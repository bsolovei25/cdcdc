<div class="container">
  <ng-container *ngIf="!planningChart else planChart">
    <evj-contemporary-widget-header
      [uniqId]="uniqId"
      [widgetTitle]="widgetTitle"
      icon="astue-predictors"
      type="astue"
    >
      <span style="margin-left: 20px">{{unitName}}</span>
      <div class="header-buttons" *ngIf="!isPredictors">
        <div
          (mousedown)="$event.stopPropagation()"
          (touchstart)="$event.stopPropagation()"
          matRipple
          [matRippleColor]="'white'"
          class="button"
        >
          <div class="icon">
            <svg-icon
              src="assets/icons/widgets/ASTUE-ONPZ/astue-onpz-conventional-fuel/event.svg"
            ></svg-icon>
          </div>
          <div class="label">Отработать событие</div>
        </div>

        <div
          (mousedown)="$event.stopPropagation()"
          (touchstart)="$event.stopPropagation()"
          matRipple
          [matRippleColor]="'white'"
          class="button"
          (click)="goToMainScreen()"
        >
          <div class="icon">
            <svg-icon
              src="assets/icons/widgets/ASTUE-ONPZ/astue-onpz-conventional-fuel/home.svg"
            ></svg-icon>
          </div>
          <div class="label">Главный экран</div>
        </div>
      </div>
    </evj-contemporary-widget-header>
    <div
      class="content"
      (mouseenter)="onMouseEnter()"
      (mouseleave)="onMouseExit()"
      (mousedown)="$event.stopPropagation()"
      (touchstart)="$event.stopPropagation()"
    >
      <div [style.left]="((paddingLeft$ | async) / 60 * 58.8) + 'px'" class="shadow-area"></div>
      <div [style.left]="(paddingLeft$ | async) + 'px'" class="info-container">
        <div class="label"> Факт </div>
        <div class="card card__fact">
          <span class="value"> {{ (predictors$ | async)?.fact?.value || '---' }} </span>
          <span class="unit"> {{ (predictors$ | async)?.units }} </span>
        </div>
        <div class="label"> План </div>
        <div class="card card__plan">
          <span class="value"> {{ (predictors$ | async)?.plan?.value || '---' }} </span>
          <span class="unit"> {{ (predictors$ | async)?.units }} </span>
        </div>
        <div class="label"> План на следующий час </div>
        <div class="card card__plan"></div>
        <div class="flex-spacer"></div>
        <div class="tag-divider">
          <svg-icon [src]="'assets/icons/widgets/ASTUE-ONPZ/astue-onpz-conventional-fuel/tag.svg'"></svg-icon>
        </div>
        <div
          class="card card__tag"
          *ngFor="let card of (predictors$ | async)?.predictors"
          [style.border-color]="card.color"
        >
          <span class="value"> {{ card.val | number:'0.0-2' }} </span>
          <span class="unit"> {{ card.units }} </span>
        </div>
      </div>
      <evj-astue-onpz-multi-chart
        class="chart"
        [data]="data"
        [colors]="colors"
        [options]="options"
        [scroll]="{left: sbLeft, right: 100 - sbLeft - sbWidth}"
      ></evj-astue-onpz-multi-chart>
      <evj-smart-scroll
        [limits]="scrollLimits"
        [data]="scrollData"
        [(sbThumbLeft)]="sbLeft" [(sbThumbWidth)]="sbWidth"
        class="scroll"
        [style.padding-left]="(paddingLeft$ | async) + 'px'"
      ></evj-smart-scroll>
      <div [style.left]="((paddingLeft$ | async) / 60 * 58.8) + 'px'" class="chart-legend">
        <div class="chart-legend__line"></div>
      </div>
    </div>
  </ng-container>
  <ng-template #planChart>
    <evj-astue-onpz-big-planning-chart></evj-astue-onpz-big-planning-chart>
  </ng-template>
</div>
