<div class="workspace">
  <div class="workspace__selects selects">
    <div class="selects__item">
      <evj-ui-block status="normal">
        <mat-form-field class="categories_selectbox">
          <mat-label>Категория</mat-label>
          <mat-select
            panelClass="mat-select-custom"
            [(ngModel)]="ewService.event.category"
            [compareWith]="compareFn"
            (selectionChange)="ewService.changeCategory()"
          >
            <mat-option *ngFor="let cat of ewService.category" [value]="cat">
              {{ ewService.categories[cat.name] }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </evj-ui-block>
    </div>
    <evj-ui-block status="{{ewService.event.priority.name}}" class="selects__item">
      <mat-form-field class="{{ewService.event.priority.name}}">
        <mat-label>Приоритет</mat-label>
        <mat-select
          panelClass="mat-select-custom"
          [(ngModel)]="ewService.event.priority"
          [compareWith]="compareFn"
        >
          <mat-option *ngFor="let p of ewService.priority" [value]="p"
          >{{ ewService.priorities[p.name] }}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </evj-ui-block>
    <div class="selects__item">
      <evj-ui-block status="normal">
        <mat-form-field class="status">
          <mat-label>Статус</mat-label>
          <mat-select
            panelClass="mat-select-custom"
            [(ngModel)]="ewService.event.status"
            [compareWith]="compareFn"
            [disabled]="true"
          >
            <mat-option *ngFor="let p of ewService.status" [value]="p"
            >{{ ewService.statuses[p.name] }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </evj-ui-block>
    </div>
    <div class="selects__item">
      <evj-ui-block status="normal">
        <mat-form-field class="status">
          <mat-label>Подкатегория</mat-label>
          <mat-select
            panelClass="mat-select-custom"
            [(ngModel)]="ewService.event?.productionTasks.subcategory"
            [compareWith]="compareFn"
          >
            <mat-option [value]="undefined">Не выбрана</mat-option>
            <mat-option *ngFor="let p of ewService.subcategory" [value]="p"
            >{{ ewService.subCategories[p.id] }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </evj-ui-block>
    </div>
    <div class="selects__item">
      <evj-ui-block status="normal">
        <div class="deadline">
          <div class="deadline__title">Срок выполнения</div>
          <evj-time-data-picker
            [data]="ewService.event.deadline"
            (dateTimePicker)="dateTimePicker($event)"
          ></evj-time-data-picker>
        </div>
      </evj-ui-block>
    </div>
    <div class="selects__item">
      <evj-ui-block status="normal">
        <mat-form-field class="status">
          <mat-label>Место</mat-label>
          <mat-select
            panelClass="mat-select-custom"
            [(ngModel)]="ewService.event.unit"
            [compareWith]="compareFn"
          >
            <mat-option *ngFor="let cat of ewService.units" [value]="cat">
              {{ cat.name }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </evj-ui-block>
    </div>
  </div>
  <div class="workspace__left left">
    <evj-event-description
      class="left__item"
      titleName="Состав бригады:"
      [description]="ewService.event?.description"
      (changedDescription)="onChangeEventDescription($event)"
    ></evj-event-description>
    <evj-chat
      [displayGraphImage]="!!ewService.event.graphValues?.graphs[0]"
      [onClickItem]="openLineChart.bind(this)"
      [messages]="ewService.event.facts"
      dataTitle="Установленные факты"
      placeholder="Укажите факты..."
      (addingMessage)="onSendMessage($event,'facts')"
    ></evj-chat>
    <evj-event-description
      class="left__item"
      titleName="Находящиеся в работе насосы и компрессоры"
      [description]="ewService.event?.description"
      (changedDescription)="onChangeEventDescription($event)"
    ></evj-event-description>
    <evj-event-description
      class="left__item"
      titleName="Замечания по работе и дефекты технологического оборудования
       печей, колонн, теплообменников, резервуаров, насосов и т.д."
      [description]="ewService.event?.description"
      (changedDescription)="onChangeEventDescription($event)"
    ></evj-event-description>
    <evj-event-description
      class="left__item"
      titleName="Сведения о проведение работ повышенной опасности"
      [description]="ewService.event?.description"
      (changedDescription)="onChangeEventDescription($event)"
    ></evj-event-description>
    <evj-event-description
      class="left__item"
      titleName="Другие события:"
      [description]="ewService.event?.description"
      (changedDescription)="onChangeEventDescription($event)"
    ></evj-event-description>
    <evj-event-description
      class="left__item"
      titleName="Состояние вентиляции"
      [description]="ewService.event?.description"
      (changedDescription)="onChangeEventDescription($event)"
    ></evj-event-description>
    <evj-event-description
      class="left__item"
      titleName="Состояние средств пожаротушения и инд. защиты:"
      [description]="ewService.event?.description"
      (changedDescription)="onChangeEventDescription($event)"
    ></evj-event-description>
    <evj-event-description
      class="left__item"
      titleName="Состояние ППК и манометров"
      [description]="ewService.event?.description"
      (changedDescription)="onChangeEventDescription($event)"
    ></evj-event-description>
    <evj-event-description
      class="left__item"
      titleName="Состояние СБ и ПАЗ"
      [description]="ewService.event?.description"
      (changedDescription)="onChangeEventDescription($event)"
    ></evj-event-description>
    <evj-event-description
      class="left__item"
      titleName="Оборудование в ремонте"
      [description]="ewService.event?.description"
      (changedDescription)="onChangeEventDescription($event)"
    ></evj-event-description>
    <evj-event-description
      class="left__item"
      titleName="Находящееся в резерве оборудование и его состояние "
      [description]="ewService.event?.description"
      (changedDescription)="onChangeEventDescription($event)"
    ></evj-event-description>
    <evj-event-description
      class="left__item"
      titleName="Тема инструктажа по ПБ, ОТ и ООС:"
      [description]="ewService.event?.description"
      (changedDescription)="onChangeEventDescription($event)"
    ></evj-event-description>
    <evj-event-description
      class="left__item"
      titleName="Отметки о сдаче инвентаря и имущества:"
      [description]="ewService.event?.description"
      (changedDescription)="onChangeEventDescription($event)"
    ></evj-event-description>

    <evj-chat
      [messages]="ewService.event.comments"
      dataTitle="Комментарии"
      placeholder="Напишите свой комментарий..."
      (addingMessage)="onSendMessage($event,'comments')"
    ></evj-chat>
  </div>
  <div class="workspace__right right">
    <evj-events-responsible-select class="right__item"></evj-events-responsible-select>
    <div class="right__item labels">
      <div class="labels__item label">
        <div class="label__name">Создано:</div>
        <div class="label__value">
          {{infoFunc('start')?.date ? (infoFunc('start').date|date:"dd.MM.yyyy | hh:mm") : '-'}}
        </div>
      </div>
      <div class="labels__item label">
        <div class="label__name">Автор:</div>
        <div class="label__value">{{infoFunc('start')?.author ? infoFunc('start').author : '-'}}</div>
      </div>
      <div class="labels__item label">
        <div class="label__name">Принято в работу:</div>
        <div class="label__value">
          {{infoFunc('inWork')?.date ? (infoFunc('inWork').date|date:"dd.MM.yyyy | hh:mm") : '-'}}
        </div>
      </div>
      <div class="labels__item label">
        <div class="label__name">Автор:</div>
        <div class="label__value">{{infoFunc('inWork')?.author ? infoFunc('inWork').author : '-'}}</div>
      </div>
      <div class="labels__item label">
        <div class="label__name">Закрыто:</div>
        <div class="label__value">
          {{infoFunc('close')?.date ? (infoFunc('close').date|date:"dd.MM.yyyy | hh:mm") : '-'}}
        </div>
      </div>
      <div class="labels__item label">
        <div class="label__name">Автор:</div>
        <div class="label__value">{{infoFunc('close')?.author ? infoFunc('close').author : '-'}}</div>
      </div>
    </div>
    <evj-events-correct class="right__item"></evj-events-correct>
  </div>
</div>
