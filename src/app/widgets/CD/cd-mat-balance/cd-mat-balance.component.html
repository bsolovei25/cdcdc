<evj-widget-header-smp
  [uniqId]="uniqId"
  (mouseenter)="onMouseEnter()"
  (mouseleave)="onMouseExit()"
  *ngIf="isHover"
>
</evj-widget-header-smp>
<div
  (mousedown)="$event.stopPropagation()"
  (touchstart)="$event.stopPropagation()"
  (mouseenter)="onMouseEnter()"
  (mouseleave)="onMouseExit()"
  class="mat-balance"
  evjContextMenu
  [disabledDirective]="!!openEvent"
  [items]="items"
>
  <evj-cd-modal-window [info]="modal"></evj-cd-modal-window>
  <div class="mat-balance__gauge">
    <evj-cd-mat-balance-gauge [data]="data?.loads"></evj-cd-mat-balance-gauge>
  </div>
  <div class="mat-balance__mnemonic">
    <evj-cd-mnemonic [dataRef]="data?.sensors"></evj-cd-mnemonic>
  </div>
  <div class="mat-balance__chart mat-elevation-z6">
    <evj-cd-mat-balance-chart [(toggleArea)]="isSelectedEl"></evj-cd-mat-balance-chart>
  </div>

  <div class="mat-balance__right">
    <evj-cd-mat-balance-right [data]="data?.streams"
                              [modalDev]="modalDeviation"
                              (modalDeviation)="openModalDeviation($event)">
    </evj-cd-mat-balance-right>
    <div *ngIf="modalDeviation"
         class="mat-balance__modal"
         [style.top.px]="modalDeviation.top"
    >
      <svg
        x="307"
        y="505"
        width="310"
        height="135"
        viewBox="0 0 260 155"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
        (click)="closeModal()">
        <rect width="170" height="75" rx="2" transform="matrix(-1 0 0 1 250 7)" fill="#191C2B"/>
        <mask id="path-2-inside-192" fill="white">
          <path d="M0 32C0 30.8954 0.895431 30 2 30H70V60H2C0.89543 60 0 59.1046 0 58V32Z"/>
        </mask>
        <path d="M0 32C0 30.8954 0.895431 30 2 30H70V60H2C0.89543 60 0 59.1046 0 58V32Z" fill="#F7931E"
              fill-opacity="0.25" stroke="#F7931E" stroke-opacity="0.25" stroke-width="2"
              mask="url(#path-2-inside-192)"/>
        <rect opacity="0.2" width="25" height="75" rx="2" transform="matrix(-1 0 0 1 250 7)"
              fill="url(#paint0_linear151)"/>
        <rect x="-0.5" y="0.5" width="169" height="74" rx="1.5" transform="matrix(-1 0 0 1 249 7)" stroke="#F7931E"
              stroke-opacity="0.25"/>
        <circle r="45" transform="matrix(-1 0 0 1 80 45)" fill="#191C2B"/>
        <circle r="45" transform="matrix(-1 0 0 1 80 45)" fill="#191C2B"/>
        <circle r="36" transform="matrix(-1 0 0 1 80.5 45.5)" stroke="#F7931E"/>
        <path
          d="M66.8818 5.64623L65.7291 4.7526C60.7251 6.41118 56.1922 9.19612 52.4975 12.8818H50.0443C50.0443 12.8818 43.6897 18.6471 41.9852 22.9327L41 22.4715C44.8473 15.6786 50.4874 10.013 57.3357 6.06181C64.1839 2.11064 71.991 0.0177563 79.9478 0.000112488C87.9046 -0.0175313 95.7214 2.0407 102.588 5.96147C109.455 9.88223 115.121 15.5228 119 22.2985L117.473 23C115.778 18.676 109.384 12.8818 109.384 12.8818H106.931C103.236 9.19612 98.7034 6.41118 93.6995 4.7526L92.7143 5.53093C84.3259 2.85267 75.2742 2.89312 66.9113 5.64623H66.8818Z"
          fill="#F7931E" fill-opacity="0.25"/>
        <path
          d="M93.3174 84.3538L94.4702 85.2474C99.4741 83.5888 104.007 80.8039 107.702 77.1182L110.155 77.1182C110.155 77.1182 116.51 71.3528 118.214 67.0673L119.199 67.5285C115.352 74.3213 109.712 79.987 102.864 83.9382C96.0153 87.8894 88.2082 89.9822 80.2514 89.9999C72.2946 90.0175 64.4778 87.9593 57.6112 84.0385C50.7446 80.1178 45.0782 74.4772 41.1992 67.7015L42.7263 67C44.4209 71.324 50.815 77.1182 50.815 77.1182L53.2682 77.1182C56.9628 80.8039 61.4958 83.5888 66.4997 85.2474L67.4849 84.4691C75.8733 87.1473 84.925 87.1069 93.2879 84.3538L93.3174 84.3538Z"
          fill="#F7931E" fill-opacity="0.25"/>
        <text fill="#D7E2F2" xml:space="preserve" style="white-space: pre" font-family="Tahoma" font-size="18"
              letter-spacing="0em"><tspan  x="76" y="43.1455" text-anchor="middle">{{ modalDeviation.valueDeviation.toFixed()  }}</tspan></text>
        <text fill="#5B607D" xml:space="preserve" style="white-space: pre" font-family="Tahoma" font-size="13"
              letter-spacing="0em"><tspan  x="66" y="63.1606">{{ modalDeviation.engUnits }}</tspan></text>
        <line opacity="0.5" y1="-0.5" x2="75" y2="-0.5" transform="matrix(4.37114e-08 1 1 -4.37114e-08 225 7)"
              stroke="#F7931E" stroke-opacity="0.25"/>
        <text fill="#D7E2F2" xml:space="preserve" style="white-space: pre" font-family="Tahoma" font-size="13"
              letter-spacing="0em">  <title></title>
          <tspan x="133" y="25.1606">{{ modalDeviation.name }}</tspan></text>
        <rect opacity="0.2" x="133" y="33" width="70" height="20" fill="url(#paint1_linear31)"/>
        <rect x="133" y="33" width="2" height="20" fill="#5C6585"/>
        <text fill="#D7E2F2" xml:space="preserve" style="white-space: pre" font-family="Tahoma" font-size="10"
              letter-spacing="0em"><tspan x="141" y="46.9697">&#x424;&#x430;&#x43a;&#x442;</tspan></text>
        <text fill="#D7E2F2" xml:space="preserve" style="white-space: pre" font-family="Tahoma" font-size="13"
              letter-spacing="0em"><tspan  x="192" y="48.1606">{{ modalDeviation.valueFact.toFixed()  }}</tspan></text>
        <rect opacity="0.2" x="133" y="55" width="70" height="20" fill="url(#paint2_linear31)"/>
        <rect x="133" y="55" width="2" height="20" fill="#5C6585"/>
        <text fill="#D7E2F2" xml:space="preserve" style="white-space: pre" font-family="Tahoma" font-size="10"
              letter-spacing="0em"><tspan x="141" y="68.9697">&#x41c;&#x43e;&#x434;&#x435;&#x43b;&#x44c;</tspan></text>
        <text fill="#F7931E" xml:space="preserve" style="white-space: pre" font-family="Tahoma" font-size="13"
              letter-spacing="0em"><tspan  x="192" y="70.1606">{{ modalDeviation.valueModel.toFixed() }}</tspan></text>
        <ng-container *ngIf="modalDeviation?.valueDeviation < 0">
          <path d="M241 45.6L237 50L233 45.6" stroke="#F7931E" stroke-linecap="round"/>
          <path d="M241 38.9999L237 43.3999L233 38.9999" stroke="#F7931E" stroke-linecap="round"/>
        </ng-container>
        <ng-container *ngIf="modalDeviation?.valueDeviation > 0">
          <path d="M241 43.4L237 39L233 43.4" stroke="#F7931E" stroke-linecap="round"/>
          <path d="M241 50.0001L237 45.6001L233 50.0001" stroke="#F7931E" stroke-linecap="round"/>
        </ng-container>
        <circle opacity="0.1" r="15" transform="matrix(-1 0 0 1 265 115)" fill="#F7931E"/>
        <path
          d="M280 115C280 111.334 278.685 107.974 276.5 105.369M258 101.73C253.242 104.245 250 109.244 250 115C250 123.284 256.716 130 265 130C267.528 130 269.91 129.374 272 128.27"
          stroke="#F7931E" stroke-width="0.75" stroke-linecap="round"/>
        <circle (click)="closeModal()" r="9.625" transform="matrix(-1 0 0 1 265 115)" fill="#F7931E" fill-opacity="0.2"
                stroke="#F7931E"
                stroke-width="0.75"/>
        <circle (click)="closeModal()" r="4.5" transform="matrix(-1 0 0 1 265 115)" fill="#191C2B" stroke="#F7931E"/>
        <path d="M265 100V46H249" stroke="#F7931E"/>
        <path fill-rule="evenodd" clip-rule="evenodd"
              d="M9.53333 37C9.82789 37 10.0667 37.2388 10.0667 37.5333V39.9092H11.2479C11.6131 39.9092 11.9091 40.2348 11.9091 40.6365C11.9091 41.0381 11.6131 41.3637 11.2479 41.3637H10.0667V44.2727H11.2479C11.6131 44.2727 11.9091 44.5983 11.9091 45C11.9091 45.4016 11.6131 45.7272 11.2479 45.7272H10.0667V48.6365H11.2479C11.6131 48.6365 11.9091 48.9621 11.9091 49.3638C11.9091 49.7654 11.6131 50.091 11.2479 50.091H10.0667V51.9333H24.4667C24.7612 51.9333 25 52.1721 25 52.4667C25 52.7612 24.7612 53 24.4667 53H9.53333C9.23878 53 9 52.7612 9 52.4667V49.3638V45V40.6365V37.5333C9 37.2388 9.23878 37 9.53333 37ZM15.5404 42.4653C15.7249 41.8816 15.9289 41.4853 16.1206 41.2449C16.3119 41.005 16.4523 40.9639 16.5272 40.9639C16.6036 40.9639 16.7483 41.0067 16.9468 41.2497C17.1443 41.4914 17.356 41.8877 17.5516 42.4686L18.7734 46.4171L18.7774 46.4297C18.9974 47.0846 19.2621 47.6158 19.5702 47.9929C19.878 48.3696 20.2687 48.6365 20.7246 48.6365C21.1821 48.6365 21.5709 48.3678 21.8738 47.9881C22.1754 47.6097 22.4298 47.0782 22.6367 46.4247L23.5164 43.7923C23.608 43.5183 23.476 43.2162 23.2216 43.1175C22.9673 43.0189 22.6868 43.161 22.5953 43.4351L21.7142 46.0717L21.7114 46.0804C21.5269 46.6641 21.3229 47.0604 21.1311 47.3008C20.9399 47.5406 20.7995 47.5818 20.7246 47.5818C20.6482 47.5818 20.5035 47.5389 20.305 47.296C20.1075 47.0543 19.8957 46.658 19.7001 46.0771L18.4784 42.1286L18.4743 42.116C18.2544 41.461 17.9897 40.9298 17.6816 40.5528C17.3738 40.1761 16.983 39.9092 16.5272 39.9092C16.0697 39.9092 15.6809 40.1778 15.378 40.5576C15.0762 40.936 14.8218 41.4678 14.6148 42.1216L13.3923 45.8093C13.3014 46.0836 13.4341 46.3853 13.6886 46.4833C13.9432 46.5812 14.2233 46.4383 14.3143 46.164L15.538 42.4727L15.5404 42.4653Z"
              fill="#F7931E"/>
        <defs>
          <linearGradient id="paint0_linear151" x1="0.000269438" y1="37.4936" x2="26.8087" y2="37.4936"
                          gradientUnits="userSpaceOnUse">
            <stop stop-color="#FF8C00"/>
            <stop offset="0.838" stop-color="#FF8C00" stop-opacity="0"/>
          </linearGradient>
          <linearGradient id="paint1_linear31" x1="133.024" y1="43.0099" x2="203.035" y2="43.0099"
                          gradientUnits="userSpaceOnUse">
            <stop stop-color="#5B607D"/>
            <stop offset="0.838" stop-color="#5B607D" stop-opacity="0"/>
          </linearGradient>
          <linearGradient id="paint2_linear31" x1="133.024" y1="65.0099" x2="203.035" y2="65.0099"
                          gradientUnits="userSpaceOnUse">
            <stop stop-color="#5B607D"/>
            <stop offset="0.838" stop-color="#5B607D" stop-opacity="0"/>
          </linearGradient>
        </defs>
      </svg>
    </div>
  </div>
</div>
