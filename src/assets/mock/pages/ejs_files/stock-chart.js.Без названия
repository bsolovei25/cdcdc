/* Copyright Â© 1993-2019 Meridium, Inc. All rights reserved.  */
define(function(require){"use strict";var a=require("lodash"),b=require("application/application-context"),c=require("ui/elements/chart/models/base-chart"),d=require("ui/elements/chart/chart-utilities"),e=require("application/application-events"),f=require("system/globalization/translator"),g="%m/%d/%Y %H:%M",h=!1,i=!1;function j(a,b,c){k.call(this,a,b,c)}var k=Object.inherit(c,j);j.prototype.configureOptions=function(a){k.prototype.configureOptions.call(this,a);var c=b.user.formats.shortDate.toLowerCase().charAt(0);return"d"===c&&(g="%d/%m/%Y %H:%M",h=!0),"y"===c&&(g="%Y/%m/%d %H:%M",i=!0),this.translator=Object.resolve(f),this.options.rangeSelector=l(this),this.options.xAxis.ordinal=!1,this.options.xAxis.plotBands=[],this.options.tooltip.xDateFormat=g,this.options.plotOptions.series.point.events.click=n.bind(null,this),this.options.plotOptions.series.dataGrouping={enabled:!1},this.options};function l(a){return{buttons:[{type:"day",count:2,
text:a.translator.translate("STOCK_CHARTS_2D")},{type:"day",count:10,text:a.translator.translate("STOCK_CHARTS_10D")},{type:"month",count:1,text:a.translator.translate("STOCK_CHARTS_1M")},{type:"year",count:1,text:a.translator.translate("STOCK_CHARTS_1Y")},{type:"year",count:3,text:a.translator.translate("STOCK_CHARTS_3Y")},{type:"all",text:a.translator.translate("STOCK_CHARTS_MAX")}],inputEnabled:!0,selected:0,inputDateFormat:g,inputEditDateFormat:g,inputDateParser:m,inputBoxWidth:120}}function m(a){return a=a.split(/[ :\.\/]/),h?new Date(parseInt(a[2]),parseInt(a[1])-1,parseInt(a[0]),parseInt(a[3],10),parseInt(a[4],10)).getTime():i?new Date(parseInt(a[0]),parseInt(a[1])-1,parseInt(a[2]),parseInt(a[3],10),parseInt(a[4],10)).getTime():new Date(parseInt(a[2]),parseInt(a[0])-1,parseInt(a[1]),parseInt(a[3],10),parseInt(a[4],10)).getTime()}j.prototype.formatChartData=function(){var a,b=(this.chartData||{}).length;for(a=0;a<b;a++)o(this),
this.config.stock&&this.config.stock===!0&&(this.chartData[a].data.sort(q),p(this.chartData[a]),this.chartData[a].threshold=null,this.chartData[a].tooltip={},this.chartData[a].tooltip.valueDecimals=2);k.prototype.formatChartData.call(this)};function n(a,b){var c;if(b&&(c=d.closestByNodeName(b.target,"MI-DASHBOARD")),b.currentTarget){var f=b.currentTarget.url,g=!0;f&&""!==f&&(f.indexOf("graph")>-1&&(g=!1),c&&(g=!0),Object.resolve(e).navigate.raise(f,{tab:g}))}}function o(b,c){a.has(b.config.series[c],"hyperlink")&&"None"!==b.config.series[c].hyperlink&&(b.chartData[c].cursor="pointer")}function p(a){"stock"===a.type?a.type="line":"stock-area"===a.type&&(a.type="area",a.fillColor={},a.fillColor.linearGradient={},a.fillColor.linearGradient.x1=0,a.fillColor.linearGradient.y1=0,a.fillColor.linearGradient.x2=0,a.fillColor.linearGradient.y2=1,a.fillColor.stops=[[0,a.color],[1,window.Highcharts.Color(a.color).setOpacity(0).get("rgba")]])}function q(a,b){
return a instanceof Array&&b instanceof Array?a[0]-b[0]:a.x-b.x}return j.prototype.formatStacked=function(a){this.config.stock&&this.chartData[a].type===this.chartUtil.CHART_TYPE_STOCK_STACKED_AREA&&(this.chartData[a].type=this.chartUtil.CHART_TYPE_AREA_SPLINE,this.options.plotOptions.areaspline.stacking="normal",this.options.tooltip.pointFormat='<span style="color:{series.color}">{series.name}</span>: <b>{point.y}</b><br/>')},j});