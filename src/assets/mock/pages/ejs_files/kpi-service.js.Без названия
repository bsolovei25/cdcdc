/* Copyright Â© 1993-2019 Meridium, Inc. All rights reserved.  */
define(function(require){"use strict";var a=require("lodash"),b=require("system/http/ajax-client"),c="api/metrics/kpi",d="api/core/metadata/entityfamily",e=require("application/application-context"),f="api/core/security/user";require("system/lang/object");function g(a){this.ajaxClient=a,this.utcHeaderOption={headers:{MeridiumToken:e.session.id+";UTC"}}}return g.dependsOn=[b],g.prototype.getKpiList=function a(b,d,e,f){var g=this,h="?startRow="+b+"&maxRows="+d+"&isForSubIndicators="+f;return e&&(h+="&nameLike="+e),g.ajaxClient.get(c+h)},g.prototype.getKpiDetails=function a(b){return this.ajaxClient.get(c+"/"+b)},g.prototype.createKPI=function a(b){var d=this;return d.ajaxClient.post(c,b,d.utcHeaderOption)},g.prototype.updateKPI=function a(b){var d=this;return d.ajaxClient.put(c+"/"+b.key,b,d.utcHeaderOption)},g.prototype.removeKPI=function a(b){return this.ajaxClient.delete(c+"/"+b)},g.prototype.getUsersList=function a(){return this.ajaxClient.get(f)},
g.prototype.getKpiData=function b(d,e,f){var g=this,h=c+"/data?";return a.isArray(d)?(h+="kpiKey="+encodeURIComponent(d[0]),a.each(a.drop(d),function(a){h+="&kpiKey="+encodeURIComponent(a)})):h+="kpiKey="+encodeURIComponent(d),h+=e===!0?"&loadChildren=true":"&loadChildren=false",h+=f===!0?"&loadFullHistory=true":"&loadFullHistory=false",g.ajaxClient.get(h,g.utcHeaderOption)},g.prototype.getKpiDataByName=function a(b,d,e){var f=this,g=c+"/name?";return g+="kpiName="+b,g+=d===!0?"&loadChildren=true":"&loadChildren=false",g+=e===!0?"&loadFullHistory=true":"&loadFullHistory=false",f.ajaxClient.get(g,f.utcHeaderOption)},g.prototype.updatemesure=function a(b){return this.ajaxClient.put(c+"/"+b+"/updatemeasure")},g.prototype.getEntityFamilyByID=function(a){return this.ajaxClient.get(d+"?id="+a)},g.prototype.checkSubIndicator=function b(d,e){var f=this,g="data?parentKpiKey="+d,h=[];return a.each(e,function(a){h.push(a.key)}),g+="&kpiChildrenKeys="+h,f.ajaxClient.get(c+"/checkSubIndicator/"+g)
},g.prototype.checkParent=function b(d,e){var f=this,g="data?",h=[];return a.each(d,function(a){h.push(a.key)}),g+="kpiChildrenKeys="+h,f.ajaxClient.get(c+"/checkParent/"+g+"&parentKey="+e)},g});