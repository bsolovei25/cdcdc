/* Copyright © 1993-2019 Meridium, Inc. All rights reserved.  */
define('system/lang/ioc',["require","exports"],function(require,exports){"use strict";function a(){for(var a=[],b=0;b<arguments.length;b++)a[b-0]=arguments[b];return function(b){b.dependsOn=a}}exports.dependsOn=a;function b(a){a.singleton=!0}exports.singleton=b;function c(a){return function(b){b.factory=a}}exports.factory=c;function d(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];return Object.resolve.apply(Object,[a].concat(b))}exports.resolve=d});
define('system/lang/object',["require","exports","lodash","jquery","bluebird"],function(require,exports,a,b,c){"use strict";function d(a,b){return __extends(b,a),a}function e(a){return new(Function.prototype.bind.apply(a,arguments))}function f(b){for(var c=[],d=1;d<arguments.length;d++)c[d-1]=arguments[d];if(g(b))return h(b);var k;if(i(b))k=j(b);else{var o=l(b),p=a.map(o,function(a){return f(a)});p.unshift(b),p=p.concat(c),k=e.apply(null,p)}return m(b)&&n(b,k),k}function g(a){return a.singleton&&a.instance}function h(a){return a.instance}function i(b){return b.factory&&a.isFunction(b.factory)}function j(a){return k(a)()}function k(a){return a.factory}function l(a){return a.dependsOn||[]}function m(a){return!!a.singleton}function n(a,b){a.instance=b}function o(b,c){var d=[],e=0;for(c=c||0,e=0;e<c;e++)d.push({});return a.each(b,function(a,b){var c={id:e,name:b,text:a,toString:function(){return a}};d[b]=c,d.push(c),e++}),d.parse=function(c){if(isNaN(c)){var e=void 0;return a.each(d,function(a){c===a&&(e=c)}),
e||a.each(b,function(a,b){c!==a&&c!==b||(e=d[b])}),e}return d[c]},d.getDisplayText=function(a){var b=d.parse(a);return b?b.text:""},Object.freeze&&Object.freeze(d),d}function p(a,b){for(var c=[],d=2;d<arguments.length;d++)c[d-2]=arguments[d];var e=Array.prototype.slice.call(arguments,2);if(r(a,b))return a[b].apply(a,e)}function q(a,b){b(a),p(a,"dispose")}function r(b,c,d){void 0===d&&(d=!1),a.isArray(c)||(c=[c]);for(var e=0;e<c.length;e++)if(!a.isFunction(b[c[e]])){if(d)throw"Required method "+c[e]+" is not defined";return!1}return!0}function s(b,c){var d=b[c];if(d&&a.isFunction(d))return d.bind(b)}function t(a,b,c){return!!a[b]&&(a[b]=c,!0)}function u(a,b){var c;return a[b]&&(c=a[b],delete a[b]),c}function v(a,b){return null===a?b:void 0===a?b:a}function w(a){var b=function(){return arguments.length&&(a=arguments[0]),a};return b.prop=function(){return a},b}var x=function(){function a(a){void 0===a&&(a=""),this.message=a,this.name="AbstractClassError"}return a}(),y=function(){
function a(a){void 0===a&&(a=""),this.message=a,this.name="AbstractMethodError"}return a}();function z(a,b){if(a.constructor===b)throw new x("Cannot create an instance of abstract class "+(b.name||""))}function A(a){throw new y("Cannot execute abstract method "+a+", must be overridden")}function B(a){return new c(C.bind(null,a))}function C(a,b,c){require(a,E.bind(null,b),D.bind(null,c))}function D(a,b){throw a(b),new Error(b)}function E(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];a(b)}var F={construct:e,resolve:f,inherit:d,createEnum:o,use:q,tryMethod:p,respondsTo:r,method:s,trySet:t,removeProperty:u,defaultValue:v,prop:w,AbstractClassError:x,AbstractMethodError:y,abstractClass:z,abstractMethod:A,require:B};return b.extend(Object,F),F});
define('system/functional/maybe',["require","exports"],function(require,exports){"use strict";function a(a){return d.fromNillable(a)}exports.maybe=a;function b(a){return new e(a)}exports.just=b;function c(){return new f}exports.nothing=c;var d=function(){function a(){}return a.fromNillable=function(a){return null===a?new f:void 0===a?new f:new e(a)},a.prototype.bind=function(a){return this.map(a).join()},a}();exports.Maybe=d;var e=function(a){__extends(b,a);function b(b){var c=a.call(this)||this;return c.value=b,c}return b.prototype.match=function(a,b){return a(this.value)},b.prototype.tap=function(a){return a(this.value),this},b.prototype.tapNothing=function(a){return this},b.prototype.map=function(a){return new b(a(this.value))},b.prototype.join=function(){return this.value instanceof d?this.value:this},b.prototype.valueOrElse=function(a){return this.value},b}(d);exports.Just=e;var f=function(a){__extends(b,a);function b(){return a.call(this)||this}return b.prototype.match=function(a,b){return b()},
b.prototype.tap=function(a){return this},b.prototype.tapNothing=function(a){return a(),this},b.prototype.map=function(a){return new b},b.prototype.join=function(){return new b},b.prototype.valueOrElse=function(a){return a},b}(d);exports.Nothing=f});
define('system/lang/event-binding',["require","exports"],function(require,exports){"use strict";var a=function(){function a(a,b,c){void 0===c&&(c=[]),this.handler=a,this.context=b,this.args=c}return a.prototype.execute=function(a){void 0===a&&(a=[]),a=this.args.concat(a),this.handler.apply(this.context,a)},a.prototype.dispose=function(){this.handler=null,this.context=null,this.args=null},a}();exports.EventBinding=a});
define('system/lang/event',["require","exports","./event-binding"],function(require,exports,a){"use strict";var b=function(){function b(){this.bindings=[]}return b.prototype.add=function(b,c){for(var d=[],e=2;e<arguments.length;e++)d[e-2]=arguments[e];if(null===b)throw"Event handler must not be null";if(void 0===b)throw"Event handler must not be undefined";var f=Array.prototype.slice.call(arguments,2),g=new a.EventBinding(b,c,f);return this.bindings.push(g),g},b.prototype.raise=function(){for(var a=[],b=0;b<arguments.length;b++)a[b-0]=arguments[b];for(var c=this.bindings.length,d=0;d!==c;d++)this.bindings[d].execute(a)},b.prototype.remove=function(a,b){arguments.length>1?c(this,a,b):arguments.length>0?(b=a,d(this,b)):e(this)},b}();function c(a,b,c){for(var d=[],e=a.bindings.length,f=0;f!==e;f++){var g=a.bindings[f];g.handler!==b||g.context!==c?d.push(g):g.dispose()}a.bindings=d}function d(a,b){for(var c=[],d=a.bindings.length,e=0;e!==d;e++){var f=a.bindings[e];f.context!==b?c.push(f):f.dispose()}
a.bindings=c}function e(a){for(var b=a.bindings.length,c=0;c!==b;c++)a.bindings[c].dispose();a.bindings=[]}return b});
define('application/application-events',["require","exports","system/lang/event","system/lang/ioc"],function(require,exports,a,b){"use strict";var c=function(){function b(){this.windowResized=new a,this.windowUnloaded=new a,this.signout=new a,this.windowClicked=new a,this.errorOccured=new a,this.errorUnhandled=new a,this.errorCleared=new a,this.titleChanged=new a,this.iconChanged=new a,this.navigate=new a,this.assetcontextChanged=new a,this.connectionChanged=new a,this.sessionChanged=new a,this.sessionExpired=new a,this.offlineSessionExpired=new a,this.smallDeviceOptionsMenuClicked=new a,this.layoutChanged=new a,this.bulkClose=new a}return b.prototype.removeAll=function(){this.connectionChanged.remove(),this.windowResized.remove(),this.windowUnloaded.remove(),this.signout.remove(),this.windowClicked.remove(),this.errorOccured.remove(),this.errorUnhandled.remove(),this.errorCleared.remove(),this.titleChanged.remove(),this.iconChanged.remove(),this.navigate.remove(),this.assetcontextChanged.remove(),
this.connectionChanged.remove(),this.sessionExpired.remove(),this.smallDeviceOptionsMenuClicked.remove(),this.layoutChanged.remove(),this.bulkClose.remove()},b}();return c=__decorate([b.singleton],c)});
define('application/application-context',["require","exports","ramda"],function(require,exports,a){"use strict";var b=function(b){return function(c){if(!c)return!1;var d=b(c);return!a.isNil(d)&&""!==d}},c=b(a.prop("siteKey")),d=b(a.prop("defaultSiteKey")),e=function(){function a(){f(this)}return a.prototype.getSiteContext=function(){return c(this.assetcontext)?this.assetcontext.siteKey:d(this.user)?this.user.defaultSiteKey:null},a.prototype.hasPredixSDKInstalled=function(){return!!window.PredixSDK},a.prototype.reset=function(){f(this)},a}();function f(a){a.user=null,a.session=null,a.homeRoute="home",a.sessionStatus={isActive:!1},a.assetcontext=null,a.licensedModules=null,a.help={helpContext:null,helpUrl:null,defaultUrl:null},a.connectionStatus={connected:!0,lastStatusChange:null,connectionCheckerInterval:null,lastResponse:new Date,lastUserActivity:new Date},a.navigation={activeRoute:null,tabsInfo:null},a.isSupportedBrowser=!0,a.isAppHub=!!window.nav,a.hostingEnvironment=0}return new e});
define('system/collections/list',["require","exports","jquery","knockout","system/lang/object"],function(require,exports,a,b,c){"use strict";return function(){function d(a){void 0===a&&(a=[]),this.items=a}return d.indexOf=function(b,c){var d=-1;return a.isArray(b)===!1?d:(a.each(b,function(a,b){if(c(b,a)===!0)return d=a,!1}),d)},d.sort=function(a,c,d,e){function f(a,b){return a&&b||!a&&!b?0:a?1:-1}function g(a,b){return a===b?0:a<b?-1:1}function h(a,b){var c=a.toString().toLocaleLowerCase(),d=b.toString().toLocaleLowerCase();return c===d?0:c<d?-1:1}function i(a,i){var j=b.utils.unwrapObservable(d?a[d]:a),k=b.utils.unwrapObservable(d?i[d]:i);e=e||typeof j;var l;switch(e){case"boolean":l=f(j,k);break;case"number":l=j-k;break;case"datetime":l=g(j,k);break;default:l=h(j,k)}return c||(l=0-l),l}a.sort(i)},d.fillArray=function(a,b,c){for(;b--;)a[b]=c;return a},d.prototype.count=function(){return this.items.length},d.prototype.add=function(a){this.items[this.count()]=a},d.prototype.item=function(a){
return a<0&&(a+=this.count()),this.items[a]},d.prototype.clear=function(){this.items.length=0},d.prototype.indexOf=function(a){return this.items.indexOf(a)},d.prototype.contains=function(a){return this.indexOf(a)!==-1},d.prototype.addRange=function(a){a.forEach(this.add,this)},d.prototype.forEach=function(a,b){for(var c=0;c!==this.count();c++)a.call(b,this.item(c),c,this)},d.prototype.map=function(a,b){for(var d=c.resolve(this.constructor),e=0;e!==this.count();e++)d.add(a.call(b,this.item(e),e,this));return d},d.prototype.take=function(a){var b;return b=a>=0?this.items.slice(0,a):this.items.slice(a),c.resolve(this.constructor,b)},d.prototype.shift=function(){return this.items.shift()},d.prototype.pop=function(){return this.items.pop()},d.prototype.moveToEnd=function(a){this.remove(a),this.add(a)},d.prototype.remove=function(a){var b=this.indexOf(a);b!==-1&&this.items.splice(b,1)},d.prototype.createArrayIndex=function(a,b){var c={};if(a)for(var d=0;d<a.length;d++)c[a[d][b]]=a[d]
;return c},d}()});
define('system/collections/observable-list',["require","exports","knockout"],function(require,exports,a){"use strict";return function(){function b(b){void 0===b&&(b=[]),this.items=a.observableArray(b)}return b.prototype.count=function(){return this.items().length},b.prototype.item=function(a){return this.items()[a]},b.prototype.add=function(a){this.items.push(a)},b.prototype.remove=function(a){return this.items.remove(a)},b.prototype.clear=function(){this.items([])},b.prototype.indexOf=function(a){return this.items.indexOf(a)},b.prototype.moveUp=function(a){var b=this.items.indexOf(a);0!==b&&(this.items()[b]=this.items()[b-1],this.items()[b-1]=a,this.items.valueHasMutated())},b.prototype.moveDown=function(a){var b=this.items.indexOf(a);b!==this.items().length-1&&(this.items()[b]=this.items()[b+1],this.items()[b+1]=a,this.items.valueHasMutated())},b.prototype.dispose=function(){this.items([])},b}()});
define('system/knockout/change-tracker',["require","exports","knockout","ramda"],function(require,exports,a,b){"use strict";var c=function(){function b(b,c,f){void 0===c&&(c=a.toJSON),void 0===f&&(f=!1),this.hashFunction=c,this.objectToTrack=b,this.lastCleanState=a.observable(),f||this.lastCleanState(e(this)),this.isDirty=a.computed(d.bind(null,this))}return b.prototype.markCurrentStateAsClean=function(){this.lastCleanState(e(this))},b.prototype.dispose=function(){this.isDirty.dispose(),this.lastCleanState(null)},b}();function d(a){return e(a)!==a.lastCleanState()}function e(a){var c=a.hashFunction.apply(a.objectToTrack);return b.is(Object,c)?JSON.stringify(c):c}return c});
define('system/lang/functional',['require','ramda'],function(require){"use strict";var a=require("ramda");function b(){}function c(b,c){return a.is(Function,c[b])?c[b]():c[b]}function d(a,b){return console[a](b),b}function e(a){return a}function f(){return Array.prototype.join.call(arguments,"")}function g(b){if(a.is(Function,b)){var c=Array.prototype.slice.call(arguments,1);return setTimeout(function(){b.apply(void 0,c)},1)}}var h=a.either(a.identity,function(){return{}}),i=a.either(a.identity,function(){return[]});return{noop:b,identity:a.identity,areSame:a.identical,result:a.curry(c),log:d.bind(null,"log"),trace:d.bind(null,"trace"),warn:d.bind(null,"warn"),error:d.bind(null,"error"),debug:e,str:f,defer:g,defaultToObject:h,defaultToArray:i}});
define('system/knockout/knockout-manager',["require","exports","knockout","system/collections/list","system/collections/observable-list","./change-tracker","system/lang/functional"],function(require,exports,a,b,c,d){"use strict";var e=require("system/lang/functional");return function(){function f(a){void 0===a&&(a=e.noop),this.observables=new b,this.computeds=new b,this.subscriptions=new b,this.tracker=new d(this,a),this.isDirty=this.tracker.isDirty}return f.prototype.observable=function(){var b=a.observable.apply(null,Array.prototype.splice.call(arguments,0));return this.observables.add(b),b},f.prototype.observableArray=function(){var b=a.observableArray.apply(null,Array.prototype.splice.call(arguments,0));return this.observables.add(b),b},f.prototype.observableList=function(a){var b=new c(a);return this.observables.add(b),b},f.prototype.computed=function(b){var c=a.computed.apply(null,Array.prototype.splice.call(arguments,0));return this.computeds.add(c),c},f.prototype.pureComputed=function(b){
var c=a.pureComputed.apply(null,Array.prototype.splice.call(arguments,0));return this.computeds.add(c),c},f.prototype.subscribe=function(a,b,c,d){var e=a.subscribe(b,c,d);return this.subscriptions.add(e),e},f.prototype.dispose=function(){this.disposeSubscriptions(),this.disposeComputeds(),this.disposeObservables(),this.tracker.dispose()},f.prototype.disposeSubscriptions=function(){this.subscriptions.forEach(function(a){a.dispose()}),this.subscriptions.clear()},f.prototype.disposeComputeds=function(){this.computeds.forEach(function(a){a.dispose()}),this.computeds.clear()},f.prototype.disposeObservables=function(){this.observables.forEach(function(a){a.dispose?a.dispose():a(null)}),this.observables.clear()},f.prototype.createHash=function(){return this.observables.items.map(function(a){return a()})},f}()});
define('spa/knockout/knockout-view-model',["require","exports","knockout"],function(require,exports,a){"use strict";return function(){function b(a){this.view=a,this.subscriptions=[],this.preserveContext=!1}return b.prototype.attach=function(b){b.attach($(this.view));var c=b.element;if(a.contextFor(c)&&this.preserveContext){var d=a.contextFor(c).createChildContext(this);a.applyBindingsToDescendants(d,c)}else a.applyBindingsToDescendants(this,c)},b.prototype.detach=function(b){a.cleanNode(b.element),b.clear()},b}()});
define('system/globalization/translator',["require","exports","system/lang/ioc","jed"],function(require,exports,a){"use strict";var b=require("jed"),c=function(){function a(){this.jed=null}return a.prototype.setLocale=function(a){this.jed=new b(a)},a.prototype.translate=function(a,b,c){if(!a)return a;if(!this.jed)return a;var d=this.jed.translate(a);return b&&d.onDomain(b),c&&d.withContext(c),d.fetch()},a}();return c=__decorate([a.singleton],c)});
define('system/error/error-message',["require","exports"],function(require,exports){"use strict";return function(){function a(a,b,c){void 0===c&&(c=null),this.code=a,this.message=b,this.detail=c}return a.fromHttpResponse=function(b,c,d){if(c.responseText){var e=d?d+c.responseText:c.responseText;return new a(b,this.fromDetail(e),c.responseText)}var e=d?d+c.statusText:c.statusText;return new a(b,e)},a.fromDetail=function(a){return a=a.replace("\r\n"," ").replace("\n","").replace("\r",""),a.length>512&&(a=a.substring(0,510)+".."),a},a}()});
/**
 * @license RequireJS text 2.0.9 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */
/*jslint regexp: true */
/*global require, XMLHttpRequest, ActiveXObject,
  define, window, process, Packages,
  java, location, Components, FileUtils */

define('text',['module'], function (module) {
    'use strict';

    var text, fs, Cc, Ci, xpcIsWindows,
        progIds = ['Msxml2.XMLHTTP', 'Microsoft.XMLHTTP', 'Msxml2.XMLHTTP.4.0'],
        xmlRegExp = /^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,
        bodyRegExp = /<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,
        hasLocation = typeof location !== 'undefined' && location.href,
        defaultProtocol = hasLocation && location.protocol && location.protocol.replace(/\:/, ''),
        defaultHostName = hasLocation && location.hostname,
        defaultPort = hasLocation && (location.port || undefined),
        buildMap = {},
        masterConfig = (module.config && module.config()) || {};

    text = {
        version: '2.0.9',

        strip: function (content) {
            //Strips <?xml ...?> declarations so that external SVG and XML
            //documents can be added to a document without worry. Also, if the string
            //is an HTML document, only the part inside the body tag is returned.
            if (content) {
                content = content.replace(xmlRegExp, "");
                var matches = content.match(bodyRegExp);
                if (matches) {
                    content = matches[1];
                }
            } else {
                content = "";
            }
            return content;
        },

        jsEscape: function (content) {
            return content.replace(/(['\\])/g, '\\$1')
                .replace(/[\f]/g, "\\f")
                .replace(/[\b]/g, "\\b")
                .replace(/[\n]/g, "\\n")
                .replace(/[\t]/g, "\\t")
                .replace(/[\r]/g, "\\r")
                .replace(/[\u2028]/g, "\\u2028")
                .replace(/[\u2029]/g, "\\u2029");
        },

        createXhr: masterConfig.createXhr || function () {
            //Would love to dump the ActiveX crap in here. Need IE 6 to die first.
            var xhr, i, progId;
            if (typeof XMLHttpRequest !== "undefined") {
                return new XMLHttpRequest();
            } else if (typeof ActiveXObject !== "undefined") {
                for (i = 0; i < 3; i += 1) {
                    progId = progIds[i];
                    try {
                        xhr = new ActiveXObject(progId);
                    } catch (e) {}

                    if (xhr) {
                        progIds = [progId];  // so faster next time
                        break;
                    }
                }
            }

            return xhr;
        },

        /**
         * Parses a resource name into its component parts. Resource names
         * look like: module/name.ext!strip, where the !strip part is
         * optional.
         * @param {String} name the resource name
         * @returns {Object} with properties "moduleName", "ext" and "strip"
         * where strip is a boolean.
         */
        parseName: function (name) {
            var modName, ext, temp,
                strip = false,
                index = name.indexOf("."),
                isRelative = name.indexOf('./') === 0 ||
                             name.indexOf('../') === 0;

            if (index !== -1 && (!isRelative || index > 1)) {
                modName = name.substring(0, index);
                ext = name.substring(index + 1, name.length);
            } else {
                modName = name;
            }

            temp = ext || modName;
            index = temp.indexOf("!");
            if (index !== -1) {
                //Pull off the strip arg.
                strip = temp.substring(index + 1) === "strip";
                temp = temp.substring(0, index);
                if (ext) {
                    ext = temp;
                } else {
                    modName = temp;
                }
            }

            return {
                moduleName: modName,
                ext: ext,
                strip: strip
            };
        },

        xdRegExp: /^((\w+)\:)?\/\/([^\/\\]+)/,

        /**
         * Is an URL on another domain. Only works for browser use, returns
         * false in non-browser environments. Only used to know if an
         * optimized .js version of a text resource should be loaded
         * instead.
         * @param {String} url
         * @returns Boolean
         */
        useXhr: function (url, protocol, hostname, port) {
            var uProtocol, uHostName, uPort,
                match = text.xdRegExp.exec(url);
            if (!match) {
                return true;
            }
            uProtocol = match[2];
            uHostName = match[3];

            uHostName = uHostName.split(':');
            uPort = uHostName[1];
            uHostName = uHostName[0];

            return (!uProtocol || uProtocol === protocol) &&
                   (!uHostName || uHostName.toLowerCase() === hostname.toLowerCase()) &&
                   ((!uPort && !uHostName) || uPort === port);
        },

        finishLoad: function (name, strip, content, onLoad) {
            content = strip ? text.strip(content) : content;
            if (masterConfig.isBuild) {
                buildMap[name] = content;
            }
            onLoad(content);
        },

        load: function (name, req, onLoad, config) {
            //Name has format: some.module.filext!strip
            //The strip part is optional.
            //if strip is present, then that means only get the string contents
            //inside a body tag in an HTML string. For XML/SVG content it means
            //removing the <?xml ...?> declarations so the content can be inserted
            //into the current doc without problems.

            // Do not bother with the work if a build and text will
            // not be inlined.
            if (config.isBuild && !config.inlineText) {
                onLoad();
                return;
            }

            masterConfig.isBuild = config.isBuild;

            var parsed = text.parseName(name),
                nonStripName = parsed.moduleName +
                    (parsed.ext ? '.' + parsed.ext : ''),
                url = req.toUrl(nonStripName),
                useXhr = (masterConfig.useXhr) ||
                         text.useXhr;

            //Load the text. Use XHR if possible and in a browser.
            if (!hasLocation || useXhr(url, defaultProtocol, defaultHostName, defaultPort)) {
                text.get(url, function (content) {
                    text.finishLoad(name, parsed.strip, content, onLoad);
                }, function (err) {
                    if (onLoad.error) {
                        onLoad.error(err);
                    }
                });
            } else {
                //Need to fetch the resource across domains. Assume
                //the resource has been optimized into a JS module. Fetch
                //by the module name + extension, but do not include the
                //!strip part to avoid file system issues.
                req([nonStripName], function (content) {
                    text.finishLoad(parsed.moduleName + '.' + parsed.ext,
                                    parsed.strip, content, onLoad);
                });
            }
        },

        write: function (pluginName, moduleName, write, config) {
            if (buildMap.hasOwnProperty(moduleName)) {
                var content = text.jsEscape(buildMap[moduleName]);
                write.asModule(pluginName + "!" + moduleName,
                               "define(function () { return '" +
                                   content +
                               "';});\n");
            }
        },

        writeFile: function (pluginName, moduleName, req, write, config) {
            var parsed = text.parseName(moduleName),
                extPart = parsed.ext ? '.' + parsed.ext : '',
                nonStripName = parsed.moduleName + extPart,
                //Use a '.js' file name so that it indicates it is a
                //script that can be loaded across domains.
                fileName = req.toUrl(parsed.moduleName + extPart) + '.js';

            //Leverage own load() method to load plugin value, but only
            //write out values that do not have the strip argument,
            //to avoid any potential issues with ! in file names.
            text.load(nonStripName, req, function (value) {
                //Use own write() method to construct full module value.
                //But need to create shell that translates writeFile's
                //write() to the right interface.
                var textWrite = function (contents) {
                    return write(fileName, contents);
                };
                textWrite.asModule = function (moduleName, contents) {
                    return write.asModule(moduleName, fileName, contents);
                };

                text.write(pluginName, nonStripName, textWrite, config);
            }, config);
        }
    };

    if (masterConfig.env === 'node' || (!masterConfig.env &&
            typeof process !== "undefined" &&
            process.versions &&
            !!process.versions.node &&
            !process.versions['node-webkit'])) {
        //Using special require.nodeRequire, something added by r.js.
        fs = require.nodeRequire('fs');

        text.get = function (url, callback, errback) {
            try {
                var file = fs.readFileSync(url, 'utf8');
                //Remove BOM (Byte Mark Order) from utf8 files if it is there.
                if (file.indexOf('\uFEFF') === 0) {
                    file = file.substring(1);
                }
                callback(file);
            } catch (e) {
                errback(e);
            }
        };
    } else if (masterConfig.env === 'xhr' || (!masterConfig.env &&
            text.createXhr())) {
        text.get = function (url, callback, errback, headers) {
            var xhr = text.createXhr(), header;
            xhr.open('GET', url, true);

            //Allow plugins direct access to xhr headers
            if (headers) {
                for (header in headers) {
                    if (headers.hasOwnProperty(header)) {
                        xhr.setRequestHeader(header.toLowerCase(), headers[header]);
                    }
                }
            }

            //Allow overrides specified in config
            if (masterConfig.onXhr) {
                masterConfig.onXhr(xhr, url);
            }

            xhr.onreadystatechange = function (evt) {
                var status, err;
                //Do not explicitly handle errors, those should be
                //visible via console output in the browser.
                if (xhr.readyState === 4) {
                    status = xhr.status;
                    if (status > 399 && status < 600) {
                        //An http 4xx or 5xx error. Signal an error.
                        err = new Error(url + ' HTTP status: ' + status);
                        err.xhr = xhr;
                        errback(err);
                    } else {
                        callback(xhr.responseText);
                    }

                    if (masterConfig.onXhrComplete) {
                        masterConfig.onXhrComplete(xhr, url);
                    }
                }
            };
            xhr.send(null);
        };
    } else if (masterConfig.env === 'rhino' || (!masterConfig.env &&
            typeof Packages !== 'undefined' && typeof java !== 'undefined')) {
        //Why Java, why is this so awkward?
        text.get = function (url, callback) {
            var stringBuffer, line,
                encoding = "utf-8",
                file = new java.io.File(url),
                lineSeparator = java.lang.System.getProperty("line.separator"),
                input = new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(file), encoding)),
                content = '';
            try {
                stringBuffer = new java.lang.StringBuffer();
                line = input.readLine();

                // Byte Order Mark (BOM) - The Unicode Standard, version 3.0, page 324
                // http://www.unicode.org/faq/utf_bom.html

                // Note that when we use utf-8, the BOM should appear as "EF BB BF", but it doesn't due to this bug in the JDK:
                // http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4508058
                if (line && line.length() && line.charAt(0) === 0xfeff) {
                    // Eat the BOM, since we've already found the encoding on this file,
                    // and we plan to concatenating this buffer with others; the BOM should
                    // only appear at the top of a file.
                    line = line.substring(1);
                }

                if (line !== null) {
                    stringBuffer.append(line);
                }

                while ((line = input.readLine()) !== null) {
                    stringBuffer.append(lineSeparator);
                    stringBuffer.append(line);
                }
                //Make sure we return a JavaScript string and not a Java string.
                content = String(stringBuffer.toString()); //String
            } finally {
                input.close();
            }
            callback(content);
        };
    } else if (masterConfig.env === 'xpconnect' || (!masterConfig.env &&
            typeof Components !== 'undefined' && Components.classes &&
            Components.interfaces)) {
        //Avert your gaze!
        Cc = Components.classes,
        Ci = Components.interfaces;
        Components.utils['import']('resource://gre/modules/FileUtils.jsm');
        xpcIsWindows = ('@mozilla.org/windows-registry-key;1' in Cc);

        text.get = function (url, callback) {
            var inStream, convertStream, fileObj,
                readData = {};

            if (xpcIsWindows) {
                url = url.replace(/\//g, '\\');
            }

            fileObj = new FileUtils.File(url);

            //XPCOM, you so crazy
            try {
                inStream = Cc['@mozilla.org/network/file-input-stream;1']
                           .createInstance(Ci.nsIFileInputStream);
                inStream.init(fileObj, 1, 0, false);

                convertStream = Cc['@mozilla.org/intl/converter-input-stream;1']
                                .createInstance(Ci.nsIConverterInputStream);
                convertStream.init(inStream, "utf-8", inStream.available(),
                Ci.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER);

                convertStream.readString(inStream.available(), readData);
                convertStream.close();
                inStream.close();
                callback(readData.value);
            } catch (e) {
                throw new Error((fileObj && fileObj.path || '') + ': ' + e);
            }
        };
    }
    return text;
});


define('text!query/views/query-screen.html',[],function () { return '<div class="query-landing-page">\r\n    <mi-page-filter>\r\n        <div class="query-results">\r\n            <mi-resultgrid selectionmode="single"\r\n                           queryexecutionmode="queryContainer"\r\n                           showrowfilter="true"\r\n                           data-bind="attr: { data: query, queryexecutionmode: queryExecMode }">\r\n            </mi-resultgrid>\r\n        </div>\r\n    </mi-page-filter>  ﻿\r\n</div>';});

define('query/query-editor-events',['require','system/lang/event','system/lang/object'],function(require){"use strict";var a=require("system/lang/event");require("system/lang/object");function b(){this.addSourceClicked=new a,this.queryTypeClicked=new a,this.appendSourceClicked=new a,this.queryExecuted=new a,this.runButtonClicked=new a,this.actionQueryRoutedToResults=new a,this.sourceProperties={},this.sourceProperties.stateChanged=new a}return b.singleton=!0,b});
define('system/text/parser',["require","exports","ramda","globalize"],function(require,exports,a){"use strict";var b=require("globalize"),c=function(){function c(){}return c.prototype.parseInt=function(a,c,d){return void 0===a||null===a?a:"string"!=typeof a&&"number"!=typeof a?NaN:b.parseInt(a,c,d)},c.prototype.parseFloat=function(a,c,d){return void 0===a||null===a||"number"==typeof a?a:"string"!=typeof a?NaN:b.parseFloat(a,c,d)},c.prototype.parseDate=function(c,e,f){if(!e){var g=a.clone(b.findClosestCulture().calendar.patterns);return g.dt=d("d","t"),g.dT=d("d","T"),g.Dt=d("D","t"),g.DT=d("D","T"),g.Mt=d("M","t"),g.MT=d("M","T"),g.Yt=d("Y","t"),g.YT=d("Y","T"),b.parseDate(c,a.values(g),f)}return b.parseDate(c,e,f)},c}();function d(a,b){return e(a)+" "+e(b)}function e(a){return b.findClosestCulture().calendar.patterns[a]}return new c});
define('system/text/formatter',["require","exports","lodash","jquery","system/lang/ioc","system/text/parser"],function(require,exports,a,b,c,d){"use strict";var e=require("globalize");Date.Formats={Unformatted:"yyyy-MM-dd HH:mm:ss",Sortable:"S",LongDate_ShortTime:"f",LongDate_LongTime:"F",ShortTime:"t",LongTime:"T",ShortDate:"d",LongDate:"D",Month_Year:"Y",Month_Day:"M"};var f=function(a){return function(b){return a+(b||"")}};Number.Formats={Number:f("n"),Decimal:f("d"),Percent:f("p"),Currency:f("c")},Number.Formats.Number_Zero="n0",Number.Formats.Number_Two=Number.Formats.Number(2),Number.Formats.Number_Four=Number.Formats.Number(4),Number.Formats.Decimal_Zero="d0",Number.Formats.Decimal_Two=Number.Formats.Decimal(2),Number.Formats.Decimal_Four=Number.Formats.Decimal(4),Number.Formats.Percent_Zero="p0",Number.Formats.Percent_One=Number.Formats.Percent(1),Number.Formats.Percent_Two=Number.Formats.Percent(2),Number.Formats.Currency_Zero="c0",Number.Formats.Currency_Two=Number.Formats.Currency(2)
;var g=function(){function c(){this.culture="en"}return c.prototype.setCulture=function(a){this.culture=a,e.culture(a)},c.prototype.cultureInfo=function(){return e.culture()},c.prototype.getFormatByCode=function(a){return i(a)},c.prototype.format=function(b,c,f){var g=this,i=!1,j=null;if(f=f||this.culture,a.isArray(c))return a.map(c,function(a){return g.format(b,a,f)}).join(" ");if(c=c,b instanceof Date)return h(b,c,f);if(c&&null!==c.match(/^[ndmg]e?[0-9]*/i)&&!(b instanceof Date)){var k="number"==typeof b?b:d.parseFloat(b,10,"en");if(isNaN(k)||null===k)c=void 0;else{var l=c.substr(0,1);if(null!==c.match(/^[ndmg]e[0-9]*/i)){c=c.replace("e","");var n=m(k,!0);n&&n.length>1&&(k=parseFloat(n[0]),j="e"+n[1])}switch(b=k,l){case"m":c=o(k,c);break;case"g":c=o(k,c),i=!0}}}var p=e.format(b,c,f);if(j&&(p+=j),i){var q=new RegExp(e.culture(f).numberFormat[","].replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1"),"g");p&&(p=p.replace(q,""))}return p},c.prototype.abbreviate=function(a,b){
return a&&a.length>2*b?a.substr(0,b)+"..."+a.substr(a.length-b,a.length):a},c.prototype.abbreviateByWidth=function(a,c,d){if(!a)return a;var e=document.createElement("span");e.className="dummy-span";var f=b(e);f.text(a),b(document).find("body").append(f);var g=f.width();return b(e).remove(),g>c?this.abbreviate(a,d):a},c}();g=__decorate([c.singleton],g);function h(a,b,c){return b=i(b),e.format(a,b,c)}function i(a){return"g"===a?j():"G"===a||"GT"===a?l():"r"===a||"R"===a?"ddd, dd MMM yyyy HH':'mm':'ss 'GMT'":"s"===a||"m"===a||"y"===a?a.toUpperCase():a}function j(){return k("d")+" "+k("t")}function k(a){return e.culture().calendar.patterns[a]}function l(){return k("d")+" "+k("T")}function m(a,b){return a=a,!b&&n(a)?[a.toString()]:a.toExponential().split(/[eE]/)}function n(a){if(0===a)return!0;var b=Math.abs(a);return b<1e10&&b>1e-6}function o(a,b){var c=b.substr(1);return p(q(a,c.length>0?parseInt(c,10):void 0))}function p(a){var b=a.indexOf(".");return"n"+(b>-1?a.length-1-b:0)}
function q(a,b){var c=Number(a);if(isNaN(c))return a;var d,e=m(c);if(Math.abs(c)<1&&e&&e.length>1){var f=Math.floor(parseFloat(e[0])).toString().length,g=e[0].toString().length>f?e[0].toString().length-f-1:0,h=f+g,i=Math.abs(parseFloat(e[1])),j=i+(b>h?h:b)-1;d=c.toFixed(j>20?20:j)}else d=Math.abs(c)>=1||!b?0===b||b?c.toFixed(b>20?20:b):c.toString():c.toPrecision(b);var k=c.toString();return k.length<d.length?k:d}return g});
define('system/diagnostics/log-message',["require","exports","lodash","system/lang/object","system/text/formatter"],function(require,exports,a,b,c){"use strict";var d=function(){function d(a,b,c,d,e){void 0===e&&(e=""),this.level=a,this.source=b,this.text=c,this.timestamp=d?new Date(d):new Date,this.context=e}return d.fromJson=function(a){return new d(a.level,a.source,a.text,a.timestamp,a.context)},d.fromJsonCollection=function(b){return a.map(b,d.fromJson)},d.prototype.fullSource=function(){return this.context?this.source+" ["+this.context+"]":this.source},d.prototype.toJson=function(){return{timestamp:this.timestamp.toISOString(),level:this.level,source:this.source,text:this.text,context:this.context}},d.prototype.getFormattedTimestamp=function(){return b.resolve(c).format(this.timestamp,"f")},d.prototype.getLevelCaption=function(a){return e(a,this.level)},d}();function e(b,c){var d=a.find(b,{value:c});return d?d.text:c}return d});
define('system/diagnostics/logger',["require","exports","lodash","./log-message"],function(require,exports,a,b){"use strict";var c={trace:5,debug:4,info:3,warn:2,error:1,fatal:0},d=function(){function a(a,b,c){this.id=a,this.messageLogged=b,this.level=c}return a.prototype.log=function(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];e(this,a,b)},a.prototype.trace=function(){for(var b=[],c=0;c<arguments.length;c++)b[c-0]=arguments[c];e(this,a.levels.trace,b)},a.prototype.debug=function(){for(var b=[],c=0;c<arguments.length;c++)b[c-0]=arguments[c];e(this,a.levels.debug,b)},a.prototype.info=function(){for(var b=[],c=0;c<arguments.length;c++)b[c-0]=arguments[c];e(this,a.levels.info,b)},a.prototype.warn=function(){for(var b=[],c=0;c<arguments.length;c++)b[c-0]=arguments[c];e(this,a.levels.warn,b)},a.prototype.error=function(){for(var b=[],c=0;c<arguments.length;c++)b[c-0]=arguments[c];e(this,a.levels.error,b)},a.prototype.fatal=function(){for(var b=[],c=0;c<arguments.length;c++)b[c-0]=arguments[c]
;e(this,a.levels.fatal,b)},a.prototype.isTraceEnabled=function(){return f(this,a.levels.trace)},a.prototype.isDebugEnabled=function(){return f(this,a.levels.debug)},a.prototype.isInfoEnabled=function(){return f(this,a.levels.info)},a.prototype.isWarnEnabled=function(){return f(this,a.levels.warn)},a.prototype.isErrorEnabled=function(){return f(this,a.levels.error)},a.prototype.isFatalEnabled=function(){return f(this,a.levels.fatal)},a}();d.levels={trace:"trace",debug:"debug",info:"info",warn:"warn",error:"error",fatal:"fatal"};function e(a,c,d){if(f(a,c)){var e=new b(c,a.id,g(d).join(" "));a.messageLogged.raise(a,e)}}function f(a,b){return c[b]<=c[a.level]}function g(b){return a.map(b,function(b){return a.isObject(b)?JSON.stringify(b):a.isNull(b)?"":a.isUndefined(b)?"":b.toString()})}return d});
define('config/storage-config',["require","exports","application/application-context"],function(require,exports,a){"use strict";function b(){var b=a.session,c=b.apiServer.toUpperCase(),d=b.datasourceId.toUpperCase(),e=b.userId.toUpperCase(),f="Meridium APM("+c+", "+d+", "+e+")";return{name:f,description:f}}exports.documentStorage=b});
define('system/data/document-storage',["require","exports","jquery","config/storage-config","localforage"],function(require,exports,a,b){"use strict";var c=require("localforage");return function(){function d(d){var e=a.extend({},b.documentStorage(),{storeName:"data"});this.prefix=d+"__",this.instance=c.createInstance(e)}return d.prototype.getItem=function(b){var c=a.Deferred();return this.instance.getItem(this.prefix+b).then(c.resolve.bind(c),c.reject.bind(c)),c.promise()},d.prototype.setItem=function(b,c){var d=a.Deferred();return this.instance.setItem(this.prefix+b,c).then(d.resolve.bind(d),d.reject.bind(d)),d.promise()},d.prototype.removeItem=function(b){var c=a.Deferred();return this.instance.removeItem(this.prefix+b).then(c.resolve.bind(c),c.reject.bind(c)),c.promise()},d}()});
define('system/data/client-preferences',["require","exports","system/data/document-storage","system/lang/ioc"],function(require,exports,a,b){"use strict";var c=function(){function b(){this.documentStorage=new a("client_preferences")}return b.prototype.retrievePreferences=function(a){return this.documentStorage.getItem(a)},b.prototype.savePreference=function(a,b){return this.documentStorage.setItem(a,b)},b.prototype.deletePreference=function(a){return this.documentStorage.removeItem(a)},b}();return c=__decorate([b.singleton],c)});
define('system/diagnostics/log-service',["require","exports","lodash","jquery","system/lang/object","system/lang/ioc","system/data/document-storage","system/data/client-preferences","./log-message","./logger"],function(require,exports,a,b,c,d,e,f,g,h){"use strict";var i={id:"log_config",level:h.levels.error,size:1e3},j=function(){function d(){this.clientPreferences=c.resolve(f),this.logStorage=new e("log"),this.messages=[]}return d.prototype.initializeLogConfig=function(a){return void 0===a&&(a=b.Deferred()),k(this).done(l.bind(null,this,a)),a.promise()},d.prototype.trimLog=function(){for(;this.messages.length>i.size;)this.messages.shift();return b.Deferred().resolve().promise()},d.prototype.saveConfig=function(b){return b=a.extend({},i,b),this.clientPreferences.savePreference(i.id,b)},d.prototype.saveMessage=function(a){var c=b.Deferred();this.messages.push(a.toJson()),this.trimLog(),this.logStorage.setItem("messages",this.messages).done(c.resolve.bind(c)).fail(o)},d.prototype.getAllMessages=function(){var a;try{
return a=this.messages.slice(0),a.reverse(),a=g.fromJsonCollection(a||[]),Promise.resolve(a)}catch(a){return console.error(a),Promise.reject(a)}},d.prototype.clearLog=function(){return this.messages=[],Promise.resolve(this.logStorage.setItem("messages",this.messages))},d}();j=__decorate([d.singleton],j);function k(a){return a.clientPreferences.retrievePreferences(i.id)}function l(a,b,c){c?n(a).done(b.resolve.bind(b,c)):a.saveConfig(i).done(m.bind(null,a,b,i))}function m(a,b,c){n(a).done(b.resolve.bind(b,c))}function n(a){return a.logStorage.getItem("messages").done(function(b){b&&(a.messages=b)}).fail(console.error)}function o(a,b){console.error(b),a.reject(b)}return j});
define('system/diagnostics/log-manager',["require","exports","lodash","system/lang/object","./logger","./log-service","system/lang/event"],function(require,exports,a,b,c,d,e){"use strict";var f=function(){function f(){this.defaultLevel=c.levels.error,this.level=this.defaultLevel,this.loggers={},this.nestedContexts=[],this.messageCache=[],this.messageLogged=new e,this.messageLogged.add(this.cacheMessage,this)}return f.prototype.cacheMessage=function(a,b){b.context=this.currentContext(),this.messageCache.push(b)},f.prototype.initialize=function(){var a=b.resolve(d);return a.trimLog(),a.initializeLogConfig().done(g.bind(null,this)).fail(h)},f.prototype.saveConfig=function(){return b.resolve(d).saveConfig().fail(h)},f.prototype.getLogger=function(a){var b=this.loggers[a];return b||(b=new c(a,this.messageLogged,this.level),this.loggers[a]=b),b},f.prototype.setLevel=function(b){this.level=b,a.each(this.loggers,function(a){return a.level=b})},f.prototype.pushContext=function(a){this.nestedContexts.push(k(a))},
f.prototype.popContext=function(){this.nestedContexts.pop()},f.prototype.currentContext=function(){return this.nestedContexts[this.nestedContexts.length-1]},f}();function g(a,b){a.setLevel(c.levels[b.level]),i(a),a.messageLogged.add(function(b,c){c.context=a.currentContext(),j(a,c)},a)}function h(a){console.error(a)}function i(b){b.messageLogged.remove(b.cacheMessage,b),a.each(b.messageCache,j.bind(null,b))}function j(a,c){b.resolve(d).saveMessage(c)}function k(b){return a.isObject(b)?JSON.stringify(b):b.toString()}return new f});
define('system/hardware/device',["require","exports","detect"],function(require,exports){"use strict";var a=require("detect");return function(){function b(b){this.userAgent=b||navigator.userAgent,this.parsedUserAgent=a.parse(this.userAgent)}return b.prototype.isMobile=function(){return this.isMobileApp()},b.prototype.isMobileApp=function(){return void 0!==window.cordova},b.prototype.isWindowsApp=function(){return!!window.MSApp},b.prototype.isAndroid=function(){return/Android/i.test(this.userAgent)},b.prototype.isIOS=function(){return/iPhone|iPad|iPod/i.test(this.userAgent)},b.prototype.isIE=function(){return/Trident/i.test(this.userAgent)&&!/MSIE/i.test(this.userAgent)},b.prototype.isEdge=function(){return/EDGE/i.test(this.userAgent)},b.prototype.isChromeOnAndroid=function(){return!!this.canReadBrowserAndOS()&&("CHROME"===this.parsedUserAgent.browser.family.toUpperCase()&&"ANDROID"===this.parsedUserAgent.os.family.toUpperCase())},b.prototype.canReadBrowserAndOS=function(){
return!(!this.parsedUserAgent.browser.family||!this.parsedUserAgent.os.family)},b.prototype.innerWidth=function(){return window.innerWidth},b.prototype.outerWidth=function(){return window.outerWidth},b.prototype.screenWidth=function(){return window.screen.width},b.prototype.innerHeight=function(){return window.innerHeight},b.prototype.pixelRatio=function(){return window.devicePixelRatio},b.prototype.deviceInnerWidth=function(){return this.roundUp(this.innerWidth()*this.pixelRatio())},b.prototype.roundUp=function(a){return Math.ceil(a)},b.prototype.deviceOuterWidth=function(){return this.roundUp(this.outerWidth()*this.pixelRatio())},b.prototype.deviceScreenWidth=function(){return this.roundUp(this.screenWidth()*this.pixelRatio())},b.prototype.isChrome=function(){return/Chrome/i.test(this.userAgent)},b}()});
define('system/mobile/device-connectivity',["require","exports","system/lang/ioc","system/lang/ioc","system/lang/ioc","application/application-events","bluebird","ramda"],function(require,exports,a,b,c,d,e,f){"use strict";var g=function(){function a(){this.userSetToOffline=!1,this.applicationEvents=c.resolve(d)}return a.prototype.getManualOfflineStatus=function(){return this.userSetToOffline},a.prototype.setManualOfflineStatus=function(a){this.userSetToOffline=a,this.hasPredixSDKInstalled()?this.queryConnectivity().catch(this.handleConnectivityFailure.bind(null,this)).then(this.handleConnectivityResponse.bind(null,this)):this.applicationEvents.connectionChanged.raise(this,{connected:!this.userSetToOffline})},a.prototype.hasPredixSDKInstalled=function(){return!!window.PredixSDK},a.prototype.queryConnectivity=function(){return new e(function(a,b){window.PredixSDK.queryConnectivity(a,b)})},a.prototype.handleConnectivityResponse=function(a,b){var c=window;a.deviceIsOnline(b)&&(b=a.resetConnectivityWithToggle(a,b)),
c.broadcaster.fireEvent("PredixSDK.ReachabilityChanged",{ReachabilityStatus:b})},a.prototype.deviceIsOnline=function(a){return f.contains("Online",a)},a.prototype.resetConnectivityWithToggle=function(a,b){b=a.getStateAsArray(b);var c=f.indexOf("Online",b);return a.userSetToOffline===!0&&(b[c]="Offline"),b},a.prototype.getStateAsArray=function(a){return"string"==typeof a&&(a=a.split(",")),a},a.prototype.handleConnectivityFailure=function(a){console.log("An error occurred")},a}();return g=__decorate([a.singleton,b.dependsOn(d)],g)});
define('system/http/predix-mobile-ajax-client',["require","exports","system/diagnostics/log-manager","application/application-context","system/mobile/device-connectivity","system/lang/object","ramda"],function(require,exports,a,b,c,d,e){"use strict";var f=a.getLogger("system/http/ajax-client"),g=59900,h={timeout:g,headers:{"Content-Type":"application/json",timeout:g}},i="apm",j="api/core/utility/unauthorizedping",k="",l=function(){function a(){}return a.prototype.baseUrl=function(){return k+i+"/"},a.useSecureConnection=function(a){},a.setServer=function(a){k=a},a.addAjaxOption=function(a,b){var c={};c[a]=b,$.extend(h,c)},a.clearHeaders=function(){},a.prototype.url=function(a){return a=this.trimSlash(a),a=k+i+"/"+a,a=encodeURI(decodeURI(a))},a.prototype.get=function(a,b){return f.info("ajax GET",a),a=this.url(a),m("GET","text",b,{},a)},a.prototype.post=function(a,b,c){return f.info("ajax POST",b,c),a=this.url(a),m("POST","text",c,b,a)},a.prototype.put=function(a,b,c){return f.info("ajax PUT",b,c),a=this.url(a),
m("PUT","text",c,b,a)},a.prototype.delete=function(a,b){return f.info("ajax DELETE",a),a=this.url(a),m("DELETE","text",b,{},a)},a.prototype.getBinary=function(a,b){return f.info("ajax binary GET",a),a=this.url(a),m("GET","blob",b,{},a)},a.isMultiTenant=function(){return!!window.nav},a.prototype.trimSlash=function(a){return a&&"/"===a.charAt(0)&&(a=a.substring(0).slice(1)),a},a}();function m(a,b,f,g,i){var j=$.extend(!0,{},h,f),k=$.Deferred(),l=window,m=new l.PredixRequest(a,i),p=d.resolve(c);return m.responseType=b,q(m,j),m.onComplete=x.bind(null,k.resolve.bind(k),k.reject.bind(k),a,i),m.onError=y.bind(null,k.reject.bind(k),i),m.beforeSend=o(m,p.getManualOfflineStatus()),"GET"===a?m.send():f&&!e.isNil(f.data)?m.send(f.data):m.send(g),n(k,m)}function n(a,b){var c=a.promise();return c.abort=b.abort,c}function o(a,b){return b?p.bind(null,a):null}function p(a){console.log("Aborting"),a.abort(),a.onComplete({statusCode:-1,error:"error"})}function q(a,b){
e.mapObjIndexed(r.bind(null,a),b.headers)}function r(a,b,c){a.setRequestHeader(c,b)}function s(a){return a>=200&&a<300||304===a}function t(a,b,c,d){if(null===b.data||""===b.data)try{c(null,null,a)}catch(a){console.log("error from success callback for url: "+d),console.log("response: "+JSON.stringify(b)),console.log("error: "+a)}else if("string"==typeof b.data)try{c(JSON.parse(b.data),null,a)}catch(a){console.log("error from success callback for url: "+d),console.log("response: "+JSON.stringify(b)),console.log("error: "+a)}else try{c(b.data,null,a)}catch(c){console.log("error from success callback for url: "+d),console.log("response: "+JSON.stringify(b),null,a),console.log("error: "+c)}}function u(a,b,c,d){var e="error";try{console.log("====jqXHR: "+JSON.stringify(a)),console.log("====text: "+e),console.log("====Error thrown "+d+" === "+b),c(a,e,b)}catch(a){console.log("error from fail callback for url: "+d),console.log("error: "+a)}}function v(a){
w(a,j)||(b.connectionStatus.lastResponse=new Date)}function w(a,b){return a.indexOf(b)>-1}function x(a,b,c,d,e){console.log("====SUCCESS "+c+" RESPONSE FROM URL: "+d+" === "+e.data),v(d);var f=s(e.statusCode),g={status:e.statusCode};f===!0?t(g,e,a,d):u(g,e.data,b,d)}function y(a,b,c){console.log("====FAIL RESPONSE FROM URL: "+b+" === "+JSON.stringify(c)),u({status:c.statusCode,statusText:c.error},c.error,a,b)}return l});
define('system/http/binary-transport',['require','jquery'],function(require){"use strict";require("jquery").ajaxTransport("+binary",function(a,b,c){if(window.FormData&&(a.dataType&&"binary"===a.dataType||a.data&&(window.ArrayBuffer&&a.data instanceof ArrayBuffer||window.Blob&&a.data instanceof Blob)))return{send:function(b,c){var d=new XMLHttpRequest,e=a.url,f=a.type,g=a.async||!0,h=a.responseType||"blob",i=a.data||null,j=a.username||null,k=a.password||null;d.addEventListener("load",function(){var b={};b[a.dataType]=d.response,c(d.status,d.statusText,b,d.getAllResponseHeaders())}),d.open(f,e,g,j,k);for(var l in b)b.hasOwnProperty(l)&&d.setRequestHeader(l,b[l]);d.responseType=h,d.send(i)},abort:function(){c.abort()}}})});
define('system/http/ajax-client',["require","exports","lodash","jquery","system/lang/ioc","application/application-events","system/diagnostics/log-manager","system/hardware/device","system/mobile/device-connectivity","system/http/predix-mobile-ajax-client","system/lang/object","./binary-transport"],function(require,exports,a,b,c,d,e,f,g,h,i){"use strict";require("./binary-transport");var j=k()?59900:3e5;function k(){return!!window.nav}var l=e.getLogger("system/http/ajax-client"),m={contentType:"application/json",dataType:"json",cache:!0,timeout:j,headers:{timeout:j}},n={useSecureConnection:"https:"===location.protocol,server:null},o=function(){function c(){}return c.useSecureConnection=function(a){n.useSecureConnection=a,l.info("connectionOptions.useSecureConnection",a)},c.setServer=function(a){c.useSecureConnection(r(a)),a=v(a),a=w(a),n.server=a,l.info("connectionOptions.server",a)},c.server=function(){return n.server},c.secureConnection=function(){return n.useSecureConnection},c.addHeader=function(a,c){
var d={};d[a]=c,m.headers=m.headers||{},b.extend(m.headers,d),l.info("adding to ajaxOptions.headers",a,c)},c.clearHeaders=function(){m.headers=void 0,l.info("ajaxOptions.headers cleared")},c.headers=function(){return b.extend({},m.headers)},c.promise=function(a,b){var c=a.promise();return c.request={abort:b.abort},c},c.prototype.url=function(a){return q(this,a)},c.prototype.get=function(a,c){a=q(this,a);var d="GET",e=b.extend({},m,{url:a,type:d});return l.info("ajax GET",e.url),y(e,c)},c.prototype.getBinary=function(a,c){a=this.url(a);var d="GET",e="binary",f=!1,g=b.extend({},m,{url:a,type:d,dataType:e,processData:f});return delete g.contentType,l.info("ajax binary GET",g.url),y(g,c)},c.prototype.post=function(c,d,e){c=q(this,c),d=a.isObject(d)?JSON.stringify(d):d;var f="POST",g=b.extend({},m,{url:c,type:f,data:d});return l.info("ajax POST",d,e),y(g,e)},c.prototype.put=function(c,d,e){return l.info("ajax PUT",d,e),c=q(this,c),y(b.extend({},m,{url:c,type:"PUT",
data:a.isObject(d)?JSON.stringify(d):d}),e)},c.prototype.delete=function(a,c){a=q(this,a);var d=b.extend({},m,{url:a,type:"DELETE"});return l.info("ajax DELETE",d.url),y(d,c)},c.isMultiTenant=function(){return k()},c.prototype.protocol=function(){return n.useSecureConnection?"https":"http"},c.prototype.baseUrl=function(){return z(this)},c}();o=__decorate([c.dependsOn(d)],o),o.factory=function(){return p()?new h:new o};function p(){return!!window.PredixSDK}function q(a,b){return b=(new f).isMobileApp()?z(a)+"meridium/"+A(b):A(b)}function r(a){return s(a)?u(a):x()}function s(a){return!!a&&(t(a)||u(a))}function t(a){return a.toLowerCase().indexOf("http://")>-1}function u(a){return a.toLowerCase().indexOf("https://")>-1}function v(a){return a?a.toLowerCase().replace("https://","").replace("http://",""):a}function w(a){return a?a.toString().replace(/\//g,""):a}function x(){return"https:"===location.protocol}function y(a,c){var d=i.resolve(f),e=i.resolve(g)
;return d.isMobile()&&e.getManualOfflineStatus()?b.ajax({beforeSend:function(a){a.abort("error")}}):b.ajax(b.extend({},a,c))}function z(a){return n.server?a.protocol()+"://"+n.server+"/":""}function A(a){return a&&"/"===a.charAt(0)&&(a=a.substring(0).slice(1)),a}return o});
define('system/lang/converter',['require','system/text/parser','globalize'],function(require){"use strict";var a=require("system/text/parser"),b=require("globalize");function c(){}c.prototype.toNullable=function a(b){return b?b:null},c.prototype.toObject=function a(b,c){return b?b:c},c.prototype.toString=function a(b,c){return void 0===b||null===b?void 0!==c?c:"":b.toString()},c.prototype.toNullableString=function a(b){return c.prototype.toString(b,null)},c.prototype.toBoolean=function a(b,c){return void 0!==b&&(b===c||b===!0)},c.prototype.toNullableBoolean=function a(b,c){return void 0!==c||void 0!==b&&null!==b?b===c||b===!0:null},c.prototype.toInteger=function a(b,c){var d=parseInt(b,10);return c=c||0,isNaN(d)?c:d},c.prototype.toFloat=function a(b,c){var d=parseFloat(b);return arguments.length<2&&(c=0),isNaN(d)?c:d},c.prototype.toDate=function a(b,c,e){return d(b,c,e)},c.prototype.toNullableDate=function a(b,c){return d(b,c,null)};function d(b,c,d){return c=c||"yyyy-MM-ddTHH:mm:ss.fff",d=Object.defaultValue(d,null),
null===b||void 0===b?d:b instanceof Date?b:a.parseDate(b,c)||a.parseDate(b,"yyyy-MM-ddTHH:mm:ss.fff")||d}return c.prototype.toDateString=function a(c,d){return d=d||"S",b.format(c,d)},c.prototype.toNullableInteger=function a(b){var c=parseFloat(b);return isNaN(c)?null:c},c.prototype.toNullableFloat=function a(b){return this.toFloat(b,null)},new c});
define('query/services/dto/rowset-dto',['require','system/lang/converter'],function(require){"use strict";var a=require("system/lang/converter");function b(b){b=b||{},this.columns=a.toObject(b.columns),this.familyMappings=a.toObject(b.familyMappings),this.rowColumns=a.toObject(b.rowColumns),this.rows=a.toObject(b.rows),this.totalRows=a.toInteger(b.totalRows)}return b.fromDataCollection=function a(c){if(c){var d,e=[];for(d=0;d<c.length;d++)e[e.length]=new b(c[d]);return e}},b});
define('query/services/dto/column-dto',['require','system/lang/converter'],function(require){"use strict";var a=require("system/lang/converter");function b(b){b=b||{},this.caption=a.toString(b.caption),this.defaultCaption=a.toString(b.defaultCaption),this.dataType=a.toString(b.dataType),this.isInactive=a.toBoolean(b.isInactive),this.id=a.toString(b.id)}return b.fromDataCollection=function a(c){if(c){var d,e=[];for(d=0;d<c.length;d++)e[e.length]=new b(c[d]);return e}},b});
define('query/services/dto/table-design-dto',['require','system/lang/converter','./column-dto'],function(require){"use strict";var a=require("system/lang/converter"),b=require("./column-dto");function c(c){c=c||{},c.showAllFields||c.showAllFields===!1||(c.showAllFields=!0),c.showDataFields||c.showDataFields===!1||(c.showDataFields=!1),c.showInactiveFields||c.showInactiveFields===!1||(c.showInactiveFields=!1),c.showSystemFields||c.showSystemFields===!1||(c.showSystemFields=!1),this.alias=a.toString(c.alias),this.caption=a.toString(c.caption),this.defaultCaption=a.toString(c.defaultCaption),this.datasheetId=a.toString(c.datasheetId),this.id=a.toString(c.id),this.key=a.toString(c.key),this.layoutX=a.toInteger(c.layoutX),this.layoutY=a.toInteger(c.layoutY),this.name=a.toString(c.name),this.queryColumns=b.fromDataCollection(c.queryColumns),this.showAllFields=a.toBoolean(c.showAllFields),this.showDataFields=a.toBoolean(c.showDataFields),this.showInactiveFields=a.toBoolean(c.showInactiveFields),this.showSystemFields=a.toBoolean(c.showSystemFields),
this.storedQueryPath=a.toString(c.storedQueryPath),this.tableType=a.toString(c.tableType),this.queryColumns&&(this.queryColumns=this.queryColumns.sort(d))}c.fromDataCollection=function a(b){if(b){var d,e=[];for(d=0;d<b.length;d++)e[e.length]=new c(b[d]);return e}};function d(a,b){var c=a.caption.toLowerCase(),d=b.caption.toLowerCase(),e=!1,f=!1;return c.indexOf("[")===-1&&c.indexOf("{")===-1||(e=!0,c=c.slice(1,c.length-1)),d.indexOf("[")===-1&&d.indexOf("{")===-1||(f=!0,d=d.slice(1,d.length-1)),e&&f||!e&&!f?c===d?0:c<d?-1:1:e?-1:1}return c});
define('query/services/dto/query-criteria-dto',['require','lodash','system/lang/converter'],function(require){"use strict";var a=require("lodash"),b=require("system/lang/converter");function c(b){b=b||{},this.expressions=a.isArray(b.expressions)?b.expressions:[b.expressions]}return c.fromDataCollection=function a(b){if(b){var d,e=[];for(d=0;d<b.length;d++)e[e.length]=b[d]?new c(b[d]):null;return e}},c});
define('query/services/dto/column-design-dto',['require','lodash','system/lang/converter','./column-dto','./query-criteria-dto'],function(require){"use strict";var a=require("lodash"),b=require("system/lang/converter"),c=require("./column-dto"),d=require("./query-criteria-dto");function e(e){e=e||{},this.alias=b.toString(e.alias,null),this.caption=b.toString(e.caption,null),this.defaultCaption=b.toString(e.defaultCaption,null),this.criterias=a.isArray(e.criterias)?e.criterias:[e.criterias],this.crosstab=b.toString(e.crosstab),this.dataType=b.toString(e.dataType),this.display=b.toBoolean(e.display),this.expressionText=b.toString(e.expressionText),this.hyperlink=b.toString(e.hyperlink),this.id=b.toString(e.id,null),this.include=b.toBoolean(e.include),this.key=b.toString(e.key),this.layoutWidth=b.toInteger(e.layoutWidth,40),this.resultFilterExpression=b.toString(e.resultFilterExpression),this.sortIndex=b.toInteger(e.sortIndex),this.sortOrder=b.toString(e.sortOrder),this.tableDesignKey=b.toString(e.tableDesignKey),this.total=b.toString(e.total),this.resultSortIndex=b.toInteger(e.resultSortIndex),
this.resultSortOrder=b.toString(e.resultSortOrder),this.appendTo=new c(e.appendTo),this.updateTo=e.updateTo,this.simpleCriteria=d.fromDataCollection(e.simpleCriteria)}return e.fromDataCollection=function a(b){if(b){var c,d=[];for(c=0;c<b.length;c++)d[d.length]=new e(b[c]);return d}},e});
define('query/services/dto/operand-dto',['require','system/lang/converter'],function(require){"use strict";var a=require("system/lang/converter");function b(b){b=b||{},this.tableDesignKey=a.toString(b.tableDesignKey),this.columnId=a.toString(b.columnId),this.charOperand=a.toString(b.charOperand)}return b.fromDataCollection=function a(c){if(c){var d,e=[];for(d=0;d<c.length;d++)e[e.length]=new b(c[d]);return e}},b});
define('query/services/dto/condition-dto',['require','system/lang/converter','./operand-dto'],function(require){"use strict";var a=require("system/lang/converter"),b=require("./operand-dto");function c(c){c=c||{},this.leftOperand=new b(c.leftOperand),this.operator=a.toString(c.operator),this.rightOperand=new b(c.rightOperand),this.nextOperator=a.toString(c.nextOperator)}return c.fromDataCollection=function a(b){if(b){var d,e=[];for(d=0;d<b.length;d++)e[e.length]=new c(b[d]);return e}},c});
define('query/services/dto/join-design-dto',['require','system/lang/converter','./condition-dto'],function(require){"use strict";var a=require("system/lang/converter"),b=require("./condition-dto");function c(c){c=c||{},this.conditions=b.fromDataCollection(c.conditions),this.isMiJoin=a.toBoolean(c.isMiJoin),this.joinSucc=a.toBoolean(c.joinSucc),this.joinType=a.toString(c.joinType),this.key=a.toInteger(c.key),this.leftDesignKey=a.toInteger(c.leftDesignKey),this.relDesignKey=a.toInteger(c.relDesignKey),this.rightDesignKey=a.toInteger(c.rightDesignKey),this.joinDesignKey=a.toInteger(c.joinDesignKey)}return c.fromDataCollection=function a(b){if(b){var d,e=[];for(d=0;d<b.length;d++)e[e.length]=new c(b[d]);return e}},c});
define('query/services/dto/parameter-value-dto',['require','system/lang/converter'],function(require){"use strict";var a=require("system/lang/converter");function b(b){b=b||{},this.value=a.toString(b.value),this.displayValue=a.toString(b.displayValue)}return b.fromDataCollection=function a(c){if(c){var d,e=[];for(d=0;d<c.length;d++)e[e.length]=new b(c[d]);return e}},b});
define('query/services/dto/parameter-design-dto',['require','lodash','system/lang/converter','./parameter-value-dto'],function(require){"use strict";var a=require("lodash"),b=require("system/lang/converter"),c=require("./parameter-value-dto");function d(a){a=a||{},this.id=b.toString(a.id,null),this.dataType=b.toString(a.dataType),this.caption=b.toString(a.caption),this.defaultValue=b.toNullableString(a.defaultValue),this.isHidden=b.toBoolean(a.isHidden),this.familyId=b.toString(a.familyId),this.fieldId=b.toString(a.fieldId),this.isMultiValue=b.toBoolean(a.isMultiValue),this.list=b.toObject(a.list,[]),this.localizedCaption=b.toString(a.localizedCaption),this.codeTable=b.toString(a.codeTable),this.referenceCode=b.toString(a.referenceCode),this.referenceTable=b.toString(a.referenceTable),this.query=b.toString(a.query),this.isExclusive=b.toBoolean(a.isExclusive),this.parmValues=c.fromDataCollection(a.parmValues),this.parmPrompts=b.toObject(a.parmPrompts,[]),this.isAssetHierarchy=b.toBoolean(a.isAssetHierarchy),this.assetHierarchyCaption=b.toString(a.assetHierarchyCaption),
this.all=b.toBoolean(a.all),this.child=b.toBoolean(a.child),this.parent=b.toBoolean(a.parent),this.current=b.toBoolean(a.current),this.isGis=b.toBoolean(a.isGis),this.format=b.toBoolean(a.format),this.alias=b.toString(a.alias),this.distance=b.toString(a.distance),this.entyKey=b.toBoolean(a.entyKey),this.justTheDate=b.toBoolean(a.justTheDate)}return d.fromDataCollection=function a(b){if(b){var c,e=[];for(c=0;c<b.length;c++)e[e.length]=new d(b[c]);return e}},d.prototype.copyPromptValues=function b(c){this.parmPrompts=a.map(c.parmPrompts)},d});
define('query/services/dto/parameter-container-dto',['require','lodash','system/lang/converter','./parameter-design-dto'],function(require){"use strict";var a=require("lodash"),b=require("system/lang/converter"),c=require("./parameter-design-dto");function d(a){a=a||{},this.hasDependencies=b.toBoolean(a.hasDependencies),this.parmDesigns=c.fromDataCollection(a.parmDesigns)}d.prototype.copyPromptValues=function b(c){var d=e.bind(null,c);a.forEach(this.parmDesigns,d)};function e(b,c){var d=c.copyPromptValues.bind(c);a(b.parmDesigns).filter({id:c.id}).take(1).forEach(d)}return d});
define('query/services/dto/query-container-dto',['require','system/lang/converter','./table-design-dto','./column-design-dto','./join-design-dto','./parameter-container-dto'],function(require){"use strict";var a=require("system/lang/converter"),b=require("./table-design-dto"),c=require("./column-design-dto"),d=require("./join-design-dto"),e=require("./parameter-container-dto");function f(f){f=f||{},this.columnDesigns=c.fromDataCollection(f.columnDesigns),this.isCaseInsensitive=a.toBoolean(f.isCaseInsensitive),this.isChanged=a.toBoolean(f.isChanged),this.isDeleteForce=a.toBoolean(f.isDeleteForce),this.isDistinct=a.toBoolean(f.isDistinct),this.isFormatted=a.toBoolean(f.isFormatted),this.isTop=a.toBoolean(f.isTop),this.isUomVisible=a.toBoolean(f.isUomVisible),this.joinDesigns=d.fromDataCollection(f.joinDesigns),this.pageSize=a.toInteger(f.pageSize),this.parmContainer=new e(f.parmContainer),this.queryText=a.toString(f.queryText),this.queryType=a.toString(f.queryType),this.showTotals=a.toBoolean(f.showTotals),this.sqlChanged=a.toBoolean(f.sqlChanged),this.designChanged=a.toBoolean(f.designChanged),this.startPage=a.toInteger(f.startPage),
this.tableDesigns=b.fromDataCollection(f.tableDesigns),this.topRows=a.toInteger(f.topRows),this.uniqueId=a.toString(f.uniqueId),this.catalogPath=a.toString(f.catalogPath),this.asyncQueryRowLimit=a.toInteger(f.asyncQueryRowLimit),this.tableDesigns&&this.tableDesigns.sort(g),this.appendSource=new b(f.appendSource),this.predecessorSource=new b(f.predecessorSource),this.successorSource=new b(f.successorSource),this.designStatus=f.designStatus,this.loadStatus=f.loadStatus}function g(a,b){var c=a.caption.toLowerCase(),d=b.caption.toLowerCase();return c.indexOf("[")===-1&&c.indexOf("{")===-1||(c=c.slice(1,c.length-1)),d.indexOf("[")===-1&&d.indexOf("{")===-1||(d=d.slice(1,d.length-1)),c===d?0:c<d?-1:1}return f});
define('query/services/dto/query-result-dto',[],function(){"use strict";function a(){this.rowCount=0,this.columns=[],this.rows=[],this.timeoutExceeded=!1}return a});
define('system/lang/private',["require","exports"],function(require,exports){"use strict";function a(a){return a.__private__=a.__private__||{},a.__private__}return a});
define('query/model/query-result',['require','ramda','system/lang/private','mi-assert'],function(require){"use strict";var a=require("ramda"),b=require("system/lang/private"),c=require("mi-assert");function d(){b(this).rowCount=0,b(this).columns=[],b(this).rows=[],b(this).timeoutExceeded=!1}var e=d.prototype;e.getRowCount=function(){return b(this).rowCount},e.setRowCount=function(a){c.isNumber(a,"rowCount"),b(this).rowCount=a},e.getColumns=function(){return b(this).columns},e.setColumns=function(a){c.isArray(a,"columns"),b(this).columns=a},e.getVisibleColumns=function(){var c=b(this).columns;return a.filter(f,c)};function f(a){return a.getIsDisplayed()}return e.getRows=function(){return b(this).rows},e.setRows=function(a){c.isArray(a,"rows"),b(this).rows=a},e.getTimeoutExceeded=function(){return b(this).timeoutExceeded},e.setTimeoutExceeded=function(a){c.isBoolean(a,"timeoutExceeded"),b(this).timeoutExceeded=a},d});
define('query/services/dto/column-result-dto',[],function(){"use strict";function a(){this.typeName="",this.alias="",this.localizedAlias="",this.isDisplayed=!0,this.fieldDataType="",this.hyperlinkFormat="",this.columnDesignKey=-1,this.fieldKey="",this.fieldId="",this.caption="",this.defaultCaption="",this.displayUomCaption="",this.displayUomDefaultCaption="",this.storageUomCaption="",this.storageUomDefaultCaption=""}return a});
define('query/model/column-result',['require','system/lang/private','mi-assert'],function(require){"use strict";var a=require("system/lang/private"),b=require("mi-assert");function c(){a(this).typeName="",a(this).alias="",a(this).localizedAlias="",a(this).isDisplayed=!0,a(this).fieldDataType="",a(this).hyperlinkFormat="",a(this).columnDesignKey=-1,a(this).fieldKey="",a(this).fieldId="",a(this).caption="",a(this).defaultCaption="",a(this).displayUomCaption="",a(this).displayUomDefaultCaption="",a(this).storageUomCaption="",a(this).storageUomDefaultCaption="",a(this).format=""}var d=c.prototype;return d.getTypeName=function(){return a(this).typeName},d.setTypeName=function(c){b.isString(c,"typeName"),a(this).typeName=c},d.getAlias=function(){return a(this).alias},d.setAlias=function(c){b.isString(c,"alias"),a(this).alias=c},d.getLocalizedAlias=function(){return a(this).localizedAlias},d.setLocalizedAlias=function(c){b.isString(c,"localizedAlias"),a(this).localizedAlias=c},d.getIsDisplayed=function(){return a(this).isDisplayed},d.setIsDisplayed=function(c){
b.isBoolean(c,"isDisplayed"),a(this).isDisplayed=c},d.getFieldDataType=function(){return a(this).fieldDataType},d.setFieldDataType=function(c){b.isString(c,"fieldDataType"),a(this).fieldDataType=c},d.getHyperlinkFormat=function(){return a(this).hyperlinkFormat},d.setHyperlinkFormat=function(c){b.isString(c,"hyperlinkFormat"),a(this).hyperlinkFormat=c},d.getFormat=function(){return a(this).format},d.setFormat=function(c){b.isString(c,"format"),a(this).format=c},d.getColumnDesignKey=function(){return a(this).columnDesignKey},d.setColumnDesignKey=function(c){b.isNumber(c,"columnDesignKey"),a(this).columnDesignKey=c},d.getFieldKey=function(){return a(this).fieldKey},d.setFieldKey=function(c){b.isString(c,"fieldKey"),a(this).fieldKey=c},d.getFieldId=function(){return a(this).fieldId},d.setFieldId=function(c){b.isString(c,"fieldId"),a(this).fieldId=c},d.getCaption=function(){return a(this).caption},d.setCaption=function(c){b.isString(c,"caption"),a(this).caption=c},
d.getDefaultCaption=function(){return a(this).defaultCaption},d.setDefaultCaption=function(c){b.isString(c,"defaultCaption"),a(this).defaultCaption=c},d.getDisplayUomCaption=function(){return a(this).displayUomCaption},d.setDisplayUomCaption=function(c){b.isString(c,"displayUomCaption"),a(this).displayUomCaption=c},d.getDisplayUomDefaultCaption=function(){return a(this).displayUomDefaultCaption},d.setDisplayUomDefaultCaption=function(c){b.isString(c,"displayUomDefaultCaption"),a(this).displayUomDefaultCaption=c},d.getStorageUomCaption=function(){return a(this).storageUomCaption},d.setStorageUomCaption=function(c){b.isString(c,"storageUomCaption"),a(this).storageUomCaption=c},d.getStorageUomDefaultCaption=function(){return a(this).storageUomDefaultCaption},d.setStorageUomDefaultCaption=function(c){b.isString(c,"storageUomDefaultCaption"),a(this).storageUomDefaultCaption=c},d.setFormat=function(c){b.isString(c,"format"),a(this).format=c},c});
define('query/adapters/column-result-adapter',['require','ramda','mi-assert','system/lang/converter','../services/dto/column-result-dto','../model/column-result'],function(require){"use strict";var a=require("ramda"),b=require("mi-assert"),c=require("system/lang/converter"),d=require("../services/dto/column-result-dto"),e=require("../model/column-result");function f(a){var e=new d;return b.isObject(a,"data"),e.typeName=c.toString(a.typeName),e.alias=c.toString(a.alias),e.localizedAlias=c.toString(a.localizedAlias),e.isDisplayed=c.toBoolean(a.isDisplayed),e.fieldDataType=c.toString(a.fieldDataType),e.hyperlinkFormat=c.toString(a.hyperlink),e.columnDesignKey=c.toInteger(a.columnDesignKey,-1),e.fieldKey=c.toString(a.fieldKey),e.fieldId=c.toString(a.fieldId),e.caption=c.toString(a.caption),e.defaultCaption=c.toString(a.defaultCaption),e.displayUomCaption=c.toString(a.displayUomCaption),e.displayUomDefaultCaption=c.toString(a.displayUomDefaultCaption),e.storageUomCaption=c.toString(a.storageUomCaption),e.storageUomDefaultCaption=c.toString(a.storageUomDefaultCaption),e.format=c.toString(a.format),e}function g(a){var c=new e
;return b.instanceOf(a,d,"dto"),c.setTypeName(a.typeName),c.setAlias(a.alias),c.setLocalizedAlias(a.localizedAlias),c.setIsDisplayed(a.isDisplayed),c.setFieldDataType(a.fieldDataType),c.setHyperlinkFormat(a.hyperlinkFormat),c.setColumnDesignKey(a.columnDesignKey),c.setFieldKey(a.fieldKey),c.setFieldId(a.fieldId),c.setCaption(a.caption),c.setDefaultCaption(a.defaultCaption),c.setDisplayUomCaption(a.displayUomCaption),c.setDisplayUomDefaultCaption(a.displayUomDefaultCaption),c.setStorageUomCaption(a.storageUomCaption),c.setStorageUomDefaultCaption(a.storageUomDefaultCaption),c.setFormat(a.format),c}return{deserialize:f,deserializeArray:a.map(f),toModel:g,toModelArray:a.map(g)}});
define('query/services/dto/row-dto',[],function(){"use strict";function a(){this.cells=[]}return a});
define('query/model/row',['require','ramda','system/lang/private','mi-assert'],function(require){"use strict";var a=require("ramda"),b=require("system/lang/private"),c=require("mi-assert");function d(){b(this).cells=[]}var e=d.prototype;e.getCells=function(){return b(this).cells},e.setCells=function(a){c.isArray(a,"cells"),b(this).cells=a},e.getVisibleCells=function(){var c=b(this).cells;return a.filter(f,c)};function f(a){return a.isVisible()}return d});
define('query/services/dto/cell-dto',[],function(){"use strict";function a(){this.dbValue=null,this.value="",this.utcValue="",this.backColor=""}return a});
define('system/lang/string',[],function(){"use strict";String.prototype.toStaticHTML=function(){return window.toStaticHTML?window.toStaticHTML(this).trim():this.trim()},String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)},String.prototype.startsWith=function(a,b){void 0===b&&(b=!0);var c=b?a.toLowerCase():a,d=a.length;return(b?this.toLowerCase():this).substr(0,d)===c},String.prototype.format=function(){var a=arguments,b=/\{(\d|\d\d)\}/g,c=/\d+/;return this.replace(b,function(b){var d=1*b.match(c)[0];return void 0!==a[d]?a[d]:""===a[d]?"":b})},String.isNullOrWhitespace=function(a){return void 0===a||null===a||("string"!=typeof a&&(a=a.toString()),""===a.trim())},String.compare=function(a,b){return void 0!==a&&null!==a&&void 0!==b&&null!==b&&a.toLocaleLowerCase().localeCompare(b.toLocaleLowerCase())},String.escapeRegex=function(a){return String(a).replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")},String.prototype.endsWith=function(a,b){
var c=this.toString();("number"!=typeof b||!isFinite(b)||Math.floor(b)!==b||b>c.length)&&(b=c.length),b-=a.length;var d=c.lastIndexOf(a,b);return d!==-1&&d===b}});
define('query/model/cell',['require','system/lang/private','mi-assert','./column-result','system/lang/converter','system/text/formatter','application/application-context','system/lang/string'],function(require){"use strict";var a=require("system/lang/private"),b=require("mi-assert"),c=require("./column-result"),d=require("system/lang/converter"),e=require("system/text/formatter"),f=require("application/application-context");require("system/lang/string");function g(){a(this).column=null,a(this).dbValue=null,a(this).value="",a(this).utcValue="",a(this).backColor="",a(this).hyperlinkRoute="",a(this).formatter=Object.resolve(e)}var h=g.prototype;return h.getColumn=function(){return a(this).column},h.setColumn=function(d){b.instanceOf(d,c,"column"),a(this).column=d},h.getDbValue=function(){var b=a(this).column,c=a(this).dbValue;if(!b)return c;switch(b.getTypeName()){case"System.DateTime":return d.toDate(c);case"System.Integer":return d.toNullableInteger(c);case"System.Double":return d.toNullableFloat(c);case"System.Boolean":return d.toBoolean(c);case"System.String":return"Boolean"===b.getFieldDataType()?c===!0||"Y"===c:d.toString(c);default:return c}},
h.setDbValue=function(b){a(this).dbValue=b},h.getValue=function(){var b=a(this).value,c=this.getDbValue(),d=a(this).column,e=a(this).formatter,g=f.user.formats.dateTime;if(!d||b)return b;switch(d.getTypeName()){case"System.DateTime":return c?e.format(c,g):"";case"System.Integer":case"System.Double":return null===c?c:e.format(c,"g");default:return c?c.toString():""}},h.setValue=function(c){b.isString(c,"value"),a(this).value=c},h.getUtcValue=function(){return a(this).utcValue},h.setUtcValue=function(c){b.isString(c,"utcValue"),a(this).utcValue=c},h.getBackColor=function(){return a(this).backColor},h.setBackColor=function(c){b.isString(c,"backColor"),a(this).backColor=c},h.getHyperlinkRoute=function(){return a(this).hyperlinkRoute},h.setHyperlinkRoute=function(c){b.isString(c,"hyperlinkRoute"),a(this).hyperlinkRoute=c},h.isVisible=function(){return a(this).column.getIsDisplayed()},g});
define('query/adapters/cell-adapter',['require','ramda','mi-assert','system/lang/converter','../services/dto/cell-dto','../model/cell'],function(require){"use strict";var a=require("ramda"),b=require("mi-assert"),c=require("system/lang/converter"),d=require("../services/dto/cell-dto"),e=require("../model/cell");function f(a){var e=new d;return b.isObject(a,"data"),void 0===a.dbValue?e.dbValue=null:e.dbValue=a.dbValue,e.value=c.toString(a.value),e.utcValue=c.toString(a.utcValue),e.backColor=c.toString(a.backColor),e}var g=a.addIndex(a.map);function h(a,c){return b.isArray(c,"dtos"),g(i.bind(null,a),c)}function i(a,c,f){var g=new e;return b.instanceOf(c,d,"dto"),g.setDbValue(c.dbValue),g.setValue(c.value),g.setUtcValue(c.utcValue),g.setBackColor(c.backColor),g.setColumn(a[f]),g}return{deserialize:f,deserializeArray:a.map(f),toModel:i,toModelArray:h}});
define('query/adapters/row-adapter',['require','ramda','mi-assert','system/lang/converter','../services/dto/row-dto','../model/row','./cell-adapter'],function(require){"use strict";var a=require("ramda"),b=require("mi-assert"),c=require("system/lang/converter"),d=require("../services/dto/row-dto"),e=require("../model/row"),f=require("./cell-adapter");function g(a){var e=new d,g=c.toObject(a.cells,[]);return b.isObject(a,"data"),e.cells=f.deserializeArray(g),e}function h(c,d){return b.isArray(d,"dtos"),a.map(i.bind(null,c),d)}function i(a,c){var g=new e,h,i;for(b.instanceOf(c,d,"dto"),b.isArray(a,"columnResults"),h=f.toModelArray(a,c.cells),i=0;i<h.length;i++)j(h,a[i],h[i]);return g.setCells(h),g}function j(a,b,c){var d=k(b,a);c.setHyperlinkRoute(d)}function k(b,c){var d=b.getHyperlinkFormat(),e=l(c);return a.all(n,e)?"":d.format.apply(d,e)}function l(b){return a.map(m,b)}function m(a){return a.getValue()}function n(a){return!a}return{deserialize:g,deserializeArray:a.map(g),toModel:i,toModelArray:h}});
define('query/adapters/query-result-adapter',['require','ramda','mi-assert','system/lang/converter','../services/dto/query-result-dto','../model/query-result','./column-result-adapter','./row-adapter'],function(require){"use strict";var a=require("ramda"),b=require("mi-assert"),c=require("system/lang/converter"),d=require("../services/dto/query-result-dto"),e=require("../model/query-result"),f=require("./column-result-adapter"),g=require("./row-adapter");function h(a){var e=new d,h=c.toObject(a.columns,[]),i=c.toObject(a.rows,[]);return b.isObject(a,"data"),e.rowCount=c.toInteger(a.rowCount),e.columns=f.deserializeArray(h),e.rows=g.deserializeArray(i),e.timeoutExceeded=c.toBoolean(a.timeoutExceeded),e}function i(a){b.instanceOf(a,d,"dto");var c=new e;return c.setRowCount(a.rowCount),c.setColumns(f.toModelArray(a.columns)),c.setRows(g.toModelArray(c.getColumns(),a.rows)),c.setTimeoutExceeded(a.timeoutExceeded),c}return{deserialize:h,deserializeArray:a.map(h),toModel:i,toModelArray:a.map(i)}});
define('query/services/dto/table-dto',['require','system/lang/converter','./column-dto'],function(require){"use strict";var a=require("system/lang/converter"),b=require("./column-dto");function c(c){c=c||{},this.caption=a.toString(c.caption),this.defaultCaption=a.toString(c.defaultCaption),this.id=a.toString(c.id),this.queryColumns=b.fromDataCollection(c.queryColumns),this.tableType=a.toString(c.tableType),this.queryColumns&&(this.queryColumns=this.queryColumns.sort(d))}c.fromDataCollection=function a(b){if(b){var d,e=[];for(d=0;d<b.length;d++)e[e.length]=new c(b[d]);return e}};function d(a,b){var c=a.caption.toLowerCase(),d=b.caption.toLowerCase(),e=!1,f=!1;return c.indexOf("[")===-1&&c.indexOf("{")===-1||(e=!0,c=c.slice(1,c.length-1)),d.indexOf("[")===-1&&d.indexOf("{")===-1||(f=!0,d=d.slice(1,d.length-1)),e&&f||!e&&!f?c===d?0:c<d?-1:1:e?-1:1}return c});
define('query/services/dto/join-source-dto',['require','system/lang/converter','./table-dto'],function(require){"use strict";var a=require("system/lang/converter"),b=require("./table-dto");function c(c){c=c||{},this.entFamilyCaption=a.toString(c.entFamilyCaption),this.entFamilyId=a.toString(c.entFamilyId),this.joinSucc=a.toBoolean(c.joinSucc),this.relFamilyCaption=a.toString(c.relFamilyCaption),this.relFamilyId=a.toString(c.relFamilyId),this.entTableData=new b(c.entTableData),this.relTableData=new b(c.relTableData)}return c.fromDataCollection=function a(b){if(b){var d,e=[];for(d=0;d<b.length;d++)e[e.length]=new c(b[d]);return e}},c});
define('query/services/dto/hyperlink-route-dto',['require','system/lang/converter'],function(require){"use strict";var a=require("system/lang/converter");function b(b){b=b||{},this.key=a.toString(b.key),this.featureKey=a.toString(b.featureKey),this.sortOrder=a.toInteger(b.sortOrder),this.caption=a.toString(b.caption),this.pattern=a.toString(b.pattern),this.parm1Caption=a.toString(b.parm1Caption),this.parm2Caption=a.toString(b.parm2Caption),this.parm3Caption=a.toString(b.parm3Caption)}return b.fromDataCollection=function a(c){if(c){var d,e=[];for(d=0;d<c.length;d++)e[e.length]=new b(c[d]);return e}},b});
define('query/services/dto/hyperlink-feature-dto',['require','system/lang/converter'],function(require){"use strict";var a=require("system/lang/converter");function b(b){b=b||{},this.key=a.toString(b.key),this.id=a.toString(b.id),this.sortOrder=a.toInteger(b.sortOrder),this.caption=a.toString(b.caption)}return b.fromDataCollection=function a(c){if(c){var d,e=[];for(d=0;d<c.length;d++)e[e.length]=new b(c[d]);return e}},b});
define('query/services/dto/hyperlink-container-dto',['require','system/lang/converter','./hyperlink-route-dto','./hyperlink-feature-dto'],function(require){"use strict";var a=require("system/lang/converter"),b=require("./hyperlink-route-dto"),c=require("./hyperlink-feature-dto");function d(a){a=a||{},this.features=c.fromDataCollection(a.features),this.routes=b.fromDataCollection(a.routes)}return d});
define('query/services/query-service',['require','lodash','jquery','system/http/ajax-client','./dto/rowset-dto','./dto/query-container-dto','../adapters/query-result-adapter','./dto/table-dto','./dto/table-design-dto','./dto/column-dto','./dto/join-source-dto','./dto/hyperlink-container-dto','system/lang/converter'],function(require){"use strict";var a=require("lodash"),b=require("jquery"),c=require("system/http/ajax-client"),d=require("./dto/rowset-dto"),e=require("./dto/query-container-dto"),f=require("../adapters/query-result-adapter"),g=require("./dto/table-dto"),h=require("./dto/table-design-dto"),i=require("./dto/column-dto"),j=require("./dto/join-source-dto"),k=require("./dto/hyperlink-container-dto"),l="api/core/queryengine",m="api/core/url",n=require("system/lang/converter");function o(a){this.ajaxClient=a}o.dependsOn=[c],o.prototype.evaluateQuerySql=function a(c){var d=b.Deferred(),e=l+"/evaluate/string",f=b.Deferred();return this.ajaxClient.post(e,{value:c}).done(function(a){d.resolve(a)}).fail(function(a){d.reject(a)}),d.promise()},o.prototype.getPromptArrayFromQueryString=function a(b){var c=/^p\d+$/,d=[],e,f,g=[],h=0,i=0;for(var j in b)b.hasOwnProperty(j)&&c.test(j)&&d.push(j);for(d.sort(),h=0;h<d.length;h++){if(e=d[h],f=e.match(/\d+/)[0],h.toString()!==f)for(i=h,
i=0;i<f;i++)g.push(null);g.push(b[e])}return g},o.prototype.evaluateQueryContainer=function a(c){var d=b.Deferred(),e=l+"/evaluate/container",f=b.Deferred();return this.ajaxClient.post(e,c).done(function(a){d.resolve(a)}).fail(function(a){d.reject(a)}),d.promise()},o.prototype.executeQuerySql=function a(c){var e=b.Deferred(),f=l+"/execute/string",g=b.Deferred();return this.ajaxClient.post(f,{value:c}).done(function(a){e.resolve(new d(a))}).fail(function(a){e.reject(a)}),e.promise()},o.prototype.executeQueryContainer=function a(c){var e=b.Deferred(),f=l+"/execute/container",g=b.Deferred();return this.ajaxClient.post(f,c).done(function(a){e.resolve(new d(a))}).fail(function(a){e.reject(a)}),e.promise()},o.prototype.executeQueryContainerSync=function a(c){var d=b.Deferred(),e=l+"/executesync/container";return this.ajaxClient.post(e,c).done(function(a){d.resolve(f.deserialize(a))}).fail(function(a){d.reject(a)}),d.promise()},o.prototype.getEntitySources=function c(){
var d=l+"/entitysources/all",e=b.Deferred();return this.ajaxClient.get(d,{}).done(function(b){var c=a.map(b,function(a){return new g(a)});c.sort(p),e.resolve(c)}).fail(function(a){e.reject(a)}),e.promise()},o.prototype.getEntitySource=function a(c){var d=l+"/entitysource?entityFamilyId="+c,e=b.Deferred();return this.ajaxClient.get(d,{}).done(function(a){var b=new h(a);e.resolve(b)}).fail(function(a){e.reject(a)}),e.promise()},o.prototype.getJoinSources=function a(c){var d=l+"/joinsources?entFamilyId="+c,e=b.Deferred();return this.ajaxClient.get(d,{}).done(function(a){var c=b.map(a,function(a){return new j(a)});e.resolve(c)}).fail(function(a){e.reject(a)}),e.promise()},o.prototype.joinsourcesForRf=function a(c){var d=l+"/joinsources_for_rf?relFamilyId="+c,e=b.Deferred();return this.ajaxClient.get(d,{}).done(function(a){var c=b.map(a,function(a){return new j(a)});e.resolve(c)}).fail(function(a){e.reject(a)}),e.promise()},o.prototype.getJoinSource=function a(c,d,e,f){var g,h=b.Deferred()
;return f=f!==!1||f,g=l+"/joinsource?predFamilyId="+c+"&relFamilyId="+d+"&succFamilyId="+e+"&getSuccessor="+f,this.ajaxClient.get(g,{}).done(function(a){var b=new j(a);h.resolve(b)}).fail(function(a){h.reject(a)}),h.promise()},o.prototype.getRelSources=function a(){var c,d=b.Deferred();return c=l+"/relsources/all",this.ajaxClient.get(c,{}).done(function(a){var c=b.map(a,function(a){return new g(a)});c.sort(p),d.resolve(c)}).fail(function(a){d.reject(a)}),d.promise()},o.prototype.getRelSource=function a(c){var d=l+"/relsource?relFamilyId="+c,e=b.Deferred();return this.ajaxClient.get(d,{}).done(function(a){var b=new h(a);e.resolve(b)}).fail(function(a){e.reject(a)}),e.promise()},o.prototype.compileString=function a(c){var d=b.Deferred(),f=l+"/compilestring/",g=b.Deferred(),h;return this.ajaxClient.post(f,{value:c}).done(function(a){h=new e(a),d.resolve(h)}).fail(function(a){d.reject(a)}),d.promise()},o.prototype.compileContainer=function a(c){
var d=b.Deferred(),e=l+"/compilecontainer/",f=b.Deferred();return this.ajaxClient.post(e,c).done(function(a){d.resolve(a)}).fail(function(a){d.reject(a)}),d.promise()},o.prototype.recompileContainer=function a(c){var d=b.Deferred(),f=l+"/recompilecontainer/",g=b.Deferred();return this.ajaxClient.post(f,c).done(function(a){d.resolve(new e(a))}).fail(function(a){d.reject(a)}),d.promise()},o.prototype.compileContainerParameters=function a(c){var d=b.Deferred(),f=l+"/compileparameters/",g=b.Deferred();return this.ajaxClient.post(f,c).done(function(a){d.resolve(new e(a))}).fail(function(a){d.reject(a)}),d.promise()},o.prototype.compileParameterDesign=function a(c){var d=b.Deferred(),e=l+"/compileparamdesign/",f=b.Deferred();return this.ajaxClient.post(e,c).done(function(a){d.resolve(a)}).fail(function(a){d.reject(a)}),d.promise()},o.prototype.getQueryAsSource=function a(c){var d=l+"/querysource?catalogItemPath="+encodeURIComponent(c),e=b.Deferred()
;return this.ajaxClient.get(d,{}).done(function(a){var b=new h(a);e.resolve(b)}).fail(function(a){e.reject(a)}),e.promise()},o.prototype.getDatasheets=function a(c){var d=l+"/datasheets?fmlyId="+c,e=b.Deferred();return this.ajaxClient.get(d,{}).done(function(a){e.resolve(a)}).fail(function(a){e.reject(a)}),e.promise()},o.prototype.getDatasheetColumns=function a(c,d){var e=l+"/datasheetColumns?fmlyId="+c+"&datasheetCaption="+d,f=b.Deferred();return this.ajaxClient.get(e,{}).done(function(a){var c=b.map(a,function(a){return new i(a)});c.sort(p),f.resolve(c)}).fail(function(a){f.reject(a)}),f.promise()},o.prototype.convertSimpleCriteria=function a(c,d,e){var f=b.Deferred(),g=l+"/convertcriteria?columnIdx="+d.toString()+"&criteriaIdx="+e.toString();return this.ajaxClient.post(g,c).done(function(a){f.resolve(a)}).fail(function(a){f.reject(a)}),f.promise()},o.prototype.convertSimpleCriteriaText=function a(c,d,e,f,g){var h=b.Deferred(),i=l+"/convertsimplecriteriatext"
;return this.ajaxClient.post(i,{queryContainer:c,toDisplay:d,columnKey:e,criteriaIndex:f,factorTexts:g}).done(function(a){h.resolve(a)}).fail(function(a){h.reject(a)}),h.promise()},o.prototype.convertCriteriaText=function a(c,d,e,f,g){var h=b.Deferred(),i=l+"/convertcriteriatext";return this.ajaxClient.post(i,{queryContainer:c,toDisplay:d,columnKey:e,criteriaIndex:f,factorText:g}).done(function(a){h.resolve(a)}).fail(function(a){h.reject(a)}),h.promise()},o.prototype.convertExpressionText=function a(c,d,e,f,g){var h=b.Deferred(),i=l+"/convertexpressiontext";return this.ajaxClient.post(i,{queryContainer:c,toDisplay:d,columnKey:e,criteriaIndex:f,factorText:g}).done(function(a){h.resolve(a)}).fail(function(a){h.reject(a)}),h.promise()},o.prototype.getUrlContainer=function a(){var c=m+"/hyperlink/container",d=b.Deferred();return this.ajaxClient.get(c,{}).done(function(a){var b=new k(a);d.resolve(b)}).fail(function(a){d.reject(a)}),d.promise()};function p(a,b){
var c=a.caption.toLowerCase(),d=b.caption.toLowerCase();return c.indexOf("[")===-1&&c.indexOf("{")===-1||(c=c.slice(1,c.length-1)),d.indexOf("[")===-1&&d.indexOf("{")===-1||(d=d.slice(1,d.length-1)),c===d?0:c<d?-1:1}return o});
define('catalog/services/dto/catalog-item-dto',['require','system/lang/converter'],function(require){"use strict";var a=require("system/lang/converter");function b(b){b=b||{},this.key=a.toString(b.key),this.id=a.toString(b.id),this.caption=a.toString(b.caption),this.defaultCaption=a.toString(b.defaultCaption),this.description=a.toString(b.description),this.path=a.toString(b.path),this.folderKey=a.toString(b.folderKey),this.itemType=a.toInteger(b.itemType),this.ownerKey=a.toString(b.ownerKey),this.ownerId=a.toString(b.ownerId),this.lockSeq=a.toString(b.lockSeq),this.query=a.toObject(b.query),this.dataset=a.toObject(b.dataset),this.createDate=a.toDate(b.createDate),this.createUser=a.toString(b.createUser),this.updateDate=a.toDate(b.updateDate),this.updateUser=a.toString(b.updateUser),this.ownerDisplay=a.toString(b.ownerDisplay),this.creatorDisplay=a.toString(b.creatorDisplay),this.updatorDisplay=a.toString(b.updatorDisplay)}return b.fromDataCollection=function a(c){if(c){var d,e=[];for(d=0;d<c.length;d++)e[e.length]=new b(c[d]);return e}},b});
define('catalog/services/dto/folder-dto',['require','jquery','system/lang/converter','./catalog-item-dto'],function(require){"use strict";var a=require("jquery"),b=require("system/lang/converter"),c=require("./catalog-item-dto");function d(c){var e=[];c=c||{},this.key=b.toString(c.key),this.id=b.toString(c.id),this.description=b.toString(c.description),this.caption=b.toString(c.caption),this.folderType=b.toInteger(c.folderType),this.hasChildren=b.toBoolean(c.hasChildren),this.ownerKey=b.toString(c.ownerKey),this.ownerId=b.toString(c.ownerId),this.parentKey=b.toString(c.parentKey),this.path=b.toString(c.path),this.privilege=b.toInteger(c.privilege),this.spread=b.toInteger(c.spread),this.updateDate=b.toDate(c.updateDate),this.updateUser=b.toString(c.updateUser),this.lockSeq=b.toString(c.lockSeq),this.ownerDisplay=b.toString(c.ownerDisplay),this.updatorDisplay=b.toString(c.updatorDisplay),c.children&&(e=a.map(c.children,function(a){return new d(b.toObject(a,{}))})),this.children=e}return d});
define('catalog/services/dto/folder-priv-dto',['require','system/lang/converter'],function(require){"use strict";var a=require("system/lang/converter");function b(b){b=b||{},this.key=a.toString(b.key,"0"),this.userKey=a.toString(b.userKey,"0"),this.userDisplay=a.toString(b.userDisplay),this.groupKey=a.toString(b.groupKey,"0"),this.groupDisplay=a.toString(b.groupDisplay),this.folderKey=a.toString(b.folderKey,"0"),this.privilege=a.toInteger(b.privilege),this.spread=a.toInteger(b.spread)}return b});
define('catalog/services/dto/user-pref-dto',['require','system/lang/converter'],function(require){"use strict";var a=require("system/lang/converter");function b(b){b=b||{},this.key=a.toString(b.key),this.userKey=a.toString(b.userKey),this.prefType=a.toInteger(b.prefType),this.name=a.toString(b.name),this.value=a.toString(b.value)}return b.fromDataCollection=function a(c){if(c){var d,e=[];for(d=0;d<c.length;d++)e[e.length]=new b(c[d]);return e}},b});
define('catalog/services/dto/nav-dto',['require','system/lang/converter'],function(require){"use strict";var a=require("system/lang/converter");function b(b){b=b||{},this.key=a.toString(b.key),this.caption=a.toString(b.caption)}return b.fromDataCollection=function a(c){if(void 0!==c){var d,e=[];for(d=0;d<c.length;d++)e[e.length]=new b(c[d]);return e}},b});
define('catalog/services/dto/catalog-item-result-grid-dto',['require','system/lang/converter'],function(require){"use strict";var a=require("system/lang/converter");function b(b){b=b||{},this.type="",this.linkValue="",b.itemType===-1?(this.type="#query/",this.linkValue=b.key):b.itemType===-2?(this.type="#graph/",this.linkValue=b.key):b.itemType===-3?(this.type="#ssrs/viewer/",this.linkValue=b.path+"\\"+a.toString(b.id)):b.itemType===-5?(this.type="#dataset/",this.linkValue=b.key):b.itemType===-9&&(this.type="#dashboard/",this.linkValue=b.key),this.name=a.toString(b.id),this.path="<a href='"+this.type+a.toString(this.linkValue)+"'>"+a.toString(b.path)+"</a>",this.creator=a.toString(b.ownerId),this.date=a.toDate(b.createDate)}return b.fromDataCollection=function a(c){var d,e=[];for(d=0;d<c.length;d++)e[d]=new b(c[d]);return e},b});
define('catalog/services/catalog-service',['require','lodash','jquery','system/http/ajax-client','./dto/folder-dto','./dto/catalog-item-dto','./dto/folder-priv-dto','./dto/user-pref-dto','./dto/nav-dto','./dto/catalog-item-result-grid-dto'],function(require){"use strict";var a=require("lodash"),b=require("jquery"),c=require("system/http/ajax-client"),d=require("./dto/folder-dto"),e=require("./dto/catalog-item-dto"),f=require("./dto/folder-priv-dto"),g=require("./dto/user-pref-dto"),h=require("./dto/nav-dto"),i=require("./dto/catalog-item-result-grid-dto"),j="api/core/userpref/",k="api/core/command/",l="api/core/catalog/",m="22",n="api/core/localizer",o=n+"/translations/objectKey/{0}?localizableType={1}&defaultValue={2}";function p(a){this.ajaxClient=a}p.dependsOn=[c],p.prototype.getAllFolders=function a(){var c=l+"folders/all/",e=b.Deferred();return this.ajaxClient.get(c,{}).done(function(a){var c=b.map(a,function(a){return new d(a)});e.resolve(c)}).fail(function(a){e.reject(a)}),e.promise()},p.prototype.getFolder=function a(c){var e=l+"folder/"+c,f=b.Deferred();return this.ajaxClient.get(e,{}).done(function(a){f.resolve(new d(a))}).fail(function(a){f.reject(a)}),f.promise()},
p.prototype.getFoldersPaginate=function a(c,e,f){var g=l+"folders/"+c+"/pageSize/"+e+"/pageNum/"+f,h=b.Deferred();return this.ajaxClient.get(g,{}).done(function(a){a&&a.length&&0!==a.length?h.resolve(b.map(a,function(a){return new d(a)})):h.resolve(null)}).fail(function(a){h.reject(a)}),h.promise()},p.prototype.getFolderRoots=function a(){var c=b.Deferred(),e=l+"folder/roots";return this.ajaxClient.get(e,{}).done(function(a){a&&a.length&&0!==a.length?c.resolve(b.map(a,function(a){return new d(a)})):c.resolve(null)}).fail(function(a){c.reject(a)}),c.promise()},p.prototype.getPublicFolder=function a(){var c=l+"folder/public/",e=b.Deferred();return this.ajaxClient.get(c,{}).done(function(a){e.resolve(new d(a))}).fail(function(a){e.reject(a)}),e.promise()},p.prototype.getPersonalFolder=function a(){var c=l+"folder/personal/",e=b.Deferred();return this.ajaxClient.get(c,{}).done(function(a){e.resolve(new d(a))}).fail(function(a){e.reject(a)}),e.promise()},
p.prototype.getBaselineFolder=function a(){var c=l+"folder/baseline/",e=b.Deferred();return this.ajaxClient.get(c,{}).done(function(a){e.resolve(new d(a))}).fail(function(a){e.reject(a)}),e.promise()},p.prototype.getFolderParents=function a(c){var e=b.Deferred(),f=l+"folder/parents?path="+c;return this.ajaxClient.get(f,{}).done(function(a){e.resolve(b.map(a,function(a){return new d(a)}))}).fail(function(a){e.reject(a)}),e.promise()},p.prototype.searchFolders=function a(c,e,f){var g=l+"folders/search?searchValue="+c+"&pageSize="+e+"&pageNum="+f,h=b.Deferred();return this.ajaxClient.get(g,{}).done(function(a){a&&a.length?h.resolve(b.map(a,function(a){return new d(a)})):h.resolve(null)}).fail(function(a){h.reject(a)}),h.promise()},p.prototype.postFolder=function a(c){var d=b.Deferred(),e=l+"folder/";return this.ajaxClient.post(e,c).done(function(a){d.resolve(a)}).fail(function(a){d.reject(a)}),d.promise()},p.prototype.postQuery=function a(c){var d=b.Deferred(),e=k+"discover"
;return this.ajaxClient.post(e,c).done(function(a){d.resolve(a)}).fail(function(a){d.reject(a)}),d.promise()},p.prototype.putFolder=function a(c){var d=b.Deferred(),e=l+"folder/";return this.ajaxClient.put(e,c).done(function(a){d.resolve(a)}).fail(function(a){d.reject(a)}),d.promise()},p.prototype.deleteFolder=function a(c){var d=b.Deferred(),e=l+"folder/";return this.ajaxClient.delete(e+c).done(function(a){d.resolve(a)}).fail(function(a){d.reject(a)}),d.promise()},p.prototype.copyFolder=function a(c,d){var e=b.Deferred(),f=l+"folder/copy/"+c+"/"+d;return this.ajaxClient.post(f).done(function(a){e.resolve(a)}).fail(function(a){e.reject(a)}),e.promise()},p.prototype.moveFolder=function a(c,d){var e=b.Deferred(),f=l+"folder/move/"+c+"/"+d;return this.ajaxClient.post(f).done(function(a){e.resolve(a)}).fail(function(a){e.reject(a)}),e.promise()},p.prototype.getCatalogItems=function a(d){var f=b.Deferred(),g=l+"items/"+d;return this.ajaxClient.get(g,{}).done(function(a){
c.isMultiTenant()&&(a=a.filter(function(a){return a.itemType!==-12||"Role"!==a.id})),f.resolve(b.map(a,function(a){return new e(a)}))}).fail(function(a){f.reject(a)}),f.promise()},p.prototype.getCatalogItem=function a(b){var c=l+"item/";return this.ajaxClient.get(c+b)},p.prototype.getCatalogItemId=function a(b,c){var d=l+"item/"+b+"?id="+c;return this.ajaxClient.get(d)},p.prototype.getCatalogItemKey=function a(b){var c=l+"itemkey?path="+b;return this.ajaxClient.get(c)},p.prototype.getCatalogItemByPath=function a(b){var c=l+"item?path="+encodeURIComponent(b);return this.ajaxClient.get(c)},p.prototype.CanUpdateCatalogItem=function a(b){var c=l+"item/can-update/"+b;return this.ajaxClient.get(c)},p.prototype.postCatalogItem=function a(c){var d=b.Deferred(),e=l+"item/";return this.ajaxClient.post(e,c).done(function(a){d.resolve(a)}).fail(function(a){d.reject(a)}),d.promise()},p.prototype.putCatalogItem=function a(c){var d=b.Deferred(),e=l+"item/"
;return this.ajaxClient.put(e,c).done(function(a){d.resolve(a)}).fail(function(a){d.reject(a)}),d.promise()},p.prototype.copyCatalogItems=function a(c,d){var e=b.Deferred(),f=l+"items/copy/"+d;return this.ajaxClient.post(f,c).done(function(a){e.resolve(a)}).fail(function(a){e.reject(a)}),e.promise()},p.prototype.moveCatalogItems=function a(c,d){var e=b.Deferred(),f=l+"items/move/"+d;return this.ajaxClient.post(f,c).done(function(a){e.resolve(a)}).fail(function(a){e.reject(a)}),e.promise()},p.prototype.deleteCatalogItem=function a(c){var d=b.Deferred(),e=l+"item/";return this.ajaxClient.delete(e+c).done(function(a){d.resolve(a)}).fail(function(a){d.reject(a)}),d.promise()},p.prototype.searchCatalogItems=function a(c,d,e,f){var g=b.Deferred(),h,i,j,k;return c=c||"0",d=d||"",e=void 0===e||e,e=e?"True":"False",f=f||0,h="?searchValue="+d,i="&searchSubFolders="+e,j="&itemType="+f,k=l+"items/search/"+c+h+i+j,this.ajaxClient.get(k,{}).done(q.bind(null,this,g)).fail(function(a){g.reject(a)}),
g.promise()};function q(a,b,c){b.resolve(e.fromDataCollection(c))}p.prototype.getFolderPrivs=function a(c){var d=l+"privs/"+c,e=b.Deferred();return this.ajaxClient.get(d,{}).done(function(a){var c=b.map(a,function(a){return new f(a)});e.resolve(c)}).fail(function(a){e.reject(a)}),e.promise()},p.prototype.postFolderPriv=function a(c){var d=b.Deferred(),e=l+"priv";return this.ajaxClient.post(e,c).done(function(a){d.resolve(a)}).fail(function(a){d.reject(a)}),d.promise()},p.prototype.putFolderPriv=function a(c){var d=b.Deferred(),e=l+"priv";return this.ajaxClient.put(e,c).done(function(a){d.resolve(a)}).fail(function(a){d.reject(a)}),d.promise()},p.prototype.deleteFolderPriv=function a(c){var d=b.Deferred(),e=l+"priv/"+c;return this.ajaxClient.delete(e).done(function(a){d.resolve(a)}).fail(function(a){d.reject(a)}),d.promise()},p.prototype.getPreference=function a(c,d){var e=b.Deferred(),f=j+"get/"+c+"/1?name="+d;return this.ajaxClient.get(f,{}).done(function(a){e.resolve(new g(a))
}).fail(function(a){e.reject(a)}),e.promise()},p.prototype.setPreference=function a(c){var d=b.Deferred(),e=j+"set";return this.ajaxClient.post(e,c).done(function(a){d.resolve(a)}).fail(function(a){d.reject(a)}),d.promise()};function r(a,b){a.resolve(i.fromDataCollection(b))}p.prototype.getTranslation=function(a,c,d){var e=b.Deferred(),f=s(a,d);return this.ajaxClient.get(f,{}).done(t.bind(null,e,c,d)).fail(function(a){e.reject(a)}),e.promise()};function s(a,b){return o.replace("{0}",encodeURIComponent(a)).replace("{1}",encodeURIComponent(m)).replace("{2}",encodeURIComponent(b))}function t(b,c,d,e){var f=a.find(e,{cultureId:c});f&&(d=f.value),b.resolve(d)}return p});
define('catalog/services/catalog-constants',[],function(){"use strict";function a(){this.FOLDER_TYPE_PERSONAL=0,this.FOLDER_TYPE_BASELINE=1,this.FOLDER_TYPE_PUBLIC=2,this.FOLDER_PRIV_NONE=0,this.FOLDER_PRIV_CREATE=1,this.FOLDER_PRIV_VIEW=2,this.FOLDER_PRIV_EDIT_OWN=4,this.FOLDER_PRIV_EDIT_ALL=8,this.FOLDER_PRIV_DELETE_OWN=16,this.FOLDER_PRIV_DELETE_ALL=32,this.ITEM_TYPE_NONE=0,this.ITEM_TYPE_QUERY=-1,this.ITEM_TYPE_GRAPH=-2,this.ITEM_TYPE_REPORT=-3,this.ITEM_TYPE_SEARCH=-4,this.ITEM_TYPE_DATASET=-5,this.ITEM_TYPE_METRICVIEW=-6,this.ITEM_TYPE_EXPLORER=-7,this.ITEM_TYPE_PROJECT=-8,this.ITEM_TYPE_DASHBOARD=-9,this.ITEM_TYPE_R_SCRIPT=-10,this.ITEM_TYPE_SCRIPT=-11,this.QUERY_TYPE_NONE=0,this.QUERY_TYPE_SELECT=1,this.QUERY_TYPE_UPDATE=2,this.QUERY_TYPE_DELETE=3,this.QUERY_TYPE_APPEND=4,this.QUERY_TYPE_TRANSFORM=5,this.QUERY_TYPE_IN=6,this.QUERY_TYPE_AGGREGATE=7,this.GRP_CATALOG_ADMIN="MI Catalog Administrator",this.GRP_POWER_USER="MI Power User Role",this.KEY_PUBLIC_FOLDER="-1",this.KEY_BASELINE_FOLDER="-41",
this.KEY_PERSONAL_FOLDER="-999999999",this.CATALOG_PREFERENCE=1}return a});
define('query/services/dto/query-state-dto',['require','system/lang/converter','./query-container-dto'],function(require){"use strict";var a=require("system/lang/converter"),b=require("./query-container-dto");function c(a){a=a||{},this.version=2,this.queryContainer=new b(a.queryContainer)}return c});
define('spa/region',["require","exports","jquery"],function(require,exports,a){"use strict";var b=8,c=function(){function a(a){this.element=null,this.$element=null,this.setElement(a),this.activeContainer=null,this.screen=null}return a.prototype.setElement=function(a){var b=d(a);this.element=e(b),this.$element=h(b),i(this)},a.prototype.attach=function(a){this.clear(),this.activeContainer=j(),k(this,a),l(this)},a.prototype.clear=function(){this.activeContainer&&(n(this),i(this))},a.prototype.remove=function(){if(!this.$element)throw new Error("region.$element is null");this.$element.remove()},a.prototype.dispose=function(){this.clear(),this.detach(),this.screen=null},a.prototype.detach=function(){this.element=null,this.$element=null},a.prototype.removeAndDispose=function(){this.remove(),this.dispose()},a}();function d(a){return a||document.createElement("div")}function e(a){return f(a)?g(a):a}function f(b){return b instanceof a}function g(a){return a.get(0)}function h(b){return f(b)?b:a(b)}
function i(a){if(!a.$element)throw new Error("region.$element is null");a.$element.empty()}function j(){var a=document.createElement("div");return a.classList.add("region"),a}function k(b,c){a(b.activeContainer).append(c)}function l(a){if(m(a.element)){if(!a.$element)throw new Error("region.$element is null");a.$element.after(a.activeContainer)}else{if(!a.element)throw new Error("region.element is null");a.element.appendChild(a.activeContainer)}}function m(a){return!!a&&a.nodeType===b}function n(b){a(b.activeContainer).remove(),b.activeContainer=null}return c});
define('spa/conductor',["require","exports","jquery","system/lang/ioc","system/diagnostics/log-manager","application/application-events","system/error/error-message","system/globalization/translator"],function(require,exports,a,b,c,d,e,f){"use strict";var g=c.getLogger("spa/conductor"),h="FND1",i="PAGE_NOT_LOADED",j=function(){function b(a,b){this.errorOccured=a.errorOccured,this.translator=b}return b.prototype.activateScreen=function(a,b){try{return k(this,a,b)}catch(a){l(this,a)}},b.prototype.createArgumentArray=function(a,b){return void 0===b&&(b=[]),g.isTraceEnabled()&&g.trace("create argument array"),a?(a.named&&b.push(a.named),Array.prototype.push.apply(b,a.positional),b):b},b.prototype.reuseScreen=function(a,b,c){try{return m(this,a,b,c)}catch(a){l(this,a)}},b.prototype.deactivateScreen=function(a){try{n(a)}catch(a){l(this,a)}},b.prototype.canUnloadScreen=function(a){try{return o(a)}catch(a){return l(this,a),!1}},b.prototype.attachScreen=function(a,b,c){try{p(a,b,c)}catch(a){l(this,a)}},
b.prototype.detachScreen=function(a){try{q(a)}catch(a){l(this,a)}},b.prototype.canReuseScreen=function(a,b,c){try{return r(this,a,b,c)}catch(a){return l(this,a),!1}},b.prototype.openScreen=function(a,b){try{s(this,a,b)}catch(a){l(this,a)}},b.prototype.loadScreen=function(a,b){try{t(this,a,b)}catch(a){l(this,a)}},b.prototype.closeScreen=function(a){try{u(a)}catch(a){l(this,a)}},b.prototype.unloadScreen=function(a){try{v(a)}catch(a){l(this,a)}},b.prototype.changeScreen=function(b,d,e,f){void 0===e&&(e={});var h=d.screen,i={isClosing:!0,checkForReuse:!0,checkForUnload:!1};if(c.pushContext(w(b)+" from "+w(h)),a.extend(i,f),i.checkForReuse&&this.canReuseScreen(h,b,e))return g.isDebugEnabled()&&g.debug("Reusing previous screen."),void this.reuseScreen(h,d,e);this.openScreen(b,e),this.loadScreen(b,e),this.deactivateScreen(h),this.activateScreen(b,e),this.detachScreen(d),this.attachScreen(b,d,e.url),i.isClosing&&b!==h&&(g.isDebugEnabled()&&g.debug("closing previous screen."),
this.unloadScreen(h),this.closeScreen(h)),c.popContext()},b.prototype.hideScreen=function(a){this.deactivateScreen(a.screen),this.detachScreen(a)},b.prototype.clearScreen=function(a){this.changeScreen(null,a),a.screen=null},b.prototype.showScreen=function(a,b){this.activateScreen(a.screen),this.attachScreen(a.screen,a,b)},b}();j=__decorate([b.dependsOn(d,f)],j);function k(a,b,c){if(g.isTraceEnabled()&&g.trace("activating screen"),(!b||!b.isActive)&&b&&(b.isActive=!0,b.activate)){var d=a.createArgumentArray(c);return b.activate.apply(b,d)}}function l(a,b){var c,d;c=b&&b.message?b.message:b instanceof Object?JSON.stringify(b):b,d=b.stack?b.stack:(new Error).stack;var f=a.translator.translate(i),g=new e(h,f,c+"\n"+d);a.errorOccured.raise(a,g)}function m(a,b,c,d){if(g.isTraceEnabled()&&g.trace("reuse screen"),b.reuse){var e=a.createArgumentArray(d,[c,d.url]);return b.reuse.apply(b,e)}}function n(a){g.isTraceEnabled()&&g.trace("deactivating screen"),a&&!a.isActive||a&&(a.isActive=!1,
a.deactivate&&a.deactivate())}function o(a){return g.isTraceEnabled()&&g.trace("can deactivate screen"),!a||!a.canUnload||a.canUnload()}function p(a,b,c){a&&a.isAttached===!0||(g.isTraceEnabled()&&g.trace("attaching screen"),a&&a.attach&&(a.attach(b,c),b.screen=a,a.isAttached=!0))}function q(a){g.isTraceEnabled()&&g.trace("detaching screen"),a&&a.screen&&(a&&a.screen&&!a.screen.isAttached||a.screen.detach&&(a.screen.detach(a),a.screen.isAttached=!1))}function r(a,b,c,d){var e=!0;if(g.isTraceEnabled()&&g.trace("can reuse screen: ",w(c)),!c||!b||c.constructor!==b.constructor)return!1;if(c.canReuse){var f=a.createArgumentArray(d);e=c.canReuse.apply(c,f)}else c.reuse||(e=!1);return e!==!1}function s(a,b,c){if(g.isTraceEnabled()&&g.trace("opening screen"),b&&!b.isOpen){if(b.open){var d=a.createArgumentArray(c);d[d.length]=c.url,b.open.apply(b,d)}b.isOpen=!0}}function t(a,b,c){if(g.isTraceEnabled()&&g.trace("load screen"),b&&!b.isLoaded){if(b.load){var d=a.createArgumentArray(c)
;b.load.apply(b,d)}b.isLoaded=!0}}function u(a){g.isTraceEnabled()&&g.trace("closing screen"),a&&a.isOpen&&(a.close&&a.close(),a.isOpen=!1)}function v(a){g.isTraceEnabled()&&g.trace("unload screen"),a&&a.isLoaded&&(a.unload&&a.unload(),a.isLoaded=!1)}function w(a){return a?a.constructor&&a.constructor.name?a.constructor.name:a.constructor?a.constructor:a.toString():a}return j});

define('text!system/ui/views/dialog.html',[],function () { return '<div class="pattern pattern-dialog" >\r\n    <div class="dialog-opacity-style"></div>\r\n    <div class="dialog-wrapper">\r\n        <section class="title">\r\n            <div class="title-wrapper">\n                <div class="title-container" data-bind="text: title, attr: {title: title}"></div>\n            </div>\r\n            <span class="close-dialog icon-close-popup"\r\n            \tdata-bind="click: closeDialog, visible: showCloseIcon"></span>\r\n        </section>\r\n        <section class="content dialog-content"></section>\r\n    </div>\r\n</div>';});

define('system/ui/dialog-view-model',["require","exports","jquery","knockout","spa/conductor","spa/region","application/application-events","system/lang/object","text!./views/dialog.html"],function(require,exports,a,b,c,d,e,f){"use strict";var g=require("text!./views/dialog.html"),h=0,i=function(){function i(a,g,h){void 0===h&&(h=null),this.options=h,this.content=a,this.title=g,this.showHelp=b.observable(!0),this.showClose=b.observable(!0),this.showCloseIcon=b.observable(!1),this.showCheck=b.observable(!0),this.applicationEvents=f.resolve(e),this.dialogShellRegion=new d(null),this.dialogContentRegion=new d(null),this.$wrapper=null,this.conductor=f.resolve(c)}return i.prototype.show=function(){var c=document.createElement("div");document.body.appendChild(c),this.dialogShellRegion.setElement(c),this.dialogShellRegion.attach(a(g)),b.applyBindings(this,this.dialogShellRegion.activeContainer),this.$wrapper=this.dialogShellRegion.$element.find(".dialog-wrapper");var d=this.$wrapper.find(".dialog-content")
;if(this.dialogContentRegion.setElement(d),this.options?(this.options.height&&this.$wrapper.css("height",this.options.height),this.options.width&&this.$wrapper.css("width",this.options.width),this.options.noPadding?d.addClass("dialog-no-padding"):j(this,d)):j(this,d),this.options&&this.options.hasOwnProperty("closeIcon")){var e=this.options.closeIcon||!1;this.showCloseIcon(e)}h++,this.dialogShellRegion.$element.find(".dialog-opacity-style").css("z-index",h.toString()+"98"),this.dialogShellRegion.$element.find(".dialog-opacity-style").on("touchstart",m.bind(null)),this.$wrapper.css("z-index",h.toString()+"99"),this.conductor.changeScreen(this.content,this.dialogContentRegion),l(this),this.applicationEvents.windowResized.add(l,this,this),this.$wrapper.find("div.dialog-message-box div.btn.btn-primary").each(n.bind(null)),this.$wrapper.find(".okButtonClass").hover(o.bind(null,this),p.bind(null,this)),this.$wrapper.find(".cancelButtonClass").hover(o.bind(null,this),p.bind(null,this)),
q(this)},i.prototype.closeDialog=function(){r(this),k(this),h--},i.prototype.centerDialog=function(){l(this)},i.prototype.setContent=function(a){this.content=a,this.conductor.changeScreen(this.content,this.dialogContentRegion),l(this)},i}();function j(a,b){a.$wrapper.find(".title").addClass("title-with-padding"),b.addClass("dialog-with-padding")}function k(a){a.dialogShellRegion.$element.find(".dialog-opacity-style").off("touchstart"),a.conductor.clearScreen(a.dialogContentRegion),b.cleanNode(a.dialogShellRegion.activeContainer),a.dialogShellRegion.clear(),a.dialogShellRegion.$element.remove(),a.applicationEvents.windowResized.remove(a),a.applicationEvents.navigate.remove(a)}function l(b){var c,d,e,f,g,h;window.scrollTo(0,0),e=window.innerHeight?window.innerHeight:a(window).height(),f=window.innerWidth?window.innerWidth:a(window).width(),h=b.$wrapper.outerHeight(),g=b.$wrapper.outerWidth(),c=Math.max(0,(e-h)/2+a(window).scrollTop()),d=Math.max(0,(f-g)/2+a(window).scrollLeft()),
b.$wrapper.css("top",c+"px"),b.$wrapper.css("left",d+"px")}function m(a){a.preventDefault(),a.stopPropagation()}function n(b,c){var d=a(c);d.attr("tabindex",b+1),"OK"===d.text()&&(d.addClass("okButtonClass"),d.focus()),"Cancel"===d.text()&&d.addClass("cancelButtonClass")}function o(b){a(b).focus()}function p(b){a(b).blur()}function q(b){b.$wrapper.keydown(function(b){var c=a(b.currentTarget).find("input, select, textarea, button"),d=c.first(),e=c.last();9===(b.which||b.keyCode)&&(b.shiftKey&&d.length&&d.is(":focus")&&(b.preventDefault(),e.focus()),!b.shiftKey&&e.length&&e.is(":focus")&&(b.preventDefault(),d.focus()))})}function r(a){a.$wrapper.off("keydown")}return i});
define('query/model/parameter-value-model',['require','knockout'],function(require){"use strict";var a=require("knockout");function b(b){b=b||{},this.value=a.observable(b.value),this.displayValue=a.observable(b.displayValue)}return b});
define('query/adapters/parameter-value-adapter',['require','../services/dto/parameter-value-dto','../model/parameter-value-model'],function(require){"use strict";var a=require("../services/dto/parameter-value-dto"),b=require("../model/parameter-value-model");function c(){}return c.toModelObject=function a(c){return new b(c)},c.toModelObjectArray=function a(b){var c=0,d=[];if(b&&b.length){for(c=0;c!==b.length;c++)d.push(this.toModelObject(b[c]));return d}},c.toDTO=function b(c){var d=new a;return c=c||{},d.value=c.value(),d.displayValue=c.displayValue(),d},c.toDTOArray=function a(b){var c=0,d=[];if(b&&b.length){for(c=0;c!==b.length;c++)d.push(this.toDTO(b[c]));return d}},c});
define('query/model/parameter-design-model',['require','knockout','../adapters/parameter-value-adapter'],function(require){"use strict";var a=require("knockout"),b=require("../adapters/parameter-value-adapter");function c(c){c=c||{},this.id=a.observable(c.id),this.dataType=a.observable(c.dataType),this.caption=a.observable(c.caption),this.defaultValue=a.observable(c.defaultValue),this.isHidden=a.observable(c.isHidden),this.familyId=a.observable(c.familyId),this.fieldId=a.observable(c.fieldId),this.isMultiValue=a.observable(c.isMultiValue),this.list=a.observableArray(c.list),this.localizedCaption=a.observable(c.localizedCaption),this.codeTable=a.observable(c.codeTable),this.referenceCode=a.observable(c.referenceCode),this.referenceTable=a.observable(c.referenceTable),this.query=a.observable(c.query),this.isExclusive=a.observable(c.isExclusive),this.parameterValues=a.observableArray(b.toModelObjectArray(c.parmValues)),this.parameterPrompts=a.observableArray(c.parmPrompts),this.isAssetHierarchy=a.observable(c.isAssetHierarchy),this.child=a.observable(c.child),
this.parent=a.observable(c.parent),this.all=a.observable(c.all),this.current=a.observable(c.current),this.isGis=a.observable(c.isGis),this.format=a.observable(c.foramt),this.alias=a.observable(c.alias),this.distance=a.observable(c.distance),this.entyKey=a.observable(c.entyKey),this.justTheDate=a.observable(c.justTheDate),this.defaultValues=a.computed({read:e.bind(null,this),write:f.bind(null,this),owner:this}),this.isExclusive.subscribe(d.bind(null,this))}function d(a,b){b||a.isMultiValue(!1)}function e(a){var b=a.defaultValue();return b?b.toString().split("|"):[]}function f(a,b){b.length>1?a.defaultValue(b.join("|")):a.defaultValue(b[0])}return c});
define('query/adapters/parameter-design-adapter',['require','../services/dto/parameter-design-dto','../model/parameter-design-model','./parameter-value-adapter'],function(require){"use strict";var a=require("../services/dto/parameter-design-dto"),b=require("../model/parameter-design-model"),c=require("./parameter-value-adapter");function d(){}return d.toModelObject=function a(c){return new b(c)},d.toModelObjectArray=function a(b){var c=0,d=[];if(b&&b.length){for(c=0;c!==b.length;c++)d.push(this.toModelObject(b[c]));return d}},d.toDTO=function b(d){var e=new a,f=d.parameterPrompts();return d=d||{},e.id=d.id()||null,e.dataType=d.dataType(),e.caption=d.caption(),e.defaultValue=d.defaultValue(),e.isHidden=d.isHidden(),e.familyId=d.familyId(),e.fieldId=d.fieldId(),e.isMultiValue=d.isMultiValue(),e.list=d.list(),e.localizedCaption=d.localizedCaption(),e.codeTable=d.codeTable(),e.referenceCode=d.referenceCode(),e.referenceTable=d.referenceTable(),e.query=d.query(),e.isExclusive=d.isExclusive(),e.parmValues=c.toDTOArray(d.parameterValues()),e.isAssetHierarchy=d.isAssetHierarchy(),e.isAssetHierarchy?(e.parmPrompts="0"===f[0]||0===f[0]?["-1"]:f,
e.assetHierarchyCaption=d.assetHierarchyCaption):e.parmPrompts=f,e.child=d.child(),e.parent=d.parent(),e.all=d.all(),e.current=d.current(),e.isGis=d.isGis(),e.format=d.format(),e.alias=d.alias(),e.distance=d.distance(),e.entyKey=d.entyKey(),e.justTheDate=d.justTheDate(),e},d.toDTOArray=function a(b){var c=0,d=[];if(b&&b.length){for(c=0;c!==b.length;c++)d.push(this.toDTO(b[c]));return d}},d});

define('text!query/execution/views/query-prompt.html',[],function () { return '<div class="query-prompt"\r\n     data-bind="foreach: prompts">\r\n    <div class="form-group"\r\n         data-bind="css: { \'has-error\': !$root.validatePrompt($data) }">\r\n        <!-- ko ifnot: isHidden -->\r\n            <label data-bind="text: caption"></label>\r\n            <!-- ko if: options && options.length -->\r\n                <!-- ko if: isExclusive -->\r\n                    <!-- ko if: isMultiValue -->\r\n                        <mi-select data-bind="miproperty: {\r\n                                                  options: options,\r\n                                                  multiple: true,\r\n                                                  optionsText: \'displayValue\',\r\n                                                  optionsValue: \'value\',\r\n                                                  optionsCaption: \'\',\r\n                                                  selectedOptions: values\r\n                                              },\r\n                                              event: {\r\n                                                  selected: $root.multiSelectValueChanged.bind($root)\r\n                                   }">\r\n                        </mi-select>\r\n                    <!-- /ko -->\r\n                    <!-- ko ifnot: isMultiValue -->\r\n                        <mi-select data-bind="miproperty: {\r\n                                                  options: options,\r\n                                                  multiple: false,\r\n                                                  optionsText: \'displayValue\',\r\n                                                  optionsValue: \'value\',\r\n                                                  optionsCaption: \'\',\r\n                                                  value: value\r\n                                    }">\r\n                        </mi-select>\r\n                    <!-- /ko -->\r\n                <!-- /ko -->\r\n                <!-- ko ifnot: isExclusive -->\r\n                    <!-- ko if: isMultiValue -->\r\n                        <mi-select data-bind="miproperty: {\r\n                                                  options: options,\r\n                                                  multiple: true,\r\n                                                  optionsText: \'displayValue\',\r\n                                                  optionsValue: \'value\',\r\n                                                  optionsCaption: \'\',\r\n                                                  selectedOptions: values\r\n                                              },\r\n                                              event: {\r\n                                                  selected: $root.multiSelectValueChanged.bind($root)\r\n                                   }">\r\n                        </mi-select>\r\n                    <!-- /ko -->\r\n                    <!-- ko ifnot: isMultiValue -->\r\n                        <mi-multi-value data-bind="miproperty: {\r\n                                                  options: cboOptions,\r\n                                                  multiple: false,\r\n                                                  optionsText: \'displayValue\',\r\n                                                  optionsValue: \'value\',\r\n                                                  optionsCaption: \'\',\r\n                                                  value: value\r\n                                    }">\r\n                        </mi-multi-value>\r\n                    <!-- /ko -->\r\n                <!-- /ko -->\r\n            <!-- /ko -->\r\n            <!-- ko ifnot: (options && options.length) -->\r\n                <!-- ko if: isAssetHierarchy -->\r\n                    <mi-asset-context dialog data-bind="value: value"></mi-asset-context>\r\n                <!-- /ko -->\r\n                <!-- ko ifnot: isAssetHierarchy -->\r\n                    <div data-bind="template: valueTemplate"></div>\r\n                <!-- /ko -->\r\n            <!-- /ko -->\r\n        <!-- /ko -->\r\n    </div>\r\n\r\n    <!-- ko if: validationMessage -->\r\n        <p class="invalid-value bg-danger text-danger">\r\n            <button type="button"\r\n                    class="close"\r\n                    data-bind="click: $root.clearPromptValidationMessage($data),\r\n                               attr: { \'aria-label\': $root.translate(\'CLOSE\')}">\r\n                <span aria-hidden="true">&times;</span>\r\n            </button>\r\n            <span data-bind="text: validationMessage" />\r\n        </p>\r\n    <!-- /ko -->\r\n</div>\r\n\r\n<script type="text/html" id="prompt-text-template">\r\n    <input type="text" class="form-control" data-bind="value: value" />\r\n</script>\r\n<script type="text/html" id="prompt-number-template">\r\n    <input type="text"\r\n           class="form-control"\r\n           data-bind="textInput: value" />\r\n</script>\r\n<script type="text/html" id="prompt-datetime-template">\r\n    <mi-date-time pick-time="true"\r\n                  use-seconds="true"\r\n                  data-bind="value: value,\r\n                             attr: { format: $root.format }" />\r\n</script>\r\n<script type="text/html" id="prompt-date-template">\r\n    <mi-date-time pick-time="false"\r\n                  data-bind="value: value,\r\n                             attr: { format: $root.dateFormat }" />\r\n</script>';});

define('assets/services/asset-context-dto',['require','system/globalization/translator','system/lang/converter'],function(require){"use strict";var a=require("system/globalization/translator"),b=require("system/lang/converter");function c(a){a=a||{},this.entityKey=b.toString(a.entityKey),this.description="-1"===this.entityKey?d("ASSET_HIERARCHY_ROOT"):b.toString(a.description),this.type=b.toString(a.type),this.familyId=b.toString(a.familyId),this.siteKey=b.toString(a.siteKey)}c.fromDataCollection=function a(b){for(var d=[],e=0;e<b.length;e++)d[d.length]=new c(b[e]);return d},c.fromHierarchyDTO=function a(b){return b?new c({entityKey:b.entityKey,description:b.description,type:"Hierarchy",familyId:b.familyId,siteKey:b.siteKey}):c.default()},c.fromGroupDTO=function a(b){return new c(b?{entityKey:b.entityKey,description:b.groupid,type:"Group",siteKey:b.siteKey}:{type:"Group"})},c.default=function a(b){var e=d("ASSET_HIERARCHY_ROOT");return new c({entityKey:b||"-1",description:e,type:"Hierarchy"})};function d(b){return Object.resolve(a).translate(b)}return c});

define('text!ui/elements/select/template.html',[],function () { return '<div class="mi-select-container" data-bind="event:{click:toggleOptions,\r\n                                                    mousedown:handleMouseDown},\r\n    css:{\'disabled\':disabled,\'open\':isOpen,\'required\': isRequired }">\r\n    <div data-bind="css:{\'active\':isOpen}" class="mi-dropdown-selector">\r\n        <div data-bind="visible:multiple,\r\n    event:{click:toggleSelectAll},\r\n    css:{\'dx-checkbox-indeterminate\':selectedOptions().length && selectedOptions().length !== options().length ,\r\n        \'dx-checkbox-checked\':selectedOptions().length === options().length}" \r\n             class="pull-left dx-select-checkbox dx-datagrid-checkbox-size dx-widget dx-checkbox" tabindex="0" onclick="void(0)">\r\n            <div class="dx-checkbox-container">\r\n                <span class="dx-checkbox-icon"></span>\r\n            </div>\r\n        </div>\r\n        <input type="text" class="mi-selected-value-text pull-left"\r\n               data-bind="value:text,\r\n    valueUpdate:\'keyup\',\r\n    attr:{\'readonly\':(!editable() || disabled() || multiple() || isMobile),\r\n           \'title\': text},\r\n    css:{\'multi\':multiple},\r\n    event: {keyup: handleKeyUpOnTextInput,\r\n            keydown:handleKeyDownOnTextInput,\r\n            click:handleKeyUpOnTextInput,\r\n            mousedown:handleKeyUpOnTextInput},\r\n    hasFocus:textFocus" /> \r\n        <i class="icon-arrow pull-right"></i>\r\n        <!--disable:(!editable() || disabled() || multiple())<span class="mi-selected-value-text pull-left" data-bind="text:selectedValueText()"></span> <span class="fa fa-angle-down pull-right"></span>-->\r\n    </div>\r\n\r\n</div>';});


define('text!ui/elements/select/options-template.html',[],function () { return '<div data-bind="visible:isOpen(),event:{mousedown:$root.handleMouseDown}" class="mi-select-options-container">\r\n\r\n    <p class="mi-select-caption" data-bind="visible:optionsCaption() && optionsCaption().trim(),text:optionsCaption,event:{\r\n                                    click:function(data,event){selectValue($root,null,event);}},\r\n                                    css:{\'mi-select-option\':optionsCaption}\r\n                                "></p>\r\n\r\n    <!-- ko ifnot:optionsGroup -->\r\n    <!-- ko foreach:filteredOptions -->\r\n    <p class="mi-select-option" data-bind="html:$parent.wrapOptionText($data),event:{\r\n                                                    click:function(data,event){$parent.selectValue($parent,data,event);}},\r\n                                                    css:{\'active\':$parent.isActive($data)},\r\n                                                    attr:{\'data-index\':$index()}">\r\n    </p>\r\n    <!-- /ko -->\r\n    <!-- /ko -->\r\n    <!-- ko if:optionsGroup -->\r\n    <!-- ko foreach:Object.keys(filteredOptions()) -->\r\n\r\n    <strong class="mi-select-group-title" data-bind="text:$data,visible:$data !== \'undefined\',click:$root.handleMouseDown"></strong>\r\n    <!-- ko foreach:$root.filteredOptions()[$data] -->\r\n    <p class="mi-select-option" data-bind="html:$root.wrapOptionText($data),event:{\r\n                                                                            click:function(data,event){$root.selectValue($root,data,event);}},\r\n                                                                            css:{\'active\':$root.isActive($data)},\r\n                                                                            attr:{\'data-index\':$index()}">\r\n    </p>\r\n    <!-- /ko -->\r\n    <!-- /ko -->\r\n    <!-- /ko -->\r\n</div>\r\n';});

define('system/knockout/bindings/halt-bindings',['require','knockout'],function(require){"use strict";var a=require("knockout");a.bindingHandlers["halt-bindings"]||(a.bindingHandlers["halt-bindings"]={init:function(){return{controlsDescendantBindings:!0}}});function b(a){return Element.build("div",a,null,{"data-bind":"halt-bindings: true"})}return{createElement:b}});
define('ui/elements/select/mi-property',['require','lodash','jquery','knockout'],function(require){"use strict";var a=require("lodash"),b=require("jquery"),c=require("knockout"),d="property-changed-event-handlers",e=1;if(!c.bindingHandlers.miproperty){c.bindingHandlers.miproperty={init:function(e,f){var h,i=b(e),j={},k=g(f());a.each(k,function(b,c){h=function(b,d){var e=f()[c];a.isFunction(e)&&e(d)},j[c]=h,i.on("attributes."+c+":changed",h),i.on("properties."+c+":changed",h)}),c.utils.domData.set(e,d,j),c.utils.domNodeDisposal.addDisposeCallback(e,function(){var b=c.utils.domData.get(e,d);a.each(f(),function(a,c){i.off("attributes."+c+":changed",b[c]),i.off("properties."+c+":changed",b[c])})})},update:function(d,h){var i,j=g(h());f(d,!1),a.each(j,function(f,g){i=c.unwrap(f),"object"==typeof i&&!a.isEqual(b(d).data(g.toLowerCase()),i)||""===i?(b(d).data(g.toLowerCase(),i),b(d).attr("data-"+g.toLowerCase(),e),e++):(b(d).data(g.toLowerCase(),i),b(d).attr("data-"+g.toLowerCase(),i))}),f(d,!0)}};var f=function(a,d){if(b(a).find(".mi-select-container")[0]){
var e=c.contextFor(b(a).find(".mi-select-container")[0]).$data;e.propertiesUpdateDone&&e.propertiesUpdateDone(d)}},g=function(a){for(var b={},c=["addCaption","multiple","editable","value","selectedOptions","optionsCaption","optionsText","optionsValue","optionsGroup","disabled","required","options"],d=0;d<c.length;d++)void 0!==a[c[d]]&&(b[c[d]]=a[c[d]]);return b}}});
define('ui/elements/select/element',['require','lodash','jquery','jquery','knockout','system/lang/converter','system/knockout/knockout-manager','system/knockout/bindings/halt-bindings','./mi-property'],function(require){"use strict";var a=require("lodash"),b=require("jquery"),c=require("jquery"),d=require("knockout"),e=require("system/lang/converter"),f=require("system/knockout/knockout-manager");require("system/knockout/bindings/halt-bindings"),require("./mi-property");function g(a,b){var c=Object.create(HTMLElement.prototype);c.createdCallback=function(){this.implementation=Object.resolve(b,this),this.implementation.element=this,Object.tryMethod(this.implementation,"created")},c.attachedCallback=function(){this.implementation&&Object.tryMethod(this.implementation,"attached")},c.detachedCallback=function(){this.implementation&&(Object.tryMethod(this.implementation,"detached"),this.implementation=null)},c.attributeChangedCallback=function(a,b,c){Object.tryMethod(this.implementation,a.toLowerCase()+"Changed",b,c)},c.getControl=function(){return this.implementation},Element.registerElement(a,{prototype:c})}var h=function(){function a(a,b,c){this.kom=Object.resolve(f),
this.properties=[],this.view=a,this.preserveContext=b||!1,this.appendAfterBindings=c||!1,this.container=null,this.element=null,this.state=null}a.prototype.created=function(){Object.tryMethod(this,"beforeCreated"),c(this),Object.tryMethod(this,"afterCreated")},a.prototype.attached=function(){Object.tryMethod(this,"beforeAttached"),e(this),Object.tryMethod(this,"afterAttached")},a.prototype.detached=function(){Object.tryMethod(this,"beforeDetached"),g(this),Object.tryMethod(this,"afterDetached"),this.kom.dispose(),this.kom=null,this.properties=null,this.view=null,this.preserveContext=null,this.appendAfterBindings=null,this.state=null,this.container=null},a.prototype.bindAttribute=function(a,c,d,e){var f=e||!1;this["data-"+a.toLowerCase()+"Changed"]=function(c,d){var e=b(this.element).data(a.toLowerCase());this[a]&&this[a](e)}.bind(this),this.kom.subscribe(this[a],function(c){f||b(this.element).trigger("attributes."+a+":changed",[c])},this),d&&this.kom.subscribe(this[a],d,this),
void 0===b(this.element).attr("data-"+a.toLowerCase())?this.element.setAttribute("data-"+a.toLowerCase(),c):this[a](b(this.element).data(a.toLowerCase()))},a.prototype.bindProperty=function(a,c,d,e){this[a]=this.kom.observable();var f=e||!1;Object.defineProperty(this.element,a,{get:function(){return this[a]()}.bind(this),set:function(b){this[a]&&this[a](b)}.bind(this)}),this.properties.push(a),this.kom.subscribe(this[a],function(c){f||b(this.element).trigger("properties."+a+":changed",[c])},this),d&&this.kom.subscribe(this[a],d,this),this[a](Object.defaultValue(this.element[a],c))},a.prototype.bindArrayProperty=function(a,c,d,e){this[a]=this.kom.observableArray();var f=e||!1;Object.defineProperty(this.element,a,{get:function(){return this[a]()}.bind(this),set:function(b){this[a](b)}.bind(this)}),this.properties.push(a),this.kom.subscribe(this[a],function(c){f||b(this.element).trigger("properties."+a+":changed",[c])},this),d&&this.kom.subscribe(this[a],d,this),
this[a](Object.defaultValue(this.element[a],c))};function c(a){a.state="created";var c=document.createElement("div"),d=b(c),e=b(a.view);a.preserveContext||d.attr("data-bind","halt-bindings"),d.append(e),a.appendAfterBindings||b(a.element).empty().append(d),a.container=c}function e(a){if("detached"===a.state){var c=document.createElement("div"),e=b(c),f=b(a.view);a.preserveContext||e.attr("data-bind","halt-bindings"),e.append(f),a.appendAfterBindings||b(a.element).empty().append(e),a.container=c}a.state="attached",d.applyBindingsToDescendants(a,a.container),a.appendAfterBindings&&b(a.element).empty().append(a.container)}function g(a){a.state="detached",d.cleanNode(a.container),b(a.container).remove()}function h(a,b){delete a[b]}return a}();function i(b,d){window.CustomElements&&(window.CustomElements.useNative||(a.isArray(b)?j(b,d):a.isString(b)?k(b,d):b instanceof c?l(b):m(b)))}function j(a,b){for(var c=0;c!==a.length;c++)i(a[c],b)}function k(a,c){c&&c.$element&&(c=c.$element),
l(b(a,c))}function l(a){a.each(function(a,b){m(b)})}function m(a){window.CustomElements.upgrade(a)}function n(b,c,d,e){var f,g=document.createElement(b);if(c&&c.appendChild(g),d)for(f=0;f!==d.length;f++)g.classList.add(d[f]);return e&&a.each(e,function(a,b){e.hasOwnProperty(b)&&g.setAttribute(b,a)}),g}function o(a,b,c){var d=a.getAttribute(b);return d?e.toBoolean(d,"true"):c}function p(a,b,c){var d=a.getAttribute(b);return d?e.toInteger(d):c}function q(a,b,c){var d=a.getAttribute(b);return d?e.toString(d):c}function r(a){for(;a.firstChild;)a.removeChild(a.firstChild)}return{register:g,ViewModel:h,upgrade:i,build:n,booleanAttribute:o,intAttribute:p,stringAttribute:q,clearDom:r}});
define('ui/elements/select/view-model',['require','lodash','jquery','text!./template.html','text!./options-template.html','knockout','spa/region','./element','system/hardware/device','system/lang/string','system/lang/object'],function(require){"use strict";var a=require("lodash"),b=require("jquery"),c=require("text!./template.html"),d=require("text!./options-template.html"),e=require("knockout"),f=require("spa/region"),g=require("./element"),h=Object.resolve(require("system/hardware/device"));require("system/lang/string"),require("system/lang/object");function i(a){j.call(this,c,!1,!1);var b=this;this.element=a,this.isOpen=null,this.selectedItem=null,this.text=null,this.showAllOptions=null,this.textFocus=null,this.keyPressed=null,this.optionsValue=null,this.optionsText=null,this.optionsGroup=null,this.multiple=null,this.optionsCaption=null,this.options=null,this.value=null,this.required=null,this.disabled=null,this.editable=null,this.selectedOptions=null,this.isRequired=null,this.currentText=null,this.currentMatchedOptions=null,this._selectedOptions=[],this.updated_selectedOptions=!1,this.propertiesUpdateDone=!0,this.selectedValueText=null,this.filteredOptions=null,this.isMobile=h.isMobile(),
this.optionsRegion=new f("","blah"),b.optionsContainerDiv=null,this.isClicked=!1,this.documentHandlerFn=w.bind(null,b),this.isRequiredSubscriber=null,this.filteredOptionsSubscriber=null}var j=Object.inherit(g.ViewModel,i);function k(b){if(!b.options)return[];var c=[].concat(b.options()),d=b.text(),f=[],g=b.optionsGroup(),h=c,i=[],j,k=b.optionsCaption(),n,o;if(c&&c.length)if(i=m(b,h,d),j=k!==d,!b.showAllOptions()&&("object"!=typeof b.options()[0]||b.optionsText())&&b.text()&&"object"!=typeof b.text()&&j&&b.keyPressed()&&(d=l(d),n=new RegExp(d.trim(),"i"),o=e.utils.arrayFilter(c,function(a){var c=b.getOptionText(a);return n.test(c)}),(!i||i&&o.length>1)&&(h=o.length?o:c)),"object"==typeof h[0]&&g){var p=a.groupBy(h,g),q={undefined:[]};f=p?p:q}else f=h;return f}function l(a){return a=a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}i.prototype.beforeAttached=function(){var c=this;this.init(),b(document).off("mousedown",this.documentHandlerFn).on("mousedown",this.documentHandlerFn),
this.bindAttribute("multiple",!1,C.bind(null,this),!0),this.bindAttribute("editable",!0,null,!0),this.bindAttribute("value",null,D.bind(null,this),!0),this.bindAttribute("selectedOptions",[],E.bind(null,this),!0),this.bindAttribute("optionsCaption",null,null,!0),this.bindAttribute("optionsText",null,null,!0),this.bindAttribute("optionsValue",null,null,!0),this.bindAttribute("optionsGroup",null,null,!0),this.bindAttribute("disabled",!1,q.bind(null,c),!0),this.bindAttribute("required",!1,null,!0),this.bindAttribute("options",[],B.bind(null,c),!0),this.resizeProxy=b.proxy(a.debounce(this.resize,100),this),this.scrollProxy=b.proxy(this.resize,this)},i.prototype.init=function a(){var b=this;this.isOpen=e.observable(!1),this.keyPressed=e.observable(),this.selectedItem=e.observable(),this.text=e.observable(),this.showAllOptions=e.observable(!1),this.textFocus=e.observable(),this.optionsValue=e.observable(),this.optionsText=e.observable(),this.optionsGroup=e.observable(),
this.multiple=e.observable(!1),this.optionsCaption=e.observable(""),this.options=e.observableArray([]),this.value=e.observable(),this.required=e.observable(!1),this.disabled=e.observable(!1),this.editable=e.observable(!0),this.selectedOptions=e.observableArray([]),this.propertiesUpdateDone=e.observable(!0),this.isRequired=e.computed(o.bind(b,b)),this.isRequiredSubscriber=this.isRequired.subscribe(r.bind(b,b)),this.selectedValueText=e.computed(y.bind(null,this)),this.filteredOptions=e.computed(k.bind(null,this)),this.filteredOptionsSubscriber=this.filteredOptions.subscribe(p.bind(b,b))};function m(b,c,d){return d!==b.currentText&&(b.currentText=d,b.currentMatchedOptions=a.find(c,n.bind(b,b,d))),b.currentMatchedOptions}function n(a,b,c){var d=a.getOptionText(c);return d&&d.toString()===b.toString()}function o(a){return a.required()&&!a.hasValue()}function p(a,b){a.setOptionContainerPosition.bind(null,a)(b),M.bind(null,a)(b)}function q(a,c){
c?b(a.element).addClass("mi-select-disabled"):b(a.element).removeClass("mi-select-disabled")}function r(a,c){a.isRequired()?b(a.element).addClass("mi-select-required"):b(a.element).removeClass("mi-select-required")}i.prototype.afterAttached=function(){var a=this},i.prototype.afterDetached=function(){this.isOpen(!1),b(this.optionsContainerDiv).remove(),this.isOpen=null,this.selectedItem=null,this.text=null,this.showAllOptions=null,this.textFocus=null,this.optionsValue=null,this.optionsText=null,this.optionsGroup=null,this.multiple=null,this.optionsCaption=null,this.options=null,this.value=null,this.required=null,this.disabled=null,this.editable=null,this.selectedOptions=null,this.isRequired=null,this.keyPressed=null,this.selectedValueText=null,this.filteredOptions=null,b(document).off("mousedown",this.documentHandlerFn),this.isRequiredSubscriber&&this.isRequiredSubscriber.dispose(),this.filteredOptionsSubscriber&&this.filteredOptionsSubscriber.dispose()},
i.prototype.selectValue=function(c,d,e){if(e&&(e.preventDefault(),e.stopPropagation()),c.disabled())return!1;if(c.multiple()){if(c.multiple()){if(!d)return!0;var f=c.selectedOptions(),g=f||[],h=c.getOptionValue(d);b.inArray(h,c.selectedOptions())===-1?(c._selectedOptions.push(d),g.push(h)):(c._selectedOptions=b.grep(c._selectedOptions,function(a){return c.getOptionValue(a)!==h}),g=b.grep(g,function(a){return a!==h})),c.updated_selectedOptions=!0,c.selectedOptions(g),b(c.element).trigger("properties.selectedOptions:changed",[g]),c.textFocus(!0)}}else{var i;if(c.selectedItem(d),a.isEqual(d,c.value()))y(c);else{if(d){var j=c.getOptionValue(d);return i=j,c.isOpen(!1),u(c),c.value&&c.value(j),b(c.element).trigger("properties.value:changed",[i]),b(c.element).trigger("selected",[c.value?c.value():c.value]),!0}c.value("");var k=c.optionsCaption()?c.optionsCaption():"";c.text(k),i="",b(c.element).trigger("properties.value:changed",[i])}c.textFocus(!0),c.isOpen(!1),u(c),
b(c.element).trigger("selected",[c.value()])}return!0},i.prototype.toggleSelectAll=function(a,c){var d=this;if(d.disabled())return!0;if(d.selectedOptions().length||d.selectedOptions().length===d.options().length)d._selectedOptions=[],d.updated_selectedOptions=!0,d.selectedOptions([]),b(d.element).trigger("properties.selectedOptions:changed",[[]]);else if(!d.selectedOptions().length){var e=s(d.options(),d.getOptionValue.bind(d));d._selectedOptions=d.options(),d.updated_selectedOptions=!0,d.selectedOptions(e),b(d.element).trigger("properties.selectedOptions:changed",[e])}return!0};function s(a,b){var c=[],d;for(d=0;d<a.length;d++)c.push(b(a[d]));return c}i.prototype.toggleOptions=function(a,c){c.stopPropagation();var d=this;return!(d.disabled()||d.options()&&!d.options().length)&&(d.isClicked=!0,b(document).trigger("mousedown",[d.element]),this.showAllOptions(!0),d.isOpen()?(u(d),b(d.element).trigger("selected",[d.multiple()?d.selectedOptions():d.value()])):(F(d),t(d)),
d.isOpen()||b(d.optionsContainerDiv).css("visibility","hidden"),d.textFocus()||d.textFocus(!0),d.isOpen(!d.isOpen()),!0)};function t(a){b(a.element).parents().on("scroll",a.scrollProxy)}function u(a){b(a.optionsContainerDiv).css("visibility","hidden"),b(a.element).parents().off("scroll",a.scrollProxy),L(a)}i.prototype.showOptions=function(a){var c=this;this.showAllOptions(c.multiple()),this.isOpen()||13===a.keyCode||c.disabled()||(b(c.optionsContainerDiv).css("visibility","hidden"),c.isClicked=!0,b(document).trigger("mousedown",[c.element]),this.isOpen(!0),F(this),t(c))},i.prototype.handleMouseDown=function a(b,c){return c.stopPropagation(),!0},i.prototype.handleKeyUpOnTextInput=function a(b,c){return c.stopPropagation(),this.isOpen()||this.keyPressed(!1),"keyup"===c.type&&this.keyPressed(!0),this.showOptions(c),!0},i.prototype.handleKeyDownOnTextInput=function a(c,d){var e=this,f;if(d.stopPropagation(),b(e.element).trigger("textChange",[d]),9===d.keyCode)e.isOpen(!1),u(e),f=!e.text(),
y(e),b(e.element).trigger("selected",[e.multiple()?e.selectedOptions():e.value()]),x(e,f);else{if(8===d.keyCode&&(e.multiple()||e.disabled()))return!1;this.showAllOptions(e.multiple()),J.bind(null,e)(d)}return!0},i.prototype.getValue=function(a){return"function"==typeof a?a():a},i.prototype.getReturnValue=function(a,b){return"function"==typeof a?b?a.call(b,b):b:b?b[a]:b},i.prototype.getOptionText=function(a){var b=this;return a&&b.optionsText()?b.getValue(b.getReturnValue(b.optionsText(),a)):a},i.prototype.getOptionValue=function(a){var b=this;return a&&b.optionsValue()?b.getValue(b.getReturnValue(b.optionsValue(),a)):a},i.prototype.hasValue=function(){var a=this;if(a.multiple()){if(a.selectedOptions()&&0===a.selectedOptions().length)return!1}else if(!a.value())return!1;return!0},i.prototype.isActive=function(c){var d=this
;return d.multiple()?b.inArray(d.getOptionValue(c),d.selectedOptions())!==-1:"object"!=typeof d.value()||d.optionsValue()?d.getOptionValue(c)===d.value():a.isEqual(c,d.value())},i.prototype.resize=function(){this.isOpen(!1),v(this)},i.prototype.wrapOptionText=function(a){var b=this,c=b.getOptionText(a),d=b.text(),e,f=c,g=b.options(),h;return h=m(b,g,d),c&&d&&d.trim()&&!h&&(d=l(d),e=new RegExp(d,"gi"),c&&"string"==typeof c&&(c=R(c)),f=c.replace(e,function(a){return"<b>"+a+"</b>"}),f=f.replace(/ /g,"&nbsp;")),f&&"string"==typeof f&&(f=R(f)),f},i.prototype.setFocus=function b(){var c=this;a.defer(c.showOptions.bind(c,{}))};function v(a){u(a)}function w(a,c){var d;a.isClicked?a.isClicked=!1:(a.isOpen&&a.isOpen()&&(a.isOpen(!1),u(a),b(a.element).trigger("selected",[a.multiple()?a.selectedOptions():a.value()]),d=!a.text()),y(a),x(a,d))}function x(a,c){
if(c)if(a.multiple()||null!==a.optionsCaption()&&""!==a.optionsCaption()||!a.options()||!a.options().length)!a.multiple()&&a.options()&&a.options().length&&(a.value(""),b(a.element).trigger("properties.value:changed",[""]));else{var d=a.getOptionValue(a.options()[0]);a.value(d),b(a.element).trigger("properties.value:changed",[d])}}function y(a,c){if(a.options){var d=null,e=a.options(),f=null,g=null,h="";if(!a.multiple()&&(null===a.optionsCaption()||""===a.optionsCaption())&&!a.value()&&a.options()&&e.length&&a.propertiesUpdateDone()){var i=a.getOptionValue(e[0]);a.value(i),b(a.element).trigger("properties.value:changed",[i])}if(a.multiple()){if(a.options()&&e.length&&a.selectedOptions()&&a.selectedOptions().length){var j=a.selectedOptions(),k="",l;return k=s(a._selectedOptions,a.getOptionText.bind(a)).join(" | "),h=k,a.text(h),h}}else if((null!==a.value()||""!==a.value())&&a.options()&&e.length){for(var m=0;m<e.length;m++)if(g=A(a,e[m],a.value())){d=g;break}
if(d)return h=a.getOptionText(d),a.text(h),h}return h=a.optionsCaption()||"",a.text(h),h}}function z(a,b,c){for(var d=[],e,f=0;f<c.length;f++){var g=c[f];if(null!==g)for(var h=0;h<b.length;h++)if(e=A(a,b[h],g)){d.push(e);break}}return d}function A(b,c,d){var e=b.getOptionValue(c),f=null;return void 0===d||null===d||void 0===e||null===e?f:("function"==typeof d.numericValue&&null!==d.numericValue()&&(d=d.numericValue()),b.optionsValue()?e.toString()===d.toString()&&(f=c):c===d.toString()?f=c:"object"==typeof d&&a.isEqual(d,c)&&(f=c),f)}function B(a,b){b.length||(a.value,a.selectedOptions&&a.selectedOptions([])),a.multiple()&&a.selectedOptions&&(a.updated_selectedOptions||(a._selectedOptions=z(a,b,a.selectedOptions()),y(a)),a.updated_selectedOptions=!1)}function C(a){}function D(a,c){null!==c&&b(a.element).trigger("valueChange",[c])}function E(a,c){if(a.multiple()){var d=a.options();a.updated_selectedOptions||(a._selectedOptions=z(a,d,c)),a.updated_selectedOptions=!1,
b(a.element).trigger("valueChange",[c])}}function F(a){a.optionsCaption()===a.text()&&a.text(""),G(a),a.setOptionContainerPosition(a),setTimeout(function(a){if("function"==typeof a.options&&"function"==typeof a.text){var c=m(a,a.options(),a.text());a.text()&&a.optionsCaption()!==a.text()&&c&&!a.isMobile&&b(a.element).find(".mi-selected-value-text").select()}}.bind(a,a),100)}function G(a){var c,f;b("body").find(".select-outer-container").length?c=b("body").find(".select-outer-container"):(c=document.createElement("div"),b(c).addClass("select-outer-container"),document.body.appendChild(c)),a.optionsContainerDiv||(f=document.createElement("div"),a.optionsContainerDiv=f,b(f).css("visibility","hidden"),b(c).append(f),a.optionsRegion.setElement(f),a.optionsRegion.attach(d),e.applyBindings(a,a.optionsRegion.activeContainer))}i.prototype.setOptionContainerPosition=function(a){var c,d,e,f,g,h,i,j=a.optionsContainerDiv;if(j){if(e=b(a.element).outerHeight(),
c=b(a.container).find(".mi-dropdown-selector").offset(),d=b(a.container).find(".mi-dropdown-selector").width(),!c)return;a.topOffset=c?c.top:0,a.leftOffset=c?c.left:0,b(j).css({position:"absolute","min-width":d,"z-index":1e5}),b(a.element).closest(".dialog-wrapper").length>0&&b(j).css({"max-width":d}),setTimeout(H.bind(null,a,j,c,d,e),1)}};function H(a,c,d,e,f){var g=b(c).outerWidth(),i=b(c).outerHeight(),j,k,l=b(c).find(".mi-select-options-container");l.removeClass("top-left top-right bottom-left bottom-right"),!a.isMobile&&h.innerHeight()<700&&b(".select-outer-container .mi-select-options-container").css("max-height","200px"),d.top+i+50>=b(window).height()?(j=d.top-i-20,d.left+e-g<80?(k=d.left,l.addClass("top-left")):(k=d.left-Math.abs(e-g),l.addClass("top-right"))):(j=a.topOffset+f+10,d.left+e-g<80?(k=d.left,l.addClass("bottom-left")):(k=d.left-Math.abs(e-g)+7,l.addClass("bottom-right"))),b(c).css({left:k,top:j,visibility:"visible"}),
b(c).find(".mi-select-option").hasClass("focus")||!a.multiple||a.multiple()||Q(a,"active")}function I(a){}function J(a,b){switch(b.keyCode){case 40:b.preventDefault(),O(a,b);break;case 38:b.preventDefault(),P(a,b);break;case 13:b.preventDefault(),K(a,b);break;default:return}}function K(a,c){var d=a.optionsContainerDiv,f=b(d).find(".mi-select-option.focus");if(f.length&&e.contextFor(b(f[0]).get(0))){var g=e.contextFor(b(f[0]).get(0)).$data;b(f[0]).hasClass("mi-select-caption")&&(g=null),a.selectValue(a,g,c),a.multiple()||(a.isOpen(!1),v(a),b(a.element).trigger("selected",[a.value()]),a.textFocus(!0))}}function L(a){var c=a.optionsContainerDiv;b(c).find(".mi-select-option").removeClass("focus")}function M(a){setTimeout(N.bind(null,a),10)}function N(a){if(!a.options||a.multiple&&a.multiple()||a.isOpen&&!a.isOpen())return!1;var c=a.options(),d=a.text(),e=!1,f=a.optionsContainerDiv;if(c&&c.length&&(e=m(a,c,d)),!e&&d&&d!==a.optionsCaption()){L(a);var g=a.optionsCaption()?1:0
;b(b(f).find(".mi-select-option")[g]).addClass("focus"),Q(a)}else e&&d&&d!==a.optionsCaption()&&(L(a),b(b(f).find(".mi-select-option")).filter(function(){return b(this).text()===d}).addClass("focus"),Q(a));!d&&a.value()&&(L(a),a.value()&&Q(a,"active"))}function O(a){var c=a.optionsContainerDiv,d=b(c).find(".mi-select-option.focus"),e=b(c).find(".mi-select-option.active"),f;b(c).find(".mi-select-option").removeClass("focus"),f=d.length&&b(d).nextAll(".mi-select-option:first").length?b(d).nextAll(".mi-select-option:first"):d.length&&!b(d).nextAll(".mi-select-option:first").length?b(b(c).find(".mi-select-option")[0]):e.length?b(e).nextAll(".mi-select-option:first"):b(b(c).find(".mi-select-option")[0]),f.addClass("focus");var g=a.options(),h=a.text(),i;g&&g.length&&((i=m(a,g,h))||a.optionsCaption()&&a.optionsCaption()===h)&&a.text(f.text()),Q(a)}function P(a){var c=a.optionsContainerDiv,d=b(c).find(".mi-select-option.focus"),e=b(c).find(".mi-select-option.active"),f
;b(c).find(".mi-select-option").removeClass("focus"),f=d.length&&b(d).prevAll(".mi-select-option:first").length?b(d).prevAll(".mi-select-option:first"):d.length&&!b(d).prevAll(".mi-select-option:first").length?b(c).find(".mi-select-option").last():e.length?b(e).prevAll(".mi-select-option:first"):b(b(c).find(".mi-select-option")[0]),f.addClass("focus");var g=a.options(),h=a.text(),i;g&&g.length&&((i=m(a,g,h))||a.optionsCaption()&&a.optionsCaption()===h)&&a.text(f.text()),Q(a)}function Q(a,c){var d=a.optionsContainerDiv,e=c||"focus",f=b(d).find(".mi-select-option."+e);f&&f[0]&&(f[0].parentNode.scrollTop=f[0].offsetTop)}function R(a){return a.replace(/<([a-z]+)([^>]*[^\/])?>(?![\s\S]*<\/\1)/gi,function(a){return b("<div/>").text(a).html()})}return g.register("mi-select",i),i});

define('text!ui/elements/multi-value/template.html',[],function () { return '<div class="mi-multi-value-container" data-bind="visible:visible,css:{\'disabled\':disabled,\'open\':isOpen,\'required\':isRequired}">\r\n    <div data-bind="css:{\'active\':isOpen},clickBubble: false, hasFocus:textFocus, event:{\r\n            keyup: handleKeyUpOnTextInput,\r\n            keydown:handleKeyDownOnTextInput,\r\n            click:handleKeyUpOnTextInput,\r\n            mousedown:handleKeyUpOnTextInput\r\n         }" class="mi-multi-value-selector">\r\n        <input type="text" class="mi-multi-value-selected-value-text pull-left" data-bind="value:text,\r\n                                                                                            valueUpdate:\'keyup\',\r\n             \r\n                                                                                            attr:{\'readonly\':(disabled() || multiple() || isMobile),\r\n                                                                                                   \'disabled\':disabled()},\r\n                                                                                            event:{keyup: handleKeyUpOnTextInput}" />\r\n        <!--<span class="mi-multi-value-selected-value-text pull-left" data-bind="text:selectedValueText"></span>-->\r\n        <i class="icon-arrow pull-right"></i>\r\n    </div>\r\n</div>';});


define('text!ui/elements/multi-value/options-template.html',[],function () { return '<div data-bind="visible:isOpen(),event:{mousedown:function(data,event){event.stopPropagation();}}" class="mi-multi-value-options-container">\r\n    <p class="mi-multi-value-option mi-multi-value-input" data-bind="event:{mousedown:inputMouseDown}">\r\n        <input type="text" data-bind="attr:{ placeholder: addCaptionText}, value:addValue,event:{\'keydown\':addValueUpdate}" />\r\n    </p>\r\n\r\n   <!-- ko if:optionsCaption -->\r\n    <p class="mi-multi-value-option mi-multi-value-caption" data-bind="text:optionsCaption,\r\n                                                                       event:{click:function(data,event){$root.selectValue($root,null,event);}}"></p>\r\n    <!-- /ko -->\r\n\r\n    <!-- ko foreach:filteredOptions -->\r\n    <p class="mi-multi-value-option" data-bind="text:$parent.getOptionText($data),\r\n                                            event:{click:function(data,event){$root.selectValue($root,data,event);}},\r\n                                            css:{\'active\':$parent.isActive($data)}">\r\n\r\n    </p>\r\n    <!-- /ko -->\r\n     \r\n   \r\n\r\n  \r\n\r\n</div>\r\n';});

define('ui/elements/multi-value/view-model',['require','lodash','jquery','text!./template.html','text!./options-template.html','knockout','spa/region','system/globalization/translator','../select/element','system/hardware/device'],function(require){"use strict";var a=require("lodash"),b=require("jquery"),c=require("text!./template.html"),d=require("text!./options-template.html"),e=require("knockout"),f=require("spa/region"),g=require("system/globalization/translator"),h=require("../select/element"),i=Object.resolve(require("system/hardware/device"));function j(){k.call(this,c,!1,!0);var a=this;this.translator=Object.resolve(g),this.optionsValue=e.observable(),this.optionsText=e.observable(),this.multiple=e.observable(!1),this.optionsCaption=e.observable(""),this.options=e.observableArray([]),this.value=e.observable(),this.required=e.observable(!1),this.disabled=e.observable(!1),this.visible=e.observable(!0),this.selectedOptions=e.observableArray([]),this.autoAdd=e.observable(!0),this.onOptionAdd=e.observable(),this.addCaption=e.observable(this.translator.translate("MULTI_VALUE_ADD_OPTION_PLACEHOLDER")),this.text=e.observable(),this.textFocus=e.observable(!1),this.keyPressed=e.observable(!1),
this.currentText=null,this.isOpen=e.observable(!1),this.selectedItem=e.observable(),this.addValue=e.observable(),this.optionsRegion=new f,this.isClicked=!1,this.isMobile=i.isMobile(),this.isRequired=e.computed(p.bind(a,a)),this.isRequiredSubscriber=this.isRequired.subscribe(q.bind(a,a)),this.addCaptionText=e.computed(o.bind(null,this)),this.selectedValueText=e.computed(u.bind(null,this)),this.filteredOptions=e.computed(l.bind(null,this)),this.addValueUpdate=r,this.addValueSubscription=this.addValue.subscribe(a.addOption,this),this.documentHandlerFn=s.bind(null,a),this.filteredOptionsSubscriber=null}var k=Object.inherit(h.ViewModel,j);j.prototype.beforeAttached=function(){var a=this;this.filteredOptionsSubscriber=this.filteredOptions.subscribe(n.bind(a,a)),b(document).on("mousedown",this.documentHandlerFn)},j.prototype.afterDetached=function(){var a=this;b(window).off("resize",a.resizeProxy),b(a.element).parents().off("scroll",a.scrollProxy),b(a.element).off(),
b(document).off("mousedown",a.documentHandlerFn),a.translator=null,a.optionsValue=null,a.optionsText=null,a.multiple=null,a.optionsCaption=null,a.options=null,a.value=null,a.required=null,a.disabled=null,a.visible=null,a.selectedOptions=null,a.autoAdd=null,a.onOptionAdd=null,a.addCaption=null,a.text=null,a.textFocus=null,a.keyPressed=null,a.currentText=null,a.isOpen=null,a.selectedItem=null,a.addValue=null,a.optionsRegion&&(a.optionsRegion.detach(),a.optionsRegion=null),a.isClicked=null,a.isMobile=null,a.isRequired&&(a.isRequired.dispose(),a.isRequired=null),a.isRequiredSubscriber&&(a.isRequiredSubscriber.dispose(),a.isRequiredSubscriber=null),a.addCaptionText&&(a.addCaptionText.dispose(),a.addCaptionText=null),a.selectedValueText&&(a.selectedValueText.dispose(),a.selectedValueText=null),a.filteredOptions&&(a.filteredOptions.dispose(),a.filteredOptions=null),a.addValueUpdate=null,a.addValueSubscription&&(a.addValueSubscription.dispose(),a.addValueSubscription=null),
a.documentHandlerFn=null,a.filteredOptionsSubscriber&&(a.filteredOptionsSubscriber.dispose(),a.filteredOptionsSubscriber=null),a.resizeProxy=null,a.scrollProxy=null,a.optionsContainerDiv=null},j.prototype.inputMouseDown=function(a,b){b.stopPropagation(),b.target.focus()};function l(a){if(!a.options)return[];var b=[].concat(a.options()),c=a.text(),d=[],f=b,g=[],h,i=a.optionsCaption(),j,k;return b&&b.length?(g=F(a,f,c),h=i!==c,a.text()&&h&&a.keyPressed()&&(c=m(c),j=new RegExp(c.trim(),"i"),k=e.utils.arrayFilter(b,function(b){var c=a.getOptionText(b);return j.test(c)}),(!g||g&&k.length>1)&&(f=k.length?k:b)),d=null!==f?f:b):void 0}function m(a){return null!==a&&(a=a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")),a}function n(a,b){a.setOptionContainerPosition.bind(null,a)()}function o(a){return a.addCaption()||a.translator.translate("MULTI_VALUE_ADD_OPTION_PLACEHOLDER")}function p(a){return a.required()&&!a.hasValue()}function q(a,c){
a.isRequired()?b(a.element).addClass("mi-multi-value-required"):b(a.element).removeClass("mi-multi-value-required")}j.prototype.hasValue=function a(){var b=this;if(b.multiple()){if(b.selectedOptions()&&b.selectedOptions().length)return!1}else if(!b.value())return!1;return!0},j.prototype.addOption=function a(c){var d=c,e=this;if(c){if(("object"==typeof e.options()[0]||e.optionsText())&&(d={},d[e.optionsText()]=c,d[e.optionsValue()]=c),e.onOptionAdd(d),e.options.push(d),e.multiple()){if(e.multiple()){var f=e.selectedOptions();f.push(e.getOptionValue(d)),e.text(f),e.selectedOptions(f),b(e.element).trigger("properties.selectedOptions:changed",[e.selectedOptions()])}}else e.selectedItem(d),e.value(e.getOptionValue(d)),b(e.element).trigger("properties.value:changed",[e.value()]);e.addValue("")}};function r(a,b){switch(b.keyCode){case 13:b.target.blur(),b.target.focus();break;case 9:a.toggleOptions();break;case 40:b.preventDefault(),P(a,b,!0);break;case 38:b.preventDefault(),Q(a,b)}return!0}
function s(a){a.isClicked?a.isClicked=!1:(a.isOpen()&&(a.isOpen(!1),E(a),b(a.element).trigger("selected",[a.multiple()?a.selectedOptions():a.value()])),u(a))}j.prototype.afterAttached=function(){},j.prototype.afterCreated=function(){},j.prototype.beforeCreated=function(){var c=this;this.bindAttribute("optionsText",null),this.bindAttribute("optionsValue",null),this.bindAttribute("optionsCaption",null),this.bindAttribute("addCaption",null),this.bindAttribute("options",[],w.bind(null,this),!0),this.bindAttribute("value",null,z.bind(null,this),!0),this.bindAttribute("selectedOptions",[],null,!0),this.bindAttribute("disabled",!1),this.bindAttribute("required",!1),this.bindAttribute("visible",!0),this.bindAttribute("multiple",!1,x.bind(null,this)),this.bindAttribute("autoAdd",!0),this.bindAttribute("onOptionAdd",null),this.resizeProxy=b.proxy(a.debounce(this.resize.bind(null,this),100),this),this.scrollProxy=b.proxy(this.scrollHandler,this),
b(this.element).on("properties.options:changed",function(a,b){}.bind(this)),b(this.element).on("properties.value:changed",z.bind(null,this)),b(this.element).on("properties.multiple:changed",function(a,b){}.bind(this)),b(this.element).on("properties.size:changed",function(a,b){}.bind(this)),b(this.element).on("properties.selectedOptions:changed",A.bind(null,this))},j.prototype.selectValue=function(c,d,e){if(e&&(e.preventDefault(),e.stopPropagation()),c.disabled())return!1;if(c.multiple()){if(c.multiple()){if(!d)return!0;var f=c.selectedOptions(),g=f||[],h=c.getOptionValue(d);b.inArray(h,c.selectedOptions())===-1?g.push(h):g=b.grep(g,function(a){return a!==h}),c.selectedOptions(g),b(c.element).trigger("properties.selectedOptions:changed",[g]),c.textFocus(!0)}}else{var i;if(c.selectedItem(d),a.isEqual(d,c.value()))u(c);else{if(d){var j=c.getOptionValue(d);return i=j,c.textFocus(!0),c.isOpen(!1),E(c),c.value&&c.value(j),b(c.element).trigger("properties.value:changed",[i]),
b(c.element).trigger("selected",[c.value?c.value():c.value]),!0}c.value("");var k=c.optionsCaption()?c.optionsCaption():"";c.text(k),i="",b(c.element).trigger("properties.value:changed",[i])}c.textFocus(!0),c.isOpen(!1),E(c),b(c.element).trigger("selected",[c.value()])}return!0},j.prototype.toggleOptions=function(a,c){var d=this;return c&&c.stopPropagation(),d.disabled()||d.options()&&!d.options().length?(d.textFocus(!0),E(d),d.isOpen(!1),!1):(d.isClicked=!0,b(document).trigger("mousedown",[d.element]),d.isOpen()?(E(d),b(d.element).trigger("selected",[d.multiple()?d.selectedOptions():d.value()])):(C(d),D(d)),d.isOpen()||b(d.optionsContainerDiv).css("visibility","hidden"),d.textFocus()||d.textFocus(!0),d.isOpen(!d.isOpen()),!0)};function t(a){e.cleanNode(a.optionsRegion.activeContainer),b(".multi-value-outer-container").remove(),b(window).off("resize",a.resizeProxy),b(a.element).parents().off("scroll",a.scrollProxy)}function u(a){if(a.options){var b=null,c=a.options(),d=null,e=null,f=""
;if(a.multiple()){if(c&&a.selectedOptions()&&a.selectedOptions().length){for(var g=a.selectedOptions(),h="",i=0;i<g.length;i++){for(var j=g[i],k=0;k<c.length;k++)if(e=v(a,c[k],j)){b=e;break}var l=h?", ":"";h+=l+a.getOptionText(b)}return a.text(g),h}}else if(a.value()&&c){for(var m=0;m<c.length;m++)if(e=v(a,c[m],a.value())){b=e;break}if(b)return f=a.getOptionText(b),a.text(f),f}return f=a.optionsCaption()||"",a.text(f),f}}function v(b,c,d){var e=b.getOptionValue(c),f=null;return b.optionsValue()?e.valueOf()===d.valueOf()&&(f=c):c.valueOf()===d.valueOf()?f=c:"object"==typeof d&&a.isEqual(d,c)&&(f=c),f}j.prototype.getValue=function(a){var b=a;return"function"==typeof a&&(b=a()),b},j.prototype.getReturnValue=function(a,b){return"function"==typeof a?a.call(b,b):b?b[a]:b},j.prototype.getOptionText=function(a){var b=this;return b.optionsText()?b.getValue(b.getReturnValue(b.optionsText(),a)):a},j.prototype.getOptionValue=function(a){var b=this
;return b.optionsValue()?b.getValue(b.getReturnValue(b.optionsValue(),a)):a},j.prototype.isActive=function(c){var d=this;return d.multiple()?b.inArray(d.getOptionValue(c),d.selectedOptions())!==-1:null===d.getOptionValue(c)||null===d.value()?d.getOptionValue(c)===d.value():"object"!=typeof d.value()||d.optionsValue()?d.getOptionValue(c).valueOf()===d.value().valueOf():a.isEqual(c,d.value())},j.prototype.resize=function(a){a.isMobile||(a.isOpen(!1),t(a))},j.prototype.scrollHandler=function(){this.isOpen(!1),t(this)};function w(){}function x(a){}function y(a){}function z(a,c){b(a.element).trigger("valueChange",[c])}function A(a,b,c){}function B(a){this.option=a,this.isSelected=e.observable(!1)}function C(a){a.optionsRegion.$element.hasClass("multi-value-outer-container")&&a.optionsRegion.$element.remove();var c;c=document.createElement("div"),a.optionsContainerDiv=c,b(c).addClass("multi-value-outer-container"),document.body.appendChild(c),a.optionsRegion.setElement(c),
a.optionsRegion.attach(d),e.applyBindings(a,a.optionsRegion.activeContainer),a.setOptionContainerPosition(a)}j.prototype.setOptionContainerPosition=function(a){var c,d,e=30,f,g,h,i,j=a.optionsContainerDiv;j&&(c=b(a.container).find(".mi-multi-value-selector").offset(),d=b(a.container).find(".mi-multi-value-selector").width(),a.topOffset=c.top,a.leftOffset=c.left,b(j).css({position:"absolute","min-width":d,"z-index":1e5}),setTimeout(function(){f=b(j).width(),g=b(j).height(),b(j).find(".mi-multi-value-options-container").removeClass("top-left top-right bottom-left bottom-right"),c.top+g+50>=b(window).height()?(h=c.top-g-20,c.left+d-f<80?(i=c.left,b(j).find(".mi-multi-value-options-container").addClass("top-left")):(i=c.left-Math.abs(d-f),b(j).find(".mi-multi-value-options-container").addClass("top-right"))):(h=a.topOffset+e+10,c.left+d-f<80?(i=c.left,b(j).find(".mi-multi-value-options-container").addClass("bottom-left")):(i=c.left-Math.abs(d-f),
b(j).find(".mi-multi-value-options-container").addClass("bottom-right"))),b(j).css({left:i,top:h})},1))},j.prototype.showOptions=function a(c){var d=this;this.isOpen()||13===c.keyCode||d.disabled()||(b(d.optionsContainerDiv).css("visibility","hidden"),d.isClicked=!0,b(document).trigger("mousedown",[d.element]),this.isOpen(!0),C(this),D(d))},j.prototype.handleKeyUpOnTextInput=function a(b,c){return c.stopPropagation(),this.isOpen()||this.keyPressed(!1),"keyup"===c.type&&this.keyPressed(!0),this.showOptions(c),!0},j.prototype.handleKeyDownOnTextInput=function a(c,d){var e=this;if(d.stopPropagation(),b(e.element).trigger("textChange",[d]),9===d.keyCode)e.isOpen(!1),E(e),u(e),b(e.element).trigger("selected",[e.multiple()?e.selectedOptions():e.value()]);else{if(8===d.keyCode&&(e.multiple()||e.disabled()))return!1;H.bind(null,e)(d)}return!0};function D(a){b(a.element).parents().on("scroll",a.scrollProxy)}function E(a){b(a.optionsContainerDiv).css("visibility","hidden"),
b(a.element).parents().off("scroll",a.scrollProxy),J(a)}function F(b,c,d){return d!==b.currentText&&(b.currentText=d,b.currentMatchedOptions=a.find(c,G.bind(b,b,d))),b.currentMatchedOptions}function G(a,b,c){var d=a.getOptionText(c);return d&&d.toString()===b.toString()}function H(a,b){switch(b.keyCode){case 40:b.preventDefault(),P(a,b);break;case 38:b.preventDefault(),Q(a,b);break;case 13:b.preventDefault(),I(a,b);break;default:return}}function I(a,c){var d=a.optionsContainerDiv,f=b(d).find(".mi-multi-value-option.focus");if(f.length&&e.contextFor(b(f[0]).get(0))){var g=e.contextFor(b(f[0]).get(0)).$data;if(b(f[0]).hasClass("mi-multi-value-caption"))g=null;else if(K(a,f))return void L(a,f);a.selectValue(a,g,c),a.multiple()||(a.isOpen(!1),E(a),b(a.element).trigger("selected",[a.value()]),a.textFocus(!0))}}function J(a){var c=a.optionsContainerDiv;b(c).find("mi-multi-value-option").removeClass("focus")}function K(a,c){return b(c[0]).hasClass("mi-multi-value-input")}function L(a,c){
b(c[0]).find("input").focus()}function M(a,b){if(K(a,b))return L(a,b),!0;a.textFocus(!0)}function N(a){setTimeout(O.bind(null,a),10)}function O(a){if(!a.options||a.multiple&&a.multiple())return!1;var c=a.options(),d=a.selectedValueText(),e=!1,f=a.optionsContainerDiv;if(c&&c.length&&(e=F(a,c,d)),!e&&d&&d!==a.optionsCaption()){J(a);var g=a.optionsCaption()?1:0;b(b(f).find(".mi-multi-value-option")[g]).addClass("focus"),R(a)}else e&&d&&d!==a.optionsCaption()&&(J(a),b(b(f).find(".mi-multi-value-option")).filter(function(){return b(this).text()===d}).addClass("focus"),R(a));!d&&a.value()&&(J(a),a.value()&&R(a,"active"))}function P(a,c,d){var e=a.optionsContainerDiv,f=b(e).find(".mi-multi-value-option.focus"),g=b(e).find(".mi-multi-value-option.active"),h;b(e).find(".mi-multi-value-option").removeClass("focus"),
h=f.length&&b(f).nextAll(".mi-multi-value-option:first").length?b(f).nextAll(".mi-multi-value-option:first"):f.length&&!b(f).nextAll(".mi-multi-value-option:first").length?b(b(e).find(".mi-multi-value-option")[0]):g.length?b(g).nextAll(".mi-multi-value-option:first"):b(b(e).find(".mi-multi-value-option")[d?1:0]),h.addClass("focus"),M(a,h);var i=a.options(),j=a.selectedValueText(),k;i&&i.length&&((k=F(a,i,j))||a.optionsCaption()&&a.optionsCaption()),R(a)}function Q(a){var c=a.optionsContainerDiv,d=b(c).find(".mi-multi-value-option.focus"),e=b(c).find(".mi-multi-value-option.active"),f;b(c).find(".mi-multi-value-option").removeClass("focus"),f=d.length&&b(d).prevAll(".mi-multi-value-option:first").length?b(d).prevAll(".mi-multi-value-option:first"):d.length&&!b(d).prevAll(".mi-multi-value-option:first").length?b(c).find(".mi-multi-value-option").last():e.length?b(e).prevAll(".mi-multi-value-option:first"):b(b(c).find(".mi-multi-value-option")[0]),f.addClass("focus"),M(a,f)
;var g=a.options(),h=a.selectedValueText(),i;g&&g.length&&((i=F(a,g,h))||a.optionsCaption()&&a.optionsCaption()),R(a)}function R(a,c){var d=a.optionsContainerDiv,e=c||"focus",f=b(d).find(".mi-multi-value-option."+e);f&&f[0]&&(f[0].parentNode.scrollTop=f[0].offsetTop)}function S(a){return a.replace(/<([a-z]+)([^>]*[^\/])?>(?![\s\S]*<\/\1)/gi,function(a){return b("<div/>").text(a).html()})}return h.register("mi-multi-value",j),j});
define('assets/services/hierarchy-dto',['require','system/lang/converter'],function(require){"use strict";var a=require("system/lang/converter");function b(b){this.entityKey=a.toString(b.entityKey),this.description=a.toString(b.description),this.familyKey=a.toString(b.familyKey),this.familyId=a.toString(b.familyId),this.siteKey=a.toNullableString(b.siteKey),this.hasChildren=null,b.childCount&&(this.hasChildren=a.toInteger(b.childCount)>0),b.hierarchyPath&&(this.hierarchyPath=a.toString(b.hierarchyPath))}return b.fromDataCollection=function a(c){for(var d=[],e=0;e<c.length;e++)d[d.length]=new b(c[e]);return d},b});
define('assets/services/hierarchy-paging-dto',[],function(){"use strict";function a(a){this.page=a.page||1,this.pageSize=a.per_page||25,this.data=null}return a});
define('assets/services/taxonomy-dto',['require','lodash','system/lang/converter'],function(require){"use strict";var a=require("lodash"),b=require("system/lang/converter");function c(a,c){this.code=b.toString(a),this.description=b.toString(c),this.children=[]}return c.fromDataCollection=function b(d){for(var e=[],f=a.values(a.groupBy(d,"categoryCode")),g,h,i,j,k=0;k<f.length;k++){g=new c(f[k][0].categoryCode,f[k][0].categoryDescription),e[e.length]=g,h=a.values(a.groupBy(f[k],"classCode"));for(var l=0;l<h.length;l++){i=new c(h[l][0].classCode,h[l][0].classDescription),g.children[g.children.length]=i;for(var m=0;m<h[l].length;m++)j=new c(h[l][m].typeCode,h[l][m].typeDescription),i.children[i.children.length]=j}}return e},c});
define('assets/models/family',['require','system/lang/converter'],function(require){"use strict";var a=require("system/lang/converter");function b(b){b=b||{},this.key=a.toString(b.key),this.id=a.toString(b.id),this.caption=a.toString(b.caption)}return b.fromDataCollection=function a(c){var d,e=[];for(d=0;d<c.length;d++)e[d]=new b(c[d]);return e},b});
define('assets/models/field',['require','system/lang/converter'],function(require){"use strict";var a=require("system/lang/converter");function b(b){this.key=a.toString(b.key),this.caption=a.toString(b.caption)}return b});
define('assets/models/hierarchy-configuration',['require','system/lang/converter','assets/models/family','assets/models/field','system/knockout/knockout-manager'],function(require){"use strict";var a=require("system/lang/converter"),b=require("assets/models/family"),c=require("assets/models/field"),d=require("system/knockout/knockout-manager");function e(e){var h,i;if(e=e||{},this.kom=Object.resolve(d),this.entityKey=a.toString(e.entityKey),this.displayFieldKey=this.kom.observable(a.toString(e.displayFieldKey)),this.parentDisplayFieldKey=this.kom.observable(a.toString(e.parentDisplayFieldKey)),this.parentKey=this.kom.observable(a.toString(e.parentKey)),this.childKey=this.kom.observable(a.toString(e.childKey)),i=[],e.children)for(h=0;h<e.children.length;h++)i[i.length]=new b(e.children[h]);if(this.children=this.kom.observableArray(i),this.relationshipKey=this.kom.observable(a.toString(e.relationshipKey)),i=[],e.relationships)for(h=0;h<e.relationships.length;h++)i[i.length]=new b(e.relationships[h]);if(this.relationships=this.kom.observableArray(i),this.taxonomyCategoryFieldKey=this.kom.observable(a.toString(e.taxonomyCategoryFieldKey)),
this.parentTaxonomyCategoryFieldKey=this.kom.observable(a.toString(e.parentTaxonomyCategoryFieldKey)),this.taxonomyClassFieldKey=this.kom.observable(a.toString(e.taxonomyClassFieldKey)),this.parentTaxonomyClassFieldKey=this.kom.observable(a.toString(e.parentTaxonomyClassFieldKey)),this.taxonomyTypeFieldKey=this.kom.observable(a.toString(e.taxonomyTypeFieldKey)),this.parentTaxonomyTypeFieldKey=this.kom.observable(a.toString(e.parentTaxonomyTypeFieldKey)),this.level=this.kom.observable(a.toInteger(e.level)),i=[],e.fields)for(h=0;h<e.fields.length;h++)i[i.length]=new c(e.fields[h]);if(this.fields=this.kom.observableArray(i),i=[],e.parentFields)for(h=0;h<e.parentFields.length;h++)i[i.length]=new c(e.parentFields[h]);this.parentFields=this.kom.observableArray(i),this.isNotRecursive=this.kom.computed(g.bind(null,this)),this.kom.tracker.hashFunction=f.bind(null,this),this.kom.tracker.markCurrentStateAsClean()}e.prototype.isDirty=function(){return this.kom.isDirty()},
e.prototype.markClean=function(){this.kom.tracker.markCurrentStateAsClean()},e.prototype.dispose=function(){this.kom.dispose()};function f(a){var b;return b={level:a.level(),displayField:a.displayFieldKey(),parentFamilyKey:a.parentKey(),childFamilyKey:a.childKey(),relationshipKey:a.relationshipKey(),taxonomyCategeoryField:a.taxonomyCategoryFieldKey(),taxonomyClassField:a.taxonomyClassFieldKey(),taxonomyTypeField:a.taxonomyTypeFieldKey(),parentDisplayField:a.parentDisplayFieldKey(),parentTaxonomyCategeoryField:a.parentTaxonomyCategoryFieldKey(),parentTaxonomyClassField:a.parentTaxonomyClassFieldKey(),parentTaxonomyTypeField:a.parentTaxonomyTypeFieldKey()},JSON.stringify(b)}function g(a){return 0===a.level()&&a.parentKey()!==a.childKey()}return e});
define('assets/models/hierarchy-config-dto',[],function(){"use strict";function a(a){a=a||{},this.entityKey=a.entityKey,this.displayFieldKey=a.displayFieldKey(),this.parentKey=a.parentKey(),this.childKey=a.childKey(),this.relationshipKey=a.relationshipKey(),this.taxonomyCategoryFieldKey=a.taxonomyCategoryFieldKey(),this.taxonomyClassFieldKey=a.taxonomyClassFieldKey(),this.taxonomyTypeFieldKey=a.taxonomyTypeFieldKey(),this.level=a.level(),this.parentDisplayFieldKey=a.parentDisplayFieldKey(),this.parentTaxonomyCategoryFieldKey=a.parentTaxonomyCategoryFieldKey(),this.parentTaxonomyClassFieldKey=a.parentTaxonomyClassFieldKey(),this.parentTaxonomyTypeFieldKey=a.parentTaxonomyTypeFieldKey()}return a});
define('assets/adapters/hierarchy-config-adapter',['require','assets/models/hierarchy-configuration','assets/models/hierarchy-config-dto'],function(require){"use strict";var a=require("assets/models/hierarchy-configuration"),b=require("assets/models/hierarchy-config-dto");function c(){}return c.fromDTOArray=function(b){var c,d,e=[];for(c=0;c<b.length;c++)d=new a(b[c]),e[e.length]=d;return e},c.toDTO=function(a){return new b(a)},c});
define('assets/services/hierarchy-service',['require','jquery','system/http/ajax-client','assets/services/hierarchy-dto','assets/services/hierarchy-paging-dto','assets/services/taxonomy-dto','assets/services/asset-context-dto','assets/adapters/hierarchy-config-adapter','assets/models/family','assets/models/field','system/globalization/translator','application/application-context'],function(require){"use strict";var a=require("jquery"),b=require("system/http/ajax-client"),c=require("assets/services/hierarchy-dto"),d=require("assets/services/hierarchy-paging-dto"),e=require("assets/services/taxonomy-dto"),f=require("assets/services/asset-context-dto"),g=require("assets/adapters/hierarchy-config-adapter"),h=require("assets/models/family"),i=require("assets/models/field"),j=require("system/globalization/translator"),k=require("application/application-context"),l="api/common/assethierarchy/",m="MI_AST_GRP",n="api/core/userpref",o="asset-hierarchy-key",p=7;function q(a,b){this.ajaxClient=a,this.request=null,this.translator=b}q.dependsOn=[b,j],q.prototype.get=function(){var b=a.Deferred();return this.ajaxClient.get(l).done(A.bind(null,b)).fail(b.reject.bind(b)),b},q.prototype.children=function b(c,d,e,f,g,h){var i=a.Deferred(),j=l+"children";return c&&(j+="/"+c.toString()),
j+="?taxonomyCategory="+d+"&taxonomyClass="+e+"&taxonomyType="+f+"&page="+g+"&pageSize="+h,this.request=this.ajaxClient.get(j),this.request.done(v.bind(null,this,i)),this.request.fail(t.bind(null,i)),i.promise()},q.prototype.childrenFilteredBySites=function(b,c,d,e,f,g,h){var i=a.Deferred(),j=l+"children";return b&&(j+="/"+b.toString()),j+="?taxonomyCategory="+c+"&taxonomyClass="+d+"&taxonomyType="+e+"&page="+f+"&pageSize="+g,this.request=this.ajaxClient.post(j,h),this.request.done(v.bind(null,this,i)),this.request.fail(t.bind(null,i)),i.promise()},q.prototype.search=function b(c,d,e){var f=a.Deferred(),g=l;return g+="search?term="+encodeURIComponent(c)+"&page="+d+"&pageSize="+e,this.ajaxClient.get(g).done(w.bind(null,this,f)).fail(f.reject.bind(f)),f.promise()},q.prototype.searchFilteredBySites=function(b,c,d,e){var f=a.Deferred(),g=l;return g+="search?term="+encodeURIComponent(b)+"&page="+c+"&pageSize="+d,this.ajaxClient.post(g,e).done(w.bind(null,this,f)).fail(f.reject.bind(f)),
f.promise()},q.prototype.assets=function b(c,d){var e,f=a.Deferred(),g=l+"assets/"+c.toString();if(d&&d.length>0)for(e=0;e<d.length;e++)g+=(0===e?"?":"&")+"families="+d[e].toString();return this.ajaxClient.get(g).done(u.bind(null,f)).fail(f.reject.bind(f)),f.promise()},q.prototype.assetsFilteredBySites=function b(c,d){var e=a.Deferred(),f=l+"assets/"+c.toString();return this.ajaxClient.post(f,d).done(u.bind(null,e)).fail(e.reject.bind(e)),e.promise()},q.prototype.abort=function a(){this.request&&this.request.abort()},q.prototype.taxonomy=function b(){var c=a.Deferred();return this.ajaxClient.get(l+"taxonomy").done(x.bind(null,c)).fail(c.reject.bind(c)),c.promise()},q.prototype.path=function b(c){var d=a.Deferred();return c&&"-1"!==c&&"0"!==c?(this.request=this.ajaxClient.get(l+"path/"+c),this.request.done(y.bind(null,this,d)),this.request.fail(d.reject.bind(d)),d.promise()):(setTimeout(y.bind(null,this,d,[]),0),d.promise())},q.prototype.pathAll=function b(c,d){
var e=a.Deferred(),f=l+"pathAll/"+d;return this.ajaxClient.post(f,c).done(z.bind(null,this,e)).fail(e.reject.bind(e)),e.promise()},q.prototype.families=function(){var b=a.Deferred();return this.ajaxClient.get(l+"families").done(B.bind(null,b)).fail(b.reject.bind(b)),b.promise()},q.prototype.relationships=function(b){var c=a.Deferred();return this.ajaxClient.get(l+"families/"+b.toString()).done(B.bind(null,c)).fail(c.reject.bind(c)),c.promise()},q.prototype.getPartialFamily=function(b){var c=a.Deferred();return this.ajaxClient.get(l+"family/"+b.toString()).done(D.bind(null,c)).fail(c.reject.bind(c)),c.promise()},q.prototype.relationshipsById=function(){var b=a.Deferred();return this.ajaxClient.get(l+"families/"+m).done(B.bind(null,b)).fail(b.reject.bind(b)),b.promise()},q.prototype.relatedFamilies=function(b,c){var d=l+"families/"+b.toString()+"/"+c.toString(),e=a.Deferred();return this.ajaxClient.get(d).done(B.bind(null,e)).fail(e.reject.bind(e)),e.promise()},
q.prototype.familyFields=function(b){var c=a.Deferred();return this.ajaxClient.get(l+"families/"+b.toString()+"/fields").done(C.bind(null,c)).fail(c.reject.bind(c)),c.promise()},q.prototype.updateConfiguration=function(a){return this.ajaxClient.put(l,a)},q.prototype.rebuild=function(){return this.ajaxClient.post(l+"rebuild")},q.prototype.storeAssetHierarchyKey=function(a){return this.ajaxClient.post(n+"/set",r(a))};function r(a){return{userKey:s(),prefType:p,name:o,value:a}}function s(){return k.user.key}function t(a,b,c,d){"abort"!==c&&a.reject(b,c,d)}function u(a,b){a.resolve(c.fromDataCollection(b))}function v(a,b,e){var f;a.request=null,f=new d(e),f.data=c.fromDataCollection(e.data),b.resolve(f)}function w(a,b,e){var f;f=new d(e),f.data=c.fromDataCollection(e.data),b.resolve(f)}function x(a,b){a.resolve(e.fromDataCollection(b))}function y(a,b,c){var d=f.fromDataCollection(c);d.unshift({description:a.translator.translate("ASSET_HIERARCHY_ROOT"),entityKey:"-1"}),b.resolve(d)}
function z(a,b,c){b.resolve(f.fromDataCollection(c))}function A(a,b){a.resolve(g.fromDTOArray(b))}function B(a,b){var c,d=[];for(c=0;c<b.length;c++)d[d.length]=new h(b[c]);a.resolve(d)}function C(a,b){var c,d=[];for(c=0;c<b.length;c++)d[d.length]=new i(b[c]);a.resolve(d)}function D(a,b){var c={},d=0;for(c.relationships=[],c.parentFields=[],d=0;d<b.parentFields.length;d++)c.parentFields[c.parentFields.length]=new i(b.parentFields[d]);for(d=0;d<b.relationships.length;d++)c.relationships[c.relationships.length]=new h(b.relationships[d]);a.resolve(c)}return q});

define('text!assets/views/asset-hierarchy-control-filter.html',[],function () { return '<div class="filter-trigger-container">\r\n    <button class="btn btn-default btn--bare actionable actionable--secondary filter-trigger-btn">\r\n        <i class="icon-collection-filter"></i>\r\n        <span class="filter-txt label--inline" for="filter-icon">Filter</span>\r\n    </button>\r\n    <button class="ahc-filters-clear-btn pull-right hide">Clear</button>\r\n</div>\r\n<div class="uacb-filter-popup hide"></div>';});

define('assets/asset-hierarchy-control-filter',['require','jquery','assets/services/hierarchy-service','spa/ko/knockout-view-model','system/knockout/knockout-manager','system/globalization/translator','text!./views/asset-hierarchy-control-filter.html'],function(require){"use strict";var a=require("jquery"),b=require("assets/services/hierarchy-service"),c=require("spa/ko/knockout-view-model"),d=require("system/knockout/knockout-manager"),e=require("system/globalization/translator"),f=require("text!./views/asset-hierarchy-control-filter.html");function g(a,c,g){h.call(this,f),this.service=Object.resolve(b),this.translator=Object.resolve(e),this.categories=null,this.classes=null,this.types=null,this.currentCategory=a,this.currentClass=c,this.currentType=g,this.kom=Object.resolve(d)}var h=Object.inherit(c,g);g.prototype.load=function a(){this.categories=this.kom.observableArray(),this.classes=this.kom.computed(m.bind(null,this)),this.types=this.kom.computed(n.bind(null,this)),this.service.taxonomy().done(l.bind(null,this))},g.prototype.attach=function b(c){c.attach(a(f)),h.prototype.attach.call(this,c),c.element.querySelector(".apply").addEventListener("click",this),c.$element.addClass("asset-hierarchy-filter-popover")},
g.prototype.detach=function(a){a.element.querySelector(".apply").removeEventListener("click",this),h.prototype.detach(a)},g.prototype.unload=function a(){this.kom.dispose()},g.prototype.translate=function a(b){return this.translator.translate(b)},g.prototype.handleEvent=function b(c){"click"===c.type&&c.target.classList.contains("apply")&&(a(".hierarchy-control-filter")[0].closeFilter(),a(".hierarchy-control-filter").trigger("filter-closed"))};function i(a,b){var c,d;for(c=a.currentCategory().code,d=0;d<b.length;){if(b[d].code===c){a.currentCategory(b[d]);break}d++}}function j(a){var b,c,d;for(b=a.currentCategory(),c=a.currentClass().code,d=0;d<b.children.length;){if(b.children[d].code===c){a.currentClass(b.children[d]);break}d++}}function k(a){var b,c,d;for(b=a.currentClass(),c=a.currentType().code,d=0;d<b.children.length;){if(b.children[d].code===c){a.currentType(b.children[d]);break}d++}}function l(a,b){a.currentCategory()&&i(a,b),a.currentClass()&&j(a),a.currentType()&&k(a),
a.categories(b)}function m(a){return a.currentCategory()?a.currentCategory().children:[]}function n(a){return a.currentClass()?a.currentClass().children:[]}return g});

define('text!assets/views/asset-hierarchy-control.html',[],function () { return '<asset-hierarchy-control data-bind="attr:{enableMultiSelect:settings.multiSelect}"></asset-hierarchy-control>\r\n';});


define('text!assets/views/asset-hierarchy-control-search.html',[],function () { return '<input placeholder="Search" type="text" class="ahc-search-input text-input" />\r\n<i class="ahc-search-icon icon-global-search"></i>\r\n<i class="ahc-search-clear-icon icon-multiply icon-close hide"></i>';});

define('ui/elements/list-group-item/view-model',['system/globalization/translator'],function(){"use strict";var a=require("system/globalization/translator"),b=Object.create(HTMLElement.prototype);b.createdCallback=function(){var b,d,e,f,g;this.translator=Object.resolve(a),this.className="list-group-item",b=document.createElement("div"),b.classList.add("background-div"),this.appendChild(b),d=document.createElement("div"),d.classList.add("block-group"),d.classList.add("mi-li-body"),this.appendChild(d),e=document.createElement("div"),e.setAttribute("name","selector"),d.appendChild(e),l(this),e=document.createElement("div"),g=document.createElement("span"),f=document.createElement("span"),g.setAttribute("name","text"),f.setAttribute("name","custom-icon"),g.classList.add("system-ellipsis-text"),e.appendChild(f),e.appendChild(g),d.appendChild(e),this._listItemIcon=f,m(this),c(this)},b.attachedCallback=function(){this.querySelector(".mi-li-body").addEventListener("click",this)},b.attributeChangedCallback=function(a,b,c){
"selector"===a||"multiselect"===a||"radio-child-only"===a?l(this):"checked"===a?r(this,c):"description"===a&&this.value?q(this):"icon-class"===a?s(this,c):"has-children"===a?m(this):"use-html"===a?q(this):"disabled"===a?n(this,c):"disabledicon"===a&&o(this,c)},b.handleEvent=function(a){"click"===a.type?t(this,a):"change"===a.type&&u(this,a)};function c(a){a._value=null,Element.defineProperty(a,"value",{get:f.bind(null,a),set:g.bind(null,a)}),Element.defineProperty(a,"listItemIcon",{get:d.bind(null,a),set:e.bind(null,a)})}function d(a){return a._listItemIcon}function e(a,b){}function f(a){return a._value}function g(a,b){a._value=b,q(a),m(a)}function h(a,b,c){var d=document.createElement("span"),e=document.createElement("input");"true"===a.getAttribute("multiselect")?(e.type="checkbox",d.classList.add("custom-checkbox")):e=i(a,e),a.getAttribute("checked")?e.checked="true"===a.getAttribute("checked"):e.checked=!1,e.setAttribute("selector",!0),b.appendChild(d),b.appendChild(e),
c.classList.add("selector-seperator")}function i(a,b){var c=!!a.querySelector("i.icon-right-arrow"),d=a.getAttribute("radio-child-only");return b=j(b),d&&c&&(b.style.visibility="hidden"),b}function j(a){return a.type="radio",a.name="list-group-radio",a}function k(a,b,c){var d=document.createElement("i");d.className="icon-plus",d.title=a.translator.translate("ADD_ASSET"),b.appendChild(d),c.classList.add("selector-seperator")}function l(a){var b=a.getAttribute("selector"),c,d=a.querySelector('[name="selector"]'),e=a.querySelector('[name="text"]');d.hasChildNodes()&&(c=d.querySelector("input"),c&&c.removeEventListener("checked",a),d.innerHTML=""),"toggle"===b?h(a,d,e):"addOnly"===b&&k(a,d,e)}function m(a){var b,c,d,e,f=a.querySelector(".mi-li-body");c=a.getAttribute("has-children"),c?"true"===c?d=!0:(e=a.value[c],d=e instanceof Function?e():e):d=!1,d&&!f.querySelector('i[name="icon"]')?(b=document.createElement("i"),b.className=a.getAttribute("icon-class"),
b.title=a.translator.translate("EXPAND"),b.setAttribute("name","icon"),f.appendChild(b)):d||(b=f.querySelector('i[name="icon"]'))&&f.removeChild(b)}function n(a,b){b===!0||"true"===b?a.classList.add("disabled"):b!==!1&&"false"!==b||a.classList.remove("disabled")}function o(a,b){b===!0||"true"===b?a.classList.add("disabledIcon"):b!==!1&&"false"!==b||a.classList.remove("disabledIcon")}function p(a){var b,c=a.querySelector(".mi-li-body");c.querySelector('i[name="icon"]')||(b=document.createElement("i"),b.className=a.getAttribute("icon-class"),b.setAttribute("name","icon"),c.appendChild(b))}function q(a){var b,c,d=a.getAttribute("description")||"description",e=a.getAttribute("use-html");a.value&&(b=a.value[d],c=b instanceof Function?b.call(a.value):b,e?a.querySelector('[name="text"]').innerHTML=c:a.querySelector('[name="text"]').textContent=c)}function r(a,b){var c=a.querySelector('[name="selector"] input');c&&(c.checked="false"!==b,
c.checked?c.previousSibling.classList.add("checked"):c.previousSibling.classList.remove("checked"))}function s(a,b){var c=a.querySelector('[name="icon"]');null!==c?c.className=b:(p(a),c=a.querySelector('[name="icon"]'),c.className=b)}function t(a,b){var c;if(b.cancelBubble=!0,b.preventDefault=!0,c=new CustomEvent("click",{bubbles:!0,cancelable:!0}),"selector"===b.target.getAttribute("name")||"selector"===b.target.parentElement.getAttribute("name"))if("INPUT"===b.target.tagName)"radio"!==b.target.getAttribute("type")&&"checkbox"!==b.target.getAttribute("type")||(c.selecting=b.target.checked);else if("I"===b.target.tagName){if("true"===a.getAttribute("disabledicon"))return;c.selecting=!0}a.dispatchEvent(c)}function u(a,b){var c,d;c=b.target.checked,a.setAttribute("checked",b.target.checked),d=b.target.checked,c!==d&&(b.target.checked=c)}return document.registerElement("mi-li",{prototype:b}),b});
define('ui/elements/searchbox/view-model',['lodash','jquery','system/globalization/translator'],function(){"use strict";var a=require("lodash"),b=require("jquery"),c=require("system/globalization/translator"),d=Object.create(HTMLElement.prototype),e=["key","description","page","page-size","scroll-percent","use-html","multiselect","selector"];d.createdCallback=function(){var b;this.classList.add("btn"),this.classList.add("btn-icon"),b=document.createElement("i"),b.className="icon-search",this.appendChild(b),this.search=a.debounce(q,500),this._searchDiv=null,this._searchList=null,this._value="",Element.defineProperty(this,"value",{get:o.bind(null,this),set:p.bind(null,this)}),this._closeSearchBind=this.closeSearch.bind(this),this._resizeBind=i.bind(null,this),this.isInToolbar=!1,this.disabled=!1,this.translator=null},d.attachedCallback=function(){this.addEventListener("click",this),window.addEventListener("resize",this._resizeBind),this.translator=Object.resolve(c),this.title=f(this,"SEARCH")},d.detachedCallback=function(){this._searchDiv&&j(this),
window.removeEventListener("resize",this._resizeBind),this.isInToolbar&&this._searchList&&k(this)},d.handleEvent=function(a){"input"===a.type?(this._value=a.target.value,n(this)):"click"===a.type&&"I"===a.target.tagName&&(a.target.classList.contains("icon-multiply")?r(this):a.target.classList.contains("icon-search")&&!this.disabled&&(w(this,a),g(this)))},d.attributeChangedCallback=function(b,c,d){var f;"delay"===b?this.search=a.debounce(q,d):"disabled"===b?this.disabled="true"===d:this.searchDiv&&(f=this.searchDiv.querySelector(".search-list"))&&e.indexOf(b)>-1&&f.setAttribute(b,d)},d.closeSearch=function(a){if(""===this._value)if(this._searchList&&"none"!==b(this._searchList).css("display")){if(a.target===this._searchDiv.querySelector("input"))return;this._searchDiv&&""===this._searchDiv.querySelector("input").value&&(j(this),k(this))}else{
if(a&&"blur"!==a.type&&(a.target===this||a.target.parentElement===this||a.target===this._searchDiv||a.target.parentElement===this._searchDiv))return;j(this)}},d.toggleEnabled=function(a){var b=this.querySelector("Search");b.disabled="true"===a},d.toggleSearch=function(){g(this)};function f(a,b){return a.translator.translate(b.toUpperCase())}function g(a){var b;a._searchDiv||a.isInToolbar&&a._searchList?(r(a),j(a),k(a)):(a._searchDiv=document.createElement("div"),a._searchDiv.className="mi-searchbox","MI-TOOL-BAR"!==a.parentElement.tagName?a.parentElement.appendChild(a._searchDiv):a.parentElement.parentElement.insertBefore(a._searchDiv,a.parentElement.nextElementSibling),b=document.createElement("input"),b.setAttribute("type","text"),b.className="form-control mi-searchbox",b.value=a.value,b.addEventListener("blur",a._closeSearchBind),a._searchDiv.appendChild(b),b.focus(),b=document.createElement("i"),b.className="icon-multiply",a._searchDiv.appendChild(b),b.addEventListener("click",a),
"true"!==a.getAttribute("custom-search")&&(b=document.createElement("mi-list-group"),Element.upgrade(b),b.classList.add("search-list"),b.classList.add("dropdown-menu-left"),s(a,b),b.loader=t.bind(null,a),"MI-TOOL-BAR"!==a.parentElement.tagName?a._searchDiv.appendChild(b):(a.isInToolbar=!0,a._searchDiv.parentElement.insertBefore(b,a._searchDiv.nextElementSibling),a._searchList=b,a._searchList.searchResult=a._searchList.parentElement.searchResult,h(a,b)),i(a)),m(a),l(a),a._searchDiv.addEventListener("input",a))}function h(a){a._searchList.addEventListener("click",function(b){b.target===this?g(a):"MI-LI"===b.target.tagName&&w(a,b)})}function i(a){var c;"true"!==a.getAttribute("custom-search")&&(c=a.parentElement)&&("MI-TOOL-BAR"===c.nodeName&&(c=c.parentElement),a._searchDiv&&(a.isInToolbar?a._searchList&&(a._searchList.style.height=(c.clientHeight-77).toString()+"px",b(a._searchList).css("position","absolute"),"relative"===b(c).css("position")?(b(a._searchList).css("top",77),
b(a._searchList).css("left",0)):(b(a._searchList).css("top",b(c).position().top+77),b(a._searchList).css("left",b(c).position().left)),a._searchList.style.width=c.clientWidth.toString()+"px"):(a._searchList=a._searchDiv.querySelector(".search-list"),a._searchList.style.height=(c.clientHeight-46-35).toString()+"px")))}function j(a){a._searchDiv&&(a._searchDiv.removeEventListener("click",a),a._searchDiv.removeEventListener("input",a),a._searchDiv.querySelector("input").removeEventListener("blur",a._closeSearchBind),Element.clearDom(a._searchDiv),a._searchDiv.parentElement.removeChild(a._searchDiv),a._searchDiv=null,l(a))}function k(a){a._searchList&&(a._searchList.removeEventListener("click",a),Element.clearDom(a._searchList),b(a._searchList).remove(),a._searchList=null,l(a))}function l(a){var b=new CustomEvent("resize",{bubbles:!0});b.open=null!==a._searchDiv,a.dispatchEvent(b)}function m(a){
a.value.length>0?a._searchDiv.querySelector("i").style.display="inline-block":a._searchDiv.querySelector("i").style.display="none"}function n(a){m(a),a.search(a)}function o(a){return a._value}function p(a,b){a._value=b||"",""===a._value||a._searchDiv||g(a),a._searchDiv&&(a._searchDiv.querySelector("input").value=a._value,n(a))}function q(a){var b;a.searchCallback&&a._searchDiv&&("true"===a.getAttribute("custom-search")?(b=a._searchDiv.querySelector("input"),a.searchCallback(b.value)):(a._searchList.value=null,a._searchList.reload()))}function r(a){a.value="",q(a),a._searchDiv.querySelector(".mi-searchbox input").focus()}function s(a,b){var c,d;for(c=0;c<e.length;c++)(d=a.getAttribute(e[c]))&&b.setAttribute(e[c],d)}function t(a,c,d){var e=a._searchDiv.querySelector("input");return e&&a.searchCallback?a.searchCallback(e.value,c,d).done(u.bind(null,a)):b.Deferred().resolve().promise()}function u(a,b){var c
;a._searchDiv&&(c=a.isInToolbar?a._searchList:a._searchDiv.querySelector(".search-list"))&&(b&&b.length>0?c.classList.add("open"):c.classList.remove("open"))}function v(a){for(var b=a.hasAttribute("multiselect")?a.querySelectorAll("mi-li[checked]"):a.querySelectorAll(".active"),c=[],d=0;d<b.length;d++)c.push(b[d].value);return c}function w(a,b){var c;c=new CustomEvent("search-selected",{bubbles:!0}),c.searchResult=v(b.currentTarget),a.dispatchEvent(c)}return document.registerElement("mi-searchbox",{prototype:d}),d});
define('ui/elements/tool-bar/view-model',['lodash','jquery'],function(){"use strict";var a=require("lodash"),b=require("jquery"),c=Object.create(HTMLElement.prototype);c.createdCallback=function(){var b,c;this._closeOverflowBind=m.bind(null,this),this.$filter=null,this.popoverId=null,b=document.createElement("button"),b.className="more-options-icon btn btn-primary btn-icon dropdown-toggle",this.appendChild(b),c=document.createElement("icon"),c.className="icon-options",b.appendChild(c),this.throttledPositionEllipsis=a.throttle(this.positionEllipsis.bind(this),650)},c.attachedCallback=function(){a.defer(q.bind(null,this)),window.addEventListener("resize",this),document.querySelector("body").addEventListener("click",this._closeOverflowBind),this.addEventListener("click",this)},c.detachedCallback=function(){var a;window.removeEventListener("resize",this),document.querySelector("body").removeEventListener("click",this._closeOverflowBind),this.$filter&&(a=document.querySelector(this.popOverId),a&&a.parentElement.removeChild(a),
this.$filter=null)},c.showElement=function(a,b){for(var c=this.firstElementChild;c;)d(c,a)&&e(c,b),null!==c&&(c=c.nextElementSibling)};function d(a,b){return a.className.split(" ").indexOf(b)>=0}function e(a,c){c?b(a).addClass("overflow").removeClass("no-access"):b(a).addClass("no-access").removeClass("overflow")}c.handleEvent=function(b){var c,d,e,f;if("resize"===b.type&&b.target===window)this.throttledPositionEllipsis(),a.defer(q.bind(null,this));else if("click"===b.type){if(c=this.querySelector(".more-options-icon"),d=document.querySelector(this.popOverId),b.target===c||c.contains(b.target))l(this);else if(d&&d.contains(b.target)){for(f=b.target;f&&!e;)f.original&&(e=f.original),f=f.parentElement;e&&(b.cancelBubble=!0,e.dispatchEvent(new CustomEvent("click",{bubble:!0})))}b.target.parentElement.classList.contains("tool-bar-overflow")&&this._closeOverflowBind(this,b)}},c.positionEllipsis=function(){
var a=this.firstElementChild,b=this.querySelector(".more-options-icon"),c=document.querySelector(".content").getBoundingClientRect(),d=0,e=5,l,m=!1,n,o,p,q,r;if(r=this,null!==this.offsetParent)if(p=this.parentElement.getBoundingClientRect(),l="MI-TREE"===this.parentElement.tagName,this.$filter&&this.$filter.popover("hide"),a&&a!==b){for(n=b.getBoundingClientRect(),q=c.width===p.width||l?p.width-n.width-e:p.left+p.width-n.width-e,o=a.getBoundingClientRect(),d=h(r,b,o,p),a=this.firstElementChild;a;)o=a.getBoundingClientRect(),j(a,b,o,p)&&(i(a)?d>0?(m=!0,a.classList.add("overflow"),f(a),d--,d=h(r,b,o,p)):(g(a),a.classList.remove("overflow")):k(a,this)?(m=!0,a.classList.add("overflow")):(g(a),a.classList.remove("overflow"))),null!==a&&(a=a.nextElementSibling);m?(b.style.visibility="visible",b.style.left=q.toString()+"px"):b.style.visibility="hidden"}else;};function f(a){var c=b(a);""===c.next().text()||c.hasClass("more-options-icon")||c.next().css({"margin-right":"20px"})}function g(a){
var c=b(a),d=[];c.hasClass("overflow")&&c.attr("style",""),c.parent().children().each(function(a,c){"right"!==b(this).css("float")||b(this).hasClass("overflow")||d.push(b(this))}),b.each(d,function(a){0!==a&&b(this).attr("style","")})}function h(a,b,c,d){var e,f=0;for(e=a.firstElementChild;e;)j(e,b,c,d)&&k(e,a)&&i(e)&&f++,e=e.nextElementSibling;return f}function i(a){return"right"===b(a).css("float")}function j(a,b,c,d){var e="addItem"===a.getAttribute("data-action");return a!==b&&c.width!==d.width&&!e}function k(a,c){var d=b(a).position().top>b(c).position().top+b(c).height();return a.classList.contains("overflow")&&!a.classList.contains("dropdown-toggle")&&(b(a).removeClass("overflow"),d=b(a).position().top>b(c).position().top+b(c).height(),b(a).addClass("overflow")),d}function l(a){if(!a.$filter){var c,d;a.$filter=b(a.querySelector(".more-options-icon")),a.$filter.popover({placement:"bottom",container:"body",content:" "}),a.$filter.on("shown.bs.popover",a,n),
a.$filter.on("hide.bs.popover",a,o),a.$filter.on("hidden.bs.popover",a,p),a.$filter.popover("show"),setTimeout(function(){c=parseInt(b(a.popOverId).css("left")),d=parseInt(b(a.popOverId).width()),b(a.popOverId).css("left",c-(d-30))},250)}}function m(a,b){var c;if(a.$filter){if(!(c=document.querySelector(a.popOverId))||c.contains(b.target)||b.target===a)return;a.$filter.popover("hide")}}function n(a){var b=a.data,c,d=b.querySelectorAll(".overflow"),e,f;for(b.popOverId="#"+a.target.attributes["aria-describedby"].value,c=document.querySelector(b.popOverId+" .popover-content"),c.classList.add("tool-bar-overflow"),e=0;e<d.length;e++)f=d[e].cloneNode(),f.original=d[e],c.appendChild(f),f.textContent=f.getAttribute("title");c.addEventListener("click",b)}function o(a){var b=a.data,c;c=document.querySelector(b.popOverId+" .popover-content"),c&&c.addEventListener("click",b),b.$filter.off("shown.bs.popover",n),b.$filter.off("hide.bs.popover",o)}function p(a){var b=a.data
;b.$filter&&(b.$filter.off("hidden.bs.popover",p),b.$filter.popover("destroy"),b.$filter=null,b.popoverId=null)}function q(a){a&&a.positionEllipsis&&a.positionEllipsis instanceof Function&&a.positionEllipsis()}return document.registerElement("mi-tool-bar",{prototype:c}),c});
define('ui/elements/tool-bar-filter/view-model',['require','jquery','spa/conductor','spa/region','system/globalization/translator'],function(require){"use strict";var a=require("jquery"),b=require("spa/conductor"),c=require("spa/region"),d=require("system/globalization/translator"),e=Object.create(HTMLElement.prototype);e.createdCallback=function(){var a;h(this),this.classList.add("btn"),this.classList.add("btn-default"),this.classList.add("btn-icon"),a=document.createElement("i"),a.className="icon-collection-filter",this.appendChild(a),this.region=null,this.translator=null},e.attachedCallback=function(){this.addEventListener("click",this),document.querySelector("body").addEventListener("click",this._closeFilterBind),this.translator=Object.resolve(d),this.title=f(this,"FILTER")},e.detachedCallback=function(){var a;"true"!==this.getAttribute("custom-filter")&&(this.$filter&&(a=document.querySelector(this.popOverId),a&&a.parentElement.removeChild(a),this.$filter=null),this.conductor.unloadScreen(this.filterViewModel),this.conductor.closeScreen(this.filterViewModel)),
document.querySelector("body").removeEventListener("click",this._closeFilterBind)},e.handleEvent=function(a){"click"===a.type&&(a.target!==this&&a.target.parentElement!==this||g(this))},e.openFilter=function(){g(this)},e.closeFilter=function(){i(this)};function f(a,b){return a.translator.translate(b.toUpperCase())}function g(b){if("true"===b.getAttribute("custom-filter"))b.filterViewModel();else{if(b.$filter)return;b.$filter=a(b),b.$filter.popover({placement:"bottom",content:" ",container:"body"}),b.$filter.on("shown.bs.popover",b,l),b.$filter.on("hide.bs.popover",b,m),b.$filter.on("hidden.bs.popover",b,n),b.$filter.popover("show")}}function h(a){a.conductor=Object.resolve(b),a._closeFilterBind=i.bind(null,a),a.$filter=null,a.popoverId=null,a._filterViewModel=null,Element.defineProperty(a,"filterViewModel",{get:j.bind(null,a),set:k.bind(null,a)})}function i(a,b){var c;if(a.$filter){if(!(c=document.querySelector(a.popOverId))||c.contains(b.target)||b.target===a)return
;a.$filter.popover("hide")}}function j(a){return a._filterViewModel}function k(a,b){b?(a._filterViewModel=b,"true"!==a.getAttribute("custom-filter")&&(a.conductor.openScreen(a._filterViewModel),a.conductor.loadScreen(a._filterViewModel))):a._filterViewModel=null}function l(b){var d=b.data;d.region=new c,d.popOverId="#"+b.target.getAttribute("aria-describedby"),d.region.setElement(a(d.popOverId+" .popover-content")),d.conductor.activateScreen(d.filterViewModel),d.conductor.attachScreen(d.filterViewModel,d.region)}function m(a){var b=a.data;b.conductor.deactivateScreen(b.filterViewModel),b.conductor.detachScreen(b.region),b.$filter.off("shown.bs.popover",l),b.$filter.off("hide.bs.popover",m)}function n(a){var b=a.data;b.$filter&&(b.$filter.off("hidden.bs.popover",n),b.$filter.popover("destroy"),b.$filter=null,b.popoverId=null,b.dispatchEvent(new CustomEvent("filter-closed",{bubbles:!0})))}return document.registerElement("mi-tool-bar-filter",{prototype:e}),e});
define('ui/elements/list-group/view-model',['require','jquery','ramda','lodash','system/lang/converter','system/globalization/translator','ui/elements/list-group-item/view-model','ui/elements/searchbox/view-model','ui/elements/tool-bar/view-model','ui/elements/tool-bar-filter/view-model'],function(require){"use strict";var a=require("jquery"),b=require("ramda"),c=require("lodash"),d=require("system/lang/converter"),e=require("system/globalization/translator"),f=["key","description","selector","multiselect","has-children","use-html","delay","custom-search","radio-child-only"];require("ui/elements/list-group-item/view-model"),require("ui/elements/searchbox/view-model"),require("ui/elements/tool-bar/view-model"),require("ui/elements/tool-bar-filter/view-model");var g=Object.create(HTMLElement.prototype);g.selectRadioButton=function(a,b){E(this,a,b,!0)},g.createdCallback=function(){var a,b,c,d,e,f,g;j(this),this.classList.add("nav-list-group"),c=this.querySelector("mi-tool-bar"),c||(c=document.createElement("mi-tool-bar"),this.appendChild(c)),this.filterViewModel&&this.classList.add("show-filter"),e=document.createElement("mi-tool-bar-filter"),e.filterViewModel=this.filterViewModel,f=this.getAttribute("custom-filter"),
"true"===f&&e.setAttribute("custom-filter","true"),c.insertBefore(e,c.firstChild),this.searchCallback&&this.classList.add("show-search-button"),d=document.createElement("mi-searchbox"),d.searchCallback=this.searchCallback,c.insertBefore(d,c.firstChild),B(this,d),"false"!==this.getAttribute("allow-add")&&this.classList.add("allow-add"),c.insertBefore(N(this,"addItem","NEWITEM","icon-plus"),c.firstChild),a=document.createElement("div"),a.className="list-group",b=this.getAttribute("selector"),"addOnly"!==b&&"toggle"!==b||(a.className+=" selectable"),this.appendChild(a),g=document.createElement("div"),g.className="loading-small",this.appendChild(g),this.loader&&this.reload(),this.addEventListener("search-selected",this)},g.attachedCallback=function(){var a=U(this),b=this.querySelector("mi-tool-bar");a.addEventListener("scroll",this),a.addEventListener("click",this),b.addEventListener("click",this),b.addEventListener("resize",this),b.addEventListener("filter-closed",this),T(this)},
g.attributeChangedCallback=function(a,b,c){var d=U(this),e;"selector"===a&&d&&("addOnly"===c||"toggle"===c?d.classList.add("selectable"):d.classList.remove("selectable")),"allow-add"===a&&("false"===c?this.classList.remove("allow-add"):this.classList.add("allow-add")),"custom-filter"===a&&(e=this.querySelector("mi-tool-bar mi-tool-bar-filter"))&&e.setAttribute(a,c),A(this,a,c,d)},g.handleEvent=function(a){var b;"scroll"===a.type?J(this,a):"click"===a.type?C(a.target)?(E(this,D(a.target).value,a.selecting),h(this,a)):"BUTTON"===a.target.nodeName?(b=a.target.getAttribute("data-action"),S(this,b,a)):"I"===a.target.tagName&&"BUTTON"===a.target.parentElement.tagName&&(b=a.target.parentElement.getAttribute("data-action"),S(this,b,a)):"resize"===a.type?T(this):"filter-closed"===a.type?this.reload():"search-selected"===a.type&&(W.call(null,this,a.searchResult),x.call(null,this,this.searchResult))};function h(a,b){F(a)&&D(b.target).value&&!b.selecting&&i(a)&&l(a,k(a))}function i(a){
return t(a)&&c.includes(t(a),k(a))}g.reload=function(){var a=U(this);a&&(this.resume(),Element.clearDom(a),this.setAttribute("page","1"),a.scrollTop=0,this.loader&&this.load().done(M.bind(null,this)))},g.pause=function(){this.paused=!0},g.resume=function(){this.paused=!1},g.load=function(){var b=this.getAttribute("page"),c=L(this),d;return this.loader?(this.pause(),this.classList.add("loading"),T(this),d=this.loader(b,c),d.done(I.bind(null,this)),d.always(V.bind(null,this)),d.promise()):a.Deferred().done().promise()},g.scrollIntoView=function(){var a,b,c,d,e=U(this);e&&(a=e.querySelector("mi-li.active"),a?(b=a.parentNode,d=a.getBoundingClientRect(),c=b.getBoundingClientRect(),(d.top<c.top||d.top>c.bottom)&&(b.scrollTop=a.offsetTop-b.offsetTop)):e.firstElementChild&&(e.firstElementChild.scrollTop=0))},g.addItem=function(){this.dispatchEvent(new CustomEvent("add-item",{bubbles:!0}))},g.loadState=function(a){var b=this.querySelector("mi-tool-bar mi-searchbox");a=a||{},
a.value&&(this.value=a.value),a.searchTerm&&(b.value=a.searchTerm)},g.saveState=function(){var a=this.querySelector("mi-tool-bar mi-searchbox");return{value:this.value,searchTerm:a.value}};function j(a){a.translator=Object.resolve(e),a.paused=!1,a.searchResult=[],a._loader=null,Element.defineProperty(a,"loader",{get:q.bind(null,a),set:r.bind(null,a)}),a._value=null,Element.defineProperty(a,"value",{get:s.bind(null,a),set:E.bind(null,a)}),Element.defineProperty(a,"items",{get:t.bind(null,a),set:u.bind(null,a)}),Element.defineProperty(a,"selectedItems",{get:v.bind(null,a),set:x.bind(null,a)}),a._filterViewModel=null,Element.defineProperty(a,"filterViewModel",{get:O.bind(null,a),set:P.bind(null,a)}),a._searchCallback=null,Element.defineProperty(a,"searchCallback",{get:Q.bind(null,a),set:R.bind(null,a)}),a._listItemIconCallback=null,Element.defineProperty(a,"listItemIconCallback",{get:o.bind(null,a),set:p.bind(null,a)})}function k(a){var b=m(a);if(b)return b.selectedRadioButton}
function l(a,b){var c=m(a);c&&(c.selectedRadioButton=b)}function m(a){var b=n(a);if(b)return b[0]}function n(b){var c=b.parentElement,d;if(c)return d=a(c).siblings()}function o(a){return a._listItemIconCallback}function p(a,b){a._listItemIconCallback=b||null}function q(a){return a._loader}function r(a,b){a._loader=b,a.reload()}function s(a){return a._value}function t(a){var b=U(a),c,d=[],e;if(b)for(c=b.querySelectorAll("mi-li"),e=0;e<c.length;e++)d[d.length]=c[e].value;return d}function u(a,b){var c=U(a);c&&(Element.clearDom(c),b&&y(a,b))}function v(a){var b=U(a),c,d=[],e;if(b)for(c=b.querySelectorAll('mi-li[checked="true"]'),e=0;e<c.length;e++)d[d.length]=c[e].value;return d}function w(a){var b,c,d=U(a);if(d&&(b=d.querySelectorAll('mi-li[checked="true"]'),b.length>0))for(c=0;c<b.length;c++)b[c].setAttribute("checked","false")}function x(a,b){var c,d;if(w(a),b)for(c=0;c<b.length;c++)(d=H(a,b[c]))&&d.setAttribute("checked","true")}function y(a,b){var c,d,e=U(a),f;if(e){
for(f=document.createDocumentFragment(),z(b,e),c=0;c<b.length;c++)d=document.createElement("mi-li"),d.setAttribute("icon-class","icon-right-arrow"),f.appendChild(d),d.value=b[c],d.value.hasOwnProperty("disabled")&&d.setAttribute("disabled","true"===d.value.disabled||d.value.disabled),d.value.hasOwnProperty("disabledIcon")&&d.setAttribute("disabledIcon","true"===d.value.disabledIcon||d.value.disabledIcon),Object.tryMethod(a,"_listItemIconCallback",d.listItemIcon,b[c]),B(a,d);var g=new CustomEvent("loaded",{bubbles:!0,cancelable:!0,detail:{frag:f}});a.dispatchEvent(g),e.appendChild(f),a.searchResult.length&&x(a,a.searchResult)}}function z(a,b){if(0===a.length){var c=b.parentElement,d,e;c&&(c.parentElement&&(c=c.parentElement,c.previousSibling&&(c=c.previousSibling)),"MI-PATH-HISTORY"===c.nodeName&&(d=c.children[0].children,e=d[d.length-1],e.setAttribute("icon-class","")))}}function A(a,b,c,d){var e,g,h;if(d&&f.indexOf(b)>-1){for(e=d.getElementsByTagName("mi-li"),
g=0;g<e.length;g++)e[g].setAttribute(b,c);h=a.querySelector("mi-tool-bar mi-searchbox"),h&&h.setAttribute(b,c)}}function B(a,b){var c,d;for(c=0;c<f.length;c++)(d=a.getAttribute(f[c]))&&b.setAttribute(f[c],d)}function C(a){return"MI-LI"===a.tagName||"MI-LI"===a.parentNode.tagName||"MI-LI"===a.parentNode.parentNode.tagName||"MI-LI"===a.parentNode.parentNode.parentNode.tagName}function D(a){for(var b=a;"MI-LI"!==b.tagName;)b=b.parentNode;return b}function E(a,b,c,d){if(b){var e,f,g;if(g=new CustomEvent("selecting",{bubbles:!0,cancelable:!0}),g.selecting=c,g.newValue=b,a.dispatchEvent(g)){if(f=a.getElementsByClassName("active"),f&&f.length>0&&f[0].classList.remove("active"),a._value=b,b)if(F(a)&&b&&c&&l(a,b),void 0!==(e=H(a)))a._value=e.value,e.classList.add("active"),a.scrollIntoView();else{var h=a.querySelector("mi-list-group");h&&void 0!==h&&(a._value=h.value,h.classList.add("active"),a.scrollIntoView())}
return a.value&&void 0!==e?(e.getAttribute("multiselect")&&("true"===e.getAttribute("checked")?e.setAttribute("checked","false"):e.setAttribute("checked","true")),d?(e.setAttribute("checked","true"),G(a,c,!0),!0):(F(a)?G(a,c,!0):G(a,c),!0)):(null!==a.value&&void 0!==a.value||G(a,c),!1)}}}function F(a){return b.any(b.propEq("name","radio-child-only"),a.attributes)}function G(a,b,c){var d=new CustomEvent("change",{bubbles:!0,cancelable:!0});a.dispatchEvent(d),d=new CustomEvent("selected",{bubbles:!0,cancelable:!0}),d.preventListGroupNull=c,d.selecting=b,a.dispatchEvent(d)}function H(a,b){var c=0,d=U(a),e,f,g;if(d&&(e=d.querySelectorAll("mi-li"))&&0!==e.length){for(b=b||a.value,f=a.getAttribute("key")||"entityKey",g=b[f];c<e.length&&g!==e[c].value[f];)c++;return e[c]}}function I(a,b){var c=U(a);c&&"1"===a.getAttribute("page")&&Element.clearDom(c),b&&(y(a,b),b.length===L(a)&&a.resume())}function J(a,b){
var c=b.target,e=d.toFloat(a.getAttribute("scroll-percent")||"0.75"),f=(c.offsetHeight+c.scrollTop)/c.scrollHeight;!a.paused&&f>=e&&(K(a),a.load())}function K(a){var b=d.toInteger(a.getAttribute("page")||"1");b++,a.setAttribute("page",b.toString())}function L(a){var b=a.getAttribute("page-size")||"25";return d.toInteger(b)}function M(a){a.value&&(E(a,a.value)||(a.paused?a.value=null:(K(a),a.load().done(M.bind(null,a)))))}function N(a,b,c,d){var e=document.createElement("button"),f=document.createElement("i");return e.className="btn btn-default btn-icon",e.setAttribute("data-action",b),e.title=a.translator.translate(c),f.className=d,e.appendChild(f),e}function O(a){return a._filterViewModel}function P(a,b){var c=a.querySelector("mi-tool-bar mi-tool-bar-filter");b?a.classList.add("show-filter"):a.classList.remove("show-filter"),c&&(c.filterViewModel=b),a._filterViewModel=b}function Q(a){return a._searchCallback}function R(a,b){var c=a.querySelector("mi-tool-bar mi-searchbox")
;b?a.classList.add("show-search-button"):a.classList.remove("show-search-button"),c&&(c.searchCallback=b),a._searchCallback=b}function S(a,b,c){b&&a[b]&&a[b](c)}function T(a){var b,c=a.querySelector("mi-tool-bar"),d=U(a);c&&(b=a.querySelector("mi-tool-bar").clientHeight,a.classList.contains("loading")&&(b+=16),d.style.height="calc(100% - "+(b+1)+"px)")}function U(a){var b=a.querySelectorAll(".list-group");return 0===b.length?null:b[b.length-1]}function V(a){a.classList.remove("loading"),T(a)}function W(a,b){var c,d,e=0;for(c=0;c<b.length;c++){for(d=0;d<a.searchResult.length;d++)if(a.searchResult[d].key===b[c].key){e++;break}0===e&&a.searchResult.push(b[c])}}return document.registerElement("mi-list-group",{prototype:g}),g});
define('ui/elements/path-history/view-model',['require','lodash','jquery','ui/elements/list-group-item/view-model','ui/elements/list-group/view-model'],function(require){"use strict";var a=require("lodash"),b=require("jquery");require("ui/elements/list-group-item/view-model"),require("ui/elements/list-group/view-model");var c=["key","description","selector","multiselect","checked","has-children","use-html","page-size","delay","radio-child-only"],d=Object.create(HTMLElement.prototype);d.createdCallback=function(){var a;this.style.display="block",a=document.createElement("div"),a.className="list-group",this.appendChild(a),Element.defineProperty(this,"value",{get:k.bind(null,this),set:l.bind(null,this)}),Element.defineProperty(this,"listGroup",{get:m.bind(null,this),set:n}),this._loader=null,Element.defineProperty(this,"loader",{get:o.bind(null,this),set:p.bind(null,this)}),this._listItemIconCallback=null,Element.defineProperty(this,"listItemIconCallback",{get:g.bind(null,this),set:h.bind(null,this)}),this._selectedRadioButton=null,Element.defineProperty(this,"selectedRadioButton",{get:e.bind(null,this),set:f.bind(null,this)})}
;function e(a){return a._selectedRadioButton}function f(a,b){a._selectedRadioButton=b}function g(a){return a._listItemIconCallback}function h(a,b){a._listItemIconCallback=b||null}d.attachedCallback=function(){this.firstElementChild.addEventListener("click",this)},d.attributeChangedCallback=function(a,b,d){var e,f;if(c.indexOf(a)>-1)for(f=this.firstElementChild.getElementsByTagName("mi-li"),e=0;e<f.length;e++)"description"!==a&&"use-html"!==a||f[e].setAttribute(a,d),f[e].listGroup.setAttribute(a,d)},d.handleEvent=function(a){var b;"click"===a.type&&(a.cancelBubble=!0,a.preventDefault=!0,b=new CustomEvent("click",{bubbles:!0}),b.data=a.target.value,this.dispatchEvent(b),i(this))};function i(a){if(a.selectedRadioButton){var c=b(a).siblings(),d,f,g;c&&(d=b(a).siblings()[0]),d&&(f=d.children),f&&(g=f[0]),g&&e(a)&&j(a,g)}}d.contains=function(a){var b,c=this.value;for(b=0;b<c.length;b++)if(a===c[b].value)return!0;return!1},d.push=function(a){var b;b=document.createElement("mi-li"),
this.firstElementChild.appendChild(b),b.classList.add("selected"),null!==a.hasChildren&&b.setAttribute("icon-class","icon-arrow"),this.getAttribute("description")&&b.setAttribute("description",this.getAttribute("description")),this.getAttribute("use-html")&&b.setAttribute("use-html",this.getAttribute("use-html")),b.setAttribute("has-children",!0),b.value=a,b.listGroup=r(this,a),Object.tryMethod(this,"_listItemIconCallback",b.listItemIcon,a),q(this),j(this,b.listGroup)};function j(b,c){c&&b.selectedRadioButton&&a.includes(c.items,b.selectedRadioButton)&&c.selectRadioButton(b.selectedRadioButton,!0)}d.pop=function(){var a=this.firstElementChild,b=a.getElementsByTagName("mi-li");b.length>1&&(a.removeChild(b[b.length-1]),q(this))},d.moveBack=function(a){var b=this.firstElementChild,c=b.getElementsByTagName("mi-li"),d,e;if(a instanceof Object)for(;c&&c[c.length-1].value!==a;)b.removeChild(c[c.length-1]),q(this);else for(c=c.splice(a+1),d=0;d<c.length;d++)b.removeChild(c[d]),q(this)
;(e=b.querySelector("mi-li:last-of-type").listGroup)&&(e._value=null)},d.clear=function(){this.firstElementChild.innerHTML=""};function k(a){var b=a.firstElementChild.getElementsByTagName("mi-li"),c=[],d;for(d=0;d<b.length;d++)c[c.length]=b[d].value;return c}function l(a,b){var c,d,e=a.firstElementChild,f=!1;if(b instanceof Array){for(d=e.getElementsByTagName("mi-li"),c=0;c<b.length;c++)c>=d.length?(a.push(b[c]),f=!0):b[c]!==d[c].value&&(d[c].value=b[c],d[c].listGroup.reload(),f=!0);if(b.length<d.length){for(f=!0,c=d.length-1;c>b.length-1;c--)e.removeChild(d[c]);d[d.length-1].listGroup.value=null}f&&q(a)}else a.firstChild.innerHTML="",b&&a.push(b),q(a)}function m(a){var b=a.firstElementChild.getElementsByTagName("mi-li"),c=[],d;for(d=0;d<b.length;d++)c[c.length]=b[d].listGroup;return c}function n(){}function o(a){return a._loader}function p(a,b){var c,d=a.firstElementChild.getElementsByTagName("mi-li");for(a._loader=b,
c=0;c<d.length;c++)d[c].listGroup.listItemIconCallback=a.listItemIconCallback,d[c].listGroup.loader=b?b.bind(null,c):null}function q(a){var b=new CustomEvent("change",{bubbles:!0});a.dispatchEvent(b)}function r(a,b){var d=document.createElement("mi-list-group"),e=a.firstElementChild.getElementsByTagName("mi-li").length-1,f;for(f=0;f<c.length;f++)t(a,d,c[f]);return d.setAttribute("allow-add","false"),b&&b.loader?d.loader=b.loader.bind(null,e):a.loader&&(d.loader=a.loader.bind(null,e)),d.listItemIconCallback=a.listItemIconCallback,d.addEventListener("change",s),d}function s(a){a.cancelBubble=!0,a.preventDefault()}function t(a,b,c){var d=a.getAttribute(c);d&&b.setAttribute(c,d)}return document.registerElement("mi-path-history",{prototype:d}),d});
define('ui/elements/tree/view-model',['require','jquery','system/globalization/translator','ui/elements/path-history/view-model','ui/elements/searchbox/view-model','ui/elements/list-group/view-model','ui/elements/tool-bar/view-model','ui/elements/tool-bar-filter/view-model'],function(require){"use strict";var a=require("jquery"),b=require("system/globalization/translator"),c=["key","description","page","page-size","scroll-percent","selector","multiselect","checked","has-children","use-html","delay","radio-child-only"];require("ui/elements/path-history/view-model"),require("ui/elements/searchbox/view-model"),require("ui/elements/list-group/view-model"),require("ui/elements/tool-bar/view-model"),require("ui/elements/tool-bar-filter/view-model");var d=Object.create(HTMLElement.prototype);d.createdCallback=function(){var a,b,c,d,f,h;g(this),b=this.querySelector("mi-tool-bar"),b||(b=document.createElement("mi-tool-bar"),Element.upgrade(b),this.appendChild(b)),this.filterViewModel&&this.classList.add("show-filter"),d=document.createElement("mi-tool-bar-filter"),Element.upgrade(d),d.classList.add("default-buttons-left"),d.filterViewModel=this.filterViewModel,f=this.getAttribute("custom-filter"),"true"===f&&d.setAttribute("custom-filter","true"),
b.insertBefore(d,b.firstChild),this.searchCallback&&this.classList.add("show-search-button"),c=document.createElement("mi-searchbox"),Element.upgrade(c),c.classList.add("default-buttons-left"),c.searchCallback=e.bind(null,this),c.setAttribute("custom-search","true"),c.setAttribute("no-auto-close","true"),b.insertBefore(c,b.firstChild),p(this,c),"false"!==this.getAttribute("allow-add")&&this.classList.add("allow-add"),b.insertBefore(C(this,"addItem","NEWITEM","icon-plus"),b.firstChild),b.insertBefore(C(this,"togglePathHistory","HIDE","icon-up-arrow","hide-button"),b.firstChild),b.insertBefore(C(this,"backInHistory","BACK","icon-back-arrow","back-button"),b.firstChild),a=document.createElement("section"),a.className="nav-list-group",this.appendChild(a),this.pathHistory=document.createElement("mi-path-history"),Element.upgrade(this.pathHistory),this.pathHistory.loader=this._loader,this.pathHistory.value=this._value,this.pathHistory.className="expanded",a.appendChild(this.pathHistory),
p(this,this.pathHistory),h=document.createElement("div"),h.className="tree-list-control",a.appendChild(h),this._value&&x(this)},d.attachedCallback=function(){var a=this.querySelector("section.nav-list-group"),b=this.querySelector("mi-tool-bar");a.addEventListener("selecting",this),a.addEventListener("selected",this),a.addEventListener("click",this),b.addEventListener("click",this),b.addEventListener("resize",this),b.addEventListener("filter-closed",this),this.pathHistory.addEventListener("change",this),B(this)},d.attributeChangedCallback=function(a,b,d){var e,f;"root-name"===a?B(this,d):"allow-add"===a?"false"===d?this.classList.remove("allow-add"):this.classList.add("allow-add"):"custom-filter"===a?(f=this.querySelector("mi-tool-bar mi-tool-bar-filter"))&&f.setAttribute(a,d):c.indexOf(a)>-1&&(this.pathHistory.setAttribute(a,d),(e=this.querySelector("mi-tool-bar mi-searchbox"))&&e.setAttribute(a,d))},d.handleEvent=function(a){
"selecting"===a.type?D(this,a):"selected"===a.type?E(this,a):"click"===a.type?q(this,a):"change"===a.type?x(this):"resize"===a.type&&a.target!==window?t(this,a):"filter-closed"===a.type?this.refreshAll():"focus"===a.type&&a.target.parentElement.classList.contains("mi-searchbox")?(this.pathHistory.value=this.pathHistory.value[0],this.pathHistory.firstElementChild.firstElementChild.style.display="none",setTimeout(t.bind(null,this),0)):"blur"===a.type&&a.target.classList.contains("mi-searchbox")&&t(this)},d.togglePathHistory=function(){var a=!this.pathHistory.classList.contains("expanded"),b=this.querySelector('button[data-action="togglePathHistory"]');b.firstElementChild.className=a?"icon-up-arrow":"icon-arrow",b.title=this.translator.translate(a?"HIDE":"SHOW"),this.pathHistory.className=a?"expanded":"collapsed",t(this)},d.backInHistory=function(){var a=this.value;a.length>1&&w(this,a[a.length-2])},d.refresh=function(){var a=this.value,b=a[a.length-1]
;1===a.length?this.reload():(this.pathHistory.pop(),this.pathHistory.push(b))},d.refreshAll=function(){var a=this.pathHistory.listGroup,b;if(a.length<=1)this.reload();else{for(b=0;b<a.length;b++)a[b].items=null,a[b].resume();a[a.length-1].reload()}},d.reload=function(){A(this)&&this.pathHistory.clear(),B(this)},d.addItem=function(){this.dispatchEvent(new CustomEvent("add-item",{bubble:!0}))},d.loadState=function(a){var b;a=a||{},a.searchTerm&&(b=this.querySelector("mi-searchbox"),b._value=a.searchTerm,b.toggleSearch(),this.searchTerm=a.searchTerm,t(this),this.preSearchValue=a.preSearchValue),this.value=a.value,a.searchTerm&&(this.pathHistory.firstElementChild.firstElementChild.style.display="none")},d.saveState=function(){return{preSearchValue:this.preSearchValue,value:this.value,searchTerm:this.searchTerm}};function e(a,b){a.pathHistory.clear(),a.pathHistory.value={description:b,loader:a._searchCallback.bind(null,b)},a.searchTerm=b,
a.pathHistory.firstElementChild.firstElementChild.style.display="none",t(a)}function f(a){var b,c;a.preSearchValue&&(a.pathHistory.clear(),a.pathHistory.value=a.preSearchValue,a.preSearchValue=null,a.searchTerm="",a.querySelector("mi-searchbox").value=null,b=a.pathHistory.firstElementChild.firstElementChild,b&&(b.style.display="block"),c=new CustomEvent("search-closed",{bubbles:!0}),a.dispatchEvent(c),t(a))}function g(a){a.translator=Object.resolve(b),a._loader=null,a.preSearchValue=null,a.searchTerm="",Element.defineProperty(a,"loader",{get:j.bind(null,a),set:k.bind(null,a)}),a._value=null,Element.defineProperty(a,"value",{get:l.bind(null,a),set:m.bind(null,a)}),Element.defineProperty(a,"listGroup",{get:n.bind(null,a),set:o}),a._filterViewModel=null,Element.defineProperty(a,"filterViewModel",{get:F.bind(null,a),set:G.bind(null,a)}),a._searchCallback=null,Element.defineProperty(a,"searchCallback",{get:H.bind(null,a),set:I.bind(null,a)}),a._listItemIconCallback=null,
Element.defineProperty(a,"listItemIconCallback",{get:h.bind(null,a),set:i.bind(null,a)})}function h(a){return a._listItemIconCallback}function i(a,b){a._listItemIconCallback=b||null,a.pathHistory&&(a.pathHistory.listItemIconCallback=b)}function j(a){return a.pathHistory?a.pathHistory.loader:a._loader}function k(a,b){a.pathHistory&&(a.pathHistory.listItemIconCallback=a._listItemIconCallback,a.pathHistory.loader=b),a._loader=b}function l(a){return a.pathHistory?a.pathHistory.value:a._value}function m(a,b){a.pathHistory&&b&&(a.pathHistory.value=b),a._value=b}function n(a){return a.querySelector(".tree-list-control mi-list-group")}function o(){}function p(a,b){var d,e;for(d=0;d<c.length;d++)(e=a.getAttribute(c[d]))&&b.setAttribute(c[d],e)}function q(a,b){var c;"BUTTON"===b.target.nodeName?(c=b.target.getAttribute("data-action"),r(a,c,b)):"I"===b.target.tagName&&"BUTTON"===b.target.parentElement.tagName?(c=b.target.parentElement.getAttribute("data-action"),
r(a,c,b)):"MI-PATH-HISTORY"===b.target.tagName&&b.data&&w(a,b.data)}function r(a,b,c){b&&a[b]&&a[b](c)}function s(a,b){a.preSearchValue=a.pathHistory.value,b.target._searchDiv&&(b.target._searchDiv.querySelector("input").addEventListener("focus",a),b.target._searchDiv.querySelector("input").addEventListener("blur",a))}function t(b,c){var d=b.querySelector(".tree-list-control"),e=b.querySelector("section.nav-list-group"),g=e.firstElementChild,h=b.children,i=b.querySelector("mi-tool-bar"),j=0,k;if(d){if(c&&(c.open===!1?f(b):s(b,c)),i){for(k=0;k<h.length;k++)h[k]!==e&&(j+=a(h[k]).outerHeight());e.style.height="calc(100% - "+j+"px)"}for(j=0;g;)g!==d&&(j+=g.clientHeight),g=g.nextElementSibling;j=j.toString()+"px",d.style.height="calc(100% - "+j+")"}}function u(a,b){var c,d;for(c=new CustomEvent("navigating",{bubbles:!0,cancelable:!0}),c.newValue=[],d=0;d<a.length&&a[d]!==b;)c.newValue[c.newValue.length]=a[d],d++;return void 0!==b&&(c.newValue[c.newValue.length]=b),c}function v(a,b){
var c,d=a.pathHistory.listGroup[a.pathHistory.listGroup.length-1];b&&b.preventListGroupNull||(d.selectedItems=null),c=new CustomEvent("navigated",{bubbles:!0}),a.dispatchEvent(c)}function w(a,b){var c;c=u(a.value,b),a.dispatchEvent(c)&&(a.pathHistory.moveBack(b),v(a))}function x(a){y(a),z(a)}function y(b){var c=a("button.hide-button",b),d=a("button.back-button",b);c.addClass("pull-right"),1===b.pathHistory.value.length?(d.addClass("disabled"),c.addClass("disabled")):(d.removeClass("disabled"),c.removeClass("disabled"))}function z(a){var b=a.pathHistory.listGroup[a.pathHistory.listGroup.length-1],c=a.querySelector(".tree-list-control");b&&(c.firstElementChild&&c.removeChild(c.firstElementChild),c.appendChild(b),t(a),0!==b.items.length||b.paused?b.scrollIntoView():b.load())}function A(a){return a.getAttribute("root-name")||a.getAttribute("title")}function B(a,b){var c,d,e=a.getAttribute("description")||"description",f=b||A(a);if(f)d=a.value,0===d.length?(c={},c[e]=f,
a.value=c):(d[0]instanceof Object||(d[0]={}),d[0][e]=f,a.value=d);else if(a.value.length>0)return void(a.value=a.value[0])}function C(a,b,c,d,e){var f=document.createElement("button"),g=document.createElement("i");return f.className="btn btn-default btn-icon default-buttons-left "+(e||""),f.setAttribute("data-action",b),f.title=a.translator.translate(c),g.className=d,f.appendChild(g),f}function D(a,b){var c;b.selecting!==!0&&b.selecting!==!1&&(b.cancelBubble=!0,c=u(a.value,b.newValue),a.dispatchEvent(c)||b.preventDefault())}function E(a,b){var c;if(b.target.classList.contains("search-list"))return void(b.cancelBubble=!0);null!==b.selecting&&void 0!==b.selecting||(b.cancelBubble=!0,a.pathHistory.push(b.target.value),v(a,b),a.preSearchValue&&(c=new CustomEvent("search-selected",{bubbles:!0}),c.searchResult=[b.target.value],a.dispatchEvent(c)))}function F(a){return a._filterViewModel}function G(a,b){var c=a.querySelector("mi-tool-bar mi-tool-bar-filter")
;b?a.classList.add("show-filter"):a.classList.remove("show-filter"),c&&(c.filterViewModel=b),a._filterViewModel=b}function H(a){return a._searchCallback}function I(a,b){b?a.classList.add("show-search-button"):a.classList.remove("show-search-button"),a._searchCallback=b}return Element.registerElement("mi-tree",{prototype:d}),d});

define('text!ui/elements/filter/filter-btn-no-ko-view.html',[],function () { return '<div class="icon-filter-container">\r\n    <button class="icon-container btn btn-icon">\r\n        <i class="icon-collection-filter"></i>\r\n    </button>\r\n</div>\r\n';});


define('text!ui/elements/filter/filter-body-no-ko-view.html',[],function () { return '<!--<mi-select data-optionscaption="Select" data-selectedoptions="" data-disabled="false" data-required="false" data-visible="true" data-multiple="false"></mi-select>-->\r\n<div class="filter-container">\r\n\r\n    <div class="filters-noko">\r\n        <!--<div class="clear-all">\r\n            <a></a>\r\n        </div>-->\r\n        <div class="tag-section tag-area">\r\n        </div>\r\n        <div class="filter-content">\r\n            <div class="sort-header ">\r\n                \r\n            </div>\r\n        </div>\r\n        <div class="filter-header">\r\n            <header></header>\r\n            <header class="dotted-border"> </header>\r\n        </div>\r\n        <div class="filter-body">\r\n            \r\n        </div>\r\n    </div>\r\n</div>\r\n';});


define('text!ui/elements/filter/filter-group-no-ko-view.html',[],function () { return '<div class="filter-section">\r\n    <header></header>\r\n    <div class="filter-item">\r\n        <form class="form-item">\r\n            <div>\r\n                <!--<mi-checkbox data-bind="miCheckboxProperty: {checked: isSelected, text: text}"></mi-checkbox>-->\r\n            </div>\r\n        </form>\r\n        <div class="second-dotted-border"></div>\r\n    </div>\r\n</div>';});

define('ui/elements/filter/filter-item-no-ko',['require'],function(require){"use strict";function a(a,b){a=a||null,this.caption=b,this.value=a.value,this.text=a.text,this.isSelected=a.isSelected}return a});
define('ui/elements/filter/filter-group-no-ko',['require','./filter-item-no-ko'],function(require){"use strict";var a=require("./filter-item-no-ko");function b(b){var c;for(b=b||null,this.caption=b.caption,this.type=b.type,this.items=[],this.hideCaption=b.hideCaption,c=0;c<b.options.length;c++)this.items.push(new a(b.options[c].option,this.caption))}return b});
define('ui/elements/filter/filter-collection-no-ko',['require','./filter-group-no-ko'],function(require){"use strict";var a=require("./filter-group-no-ko");function b(){this.filterGroups=[]}return b.prototype.populateGroups=function(b){var c,d;for(c=0;c<b.filteroptions.length;c++)d=new a(b.filteroptions[c]),this.filterGroups.push(d)},b.prototype.clear=function(){this.filterGroups=[]},b});

define('text!ui/elements/checkbox/template.html',[],function () { return '<div class="checkbox-noko-container">\r\n    <input type="checkbox" />\r\n    <label class="">\r\n        <span class="checkbox-label"></span>\r\n        <span class="chkbox-text"></span>\r\n    </label>\r\n   \r\n</div>';});

define('ui/elements/checkbox/view-model',['require','jquery','text!./template.html','knockout'],function(require){"use strict";var a=require("jquery"),b=require("text!./template.html"),c=require("knockout"),d=Object.create(HTMLElement.prototype);d.createdCallback=function(){this.implementation=Object.resolve(e),this.implementation.element=this,this.implementation.$element=a(this),Object.tryMethod(this.implementation,"created")},d.attachedCallback=function(){Object.tryMethod(this.implementation,"attached")},d.detachedCallback=function(){Object.tryMethod(this.implementation,"detached")},d.attributeChangedCallback=function(a,b,c){Object.tryMethod(this.implementation,a+"Changed",b,c)};function e(){this.element=null,this.$element=null,this.$input=null,this.$container=b,this.inputChangeHandler=f.bind(null,this),this.init={}}e.prototype.created=function b(){var c=this;this.Node=document.createElement("div"),a(this.Node).append(),a(this.element).empty().append(this.$container),this.$input=this.$element.find('input[type="checkbox"]'),this.$label=this.$element.find("label")
;var d=this.getGuid();this.$input.attr("id",d),this.$label.attr("for",d),this.setAccessor("text",g.bind(this,this,"text")),this.setAccessor("checked",g.bind(this,this,"checked")),this.setAccessor("disabled",g.bind(this,this,"disabled")),this.setAccessor("value",g.bind(this,this,"value")),this.setAccessor("name",g.bind(this,this,"name"))},e.prototype.attached=function a(){this.$input.on("change",this.inputChangeHandler)},e.prototype.detached=function a(){this.$input.off("change",this.inputChangeHandler)};function f(a,b){a.$element.parents("mi-widget").length&&b.stopPropagation(),a.checked(b.currentTarget.checked),a.$element.trigger("checkedChange",[b.currentTarget.checked,a.value()])}function g(a,b,c){return"text"===b?void a.$element.find(".chkbox-text").html(c):"checked"===b?void(a.$input.get(0).checked="checked"===c||h(c)):"disabled"===b?void a.$input.prop("disabled",h(c)):void(a.$input&&a.$input.prop(b,c))}function h(a){return"false"!==a&&a!==!1&&("true"===a||a===!0)}
e.prototype.setAccessor=function(a,b){this[a]=c.observable(),Object.defineProperty(this.element,a,{get:i.bind(this,this,a),set:j.bind(this,this,a)}),this[a+"Changed"]=k.bind(this,this,a),this[a].subscribe(l.bind(this,this,b)),this[a](this.element.getAttribute(a))};function i(a,b){return a[b]()}function j(a,b,c){a[b](c)}function k(a,b,c,d){a[b](d)}function l(a,b,c){b&&b.call(a,c)}return e.prototype.getGuid=function a(){return this.s4()+this.s4()+"-"+this.s4()+"-"+this.s4()+"-"+this.s4()+"-"+this.s4()+this.s4()+this.s4()},e.prototype.s4=function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)},Element.registerElement("mi-checkbox-noko",{prototype:d}),e});

define('text!ui/elements/radio/template.html',[],function () { return '<div class="radio-noko-container">\r\n    <input type="radio" tabindex="0" />\r\n    <label class="">\r\n        <span class="radio-label"></span>\r\n        <span class="radio-text"></span>\r\n    </label>\r\n\r\n</div>';});

define('ui/elements/radio/view-model',['require','jquery','text!./template.html','knockout'],function(require){"use strict";var a=require("jquery"),b=require("text!./template.html"),c=require("knockout"),d=Object.create(HTMLElement.prototype);d.createdCallback=function(){this.implementation=Object.resolve(e),this.implementation.element=this,this.implementation.$element=a(this),Object.tryMethod(this.implementation,"created")},d.attachedCallback=function(){Object.tryMethod(this.implementation,"attached")},d.detachedCallback=function(){Object.tryMethod(this.implementation,"detached")},d.attributeChangedCallback=function(a,b,c){Object.tryMethod(this.implementation,a+"Changed",b,c)};function e(){this.element=null,this.$element=null,this.$input=null,this.$container=b,this.init={}}e.prototype.created=function(){var b=this;this.Node=document.createElement("div"),a(this.Node).append(this.$container),a(this.element).html(this.Node),this.$input=this.$element.find('input[type="radio"]'),this.$label=this.$element.find("label");var c=this.getGuid();this.$input.attr("id",c),
this.$label.attr("for",c),this.$input.on("change",function(a){b.checked(a.currentTarget.checked),b.$element.trigger("checkedChange",[a.currentTarget.checked,b.value(),b.name()])}),this.setAccessor("text",f.bind(this,this,"text")),this.setAccessor("checked",f.bind(this,this,"checked")),this.setAccessor("value",f.bind(this,this,"value")),this.setAccessor("name",f.bind(this,this,"name"))};function f(a,b,c){return a.init[b]&&"null"!==c?"text"===b?void a.$element.find(".radio-text").html(c):"checked"===b?void(a.$input.get(0).checked=g(c)):"disabled"===b?void a.$input.prop("disabled",g(c)):void(a.$input&&a.$input.prop(b,c)):void(a.init[b]=!0)}function g(a){if(!a)return!1;var b=a.toString();return"false"!==b&&"true"===b}return e.prototype.setAccessor=function(a,b){this[a]=c.observable(),this[a+"_canSet"]=!0,Object.defineProperty(this.element,a,{get:function(){return this[a]()}.bind(this),set:function(b){this[a+"_canSet"]=!1,this[a](b),this.element.setAttribute(a,b)}.bind(this)}),
this[a+"Changed"]=function(b,c){this[a+"_canSet"]=!1,this[a](c),this.element[a]=c}.bind(this),this[a].subscribe(function(c){b&&b.call(this,c),this.element.setAttribute(a,c),this.element[a]=c}.bind(this)),this[a](this.element.getAttribute(a)),b&&b.call(this,this.element.getAttribute(a))},e.prototype.attached=function(){},e.prototype.getGuid=function a(){return this.s4()+this.s4()+"-"+this.s4()+"-"+this.s4()+"-"+this.s4()+"-"+this.s4()+this.s4()+this.s4()},e.prototype.s4=function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)},Element.registerElement("mi-radio-noko",{prototype:d}),e});
define('ui/elements/filter/filter-no-ko',['require','lodash','jquery','text!./filter-btn-no-ko-view.html','text!./filter-body-no-ko-view.html','text!./filter-group-no-ko-view.html','./filter-collection-no-ko','system/lang/converter','system/globalization/translator','spa/conductor','spa/region','ui/elements/select/view-model','ui/elements/checkbox/view-model','ui/elements/radio/view-model'],function(require){"use strict";var a=require("lodash"),b=require("jquery"),c=require("text!./filter-btn-no-ko-view.html"),d=require("text!./filter-body-no-ko-view.html"),e=require("text!./filter-group-no-ko-view.html"),f=require("./filter-collection-no-ko"),g=require("system/lang/converter"),h=require("system/globalization/translator"),i=require("spa/conductor"),j=require("spa/region");require("ui/elements/select/view-model"),require("ui/elements/checkbox/view-model"),require("ui/elements/radio/view-model");var k=Object.create(HTMLElement.prototype);k.createdCallback=function(){var c=this;this.resizeProxy=b.proxy(a.debounce(this.resize,100),this),this.scrollProxy=b.proxy(this.scroll,this),this.translator=Object.resolve(h),this.isClicked=!1,this.element=this,this.$element=null,this.isVisible=!1,this.isFilterScrollable=this.getFilterScrollable(),this.loader=null,this.filterOptions=[],this.filterCollection=new f,this.filterVMRegion=null,this.tags=[],
this.customHTML=this.getAttribute("custom-html"),this.customFilter=this.getAttribute("custom-filter"),this.documentClickHandlerFn=r.bind(null,this),c.conductor=Object.resolve(i),c._filterViewModel=null,Element.defineProperty(c,"filterViewModel",{get:n.bind(null,c),set:o.bind(null,c)}),this._loader=null,Element.defineProperty(c,"loader",{get:t.bind(null,c),set:u.bind(null,c)}),this.callback=null,Element.defineProperty(c,"filterCB",{get:function(){return c.callback},set:function(a){c.callback=a}}),this._popupWidth=null,Element.defineProperty(c,"popupWidth",{get:function(){return c._popupWidth},set:function(a){c._popupWidth=a}}),this._showHeading=!0,Element.defineProperty(c,"showHeading",{get:function(){return c._showHeading},set:function(a){void 0!==a&&(c._showHeading=g.toBoolean(a,"true"))}}),this._showTags=!0,Element.defineProperty(c,"showTags",{get:function(){return c._showTags},set:function(a){void 0!==a&&(c._showTags=g.toBoolean(a,"true"))}}),this._maxHeight=null,
Element.defineProperty(c,"maxHeight",{get:function(){return c._maxHeight},set:function(a){c._maxHeight=a}}),this._internalIcon=null,Element.defineProperty(c,"icon",{get:function(){return c._internalIcon}.bind(c),set:function(a){l(c,a)}.bind(c)}),this._disabled=b(this).is("[disabled]"),Element.defineProperty(c,"disabled",{get:function(){return c._disabled}.bind(c),set:function(a){m(c,a)}.bind(c)}),c._internalIcon&&l(c,c._internalIcon)},k.attachedCallback=function(){this.setElement(),this.htmlToDisplay=this.element.innerHTML,this.element.innerHTML=c,this.attachClickHandlers(),l(this,this._internalIcon),m(this,this._disabled)},k.detachedCallback=function(){this.customFilter&&(q(this),this.conductor.unloadScreen(this.filterViewModel),this.conductor.closeScreen(this.filterViewModel)),b(document).find("#shell-screen").off("mousedown.mifilter touchstart click",this.documentClickHandlerFn),W(this),this.resizeProxy=null,this.scrollProxy=null,this.translator=null,this.isClicked=null,
this.isVisible=!1,this.isFilterScrollable=null,this.loader=null,this.filterOptions=null,this.filterCollection&&(this.filterCollection.clear(),this.filterCollection=null),this.filterVMRegion=null,this.tags=null,this.customHTML=null,this.customFilter=null,this.documentClickHandlerFn=null,this.conductor=null,this._loader=null,this.callback=null,this._popupWidth=null,this._showHeading=null,this._showTags=null,this._maxHeight=null,this._internalIcon=null,this._disabled=null,this._filterViewModel=null,this.filterViewModel=null,this.$element=null},k.attributeChangedCallback=function(a,b,c){var d=this;"custom-html"===a?(d.customHTML=c,W(d),"true"===c&&z(d)):"custom-filter"===a?(d.customFilter=c,W(d),"true"===c&&d.isVisible&&(d.conductor.openScreen(d._filterViewModel),d.conductor.loadScreen(d._filterViewModel),z(d))):"icon"===a?l(d,c):"disabled"===a&&m(d,c)};function l(a,c){a._internalIcon=c?c.trim():"icon-collection-filter",b(a).find("button i").removeAttr("class").addClass(a._internalIcon)}
function m(a,c){void 0!==c&&(a._disabled=c),a._disabled?b(a).find("button").addClass("disabled"):b(a).find("button").removeClass("disabled")}k.load=function(){var a;return this.loader?(a=this.loader(),a.promise()):b.Deferred().done().promise()},k.setElement=function(){this.$element=b(this.element)},k.attachClickHandlers=function(){this.$element.find(".icon-container").on("click",v.bind(null,this)),b(document).find("#shell-screen").on("mousedown.mifilter touchstart click",this.documentClickHandlerFn),this.find=s.bind(null,this)},k.detachClickHandlers=function(){},k.resize=function(a){b(a).find(".icon-container").is(":visible")&&a.isVisible&&X(this)},k.scroll=function(a){g.toBoolean(a.isFilterScrollable,"true")?a.resize(a):(w(a),a.isVisible=!1)},k.getFilterScrollable=function(){return this.getAttribute("isfilterscrollable")||!0},k.closeFilter=function(){w(this)};function n(a){return a._filterViewModel}function o(a,b){b?(a._filterViewModel=b,
"true"===a.getAttribute("custom-filter")&&(a.conductor.openScreen(a._filterViewModel),a.conductor.loadScreen(a._filterViewModel))):a._filterViewModel=null}function p(a){var c=new j;a.filterVMRegion=c,c.setElement(b(".filter-outer-container .filters-noko")),a.conductor.activateScreen(a.filterViewModel),a.conductor.attachScreen(a.filterViewModel,c)}function q(a){a.conductor.deactivateScreen(a.filterVMRegion),a.conductor.detachScreen(a.filterVMRegion)}function r(a,c,d){a.isClicked?a.isClicked=!1:b(".filter-outer-container").find(c.target).length||b(".filter-outer-container").find(d).length||b(c.target).closest(".icon-filter-container").length||w(a)}function s(a,c){return b(a.htmlToDisplay).find(c)[0]}function t(a){return a._loader}function u(a,b){a._loader=b,a.isPopulated=!1,a.filterCollection&&a.filterCollection.clear()}function v(a,b){b.stopPropagation(),a._disabled||(a.isVisible?w(a):x(a))}function w(a){a.isVisible=!1,b(window).off("resize",a.resizeProxy.bind(null,a)),
b(a).parents().off("scroll",a.scrollProxy.bind(null,a)),a.contentContainer&&b(a.contentContainer).off(" click","**"),"true"===a.customFilter&&q(a),W(a)}function x(a){a.isClicked=!0,a.isVisible=!0,b(document).find("#shell-screen").trigger("mousedown.mifilter"),"true"===a.customHTML||"true"===a.customFilter?z(a):a.load().done(y.bind(null,a))}function y(a,b){a.filterOptions=b,z(a)}function z(a){V(a),"true"===a.customHTML?b(".filter-outer-container .filters-noko").empty().append(a.htmlToDisplay):"true"===a.customFilter?p(a):(a.filterOptions.sortOptions&&a.filterOptions.sortOptions.length?B(a):b(".filter-outer-container .sort-header").hide(),E(a)),Y(a),X(a),A(a)}function A(a){null!==a._maxHeight&&b(".filter-outer-container .filter-body").css({"max-height":a._maxHeight+"px"})}function B(a){var c=b(".filter-outer-container .sort-header")[0],d,e;for(b(c).append('<mi-select class="sort-dropdown"></mi-select>'),d=b(c).find(".sort-dropdown")[0],e=0;e<a.filterOptions.sortOptions.length;e++);
b(d).data("options",a.filterOptions.sortOptions),b(d).attr("data-options",JSON.stringify(a.filterOptions.sortOptions)),C(a)}function C(a){b(".filter-outer-container .sort-header .sort-dropdown").on("valueChange",function(c){c.preventDefault(),D(a,"sort",b(this).val())})}function D(a,b,c){Object.tryMethod(a,"callback",b,c)}function E(a){a.isPopulated||(F(a),a.isPopulated=!0),G(a),L(a),a.contentContainer.find(".clear-all a").on("click",Q.bind(null,a))}function F(a){a.filterCollection.populateGroups(a.filterOptions)}function G(a){var b,c=a.filterCollection,d=c.filterGroups;for(a.tags=[],b=0;b<d.length;b++)H(a,d[b],b)}function H(a,c,d){var f=a.contentContainer.find(".filter-body").get(0),g=b(e),h,i,j;if(g.data("group-index",d),i=g.find("header"),j=g.find(".form-item div").get(0),I(i,c.caption),"select"===a.filterCollection.filterGroups[d].type)J(a,j,c,d);else for(h=0;h<c.items.length;h++)K(a,j,c.items[h],h,d);b(f).append(g)}function I(a,c){b(a).append(c)}function J(a,c,d,e){
for(var f=d.hideCaption?b('<mi-select data-optionsvalue="value" data-optionstext="text"></mi-select><br />').data({"group-index":e}):b('<mi-select data-optionsvalue="value" data-optionstext="text" data-optionscaption="'+a.filterCollection.filterGroups[e].caption+'"></mi-select><br />').data({"group-index":e}),g=0;g<d.items.length;g++)if(d.items[g].isSelected){b(f[0]).data("value",d.items[g].value),b(f[0]).attr("data-value",d.items[g].value),T(a,{target:f[0]},d.items[g].value,d.caption,d.items[g].text);break}b(f).data("options",d.items),b(f).attr("data-options",JSON.stringify(d.items)),b(c).append(f)}function K(a,c,d,e,f){var g,h;"checkbox"===a.filterCollection.filterGroups[f].type?g=b('<mi-checkbox-noko  value="'+d.value+'" text="'+d.text+'" ></mi-checkbox-noko><br />').data({"group-index":f,"item-index":e,item:d
}):"radio"===a.filterCollection.filterGroups[f].type&&(g=b('<mi-radio-noko  value="'+d.value+'" text="'+d.text+'" name="'+a.filterCollection.filterGroups[f].caption+'" ></mi-radio-noko>').data({"group-index":f,"item-index":e,item:d})),b(c).append(g),d.isSelected&&"checkbox"===a.filterCollection.filterGroups[f].type?(T(a,{target:g[0]},d.value,h,d.text),b(g[0]).attr("checked",d.isSelected)):d.isSelected&&"radio"===a.filterCollection.filterGroups[f].type&&(h=a.filterCollection.filterGroups[f].caption,T(a,{target:g[0]},d.value,h,d.text),g[0].setAttribute("checked",d.isSelected)),b(c).append(g)}function L(a){var b=a.contentContainer.find(".filter-body"),c,d,e;c=b.find("mi-checkbox-noko"),c&&(Element.upgrade(c),c.on("checkedChange",O.bind(null,a))),d=b.find("mi-radio-noko"),d&&(Element.upgrade(d),d.on("checkedChange",N.bind(null,a))),(e=b.find("mi-select"))&&(Element.upgrade(e),e.on("valueChange",M.bind(null,a)))}function M(c,d,e){d.preventDefault()
;var f=b(d.target).data(),g=parseInt(f["group-index"]),h=c.filterCollection.filterGroups[g],i=h.caption;if(e){R(c,i);var j=a.find(h.items,function(a){if(a&&a.value===e)return a});T(c,d,e,i,j.text)}else{P(c,e);var k=b(d.target).data("tag");k&&k.remove()}for(var l=h.type,m=c.filterCollection.filterGroups[g].items,n,o=0;o<m.length;o++)m[o].isSelected=!1,void 0!==m[o].value&&null!==m[o].value&&void 0!==e&&null!==e&&m[o].value.toString()===e.toString()&&(m[o].isSelected=!0,n=m[o]);c.filterCollection.filterGroups[g].items=m,S(c,l,n)}function N(a,c,d,e,f){if(d)R(a,f),T(a,c,e,f,e);else{P(a,e);b(c.target).data("tag").remove()}for(var g=b(c.target).data(),h=parseInt(g["group-index"]),i=a.filterCollection.filterGroups[h],j=i.type,k=a.filterCollection.filterGroups[h].items,l,m=0;m<k.length;m++)k[m].isSelected=!1;a.filterCollection.filterGroups[h].items=k,a.filterCollection.filterGroups[h].items[g["item-index"]].isSelected=d,g.item.isSelected=d,S(a,j,g.item)}function O(a,c,d,e){var f=c.target.text
;if(d)T(a,c,e,null,f);else{P(a,e);b(c.target).data("tag").remove()}var g=b(c.target).data(),h=parseInt(g["group-index"]),i=a.filterCollection.filterGroups[h],j=i.type;a.filterCollection.filterGroups[h].items[parseInt(g["item-index"])].isSelected=d,g.item.isSelected=d,S(a,j,g.item)}function P(a,b){var c=a.tags.indexOf(b);c>=0&&a.tags.splice(c,1),a.tags.length||(a.contentContainer.find(".tag-section").hide(),a.contentContainer.find(".clear-all").hide(),Y(a),X(a))}function Q(a){for(var c=a.contentContainer.find(".tag-section").find(".tag"),d=0;d<c.length;d++){var e=b(c[d]).data();U(a,e.value,e.item,{target:c[d]})}}function R(a,b){var c=a.contentContainer.find(".tag-section").find('.tag[name="'+b+'"]'),d=c.data("value"),e=a.tags.indexOf(d);a.tags.splice(e,1),c.remove()}function S(a,b,c){var d,e=a.filterCollection,f=e.filterGroups;Object.tryMethod(a,"callback",b,c,a.tags)}function T(a,c,d,e,f){a.contentContainer.find(".tag-section").show(),a.contentContainer.find(".clear-all").show(),
a.tags.push(d);var g=b('<div class="tag tag-style"><span><span>'+f+'</span></span><i class="icon-node-error icon-style"></i></div>');g.attr("name",e).data({value:d,item:c}).find(".icon-style").on("click",U.bind(null,a,d,c)),b(c.target).data("tag",g),g.appendTo(a.contentContainer.find(".tag-section"))}function U(a,c,d,e){b(e.target).closest(".tag").remove(),P(a,c);var f=b(d.target).data(),g=parseInt(f["group-index"]),h=a.filterCollection.filterGroups[g],i=h.type;if("checkbox"===i||"radio"===i?d.target.checked=!1:(b(d.target).data("value",""),b(d.target).attr("data-value","")),"checkbox"===i)a.filterCollection.filterGroups[g].items[parseInt(f["item-index"])].isSelected=!1;else if("radio"===i||"select"===i){for(var j=a.filterCollection.filterGroups[g].items,k=0;k<j.length;k++)j[k].isSelected=!1;a.filterCollection.filterGroups[g].items=j}S(a,i,b(d.target).data().item)}function V(a){var c,e;e=b(".content-wrapper"),c=document.createElement("div"),b(c).addClass("filter-outer-container"),
a.contentContainer=b(c),b(e).after(c),b(c).append(d).on("mousedown.mifilter",function a(b){b.stopPropagation()}),b(c).find(".clear-all a").html(a.translator.translate("MF_CLEAR_ALL")),b(b(c).find(".filter-header header")[0]).text(a.translator.translate("FILTER_HEADER_CAPTION")),b(b(c).find(".filter-header")[0]).removeClass("hide"),a.contentContainer.find(".tag-section").removeClass("hide"),a.showHeading||b(b(c).find(".filter-header")[0]).addClass("hide"),a.showTags||a.contentContainer.find(".tag-section").hide().addClass("hide")}function W(a){b(".filter-outer-container").remove()}function X(a){var c=50,d,e;Y(a),Z(a),a.ctrlOffset&&a.ctrlOffset.top+a.filtersHeight+c>=b(window).height()?$(a):_(a),b(window).on("resize",a.resizeProxy.bind(null,a)),b(a).parents().on("scroll",a.scrollProxy.bind(null,a))}function Y(a){a.outerContainer=b(a.contentContainer),a.ctrlOffset=b(a).find(".icon-container").offset(),a.ctrlWidth=b(a).find(".icon-container").width()+25,
null!==a._popupWidth&&b(a.outerContainer).find(".filters-noko").css("width",a._popupWidth+"px"),b(a.outerContainer).css({position:"absolute"}),a.filtersWidth=b(a.outerContainer).find(".filters-noko").width(),a.filtersHeight=b(a.outerContainer).find(".filters-noko").height()}function Z(a){b(a.outerContainer).find(".filters-noko").removeClass("top-left top-right bottom-left bottom-right")}function $(a){var b;a.ctrlOffset&&(b=a.ctrlOffset.top-a.filtersHeight-10,a.ctrlOffset&&a.ctrlOffset.left+a.ctrlWidth-a.filtersWidth<80?aa(a,"top-left",b):ba(a,"top-right",b))}function _(a){var b;a.ctrlOffset&&(b=a.ctrlOffset.top+50-6,a.ctrlOffset&&a.ctrlOffset.left+a.ctrlWidth-a.filtersWidth<80?aa(a,"bottom-left",b):ba(a,"bottom-right",b))}function aa(a,b,c){var d;d=a.ctrlOffset.left,ca(a,b),da(a,d,c)}function ba(a,b,c){var d;d=a.ctrlOffset.left-Math.abs(a.ctrlWidth-a.filtersWidth),null!==a._popupWidth&&(d-=12),ca(a,b),da(a,d,c)}function ca(a,c){var d;d=b(a.outerContainer).find(".filters-noko"),
b(d).addClass(c)}function da(a,c,d){b(a.outerContainer).css({left:c,top:d})}return document.registerElement("mi-filter-no-ko",{prototype:k}),k});
define('assets/asset-hierarchy-control',['require','jquery','spa/ko/knockout-view-model','system/knockout/knockout-manager','spa/region','application/application-events','application/application-context','assets/services/hierarchy-service','assets/asset-hierarchy-control-filter','assets/services/asset-context-dto','system/globalization/translator','toastr','text!./views/asset-hierarchy-control.html','text!./views/asset-hierarchy-control-filter.html','text!./views/asset-hierarchy-control-search.html','ramda','devExWebJS','ui/elements/tree/view-model','ui/elements/filter/filter-no-ko','ui/elements/searchbox/view-model','unified-asset-context-browser'],function(require){"use strict";var a=require("jquery"),b=require("spa/ko/knockout-view-model"),c=require("system/knockout/knockout-manager"),d=require("spa/region"),e=require("application/application-events"),f=require("application/application-context"),g=require("assets/services/hierarchy-service"),h=require("assets/asset-hierarchy-control-filter"),i=require("assets/services/asset-context-dto"),j=require("system/globalization/translator"),k=require("toastr"),l=require("text!./views/asset-hierarchy-control.html"),m=require("text!./views/asset-hierarchy-control-filter.html"),n=require("text!./views/asset-hierarchy-control-search.html"),o=require("ramda");require("devExWebJS"),require("ui/elements/tree/view-model"),require("ui/elements/filter/filter-no-ko"),require("ui/elements/searchbox/view-model"),require("unified-asset-context-browser");var p={selector:"none",multiSelect:!1},q=500,r=500,s=1;function t(a,b,c){u.call(this,l),this.service=a,this.tree=null,this.translator=b,
this.kom=c,this.filter=null,this.category=null,this.class=null,this.type=null,this.applyingFilter=!1,this.errorOccured=Object.resolve(e).errorOccured,this.sites=null,this.searchSelectedKey=null,this.selectChildren=null,this.disableSelectAllChildren=null,this.searchTerm=null,this.currentContext=[],this.contextNodes={},this.selectedAsset=null,this.filterConfigLoaded=!1}var u=Object.inherit(b,t);t.dependsOn=[g,j,c],t.create=function b(c){var d=Object.resolve(t);return d.settings=a.extend(null,p,c),d},t.prototype.load=function(){var a=this;this.category=this.kom.observable(),this.class=this.kom.observable(),this.type=this.kom.observable(),this.filter=new h(this.category,this.class,this.type),this.selectChildren=this.kom.observable(this.settings.selectChildren),this.disableSelectAllChildren=this.kom.observable(!0)},t.prototype.attach=function a(b,c){var e=this;this.settings.contentArea?(this.region=new d,this.region.setElement(b.$element.find(this.settings.contentArea))):this.region=b,
u.prototype.attach.call(this,this.region),this.contextBrowser=this.region.$element.find("asset-hierarchy-control")[0],this.isFirstLoad=!0,this.filterConfigLoaded=!1,Element.upgrade(this.contextBrowser),this.contextBrowser.filterTemplate=m,this.contextBrowser.searchTemplate=n,this.contextBrowser.spinnerTemplate='<span class="loading-med loading-active center-block" ></span>',this.contextBrowser.enableMultiSelect="addOnly"===this.settings.selector,this.contextBrowser.itemSelectorIcon='<i class="icon-plus"></i>',this.contextBrowser.addToolbarButton(v(this)),this.contextBrowser.itemExpandCB=G.bind(null,this),this.contextBrowser.filterConfig=y.bind(null,this),this.contextBrowser.filterCB=w.bind(null,this),this.contextBrowser.searchCB=F.bind(null,this),this.contextBrowser.addEventListener("selected",this),this.contextBrowser.addEventListener("search-cleared",this),!c&&z(this),this.disableSelectAllChildren.subscribe(function(a){
e.region&&e.region.$element&&e.region.$element.find(".add-all-children-btn").attr("disabled",!!a)})};function v(b){var c=a('<button><i class="icon-plus"></i></button>').addClass("btn btn-default btn-icon add-all-children-btn").attr("title",b.translate("ADD_ALL_CHILDREN")).attr("disabled",b.disableSelectAllChildren()).on("click",b.addAllChildren.bind(null,b));return b.settings.enableAddAllChildren&&!b.selectChildren()?c[0]:a("<span></span>")[0]}function w(a,b,c){var d,e,f;c&&(d=c[0],e=c[1],f=c[2]),a.applyingFilter=!0,a.category(d||null),a.class(e||null),a.type(f||null),!c&&a.contextBrowser.selected&&"-1"!==a.contextBrowser.selected&&"0"!==a.contextBrowser.selected?a.service.path(a.contextBrowser.selected).done(x.bind(null,a)):z(a)}function x(a,b){if(a.contextBrowser){if(b.length>1){for(var c=[],d=0;d<b.length;d++)b[d].name=b[d].description,b[d].key=b[d].entityKey,b[d].parentKey="-1",b[d].hasChildren=!0,c.push(b[d]);a.currentContext=[].concat(c),a.isFirstLoad=!0,
a.pathToNavigateInitial=c,J(a,a.pathToNavigateInitial).then(function(){z(a).done(function(){a.contextBrowser.navigate(c)})})}}else z(a)}function y(a,b){a.service.taxonomy().done(function(c){a.filterConfigLoaded=!0;var d=[{id:"CATEGORY",title:a.translate("TAXONOMY_CATEGORY"),defaultCaption:a.translate("SEL_TAX_CAT_CAP"),visible:!0},{id:"CLASS",title:a.translate("TAXONOMY_CLASS"),defaultCaption:a.translate("SEL_TAX_CLS_CAP"),visible:!0},{id:"TYPE",title:a.translate("TAXONOMY_TYPE"),defaultCaption:a.translate("SEL_TAX_TYP_CAP"),visible:!0}];b.resolve(c,d);var e=[a.category(),a.class(),a.type()];e[0]&&a.contextBrowser.filter(e)})}function z(b,c,d){var e=a.Deferred(),f=[{name:"Home",description:"Home",entityKey:"-1",key:"-1",hasChildren:!0,canOpen:!1,isExpanded:void 0===d}];return f=c===!1?[]:f,b.contextBrowser&&b.contextBrowser.init(f,!0),e.resolve(f),e}t.prototype.handleEvent=function(a){"selected"!==a.type||this.searchTerm?"filter-closed"===a.type?(this.applyingFilter=!0,
z(this)):"selected"===a.type&&this.searchTerm?B(this,a):"search-cleared"===a.type&&C(this):(this.service.abort(),this.disableSelectAllChildren(!this.settings.multiSelect))};function A(a){return 1===a.newValue.length}function B(a,b){var c=a.contextBrowser.selectedAsset,d=c.entityKey;a.searchSelectedKey=d}function C(a){var b=null===a.contextBrowser.selectedAsset||"-1"===a.contextBrowser.selectedAsset.key&&a.contextBrowser.selectedAsset.key!==a.contextBrowser.selectedAssetKey?a.selectedAsset:a.contextBrowser.selectedAsset,c=b?b.entityKey:"-1";O(a)&&(c="-1"),a.searchTerm=null,a.service.path(c).done(D.bind(null,a))}function D(a,b){if(a.contextBrowser)if(b.length>1){for(var c=[],d=0;d<b.length;d++)b[d].name=b[d].description,b[d].key=b[d].entityKey,b[d].parentKey="-1",b[d].hasChildren=!0,c.push(b[d]);a.currentContext=[].concat(c),a.isFirstLoad=!0,a.pathToNavigateInitial=c,J(a,a.pathToNavigateInitial).then(function(){z(a).done(function(){a.contextBrowser.navigate(c)})})}else z(a)}
t.prototype.detach=function a(){this.service.abort(),this.region.$element.find(".hierarchy-control-filter").off("filter-closed"),this.contextBrowser.removeEventListener("selected",this),this.contextBrowser=null,this.toolbar=null,this.filterElem=null,this.searchElem=null,this.searchTerm=null,this.applyingFilter=!1,this.currentContext=[],this.contextNodes={},this.category(null),this.class(null),this.type(null),u.prototype.detach.call(this,this.region),this.region=null,this.filterConfigLoaded=!1},t.prototype.unload=function a(){this.kom.dispose()},t.prototype.translate=function(a){return this.translator.translate(a)},t.prototype.loadcontext=function(a){this.contextBrowser.selected=a,this.service.path(a).done(N.bind(null,this)).fail(P.bind(null,this))};var E=o.cond([[o.or(o.equals("0"),o.equals(0)),o.always(null)],[o.T,o.identity()]]);t.prototype.setSiteFilter=function(a){a&&(this.sites=o.map(E,a))},t.prototype.loadState=function(a){a=a||{tree:{value:i.default()}},
this.category(a.category),this.class(a.class),this.type(a.type),this.searchTerm=a.searchTerm,this.selectedAsset=a.context},t.prototype.saveState=function(){var a=null===this.contextBrowser.selectedAsset||null!==this.contextBrowser.selectedAsset&&"-1"===this.contextBrowser.selectedAsset.key&&this.contextBrowser.selectedAsset.key!==this.contextBrowser.selectedAssetKey;return{category:this.category(),class:this.class(),type:this.type(),context:a?this.selectedAsset:this.contextBrowser.selectedAsset,searchTerm:this.searchTerm}},t.prototype.getContextValue=function(){var a=null===this.contextBrowser.selectedAsset||"-1"===this.contextBrowser.selectedAsset.key&&this.contextBrowser.selectedAsset.key!==this.contextBrowser.selectedAssetKey;return i.fromHierarchyDTO(a?this.selectedAsset:this.contextBrowser.selectedAsset)},t.prototype.addAllChildren=function(a,b){var c=new CustomEvent("selectallchildren",{bubbles:!0,cancelable:!0,detail:a.contextBrowser.selectedAsset})
;a.contextBrowser&&a.contextBrowser.dispatchEvent(c)};function F(b,c,d,e,f){var g=a.Deferred();return e=s,f=r,b.searchTerm=c,c&&o.isNil(b.sites)?b.service.search(c,e,f).done(L.bind(null,b,g)).fail(P.bind(null,b)):c&&!o.isNil(b.sites)?b.service.search(c,e,f).done(M.bind(null,b,g,b.sites)).fail(P.bind(null,b)):g.resolve(),g}function G(b,c,d,e,g){var h="",i="",j="",k=d||a.Deferred(),l;return b.contextBrowser?(l=c||f.assetcontext)?b.contextNodes[l.entityKey]?(o.isNil(b.sites)?H(b,k,l,b.contextNodes[l.entityKey]):I(b,k,l,b.sites,b.contextNodes[l.entityKey]),delete b.contextNodes[l.entityKey],k):(b.category()&&(h=b.category().code),b.class()&&(i=b.class().code),b.type()&&(j=b.type().code),o.isNil(b.sites)?b.service.children(l.entityKey,h,i,j,s,q).done(H.bind(null,b,k,l)).fail(P.bind(null,b)):b.service.children(l.entityKey,h,i,j,s,q,b.sites).done(I.bind(null,b,k,l,b.sites)).fail(P.bind(null,b)),k):(setTimeout(H.bind(null,b,k,{data:[]})),k):(setTimeout(k.reject.bind(k),0),k)}
function H(a,b,c,d){for(var e=!1,f=a.currentContext&&a.currentContext.length>1,g=!1,h=0,i=0;i<a.currentContext.length-1;i++)a.currentContext[i].entityKey===c.entityKey&&(g=!0,h=i);var j=d.data.map(function(b){return b.name=b.description,b.key=a.searchTerm?R():b.entityKey,b.parentKey=a.searchTerm?c.key:c.entityKey,b.hasChildren=!!b.hasChildren,g&&!e&&f&&!a.searchTerm&&a.currentContext[h].entityKey===b.parentKey&&a.currentContext[h+1].entityKey===b.entityKey&&(e=!0),b});if(!e&&f&&g&&!a.searchTerm&&!a.applyingFilter){var k=a.currentContext[h+1];j.push(k)}if(j.length>=q){var l=a.searchTerm?c.key:c.entityKey,m={key:l.toString()+"_more_data",isAlertMessage:!0,name:a.translate("ASSET_HIERARCHY_TOO_MANY_MSG"),pathLabel:a.translate("ASSET_HIERARCHY_TOO_MANY_SUGGESTION"),parentKey:l};j.push(m)}b.resolve(j),a.category()&&0===d.data.length&&a.applyingFilter?z(a,!1):a.applyingFilter=!1}function I(a,b,c,d,e){o.forEach(K.bind(null,d),e.data)
;for(var f=!1,g=a.currentContext&&a.currentContext.length>1,h=!1,i=0,j=0;j<a.currentContext.length-1;j++)a.currentContext[j].entityKey===c.entityKey&&(h=!0,i=j);var k=e.data.map(function(b){return b.name=b.description,b.key=a.searchTerm?R():b.entityKey,b.parentKey=a.searchTerm?c.key:c.entityKey,b.hasChildren=!!b.hasChildren,b.canOpen=!b.disabledIcon,h&&!f&&g&&!a.searchTerm&&a.currentContext[i].entityKey===b.parentKey&&a.currentContext[i+1].entityKey===b.entityKey&&(f=!0),b});if(!f&&g&&h&&!a.searchTerm&&!a.applyingFilter){var l=a.currentContext[i+1];k.push(l)}if(k.length>=q){var m=a.searchTerm?c.key:c.entityKey,n={key:m.toString()+"_more_data",isAlertMessage:!0,name:a.translate("ASSET_HIERARCHY_TOO_MANY_MSG"),pathLabel:a.translate("ASSET_HIERARCHY_TOO_MANY_SUGGESTION"),parentKey:m};k.push(n)}b.resolve(k),a.category()&&0===e.data.length&&a.applyingFilter?z(a,!1):a.applyingFilter=!1}function J(b,c){var d=c.filter(function(a){return a.entityKey!==c[c.length-1].entityKey})
;return a.when.apply(a,d.map(function(a){return b.service.children(a.entityKey,"","","",s,q)})).then(function(){for(var a=0;a<d.length;a++)b.contextNodes[d[a].key]=arguments[a]})}function K(a,b){b.disabledIcon=!o.contains(b.siteKey,a)}function L(a,b,c){if(b.resolve(c.data),a.searchSelectedKey=null,a.contextBrowser){var d=c.data.map(function(a){return a.name=a.description,a.key=R(),a.parentKey="-1",a.hasChildren=!!a.hasChildren,a.pathLabel=a.hierarchyPath,a});if(d.length>=r){var e={key:R()+"_more_data",isAlertMessage:!0,name:a.translate("ASSET_HIERARCHY_TOO_MANY_MSG"),pathLabel:a.translate("ASSET_HIERARCHY_TOO_MANY_SUGGESTION"),parentKey:"-1"};d.push(e)}a.contextBrowser.init(d)}}function M(a,b,c,d){if(o.forEach(K.bind(null,c),d.data),b.resolve(d.data),a.searchSelectedKey=null,a.contextBrowser){var e=d.data.map(function(a){return a.name=a.description,a.key=R(),a.parentKey="-1",a.hasChildren=!!a.hasChildren,a.canOpen=!a.disabledIcon,a.pathLabel=a.hierarchyPath,a});if(e.length>=r){var f={
key:R()+"_more_data",isAlertMessage:!0,name:a.translate("ASSET_HIERARCHY_TOO_MANY_MSG"),pathLabel:a.translate("ASSET_HIERARCHY_TOO_MANY_SUGGESTION"),parentKey:"-1"};e.push(f)}a.contextBrowser.init(e)}}function N(a,b){var c;if(a&&a.contextBrowser){for(var d=[],e=0;e<b.length;e++)b[e].name=b[e].description,b[e].key=b[e].entityKey,b[e].parentKey="-1",b[e].hasChildren=!0,d.push(b[e]);c=[a.category(),a.class(),a.type()],a.currentContext=[].concat(d),a.pathToNavigateInitial=d,a.searchTerm&&null!==a.searchTerm?a.contextBrowser.search(a.searchTerm):c[0]?(z(a,!0,!1),a.filterConfigLoaded&&a.contextBrowser.filter(c)):J(a,a.pathToNavigateInitial).then(function(){z(a).done(function(){a.isFirstLoad?a.contextBrowser.navigate(d):a.pathToNavigateInitial=d})})}}function O(b){return!!a(b.region.element).parents(".asset-finder-screen").length}function P(a,b,c,d){d&&"abort"!==d&&k.error(d,void 0,{positionClass:"toast-top-right "})}function Q(){
return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function R(){return Q()+Q()+""+Q()+Q()+Q()+Q()+Q()+Q()}return t});
define('system/http/ajax-request',['require','lodash','system/http/ajax-client','mi-assert'],function(require){"use strict";var a=require("lodash"),b=require("system/http/ajax-client"),c=require("mi-assert");function d(a,c,d,e){this.ajaxClient=Object.resolve(b),this.method=a,this.url=c,this.data=d||null,this.options=e||null}d.get=function(a,b){return new d("get",a,null,b)},d.post=function(a,b,c){return new d("post",a,b,c)},d.put=function(a,b,c){return new d("put",a,b,c)},d.delete=function(a,b){return new d("delete",a,null,b)},d.prototype.send=function a(b){var c;if("get"===this.method)c=this.ajaxClient.get(this.url,this.options);else if("post"===this.method)c=this.ajaxClient.post(this.url,this.data,this.options);else if("put"===this.method)c=this.ajaxClient.put(this.url,this.data,this.options);else{if("delete"!==this.method)throw"Unknown request method: "+this.method;c=this.ajaxClient.delete(this.url,this.options)}return b&&c.fail(this.onFail(b)),c},d.prototype.onFail=function a(b){return c.isObject(b,"dfd"),e.bind(null,b,this)};function e(b,e,f){c.isObject(b,"dfd"),
c.instanceOf(e,d,"request"),c.isObject(f,"response"),a.isFunction(b.promise)?b.reject(e,f):b.reject({request:e,response:f})}return d});
define('system/http/es6-ajax-request',['require','./ajax-request','bluebird'],function(require){"use strict";var a=require("./ajax-request"),b=require("bluebird");function c(a,b,c,e){d.call(this,a,b,c,e),this.xhr=null}var d=Object.inherit(a,c);c.get=function(a,b){return new c("get",a,null,b)},c.post=function(a,b,d){return new c("post",a,b,d)},c.put=function(a,b,d){return new c("put",a,b,d)},c.delete=function(a,b){return new c("delete",a,null,b)},c.prototype.send=function(){return this.xhr=d.prototype.send.call(this),b.resolve(this.xhr).catch(e.bind(null,this))};function e(a,b){return{request:a,response:b}}return c});
define('assets/services/asset-dto',['require','system/lang/converter'],function(require){"use strict";var a=require("system/lang/converter");function b(b){b=b||{},this.entityKey=a.toString(b.entityKey),this.equipmentId=a.toString(b.equipmentId),this.groupid=a.toString(b.equipmentId),this.familyId=a.toString(b.familyId),this.siteKey=a.toInteger(b.siteKey)}return b.fromDataCollection=function a(c){var d,e=[];for(d=0;d<c.length;d++)e[d]=new b(c[d]);return e},b.fromSelectedAsset=function a(c){return new b({entityKey:c.entityKey,equipmentId:c.description,familyId:c.familyId,siteKey:c.siteKey})},b.fromSelectedAssetArray=function a(c){return c.map(b.fromSelectedAsset)},b});
define('assets/services/asset-group-dto',['require','system/lang/converter','assets/services/asset-dto','assets/services/hierarchy-dto','assets/models/family','system/lang/string'],function(require){"use strict";var a=require("system/lang/converter"),b=require("assets/services/asset-dto"),c=require("assets/services/hierarchy-dto"),d=require("assets/models/family");require("system/lang/string");function e(e){e=e||{},this.entityKey=a.toString(e.entityKey),this.groupid=a.toString(e.groupid),this.createdBy=a.toString(e.createdBy),this.modifiedBy=a.toString(e.lastUpdatedBy),this.modifiedOn=a.toDate(e.lastUpdatedDate),this.groupdesc=a.toString(e.groupdesc),this.catalogKey=a.toInteger(e.catalogKey),this.catalogPath=a.toString(e.catalogPath),this.siteKey=a.toInteger(e.siteKey),this.equipmentCount=a.toInteger(e.equipmentCount),this.relationships=e.relationships?d.fromDataCollection(e.relationships):[],this.equipments=e.equipments?b.fromDataCollection(e.equipments):[],this.corrosionloops=e.corrosionloops?f(e.corrosionloops):[],this.hierarchyparents=e.hierarchyparents?c.fromDataCollection(e.hierarchyparents):[],this.selected=null}e.fromDataCollection=function a(b){
var c,d=[];for(c=0;c<b.length;c++)d[c]=new e(b[c]);return d},e.fromAssetContextDTO=function a(b){return new e({entityKey:b.entityKey,createdBy:b.createdBy,groupid:b.description})};function f(b){var c,d=[];for(c=0;c<b.length;c++)d[c]=a.toString(b[c]);return d}return e});
define('security/services/usersite-dto',['require','system/lang/converter'],function(require){"use strict";var a=require("system/lang/converter");function b(b){b=b||{},this.key=a.toString(b.key)||"0",this.siteKey=a.toString(b.siteKey)||"0",this.userKey=a.toString(b.userKey)||"0",this.viewOnly=a.toBoolean(b.viewOnly)||!1,this.siteName=a.toString(b.siteName),this.userName=a.toString(b.userName),this.lockSeq=a.toString(b.lockSeq)||"0"}return b.fromDataCollection=function a(c){if(c){var d,e=[];for(d=0;d<c.length;d++)e[e.length]=new b(c[d]);return e}},b});
define('security/services/site-dto',['require','./usersite-dto','system/lang/converter'],function(require){"use strict";var a=require("./usersite-dto"),b=require("system/lang/converter");function c(c){c=c||{},this.name=b.toString(c.name),this.key=b.toString(c.key)||"0",this.lockSeq=b.toString(c.lockSeq),this.users=a.fromDataCollection(c.users)}return c.fromDataCollection=function a(b){if(b){var d,e=[];for(d=0;d<b.length;d++)e[e.length]=new c(b[d]);return e}},c});
define('system/lang/url-codec',["require","exports"],function(require,exports){"use strict";var a=[],b=/\[\]$/,c=/\[/,d=/\]$/,e=function(){function b(){}return b.encode=function(b){return a=[],h("",b).join("&")},b.decode=function(a){return i(a)},b}();function f(a){return"[object Array]"===Object.prototype.toString.call(a)}function g(b,c){c="function"==typeof c?c():null===c?"":void 0===c?"":c,a[a.length]=encodeURIComponent(b)+"="+encodeURIComponent(c)}function h(c,d){var e,i;if(c)if(f(d))for(e=0,i=d.length;e<i;e++)b.test(c)?g(c,d[e]):h(c+"["+("object"==typeof d[e]?e:"")+"]",d[e]);else if(d&&"[object Object]"===String(d))for(var j in d)d.hasOwnProperty(j)&&h(c+"["+j+"]",d[j]);else g(c,d);else if(f(d))for(e=0,i=d.length;e<i;e++)g(d[e].name,d[e].value);else for(var j in d)d.hasOwnProperty(j)&&h(j,d[j]);return a}function i(a){var b={};return a?(a.split("&").forEach(j.bind(null,b)),b):b}function j(a,b){var e=b.split("="),f=decodeURIComponent(e[0]),g=typeof a,h=f.split("]["),i=h.length-1
;if(c.test(h[0])&&d.test(h[i])){h[i]=h[i].replace(d,"");var j=h.shift();null!==j&&(h=j.split("[").concat(h),i=h.length-1)}else i=0;if(2===e.length){var k=decodeURIComponent(e[1]);if(i)for(var l=0;l<=i;l++)f=""===h[l]?g.length:h[l],g=g[f]=l<i?g[f]||(h[l+1]&&isNaN(h[l+1])?{}:[]):k;else"[object Array]"===Object.prototype.toString.call(a[f])?a[f].push(k):!{}.hasOwnProperty.call(a,f)?a[f]=k:a[f]=[a[f],k]}}return e});
define('assets/services/group-service',['require','jquery','system/http/ajax-client','assets/services/asset-group-dto','assets/services/asset-dto','assets/services/hierarchy-dto','security/services/site-dto','catalog/services/dto/user-pref-dto','system/lang/url-codec'],function(require){"use strict";var a=require("jquery"),b=require("system/http/ajax-client"),c=require("assets/services/asset-group-dto"),d=require("assets/services/asset-dto"),e=require("assets/services/hierarchy-dto"),f="api/common/assetgroup",g="api/core/security",h=require("security/services/site-dto"),i=require("catalog/services/dto/user-pref-dto"),j="api/core/userpref/",k=require("system/lang/url-codec");function l(a){this.ajaxClient=a,this.request=null}l.dependsOn=[b],l.prototype.abort=function a(){this.request&&this.request.abort()},l.prototype.getAllGroups=function(b,c,d,e,g,h){var i=a.Deferred(),j="",k="",l;for(d=d||[],l=0;l<d.length;l++)j+="&keys="+d[l];return h=h?"&searchterm="+h:"",e=e?"&relationshipId="+e:"",g=g?"&byCurrUser="+g:"",k="?page="+b+"&pageSize="+c+j+e+g+h,this.ajaxClient.get(f+k).done(n.bind(null,i)).fail(i.reject.bind(i)),i.promise()},l.prototype.getGroupDetails=function b(c){var d=a.Deferred()
;return this.ajaxClient.get(f+"/"+c.toString()).done(o.bind(null,d)).fail(u.bind(null,d)),d.promise()},l.prototype.assets=function b(c,d,e){var g=a.Deferred();return this.ajaxClient.get(f+"/"+c+"/assets?page="+d+"&pageSize="+e).done(q.bind(null,g)).fail(g.reject.bind(g)),g.promise()},l.prototype.allAssets=function b(c){var d=a.Deferred();return this.ajaxClient.get(f+"/"+c+"/assets").done(q.bind(null,d)).fail(d.reject.bind(d)),d.promise()},l.prototype.assetsByKey=function b(c){var d=a.Deferred();return this.ajaxClient.get(f+"/"+c+"/assetsbykey").done(q.bind(null,d)).fail(d.reject.bind(d)),d.promise()},l.prototype.getGroupDetailsWithPaging=function(b,c,d){var e=a.Deferred(),g=this;return this.request=this.ajaxClient.get(f+"/"+b.toString()+"?page="+c.toString()+"&pageSize="+d.toString()).done(o.bind(null,e)).fail(e.reject.bind(e)).always(p.bind(null,g)),e.promise()},l.prototype.addGroup=function b(c){var d=a.Deferred()
;return this.ajaxClient.post(f,c).done(o.bind(null,d)).fail(d.reject.bind(d)),d.promise()},l.prototype.editGroup=function b(c){var d=a.Deferred();return this.ajaxClient.put(f,c).done(t.bind(null,d)).fail(d.reject.bind(d)),d.promise()},l.prototype.removeGroup=function b(c){var d=a.Deferred();return this.ajaxClient.delete(f+"/"+c.toString()).done(t.bind(null,d)).fail(d.reject.bind(d)),d.promise()},l.prototype.addAssets=function b(c,d,e){var g=a.Deferred();return e=e?"?contextKey="+e.toString():"",this.ajaxClient.post(f+"/"+c.toString()+"/assets"+e,d).done(t.bind(null,g)).fail(g.reject.bind(g)),g.promise()},l.prototype.removeAssets=function b(c,d){var e=a.Deferred(),g=null,h,i=[],j;for(j=d.splice(0,50);j&&j.length>0;)h=j.map(m),g=k.encode({keys:h}),i[i.length]=this.ajaxClient.delete(f+"/"+c.toString()+"/assets?"+g),j=d.splice(0,50);return a.when.apply(a,i).done(t.bind(null,e)).fail(e.reject.bind(e)),e.promise()},l.prototype.addAssociations=function b(c,d){var e=a.Deferred()
;return this.ajaxClient.post(f+"/"+c+"/hierarchy",d).done(t.bind(null,e)).fail(e.reject.bind(e)),e.promise()},l.prototype.removeAssociations=function b(c,d){var e=a.Deferred(),g=null;return g=k.encode({keys:d}),this.ajaxClient.delete(f+"/"+c+"/hierarchy?"+g).done(t.bind(null,e)).fail(e.reject.bind(e)),e.promise()},l.prototype.getAssociations=function b(c){var d=a.Deferred();return this.ajaxClient.get(f+"/"+c.toString()+"/hierarchy").done(s.bind(null,d)).fail(d.reject.bind(d)),d.promise()},l.prototype.getSites=function b(){var c=a.Deferred();return this.ajaxClient.get(g+"/sites",{}).done(r.bind(null,c)).fail(c.reject.bind(c)),c.promise()},l.prototype.getPreference=function b(c,d){var e=a.Deferred(),f=j+"get/"+c+"/1?name="+d;return this.ajaxClient.get(f,{}).done(t.bind(null,e)).fail(e.reject.bind(e)),e.promise()},l.prototype.setPreference=function b(c){var d=a.Deferred(),e=j+"set";return this.ajaxClient.post(e,c).done(t.bind(null,d)).fail(d.reject.bind(d)),d.promise()},
l.prototype.copyGroup=function b(c){var d=a.Deferred();return this.ajaxClient.post(f+"/copy",c).done(o.bind(null,d)).fail(u.bind(null,d)),d.promise()},l.prototype.checkPermission=function(){var b=a.Deferred();return this.ajaxClient.get(f+"/permission").done(b.resolve.bind(b)).fail(b.reject.bind(b)),b.promise()};function m(a){return a.entityKey||a}function n(a,b){a.resolve(c.fromDataCollection(b))}function o(a,b){a.resolve(new c(b))}function p(a){a.request=null}function q(a,b){a.resolve(d.fromDataCollection(b))}function r(a,b){a.resolve(h.fromDataCollection(b))}function s(a,b){a.resolve(e.fromDataCollection(b))}function t(a,b){a.resolve(b)}function u(a,b,c,d){a.reject(b,c,d)}return l});

define('text!assets/views/asset-group-control.html',[],function () { return '<div data-bind="if: settings.loadAssets, style: { height: settings.loadAssets ? \'100%\' : 0 }">\r\n    <mi-tree description="groupid"\r\n             custom-filter="true"\r\n             data-bind="attr: { \'root-name\': translate(\'ASSET_GROUPS\'), multiselect: settings.multiSelect, \'allow-add\': settings.allowAdd, \'has-children\': settings.hasChildren }">\r\n        <mi-tool-bar>\r\n            <!-- ko if: settings.enableAddAllChildren === true -->\r\n            <button class="btn btn-default btn-icon" data-bind="click: addAllChildren, attr: { title: translate(\'ADD_ALL_CHILDREN\'), disabled: disableSelectAllChildren }">\r\n                <i class="icon-plus"></i>\r\n            </button>\r\n            <!-- /ko -->\r\n        </mi-tool-bar>\r\n    </mi-tree>\r\n</div>\r\n\r\n<div data-bind="ifnot: settings.loadAssets, style: { height: !settings.loadAssets ? \'100%\' : 0 }">\r\n<mi-list-group description="groupid"\r\n               custom-filter="true"\r\n               data-bind="attr: { selector: settings.selector, multiselect: settings.multiSelect, \'allow-add\': settings.allowAdd, \'has-children\': settings.hasChildren }">\r\n</mi-list-group>\r\n</div>\r\n';});


define('text!assets/views/hierarchy-finder.html',[],function () { return '<section class="asset-hierarchy-finder">\r\n    <section class="hierarchy-control"></section>\r\n    <section class="well tag-section" data-bind="foreach: results">\r\n        <span class="tag" data-bind="click: $root.removeSelection.bind($root)">\r\n            <span class="block-group">\r\n                <span data-bind="text: description"></span>\r\n                <i class="icon-multiply"></i>\r\n            </span>\r\n        </span>\r\n    </section>\r\n    <div class="controls">\r\n        <button type="button" class="btn  btn-text  btn-secondary" data-bind="click: cancel, text: translate(\'CANCEL\')"></button>\r\n        <button type="button" class="btn btn-text" data-bind="click: done, text: translate(\'OK\'), enable: hasSelection"></button>        \r\n    </div>\r\n</section>\r\n';});

define('assets/models/selected-asset',[],function(){"use strict";function a(a,b,c,d,e){this.entityKey=a,this.description=b,this.family=c,this.familyId=d,this.siteKey=e?e:0}return a});
define('assets/adapters/selected-asset-adapter',['require','assets/models/selected-asset'],function(require){"use strict";var a=require("assets/models/selected-asset");function b(){}return b.fromAssetDTO=function b(c){return new a(c.entityKey,c.equipmentId,"",c.familyId,c.siteKey)},b.fromAssetDTOArray=function a(c){return c.map(b.fromAssetDTO)},b.fromHierarchyDTO=function b(c){return new a(c.entityKey,c.description,c.family,c.familyId,c.siteKey)},b.fromAssetGroupDTO=function b(c){return new a(c.entityKey,c.groupid,"","",c.siteKey)},b.fromHierarchyDTOArray=function a(c){return c.map(b.fromHierarchyDTO)},b});
define('assets/hierarchy-finder',['require','jquery','knockout','system/knockout/knockout-manager','spa/ko/knockout-view-model','assets/asset-hierarchy-control','system/ui/dialog-view-model','text!./views/hierarchy-finder.html','system/globalization/translator','assets/adapters/selected-asset-adapter'],function(require){"use strict";var a=require("jquery"),b=require("knockout"),c=require("system/knockout/knockout-manager"),d=require("spa/ko/knockout-view-model"),e=require("assets/asset-hierarchy-control"),f=require("system/ui/dialog-view-model"),g=require("text!./views/hierarchy-finder.html"),h=require("system/globalization/translator"),i=require("assets/adapters/selected-asset-adapter");function j(){k.call(this,g),this.dialog=null,this.dfd=null,this.translator=Object.resolve(h),this.kom=Object.resolve(c),this.results=null,this.existing=[],this.assetHierarchyControl=null,this.settings={multiSelect:!0,contentArea:".hierarchy-control",selector:"addOnly"}}var k=Object.inherit(d,j);j.prototype.show=function b(c,d){var e={height:"90%",width:"40%"};return d===!1&&(this.settings.multiSelect=d),c=c||[],c.map instanceof Function?this.existing=c.map(i.fromHierarchyDTO):this.existing=[i.fromHierarchyDTO(c)],this.dialog=new f(this,this.translator.translate("HIERARCHY_FINDER"),e),
this.dialog.show(),this.dfd=a.Deferred(),this.dfd.promise()},j.prototype.close=function a(){this.dialog=null},j.prototype.load=function a(){this.results=this.kom.observableArray(this.existing),this.hasSelection=this.kom.computed(l.bind(null,this)),this.assetHierarchyControl=e.create(this.settings),this.assetHierarchyControl.load()},j.prototype.attach=function a(b){k.prototype.attach.apply(this,arguments),this.assetHierarchyControl.attach(b),this.assetHierarchyControl.loadState(),this.assetHierarchyControl.contextBrowser.addEventListener("multiSelected",this),this.assetHierarchyControl.contextBrowser.addEventListener("search-selected",this)},j.prototype.detach=function a(){this.assetHierarchyControl.contextBrowser.removeEventListener("multiSelected",this),this.assetHierarchyControl.contextBrowser.removeEventListener("search-selected",this),this.assetHierarchyControl.detach(),k.prototype.detach.apply(this,arguments)},j.prototype.unload=function a(){this.kom.dispose(),
"resolved"!==this.dfd.state()&&this.dfd.reject(),this.dfd=null,this.assetHierarchyControl.unload(),this.assetHierarchyControl=null,this.existing=null},j.prototype.handleEvent=function(a){"multiSelected"===a.type?o(this,a.detail):"search-selected"===a.type&&o(this,a.searchResult[0])},j.prototype.done=function a(){this.settings.multiSelect?this.dfd.resolve(this.results()):this.dfd.resolve(this.results()[0]),this.dialog.closeDialog()},j.prototype.cancel=function a(){this.dialog.closeDialog()},j.prototype.translate=function a(b){return this.translator.translate(b)},j.prototype.removeSelection=function a(c,d){var e=b.dataFor(d.target);d.target.classList.contains("icon-multiply")&&e.entityKey&&n(this,e.entityKey)};function l(a){return a.results().length>0}function m(a,b){for(var c=0;c<a.length&&a[c].entityKey!==b;)c++;return c===a.length?-1:c}function n(a,b){var c=0;(c=m(a.results(),b))>-1&&a.results.splice(c,1)}function o(a,b){
b&&(a.settings.multiSelect?m(a.results(),b.entityKey)===-1&&a.results.push(i.fromHierarchyDTO(b)):a.results.splice(0,1,i.fromHierarchyDTO(b)))}return j});

define('text!assets/views/group-filter.html',[],function () { return '<section class="group-filter">\r\n    <section class="form-group">\r\n        <label class="control-label" for="relationships" data-bind="text: $root.translate(\'ASSET_HIERARCHY_RELATIONSHIP_FIELD\')"></label>\r\n        <select class="form-control"\r\n                name="relationships"\r\n                data-bind="options: relationships, optionsText: \'caption\', optionsValue: \'id\', value: $root.selectedFamily, optionsCaption: $root.translate(\'ASSET_HIERARCHY_RELATIONSHIP_CAPTION\')"></select>\r\n    </section>\r\n\r\n    <section class="hierarchy">\r\n        <button class="hierarchy-filter btn btn-default" data-bind="click: editHierarchy, text: translate(\'HIERARCHY_FILTER\')"></button>\r\n        <div class="hierarchy-list">\r\n            <ul data-bind="foreach: results, click: removeHierarchyFilter">\r\n                <li class="list-group-item"><i class="icon-multiply"></i><span data-bind="text: description"></span></li>\r\n            </ul>\r\n        </div>\r\n    </section>\r\n\r\n    <section class="my-groups">\r\n        <mi-checkbox data-bind="miCheckboxProperty: {\r\n                            checked: filterByCurrUser,\r\n                            disable: false,\r\n                            value: filterByCurrUser,\r\n                            text: translate(\'MY_GROUPS\')}">\r\n        </mi-checkbox>\r\n    </section>\r\n\r\n    <div class="controls">\r\n        <button type="button" class="btn  btn-text  btn-secondary" data-bind="click: cancel, text: translate(\'CLOSE\')"></button>\r\n        <button type="button" class="btn btn-text" data-bind="click: done, text: translate(\'DONE\')"></button>\r\n    </div>\r\n</section>\r\n';});


define('text!ui/elements/checkbox/checkbox-template.html',[],function () { return '<script id="mi-checkbox-tmpl" type="text/html">\r\n    <div class="checkbox-container">\r\n        <input type="checkbox" data-bind="checked: $root.checked,disable: $root.disable,value:$root.value, attr:{id:$data.id, required: $root.required}, checkedValue: $root.checkedValue " />\r\n        <label data-bind="attr:{for:$data.id}">\r\n            <span class="checkbox-label" ></span>\r\n            <span class="chkbox-text" data-bind="text:$root.text"></span>\r\n        </label>       \r\n    </div>\r\n</script>';});

define('ui/elements/checkbox/checkbox-view-model',['require','lodash','jquery','text!./checkbox-template.html','knockout'],function(require){"use strict";var a=require("lodash"),b=require("jquery"),c=require("text!./checkbox-template.html"),d=require("knockout");d.bindingHandlers.miCheckboxProperty={createNodes:function(a,b){document.getElementById("mi-checkbox-tmpl")||document.body.insertAdjacentHTML("beforeend",c),d.applyBindingsToNode(a,{template:{name:"mi-checkbox-tmpl"}},b)},init:function(a,c){var e=c();return e.id=d.bindingHandlers.miCheckboxProperty.getGuid(),e.textClick=function a(c,d){if(this.disable)return!1;"function"==typeof this.checked?this.checked(!this.checked()):"boolean"==typeof this.checked&&(b(d.target).parent().find("input").prop("checked",!this.checked),this.checked=!this.checked)},d.bindingHandlers.miCheckboxProperty.createNodes(a,e),{controlsDescendantBindings:!0}},getGuid:function a(){return this.s4()+this.s4()+"-"+this.s4()+"-"+this.s4()+"-"+this.s4()+"-"+this.s4()+this.s4()+this.s4()},s4:function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)},
update:function(c,e){var f,g=b(c).find('input[type="checkbox"]');a.each(e(),function(a,e){f=d.unwrap(a),"disable"===e?g.prop("disabled",f):"checked"===e?f!==!0&&f!==!1||g.prop("checked",f):"text"===e&&b(c).find(".chkbox-text").html(f)})}};var e=Object.create(HTMLElement.prototype);document.registerElement("mi-checkbox",{prototype:e})});
define('assets/group-filter-view-model',['require','jquery','knockout','spa/ko/knockout-view-model','system/ui/dialog-view-model','system/globalization/translator','assets/hierarchy-finder','assets/services/hierarchy-service','text!./views/group-filter.html','ui/elements/checkbox/checkbox-view-model'],function(require){"use strict";var a=require("jquery"),b=require("knockout"),c=require("spa/ko/knockout-view-model"),d=require("system/ui/dialog-view-model"),e=require("system/globalization/translator"),f=require("assets/hierarchy-finder"),g=require("assets/services/hierarchy-service"),h=require("text!./views/group-filter.html");require("ui/elements/checkbox/checkbox-view-model");function i(){j.call(this,h),this.dialog=null,this.dfd=null,this.existing=[],this.relationships=[],this.family=null,this.selectedFamily=null,this.service=Object.resolve(g),this.translator=Object.resolve(e),this.results=null,this.finder=null,this.byCurrUser=null,this.filterByCurrUser=!1}var j=Object.inherit(c,i);i.prototype.show=function b(c,e,f){var g={height:"70%",width:"40%"};return c&&c instanceof Array?this.existing=c:this.existing=c?[c]:[],this.family=e,this.byCurrUser=f,this.dialog=new d(this,this.translator.translate("GROUP_FILTER"),g),this.dialog.show(),this.dfd=a.Deferred(),this.dfd.promise()},
i.prototype.close=function a(){this.dialog=null},i.prototype.load=function c(){this.finder=new f,a.isArray(this.existing)?this.results=b.observableArray(this.existing):this.results=b.observableArray([this.existing]),this.selectedFamily=b.observable(this.family),this.relationships=b.observableArray([]),this.filterByCurrUser=b.observable(this.byCurrUser),this.service.relationshipsById().done(k.bind(null,this))},i.prototype.attach=function a(){j.prototype.attach.apply(this,arguments)},i.prototype.detach=function a(){j.prototype.detach.apply(this,arguments)},i.prototype.unload=function a(){this.dialog=null,this.dfd=null,this.existing=[],this.existing=null,this.results([]),this.results=null,this.finder.close(),this.finder=null,this.selectedFamily(null),this.family=null,this.filterByCurrUser(null)},i.prototype.done=function a(){var b={family:this.selectedFamily(),results:this.results(),byCurrUser:this.filterByCurrUser()};this.dfd.resolve(b),this.dialog.closeDialog()},
i.prototype.cancel=function a(){this.dialog.closeDialog()},i.prototype.translate=function a(b){return this.translator.translate(b)},i.prototype.editHierarchy=function a(){this.finder.show(this.results()).done(l.bind(null,this))},i.prototype.removeHierarchyFilter=function c(d,e){var f=b.dataFor(e.target),g=0;if(a(e.target).hasClass("icon-multiply"))for(g=0;g<this.results().length;g++)this.results()[g].entityKey===f.entityKey&&this.results.splice(g,1)};function k(a,b){a.relationships(b),a.selectedFamily(a.family),a.filterByCurrUser(a.byCurrUser)}function l(a,b){a.results(b)}return i});
define('assets/asset-group-control',['require','jquery','bluebird','system/http/es6-ajax-request','spa/ko/knockout-view-model','spa/region','assets/services/group-service','assets/services/hierarchy-service','assets/services/asset-group-dto','assets/services/asset-context-dto','text!./views/asset-group-control.html','system/globalization/translator','assets/group-filter-view-model','system/error/error-message','application/application-events','application/application-context','catalog/services/dto/user-pref-dto','system/knockout/knockout-manager','catalog/services/catalog-constants','ui/elements/list-group/view-model','ui/elements/tree/view-model','ui/elements/tool-bar/view-model'],function(require){"use strict";var a=require("jquery"),b=require("bluebird"),c=require("system/http/es6-ajax-request"),d=require("spa/ko/knockout-view-model"),e=require("spa/region"),f=require("assets/services/group-service"),g=require("assets/services/hierarchy-service"),h=require("assets/services/asset-group-dto"),i=require("assets/services/asset-context-dto"),j=require("text!./views/asset-group-control.html"),k=require("system/globalization/translator"),l=require("assets/group-filter-view-model"),m=require("system/error/error-message"),n=require("application/application-events"),o=require("application/application-context"),p=require("catalog/services/dto/user-pref-dto"),q=require("system/knockout/knockout-manager"),r=require("catalog/services/catalog-constants");require("ui/elements/list-group/view-model"),require("ui/elements/tree/view-model"),require("ui/elements/tool-bar/view-model");var s={multiSelect:!1,selector:"none",contentArea:"",allowAdd:!1,loadAssets:!0,
hasChildren:!1};function t(a,b,c,d){u.call(this,j),this.user=o.user,this.constants=new r,this.groupService=a,this.hierarchyService=Object.resolve(g),this.translator=b,this.settings=null,this.selectedHierarchy=null,this.selectedFamily=null,this.filter=null,this.groupElement=null,this.appEvents=c,this.delayed=!1,this.filterByCurrUser=!1,this.kom=d,this.selectChildren=null,this.disableSelectAllChildren=null}var u=Object.inherit(d,t,q);t.dependsOn=[f,k,n,q],t.create=function b(c){var d=Object.resolve(t);return d.settings=a.extend(null,s,c),d.filter=new l,d},t.prototype.addAllChildren=function(){var a=new CustomEvent("selectallchildren",{bubbles:!0,cancelable:!0});this.groupElement.dispatchEvent(a)},t.prototype.attach=function a(b){var c;this.disableSelectAllChildren=this.kom.observable(!0),this.settings.contentArea?(c=new e,c.setElement(b.$element.find(this.settings.contentArea))):c=b,u.prototype.attach.call(this,c),this.groupElement=c.$element.find("mi-tree, mi-list-group")[0],
Element.upgrade(this.groupElement),v(this).then(E.bind(null,this)).then(w.bind(null,this))};function v(a){return b.resolve(a.groupService.getPreference(a.user.key,"groups-by-user"))}function w(a){null!==a.groupElement&&(a.groupElement.loader=a.loadGroup.bind(a),a.groupElement.addEventListener("search-selected",a),a.groupElement.addEventListener("filter-closed",a),a.groupElement.addEventListener("navigating",a),a.groupElement.addEventListener("navigated",a),a.settings.loadAssets?a.groupElement.searchCallback=a.searchGroupTree.bind(a):a.groupElement.searchCallback=a.searchGroupList.bind(a),a.groupElement.filterViewModel=a.editFilter.bind(a),a.groupElement.setAttribute("allow-add",a.settings.allowAdd))}t.prototype.handleEvent=function(a){"navigating"===a.type?(3===a.newValue.length&&a.preventDefault(),
this.disableSelectAllChildren(x(a))):"navigated"===a.type&&2===a.target.pathHistory.listGroup.length?a.target.pathHistory.listGroup[1].setAttribute("has-children","false"):"search-selected"===a.type?this.loadcontext(a.searchResult[0]):"filter-closed"===a.type&&(this.applyingFilter=!0)};function x(a){return 1===a.newValue.length}t.prototype.detach=function a(b){var c;this.groupElement.removeEventListener("search-selected",this),this.groupElement.removeEventListener("filter-closed",this),this.groupElement.removeEventListener("navigating",this),this.groupElement.removeEventListener("navigated",this),this.groupElement=null,this.settings.contentArea?(c=new e,c.setElement(b.$element.find(this.settings.contentArea))):c=b,this.filter&&this.filter.close(),c.screen&&u.prototype.detach.call(this,c)},t.prototype.unload=function a(){this.filter&&(this.filter.close(),this.filter=null)},t.prototype.translate=function a(b){return this.translator.translate(b)},t.prototype.editFilter=function a(){
this.filter.show(this.selectedHierarchy,this.selectedFamily,this.filterByCurrUser).done(y.bind(null,this)).fail(B.bind(null,this))},t.prototype.searchGroupTree=function(a,b,c,d){return this.groupService.getAllGroups(c,d,z(this),this.selectedFamily,this.filterByCurrUser,a).fail(B.bind(null,this)).promise()},t.prototype.searchGroupList=function(a,b,c){return this.groupService.getAllGroups(b,c,z(this),this.selectedFamily,this.filterByCurrUser,a).fail(B.bind(null,this)).promise()},t.prototype.loadGroup=function b(c,d,e){var f=a.Deferred();return void 0===e?this.groupService.getAllGroups(c,d,z(this),this.selectedFamily,this.filterByCurrUser).done(f.resolve.bind(f)).fail(B.bind(null,this)):0===c?this.groupService.getAllGroups(d,e,z(this),this.selectedFamily,this.filterByCurrUser).done(f.resolve.bind(f)).fail(B.bind(null,this)):this.groupService.assets(this.groupElement.value[c].entityKey,d,e).done(f.resolve.bind(f)).fail(B.bind(null,this)),f.promise()},t.prototype.loadcontext=function(a){
a&&(this.settings.loadAssets?C(this,a):D(this,a))},t.prototype.getContextValue=function(){return this.loadAssets?i.fromGroupDTO(this.groupElement.value[this.groupElement.value.length-1]):i.fromGroupDTO(this.groupElement.value||this.groupElement.items[0])},t.prototype.setValue=function(a,b){var c=b.originalEvent.searchResult[0];c&&(this.groupElement.value=c,this.groupElement.reload())},t.prototype.loadState=function(a){a=a||{},this.selectedHierarchy=a.hierarchy,this.selectedFamily=a.family,this.filterByCurrUser=a.byCurrUser,this.groupElement.loadState(a.groupElement)},t.prototype.saveState=function(){return{hierarchy:this.selectedHierarchy,family:this.selectedFamily,byCurrUser:this.filterByCurrUser,groupElement:this.groupElement.saveState()}};function y(a,b){a.selectedFamily=b.family,a.selectedHierarchy=b.results,a.filterByCurrUser!==b.byCurrUser&&(a.filterByCurrUser=b.byCurrUser,F(a)),a.groupElement.reload()}function z(a){
return a.selectedHierarchy?a.selectedHierarchy instanceof Array?0===a.selectedHierarchy.length?null:a.selectedHierarchy.map(A):[a.selectedHierarchy.entityKey]:null}function A(a){return a.entityKey}function B(a,b,c,d){if("abort"!==d){var e=new m("AG1",d,(new Error).stack);a.appEvents.errorOccured.raise(a,e)}}function C(a,b){"-1"===b.entityKey?a.groupElement.value&&a.groupElement.value.length>0&&(a.groupElement.value=a.groupElement.value[0]):a.groupElement.value[1]=h.fromAssetContextDTO(b)}function D(a,b){var c=h.fromAssetContextDTO(b);a.groupElement.value=c,a.groupElement.reload();var d=a.groupElement.querySelector("mi-list-group");d&&(Element.upgrade(d),d.value=c,d.reload())}function E(a,b){b&&b.value&&(a.filterByCurrUser="True"===b.value)}function F(a){var b=new p;b.userKey=a.user.key,b.prefType=a.constants.CATALOG_PREFERENCE,b.name="groups-by-user",b.value=a.filterByCurrUser,a.groupService.setPreference(b)}return t});
define('system/ui/dialog-box',['require','lodash','jquery','system/ui/dialog-view-model','system/lang/object'],function(require){"use strict";var a=require("lodash"),b=require("jquery"),c=require("system/ui/dialog-view-model");require("system/lang/object");function d(a,b,c){e.call(this,a,b,c),this.handlingButtonClick=!1,this.dfd=null,this.showHelp(!1),this.showClose(!1),this.showCheck(!1)}var e=Object.inherit(c,d);d.prototype.show=function(){return e.prototype.show.call(this),f(this),this.dialogContentRegion.$element.css("overflow-y","auto").addClass("dialog-box"),this.dfd=b.Deferred(),this.dfd.promise()},d.prototype.setContent=function(a){e.prototype.setContent.call(this,a)};function f(c){if(c.options&&c.options.buttons){var d=c.options.buttons||[],e=c.dialogShellRegion.$element.find(".dialog-wrapper");if(d.length>0){var f=b('<div class="button-bar clearfix text-right"></div>').appendTo(e);a.each(d,function(a,d){var e=a.cssClass?a.cssClass:"btn-default";b('<button class="btn pull-right '+e+'"><span>'+a.name+"</span></button>").on("click",g.bind(null,c,d,a.value||a.name)).appendTo(f)}),
b('<div class="clearfix"></div>').appendTo(f),c.centerDialog()}}}function g(a,c,d){if(!a.handlingButtonClick){a.handlingButtonClick=!0;var e=Object.tryMethod(a.content,d);if(e===!1)return void(a.handlingButtonClick=!1);b.when(e).done(function(b){a.dfd.resolve(c,d,b),a.closeDialog(),a.handlingButtonClick=!1}).fail(function(b){a.options.closeOnReject&&(a.dfd.reject(c,d,b),a.closeDialog()),a.handlingButtonClick=!1})}}d.prototype.closeDialog=function(){h(this),e.prototype.closeDialog.apply(this,arguments)};function h(c){var d=c.dialogShellRegion.$element.find(".dialog-wrapper"),e=b(".button-bar",d),f=e.find("button");a.each(f,i),e.remove(),c.centerDialog()}function i(a){b(a).off().remove()}return d});
define('assets/models/selected-asset-results',['require','knockout'],function(require){"use strict";var a=require("knockout");function b(){this.existing=null,this.selected=null,this.arrayChangeSubscription=null,this.added=[],this.removed=[]}b.prototype.init=function b(d){var e,f=[];if(this.existing=d,d)for(e=0;e<d.length;e++)f[f.length]=d[e];this.selected=a.observableArray(f),this.arrayChangeSubscription=this.selected.subscribe(c.bind(null,this),null,"arrayChange")},b.prototype.dispose=function a(){this.selected([]),this.selected=null,this.arrayChangeSubscription.dispose(),this.arrayChangeSubscription=null};function c(a,b){var c;for(c=0;c<b.length;c++)"added"===b[c].status?f(a,b[c].value):e(a,b[c].value.entityKey)}function d(a,b){for(var c=0,d=!1;c<a.length&&!d;)d=a[c].entityKey===b,c++;return d?a[c-1]:void 0}function e(a,b){var c=0,e=!1,f;if(f=d(a.existing,b))a.removed.push(f);else for(c=0,e=!1;c<a.added.length&&!e;)e=a.added[c].entityKey===b,e&&a.added.splice(c,1),c++}function f(a,b){var c=0,e=!1;if(d(a.existing,b.entityKey))for(c=0,
e=!1;c<a.removed.length&&!e;)e=a.removed[c].entityKey===b.entityKey,e&&a.removed.splice(c,1),c++;else d(a.added,b.entityKey)||a.added.push(b)}return b});

define('text!ui/elements/asset-context/template.html',[],function () { return '<div class="asset-context-selection static">\r\n  <div class="navigation">\r\n    <ul class="nav nav-pills assetMenu pull-left" data-bind="click: menuClick">\r\n      <li data-bind="css: {active: activePill() === hierarchy.url }">\r\n        <a data-bind="attr: { \'data-menu-item\': hierarchy.url, href: hierarchy.href, title: translator.translate(\'ASSET_HIERARCHY\') }, text: translator.translate(\'ASSET_HIERARCHY\')">\r\n        </a>\r\n      </li>\r\n      <li data-bind="css: {active: activePill() === group.url }">\r\n        <a data-bind="attr: { href: group.href, \'data-menu-item\': group.url, title: translator.translate(\'ASSET_GROUP\') }, text: translator.translate(\'ASSET_GROUP\')">\r\n        </a>\r\n      </li>\r\n    </ul>          \r\n  </div>\r\n  <section class="block-group context-select">\r\n    <section class="asset-content">\r\n      <section class="asset-hierarchy-control" data-bind="visible: $root.activePill() === \'hierarchy\'"></section>\r\n      <section class="asset-group-explorer" data-bind="visible: $root.activePill() === \'group\'"></section>\r\n    </section>\r\n  </section>\r\n</div>\r\n';});

define('assets/services/asset-context-service',['require','lodash','jquery','system/http/ajax-client','assets/services/asset-context-dto','application/application-context'],function(require){"use strict";var a=require("lodash"),b=require("jquery"),c=require("system/http/ajax-client"),d=require("assets/services/asset-context-dto"),e=require("application/application-context"),f="api/common/assetcontext/";function g(a){this.ajaxClient=a,this.request=null}g.dependsOn=[c],g.prototype.getcontext=function c(d){var e=b.Deferred();return this.request&&this.abort(),d&&"-1"!==d&&"0"!==d?this.request=this.ajaxClient.get(f+d).done(k.bind(null,this,e)).fail(l.bind(null,this,e)):(this.request="home",a.defer(j,this,e,"-1")),e.promise()},g.prototype.abort=function(){this.request&&this.request.abort?this.request.abort():"home"===this.request&&(this.request="home-abort")},g.prototype.getAssetContextPreference=function(){var a=f+"preference/"+i(),c=b.Deferred();return this.ajaxClient.get(a).done(k.bind(null,this,c)).fail(l.bind(null,this,c)),c.promise()},g.prototype.getAssetContextAppHub=function(){var a=f+"apphub/"+i(),c=b.Deferred()
;return this.ajaxClient.get(a).done(h.bind(null,c)).fail(l.bind(null,this,c)),c.promise()};function h(a,b){return a.resolve(b)}g.prototype.setAssetContextAppHub=function(a){var c=f+"apphub/"+a,d=b.Deferred();return this.ajaxClient.put(c).done(k.bind(null,this,d)).fail(l.bind(null,this,d)),d.promise()};function i(){return e.user.key}function j(a,b,c){"home-abort"!==a.request&&b.resolve(d.default(c)),a.request=null}function k(a,b,c){a.request=null,b.resolve(new d(c))}function l(a,b,c,e){a.request=null,404===c.status?b.resolve(d.default()):"abort"!==e&&b.reject()}return g});
define('ui/elements/asset-context/view-model',['require','lodash','jquery','assets/asset-hierarchy-control','assets/asset-group-control','system/ui/dialog-box','system/globalization/translator','assets/models/selected-asset-results','knockout','text!./template.html','spa/region','application/application-context','assets/services/asset-context-dto','assets/services/hierarchy-dto','assets/services/asset-group-dto','assets/services/asset-context-service','ramda'],function(require){"use strict";var a=require("lodash"),b=require("jquery"),c=require("assets/asset-hierarchy-control"),d=require("assets/asset-group-control"),e=require("system/ui/dialog-box"),f=require("system/globalization/translator"),g=require("assets/models/selected-asset-results"),h=require("knockout"),i=require("text!./template.html"),j=require("spa/region"),k=require("application/application-context"),l=require("assets/services/asset-context-dto"),m=require("assets/services/hierarchy-dto"),n=require("assets/services/asset-group-dto"),o=require("assets/services/asset-context-service"),p=require("ramda"),q=["selector","multiselect","allowAdd"],r={};r.prototype=Object.create(HTMLElement.prototype),r.prototype.createdCallback=function(){this.element=this,this.translator=Object.resolve(f),this.results=null,this.dialog=null,this.existing=[],this.activePill=null,this.internalvalue=null,this.showAsDialog=null,this.assetContextService=Object.resolve(o),this.group={
href:"#assets/group",title:this.translator.translate("ASSET_GROUP"),url:"group",screen:null},this.hierarchy={href:"#assets/hierarchy",title:this.translator.translate("ASSET_HIERARCHY"),url:"hierarchy",screen:null},Object.defineProperty(this,"value",{get:K.bind(null,this),set:this.setContext.bind(this)}),this.delayload=Element.booleanAttribute(this,"delayload")},r.prototype.setContext=function(c){var d=new b.Deferred,e;return c&&(e=c.entityKey||c)?this.internalvalue&&"-1"!==this.internalvalue.entityKey&&L(this.internalvalue.entityKey,e)?(a.defer(d.resolve,this.internalvalue),d.promise()):(s(this,c),z(this,c,d),d.promise()):(a.defer(d.resolve,this.internalvalue),d.promise())};function s(a,b){"string"==typeof b&&B(a,b)}r.prototype.attachedCallback=function(){Element.clearDom(this),"true"===this.getAttribute("data-open")?(this.load(),this.attach(new j(b(this)))):T(this)},r.prototype.disableStuff=function(a,b){if(a!==!1||b!==!1){var c=this.region.element.querySelector(".assetMenu")
;a===!0?(P(this),M(this),this.region.element.querySelector(".asset-hierarchy-control").style.display="none",c.removeChild(c.firtElementChild),this.activePill("hierarchy")):b===!0&&(R(this),N(this),this.region.element.querySelector(".asset-group-explorer").removeAttribute("data-bind"),c.removeChild(c.lastElementChild),this.activePill("group")),c.classList.add("not-active")}},r.prototype.detachedCallback=function(){this.region&&(this.detach(),this.unload())},r.prototype.attributeChangedCallback=function(a,b,c){this.delayload===!1&&("entitykey"===a?z(this,c):"loadassets"===a?(this.group.screen.settings.loadAssets="true"===c,this.group.screen.settings.hasChildren="true"===c,this.group.screen.detach(this.region),this.group.screen.attach(this.region)):"selectchildren"===a?this.hierarchy.screen.selectChildren(c):"multiselect"===a&&(this.hierarchy.screen.settings.multiSelect="true"===c),H(this,a,c))},r.prototype.menuClick=function a(b,c){var d,e,f;c.preventDefault(),
c.stopImmediatePropagation(),f=c.target.getAttribute("data-menu-item"),e="hierarchy"===f?this.hierarchy:this.group,d=new CustomEvent("menu-changing",{bubbles:!0,cancelable:!0,detail:{menu:e}}),this.dispatchEvent(d),d.returnValue===!1||d.defaultPrevented||("hierarchy"===f?this.showHierarchy():this.showGroup())},r.prototype.load=function(){var a,b,e,f;for(this.results=new g,this.results.init(),this.results.existing=this.existing,this.activePill=h.observable("hierarchy"),f=this.getAttribute("data-open"),this.showAsDialog=h.observable(!f),a=0;a<this.existing.length;a++)this.results.selected.push(this.existing[a]);b={multiSelect:!1,selectedItems:this.results.selected,selectable:!1,contentArea:".asset-hierarchy-control",enableAddAllChildren:null!==this.getAttribute("enableAddAllChildren"),selectChildren:null!==this.getAttribute("selectChildren")},e={multiSelect:!1,selectedItems:this.results.selected,selectable:!1,contentArea:".asset-group-explorer",
loadAssets:null!==this.getAttribute("loadassets"),enableAddAllChildren:null!==this.getAttribute("enableAddAllChildren"),allowAdd:null!==this.getAttribute("allow-add")},this.hierarchy.screen=c.create(b),this.hierarchy.screen.load(),this.group.screen=d.create(e)},r.prototype.attach=function(a){this.region=a,this.region.attach(b(i)),this.region.$element.find(".region").attr("data-bind","halt-bindings"),this.region.element.addEventListener("change",this),this.delayload===!1&&(h.applyBindingsToDescendants(this,this.region.element.querySelector(".region")),O(this),Q(this),I(this),Element.raiseEvent(this.group.screen.groupElement.querySelector("mi-tool-bar"),"resize",{}))},r.prototype.detach=function(){P(this),R(this),h.cleanNode(this.region.element),this.region.clear(),this.region=null},r.prototype.handleEvent=function(a){
"navigated"===a.type?this.group.screen&&a.target===this.group.screen.groupElement?w(this):u(this):"selected"===a.type&&"group"!==this.activePill()&&this.group.screen&&a.target!==this.group.screen.groupElement?u(this):"selected"===a.type&&"group"===this.activePill()?v(this):"loaded"===a.type?J(this,a):"click"===a.type?x(this):"change"===a.type&&a.target!==this&&a.stopImmediatePropagation()},r.prototype.unload=function a(){M(this),N(this)},r.prototype.translateText=function a(b){return this.translator.translate(b)},r.prototype.done=function a(){this.dialog||y(this)},r.prototype.showHierarchy=function a(){this.activePill(this.hierarchy.url),Element.raiseEvent(this,"menu-change",{menu:this.hierarchy})},r.prototype.showGroup=function a(){this.activePill(this.group.url),Element.raiseEvent(this,"menu-change",{menu:this.group}),Element.raiseEvent(this.group.screen.groupElement.querySelector("mi-tool-bar"),"resize",{})},r.prototype.setSiteFilter=function(a){
this.hierarchy.screen.setSiteFilter(a)},r.prototype.loadState=function(a){var c,d;return a=a||{},a.hierarchy=a.hierarchy||{},a.group=a.group||{},a.hierarchy.value=null,a.group.value=null,this.hierarchy.screen.loadState(a.hierarchy),this.group.screen.loadState(a.group),c=a.value,c?d=this.setContext(c):(d=b.Deferred(),d.resolve(),a.menu===this.group.url?(this.activePill(this.group.url),this.group.screen.groupElement.addEventListener("loaded",this),this.group.screen.groupElement.reload()):(this.activePill(this.hierarchy.url),this.value=t(this)?k.assetcontext:l.default())),d.promise()},r.prototype.saveState=function(){return{hierarchy:this.hierarchy.screen.saveState(),group:this.group.screen.saveState(),value:this.internalvalue,menu:this.activePill()}},r.prototype.href=function(){return this.activePill()===this.hierarchy.url?this.hierarchy.href+"/"+this.value.entityKey:this.group.href+"/"+this.value.entityKey};function t(a){if(p.isNil(a.parentElement))return!1
;if(p.isNil(a.parentElement.parentElement))return!1;if(p.isNil(a.parentElement.parentElement.parentElement))return!1;var b=a.parentElement.parentElement.parentElement;return b.classList.contains("assets-shell-screen")&&!b.classList.contains("asset-finder-screen")}function u(a){var c=a.hierarchy.screen.contextBrowser.selectedAsset;A(a,l.fromHierarchyDTO(c)),b(a.element).find("span.context-id").text(a.internalvalue.description)}function v(a){a.group.screen.groupElement.value&&(A(a,l.fromGroupDTO(a.group.screen.groupElement.value)),b(a.element).find("span.context-id").text(a.internalvalue.description))}function w(a){var c=a.group.screen.groupElement.value.length-1,d=a.group.screen.groupElement.value[c];A(a,l.fromGroupDTO(d)),b(a.element).find("span.context-id").text(a.internalvalue.description)}function x(a){var c={height:"90%",width:"auto",buttons:[{name:a.translator.translate("DONE"),value:"done",cssClass:"btn-primary"}]},d=a.translator.translate("ASSET_HIERARCHY")
;null!==a.getAttribute("dialog")?(a.dialog=new e(a,d,c),a.dialog.show(),a.loadState()):(a.region||a.attach(new j(b(a.querySelector(".asset-context-selection")))),b(a.element).find("div.asset-context-selection").show())}function y(a){b(a.element).find("div.asset-context-selection").removeAttr("style")}function z(a,b,c){var d;b instanceof l?setTimeout(F.bind(null,a,c,b),0):b instanceof m?(d=l.formHierarchyDTO(b),setTimeout(F.bind(null,a,c,d),0)):b instanceof n?(d=l.fromGroupDTO(b),setTimeout(F.bind(null,a,c,d),0)):b.entityKey?a.assetContextService.getcontext(b.entityKey).done(F.bind(null,a,c)).fail(c.reject.bind(c)):a.assetContextService.getcontext(b).done(F.bind(null,a,c)).fail(c.reject.bind(c))}function A(a,b){(!a.internalvalue&&a.internalvalue!==b||a.internalvalue.entityKey!==b.entityKey)&&(a.internalvalue=b,G(a))}function B(a,b){(!a.internalvalue&&a.internalvalue!==b||a.internalvalue.entityKey!==b.entityKey)&&(a.internalvalue=b)}function C(a){var b=a.value||[{}]
;return 0===b.length?"":b[b.length-1].entityKey||""}function D(a){var b=a.selectedAsset;return b?b.entityKey:""}function E(a,b){var c,d,e,f;(a.region||a.dialog)&&(c="Hierarchy"===b.type,f=a.hierarchy.screen.contextBrowser,c?(a.activePill(a.hierarchy.url),D(f)!==b.entityKey&&a.hierarchy.screen.loadcontext(b.entityKey)):(a.activePill(a.group.url),e=a.group.screen.groupElement,e.value&&e.value.entityKey===b.entityKey||a.group.screen.loadcontext(b)))}function F(a,c,d){null===d&&(d=k.assetcontext||l.default()),E(a,d),A(a,d),a.internalvalue&&b(a.element).find("span.context-id").text(a.internalvalue.description),c&&c.resolve(d)}function G(a){Element.raiseEvent(a,"change",a.internalvalue)}function H(a,b,c){var d,e,f,g,h;if(q.indexOf(b)>-1){for(h=a.querySelector("asset-hierarchy-control"),"selector"===b&&h&&(h.enableMultiSelect="addOnly"===c),d=a.getElementsByTagName("mi-list-group"),e=0;e<d.length;e++)null!==c?d[e].setAttribute(b,c):d[e].removeAttribute(b)
;for(f=a.querySelectorAll("mi-tool-bar mi-searchbox"),e=0;e<f.length;e++)null!==c?f[e].setAttribute(b,c):f[e].removeAttribute(b);for(g=a.getElementsByTagName("mi-tree"),e=0;e<g.length;e++)"groupid"===g[e].getAttribute("description")&&"selector"===b&&(c="none"),null!==c?g[e].setAttribute(b,c):g[e].removeAttribute(b)}}function I(a){var b;for(b=0;b<q.length;b++)H(a,q[b],a.getAttribute(q[b]))}function J(a,b){if(null!==b.detail.frag.querySelector("mi-li")){var c=b.detail.frag.querySelector("mi-li").value;a.value=c,a.group.screen&&a.group.screen.groupElement.removeEventListener("loaded",a)}}function K(a){return a.internalvalue}function L(a,b){return a="0"===a?"-1":a,b="0"===b?"-1":b,a===b}function M(a){a.hierarchy.screen&&(a.hierarchy.screen.unload(),a.hierarchy.screen=null)}function N(a){a.group.screen&&(a.group.screen.unload(),a.group.screen=null)}function O(a){a.hierarchy.screen.attach(a.region,!0),a.hierarchy.screen.contextBrowser.addEventListener("selected",a)}function P(a){
a.hierarchy.screen&&(a.hierarchy.screen.contextBrowser.removeEventListener("selected",a),a.hierarchy.screen.detach(a.region))}function Q(a){var b;a.group.screen.attach(a.region),b=null!==a.getAttribute("loadassets"),b?a.group.screen.groupElement.addEventListener("navigated",a):a.group.screen.groupElement.addEventListener("selected",a)}function R(a){a.group.screen&&(a.group.screen.groupElement.removeEventListener("navigated",a),a.group.screen.groupElement.removeEventListener("selected",a),a.group.screen.detach(a.region))}function S(a){var c=k.assetcontext||l.default();F(a,b.Deferred(),c)}function T(a){var b,c,d,e,f;f=document.createElement("div"),f.className="region",b=document.createElement("div"),f.appendChild(b),c=document.createElement("button"),c.className="btn btn-default",b.appendChild(c),e=document.createElement("span"),e.className="context-id",c.appendChild(e),c.addEventListener("click",a),d=document.createElement("i"),d.className="ds ds-assethierachy ds-dashboard-style",
c.appendChild(d),a.appendChild(f),b=document.createElement("div"),b.className="asset-context-selection",a.appendChild(b),S(a)}return document.registerElement("mi-asset-context",{prototype:r.prototype}),r});
!function(a){"use strict";if("function"==typeof define&&define.amd)define('ui/elements/date-time/bootstrap-datetimepicker',["jquery","moment","lodash","system/text/formatter","system/lang/converter","system/globalization/translator","system/hardware/device","system/text/parser"],a);else{if(!jQuery)throw"bootstrap-datetimepicker requires jQuery to be loaded first";if(!moment)throw"bootstrap-datetimepicker requires moment.js to be loaded first";a(jQuery,moment,_)}}(function(a,b,c,d,e,f,g,h){"use strict";if(void 0===b)throw alert("momentjs is required"),new Error("momentjs is required");var i=0,j=b,k=Object.resolve(d),l=Object.resolve(f),m=function(b,d){var e=a.fn.datetimepicker.defaults,f={time:"icon-time-units",date:"icon-calendar",up:"icon-up-arrow",down:"icon-arrow"},m=new g,n=this,o=!1,p=function(){var b=!1,c;if(t(),c=k.cultureInfo().calendar.patterns,r(c),n.use24hours=n.format.toLowerCase().indexOf("t")<1,null===k.cultureInfo().calendar.AM&&null===k.cultureInfo().calendar.AM&&(n.use24hours=!0),
n.component&&(b=n.component.find("span")),n.options.pickTime&&b&&b.addClass(n.options.icons.time),n.options.pickDate&&b&&(b.removeClass(n.options.icons.time),b.addClass(n.options.icons.date)),n.options.widgetParent="string"==typeof n.options.widgetParent&&n.options.widgetParent||n.element.parents().filter(function(){return"scroll"===a(this).css("overflow-y")}).get(0)||"body",n.widget=a(da()).appendTo(n.options.widgetParent),n.options.useSeconds&&!n.use24hours&&n.widget.width(300),s(),n.options.disabledDates=ba(n.options.disabledDates),n.options.enabledDates=ba(n.options.enabledDates),q(),""!==n.options.defaultDate&&""===u().val()&&n.setValue(n.options.defaultDate),1!==n.options.minuteStepping){var d=n.options.minuteStepping;n.date.minutes(Math.round(n.date.minutes()/d)*d%60).seconds(0)}},q=function(){n.startViewMode=n.viewMode,n.setMinDate(n.options.minDate),n.setMaxDate(n.options.maxDate),E(),F(),H(),I(),J(),D(),T(),U()},r=function(a){n.format||(n.format=n.options.pickDate?a.d:"",
n.options.pickDate&&n.options.pickTime&&(n.format+=" "),n.format+=n.options.pickTime?a.t:"",n.options.useSeconds&&(~a.t.indexOf(" tt")?n.format=n.format.split(" tt")[0]+":ss tt":~a.t.indexOf(" t")?n.format=n.format.split(" t")[0]+":ss t":n.format+=":ss"))},s=function(){if(n.minViewMode=n.options.minViewMode||0,"string"==typeof n.minViewMode)switch(n.minViewMode){case"months":n.minViewMode=1;break;case"years":n.minViewMode=2;break;default:n.minViewMode=0}if(n.viewMode=n.options.viewMode||0,"string"==typeof n.viewMode)switch(n.viewMode){case"months":n.viewMode=1;break;case"years":n.viewMode=2;break;default:n.viewMode=0}},t=function(){if(n.options=a.extend({},e,d),n.options.icons=a.extend({},f,n.options.icons),n.element=a(b),n.elementZIndexOrig=n.element.css("z-index"),n.elementPosOrig=n.element.css("position"),n.blockout=a('<div class="datepicker-screen-freeze"></div>'),v(),!n.options.pickTime&&!n.options.pickDate)throw new Error("Must choose at least one picker");n.id=i++,
j.locale(n.options.language),n.date=j(),n.unset=!1,n.isInput=n.element.is("input"),n.component=!1,n.element.hasClass("input-group")&&(0===n.element.find(".datepickerbutton").size()?n.component=n.element.find("[class^='input-group-']"):n.component=n.element.find(".datepickerbutton")),n.format=n.options.format,n.placePosition=""},u=function(){var a;if(n.isInput)return n.element;if(a=n.element.find(".datepickerinput"),0===a.size())a=n.element.find("input");else if(!a.is("input"))throw new Error('CSS class "datepickerinput" cannot be applied to non input element');return a},v=function(){var a;a=n.element.is("input")?n.element.data():n.element.find("input").data(),void 0!==a.dateFormat&&(n.options.format=a.dateFormat),void 0!==a.datePickdate&&(n.options.pickDate=a.datePickdate),void 0!==a.datePicktime&&(n.options.pickTime=a.datePicktime),void 0!==a.dateUseminutes&&(n.options.useMinutes=a.dateUseminutes),void 0!==a.dateUseseconds&&(n.options.useSeconds=a.dateUseseconds),
void 0!==a.dateUsecurrent&&(n.options.useCurrent=a.dateUsecurrent),void 0!==a.dateMinutestepping&&(n.options.minuteStepping=a.dateMinutestepping),void 0!==a.dateMindate&&(n.options.minDate=a.dateMindate),void 0!==a.dateMaxdate&&(n.options.maxDate=a.dateMaxdate),void 0!==a.dateShowtoday&&(n.options.showToday=a.dateShowtoday),void 0!==a.dateCollapse&&(n.options.collapse=a.dateCollapse),void 0!==a.dateLanguage&&(n.options.language=a.dateLanguage),void 0!==a.dateDefaultdate&&(n.options.defaultDate=a.dateDefaultdate),void 0!==a.dateDisableddates&&(n.options.disabledDates=a.dateDisableddates),void 0!==a.dateEnableddates&&(n.options.enabledDates=a.dateEnableddates),void 0!==a.dateIcons&&(n.options.icons=a.dateIcons),void 0!==a.dateUsestrict&&(n.options.useStrict=a.dateUsestrict),void 0!==a.dateDirection&&(n.options.direction=a.dateDirection),void 0!==a.dateSidebyside&&(n.options.sideBySide=a.dateSidebyside)},w=function(){
var b="absolute",c=n.component?n.component.offset():n.element.offset(),d=a(window);n.width=n.component?n.component.outerWidth():n.element.outerWidth(),c.top=c.top+n.element.outerHeight(),n.placePosition,y(c,d),z(c),void 0!==n.options.width&&n.widget.width(n.options.width),"left"===n.options.orientation&&(n.widget.addClass("left-oriented"),c.left=c.left-n.widget.width()+20),Y()&&(b="fixed",c.top-=d.scrollTop(),c.left-=d.scrollLeft()),d.width()<c.left+n.widget.outerWidth()?(c.right=d.width()-c.left-n.width,c.left="auto",n.widget.addClass("pull-right")):(c.right="auto",n.widget.removeClass("pull-right")),n.widget.css({position:b,top:c.top,left:c.left,right:c.right})},x=function(){c.defer(function(){window.scrollTo(0,0),n.widget.css("top",Math.max(0,(a(window).height()-n.widget.outerHeight())/2+a(window).scrollTop())+"px"),n.widget.css("left",Math.max(0,(a(window).width()-n.widget.outerWidth())/2+a(window).scrollLeft())+"px")})},y=function(b,c){
var d=b.top+n.widget.height()>c.height()+c.scrollTop()&&n.widget.height()+n.element.outerHeight()<b.top,e=!(b.top>0&&b.left>0&&b.top+n.widget.height()<c.height());"up"===n.options.direction?n.placePosition="top":"bottom"===n.options.direction?n.placePosition="bottom":"auto"===n.options.direction&&(d?n.placePosition="top":e?(x(),a(n.widget).addClass("remove-arrow")):n.placePosition="bottom")},z=function(a){"top"===n.placePosition?(a.top-=n.widget.height()+n.element.outerHeight()+15,n.widget.addClass("top").removeClass("bottom")):(a.top+=1,n.widget.addClass("bottom").removeClass("top"))},A=function(a){n.element.trigger({type:"dp.clear",date:j(n.date),oldDate:j(a)})},B=function(a,b){if(o)o=!1;else if(j(n.date).isSame(j(a)))return;n.element.trigger({type:"dp.change",date:j(n.date),oldDate:j(a)}),"change"!==b&&n.element.change()},C=function(a){o=!0,n.element.trigger({type:"dp.error",date:j(a)})},D=function(a){j.locale(n.options.language);var b=a,c;b||(b=u().val(),b&&(c=S(b,n.format,b),
c instanceof Date||!n.options.oldFormat||n.format===n.options.oldFormat||(c=S(b,n.options.oldFormat,b)),n.date=j(c)),n.date||(n.date=j())),n.viewDate=j(n.date).startOf("month"),G(),K()},E=function(){j.locale(n.options.language);var b=a("<tr>"),c=j.weekdaysMin(),d;if(0===j().localeData()._week.dow)for(d=0;d<7;d++)b.append('<th class="dow">'+c[d]+"</th>");else for(d=1;d<8;d++)7===d?b.append('<th class="dow">'+c[0]+"</th>"):b.append('<th class="dow">'+c[d]+"</th>");n.widget.find(".datepicker-days thead").append(b)},F=function(){j.locale(n.options.language);for(var a="",b=0,c=j.monthsShort();b<12;)a+='<span class="month">'+c[b++]+"</span>";n.widget.find(".datepicker-months td").append(a)},G=function(){if(n.options.pickDate){j.locale(n.options.language);var b=n.viewDate.year(),c=n.viewDate.month(),d=n.options.minDate.year(),e=n.options.minDate.month(),f=n.options.maxDate.year(),g=n.options.maxDate.month(),h,i,k,l=[],m,o,p,q,r,s,t=j.months()
;for(n.widget.find(".datepicker-days").find(".disabled").removeClass("disabled"),n.widget.find(".datepicker-months").find(".disabled").removeClass("disabled"),n.widget.find(".datepicker-years").find(".disabled").removeClass("disabled"),n.widget.find(".datepicker-days th:eq(1)").text(t[c]+" "+b),i=j(n.viewDate).subtract(1,"months"),q=i.daysInMonth(),i.date(q),i.startOf("week"),(b===d&&c<=e||b<d)&&n.widget.find(".datepicker-days th:eq(0)").addClass("disabled"),(b===f&&c>=g||b>f)&&n.widget.find(".datepicker-days th:eq(2)").addClass("disabled"),k=j(i).add(42,"d");i.isBefore(k);){if(i.weekday()===j().startOf("week").weekday()&&(m=a("<tr>"),l.push(m)),o="",i.year()<b||i.year()===b&&i.month()<c?o+=" old":(i.year()>b||i.year()===b&&i.month()>c)&&(o+=" new"),i.isSame(j({y:n.date.year(),M:n.date.month(),d:n.date.date()}))&&(o+=" active"),!_(i,"day")&&aa(i)||(o+=" disabled"),n.options.showToday===!0&&i.isSame(j(),"day")&&(o+=" today"),
n.options.daysOfWeekDisabled)for(p in n.options.daysOfWeekDisabled)if(i.day()===n.options.daysOfWeekDisabled[p]){o+=" disabled";break}m.append('<td class="day'+o+'">'+i.date()+"</td>"),h=i.date(),i.add(1,"d"),h===i.date()&&i.add(1,"d")}for(n.widget.find(".datepicker-days tbody").empty().append(l),s=n.date.year(),t=n.widget.find(".datepicker-months").find("th:eq(1)").text(b).end().find("span").removeClass("active"),s===b&&t.eq(n.date.month()).addClass("active"),s-1<d&&n.widget.find(".datepicker-months th:eq(0)").addClass("disabled"),s+1>f&&n.widget.find(".datepicker-months th:eq(2)").addClass("disabled"),p=0;p<12;p++)b===d&&e>p||b<d?a(t[p]).addClass("disabled"):(b===f&&g<p||b>f)&&a(t[p]).addClass("disabled");for(l="",b=10*parseInt(b/10,10),r=n.widget.find(".datepicker-years").find("th:eq(1)").text(b+"-"+(b+9)).end().find("td"),n.widget.find(".datepicker-years").find("th").removeClass("disabled"),d>b&&n.widget.find(".datepicker-years").find("th:eq(0)").addClass("disabled"),
f<b+9&&n.widget.find(".datepicker-years").find("th:eq(2)").addClass("disabled"),b-=1,p=-1;p<11;p++)l+='<span class="year'+(p===-1||10===p?" old":"")+(s===b?" active":"")+(b<d||b>f?" disabled":"")+'">'+b+"</span>",b+=1;r.html(l)}},H=function(){j.locale(n.options.language);var a=n.widget.find(".timepicker .timepicker-hours table"),b="",c,d,e;if(a.parent().hide(),n.use24hours)for(c=0,d=0;d<6;d+=1){for(b+="<tr>",e=0;e<4;e+=1)b+='<td class="hour">'+ca(c.toString())+"</td>",c++;b+="</tr>"}else for(c=1,d=0;d<3;d+=1){for(b+="<tr>",e=0;e<4;e+=1)b+='<td class="hour">'+ca(c.toString())+"</td>",c++;b+="</tr>"}a.html(b)},I=function(){var a=n.widget.find(".timepicker .timepicker-minutes table"),b="",c=0,d,e,f=n.options.minuteStepping;for(a.parent().hide(),1===f&&(f=5),d=0;d<Math.ceil(60/f/4);d++){for(b+="<tr>",e=0;e<4;e+=1)c<60?(b+='<td class="minute">'+ca(c.toString())+"</td>",c+=f):b+="<td></td>";b+="</tr>"}a.html(b)},J=function(){
var a=n.widget.find(".timepicker .timepicker-seconds table"),b="",c=0,d,e;for(a.parent().hide(),d=0;d<3;d++){for(b+="<tr>",e=0;e<4;e+=1)b+='<td class="second">'+ca(c.toString())+"</td>",c+=5;b+="</tr>"}a.html(b)},K=function(){if(n.date){var a=n.widget.find(".timepicker span[data-time-component]"),b=n.date.hours(),c="AM";n.use24hours?(n.widget.find(".timepicker-hour").addClass("hour-fix"),n.widget.find(".timepicker-minute").addClass("hour-fix"),n.widget.find(".timepicker-second").addClass("hour-fix")):(b>=12&&(c="PM"),0===b?b=12:12!==b&&(b%=12),n.widget.find(".timepicker [data-action=togglePeriod]").text(c)),a.filter("[data-time-component=hours]").text(ca(b)),a.filter("[data-time-component=minutes]").text(ca(n.date.minutes())),a.filter("[data-time-component=seconds]").text(ca(n.date.second()))}},L=function(b){b.stopPropagation(),b.preventDefault(),n.unset=!1;var c=a(b.target).closest("span, td, th, button"),d,e,f,g,h=j(n.date);c.hasClass("close-button")&&n.hide(),
c.hasClass("clear-date-button")&&(n.setDate(S("",void 0,"")),n.hide(),A()),1===c.length&&M(b,c,d,e,f,g,h)},M=function(a,b,c,d,e,f,g){if(!b.is(".disabled"))switch(b[0].nodeName.toLowerCase()){case"th":switch(b[0].className){case"switch":T(1);break;case"prev":case"next":e=ea.modes[n.viewMode].navStep,"prev"===b[0].className&&(e*=-1),n.viewDate.add(e,ea.modes[n.viewMode].navFnc),G()}break;case"span":b.is(".month")?(c=b.parent().find("span").index(b),n.viewDate.month(c)):(d=parseInt(b.text(),10)||0,n.viewDate.year(d)),n.viewMode===n.minViewMode&&(n.date=j({y:n.viewDate.year(),M:n.viewDate.month(),d:n.viewDate.date(),h:n.date.hours(),m:n.date.minutes(),s:n.date.seconds()}),B(g,a.type),Z()),T(-1),G();break;case"td":b.is(".day")&&(f=parseInt(b.text(),10)||1,c=n.viewDate.month(),d=n.viewDate.year(),b.is(".old")?0===c?(c=11,d-=1):c-=1:b.is(".new")&&(11===c?(c=0,d+=1):c+=1),n.date=j({y:d,M:c,d:f,h:n.date.hours(),m:n.date.minutes(),s:n.date.seconds()}),n.viewDate=j({y:d,M:c,d:Math.min(28,f)}),
G(),Z(),B(g,a.type),n.hide())}},N={incrementHours:function(){$("add","hours",1)},incrementMinutes:function(){$("add","minutes",n.options.minuteStepping)},incrementSeconds:function(){$("add","seconds",1)},decrementHours:function(){$("subtract","hours",1)},decrementMinutes:function(){$("subtract","minutes",n.options.minuteStepping)},decrementSeconds:function(){$("subtract","seconds",1)},togglePeriod:function(){var a=n.date.hours();a>=12?a-=12:a+=12,n.date.hours(a)},showPicker:function(){n.widget.find(".timepicker > div:not(.timepicker-picker)").hide(),n.widget.find(".timepicker .timepicker-picker").show()},showHours:function(){n.widget.find(".timepicker .timepicker-picker").hide(),n.widget.find(".timepicker .timepicker-hours").show()},showMinutes:function(){n.widget.find(".timepicker .timepicker-picker").hide(),n.widget.find(".timepicker .timepicker-minutes").show()},showSeconds:function(){n.widget.find(".timepicker .timepicker-picker").hide(),
n.widget.find(".timepicker .timepicker-seconds").show()},selectHour:function(b){var c=n.widget.find(".timepicker [data-action=togglePeriod]").text(),d=parseInt(a(b.target).text(),10);"PM"===c&&(d+=12),n.date.hours(d),N.showPicker.call(n)},selectMinute:function(b){n.date.minutes(parseInt(a(b.target).text(),10)),N.showPicker.call(n)},selectSecond:function(b){n.date.seconds(parseInt(a(b.target).text(),10)),N.showPicker.call(n)}},O=function(b){var c=j(n.date),d=a(b.currentTarget).data("action"),e=N[d].apply(n,arguments);return P(b),n.date||(n.date=j({y:1970})),Z(),K(),B(c,b.type),e},P=function(a){a.stopPropagation(),a.preventDefault()},Q=function(a){27===a.keyCode&&n.hide()},R=function(b){j.locale(n.options.language);var c=a(b.target),d=j(n.date),e=j(S(c.val(),n.format,c.val()));e.isValid()&&!_(e)&&aa(e)?(D(),n.setValue(e),B(d,b.type),Z()):(n.viewDate=d,n.unset=!0,B(d,b.type),C(e))},S=function(a,b,c){return b=b||"yyyy-MM-ddTHH:mm:ss.fff",c=Object.defaultValue(c,null),
null===a||void 0===a?c:a instanceof Date?a:h.parseDate(a,b)||h.parseDate(a,"yyyy-MM-ddTHH:mm:ss.fff")||h.parseDate(a)||null},T=function(a){a&&(n.viewMode=Math.max(n.minViewMode,Math.min(2,n.viewMode+a))),n.widget.find(".datepicker > div").hide().filter(".datepicker-"+ea.modes[n.viewMode].clsName).show()},U=function(){var b,c,d,e,f;n.widget.on("click",".datepicker *, .close-button, .clear-date-button",a.proxy(L,this)),n.widget.on("click","[data-action]",a.proxy(O,this)),n.widget.on("mousedown",a.proxy(P,this)),n.element.on("keydown",a.proxy(Q,this)),n.options.pickDate&&n.options.pickTime&&n.widget.on("click.togglePicker",".accordion-toggle",function(g){if("top"===n.placePosition&&setTimeout(function(){w()},250),g.stopPropagation(),b=a(this),c=b.closest("ul"),d=c.find(".in"),e=c.find(".collapse:not(.in)"),d&&d.length){if((f=d.data("collapse"))&&f.transitioning)return;d.collapse("hide"),e.collapse("show"),b.find("span").toggleClass(n.options.icons.time+" "+n.options.icons.date),
n.element.find("[class^='input-group-'] span").toggleClass(n.options.icons.time+" "+n.options.icons.date)}}),n.isInput?m.isMobile()?n.element.on({focus:a.proxy(n.show,this),change:a.proxy(R,this)}):n.element.on({focus:a.proxy(n.show,this),change:a.proxy(R,this),blur:a.proxy(n.hide,this)}):(n.element.on({change:a.proxy(R,this)},"input"),n.component?n.component.on("click",a.proxy(n.show,this)):n.element.on("click",a.proxy(n.show,this)))},V=function(){a(window).on("resize.datetimepicker"+n.id,a.proxy(w,this)),n.isInput||a(document).on("mousedown.datetimepicker"+n.id,a.proxy(n.hide,this))},W=function(){n.widget.off("click",".datepicker *, .close-button, .clear-date-button",n.click),n.widget.off("click","[data-action]"),n.widget.off("mousedown",n.stopEvent),n.options.pickDate&&n.options.pickTime&&n.widget.off("click.togglePicker"),n.isInput?n.element.off({focus:n.show,change:n.change}):(n.element.off({change:n.change},"input"),
n.component?n.component.off("click",n.show):n.element.off("click",n.show))},X=function(){a(window).off("resize.datetimepicker"+n.id),n.isInput||a(document).off("mousedown.datetimepicker"+n.id)},Y=function(){if(n.element){var b=n.element.parents(),c=!1,d;for(d=0;d<b.length;d++)if("fixed"===a(b[d]).css("position")){c=!0;break}return c}return!1},Z=function(){j.locale(n.options.language);var a="";n.unset||(a=k.format(n.date.toDate(),n.format)),u().val(a),n.element.data("date",a),n.options.pickTime||n.hide()},$=function(a,b,c){j.locale(n.options.language);var d;if("add"===a?(d=j(n.date),23===d.hours()&&d.add(c,b),d.add(c,b)):d=j(n.date).subtract(c,b),_(j(d.subtract(c,b)))||_(d))return void C(k.format(d.toDate(),n.format));"add"===a?n.date.add(c,b):n.date.subtract(c,b),n.unset=!1},_=function(a,b){j.locale(n.options.language);var c=n.options.maxDate,d=n.options.minDate;return b&&(c=j(c).endOf(b),d=j(d).startOf(b)),
!(!a.isAfter(c)&&!a.isBefore(d))||n.options.disabledDates!==!1&&n.options.disabledDates[k.format(a,"yyyy-MM-dd")]===!0},aa=function(a){return j.locale(n.options.language),n.options.enabledDates===!1||n.options.enabledDates[k.format(a,"yyyy-MM-dd")]===!0},ba=function(a){var b,c={},d=0,e;for(e=0;e<a.length;e++)b=j(a[e]),b.isValid()&&(c[k.format(b.toDate(),"yyyy-MM-dd")]=!0,d++);return d>0&&c},ca=function(a){return a=a.toString(),a.length>=2?a:"0"+a},da=function(){if(n.options.pickDate&&n.options.pickTime){var a="";return a='<div class="bootstrap-datetimepicker-widget'+(n.options.sideBySide?" timepicker-sbs":"")+' dropdown-menu" style="z-index:99999 !important;">',
n.options.sideBySide?a+='<div class="row"><div class="col-sm-6 datepicker">'+ea.template+'</div><div class="col-sm-6 timepicker">'+fa.getTemplate()+"</div></div>":a+='<ul class="list-unstyled"><li'+(n.options.collapse?' class="collapse in"':"")+'><div class="datepicker">'+ea.template+'</div></li><li class="picker-switch accordion-toggle"><a class="btn btn-icon" style="width:100%; padding-top:5px;"><span class="'+n.options.icons.time+'"></span></a></li><li'+(n.options.collapse?' class="collapse"':"")+'><div class="timepicker">'+fa.getTemplate()+"</div></li></ul>"+ea.buttonsTemplate,a+="</div>"}return n.options.pickTime?'<div class="bootstrap-datetimepicker-widget dropdown-menu"><div class="timepicker">'+fa.getTemplate()+"</div>"+ea.buttonsTemplate+"</div>":'<div class="bootstrap-datetimepicker-widget dropdown-menu"><div class="datepicker">'+ea.template+"</div>"+ea.buttonsTemplate+"</div>"},ea={modes:[{clsName:"days",navFnc:"month",navStep:1},{clsName:"months",navFnc:"year",navStep:1},{
clsName:"years",navFnc:"year",navStep:10}],headTemplate:'<thead><tr><th class="prev"><i class="icon-back-arrow"></i></th><th colspan="5" class="switch"></th><th class="next"><i class="icon-right-arrow"></i></th></tr></thead>',contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>'},fa={hourTemplate:'<span data-action="showHours" data-time-component="hours" class="timepicker-hour"></span>',minuteTemplate:'<span data-action="showMinutes" data-time-component="minutes" class="timepicker-minute"></span>',secondTemplate:'<span data-action="showSeconds"  data-time-component="seconds" class="timepicker-second"></span>'};ea.template='<div class="datepicker-days"><table class="table-condensed">'+ea.headTemplate+'<tbody></tbody></table></div><div class="datepicker-months"><table class="table-condensed">'+ea.headTemplate+ea.contTemplate+'</table></div><div class="datepicker-years"><table class="table-condensed">'+ea.headTemplate+ea.contTemplate+"</table></div>",
ea.buttonsTemplate='<div class="block-group date-picker-buttons"><button class="clear-date-button btn btn-default block">'+l.translate("CLEAR")+'</button><button class="close-button btn btn-default block">'+l.translate("CLOSE")+"</button> </div>",fa.getTemplate=function(){
return'<div class="timepicker-picker"><table class="table-condensed"><tr><td><a href="#" class="btn  btn-icon" data-action="incrementHours"><span style="box-shadow:none; font-size:18px;" class="'+n.options.icons.up+'"></span></a></td><td class="separator"></td><td>'+(n.options.useMinutes?'<a href="#" class="btn btn-icon" data-action="incrementMinutes"><span style="box-shadow:none; font-size:18px;" class="'+n.options.icons.up+'"></span></a>':"")+"</td>"+(n.options.useSeconds?'<td class="separator"></td><td><a href="#" class="btn btn-icon" data-action="incrementSeconds"><span style="box-shadow:none; font-size:18px;" class="'+n.options.icons.up+'"></span></a></td>':"")+(n.use24hours?"":'<td class="separator"></td>')+"</tr><tr><td>"+fa.hourTemplate+'</td> <td class="separator">:</td><td>'+(n.options.useMinutes?fa.minuteTemplate:'<span class="timepicker-minute">00</span>')+"</td> "+(n.options.useSeconds?'<td class="separator">:</td><td>'+fa.secondTemplate+"</td>":"")+(n.use24hours?"":'<td class="separator"></td><td><button type="button" class="btn btn-primary" style="min-width: 0;" data-action="togglePeriod"></button></td>')+'</tr><tr><td><a href="#" class="btn btn-icon" data-action="decrementHours"><span style="box-shadow:none; font-size:18px;" class="'+n.options.icons.down+'"></span></a></td><td class="separator"></td><td>'+(n.options.useMinutes?'<a href="#" class="btn btn-icon" data-action="decrementMinutes"><span style="box-shadow:none; font-size:18px;" class="'+n.options.icons.down+'"></span></a>':"")+"</td>"+(n.options.useSeconds?'<td class="separator"></td><td><a href="#" class="btn btn-icon" data-action="decrementSeconds"><span class="'+n.options.icons.down+'"></span></a></td>':"")+(n.use24hours?"":'<td class="separator"></td>')+'</tr></table></div><div class="timepicker-hours" data-action="selectHour"><table class="table-condensed"></table></div><div class="timepicker-minutes" data-action="selectMinute"><table class="table-condensed"></table></div>'+(n.options.useSeconds?'<div class="timepicker-seconds" data-action="selectSecond"><table class="table-condensed"></table></div>':"")
},n.destroy=function(){W(),X(),n.widget.remove(),n.blockout&&n.blockout.remove(),n.element.removeData("DateTimePicker"),n.component&&n.component.removeData("DateTimePicker")},n.show=function(b){if(n.options.useCurrent&&""===u().val()){if(1!==n.options.minuteStepping){var c=j(),d=n.options.minuteStepping;c.minutes(Math.round(c.minutes()/d)*d%60).seconds(0),n.setValue(k.format(c.toDate(),n.format))}else n.setValue(k.format(new Date,n.format));B("",b.type)}n.blockout=a('<div class="datepicker-screen-freeze"></div>').appendTo("body"),m.isMobile()&&n.blockout.click(function(){a(n.blockout).remove(),n.hide()}),n.widget.hasClass("picker-open")?(n.widget.hide(),n.widget.removeClass("picker-open")):(n.widget.show(),n.blockout.show(),n.widget.css("visibility","visible"),n.element.css("z-index",99999),a("input.form-control").css("z-index",2),n.element.css("position","relative"),n.widget.addClass("picker-open")),n.height=n.component?n.component.outerHeight():n.element.outerHeight(),w(),
n.element.trigger({type:"dp.show",date:j(n.date)}),V(),b&&P(b)},n.disable=function(){var a=n.element.find("input");a.prop("disabled")||a.prop("disabled",!0)},n.enable=function(){var a=n.element.find("input");a.prop("disabled")&&a.prop("disabled",!1)},n.hide=function(a){m.isMobile()?setTimeout(n.hide_function.bind(null,this,a),500):n.hide_function(a)},n.hide_function=function(b){if(!b||!a(b.target).is("#"+n.element.attr("id"))){var c=n.widget.find(".collapse"),d,e;for(d=0;d<c.length;d++)if((e=c.eq(d).data("collapse"))&&e.transitioning)return;n.widget.hide(),n.widget.css("visiblity","hidden"),n.widget.removeClass("picker-open"),n.viewMode=n.startViewMode,n.blockout&&(n.blockout.remove(),m.isMobile()&&n.blockout.off("click")),m.isMobile()&&a(n.element).blur(),n.element.css("z-index",n.elementZIndexOrig),n.element.css("position",n.elementPosOrig),T(),n.element.trigger({type:"dp.hide",date:j(n.date)}),X()}},n.setValue=function(a){j.locale(n.options.language),a?n.unset=!1:(n.unset=!0,Z()),
j.isMoment(a)||(a=j(a instanceof Date?a:S(a,n.format,a))),a.isValid()?(n.date=a,Z(),n.viewDate=j({y:n.date.year(),M:n.date.month()}),G(),K()):C(a)},n.getDate=function(){return n.unset?null:j(n.date)},n.setDate=function(a){var b=j(n.date);a?n.setValue(a):n.setValue(null),B(b,"function")},n.setDisabledDates=function(a){n.options.disabledDates=ba(a),n.viewDate&&D()},n.setEnabledDates=function(a){n.options.enabledDates=ba(a),n.viewDate&&D()},n.setMaxDate=function(a){void 0!==a&&(n.options.maxDate=j(a),n.viewDate&&D())},n.setMinDate=function(a){void 0!==a&&(n.options.minDate=j(a),n.viewDate&&D())},p()};a.fn.datetimepicker=function(b){function c(c){var d=a(c);d.data("DateTimePicker")||d.data("DateTimePicker",new m(c,b))}return this.each(c.bind(null,this))},a.fn.datetimepicker.defaults={pickDate:!0,pickTime:!0,useMinutes:!0,useSeconds:!1,useCurrent:!0,minuteStepping:1,minDate:new j({y:1900}),maxDate:(new j).add(1e3,"y"),showToday:!0,collapse:!0,language:"en",defaultDate:"",disabledDates:!1,
enabledDates:!1,icons:{},useStrict:!1,direction:"auto",sideBySide:!1,daysOfWeekDisabled:!1,widgetParent:!1}});
define('logging/error-notification-handler',['require','jquery','knockout','spa/ko/knockout-view-model','system/lang/event'],function(require){"use strict";var a=require("jquery"),b=require("knockout"),c=require("spa/ko/knockout-view-model"),d=require("system/lang/event"),e=[];function f(){g.call(this)}var g=Object.inherit(c,f);f.prototype.addError=function a(b){b&&(b.errorCode=b.errorCode||"",b.errorMessage=b.errorMessage||"",b.errorDetail=b.errorDetail||"",b.date=b.date||h(),b.time=b.time||i(new Date))},f.prototype.getErrorsLog=function a(b,c){return e},f.prototype.getErrorById=function b(c){return a.grep(e,function(a){return a.number===parseInt(c.logId)})};function h(){var a=new Date;return a.getMonth()+1+"/"+a.getDate()+"/"+a.getFullYear().toString().substr(2,2)}function i(a){var b=a.getHours(),c=a.getMinutes(),d=b>=12?"pm":"am";return b%=12,b=b?b:12,c=c<10?"0"+c:c,b+":"+c+" "+d}return f.singleton=!0,f});
define('ui/elements/date-time/date-time-control',['require','exports','module','lodash','jquery','logging/error-notification-handler','system/diagnostics/log-manager','system/lang/event','system/hardware/device','ui/elements/date-time/bootstrap-datetimepicker'],function(require,exports,module){"use strict";var a=require("lodash"),b=require("jquery"),c=require("logging/error-notification-handler"),d=require("system/diagnostics/log-manager"),e=d.getLogger(module.id),f=require("system/lang/event"),g=require("system/hardware/device");require("ui/elements/date-time/bootstrap-datetimepicker");function h(a){this.element=a,this.options=null,this.picker=null,this.changed=new f,this.invalid=new f,this.clear=new f,this.blur=new f,this.hide=new f,this.inputGroup=null,this.input=null,this.addon=null,this.button=null,this.icon=null,this.$input=null,this.$addon=null,this.markValid=!1,this.errorNotificationHandler=Object.resolve(c)}h.culture="",h.setCulture=function(a){try{h.culture=a}catch(a){B(this,a)}},h.prototype.initHTML=function(){try{i(this)}catch(a){B(this,a)}},h.prototype.initialize=function(a){try{j(this,a)}catch(a){B(this,a)}},h.prototype.setValue=function(a){try{this.picker&&this.picker.setDate(a)}catch(a){B(this,a)}},
h.prototype.enable=function(){try{r(this,!1)}catch(a){B(this,a)}},h.prototype.disable=function(){try{r(this,!0)}catch(a){B(this,a)}},h.prototype.dispose=function(){try{k(this)}catch(a){B(this,a)}finally{l(this)}};function i(a){Element.clearDom(a.element),a.inputGroup=Element.build("div",a.element,["input-group","date"]),a.input=Element.build("input",a.inputGroup,["form-control"],{type:"text"}),a.addon=Element.build("span",a.inputGroup,["input-group-btn"]),a.button=Element.build("button",a.addon,["btn","btn-icon"]),a.icon=Element.build("span",a.button),a.$input=b(a.input),a.$addon=b(a.addon)}function j(a,b){if(b){var c;a.options&&(c=a.options.format),a.options=b,a.options.oldFormat=c}l(a),o(a),p(a)}function k(a){a.changed.remove(),a.changed=null,a.invalid.remove(),a.invalid=null,a.clear.remove(),a.clear=null,l(a)}function l(a){m(a),n(a)}function m(a){a.$addon.off(),a.$input.off()}function n(a){a.picker&&(a.picker.destroy(),a.picker=null)}function o(a){
a.options.pickDate?(a.icon.classList.add("icon-calendar"),a.icon.classList.remove("icon-time-units")):(a.icon.classList.add("icon-time-units"),a.icon.classList.remove("icon-calendar"))}function p(a){a.picker=q(a),r(a,a.options.disabled),s(a)}function q(a){return a.$input.datetimepicker({pickDate:a.options.pickDate,pickTime:a.options.pickTime,useMinutes:a.options.useMinutes,useSeconds:a.options.useSeconds,minuteStepping:a.options.minuteStep,format:a.options.format,oldFormat:a.options.oldFormat,language:h.culture,useCurrent:a.options.useCurrent}),a.$input.data("DateTimePicker")}function r(a,b){a.picker&&b?a.picker.disable():a.picker&&!b&&a.picker.enable(),a.input.disabled=b,a.button.disabled=b}function s(a){a.$addon.click(u.bind(null,a)),a.$input.change(v),a.$input.on("dp.change",w.bind(null,a)),a.$input.on("blur",x.bind(null,a)),a.$input.on("dp.error",z.bind(null,a)),a.$input.on("dp.hide",y.bind(null,a)),a.$input.on("dp.clear",A.bind(null,a)),t(a)}function t(a){
Object.resolve(g).isMobile()&&(a.input.readOnly=!0)}function u(a){a.input.focus()}function v(a){a.stopPropagation()}function w(c,d){var e=d.oldDate?d.oldDate.toDate():null,f=d.date?d.date.toDate():null;a.defer(function(){b(c.input).removeClass("date-error"),c.input.style.border="1px solid #c0c5c5",c.input.style.padding="10px"}),c.changed.raise(c,e,f)}function x(a,b){a.blur.raise(a),b.stopPropagation()}function y(a,b){a.hide.raise(),b.stopPropagation()}function z(c,d){c.input.value||!c.input.value&&c.element.required?(c.invalid.raise(c,c.input.value),a.defer(function(){c.markValid||b(c.input).addClass("date-error")})):c.changed.raise(c,null,null)}function A(a,b){a.clear.raise(),b.stopPropagation()}function B(a,b){e.error(b.stack),a.errorNotificationHandler.addError({errorMessage:b.message,errorDetail:b.stack})}return h});
define('ui/elements/date-time/element',['require','exports','module','lodash','jquery','logging/error-notification-handler','system/diagnostics/log-manager','system/lang/converter','./date-time-control'],function(require,exports,module){"use strict";var a=require("lodash"),b=require("jquery"),c=require("logging/error-notification-handler"),d=require("system/diagnostics/log-manager"),e=d.getLogger(module.id),f=require("system/lang/converter"),g=require("./date-time-control"),h=Object.create(HTMLElement.prototype);h.createdCallback=function(){m(this),this.rebuild=a.debounce(U.bind(null,this),100),this.errorNotificationHandler=Object.resolve(c)},h.attachedCallback=function(){try{i(this)}catch(a){V(a,this)}},h.detachedCallback=function(){try{j(this)}catch(a){V(a,this)}finally{Element.clearDom(this)}},h.attributeChangedCallback=function(a,b,c){try{k(this,a,b,c)}catch(a){V(a,this)}};function i(a){a.control=new g(a),o(a),a.control.initHTML(),a.control.initialize({pickDate:a.pickDate,pickTime:a.pickTime,useMinutes:a.useMinutes,useSeconds:a.useSeconds,minuteStep:a.minuteStep,format:a.format,disabled:a.disabled,required:a.required,defaultDate:a.value,useCurrent:a.useCurrent}),
a.control.changed.add(E,null,a),a.control.blur.add(F,null,a),a.control.invalid.add(H,null,a),a.control.hide.add(G,null,a),a.control.clear.add(I,null,a)}function j(a){a.control.dispose(),a.control=null,Element.clearDom(a)}function k(a,b,c,d){"value"===b?(c=f.toNullableDate(c),d=f.toNullableDate(d),L(a,c,d)):"format"===b?a.format=p(a):"pick-date"===b?a.pickDate=q(a):"pick-time"===b?a.pickTime=r(a):"use-minutes"===b?a.useMinutes=s(a):"use-seconds"===b?a.useSeconds=t(a):"minute-step"===b?a.minuteStep=u(a):"disabled"===b?a.disabled=v(a):"required"===b?a.required=x(a):"populate-empty"===b&&(a.useCurrent=w(a)),l(a)}function l(a){a._properties.value&&a.control.picker.setValue(a.control.picker.date.toDate())}function m(b){b._properties={pickDate:!0,pickTime:!0,useMinutes:!0,useSeconds:!1,minuteStep:1,format:"",disabled:!1,required:!1,useCurrent:!0,oldValue:null},a.each(b._properties,n.bind(null,b)),b._properties.value=f.toDate(),Element.defineProperty(b,"value",{get:A.bind(null,b,"value"),
set:C.bind(null,b)})}function n(a,b,c){Object.defineProperty(a,c,{get:A.bind(null,a,c),set:B.bind(null,a,c)})}function o(a){a._properties.format=p(a),a._properties.pickDate=q(a),a._properties.pickTime=r(a),a._properties.useMinutes=s(a),a._properties.useSeconds=t(a),a._properties.minuteStep=u(a),a._properties.disabled=v(a),a._properties.value=f.toDate(z(a),void 0,z(a)),a._properties.required=x(a),a._properties.useCurrent=w(a),a._properties.oldValue=a._properties.value}function p(a){return Element.stringAttribute(a,"format",a.format)}function q(a){return y(a,"pick-date",a.pickDate)}function r(a){return y(a,"pick-time",a.pickTime)}function s(a){return y(a,"use-minutes",a.useMinutes)}function t(a){return y(a,"use-seconds",a.useSeconds)}function u(a){return Element.intAttribute(a,"minute-step",a.minuteStep)}function v(a){return Element.booleanAttribute(a,"disabled")}function w(a){return!Element.booleanAttribute(a,"populate-empty")}function x(a){return Element.booleanAttribute(a,"required")}
function y(a,b,c){var d=a.getAttribute(b);return d?f.toBoolean(d,"true"):c}function z(a){return Element.stringAttribute(a,"value",a.value)}function A(a,b){return a._properties[b]}function B(a,b,c){a._properties[b]=c,U(a)}function C(c,d){if(!window.CustomElements||window.CustomElements.useNative)D(c,d);else{var e,f=!1;c.parentNode&&c.parentNode.parentNode&&(e=c.parentNode.parentNode),e&&b(e).hasClass("layout-element-content")&&(f=!0),f?D(c,d):a.defer(function(){D(c,d)})}}function D(b,c){void 0!==c&&(""===c&&(c=null),null===c||void 0===c||a.isDate(c)||(c=f.toDate(c,void 0,c)),c=K(b,c),b._properties.value=c,b._properties.oldValue=c,b.control&&b.control.setValue(b.value))}function E(a,b,c,d){null===a.value&&null===d||L(a,a.value,d)}function F(a){M(a)}function G(a){N(a)}function H(a,b,c){var d=a._properties.value;if(c){var e;if(c=c.trim(),/AM|PM/.test(c.substr(c.length-2))&&(c=c.split(/AM|PM/)[0]),e=new Date(c.trim()),
!isNaN(e.getTime()))return void(a.value.getTime()!==e.getTime()&&(a.value=e,a.control.markValid=!0,P(a,d,a.value)))}a._properties.value=null,R(a,d)}function I(a){J(a)}function J(a){a.dispatchEvent(new CustomEvent("clear",{detail:{oldValue:null,newValue:null}}))}function K(a,b){if(b)return a.pickTime?!a.useSeconds&&b.setSeconds&&b.setSeconds(0,0):b.setHours(0,0,0,0),b}function L(a,b,c){T(b,c)&&(a._properties.value=c)}function M(a){T(a._properties.oldValue,a._properties.value)&&(P(a,a._properties.oldValue,a._properties.value),a._properties.oldValue=a._properties.value)}function N(a){O(a)&&T(a._properties.oldValue,a._properties.value)&&(Q(a,a._properties.oldValue,a._properties.value),a._properties.oldValue=a._properties.value)}function O(a){return a.getAttribute("update-on-close")}function P(a,b,c){a.dispatchEvent(new CustomEvent("change",{detail:{oldValue:b,newValue:c}}))}function Q(a,b,c){a.dispatchEvent(new CustomEvent("updateValueOnClose",{detail:{oldValue:b,newValue:c}}))}
function R(a,b){a.dispatchEvent(new CustomEvent("invalid",{detail:{oldValue:b,newValue:null}}))}function S(a){return Math.floor(a/1e3)}function T(a,b){return!a||(!b||S(a.valueOf())!==S(b.valueOf()))}function U(a){a.control&&(a.control.initialize({pickDate:a.pickDate,pickTime:a.pickTime,useMinutes:a.useMinutes,useSeconds:a.useSeconds,minuteStep:a.minuteStep,format:a.format,disabled:a.disabled,required:a.required,defaultDate:a.value,useCurrent:a.useCurrent}),a.disabled?a.control.disable():a.control.enable())}function V(a,b){e.error(a.stack),b.errorNotificationHandler.addError({errorMessage:a.message,errorDetail:a.stack})}return document.registerElement("mi-date-time",{prototype:h}),h});
define('query/execution/query-prompt-view-model',['require','lodash','jquery','knockout','application/application-events','application/application-context','system/knockout/knockout-manager','spa/ko/knockout-view-model','system/error/error-message','system/globalization/translator','../services/query-service','../services/dto/parameter-container-dto','../adapters/parameter-design-adapter','../adapters/parameter-value-adapter','text!./views/query-prompt.html','assets/services/asset-context-dto','system/lang/converter','moment','system/lang/object','ui/elements/select/view-model','ui/elements/multi-value/view-model','ui/elements/asset-context/view-model','ui/elements/date-time/bootstrap-datetimepicker','ui/elements/date-time/element'],function(require){"use strict";var a=require("lodash"),b=require("jquery"),c=require("knockout"),d=require("application/application-events"),e=require("application/application-context"),f=require("system/knockout/knockout-manager"),g=require("spa/ko/knockout-view-model"),h=require("system/error/error-message"),i=require("system/globalization/translator"),j=require("../services/query-service"),k=require("../services/dto/parameter-container-dto"),l=require("../adapters/parameter-design-adapter"),m=require("../adapters/parameter-value-adapter"),n=require("text!./views/query-prompt.html"),o=require("assets/services/asset-context-dto"),p=require("system/lang/converter"),q=require("moment");require("system/lang/object"),require("ui/elements/select/view-model"),require("ui/elements/multi-value/view-model"),require("ui/elements/asset-context/view-model"),require("ui/elements/date-time/bootstrap-datetimepicker"),require("ui/elements/date-time/element");function r(a,b){s.call(this,n),
this.kom=a,this.applicationEvents=b,this.translator=Object.resolve(i),this.queryService=Object.resolve(j),this.queryContainer=null,this.hasParamDependency=null,this.prompts=null,this.isLoading=!0,this.assetFinder=null,this.format=e.user.formats.dateTime,this.dateFormat=e.user.formats.shortDate}var s=Object.inherit(g,r);r.dependsOn=[f,d],r.prototype.open=function a(b){},r.prototype.load=function a(c){var d=new b.Deferred,e;return this.queryContainer=c.queryContainer,e=this.queryContainer.parmContainer,this.hasParamDependency=this.kom.observable(e.hasDependencies),this.prompts=this.kom.observableArray(t(this,e.parmDesigns)),d.promise()},r.prototype.activate=function a(){},r.prototype.attach=function a(b){s.prototype.attach.call(this,b),this.region=b,this.isLoading=!1},r.prototype.detach=function a(b){s.prototype.detach.call(this,b)},r.prototype.deactivate=function a(b){this.kom.disposeSubscriptions(),this.kom.disposeComputeds()},r.prototype.unload=function a(){
this.kom.disposeObservables()},r.prototype.validatePrompt=function a(b){return!b.value()||(b.isMultiValue?!b.options||!b.options.length||b.values().length>0:"Numeric"!==b.paramDesign.dataType()||b.isAssetHierarchy?"Date"!==b.paramDesign.dataType()||(G(this,b.value())?(this.clearPromptValidationMessage(b),!0):(b.validationMessage(this.translate("QUERY_INVALID_DATE")),!1)):F(this,b.value().replace(",",""))?(this.clearPromptValidationMessage(b),!0):(b.validationMessage(this.translate("QUERY_INVALID_NUMBER")),!1))},r.prototype.validate=function a(){var b=0;for(b=0;b<this.prompts().length;b++){var c=this.prompts()[b];if(!this.validatePrompt(c))return!1}return!0},r.prototype.clearPromptValidationMessage=function a(b){b.validationMessage(null)},r.prototype.getParameterValues=function b(){var c;return c=a.map(this.prompts(),H.bind(null,this)),new k({hasDependencies:this.hasParamDependency(),parmDesigns:l.toDTOArray(c)})},r.prototype.multiSelectValueChanged=function a(){
this.hasParamDependency()&&D(this,null)},r.prototype.translate=function(a){return this.translator.translate(a)};function t(b,c){var d,e;return d=l.toModelObjectArray(c),b.kom.disposeSubscriptions(),e=a.map(d,u.bind(null,b))}function u(b,c,d){var e,f=a.map(c.list(),B.bind(null,b,c)),g=f;return f&&f.length>0||(f=c.parameterValues(),g=m.toDTOArray(c.parameterValues())),"Boolean"===c.dataType()&&(f=[{displayValue:"All",value:"A"},{displayValue:"True",value:"Y"},{displayValue:"False",value:"N"}],g=f),e={caption:c.localizedCaption()||c.caption()||c.id()||b.translate("QUERY_EXEC_PROMPT_ENTER_VAL"),options:f,cboOptions:g||[],values:b.kom.observableArray(w(b,c,f)),value:b.kom.observable(v(b,c,f)),isExclusive:c.isExclusive()||"Boolean"===c.dataType(),isMultiValue:c.isMultiValue(),paramDesign:c,isAssetHierarchy:c.isAssetHierarchy(),child:c.child(),parent:c.parent(),valueTemplate:A(c),all:c.all(),current:c.current(),validationMessage:b.kom.observable(),isGis:c.isGis(),isHidden:c.isHidden(),
format:c.format(),alias:c.alias(),distance:c.distance(),entyKey:c.entyKey(),justTheDate:c.justTheDate()},b.hasParamDependency()&&(e.isExclusive||e.options.length||e.value.extend({rateLimit:{timeout:1200,method:"notifyWhenChangesStop"}}),e.isMultiValue||d+1<b.queryContainer.parmContainer.parmDesigns.length&&b.kom.subscribe(e.value,D.bind(null,b,d))),e}function v(b,d,f){var g,h=d.parameterPrompts();if(h&&h.length)return z(b,d,h[0]);if(null!==d.defaultValue()){if("Date"===d.dataType()){var i=a.find(b.queryContainer.parmContainer.parmDesigns,function(a,b){return a.caption===d.caption()});if(i&&i.parmValues.length)return C(b,d,d.defaultValue())}return z(b,d,d.defaultValue())}return f&&f.length?z(b,d,c.unwrap(f[0].value)):d.isAssetHierarchy()?(g=e.assetcontext||new o,g.entityKey&&"0"!==g.entityKey&&0!==g.entityKey||(g.entityKey="-1"),g):"Date"===d.dataType()?new Date:void 0}function w(a,b,c){var d=0,e=b.parameterPrompts(),f;if(b.isMultiValue()){if(e&&e.length){
for(d=0;d<e.length;d++)if(f=e[d],c&&c.length&&!x(c,f))return b.parameterPrompts.removeAll(),b.parameterPrompts();return b.parameterPrompts()}return b.defaultValues()}}function x(b,c){return a.find(b,y.bind(null,c))}function y(a,b){return c.utils.unwrapObservable(b.value)===a}function z(a,b,c){return"Date"===b.dataType()?p.toDate(c,"yyyy-MM-ddTHH:mm:ss.fff"):c}function A(a){switch(a.dataType()){case"Date":return a.justTheDate()?"prompt-date-template":"prompt-datetime-template";case"Numeric":return"prompt-number-template";default:return"prompt-text-template"}}function B(a,b,c){return{value:z(a,b,c),displayValue:C(a,b,c)}}function C(a,b,c){var d,e=c;return"Date"===b.dataType()&&(d=z(a,b,c),e=p.toDateString(d,a.format)),e}function D(b,c){var d=b.queryContainer,e;b.isLoading||(e=a.map(b.prompts(),H.bind(null,b)),d.parmContainer.parmDesigns=l.toDTOArray(e),b.queryService.compileContainerParameters(d).done(E.bind(null,b,c)).fail(J.bind(null,b)))}function E(a,b,c){var d,e;a.isLoading=!0,
e=t(a,c.parmContainer.parmDesigns),null!==b&&(d=e[b],!d.value()||d.isExclusive||x(d.cboOptions,d.value())||d.cboOptions.push({displayValue:d.value(),value:d.value()})),a.prompts(e),a.isLoading=!1}function F(a,c){return!!b.isNumeric(c)}function G(a,b){return q(p.toDate(b,a.format,b)).isValid()}function H(a,b){var c;return b.isMultiValue?b.options&&b.options.length?b.paramDesign.parameterPrompts(b.values()):b.paramDesign.parameterPrompts(I(b.value())):b.value()instanceof o?(b.paramDesign.parameterPrompts([b.value().entityKey]),b.paramDesign.assetHierarchyCaption=b.value().description):b.value()instanceof Date?b.paramDesign.parameterPrompts([p.toDateString(b.value(),"yyyy-MM-ddTHH:mm:ss.fff")]):"Date"===b.paramDesign.dataType()&&b.value()?(c=p.toDate(b.value(),"yyyy-MM-ddTHH:mm:ss.fff",b.value()),b.paramDesign.parameterPrompts([p.toDateString(c,"yyyy-MM-ddTHH:mm:ss.fff")])):b.value()?b.paramDesign.parameterPrompts([b.value().toString()]):b.paramDesign.parameterPrompts([null]),
b.paramDesign}function I(a){var b;if(!a)return[];b=a.split(",");for(var c=0;c<b.length;c++)b[c].trim();return b}function J(a,b){var c=2,d=h.fromHttpResponse(c,b);a.applicationEvents.errorOccured.raise(a,d)}return r});

define('text!query/execution/views/query-prompt-dialog.html',[],function () { return '<div class="query-prompt-dialog block-group">\r\n    <div class="query-prompt-container">\r\n        &nbsp;\r\n    </div>\r\n    <div class="controls">\r\n        <button type="button"\r\n                class="btn  btn-text  btn-secondary"\r\n                data-bind="click: cancel,\r\n                           text: translate(\'CANCEL\')"></button>\r\n        <button type="button"\r\n                class="btn btn-text"\r\n                data-bind="click: done,\r\n                           enable: isDoneButtonEnabled,\r\n                           text: translate(\'DONE\').capitalize()"></button>        \r\n    </div>\r\n</div>';});

define('query/execution/query-prompt-dialog',['require','jquery','spa/ko/knockout-view-model','application/application-events','system/error/error-message','system/knockout/knockout-manager','spa/region','system/ui/dialog-view-model','./query-prompt-view-model','system/globalization/translator','text!./views/query-prompt-dialog.html','system/lang/string','system/lang/object'],function(require){"use strict";var a=require("jquery"),b=require("spa/ko/knockout-view-model"),c=require("application/application-events"),d=require("system/error/error-message"),e=require("system/knockout/knockout-manager"),f=require("spa/region"),g=require("system/ui/dialog-view-model"),h=require("./query-prompt-view-model"),i=require("system/globalization/translator"),j=require("text!./views/query-prompt-dialog.html");require("system/lang/string"),require("system/lang/object");function k(a,b,c,d){l.call(this,j),this.kom=a,this.applicationEvents=b,this.queryPromptRegion=c,this.queryPromptViewModel=d,this.translator=Object.resolve(i),this.dialog=null,this.dfd=null,this.isDoneButtonEnabled=null,this.queryContainer=null}var l=Object.inherit(b,k);k.dependsOn=[e,c,f,h],k.prototype.show=function b(c){var d={height:"70%",width:"30%"};return c=c||{},c.title=c.title||this.translate("QUERY_EXEC_PROMPT_DLG_TITLE"),this.queryContainer=c.queryContainer,this.dialog=new g(this,c.title,d),
this.dialog.show(),this.dfd=a.Deferred(),this.dfd.promise()},k.prototype.close=function a(){this.dialog=null},k.prototype.open=function a(){},k.prototype.load=function b(c){var d=new a.Deferred;return c=c||{},c.queryContainer=this.queryContainer,this.queryPromptViewModel.load(c),d.promise()},k.prototype.activate=function a(){this.queryPromptViewModel.activate(),this.isDoneButtonEnabled=this.kom.computed(m.bind(null,this))},k.prototype.attach=function a(b){l.prototype.attach.call(this,b),this.region=b,this.queryPromptRegion.setElement(this.region.$element.find("div.query-prompt-container")),this.queryPromptViewModel.attach(this.queryPromptRegion)},k.prototype.detach=function a(b){this.queryPromptViewModel.detach(this.queryPromptRegion),this.queryPromptRegion.clear(),l.prototype.detach.call(this,b)},k.prototype.canUnload=function a(){return this.queryPromptViewModel.canUnload()},k.prototype.deactivate=function a(){this.queryPromptViewModel.deactivate(this.queryPromptRegion),
this.kom.disposeSubscriptions(),this.kom.disposeComputeds()},k.prototype.unload=function a(){this.queryPromptViewModel.unload(),this.kom.disposeObservables()},k.prototype.translate=function(a){return this.translator.translate(a)},k.prototype.done=function a(){var b;this.queryPromptViewModel.validate()&&(b=this.queryPromptViewModel.getParameterValues(),this.dfd.resolve(b),this.dialog.closeDialog())},k.prototype.cancel=function a(){this.dfd.reject(),this.dialog.closeDialog()};function m(a){return a.queryPromptViewModel.validate()}function n(a,b){b&&a.dfd.resolve(b),a.dialog.closeDialog()}function o(a,b){var c=2,e=d.fromHttpResponse(c,b);a.applicationEvents.errorOccured.raise(a,e)}return k});
define('system/lang/unique-id',['require','uuid'],function(require){"use strict";var a=require("uuid");function b(){return a.v1()}function c(){return a.v4()}return{createV1:b,createV4:c}});
define('query/model/column-model',['require','knockout'],function(require){"use strict";var a=require("knockout");function b(b){b=b||{},this.id=a.observable(b.id),this.caption=a.observable(b.caption),this.defaultCaption=a.observable(b.defaultCaption),this.dataType=a.observable(b.dataType),this.isInactive=a.observable(b.isInactive),this.captionDisplay=a.computed(c.bind(null,this)),this.idUndecorated=a.computed(d.bind(null,this))}function c(a){var b=a.caption();if(b)return 0===b.indexOf("[")?b.substring(1,b.length-1):b}function d(a){var b=a.id();if(b)return 0===b.indexOf("[")?b.substring(1,b.length-1):b}return b});
define('query/adapters/column-adapter',['require','../services/dto/column-dto','../model/column-model'],function(require){"use strict";var a=require("../services/dto/column-dto"),b=require("../model/column-model");function c(){}return c.toModelObject=function a(c){return new b(c)},c.toModelObjectArray=function a(b){var c=0,d=[];if(b&&b.length){for(c=0;c!==b.length;c++)d.push(this.toModelObject(b[c]));return d}},c.toDTO=function c(d){var e=new a;return d=d||new b,e.id=d.id(),e.caption=d.caption(),e.defaultCaption=d.defaultCaption(),e.dataType=d.dataType(),e.isInactive=d.isInactive(),e},c.toDTOArray=function a(b){var c=0,d=[];if(b&&b.length){for(c=0;c!==b.length;c++)d.push(this.toDTO(b[c]));return d}},c});
define('query/model/table-design-model',['require','knockout','../adapters/column-adapter'],function(require){"use strict";var a=require("knockout"),b=require("../adapters/column-adapter");function c(c){var h=[];c=c||{},c.showAllFields||c.showAllFields===!1||(c.showAllFields=!0),c.showDataFields||c.showDataFields===!1||(c.showDataFields=!1),c.showInactiveFields||c.showInactiveFields===!1||(c.showInactiveFields=!1),c.showSystemFields||c.showSystemFields===!1||(c.showSystemFields=!1),this.alias=a.observable(c.alias),this.caption=a.observable(c.caption),this.defaultCaption=a.observable(c.defaultCaption),this.datasheetId=a.observable(c.datasheetId),this.id=a.observable(c.id),this.key=a.observable(c.key),this.layoutX=a.observable(c.layoutX),this.layoutY=a.observable(c.layoutY),this.name=a.observable(c.name),h=b.toModelObjectArray(c.queryColumns),this.queryColumns=a.observableArray(h&&h.length?h:[]),this.showAllFields=a.observable(c.showAllFields),this.showDataFields=a.observable(c.showDataFields),this.showInactiveFields=a.observable(c.showInactiveFields),
this.showSystemFields=a.observable(c.showSystemFields),this.storedQueryPath=a.observable(c.storedQueryPath),this.tableType=a.observable(c.tableType),this.captionDisplay=a.computed(d.bind(null,this)),this.idUndecorated=a.computed(e.bind(null,this)),this.aliasDisplay=a.computed({read:f.bind(null,this),write:g.bind(null,this)})}function d(a){var b=a.caption();if(b)return 0===b.indexOf("[")||0===b.indexOf("{")?b.substring(1,b.length-1):b}function e(a){var b=a.id();if(b)return 0===b.indexOf("[")||0===b.indexOf("{")?b.substring(1,b.length-1):b}function f(a){return a.alias()||a.captionDisplay()}function g(a,b){b=b.replace(/ /g,"_").replace(/\(/g,"").replace(/\)/g,"").replace(/-/g,"_"),a.alias(b)}return c});
define('query/adapters/table-design-adapter',['require','../services/dto/table-design-dto','../model/table-design-model','./column-adapter'],function(require){"use strict";var a=require("../services/dto/table-design-dto"),b=require("../model/table-design-model"),c=require("./column-adapter");function d(){}return d.toModelObject=function a(c){return new b(c)},d.toModelObjectArray=function a(b){var c=0,d=[];if(b&&b.length){for(c=0;c!==b.length;c++)d.push(this.toModelObject(b[c]));return d}},d.toDTO=function d(e){var f=new a;return e=e||new b,f.alias=e.alias()||null,f.caption=e.caption()||null,f.defaultCaption=e.defaultCaption()||null,f.datasheetId=e.datasheetId(),f.id=e.id(),f.key=e.key(),f.layoutX=e.layoutX(),f.layoutY=e.layoutY(),f.name=e.name(),f.queryColumns=c.toDTOArray(e.queryColumns()),f.showAllFields=e.showAllFields(),f.showDataFields=e.showDataFields(),f.showInactiveFields=e.showInactiveFields(),f.showSystemFields=e.showSystemFields(),f.storedQueryPath=e.storedQueryPath(),f.tableType=e.tableType(),f},d.toDTOArray=function a(b){var c=0,d=[];if(b&&b.length){for(c=0;c!==b.length;c++)d.push(this.toDTO(b[c]))
;return d}},d});
define('query/services/dto/expression-dto',['require','system/lang/converter'],function(require){"use strict";var a=require("system/lang/converter");function b(b){b=b||{},this.conditionOperator=a.toString(b.conditionOperator),this.operator=a.toString(b.operator),this.value=b.dateValue?a.toDate(b.dateValue):a.toString(b.value),this.dateValue=a.toDate(b.dateValue)}return b.fromDataCollection=function a(c){if(c){var d,e=[];for(d=0;d<c.length;d++)e[e.length]=new b(c[d]);return e}},b});

define('text!query/expression-simple-operators.json',[],function () { return '{\r\n    "Character": [\r\n        { "text": "EXPR_SIMPLE_OPERATOR_EQUALS", "value": "Equal", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_NOT_EQUALS", "value": "NotEqual", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_CONTAINS", "value": "Contains", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_NOT_CONTAINS", "value": "DoesNotContain", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_STARTS_WITH", "value": "StartsWith", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_ENDS_WITH", "value": "EndsWith", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_IS_NULL", "value": "IsNull", "valueNeeded": false },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_IS_NOT_NULL", "value": "IsNotNull", "valueNeeded": false }\r\n    ],\r\n\r\n    "Character-dh": [\r\n        { "text": "EXPR_SIMPLE_OPERATOR_EQUALS", "value": "Equal", "valueNeeded": true }\r\n    ],\r\n\r\n    "Numeric": [\r\n        { "text": "EXPR_SIMPLE_OPERATOR_EQUALS", "value": "Equal", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_IS_ATMOST", "value": "EqualOrLessThan", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_IS_ATLEAST", "value": "EqualOrGreaterThan", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_NOT_EQUALS", "value": "NotEqual", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_IS_LESS_THAN", "value": "LessThan", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_IS_GREATER_THAN", "value": "GreaterThan", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_IS_NULL", "value": "IsNull", "valueNeeded": false },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_IS_NOT_NULL", "value": "IsNotNull", "valueNeeded": false }\r\n    ],\r\n\r\n    "Numeric-dh": [\r\n        { "text": "EXPR_SIMPLE_OPERATOR_EQUALS", "value": "Equal", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_IS_ATMOST", "value": "EqualOrLessThan", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_IS_ATLEAST", "value": "EqualOrGreaterThan", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_IS_LESS_THAN", "value": "LessThan", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_IS_GREATER_THAN", "value": "GreaterThan", "valueNeeded": true }\r\n    ],\r\n\r\n    "Date": [\r\n        { "text": "EXPR_SIMPLE_OPERATOR_ON", "value": "DayOf", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_IS_AT", "value": "Equal", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_IS_AT_OR_BEFORE", "value": "EqualOrLessThan", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_IS_AT_OR_AFTER", "value": "EqualOrGreaterThan", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_IS_NOT_AT", "value": "NotEqual", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_BEFORE", "value": "LessThan", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_AFTER", "value": "GreaterThan", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_IS_NULL", "value": "IsNull", "valueNeeded": false },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_IS_NOT_NULL", "value": "IsNotNull", "valueNeeded": false }\r\n    ],\r\n\r\n    "Date-dh": [\r\n        { "text": "EXPR_SIMPLE_OPERATOR_IS_AT", "value": "Equal", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_IS_AT_OR_BEFORE", "value": "EqualOrLessThan", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_IS_AT_OR_AFTER", "value": "EqualOrGreaterThan", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_BEFORE", "value": "LessThan", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_AFTER", "value": "GreaterThan", "valueNeeded": true }\r\n    ],\r\n\r\n    "Boolean": [\r\n        { "text": "EXPR_SIMPLE_OPERATOR_IS_TRUE", "value": "True", "valueNeeded": false },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_IS_FALSE", "value": "False", "valueNeeded": false },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_IS_NULL", "value": "IsNull", "valueNeeded": false },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_IS_NOT_NULL", "value": "IsNotNull", "valueNeeded": false }\r\n    ],\r\n\r\n    "Boolean-dh": [\r\n        { "text": "EXPR_SIMPLE_OPERATOR_IS_TRUE", "value": "True", "valueNeeded": false },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_IS_FALSE", "value": "False", "valueNeeded": false }\r\n    ],\r\n\r\n    "Text": [\r\n        { "text": "EXPR_SIMPLE_OPERATOR_EQUALS", "value": "Equal", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_NOT_EQUALS", "value": "NotEqual", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_CONTAINS", "value": "Contains", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_NOT_CONTAINS", "value": "DoesNotContain", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_STARTS_WITH", "value": "StartsWith", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_ENDS_WITH", "value": "EndsWith", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_IS_NULL", "value": "IsNull", "valueNeeded": false },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_IS_NOT_NULL", "value": "IsNotNull", "valueNeeded": false }\r\n    ],\r\n\r\n    "Text-dh": [\r\n        { "text": "EXPR_SIMPLE_OPERATOR_EQUALS", "value": "Equal", "valueNeeded": true }\r\n    ],\r\n\r\n    "Unknown": [\r\n        { "text": "EXPR_SIMPLE_OPERATOR_EQUALS", "value": "Equal", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_NOT_EQUALS", "value": "NotEqual", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_IS_NULL", "value": "IsNull", "valueNeeded": false },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_IS_NOT_NULL", "value": "IsNotNull", "valueNeeded": false }\r\n    ],\r\n\r\n    "Unknown-dh": [\r\n        { "text": "EXPR_SIMPLE_OPERATOR_EQUALS", "value": "Equal", "valueNeeded": true }\r\n    ]\r\n}\r\n';});

define('query/model/expression-simple-operator-model',['require','system/globalization/translator'],function(require){"use strict";var a=require("system/globalization/translator");function b(b){b=b||{};var c=Object.resolve(a);this.text=c.translate(b.text),this.value=b.value,this.valueNeeded=b.valueNeeded!==!1,this.dataType=b.dataType}return b});
define('query/model/expression-simple-operator-list',['require','ramda','text!../expression-simple-operators.json','./expression-simple-operator-model'],function(require){"use strict";var a=require("ramda"),b=require("text!../expression-simple-operators.json"),c=require("./expression-simple-operator-model");function d(a){a&&a.length?this.items=a.map(e):this.items=[]}function e(a){return new c(a)}d.loadOperatorsForDataType=function a(c){return c=c||"Unknown",f(c,JSON.parse(b)[c])};function f(b,c){var e=g(b);return new d(a.map(e,c))}var g=a.curry(function a(b,c){return c.dataType=b,c});return d});
define('query/adapters/expression-simple-operator-adapter',['require','ramda','../model/expression-simple-operator-list'],function(require){"use strict";var a=require("ramda"),b=require("../model/expression-simple-operator-list");function c(){}var d=a.propEq("value");return c.toModelObject=function c(e,f){var g=b.loadOperatorsForDataType(f);return a.find(d(e),g.items)},c.toModelObjectArray=function a(b,d){return b.map(function(a,b){return c.toModelObject(a,b)})},c});
define('query/model/expression-model',['require','knockout','../adapters/expression-simple-operator-adapter','system/lang/converter'],function(require){"use strict";var a=require("knockout"),b=require("../adapters/expression-simple-operator-adapter"),c=require("system/lang/converter");function d(b,d){b=b||{},this.conditionOperator=a.observable(b.conditionOperator),this.value=a.observable(b.value),this.dataType=a.observable(d),"Date"===d&&this.value(c.toDate(b.dateValue)),this.operator=a.observable(e(b,d)),this.valueNeeded=a.computed(f.bind(null,this)),this.operator.subscribe(g.bind(null,this)),this.template=a.computed(h.bind(null,this))}function e(a,c){return a.operator?b.toModelObject(a.operator,c):null}function f(a){return!a.operator()||a.operator().valueNeeded}function g(a,b){a.valueNeeded()?"Date"!==b.dataType||a.value()||a.value(new Date):a.value(null)}function h(a){switch(a.dataType()){case"Date":return a.operator()&&"DayOf"===a.operator().value?"exp-bld-simple-date-template":"exp-bld-simple-datetime-template";case"Boolean":return"exp-bld-simple-boolean-template";default:
return"exp-bld-simple-text-template"}}return d.prototype.toString=function a(){return this.operator()?(this.conditionOperator()?this.conditionOperator()+" ":"")+this.operator().value+(this.value()?" '"+this.value()+"'":""):""},d});
define('query/adapters/expression-adapter',['require','../services/dto/expression-dto','../model/expression-model','system/lang/converter'],function(require){"use strict";var a=require("../services/dto/expression-dto"),b=require("../model/expression-model"),c=require("system/lang/converter");function d(){}return d.toModelObject=function a(c,d){return new b(c,d)},d.toModelObjectArray=function a(b,c){var e=0,f=[];if(b&&b.length){for(e=0;e!==b.length;e++)f.push(d.toModelObject(b[e],c));return f}},d.toDTO=function b(d){var e=new a;return d=d||{},e.conditionOperator=d.conditionOperator()||"",e.operator=d.operator()?d.operator().value||"":"",e.value=d.value(),d.value()&&d.value()instanceof Date&&(e.dateValue=c.toDateString(d.value(),"yyyy-MM-ddTHH:mm:ss.fff")),e},d.toDTOArray=function a(b){var c=0,e=[];if(b&&b.length){for(c=0;c!==b.length;c++)e.push(d.toDTO(b[c]));return e}},d});
define('query/model/query-criteria-model',['require','knockout','../adapters/expression-adapter'],function(require){"use strict";var a=require("knockout"),b=require("../adapters/expression-adapter");function c(c,d){c=c||{},this.expressions=a.observableArray(b.toModelObjectArray(c.expressions,d))}return c.prototype.toString=function a(){var b=0,c="",d="";for(b=0;b<this.expressions().length;b++)d=this.expressions()[b].toString(),c+=d.length>0?d+" ":"";return c},c});
define('query/adapters/query-criteria-adapter',['require','../services/dto/query-criteria-dto','../model/query-criteria-model','./expression-adapter'],function(require){"use strict";var a=require("../services/dto/query-criteria-dto"),b=require("../model/query-criteria-model"),c=require("./expression-adapter");function d(){}return d.toModelObject=function a(c,d){return c?new b(c,d):null},d.toModelObjectArray=function a(b,c){var e=0,f=[];if(!b||!b.length)return f;for(e=0;e!==b.length;e++)f.push(d.toModelObject(b[e],c));return f},d.toDTO=function b(d){if(!d)return null;var e=new a;return d=d||{},e.expressions=c.toDTOArray(d.expressions()),e},d.toDTOArray=function a(b){var c=0,d=[];if(!b||!b.length)return d;for(c=0;c!==b.length;c++)d.push(this.toDTO(b[c]));return d},d});
define('query/model/column-design-model',['require','knockout','../adapters/column-adapter','../adapters/query-criteria-adapter'],function(require){"use strict";var a=require("knockout"),b=require("../adapters/column-adapter"),c=require("../adapters/query-criteria-adapter");function d(d){d=d||{},this.alias=a.observable(d.alias),this.caption=a.observable(d.caption),this.defaultCaption=a.observable(d.defaultCaption),this.criterias=a.observableArray(d.criterias),this.crosstab=a.observable(d.crosstab),this.dataType=a.observable(d.dataType),this.display=a.observable(d.display),this.expressionText=a.observable(d.expressionText),this.hyperlink=a.observable(d.hyperlink),this.id=a.observable(d.id),this.include=a.observable(d.include),this.key=a.observable(d.key),this.layoutWidth=a.observable(d.layoutWidth),this.resultFilterExpression=a.observable(d.resultFilterExpression),this.sortIndex=a.observable(d.sortIndex),this.sortOrder=a.observable(d.sortOrder),this.tableDesignKey=a.observable(d.tableDesignKey),this.total=a.observable(d.total),this.appendTo=a.observable(b.toModelObject(d.appendTo)),
this.updateTo=a.observable(d.updateTo),this.simpleCriteria=a.observableArray([]),this.simpleCriteria(c.toModelObjectArray(d.simpleCriteria,this.dataType())),this.captionDisplay=a.computed(e.bind(null,this)),this.idUndecorated=a.computed(f.bind(null,this)),this.isSelected=a.observable(!1),this.include.subscribe(g.bind(null,this)),this.display.subscribe(h.bind(null,this)),this.expressionText.subscribe(i.bind(null,this))}function e(a){var b=a.caption();if(b)return 0===b.indexOf("[")?b.substring(1,b.length-1):b}function f(a){var b=a.id();if(b)return 0===b.indexOf("[")?b.substring(1,b.length-1):b}function g(a){a&&a.include&&null!==a.include()&&void 0!==a.include()&&(a.include()||a.display(!1))}function h(a){a&&a.display&&null!==a.display()&&void 0!==a.display()&&a.display()&&a.include(!0)}function i(a){a&&a.expressionText&&a.expressionText()&&a.tableDesignKey("")}return d});
define('query/adapters/column-design-adapter',['require','../services/dto/column-design-dto','../model/column-design-model','../adapters/column-adapter','./query-criteria-adapter'],function(require){"use strict";var a=require("../services/dto/column-design-dto"),b=require("../model/column-design-model"),c=require("../adapters/column-adapter"),d=require("./query-criteria-adapter");function e(){}return e.toModelObject=function a(c){return new b(c)},e.toModelObjectArray=function a(b){var c=0,d=[];if(!b||!b.length)return d;for(c=0;c!==b.length;c++)d.push(this.toModelObject(b[c]));return d},e.toDTO=function b(e){var f=new a;return e=e||{},f.alias=e.alias()||null,f.caption=e.caption()||null,f.defaultCaption=e.defaultCaption()||null,f.criterias=e.criterias(),f.crosstab=e.crosstab(),f.dataType=e.dataType(),f.display=e.display(),f.expressionText=e.expressionText(),f.hyperlink=e.hyperlink(),f.id=e.id()||null,f.include=e.include(),f.key=e.key(),f.layoutWidth=e.layoutWidth(),f.resultFilterExpression=e.resultFilterExpression(),f.sortIndex=e.sortIndex(),f.sortOrder=e.sortOrder(),f.tableDesignKey=e.tableDesignKey(),f.total=e.total(),f.appendTo=c.toDTO(e.appendTo()),
f.updateTo=e.updateTo(),f.simpleCriteria=d.toDTOArray(e.simpleCriteria()),f},e.toDTOArray=function a(b){var c=0,d=[];if(b&&b.length){for(c=0;c!==b.length;c++)d.push(this.toDTO(b[c]));return d}},e});
define('query/model/operand-model',['require','knockout'],function(require){"use strict";var a=require("knockout");function b(b){b=b||{},this.tableDesignKey=a.observable(b.tableDesignKey),this.columnId=a.observable(b.columnId),this.charOperand=a.observable(b.charOperand)}return b});
define('query/adapters/operand-adapter',['require','../services/dto/operand-dto','../model/operand-model'],function(require){"use strict";var a=require("../services/dto/operand-dto"),b=require("../model/operand-model");function c(){}return c.toModelObject=function a(c){return new b(c)},c.toModelObjectArray=function a(b){var c=0,d=[];if(b&&b.length){for(c=0;c!==b.length;c++)d.push(this.toModelObject(b[c]));return d}},c.toDTO=function b(c){var d=new a;return c=c||{},d.tableDesignKey=c.tableDesignKey(),d.columnId=c.columnId(),d.charOperand=c.charOperand(),d},c.toDTOArray=function a(b){var c=0,d=[];if(b&&b.length){for(c=0;c!==b.length;c++)d.push(this.toDTO(b[c]));return d}},c});
define('query/model/condition-model',['require','knockout','../adapters/operand-adapter'],function(require){"use strict";var a=require("knockout"),b=require("../adapters/operand-adapter");function c(c){c=c||{},this.leftOperand=a.observable(b.toModelObject(c.leftOperand)),this.operator=a.observable(c.operator),this.rightOperand=a.observable(b.toModelObject(c.rightOperand)),this.nextOperator=a.observable(c.nextOperator)}return c});
define('query/adapters/condition-adapter',['require','../services/dto/condition-dto','../model/condition-model','../adapters/operand-adapter'],function(require){"use strict";var a=require("../services/dto/condition-dto"),b=require("../model/condition-model"),c=require("../adapters/operand-adapter");function d(){}return d.toModelObject=function a(c){return new b(c)},d.toModelObjectArray=function a(b){var c=0,d=[];if(b&&b.length){for(c=0;c!==b.length;c++)d.push(this.toModelObject(b[c]));return d}},d.toDTO=function b(d){var e=new a;return d=d||{},e.leftOperand=c.toDTO(d.leftOperand()),e.operator=d.operator(),e.rightOperand=c.toDTO(d.rightOperand()),e.nextOperator=d.nextOperator(),e},d.toDTOArray=function a(b){var c=0,d=[];if(b&&b.length){for(c=0;c!==b.length;c++)d.push(this.toDTO(b[c]));return d}},d});
define('query/model/join-design-model',['require','knockout','system/globalization/translator','../adapters/condition-adapter'],function(require){"use strict";var a=require("knockout"),b=require("system/globalization/translator"),c=require("../adapters/condition-adapter");function d(d){d=d||{},this.translator=Object.resolve(b),this.conditions=a.observableArray(c.toModelObjectArray(d.conditions)),this.isMiJoin=a.observable(d.isMiJoin),this.joinSucc=a.observable(d.joinSucc),this.joinType=a.observable(d.joinType),this.key=a.observable(d.key),this.leftDesignKey=a.observable(d.leftDesignKey),this.relDesignKey=a.observable(d.relDesignKey),this.rightDesignKey=a.observable(d.rightDesignKey),this.joinDesignKey=a.observable(d.joinDesignKey),this.jointLinkIds=[],this.leftDesignName=a.observable(this.leftDesignKey()),this.rightDesignName=a.observable(this.rightDesignKey()),this.relDesignName=a.observable(this.relDesignKey()),this.predDesignKey=a.computed(e.bind(null,this)),this.succDesignKey=a.computed(f.bind(null,this)),this.predDesignName=a.computed(g.bind(null,this)),
this.succDesignName=a.computed(h.bind(null,this)),this.innerDescription=a.computed(k.bind(null,this)),this.leftDescription=a.computed(l.bind(null,this)),this.rightDescription=a.computed(m.bind(null,this)),this.predColumnId=a.computed(i.bind(null,this)),this.succColumnId=a.computed(j.bind(null,this))}function e(a){return a.joinSucc()?a.leftDesignKey():a.rightDesignKey()}function f(a){return a.joinSucc()?a.rightDesignKey():a.leftDesignKey()}function g(a){return a.joinSucc()?a.leftDesignName():a.rightDesignName()}function h(a){return a.joinSucc()?a.rightDesignName():a.leftDesignName()}function i(a){if(a.conditions&&a.conditions()[0]&&a.conditions()[0].leftOperand&&a.conditions()[0].leftOperand()&&a.conditions()[0].leftOperand().columnId)return a.joinSucc()?a.conditions()[0].leftOperand().columnId():a.conditions()[0].rightOperand().columnId()}function j(a){
if(a.conditions&&a.conditions()[0]&&a.conditions()[0].rightOperand&&a.conditions()[0].rightOperand()&&a.conditions()[0].rightOperand().columnId)return a.joinSucc()?a.conditions()[0].rightOperand().columnId():a.conditions()[0].leftOperand().columnId()}function k(a){return a.isMiJoin()?n(a,"QUERY_EDITOR_INNER_MI_JOIN_DESC_PREFIX")+" '"+a.relDesignName()+"'":n(a,"QUERY_EDITOR_INNER_JOIN_DESC")}function l(a){return a.isMiJoin()?n(a,"QUERY_EDITOR_JOIN_INC_PRED_DESC_PREFIX")+" '"+a.leftDesignName()+"' "+n(a,"QUERY_EDITOR_JOIN_INC_SUCC_DESC_PREFIX")+" '"+a.rightDesignName()+"' "+n(a,"QUERY_EDITOR_JOIN_INC_MI_REL_DESC_PREFIX")+" '"+a.relDesignName()+"'":n(a,"QUERY_EDITOR_JOIN_INC_PRED_DESC_PREFIX")+" '"+a.leftDesignName()+"' "+n(a,"QUERY_EDITOR_JOIN_INC_SUCC_DESC_PREFIX")+" '"+a.rightDesignName()+"' "+n(a,"QUERY_EDITOR_JOIN_INC_REL_DESC")}function m(a){
return a.isMiJoin()?n(a,"QUERY_EDITOR_JOIN_INC_PRED_DESC_PREFIX")+" '"+a.rightDesignName()+"' "+n(a,"QUERY_EDITOR_JOIN_INC_SUCC_DESC_PREFIX")+" '"+a.leftDesignName()+"' "+n(a,"QUERY_EDITOR_JOIN_INC_MI_REL_DESC_PREFIX")+" '"+a.relDesignName()+"'":n(a,"QUERY_EDITOR_JOIN_INC_PRED_DESC_PREFIX")+" '"+a.rightDesignName()+"' "+n(a,"QUERY_EDITOR_JOIN_INC_SUCC_DESC_PREFIX")+" '"+a.leftDesignName()+"' "+n(a,"QUERY_EDITOR_JOIN_INC_REL_DESC")}function n(a,b){return a.translator.translate(b)}return d});
define('query/adapters/join-design-adapter',['require','../services/dto/join-design-dto','../model/join-design-model','../adapters/condition-adapter'],function(require){"use strict";var a=require("../services/dto/join-design-dto"),b=require("../model/join-design-model"),c=require("../adapters/condition-adapter");function d(){}return d.toModelObject=function a(c){return new b(c)},d.toModelObjectArray=function a(b){var c=0,d=[];if(b&&b.length){for(c=0;c!==b.length;c++)d.push(this.toModelObject(b[c]));return d}},d.toDTO=function b(d){var e=new a;return d=d||{},e.conditions=c.toDTOArray(d.conditions()),e.isMiJoin=d.isMiJoin(),e.joinSucc=d.joinSucc(),e.joinType=d.joinType(),e.key=d.key(),e.leftDesignKey=d.leftDesignKey(),e.relDesignKey=d.relDesignKey(),e.rightDesignKey=d.rightDesignKey(),e.joinDesignKey=d.joinDesignKey(),e},d.toDTOArray=function a(b){var c=0,d=[];if(b&&b.length){for(c=0;c!==b.length;c++)d.push(this.toDTO(b[c]));return d}},d});
define('query/model/parameter-container-model',['require','knockout','../adapters/parameter-design-adapter'],function(require){"use strict";var a=require("knockout"),b=require("../adapters/parameter-design-adapter");function c(c){c=c||{},this.hasDependencies=a.observable(c.hasDependencies),this.parameterDesigns=a.observableArray(b.toModelObjectArray(c.parmDesigns))}return c});
define('query/adapters/parameter-container-adapter',['require','../services/dto/parameter-container-dto','../model/parameter-container-model','../adapters/parameter-design-adapter'],function(require){"use strict";var a=require("../services/dto/parameter-container-dto"),b=require("../model/parameter-container-model"),c=require("../adapters/parameter-design-adapter");function d(){}return d.toModelObject=function a(c){return new b(c)},d.toModelObjectArray=function a(b){var c=0,d=[];if(b&&b.length){for(c=0;c!==b.length;c++)d.push(this.toModelObject(b[c]));return d}},d.toDTO=function b(d){var e;return d?(e=new a,e.hasDependencies=d.hasDependencies(),e.parmDesigns=c.toDTOArray(d.parameterDesigns()),e):null},d.toDTOArray=function a(b){var c=0,d=[];if(b&&b.length){for(c=0;c!==b.length;c++)d.push(this.toDTO(b[c]));return d}},d});
define('query/model/query-container-model',['require','lodash','knockout','system/lang/unique-id','../adapters/table-design-adapter','../adapters/column-design-adapter','catalog/services/catalog-constants','../adapters/join-design-adapter','../adapters/parameter-container-adapter','system/lang/object'],function(require){"use strict";var a=require("lodash"),b=require("knockout"),c=require("system/lang/unique-id"),d=require("../adapters/table-design-adapter"),e=require("../adapters/column-design-adapter"),f=require("catalog/services/catalog-constants"),g=require("../adapters/join-design-adapter"),h=require("../adapters/parameter-container-adapter");require("system/lang/object"),b.extenders.numeric=function(a,c){var d=b.computed({read:a,write:function(b){var d=a(),e=Math.pow(10,c),f=isNaN(b)?0:parseFloat(+b),g=Math.round(f*e)/e;g!==d?a(g):b!==d&&a.notifySubscribers(g)}}).extend({notify:"always"});return d(a()),d};function i(a){a=a||{},this.catalogConstants=Object.resolve(f),a.tableDesigns=j(a.tableDesigns,a.joinDesigns),this.columnDesigns=b.observableArray(e.toModelObjectArray(a.columnDesigns)),this.isCaseInsensitive=b.observable(a.isCaseInsensitive),this.isChanged=b.observable(a.isChanged),this.isDeleteForce=b.observable(a.isDeleteForce),
this.isDistinct=b.observable(a.isDistinct),this.isFormatted=b.observable(a.isFormatted),this.isTop=b.observable(a.isTop),this.isUomVisible=b.observable(a.isUomVisible),this.joinDesigns=b.observableArray(g.toModelObjectArray(a.joinDesigns)),this.pageSize=b.observable(a.pageSize),this.parameterContainer=b.observable(h.toModelObject(a.parmContainer)),this.queryText=b.observable(a.queryText),this.queryType=b.observable(a.queryType),this.showTotals=b.observable(a.showTotals),this.sqlChanged=b.observable(a.sqlChanged),this.designChanged=b.observable(a.designChanged),this.startPage=b.observable(a.startPage),this.catalogPath=b.observable(a.catalogPath),this.tableDesigns=b.observableArray(d.toModelObjectArray(a.tableDesigns)),this.topRows=b.observable(a.topRows).extend({numeric:0}),this.uniqueId=b.observable(a.uniqueId||c.createV1()),this.asyncQueryRowLimit=b.observable(a.asyncQueryRowLimit),this.appendSource=b.observable(d.toModelObject(a.appendSource)),
this.predecessorSource=b.observable(d.toModelObject(a.predecessorSource)),this.successorSource=b.observable(d.toModelObject(a.successorSource)),this.designStatus=b.observable(a.designStatus),this.loadStatus=b.observable(a.loadStatus),this.queryTypeInt=b.computed(l.bind(null,this)),this.isDesignable=b.computed(m.bind(null,this)),this.maxCriteria=b.computed(k.bind(null,this)),this.tableDesigns.subscribe(n.bind(null,this),null,"arrayChange"),this.columnDesigns.subscribe(t.bind(null,this),null,"arrayChange"),this.joinDesigns.subscribe(w.bind(null,this),null,"arrayChange"),this.showTotals.subscribe(y.bind(null,this)),this.showTotals.subscribe(x.bind(null,this)),this.isDistinct.subscribe(x.bind(null,this)),this.appendSource.subscribe(z.bind(null,this)),A(this)}function j(b,c){var d=0,e,f,g=[],h=[],i=[];if(b){if(!c||!c.length)return b;for(d=0;d<c.length;d++)e=c[d],g.push(e.leftDesignKey),e.isMiJoin&&g.push(e.relDesignKey),g.push(e.rightDesignKey)
;for(d=0;d<g.length;d++)f=a.find(b,C.bind(null,g[d])),h.push(f);return a.union(h,b)}}function k(a){var b=0,c=0,d=0;for(b=0;b!==a.columnDesigns().length;b++)(c=a.columnDesigns()[b].criterias().length)>d&&(d=c);return d}function l(a){switch(a.queryType()){case"Select":return a.catalogConstants.QUERY_TYPE_SELECT;case"Update":return a.catalogConstants.QUERY_TYPE_UPDATE;case"Delete":return a.catalogConstants.QUERY_TYPE_DELETE;case"Append":return a.catalogConstants.QUERY_TYPE_APPEND;case"Transform":return a.catalogConstants.QUERY_TYPE_TRANSFORM;case"Crosstab":return a.catalogConstants.QUERY_TYPE_TRANSFORM;case"Datahub":return a.catalogConstants.QUERY_TYPE_AGGREGATE;default:return a.catalogConstants.QUERY_TYPE_NONE}}function m(a){var b=a.designStatus();return!!(!b||"Loaded"===b)}function n(b,c){var d=a.filter(c,o.bind(null,b)),e=a.filter(c,p.bind(null,b)),f=0,g=[],h,i=q(b.tableDesigns()),j=!1;for(f=0;f<e.length;f++)h=e[f].value,(!h.key()||parseInt(h.key(),10)<=0)&&(h.key(i),i++),
g=a.filter(b.tableDesigns(),r.bind(null,b,h.aliasDisplay())),g.length>1&&h.aliasDisplay(h.captionDisplay()+" "+g.length),"Datahub"===h.tableType()&&(j=!0);for(j?b.queryType("Datahub"):"Datahub"===b.queryType()&&b.queryType("Select"),f=0;f<d.length;f++)b.columnDesigns.remove(s.bind(null,b,d[f].value.key()))}function o(a,b){return"deleted"===b.status}function p(a,b){return"added"===b.status}function q(a){var b=0,c=0,d=0;for(b=0;b<a.length;b++)d=parseInt(a[b].key(),10),c=c<d?d:c;return(c+1).toString()}function r(a,b,c){return b===c.captionDisplay()}function s(a,b,c){return!!c.tableDesignKey()&&c.tableDesignKey().toString()===b.toString()}function t(b,c){var d=a.filter(c,p.bind(null,b)),e,f=0,g=q(b.columnDesigns());for(f=0;f<d.length;f++)e=d[f].value,u(b,e),(!e.key()||parseInt(e.key(),10)<=0)&&(e.key(g),g++),e.sortOrder()&&""!==e.sortOrder()||e.sortOrder("None"),e.sortIndex()&&""!==e.sortIndex()||e.sortIndex("0")}function u(b,c){if(!c.alias())return void c.alias("")
;if(!(a.filter(b.columnDesigns(),function(a){return a.alias()||a.alias(""),a.alias().toLowerCase()===c.alias().toLowerCase()}).length<=1)){var d=0,e;for(e=v(b,c,d);e;)d++,e=v(b,c,d);c.alias(c.alias()+d.toString())}}function v(b,c,d){return a.find(b.columnDesigns(),function(a){return a.alias().toLowerCase()===c.alias().toLowerCase()+d.toString()})}function w(b,c){var d=a.filter(c,p.bind(null,b)),e,f=0,g=q(b.joinDesigns());for(f=0;f<d.length;f++)e=d[f].value,parseInt(e.key(),10)<=0&&(e.key(g),g++),B(b,e,b.tableDesigns()),e.leftDesignName(),e.relDesignName(),e.rightDesignName()}function x(a){a&&a.showTotals&&a.isDistinct&&(a.showTotals()||a.isDistinct())&&a.isFormatted(!1)}function y(a,b){var c=0,d;for(c=0;c<a.columnDesigns().length;c++)d=a.columnDesigns()[c],b?d.total(d.include()?"GroupBy":"Where"):d.total("")}function z(a){var b=0,c;for(b=0;b<a.columnDesigns().length;b++)c=a.columnDesigns()[b],c.appendTo(null)}function A(a){var b=0,c
;for(b=0;b<a.joinDesigns().length;b++)c=a.joinDesigns()[b],B(a,c)}function B(c,d){var e=c.tableDesigns();d.leftDesignName(b.unwrap(a.find(e,C.bind(null,d.leftDesignKey())).caption)),d.rightDesignName(b.unwrap(a.find(e,C.bind(null,d.rightDesignKey())).caption)),d.isMiJoin()&&d.relDesignName(b.unwrap(a.find(e,C.bind(null,d.relDesignKey())).caption))}function C(a,c){return b.unwrap(c.key).toString()===a.toString()}return i});
define('query/adapters/query-container-adapter',['require','../services/dto/query-container-dto','../model/query-container-model','./table-design-adapter','./column-design-adapter','./join-design-adapter','./parameter-container-adapter'],function(require){"use strict";var a=require("../services/dto/query-container-dto"),b=require("../model/query-container-model"),c=require("./table-design-adapter"),d=require("./column-design-adapter"),e=require("./join-design-adapter"),f=require("./parameter-container-adapter");function g(){}return g.toModelObject=function a(c){return new b(c)},g.toDTO=function b(g){var h=new a;return g=g||{},h.columnDesigns=d.toDTOArray(g.columnDesigns()),h.isCaseInsensitive=g.isCaseInsensitive(),h.isChanged=g.isChanged(),h.isDeleteForce=g.isDeleteForce(),h.isDistinct=g.isDistinct(),h.isFormatted=g.isFormatted(),h.isTop=g.isTop(),h.isUomVisible=g.isUomVisible(),h.joinDesigns=e.toDTOArray(g.joinDesigns()),h.pageSize=g.pageSize(),h.parmContainer=f.toDTO(g.parameterContainer()),h.queryText=g.queryText(),h.queryType=g.queryType(),h.showTotals=g.showTotals(),h.sqlChanged=g.sqlChanged(),h.designChanged=g.designChanged(),h.startPage=g.startPage(),h.catalogPath=g.catalogPath(),
h.tableDesigns=c.toDTOArray(g.tableDesigns()),h.topRows=g.topRows(),h.uniqueId=g.uniqueId(),h.asyncQueryRowLimit=g.asyncQueryRowLimit(),h.appendSource=c.toDTO(g.appendSource()),h.predecessorSource=c.toDTO(g.predecessorSource()),h.successorSource=c.toDTO(g.successorSource()),h.designStatus=g.designStatus(),h.loadStatus=g.loadStatus(),h},g.cloneDTO=function(b){var c=JSON.stringify(b);return new a(JSON.parse(c))},g});
define('query/model/query-state-model',['require','knockout','../adapters/query-container-adapter'],function(require){"use strict";var a=require("knockout"),b=require("../adapters/query-container-adapter");function c(c){c=c||{},this.version=c.version||2,this.queryContainer=a.observable(b.toModelObject(c.queryContainer)),this.selectedTableDesign=a.observable(),this.selectedJoinDesign=a.observable()}return c});
define('query/adapters/query-state-adapter',['require','../services/dto/query-state-dto','../model/query-state-model','./query-container-adapter'],function(require){"use strict";var a=require("../services/dto/query-state-dto"),b=require("../model/query-state-model"),c=require("./query-container-adapter");function d(){}return d.toModelObject=function a(c){if(c&&c.version)return new b(c)},d.toModelObjectArray=function a(b){var c=0,d=[];if(b&&b.length){for(c=0;c!==b.length;c++)d.push(this.toModelObject(b[c]));return d}},d.toDTO=function b(d){var e=new a;return d=d||{},e.version=d.version,e.queryContainer=c.toDTO(d.queryContainer()),e},d.toDTOArray=function a(b){var c=0,d=[];if(b&&b.length){for(c=0;c!==b.length;c++)d.push(this.toDTO(b[c]));return d}},d});
define('query/execution/query-execution-engine',['require','jquery','ramda','application/application-events','system/error/error-message','system/globalization/translator','../services/query-service','catalog/services/catalog-service','catalog/services/dto/catalog-item-dto','catalog/services/catalog-constants','../services/dto/query-state-dto','../services/dto/query-container-dto','./query-prompt-dialog','../adapters/query-state-adapter','../adapters/query-result-adapter'],function(require){"use strict";var a=require("jquery"),b=require("ramda"),c=require("application/application-events"),d=require("system/error/error-message"),e=require("system/globalization/translator"),f=require("../services/query-service"),g=require("catalog/services/catalog-service"),h=require("catalog/services/dto/catalog-item-dto"),i=require("catalog/services/catalog-constants"),j=require("../services/dto/query-state-dto"),k=require("../services/dto/query-container-dto"),l=require("./query-prompt-dialog"),m=require("../adapters/query-state-adapter"),n=require("../adapters/query-result-adapter");function o(a){this._appEvents=Object.resolve(c),this._translator=Object.resolve(e),this._catConstants=Object.resolve(i),this._promptDialog=Object.resolve(l),this.queryService=Object.resolve(f),this.catalogService=Object.resolve(g),this.executionMode=null,this._dfd=null,a&&(p(this,a),this._opt=a)}o.prototype.execute=function b(c){var d,e=c||{};switch(this._dfd=a.Deferred(),
this.executionMode){case"SqlStatement":d=e.evalOnly?y.bind(null,this,e,this._opt.sqlStatement):s.bind(null,this,e,this._opt.sqlStatement);break;case"CatalogItemKey":d=e.evalOnly?M.bind(null,this,e,this._opt.catalogItemKey):G.bind(null,this,e,this._opt.catalogItemKey);break;case"CatalogItem":d=e.evalOnly?D.bind(null,this,e,this._opt.catalogItem):A.bind(null,this,e,this._opt.catalogItem);break;case"QueryContainer":d=e.evalOnly?R.bind(null,this,e,this._opt.queryContainer):O.bind(null,this,e,this._opt.queryContainer);break;default:throw this._translator.translate("QUERY_EXEC_UNKNOWN_MODE")}return d(),this._dfd.promise()},o.prototype.prompt=function b(c){var d;switch(this._dfd=a.Deferred(),c=c||{},this.executionMode){case"SqlStatement":d=t.bind(null,this,c,this._opt.sqlStatement);break;case"CatalogItemKey":d=H.bind(null,this,c,this._opt.catalogItemKey);break;case"CatalogItem":d=B.bind(null,this,c,this._opt.catalogItem);break;case"QueryContainer":
d=P.bind(null,this,c,this._opt.queryContainer);break;default:throw this._translator.translate("QUERY_EXEC_UNKNOWN_MODE")}return d(),this._dfd.promise()},o.prototype.compile=function b(c){var d;switch(this._dfd=a.Deferred(),this.executionMode){case"SqlStatement":d=u.bind(null,this,{},this._opt.sqlStatement);break;case"CatalogItemKey":d=I.bind(null,this,{},this._opt.catalogItemKey);break;case"CatalogItem":d=C.bind(null,this,{},this._opt.catalogItem);break;case"QueryContainer":d=Q.bind(null,this,{},this._opt.queryContainer);break;default:throw this._translator.translate("QUERY_EXEC_UNKNOWN_MODE")}return d(),this._dfd.promise()};function p(a,b){return b.catalogItemKey?void(a.executionMode="CatalogItemKey"):b.catalogItem?(q(a,b.catalogItem),void(a.executionMode="CatalogItem")):b.queryContainer?(r(a,b.queryContainer),void(a.executionMode="QueryContainer")):b.sqlStatement?void(a.executionMode="SqlStatement"):void 0}function q(a,b){
if(!(b instanceof h))throw a._translator.translate("QUERY_EXEC_INVALID_CAT_ITEM");if(b.itemType!==a._catConstants.ITEM_TYPE_QUERY)throw a._translator.translate("QUERY_EXEC_INVALID_CAT_ITEM");if(!b.query)throw a._translator.translate("QUERY_EXEC_INVALID_CAT_ITEM");if(!b.query.source)throw a._translator.translate("QUERY_EXEC_INVALID_CAT_ITEM")}function r(a,b){if(!(b instanceof k))throw a._translator.translate("QUERY_EXEC_INVALID_QUERY_CONT")}function s(a,b,c){a.queryService.compileString(c).done(v.bind(null,a,b)).fail(ea.bind(null,a))}function t(a,b,c){a.queryService.compileString(c).done(w.bind(null,a,b)).fail(ea.bind(null,a))}function u(a,b,c){a.queryService.compileString(c).done(x.bind(null,a,b)).fail(ea.bind(null,a))}function v(a,b,c){O(a,b,c)}function w(a,b,c){P(a,b,c)}function x(a,b,c){a._dfd.resolve(c)}function y(a,b,c){a.queryService.compileString(c).done(z.bind(null,a,b)).fail(ea.bind(null,a))}function z(a,b,c){R(a,b,c)}function A(a,b,c){var d=c.query.layout,e=new j(d)
;d&&d.queryContainer?O(a,b,e.queryContainer):s(a,b,c.query.source)}function B(a,b,c){var d=c.query.layout,e=new j(d);d&&d.queryContainer?P(a,b,e.queryContainer):t(a,b,c.query.source)}function C(a,b,c){var d=c.query.layout,e=new j(d);d&&d.queryContainer?Q(a,b,e.queryContainer):u(a,b,c.query.source)}function D(a,b,c){var d=c.query.layout,e=new j(d);d&&d.queryContainer?R(a,b,e.queryContainer):y(a,b,c.query.source)}function E(a,b,c){s(a,b,"(! '"+c+"')")}function F(a,b,c){y(a,b,"(! '"+c+"')")}function G(a,b,c){a.catalogService.getCatalogItem(c).done(J.bind(null,a,b)).fail(ea.bind(null,a))}function H(a,b,c){a.catalogService.getCatalogItem(c).done(K.bind(null,a,b)).fail(ea.bind(null,a))}function I(a,b,c){a.catalogService.getCatalogItem(c).done(L.bind(null,a,b)).fail(ea.bind(null,a))}function J(a,b,c){A(a,b,c)}function K(a,b,c){B(a,b,c)}function L(a,b,c){C(a,b,c)}function M(a,b,c){a.catalogService.getCatalogItem(c).done(N.bind(null,a,b)).fail(ea.bind(null,a))}function N(a,b,c){D(a,b,c)}
function O(a,b,c){b.suppressPrompts?Y(a,b,c):S(a,b,c).done(W.bind(null,a,b,c)).fail(a._dfd.reject)}function P(a,b,c){b.parameters&&c.parmContainer&&c.parmContainer.copyPromptValues(b.parameters),S(a,b,c).done(X.bind(null,a,b,c)).fail(a._dfd.reject)}function Q(a,b,c){a._dfd.resolve(c)}function R(a,b,c){b.suppressPrompts?$(a,b,c):S(a,b,c).done(Z.bind(null,a,b,c)).fail(a._dfd.reject)}function S(b,c,d){var e=a.Deferred();return T(d)?b.queryService.compileContainerParameters(d).then(V.bind(null,b),ea.bind(null,b)):(e.resolve(d.parmContainer),e.promise())}function T(a){var c,d,e;return c=a.parmContainer,d=c?c.parmDesigns:null,(e=d?b.filter(U,d):null)&&e.length>0}function U(a){return!a.isHidden}function V(a,b){return a._promptDialog.show({queryContainer:b})}function W(a,b,c,d){c.parmContainer=d,Y(a,b,c)}function X(a,b,c,d){c.parmContainer=d,a._dfd.resolve(c)}function Y(a,b,c){b&&(c.pageSize=b.pageSize||c.pageSize,c.startPage=b.startPage||c.startPage,
c.parmContainer=b.parameters||c.parmContainer,b.queryContainer&&(c.columnDesigns=b.queryContainer.columnDesigns||c.columnDesigns)),"Select"===c.queryType||"Crosstab"===c.queryType?b.sync?a.queryService.executeQueryContainerSync(c).done(ca.bind(null,a,c)).fail(ea.bind(null,a)):a.queryService.executeQueryContainer(c).done(ba.bind(null,a,c)).fail(ea.bind(null,a)):a.queryService.evaluateQueryContainer(c).done(aa.bind(null,a,b,c)).fail(ea.bind(null,a))}function Z(a,b,c,d){c.parmContainer=d,$(a,b,c)}function $(a,b,c){b&&(c.parmContainer=b.parameters||c.parmContainer),a.queryService.evaluateQueryContainer(c).done(_.bind(null,a,c)).fail(ea.bind(null,a))}function _(a,b,c){a._dfd.resolve({queryContainer:b,rowCount:c})}function aa(a,b,c,d){b.sync?a.queryService.executeQueryContainerSync(c).done(da.bind(null,a,c,d)).fail(ea.bind(null,a)):a.queryService.executeQueryContainer(c).done(da.bind(null,a,c,d)).fail(ea.bind(null,a))}function ba(a,b,c){a._dfd.resolve({queryContainer:b,rowset:c})}
function ca(a,b,c){a._dfd.resolve({queryContainer:b,result:n.toModel(c)})}function da(a,b,c){a._dfd.resolve({queryContainer:b,rowCount:c})}function ea(a,b){var c=2,e=d.fromHttpResponse(c,b);a._appEvents.errorOccured.raise(a,e),a._dfd.reject()}return o});
define('catalog/model/recent-item',['require','lodash','catalog/services/dto/user-pref-dto','application/application-context','system/lang/converter','system/text/formatter'],function(require){"use strict";var a=require("lodash"),b=require("catalog/services/dto/user-pref-dto"),c=require("application/application-context"),d=require("system/lang/converter"),e=Object.resolve(require("system/text/formatter")),f=25,g="f";function h(){this.createDate="",this.key="",this.ownerId="",this.path="",this.caption=""}h.fromPreferenceData=function(a,c){return a&&a.key?i(new b(a),c):[]};function i(a,b){return j(JSON.parse(a.value),b)}function j(a,b){return a.map(b)}h.toResultSet=function(b,c){return{columns:b,data:a.invokeMap(c,"toRow").reverse()}},h.prototype.addToCollection=function(b){return a.remove(b,{key:Number(this.key)}),a.remove(b,{path:this.path}),b.push(this),b=k(b)};function k(a){return a.length>f&&a.shift(),a}return h.prototype.populateFromData=function(a){this.createDate=a.createDate,this.key=a.key,this.ownerId=a.ownerId,this.path=a.path,this.caption=a.caption},h.prototype.populateFromCatalogItem=function(a){this.createDate=a.updateDate,this.key=a.key,
this.ownerId=a.updatorDisplay,this.path=a.path,this.caption=a.caption},h.prototype.toRow=function(){var a={},b=d.toDate(this.createDate);return a.creator=d.toString(this.ownerId),a.date=e.format(b,g),a.caption=this.caption,a},h});
define('catalog/model/recent-dashboard',['require','./recent-item'],function(require){"use strict";var a=require("./recent-item");function b(){c.call(this),this.dashboardid=""}var c=Object.inherit(a,b);b.fromPreferenceData=function(b){return a.fromPreferenceData(b,d)};function d(a){var c=new b;return c.populateFromData(a),c}return b.fromCatalogItem=function(a){var c=new b;return c.populateFromCatalogItem(a),c},b.prototype.populateFromData=function(a){c.prototype.populateFromData.apply(this,arguments),this.dashboardid=a.dashboardid},b.prototype.populateFromCatalogItem=function(a){c.prototype.populateFromCatalogItem.apply(this,arguments),this.dashboardid=a.id},b.prototype.toRow=function(){var a=c.prototype.toRow.apply(this);return a.name=this.dashboardid,a.path="<a href='#dashboard/"+this.key+"'>"+this.path+"</a>",a},b});
define('catalog/model/recent-query',['require','./recent-item'],function(require){"use strict";var a=require("./recent-item");function b(){c.call(this),this.queryid=""}var c=Object.inherit(a,b);b.fromPreferenceData=function(b){return a.fromPreferenceData(b,d)};function d(a){var c=new b;return c.populateFromData(a),c}return b.fromCatalogItem=function(a){var c=new b;return c.populateFromCatalogItem(a),c},b.prototype.populateFromData=function(a){c.prototype.populateFromData.apply(this,arguments),this.queryid=a.queryid},b.prototype.populateFromCatalogItem=function(a){c.prototype.populateFromCatalogItem.apply(this,arguments),this.queryid=a.id},b.prototype.toRow=function(){var a=c.prototype.toRow.apply(this);return a.name="<a href='#qdetail/"+this.key+"'>"+this.queryid+"</a>",a.path="<a href='#query/"+this.key+"'>"+this.path+"</a>",a},b});
define('catalog/model/recent-graph',['require','./recent-item'],function(require){"use strict";var a=require("./recent-item");function b(){c.call(this),this.graphid=""}var c=Object.inherit(a,b);b.fromPreferenceData=function(b){return a.fromPreferenceData(b,d)};function d(a){var c=new b;return c.populateFromData(a),c}return b.fromCatalogItem=function(a){var c=new b;return c.populateFromCatalogItem(a),c},b.prototype.populateFromData=function(a){c.prototype.populateFromData.apply(this,arguments),this.graphid=a.graphid},b.prototype.populateFromCatalogItem=function(a){c.prototype.populateFromCatalogItem.apply(this,arguments),this.graphid=a.id},b.prototype.toRow=function(){var a=c.prototype.toRow.apply(this);return a.name="<a href='#graph-preview/"+this.key+"'>"+this.graphid+"</a>",a.path="<a href='#graph/"+this.key+"'>"+this.path+"</a>",a},b});
define('catalog/model/recent-report',['require','./recent-item'],function(require){"use strict";var a=require("./recent-item");function b(){c.call(this),this.reportid=""}var c=Object.inherit(a,b);b.fromPreferenceData=function(b){return a.fromPreferenceData(b,d)};function d(a){var c=new b;return c.populateFromData(a),c}return b.fromCatalogItem=function(a){var c=new b;return c.populateFromCatalogItem(a),c},b.prototype.populateFromData=function(a){c.prototype.populateFromData.apply(this,arguments),this.reportid=a.reportid},b.prototype.populateFromCatalogItem=function(a){c.prototype.populateFromCatalogItem.apply(this,arguments),this.reportid=a.id},b.prototype.toRow=function(){var a=c.prototype.toRow.apply(this);return a.name=this.reportid,a.path="<a href='#ssrs/viewer/"+this.path+"'>"+this.path+"</a>",a},b});
define('catalog/model/recent-rscript',['require','./recent-item'],function(require){"use strict";var a=require("./recent-item");function b(){c.call(this),this.rscriptid=""}var c=Object.inherit(a,b);b.fromPreferenceData=function(b){return a.fromPreferenceData(b,d)};function d(a){var c=new b;return c.populateFromData(a),c}return b.fromCatalogItem=function(a){var c=new b;return c.populateFromCatalogItem(a),c},b.prototype.populateFromData=function(a){c.prototype.populateFromData.apply(this,arguments),this.rscriptid=a.rscriptid},b.prototype.populateFromCatalogItem=function(a){c.prototype.populateFromCatalogItem.apply(this,arguments),this.rscriptid=a.id},b.prototype.toRow=function(){var a=c.prototype.toRow.apply(this);return a.name=this.rscriptid,a.path="<a href='#rscript/"+this.key+"'>"+this.path+"</a>",a},b});
define('catalog/model/recent-script',['require','./recent-item'],function(require){"use strict";var a=require("./recent-item");function b(){c.call(this),this.scriptId=""}var c=Object.inherit(a,b);b.fromPreferenceData=function(b){return a.fromPreferenceData(b,d)};function d(a){var c=new b;return c.populateFromData(a),c}return b.fromCatalogItem=function(a){var c=new b;return c.populateFromCatalogItem(a),c},b.prototype.populateFromData=function(a){c.prototype.populateFromData.apply(this,arguments),this.scriptId=a.scriptId},b.prototype.populateFromCatalogItem=function(a){c.prototype.populateFromCatalogItem.apply(this,arguments),this.scriptId=a.id},b.prototype.toRow=function(){var a=c.prototype.toRow.apply(this);return a.name=this.scriptId,a.path='<a href="#script/'+this.key+'">'+this.path+"</a>",a},b});
define('catalog/model/recent-dataset',['require','exports','module','./recent-item'],function(require,exports,module){"use strict";var a=require("./recent-item");function b(){c.call(this),this.datasetid=""}var c=Object.inherit(a,b);b.fromPreferenceData=function(b){return a.fromPreferenceData(b,d)};function d(a){var c=new b;return c.populateFromData(a),c}return b.fromCatalogItem=function(a){var c=new b;return c.populateFromCatalogItem(a),c},b.prototype.populateFromData=function(a){c.prototype.populateFromData.apply(this,arguments),this.datasetid=a.datasetid},b.prototype.populateFromCatalogItem=function(a){c.prototype.populateFromCatalogItem.apply(this,arguments),this.datasetid=a.id},b.prototype.toRow=function(){var a=c.prototype.toRow.apply(this);return a.name=this.datasetid,a.path="<a href='#dataset/"+this.key+"'>"+this.path+"</a>",a},b});
define('catalog/model/recent-map',['require','./recent-item'],function(require){"use strict";var a=require("./recent-item");function b(){c.call(this),this.queryid=""}var c=Object.inherit(a,b);b.fromPreferenceData=function(b){return a.fromPreferenceData(b,d)};function d(a){var c=new b;return c.populateFromData(a),c}return b.fromCatalogItem=function(a){var c=new b;return c.populateFromCatalogItem(a),c},b.prototype.populateFromData=function(a){c.prototype.populateFromData.apply(this,arguments),this.queryid=a.queryid},b.prototype.populateFromCatalogItem=function(a){c.prototype.populateFromCatalogItem.apply(this,arguments),this.queryid=a.id},b.prototype.toRow=function(){var a=c.prototype.toRow.apply(this);return a.name="<a href='#map/"+this.key+"'>"+this.queryid+"</a>",a.path="<a href='#query/"+this.key+"' target='_blank'>"+this.path+"</a>",a},b});
define('catalog/model/recent-advanced-search',['require','./recent-item'],function(require){"use strict";var a=require("./recent-item");function b(){c.call(this),this.advancedSearchId=""}var c=Object.inherit(a,b);b.fromPreferenceData=function(b){return a.fromPreferenceData(b,d)};function d(a){var c=new b;return c.populateFromData(a),c}return b.fromCatalogItem=function(a){var c=new b;return c.populateFromCatalogItem(a),c},b.prototype.populateFromData=function(a){c.prototype.populateFromData.apply(this,arguments),this.advancedSearchId=a.advancedSearchId},b.prototype.populateFromCatalogItem=function(a){c.prototype.populateFromCatalogItem.apply(this,arguments),this.advancedSearchId=a.id},b.prototype.toRow=function(){var a=c.prototype.toRow.apply(this);return a.name=this.advancedSearchId,a.path="<a href='#advsearch/"+this.key+"'>"+this.path+"</a>",a},b});
define('catalog/services/recent-item-service',['require','knockout','bluebird','application/application-context','catalog/services/dto/user-pref-dto','catalog/services/catalog-service','catalog/services/catalog-constants','catalog/model/recent-dashboard','catalog/model/recent-query','catalog/model/recent-graph','catalog/model/recent-report','catalog/model/recent-rscript','catalog/model/recent-script','catalog/model/recent-dataset','catalog/model/recent-map','catalog/model/recent-advanced-search'],function(require){"use strict";var a=require("knockout"),b=require("bluebird"),c=require("application/application-context"),d=require("catalog/services/dto/user-pref-dto"),e=require("catalog/services/catalog-service"),f=require("catalog/services/catalog-constants"),g=require("catalog/model/recent-dashboard"),h=require("catalog/model/recent-query"),i=require("catalog/model/recent-graph"),j=require("catalog/model/recent-report"),k=require("catalog/model/recent-rscript"),l=require("catalog/model/recent-script"),m=require("catalog/model/recent-dataset"),n=require("catalog/model/recent-map"),o=require("catalog/model/recent-advanced-search"),p="RecentOpenDashboard",q="RecentOpenQuery",r="RecentOpenChart",s="RecentOpenReport",t="RecentOpenRScript",u="RecentOpenDataset",v="RecentOpenMap",w="RecentOpenScripts",x="RecentOpenAdvancedSearch";function y(){this.catalogService=Object.resolve(e),this.constants=new f}y.prototype.getDashboards=function(){
return z(this,p).then(g.fromPreferenceData)};function z(a,d){return b.resolve(a.catalogService.getPreference(c.user.key,d))}y.prototype.getQueries=function(){return z(this,q).then(h.fromPreferenceData)},y.prototype.getGraphs=function(){return z(this,r).then(i.fromPreferenceData)},y.prototype.getReports=function(){return z(this,s).then(j.fromPreferenceData)},y.prototype.getRScripts=function(){return z(this,t).then(k.fromPreferenceData)},y.prototype.getScripts=function(){return z(this,w).then(l.fromPreferenceData)},y.prototype.getDatasets=function(){return z(this,u).then(m.fromPreferenceData)},y.prototype.getMaps=function(){return z(this,v).then(n.fromPreferenceData)},y.prototype.getAdvancedSearches=function(){return z(this,x).then(o.fromPreferenceData)},y.prototype.addDashboardByKey=function(a){var c=[A(this,a),this.getDashboards()];return b.all(c).then(C).then(D.bind(null,this))};function A(a,b){return B(a,b).then(g.fromCatalogItem)}function B(a,c){
return b.resolve(a.catalogService.getCatalogItem(c))}function C(a){var b=a[0],c=a[1];return b.addToCollection(c),c}function D(a,b){return E(a,p,b)}function E(c,d,e){var f=F(c,d,a.toJSON(e));return b.resolve(c.catalogService.setPreference(f))}function F(a,b,e){var f=new d;return f.userKey=c.user.key,f.prefType=a.constants.CATALOG_PREFERENCE,f.name=b,f.value=e,f}y.prototype.addQueryByKey=function(a){var c=[G(this,a),this.getQueries()];return b.all(c).then(C).then(H.bind(null,this))};function G(a,b){return B(a,b).then(h.fromCatalogItem)}function H(a,b){return E(a,q,b)}y.prototype.addAdvancedSearchByKey=function(a){var c=[I(this,a),this.getAdvancedSearches()];return b.all(c).then(C).then(J.bind(null,this))};function I(a,b){return B(a,b).then(o.fromCatalogItem)}function J(a,b){return E(a,x,b)}y.prototype.addGraphByKey=function(a){var c=[K(this,a),this.getGraphs()];return b.all(c).then(C).then(L.bind(null,this))};function K(a,b){return B(a,b).then(i.fromCatalogItem)}function L(a,b){
return E(a,r,b)}y.prototype.addReportByPath=function(a){var c=[M(this,a),this.getReports()];return b.all(c).then(C).then(O.bind(null,this))};function M(a,b){return N(a,b).then(j.fromCatalogItem)}function N(a,c){return b.resolve(a.catalogService.getCatalogItemByPath(c))}function O(a,b){return E(a,s,b)}y.prototype.addRScriptByKey=function(a){var c=[P(this,a),this.getRScripts()];return b.all(c).then(C).then(Q.bind(null,this))};function P(a,b){return B(a,b).then(k.fromCatalogItem)}function Q(a,b){return E(a,t,b)}y.prototype.addScript=function(a){var c=[R(this,a),this.getScripts()];return b.all(c).then(C).then(T.bind(null,this))},y.prototype.addScriptByKey=function(a){var c=[S(this,a),this.getScripts()];return b.all(c).then(C).then(T.bind(null,this))};function R(a,b){return l.fromCatalogItem(b)}function S(a,b){return B(a,b).then(l.fromCatalogItem)}function T(a,b){return E(a,w,b)}y.prototype.addDatasetByKey=function(a){var c=[U(this,a),this.getDatasets()]
;return b.all(c).then(C).then(V.bind(null,this))};function U(a,b){return B(a,b).then(m.fromCatalogItem)}function V(a,b){return E(a,u,b)}y.prototype.addMapByKey=function(a){var c=[W(this,a),this.getMaps()];return b.all(c).then(C).then(X.bind(null,this))};function W(a,b){return B(a,b).then(n.fromCatalogItem)}function X(a,b){return E(a,v,b)}return y});
define('ui/elements/page-filter/page-filter-remote',['require','jquery'],function(require){"use strict";var a=require("jquery");function b(){this.pageFilter=null}b.prototype.connect=function a(b){this.pageFilter=c(b)};function c(b){var c;return c=a(b).closest("mi-page-filter").get(0)||null,null===c?a(b).closest("mi-et-page-filter").get(0)||null:c}return b.prototype.isConnected=function a(){return null!==this.pageFilter},b});
define('ui/elements/page-filter/page-filter-connection',['require','./page-filter-remote'],function(require){"use strict";var a=require("./page-filter-remote");function b(){this.callback=null,this.element=null,this.filter=null,this.remote=Object.resolve(a)}return b.prototype.open=function a(b,c){this.callback=b,this.element=c,this.remote.connect(c),this.filter=this.remote.pageFilter,this.remote.isConnected()?this.filter.connect(this):this.publish()},b.prototype.close=function a(){this.filter&&this.filter.disconnect(this),this.filter=null,this.element=null,this.callback=null},b.prototype.publish=function a(b){this.callback(b)},b.prototype.isSame=function a(b){return this===b},b});
define('system/knockout/bindings/property',['require','lodash','jquery','knockout'],function(require){"use strict";var a=require("lodash"),b=require("jquery"),c=require("knockout"),d="property-changed-event-handlers";c.bindingHandlers.property||(c.bindingHandlers.property={init:function(e,f){var g,h=b(e),i={};a.each(f(),function(b,c){g=function(b,d){var e=f()[c];a.isFunction(e)&&e(d)},i[c]=g,h.on("attributes."+c+":changed",g),h.on("properties."+c+":changed",g)}),c.utils.domData.set(e,d,i),c.utils.domNodeDisposal.addDisposeCallback(e,function(){var b=c.utils.domData.get(e,d);a.each(f(),function(a,c){h.off("attributes."+c+":changed",b[c]),h.off("properties."+c+":changed",b[c])})})},update:function(b,d){var e;a.each(d(),function(a,d){e=c.unwrap(a),b[d]=e})}})});
define('system/lang/element',['require','lodash','jquery','jquery','knockout','system/lang/converter','system/knockout/knockout-manager','system/knockout/bindings/halt-bindings','system/knockout/bindings/property'],function(require){"use strict";var a=require("lodash"),b=require("jquery"),c=require("jquery"),d=require("knockout"),e=require("system/lang/converter"),f=require("system/knockout/knockout-manager");require("system/knockout/bindings/halt-bindings"),require("system/knockout/bindings/property"),Element.registeredElements={};function g(){var a=Array.prototype.slice.call(arguments,0),b=a[0];Element.registeredElements[b]?console.warn("Attemted to register element "+b+" after it was already registered"):(document.registerElement.apply(document,a),Element.registeredElements[b]=!0)}function h(a,b){var c=Object.create(HTMLElement.prototype);c.createdCallback=function(){this.implementation=Object.resolve(b),this.implementation.element=this,Object.tryMethod(this.implementation,"created")},c.attachedCallback=function(){Object.tryMethod(this.implementation,"attached")},c.detachedCallback=function(){Object.tryMethod(this.implementation,"detached")},c.attributeChangedCallback=function(a,b,c){
Object.tryMethod(this.implementation,a+"Changed",b,c)},document.registerElement(a,{prototype:c})}var i=function(){function a(a,b,c){this.kom=Object.resolve(f),this.properties=[],this.view=a,this.preserveContext=b||!1,this.appendAfterBindings=c||!1,this.container=null,this.element=null}a.prototype.created=function(){Object.tryMethod(this,"beforeCreated"),c(this),Object.tryMethod(this,"afterCreated")},a.prototype.attached=function(){Object.tryMethod(this,"beforeAttached"),e(this),Object.tryMethod(this,"afterAttached")},a.prototype.detached=function(){Object.tryMethod(this,"beforeDetached"),g(this),Object.tryMethod(this,"afterDetached")},a.prototype.bindAttribute=function(a,c,d){this[a]=this.kom.observable(),this[a+"Changed"]=function(b,c){this[a](c)}.bind(this),this.kom.subscribe(this[a],function(c){b(this.element).trigger("attributes."+a+":changed",[c])},this),d&&this.kom.subscribe(this[a],d,this),this[a](Object.defaultValue(this.element.getAttribute(a),c))},
a.prototype.bindProperty=function(a,c,d,e){this[a]=this.kom.observable();var f=e||!1;Object.defineProperty(this.element,a,{get:function(){return this[a]()}.bind(this),set:function(b){this[a](b)}.bind(this)}),this.properties.push(a),this.kom.subscribe(this[a],function(c){f||b(this.element).trigger("properties."+a+":changed",[c])},this),d&&this.kom.subscribe(this[a],d,this),this[a](Object.defaultValue(this.element[a],c))},a.prototype.bindArrayProperty=function(a,c,d,e){this[a]=this.kom.observableArray();var f=e||!1;Object.defineProperty(this.element,a,{get:function(){return this[a]()}.bind(this),set:function(b){this[a](b)}.bind(this)}),this.properties.push(a),this.kom.subscribe(this[a],function(c){f||b(this.element).trigger("properties."+a+":changed",[c])},this),d&&this.kom.subscribe(this[a],d,this),this[a](Object.defaultValue(this.element[a],c))};function c(a){var c=document.createElement("div"),d=b(c),e=b(a.view);a.preserveContext||d.attr("data-bind","halt-bindings"),d.append(e),
a.appendAfterBindings||b(a.element).empty().append(d),a.container=c}function e(a){d.applyBindingsToDescendants(a,a.container),a.appendAfterBindings&&b(a.element).empty().append(a.container)}function g(a){d.cleanNode(a.container),b(a.container).remove(),a.kom.dispose(),a.properties.forEach(h.bind(null,a))}function h(a,b){delete a[b]}return a}();function j(b,d){window.CustomElements&&(window.CustomElements.useNative||(a.isArray(b)?k(b,d):a.isString(b)?l(b,d):b instanceof c?m(b):n(b)))}function k(a,b){for(var c=0;c!==a.length;c++)j(a[c],b)}function l(a,c){c&&c.$element&&(c=c.$element),m(b(a,c))}function m(a){a.each(function(a,b){n(b)})}function n(a){window.CustomElements.upgrade(a)}function o(b,c,d,e,f){var g,h=document.createElement(b);if(d)for(g=0;g!==d.length;g++)h.classList.add(d[g]);return e&&a.each(e,function(a,b){e.hasOwnProperty(b)&&h.setAttribute(b,a)}),f&&(h.textContent=f),c&&c.appendChild(h),h}function p(a,b){return null!==a.getAttribute(b)}function q(a,b,c){
var d=a.getAttribute(b);return d?e.toInteger(d):c}function r(a,b,c){var d=a.getAttribute(b);return d?e.toString(d):c}function s(a){for(;a.firstChild;)a.removeChild(a.firstChild)}function t(a,b,c){var d=a[b];Object.defineProperty(a,b,c),a[b]=d}function u(a,b,c){a.dispatchEvent(new CustomEvent(b,{detail:c}))}function v(a){a.parentNode&&a.parentNode.removeChild(a)}var w={registerElement:g,register:h,ViewModel:i,upgrade:j,build:o,booleanAttribute:p,intAttribute:q,stringAttribute:r,clearDom:s,defineProperty:t,raiseEvent:u,detach:v};return b.extend(Element,w),w});
define('query/query-screen',["require","exports","ramda","system/lang/ioc","system/lang/object","system/functional/maybe","application/application-events","application/application-context","system/knockout/knockout-manager","spa/knockout/knockout-view-model","system/globalization/translator","system/error/error-message","text!./views/query-screen.html","query/query-editor-events","query/execution/query-execution-engine","query/services/dto/query-container-dto","catalog/services/recent-item-service","catalog/services/catalog-service","ui/elements/page-filter/page-filter-connection","system/lang/element"],function(require,exports,a,b,c,d,e,f,g,h,i,j){"use strict"
;var k=require("query/query-editor-events"),l=require("query/services/dto/query-container-dto"),m=require("catalog/services/recent-item-service"),n=require("catalog/services/catalog-service"),o=require("ui/elements/page-filter/page-filter-connection"),p=require("system/lang/element"),q=require("text!./views/query-screen.html"),r=require("system/lang/url-codec");require("ui/elements/resultgrid/resultgrid-view-model");var s=function(b){return a.or(a.isNil(b),a.isEmpty(b))},t=function(b){__extends(e,b);function e(a,d){var e=b.call(this,q)||this;return e.kom=new g,e.applicationEvents=a,e.queryEvents=c.resolve(k),e.translator=d,e.recentItemService=c.resolve(m),e.catalogService=c.resolve(n),e.pageFilterConnection=c.resolve(o),e.region=null,e.key=e.kom.observable(""),e.query=e.kom.observable(null),e.cachedQueryContainer=e.kom.observable(null),e.resultGrid=null,e.pageFilter=null,e.pageFilterState=null,e.queryExecMode="queryContainer",e.queryString=e.kom.observable(""),e}
return e.prototype.open=function(){this.applicationEvents.titleChanged.raise(u(this,"QUERY"),this)},e.prototype.attach=function(a){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(c){switch(c.label){case 0:return b.prototype.attach.call(this,a),this.pageFilter=a.element.querySelector("mi-page-filter"),this.pageFilter&&(p.upgrade(this.pageFilter),this.pageFilter.loadState(this.pageFilterState),this.pageFilter.setAttribute("validate-dash-parameters",!0),s(this.queryString())||this.pageFilter.setAttribute("query-string",this.queryString())),this.resultGrid=a.element.querySelector("mi-resultgrid"),this.resultGrid&&(p.upgrade(this.resultGrid),this.resultGrid.suppressPrompts(!0),this.resultGrid.queryExecutedCB=z.bind(null,this),this.resultGrid.setAttribute("queryexecutionmode",this.queryExecMode),this.resultGrid.setAttribute("showprint",!0)),[4,this.catalogItems()];case 1:return c.sent(),[2]}})})},e.prototype.catalogItems=function(){
return __awaiter(this,void 0,void 0,function(){var b,c,e,f,g;return __generator(this,function(c){switch(c.label){case 0:return c.trys.push([0,5,,6]),a.isNil(this.cachedQueryContainer())?(b=d.just,[4,v(this)]):[3,2];case 1:return[2,b.apply(void 0,[c.sent()])];case 2:return e=d.just,[4,y(this)];case 3:return[2,e.apply(void 0,[c.sent()])];case 4:return[3,6];case 5:return g=c.sent(),[2,d.nothing()];case 6:return[2]}})})},e.prototype.activate=function(){f.help.helpContext="../Subsystems/Queries/Content/QueryWorkflow.htm"},e.prototype.load=function(a,b){this.key(a.key),b&&(delete b.__isQueryString__,this.queryString(r.encode(b)))},e.prototype.detach=function(a){this.region=null,this.pageFilterConnection.close(),this.pageFilterState=this.pageFilter.saveState(),this.pageFilter=null},e}(h);t=__decorate([b.dependsOn(e,i)],t);function u(a,b){return a.translator.translate(b)}function v(b){a.when(a.or(a.isNil,a.equals("0")),a.always(!1))(b.key())&&(b.recentItemService.addQueryByKey(b.key()),
b.catalogService.getCatalogItem(b.key()).then(w.bind(null,b)).then(x.bind(null,b)).fail(A.bind(null,b,null)))}function w(a,b){var c=b.caption||b.defaultCaption||b.id,d=b.query.layout.queryContainer.parmContainer;return a.applicationEvents.titleChanged.raise(c,a),a.pageFilter.setAttribute("filter-id","query-screen/"+a.key()),d&&d.parmDesigns&&a.pageFilter.setAttribute("filter",b.path),a.pageFilter.setAttribute("caption",c),a.pageFilter.reload(),b.query.layout}function x(a,b){var c=new l(b.queryContainer);a.query(c),a.resultGrid.queryContainerObject=c,a.resultGrid.refresh(c)}function y(a){a.resultGrid.queryContainerObject=a.cachedQueryContainer(),a.resultGrid.refresh(a.cachedQueryContainer())}function z(a,b){var c;c=a.query(),c.parmContainer=b.queryContainer.parmContainer,a.cachedQueryContainer(c),a.queryEvents.queryExecuted.raise(b)}function A(a,b,c){var d=2,e=j.fromHttpResponse(d,c);a.applicationEvents.errorOccured.raise(a,e),b&&b.reject()}return t});
