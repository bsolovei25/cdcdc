/* Copyright Â© 1993-2019 Meridium, Inc. All rights reserved.  */
define(function(require){"use strict";var a=require("lodash"),b=require("system/lang/converter"),c=require("knockout");function d(){var a=this;a.key=void 0,a.id=void 0,a.description=void 0,a.lastMeasurementDate=void 0,a.prevMeasurementDate=void 0,a.lastMeasurementValue=void 0,a.prevMeasurementValue=void 0,a.lastMeasurementScore=void 0,a.prevMeasurementScore=void 0,a.lastMeasurementColor=void 0,a.prevMeasurementColor=void 0,a.lastMeasurementRange=void 0,a.prevMeasurementRange=void 0,a.delta=void 0,a.deltaPercentage=void 0,a.deltaScore=void 0,a.deltaScorePercentage=void 0,a.measurementRange=[],a.history=[],a.lastUpdate=void 0,a.lastScheduledUpdate=void 0,a.nextScheduledUpdate=void 0,a.numberFormat="n0",a.children=[],a.canView=c.observable(),a.canUpdate=c.observable(),a.canDelete=c.observable(),a.scorecards=c.observableArray(),a.parent=c.observable(),a.lastUpdateDate=void 0,a.lastUpdateBy=void 0,a.showScore=!1,a.chartType="Dial"}d.prototype.loadFromDTO=function c(d){if(d){var g=this
;g.key=d.key,g.id=d.id,g.description=d.description,g.numberFormat=d.numberFormat?d.numberFormat:"n0",g.lastMeasurementDate=b.toNullableDate(d.lastMeasurementDate),g.prevMeasurementDate=b.toNullableDate(d.prevMeasurementDate),g.lastMeasurementValue=d.lastMeasurementValue,g.prevMeasurementValue=d.prevMeasurementValue,g.lastMeasurementScore=d.lastMeasurementScore,g.prevMeasurementScore=d.prevMeasurementScore,g.lastMeasurementColor=d.lastMeasurementColor,g.prevMeasurementColor=d.prevMeasurementColor,g.lastMeasurementRange=d.lastMeasurementRange,g.prevMeasurementRange=d.prevMeasurementRange,g.currentUserPrivilege=d.currentUserPrivilege,g.showScore=d.showScore,g.bestAndWorstEqual=d.bestAndWorstEqual,g.chartType=d.chartType,a.isFinite(g.lastMeasurementValue)&&a.isFinite(g.prevMeasurementValue)&&(g.delta=g.lastMeasurementValue-g.prevMeasurementValue,
0===g.prevMeasurementValue&&0!==g.lastMeasurementValue?g.deltaPercentage=1:0===g.delta?g.deltaPercentage=0:g.deltaPercentage=g.delta/Math.abs(g.prevMeasurementValue)),g.showScore&&a.isFinite(g.lastMeasurementScore)&&a.isFinite(g.prevMeasurementScore)&&(g.deltaScore=g.lastMeasurementScore-g.prevMeasurementScore,0===g.prevMeasurementScore&&0!==g.lastMeasurementScore?g.deltaScorePercentage=1:0===g.deltaScore?g.deltaScorePercentage=0:g.deltaScorePercentage=g.deltaScore/Math.abs(g.prevMeasurementScore)),g.lastUpdate=b.toNullableDate(d.lastUpdate),g.lastScheduledUpdate=b.toNullableDate(d.lastScheduledUpdate),g.nextScheduledUpdate=b.toNullableDate(d.nextScheduledUpdate),g.measurementRange=d.measurementRange,g.history=a.map(d.history,e),g.children=a.map(d.children,f),g.canView(d.currentUserPrivilege.canView||d.currentUserPrivilege.canDelete||d.currentUserPrivilege.canUpdate),g.canDelete(d.currentUserPrivilege.canDelete),
g.canUpdate(d.currentUserPrivilege.canUpdate||d.currentUserPrivilege.canDelete),g.scorecards(a.map(d.scorecards,function(a){return{name:a.name,key:a.entityKey}})),g.lastUpdateDate=b.toNullableDate(d.lastUpdateDate),g.lastUpdateBy=d.lastUpdateBy,d.parent&&g.parent({text:d.parent.id,value:d.parent.key})}};function e(a){return{date:b.toNullableDate(a.date),value:a.value,score:a.score,color:a.color,range:a.range}}function f(a){var b=new d;return b.loadFromDTO(a),b}return d});