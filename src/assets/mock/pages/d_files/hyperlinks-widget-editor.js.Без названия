/* Copyright Â© 1993-2019 Meridium, Inc. All rights reserved.  */
define(function a(require){"use strict";var b=require("dashboard/view-models/widget-editor"),c=require("dashboard/models/hyperlink"),d=require("system/ui/message-box"),e=require("dashboard/view-models/url-builder/url-builder"),f=require("dashboard/views/hyperlinks-widget/hyperlinks-widget-editor-view"),g=require("mi-assert");require("ui/elements/localize/localize-element");function h(a){i.call(this,a,f.html),this.editorView=Object.resolve(f),this.selectedHyperlink=this.kom.observable(),this.backup.hyperlinks=this.kom.observableArray()}var i=Object.inherit(b,h);h.prototype.afterLoad=function a(){m(this)},h.prototype.afterSave=function a(){n(this)},h.prototype.afterCancel=function a(){o(this)},h.prototype.afterAttach=function(a){g.ok(a),this.editorView.attach(a),Element.upgrade(a.element.querySelectorAll("mi-localize"))},h.prototype.afterDetach=function a(){this.editorView.detach()},h.prototype.select=function a(b){g.assert(b instanceof c||null===b),this.selectedHyperlink(b)},
h.prototype.add=function a(b){var d=new c(this.widgetVM);j(d,b),l(this).add(d),this.select(d),r(this,d),s(this,d),this.widgetVM.setLayout()};function j(a,b){return b&&"string"==typeof b&&(a.text(b),a.url(b)),a}h.prototype.browse=function(){var a=e.factory(),b=this;a.show().done(k.bind(null,this))};function k(a,b){a.add(b)}h.prototype.remove=function a(b){g.instanceOf(b,c),p(this,b).done(q.bind(null,this,b))},h.prototype.moveUp=function a(b){g.instanceOf(b,c),l(this).moveUp(b),r(this,b)},h.prototype.moveDown=function a(b){g.instanceOf(b,c),l(this).moveDown(b),r(this,b)};function l(a){return g.instanceOf(a,h),a.widgetVM.hyperlinks}function m(a){g.instanceOf(a,h),a.backup.hyperlinks(c.copy(l(a).items()))}function n(a){g.instanceOf(a,h),a.backup.hyperlinks([])}function o(a){g.instanceOf(a,h),l(a).items(a.backup.hyperlinks())}function p(a,b){g.instanceOf(a,h),g.instanceOf(b,c);var e=a.translate("CONFIRM_REMOVE").replace("$0",b.text()),f=a.translate("CONFIRMATION")
;return d.showOkCancel(e,f,"icon-questionmark-popup")}function q(a,b,d){g.instanceOf(a,h,"self"),g.instanceOf(b,c,"hyperlink"),g.isNumber(d),d||(l(a).remove(b),a.select(null))}function r(a,b){g.instanceOf(a,h),g.instanceOf(b,c);var d=l(a).indexOf(b);a.editorView.scrollTo(d)}function s(a,b){g.instanceOf(a,h),g.instanceOf(b,c);var d=l(a).indexOf(b);a.editorView.focus(d)}return h});