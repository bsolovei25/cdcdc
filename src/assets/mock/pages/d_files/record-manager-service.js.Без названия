/* Copyright Â© 1993-2019 Meridium, Inc. All rights reserved.  */
define(function(require){"use strict";var a=require("jquery"),b=require("./dto/rm-relationship-dto"),c=require("./dto/rm-relation-dto"),d=require("./dto/rm-hyperlink-dto"),e=require("../model/rm-entity"),f="api/core/userpref/",g=require("system/globalization/translator");require("system/lang/object");var h=require("system/http/ajax-client"),i="api/internal/recommendations",j="api/core/entity/RM/",k="api/core/relationship/",l="api/core/entity/Urls/",m="api/core/entity/";function n(a){this.ajaxClient=a,this.translator=Object.resolve(g)}return n.dependsOn=[h],n.prototype.getHierarchy=function c(d){var e=j+d,f=a.Deferred();return this.ajaxClient.get(e).done(function(a){a.errorMessage?f.reject(a.errorMessage):f.resolve(new b(a))}).fail(function(a){f.reject(a.responseText)}),f.promise()},n.prototype.removeRelation=function b(d,e,f,g){var h=k+d+"/"+e+"/"+f+"/"+g,i=a.Deferred();return this.ajaxClient.delete(h).done(function(a){i.resolve(new c(a))}).fail(function(a){i.reject(a.responseText)}),
i.promise()},n.prototype.unlinkRecords=function b(d,e){var f=k+"primEntyKey/"+d+"/secEntyKey/"+e,g=a.Deferred();return this.ajaxClient.delete(f).done(function(a){g.resolve(new c(a))}).fail(function(a){g.reject(a.responseText)}),g.promise()},n.prototype.addRelation=function b(d,e,f){var g=k+d+"/predecessorKey/"+e+"/successorKey/"+f,h=a.Deferred();return this.ajaxClient.post(g).done(function(a,b){b.errorMessage?h.reject(b.errorMessage):h.resolve(new c(b))}.bind(null,this)).fail(function(a){h.reject(a.responseText)}),h.promise()},n.prototype.newRelation=function b(c,d,e,f){var g=k+c+"/"+d+"/"+e+"/"+f,h=a.Deferred();return this.ajaxClient.get(g).done(function(a,b){b.errorMessage?h.reject(b.errorMessage):h.resolve(b)}.bind(null,this)).fail(function(a){h.reject(a.responseText)}),h.promise()},n.prototype.addRelationUsingRelFamID=function b(d,e,f){var g=k+d+"/predecessorKey/"+e+"/successorKey/"+f,h=a.Deferred();return this.ajaxClient.post(g).done(function(a){
if(a.errorMessage)throw a.errorMessage;h.resolve(new c(a))}).fail(function(a){h.reject(a.responseText)}),h.promise()},n.prototype.getAssocPages=function b(c){var e=l+c,f=a.Deferred();return this.ajaxClient.get(e).done(function(a){for(var b=[],c=0;c<a.length;c++)b.push(new d(a[c]));f.resolve(b)}).fail(function(a){f.reject(a.responseText)}),f.promise()},n.prototype.getRelatedEntityKeys=function b(c,d,e,f){var g=m+"MDFKeys/"+c+"/"+d+"/"+e+"/"+f,h=a.Deferred();return this.ajaxClient.get(g).done(function(a){h.resolve(a)}).fail(function(){h.reject()}),h.promise()},n.prototype.setPreference=function b(c){var d=a.Deferred(),e=f+"set";return this.ajaxClient.post(e,c).done(d.resolve.bind(null,d)).fail(d.reject.bind(d)),d.promise()},n.prototype.getPreference=function b(c,d){var e=a.Deferred(),g=f+"get/"+c+"/9?name="+d;return this.ajaxClient.get(g,{}).done(function(a){e.resolve(a)}).fail(e.reject.bind(e)),e.promise()},n.prototype.getRecommendationFamily=function b(c){
var d=i+"/recommendationFamily/"+c,f=a.Deferred();return this.ajaxClient.get(d).done(function(a){f.resolve(new e(a))}).fail(function(){f.reject()}),f.promise()},n});