/* Copyright Â© 1993-2019 Meridium, Inc. All rights reserved.  */
define(["require","exports","lodash","ramda","application/application-events","ui/elements/chart/chart-utilities","ui/elements/chart/formatters/chart-formatter-factory","system/lang/converter"],function(require,exports,a,b,c){"use strict";var d=require("system/lang/converter"),e=require("ui/elements/chart/chart-utilities"),f=require("ui/elements/chart/formatters/chart-formatter-factory"),g=window,h=Object;return function(){function i(a,b,c){this.chartUtil=h.resolve(e),this.config=b,this.chartData=null,this.categoryArray=[],this.chartFormatter=f.create(this.config),this.options=this.newChartOptions(a,c),this.formatLegendOptions(),this.MSMoveFix()}return i.prototype.MSMoveFix=function(){if(g.MSPointerEvent&&g.Highcharts.Pointer&&!g.Highcharts.Pointer.MSHighChartMeridium){var a=g.Highcharts.Pointer.prototype.onContainerPointerMove;g.Highcharts.extend(g.Highcharts.Pointer.prototype,{onContainerPointerMove:this.deferMSClicks.bind(null,a),MSHighChartMeridium:!0})}},
i.prototype.deferMSClicks=function(c){var d=arguments;a.defer(c.bind(null,c,b.drop(1,d)))},i.prototype.formatLegendOptions=function(){var a=this.chartUtil.getLegendHorizontalPosition(this.config.legendPosition),b=this.chartUtil.getLegendVerticalPosition(this.config.legendPosition),c="bottom"===b,d="left"===a&&c,e="right"===a&&c,f=d||e,g="stock"===this.config.chartType||"stock-area"===this.config.chartType||"stacked-stock"===this.config.chartType,h="top"===b&&"right"===a&&g,i=f?this.config.series.length*-12:12,j=d?150:10,k=e?150:10,l=d?-150:e?150:0,m=f?{textOverflow:"ellipsis",width:110}:{},n="top"!==b?0:h?70:30;this.options.chart.spacingLeft=j,this.options.chart.spacingRight=k,this.options.legend.margin=i,this.options.legend.x=l,this.options.legend.y=n,this.options.legend.align=a,this.options.legend.verticalAlign=b,this.options.legend.itemStyle=m},i.prototype.newChartOptions=function(a,b){return{chart:{style:{fontFamily:"open_sansregular"},renderTo:a,backgroundColor:"transparent",
zoomType:"xy",panning:!0,panKey:"shift",options3d:{}},colors:this.chartUtil.CHART_COLORS,exporting:{enabled:!1},credits:{enabled:!1},title:{text:b},loading:{style:{}},scrollbar:{},legend:{enabled:0!==this.config.legendPosition,layout:"vertical",borderColor:"#CCC",borderWidth:1,backgroundColor:"#FFFFFF",shadow:!1},tooltip:{pointFormat:this.config.pointFormat||"{series.name}: {point.y:g2}",pointFormatter:this.chartFormatter.formatTooltip(this),shared:!1},plotOptions:{series:{turboThreshold:1e4,showInLegend:!0,pointWidth:35,pointPadding:5,cursor:null,dataLabels:{enabled:this.config.showLabels,pointFormat:this.config.dataLabelFormat||(this.isPieChart()?"{point.name}: {point.y:g2}":"{point.y:g2}"),formatter:this.chartFormatter.formatDataLabels(this),color:"black",distance:45,style:{textShadow:"none"}},point:{events:{click:this.pointClickEvent,mouseOver:this.mouseOverEvent}}},line:{marker:{enabled:!1}},column:{},bar:{},area:{marker:{enabled:!1},lineWidth:3},areaspline:{marker:{enabled:!1},
lineWidth:3}},yAxis:[],xAxis:{labels:{rotation:this.xAxisLabelAngle(this.chartUtil,this.config.chartType),enabled:this.config.showXaxisLabels}}}},i.prototype.pointClickEvent=function(){var a=this,b,d,f,g=!0;a.series&&a.series.chart&&a.series.chart.container&&(d=a.series.chart.container,f=e.closestByNodeName(d,"MI-DASHBOARD")),a.options&&a.options.url&&(b=a.options.url),b&&(g=b.indexOf("graph")<=-1,f&&(g=!0),h.resolve(c).navigate.raise(b,{tab:g}))},i.prototype.mouseOverEvent=function(){var a=this;(a.options&&a.options.url?a.options.url:null)&&a.graphic&&(a.graphic.element.style.cursor="pointer")},i.prototype.xAxisLabelAngle=function(a,b){return[a.CHART_TYPE_BAR,a.CHART_TYPE_STACKED_BAR,a.CHART_TYPE_POLAR,a.CHART_TYPE_RADAR].indexOf(b)>-1?0:-60},i.prototype.getOptions=function(a,b){return this.chartData=a,this.categoryArray=b,this.configureOptions(),this.formatChartData(),this.configureChartType(),this.setAxes(),this.options},i.prototype.formatChartData=function(){
this.options.series=this.chartData},i.prototype.configureChartType=function(){var a=(this.chartData||{}).length,b;for(b=0;b<a;b++)this.enable3D(),this.formatScrollBar(b),this.formatStacked(b)},i.prototype.enable3D=function(){this.options.chart.options3d.enabled=!1},i.prototype.setAxes=function(){this.setXAxis(),this.setYAxis(0),this.setYAxis(1)},i.prototype.setXAxis=function(){this.options.xAxis.title=this.options.xAxis.title||{},this.options.xAxis.title.text||(this.options.xAxis.title.text=this.config.axis[2].caption||this.config.axis[2].name),this.options.xAxis.gridLineWidth||(this.options.xAxis.gridLineWidth=this.config.axis[2].gridLines?1:0)},i.prototype.setYAxis=function(a){this.options.yAxis[this.options.yAxis.length]={type:this.calculateChartType(this.config.axis[a]),min:this.calculateYAxisMinimum(this.config.axis[a]),max:d.toNullableInteger(this.config.axis[a].maximum),title:{text:this.config.axis[a].caption||this.config.axis[a].name},labels:{
format:this.chartFormatter.translateFormatting(this.config.axis[a]),formatter:this.chartFormatter.axisFormatter,rotation:this.calculateLabelAngle(this.config),enabled:this.shouldLabelsBeEnabled(this.config)},opposite:1===a,tickInterval:d.toNullableInteger(this.config.axis[a].tickInterval),gridLineWidth:this.config.axis[a].gridLines?1:0,stackLabels:{enabled:!1}}},i.prototype.calculateYAxisMinimum=function(a){var b=d.toNullableInteger(a.minimum);return a.logarithmic?Math.max(1,b):b},i.prototype.calculateChartType=function(a){if(a.logarithmic)return"logarithmic"},i.prototype.calculateLabelAngle=function(a){return"bar"!==a.chartType&&"stacked-bar"!==a.chartType?0:-60},i.prototype.shouldLabelsBeEnabled=function(a){return"bar"!==a.chartType&&"stacked-bar"!==a.chartType||a.showXaxisLabels},i.prototype.isPieChart=function(){
return this.chartUtil.CHART_TYPE_PIE===this.config.chartType||this.chartUtil.CHART_TYPE_DONUT===this.config.chartType||this.chartUtil.CHART_TYPE_PYRAMID===this.config.chartType},i.prototype.formatScrollBar=function(a){},i.prototype.formatStacked=function(a){},i.prototype.configureOptions=function(){},i}()});