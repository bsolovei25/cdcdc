/* Copyright Â© 1993-2019 Meridium, Inc. All rights reserved.  */
define(function(require){"use strict";var a=require("ui/elements/chart/models/base-chart"),b=require("ui/elements/chart/chart-utilities"),c=require("application/application-events"),d=require("ui/elements/chart/formatters/chart-formatter-factory"),e=require("ramda");function f(a,b,c){g.call(this,a,b,c),this.chartFormatter=d.create(this.config)}var g=Object.inherit(a,f);f.prototype.configureOptions=function(){var a=[];return g.prototype.configureOptions.call(this),this.options.chart.type="heatmap",this.options.chart.inverted=this.config.heatmap.inverted,this.options.plotOptions.series.point.events.click=i.bind(null,this),this.options.plotOptions.series.point.events.mouseOver=k.bind(null,this),this.options.xAxis.categories=l(this.categoryArray),this.options.xAxis.labels.formatter=e.partial(j,[this.config]),this.options.tooltip.formatter=this.chartFormatter.formatTooltip(this),this.options.plotOptions.series.dataLabels={enabled:!0,
pointFormat:this.config.heatmap.pointFormat||"{point.value:g2}",formatter:this.chartFormatter.formatDataLabels(this)},this.options.plotOptions.heatmap={dataLabels:{},states:{hover:{}}},this.options.plotOptions.heatmap.dataLabels={enabled:!0,color:this.config.heatmap.labelColor?this.config.heatmap.labelColor:"#000000"},this.config.heatmap.hoverColor||(this.config.heatmap.hoverColor=window.Highcharts.getOptions().colors[0]),this.options.plotOptions.heatmap.states.hover.color=this.config.heatmap.hoverColor,this.options.plotOptions.heatmap.borderWidth=this.config.heatmap.borderWidth,this.config.heatmap.borderColor||(this.config.heatmap.borderColor=window.Highcharts.getOptions().colors[0]),this.options.plotOptions.heatmap.borderColor=this.config.heatmap.borderColor,this.options.yAxis={categories:this.config.heatmap.yAxis,title:null},this.config.heatmap.minColor||(this.config.heatmap.minColor="#FFFFFF"),
this.config.heatmap.maxColor||(this.config.heatmap.maxColor=window.Highcharts.getOptions().colors[0]),this.options.colorAxis={min:Number(this.config.heatmap.minValue),minColor:this.config.heatmap.minColor,maxColor:this.config.heatmap.maxColor},this.config.heatmap.maxValue&&(this.options.colorAxis.max=Number(this.config.heatmap.maxValue)),this.config.heatmap.maxValue||(this.options.colorAxis.tickPositions=this.config.heatmap.steps?h(this.config.heatmap.steps.split(",")):h()),this.config.heatmap.specifyColors&&this.config.heatmap.colorSeries.length>0&&(a[0]={data:this.config.heatmap.colorSeries},this.chartData=a),this.options};function h(a){var b=[],c=10,d;if(void 0===a)for(d=0;d<100;d++)d%c==0&&b.push(d);else for(d=0;d<a.length;d++)b.push(Number(a[d]));return b}function i(a,d){var e,f,g,h,i,j=a.config.heatmap.hyperlinks,k=a.config.heatmap.specifyColors;d&&(e=d.currentTarget.series._i,h=d.currentTarget.graphic.element,i=b.closestByNodeName(h,"MI-DASHBOARD")),
a.chartData[e]&&a.chartData[e].urls&&j&&!k?(f=a.chartData[e].urls[d.currentTarget.index],g=!0,f&&""!==f&&(g=f.indexOf("graph")<=-1,i&&(g=!0),Object.resolve(c).navigate.raise(f,{tab:g}))):j&&k&&(g=!0,d.currentTarget.options&&d.currentTarget.options.url&&(f=d.currentTarget.options.url),f&&(g=f.indexOf("graph")<=-1,i&&(g=!0),Object.resolve(c).navigate.raise(f,{tab:g})))}var j=e.curry(function a(b){var c=10,d=(this.value||"").toString();return d.length>c&&b.truncateLabels?d.substring(0,c)+" ...":this.value});function k(a,b){var c,d,e=a.config.heatmap.hyperlinks,f=a.config.heatmap.specifyColors;b&&(c=b.currentTarget.series._i),a.chartData[c]&&a.chartData[c].urls&&e&&!f?(d=a.chartData[c].urls[b.currentTarget.index])&&""!==d&&(b.currentTarget.graphic.element.style.cursor="pointer"):e&&f&&(b.currentTarget.options&&b.currentTarget.options.url&&(d=b.currentTarget.options.url),d&&""!==d&&(b.currentTarget.graphic.element.style.cursor="pointer"))}function l(a){
for(var c=0;c<a.length;c++)a[c]=b.extractHyperlinkValue(a[c]);return a}return f});