/* Copyright Â© 1993-2019 Meridium, Inc. All rights reserved.  */
define(function(require){"use strict";var a=require("mi-assert"),b=require("./i-task"),c=require("application/application-service"),d=require("application/application-context"),e=require("security/offline-login/context/offline-login-context"),f=require("system/hardware/device"),g=require("security/offline-login/api/offline-login-api");function h(){a.implementsInterface(this,b,"this")}h.prototype.execute=function(){var a=new f,b=Object.resolve(c);a.isMobileApp()&&(b.ping().done(i.bind(null,this)),j())};function i(a){var b=new g,c=d.session.apiServer,f=d.session.datasourceId,h=d.session.userId,i=e.user.password,j=e.datasources,k=e.locale;b.setOfflineCache().then(b.setPassword.bind(null,c,f,h,i)).then(b.setOfflineDatasources.bind(null,j)).then(b.setOfflineTranslations.bind(null,k)).then(b.deleteExpiredUsers)}function j(){clearInterval(d.connectionStatus.connectionCheckerInterval)}return h});