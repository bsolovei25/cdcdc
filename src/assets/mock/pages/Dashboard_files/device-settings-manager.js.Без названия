/* Copyright Â© 1993-2019 Meridium, Inc. All rights reserved.  */
define(function(require){"use strict";var a=require("system/knockout/knockout-manager"),b=require("rounds/common/services/rounds-admin-service"),c=require("security/model/groups"),d=require("bluebird");function e(){this.kom=Object.resolve(a),this.deviceSettingService=Object.resolve(b),this.downloadHorizon=this.kom.observable(),this.syncInterval=this.kom.observable(),this.batchUploadSize=this.kom.observable(),this.gisTimeout=this.kom.observable(),this.isDefaultSetting=this.kom.observable(),f(this),this.timezones=[]}function f(a){g()&&(a.deviceSettingService.getUserDeviceSettings().done(h.bind(null,a)),a.deviceSettingService.getTimezones().done(n.bind(null,a)))}function g(){return c.isSuperUser()||c.hasMIOperatorRoundsMobileUser()||c.hasLubricationManagementUser()||c.hasMAPMSecurityGroup()}function h(a,b){i(a,b.syncInterval),l(a,b.downloadHorizon),j(a,b.batchUploadSize),k(a,b.gisTimeout),m(a,b.isSystem)}function i(a,b){a.syncInterval(b)}function j(a,b){a.batchUploadSize(b)}
function k(a,b){a.gisTimeout(b)}function l(a,b){a.downloadHorizon(b)}function m(a,b){a.isDefaultSetting(b)}function n(a,b){a.timezones=b}e.singleton=!0,e.prototype.setSyncInterval=function(a){i(this,a)},e.prototype.setBatchUploadSize=function(a){j(this,a)},e.prototype.setGisTimeout=function(a){k(this,a)},e.prototype.setDownloadHorizon=function(a){l(this,a)},e.prototype.setIsDefaultSetting=function(a){m(this,a)},e.prototype.resetDeviceToDefaultSettings=function(){d.resolve(this.deviceSettingService.selectDefaultUserSettings()).then(h.bind(null,this)).then(o.bind(null,this))};function o(a){return d.resolve(a.deviceSettingService.setUserDeviceSettings({downloadHorizon:a.downloadHorizon(),syncInterval:a.syncInterval(),batchUploadSize:a.batchUploadSize(),gisTimeout:a.gisTimeout()}))}return e});