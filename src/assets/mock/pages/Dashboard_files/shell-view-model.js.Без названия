/* Copyright Â© 1993-2019 Meridium, Inc. All rights reserved.  */
define('application/application-context',["require","exports","ramda"],function(require,exports,a){"use strict";var b=function(b){return function(c){if(!c)return!1;var d=b(c);return!a.isNil(d)&&""!==d}},c=b(a.prop("siteKey")),d=b(a.prop("defaultSiteKey")),e=function(){function a(){f(this)}return a.prototype.getSiteContext=function(){return c(this.assetcontext)?this.assetcontext.siteKey:d(this.user)?this.user.defaultSiteKey:null},a.prototype.hasPredixSDKInstalled=function(){return!!window.PredixSDK},a.prototype.reset=function(){f(this)},a}();function f(a){a.user=null,a.session=null,a.homeRoute="home",a.sessionStatus={isActive:!1},a.assetcontext=null,a.licensedModules=null,a.help={helpContext:null,helpUrl:null,defaultUrl:null},a.connectionStatus={connected:!0,lastStatusChange:null,connectionCheckerInterval:null,lastResponse:new Date,lastUserActivity:new Date},a.navigation={activeRoute:null,tabsInfo:null},a.isSupportedBrowser=!0,a.isAppHub=!!window.nav,a.hostingEnvironment=0}return new e});
define('spa/knockout/knockout-view-model',["require","exports","knockout"],function(require,exports,a){"use strict";return function(){function b(a){this.view=a,this.subscriptions=[],this.preserveContext=!1}return b.prototype.attach=function(b){b.attach($(this.view));var c=b.element;if(a.contextFor(c)&&this.preserveContext){var d=a.contextFor(c).createChildContext(this);a.applyBindingsToDescendants(d,c)}else a.applyBindingsToDescendants(this,c)},b.prototype.detach=function(b){a.cleanNode(b.element),b.clear()},b}()});
define('system/lang/ioc',["require","exports"],function(require,exports){"use strict";function a(){for(var a=[],b=0;b<arguments.length;b++)a[b-0]=arguments[b];return function(b){b.dependsOn=a}}exports.dependsOn=a;function b(a){a.singleton=!0}exports.singleton=b;function c(a){return function(b){b.factory=a}}exports.factory=c;function d(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];return Object.resolve.apply(Object,[a].concat(b))}exports.resolve=d});
define('system/globalization/translator',["require","exports","system/lang/ioc","jed"],function(require,exports,a){"use strict";var b=require("jed"),c=function(){function a(){this.jed=null}return a.prototype.setLocale=function(a){this.jed=new b(a)},a.prototype.translate=function(a,b,c){if(!a)return a;if(!this.jed)return a;var d=this.jed.translate(a);return b&&d.onDomain(b),c&&d.withContext(c),d.fetch()},a}();return c=__decorate([a.singleton],c)});
define('system/lang/object',["require","exports","lodash","jquery","bluebird"],function(require,exports,a,b,c){"use strict";function d(a,b){return __extends(b,a),a}function e(a){return new(Function.prototype.bind.apply(a,arguments))}function f(b){for(var c=[],d=1;d<arguments.length;d++)c[d-1]=arguments[d];if(g(b))return h(b);var k;if(i(b))k=j(b);else{var o=l(b),p=a.map(o,function(a){return f(a)});p.unshift(b),p=p.concat(c),k=e.apply(null,p)}return m(b)&&n(b,k),k}function g(a){return a.singleton&&a.instance}function h(a){return a.instance}function i(b){return b.factory&&a.isFunction(b.factory)}function j(a){return k(a)()}function k(a){return a.factory}function l(a){return a.dependsOn||[]}function m(a){return!!a.singleton}function n(a,b){a.instance=b}function o(b,c){var d=[],e=0;for(c=c||0,e=0;e<c;e++)d.push({});return a.each(b,function(a,b){var c={id:e,name:b,text:a,toString:function(){return a}};d[b]=c,d.push(c),e++}),d.parse=function(c){if(isNaN(c)){var e=void 0;return a.each(d,function(a){c===a&&(e=c)}),
e||a.each(b,function(a,b){c!==a&&c!==b||(e=d[b])}),e}return d[c]},d.getDisplayText=function(a){var b=d.parse(a);return b?b.text:""},Object.freeze&&Object.freeze(d),d}function p(a,b){for(var c=[],d=2;d<arguments.length;d++)c[d-2]=arguments[d];var e=Array.prototype.slice.call(arguments,2);if(r(a,b))return a[b].apply(a,e)}function q(a,b){b(a),p(a,"dispose")}function r(b,c,d){void 0===d&&(d=!1),a.isArray(c)||(c=[c]);for(var e=0;e<c.length;e++)if(!a.isFunction(b[c[e]])){if(d)throw"Required method "+c[e]+" is not defined";return!1}return!0}function s(b,c){var d=b[c];if(d&&a.isFunction(d))return d.bind(b)}function t(a,b,c){return!!a[b]&&(a[b]=c,!0)}function u(a,b){var c;return a[b]&&(c=a[b],delete a[b]),c}function v(a,b){return null===a?b:void 0===a?b:a}function w(a){var b=function(){return arguments.length&&(a=arguments[0]),a};return b.prop=function(){return a},b}var x=function(){function a(a){void 0===a&&(a=""),this.message=a,this.name="AbstractClassError"}return a}(),y=function(){
function a(a){void 0===a&&(a=""),this.message=a,this.name="AbstractMethodError"}return a}();function z(a,b){if(a.constructor===b)throw new x("Cannot create an instance of abstract class "+(b.name||""))}function A(a){throw new y("Cannot execute abstract method "+a+", must be overridden")}function B(a){return new c(C.bind(null,a))}function C(a,b,c){require(a,E.bind(null,b),D.bind(null,c))}function D(a,b){throw a(b),new Error(b)}function E(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];a(b)}var F={construct:e,resolve:f,inherit:d,createEnum:o,use:q,tryMethod:p,respondsTo:r,method:s,trySet:t,removeProperty:u,defaultValue:v,prop:w,AbstractClassError:x,AbstractMethodError:y,abstractClass:z,abstractMethod:A,require:B};return b.extend(Object,F),F});
define('system/lang/private',["require","exports"],function(require,exports){"use strict";function a(a){return a.__private__=a.__private__||{},a.__private__}return a});
define('spa/react/react-view-model',["require","exports","react","react-dom","system/lang/object","system/lang/private"],function(require,exports,a,b,c,d){"use strict";var e=function(a){return function(b){a[b]=a[b].bind(a)}},f=function(a){return function(b){var c=a[b];a[b]=function(){c.apply(a,arguments),a.updateView()}}};return function(){function g(a){d(this).view=a,d(this).mountNode=null,d(this).afterViewUpdate=null}return g.prototype.bindMethods=function(a){a.forEach(e(this))},g.prototype.updateViewAfter=function(a){a.forEach(f(this))},g.prototype.attach=function(a){c.tryMethod(this,"beforeAttach",a),a.attach(document.createElement("div")),d(this).mountNode=a.activeContainer,d(this).afterViewUpdate=this.afterViewUpdate.bind(this),this.updateView(),c.tryMethod(this,"afterAttach",a)},g.prototype.updateView=function(){var c=d(this).mountNode;if(c){var e=a.createElement(d(this).view,{vm:this}),f=d(this).afterViewUpdate;b.render(e,c,f)}},g.prototype.afterViewUpdate=function(){},g.prototype.detach=function(a){
c.tryMethod(this,"beforeDetach",a),b.unmountComponentAtNode(d(this).mountNode),d(this).afterViewUpdate=null,d(this).mountNode=null,c.tryMethod(this,"afterDetach",a)},g}()});
define('shell/models/folder',["require","exports"],function(require,exports){"use strict";var a=function(){function a(a,b,c,d,e){this.name=a,this.caption=b,this.icon=c,this.id=d,this.orderUnderParent=e,this.apps=[]}return a.prototype.getName=function(){return this.name},a.prototype.setApps=function(a){this.apps=a},a.prototype.getApps=function(){return this.apps},a.prototype.setClickHandler=function(a){this.onclick=a},a.prototype.setVisible=function(a){this.visible=a},a.prototype.setUpperEdgePosition=function(a){this.upperEdgePosition=a},a.prototype.setOrderUnderParent=function(a){this.orderUnderParent=a},a.prototype.getUpperEdgePosition=function(){return this.upperEdgePosition},a.prototype.getOrderUnderParent=function(){return this.orderUnderParent},a.prototype.getId=function(){return this.id},a.prototype.getFormattedId=function(){return this.id.replace(".","-")},a.prototype.getCaption=function(){return this.caption},a.prototype.getIcon=function(){return this.icon},a.prototype.onClick=function(){
return this.onclick.bind(null,this)},a.prototype.isVisible=function(){return this.visible},a.prototype.map=function(a){return a(this)},a}();exports.Folder=a});
define('shell/utils/target-path',["require","exports"],function(require,exports){"use strict";function a(a){return"path"in Event.prototype?a.path:b(a)}exports.getTargetPath=a;function b(a){for(var b=a.target,d=[];b;)d.push(b),b=b.parentElement;return d=c(d)}function c(a){return d(a)&&a.push(document),e(a)&&a.push(window),a}function d(a){return a.indexOf(window)===-1&&a.indexOf(document)===-1}function e(a){return a.indexOf(window)===-1}});
define('system/lang/event-binding',["require","exports"],function(require,exports){"use strict";var a=function(){function a(a,b,c){void 0===c&&(c=[]),this.handler=a,this.context=b,this.args=c}return a.prototype.execute=function(a){void 0===a&&(a=[]),a=this.args.concat(a),this.handler.apply(this.context,a)},a.prototype.dispose=function(){this.handler=null,this.context=null,this.args=null},a}();exports.EventBinding=a});
define('system/lang/event',["require","exports","./event-binding"],function(require,exports,a){"use strict";var b=function(){function b(){this.bindings=[]}return b.prototype.add=function(b,c){for(var d=[],e=2;e<arguments.length;e++)d[e-2]=arguments[e];if(null===b)throw"Event handler must not be null";if(void 0===b)throw"Event handler must not be undefined";var f=Array.prototype.slice.call(arguments,2),g=new a.EventBinding(b,c,f);return this.bindings.push(g),g},b.prototype.raise=function(){for(var a=[],b=0;b<arguments.length;b++)a[b-0]=arguments[b];for(var c=this.bindings.length,d=0;d!==c;d++)this.bindings[d].execute(a)},b.prototype.remove=function(a,b){arguments.length>1?c(this,a,b):arguments.length>0?(b=a,d(this,b)):e(this)},b}();function c(a,b,c){for(var d=[],e=a.bindings.length,f=0;f!==e;f++){var g=a.bindings[f];g.handler!==b||g.context!==c?d.push(g):g.dispose()}a.bindings=d}function d(a,b){for(var c=[],d=a.bindings.length,e=0;e!==d;e++){var f=a.bindings[e];f.context!==b?c.push(f):f.dispose()}
a.bindings=c}function e(a){for(var b=a.bindings.length,c=0;c!==b;c++)a.bindings[c].dispose();a.bindings=[]}return b});
define('application/application-events',["require","exports","system/lang/event","system/lang/ioc"],function(require,exports,a,b){"use strict";var c=function(){function b(){this.windowResized=new a,this.windowUnloaded=new a,this.signout=new a,this.windowClicked=new a,this.errorOccured=new a,this.errorUnhandled=new a,this.errorCleared=new a,this.titleChanged=new a,this.iconChanged=new a,this.navigate=new a,this.assetcontextChanged=new a,this.connectionChanged=new a,this.sessionChanged=new a,this.sessionExpired=new a,this.offlineSessionExpired=new a,this.smallDeviceOptionsMenuClicked=new a,this.layoutChanged=new a,this.bulkClose=new a}return b.prototype.removeAll=function(){this.connectionChanged.remove(),this.windowResized.remove(),this.windowUnloaded.remove(),this.signout.remove(),this.windowClicked.remove(),this.errorOccured.remove(),this.errorUnhandled.remove(),this.errorCleared.remove(),this.titleChanged.remove(),this.iconChanged.remove(),this.navigate.remove(),this.assetcontextChanged.remove(),
this.connectionChanged.remove(),this.sessionExpired.remove(),this.smallDeviceOptionsMenuClicked.remove(),this.layoutChanged.remove(),this.bulkClose.remove()},b}();return c=__decorate([b.singleton],c)});
define('shell/views/calculate-offsets',["require","exports","jquery"],function(require,exports,a){"use strict";var b=25,c=20,d=55;function e(a){var b=a.querySelectorAll(".apps-list");Array.prototype.forEach.call(b,f)}exports.calculateOffsets=e;function f(b){var c=a(b);c.is(":visible")&&(j(c)?i(c)?g(c):h(c):k(c))}function g(a){var b=a.offset().top,c=b-a.find(".left-subnav").height()+12;a.css("margin-top",c)}function h(a){k(a),a.css("margin-top","0px")}function i(a){return a.offset().top>a.find(".left-subnav").height()}function j(b){var c=b.offset().top,e=a(window).height(),f=c,g=b.height();return e-f-d<g}function k(a){var b=parseInt(a.css("margin-top").replace("px",""),10);a.find(".left-subnav").css("max-height",l(a)+b),a.find(".left-subnav").css("overflow-y","auto"),a.find(".left-subnav").css("overflow-x","hidden")}function l(a){return m(a)-b-c}function m(b){var c=b.offset().top;return a(window).height()-c}});
define('shell/views/components/folder',["require","exports","react"],function(require,exports,a){"use strict";var b=a.DOM.a,c=a.DOM.div,d=a.DOM.i;function e(a){var e="left-nav-"+a.getFormattedId()+" app-folder "+(a.isVisible()?"selected":"");return c({className:e,title:a.getCaption(),onClick:a.onClick()},d({className:a.getIcon()+" ic-nav"}),b({className:"text-style"},a.getCaption()))}exports.folder=e;function f(){for(var a=[],b=0;b<arguments.length;b++)a[b-0]=arguments[b];return c.apply(void 0,[{className:"left-nav-main-menu"}].concat(a))}exports.folderContainer=f});
define('shell/views/components/subapp',["require","exports","react"],function(require,exports,a){"use strict";var b=a.DOM.a,c=a.DOM.span;function d(a){if(a.getId())return b({className:"sub-app",target:"tab",href:a.getHref()},c(void 0,a.getCaption()))}exports.subApp=d});
define('shell/views/components/app',["require","exports","react","./subapp"],function(require,exports,a,b){"use strict";var c=a.DOM.a,d=a.DOM.i,e=a.DOM.li,f=a.DOM.span;function g(a){if(a.getId()){var g=d({className:a.getIcon()}),i=f(void 0,a.getCaption());return e.apply(void 0,[void 0,c(h(a),g,i)].concat(a.mapSubApps(b.subApp)))}}exports.app=g;function h(a){var b;return b=a.getHref()?{href:a.getHref(),target:"tab"}:{}}});
define('shell/views/components/app-list',["require","exports","ramda","react"],function(require,exports,a,b){"use strict";var c=b.DOM.div,d=b.DOM.ul;function e(b,e,f){for(var g=[],h=3;h<arguments.length;h++)g[h-3]=arguments[h];return c({className:"apps-list apps-list-"+e+" hidden",style:{marginTop:f}},c({className:"left-subnav"},d.apply(void 0,[void 0].concat(a.reject(a.isNil,g)))))}exports.appList=e});
define('shell/views/leftnav',["require","exports","ramda","react","./calculate-offsets","./components/folder","./components/app","./components/app-list","application/application-context"],function(require,exports,a,b,c,d,e,f,g){"use strict";exports.apps=a.map(e.app);var h=function(a){__extends(e,a);function e(b){var c=a.call(this,b)||this;return c.root=null,c.addApphubRepaint(),c}return e.prototype.render=function(){var a=this.props.vm,b=a.getFolders(),c=this.populateAppLists(b);return this.menu.apply(this,[d.folderContainer.apply(void 0,b.map(d.folder))].concat(c))},e.prototype.populateAppLists=function(a){var b=[];return a.forEach(function(a){a.getApps().length>0&&b.push(f.appList.apply(void 0,[!0,a.getFormattedId(),a.getUpperEdgePosition()].concat(exports.apps(a.apps))))}),b},e.prototype.menu=function(){for(var a=this,c=[],d=0;d<arguments.length;d++)c[d-0]=arguments[d];var e={height:"inherit"};return b.DOM.div.apply(b.DOM,[{style:e,ref:function(b){return a.root=b}}].concat(c))},
e.prototype.addApphubRepaint=function(){if(g.isAppHub){window.nav.repaint=this.repaintLeftNav.bind(null,this)}},e.prototype.repaintLeftNav=function(a){a.forceUpdate()},e.prototype.componentDidMount=function(){null!==this.root&&c.calculateOffsets(this.root)},e.prototype.componentDidUpdate=function(){null!==this.root&&c.calculateOffsets(this.root)},e}(b.Component);exports.LeftNavView=h});
define('shell/models/app',["require","exports"],function(require,exports){"use strict";var a=function(){function a(a,b,c,d,e,f){void 0===d&&(d=[]),this.href=a,this.icon=b,this.caption=c,this.subApps=d,this.orderUnderParent=e,this.id=f}return a.prototype.getHref=function(){return this.href},a.prototype.getId=function(){return this.id},a.prototype.getIcon=function(){return this.icon},a.prototype.setIcon=function(a){a&&(this.icon=a)},a.prototype.setCaption=function(a){a&&(this.caption=a)},a.prototype.getCaption=function(){return this.caption},a.prototype.getOrderUnderParent=function(){return this.orderUnderParent},a.prototype.getSubApps=function(){return this.subApps},a.prototype.map=function(a){return a(this)},a.prototype.mapSubApps=function(a){return this.subApps.map(a)},a.empty=function(){return new a("","","",[],0,"")},a}();exports.App=a});
define('shell/models/predix-admin-apps',["require","exports"],function(require,exports){"use strict";function a(){return[{id:"Predix Administrator",label:"Predix Administrator",label_key:"PREDIX_ADMINISTRATOR",icon:"icon-predix-admin",customConfig:{parent:"administration"},items:[]},{id:"userpreference",label:"User Preferences",label_key:"USER_PREFERENCES",path:"/preferences/#/user",icon:"icon-predix-user-preferences",customConfig:{parent:"administration"}},{id:"userprofile",label:"User Profile",label_key:"USER_PROFILE",path:"/user",icon:"icon-predix-user-profile-icon",customConfig:{parent:"administration"}}]}exports.predixAdminApps=a});
define('shell/builders/admin-apps-builder',["require","exports","ramda","../models/predix-admin-apps"],function(require,exports,a,b){"use strict";var c="Predix Administrator",d=function(){function d(){this.apps=[]}return d.prototype.buildAdminApps=function(d){if(d){this.apps=d.concat(b.predixAdminApps());var e=this.findAppById(c),f=this.findAppById("usermanagement.0"),g=void 0,h=void 0,i=void 0;if(f&&(g=f.items?a.find(a.propEq("id","usermanagement.0.1"),f.items):void 0,h=f.items?a.find(a.propEq("id","usermanagement.0.0"),f.items):void 0,i=f.items?a.find(a.propEq("id","usermanagement.0.2"),f.items):void 0),e){var j=this.findAppById("auditlog.0"),k=this.findAppById("tenantpreference.0"),l=this.findAppById("tenantsetup.0");j&&e.items.push(j),g&&e.items.push(g),l&&e.items.push(l),k&&e.items.push(k),h&&e.items.push(h),i&&e.items.push(i),this.removeSubAppDuplicates(e),this.checkForEmptyAdminApps(e)}}return this.apps},d.prototype.removeSubAppDuplicates=function(a){var b=a.items
;b&&b.forEach(this.removeSubAppDuplicate.bind(this))},d.prototype.removeSubAppDuplicate=function(a){var b=this;this.apps.forEach(function(c,d){c.id===a.id&&b.apps.splice(d,1)})},d.prototype.findAppById=function(b){return a.find(function(a){return!!a.id&&a.id===b},this.apps)},d.prototype.checkForEmptyAdminApps=function(b){if(this.adminAppsAreEmpty(b)){var d=a.findIndex(function(a){return!!a&&a.id===c},this.apps);this.apps.splice(d,1)}},d.prototype.adminAppsAreEmpty=function(a){return!(!(this.apps&&a.items&&a.items)||a.items.length)},d}();exports.AdminAppsBuilder=d});
define('system/text/parser',["require","exports","ramda","globalize"],function(require,exports,a){"use strict";var b=require("globalize"),c=function(){function c(){}return c.prototype.parseInt=function(a,c,d){return void 0===a||null===a?a:"string"!=typeof a&&"number"!=typeof a?NaN:b.parseInt(a,c,d)},c.prototype.parseFloat=function(a,c,d){return void 0===a||null===a||"number"==typeof a?a:"string"!=typeof a?NaN:b.parseFloat(a,c,d)},c.prototype.parseDate=function(c,e,f){if(!e){var g=a.clone(b.findClosestCulture().calendar.patterns);return g.dt=d("d","t"),g.dT=d("d","T"),g.Dt=d("D","t"),g.DT=d("D","T"),g.Mt=d("M","t"),g.MT=d("M","T"),g.Yt=d("Y","t"),g.YT=d("Y","T"),b.parseDate(c,a.values(g),f)}return b.parseDate(c,e,f)},c}();function d(a,b){return e(a)+" "+e(b)}function e(a){return b.findClosestCulture().calendar.patterns[a]}return new c});
define('system/text/formatter',["require","exports","lodash","jquery","system/lang/ioc","system/text/parser"],function(require,exports,a,b,c,d){"use strict";var e=require("globalize");Date.Formats={Unformatted:"yyyy-MM-dd HH:mm:ss",Sortable:"S",LongDate_ShortTime:"f",LongDate_LongTime:"F",ShortTime:"t",LongTime:"T",ShortDate:"d",LongDate:"D",Month_Year:"Y",Month_Day:"M"};var f=function(a){return function(b){return a+(b||"")}};Number.Formats={Number:f("n"),Decimal:f("d"),Percent:f("p"),Currency:f("c")},Number.Formats.Number_Zero="n0",Number.Formats.Number_Two=Number.Formats.Number(2),Number.Formats.Number_Four=Number.Formats.Number(4),Number.Formats.Decimal_Zero="d0",Number.Formats.Decimal_Two=Number.Formats.Decimal(2),Number.Formats.Decimal_Four=Number.Formats.Decimal(4),Number.Formats.Percent_Zero="p0",Number.Formats.Percent_One=Number.Formats.Percent(1),Number.Formats.Percent_Two=Number.Formats.Percent(2),Number.Formats.Currency_Zero="c0",Number.Formats.Currency_Two=Number.Formats.Currency(2)
;var g=function(){function c(){this.culture="en"}return c.prototype.setCulture=function(a){this.culture=a,e.culture(a)},c.prototype.cultureInfo=function(){return e.culture()},c.prototype.getFormatByCode=function(a){return i(a)},c.prototype.format=function(b,c,f){var g=this,i=!1,j=null;if(f=f||this.culture,a.isArray(c))return a.map(c,function(a){return g.format(b,a,f)}).join(" ");if(c=c,b instanceof Date)return h(b,c,f);if(c&&null!==c.match(/^[ndmg]e?[0-9]*/i)&&!(b instanceof Date)){var k="number"==typeof b?b:d.parseFloat(b,10,"en");if(isNaN(k)||null===k)c=void 0;else{var l=c.substr(0,1);if(null!==c.match(/^[ndmg]e[0-9]*/i)){c=c.replace("e","");var n=m(k,!0);n&&n.length>1&&(k=parseFloat(n[0]),j="e"+n[1])}switch(b=k,l){case"m":c=o(k,c);break;case"g":c=o(k,c),i=!0}}}var p=e.format(b,c,f);if(j&&(p+=j),i){var q=new RegExp(e.culture(f).numberFormat[","].replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1"),"g");p&&(p=p.replace(q,""))}return p},c.prototype.abbreviate=function(a,b){
return a&&a.length>2*b?a.substr(0,b)+"..."+a.substr(a.length-b,a.length):a},c.prototype.abbreviateByWidth=function(a,c,d){if(!a)return a;var e=document.createElement("span");e.className="dummy-span";var f=b(e);f.text(a),b(document).find("body").append(f);var g=f.width();return b(e).remove(),g>c?this.abbreviate(a,d):a},c}();g=__decorate([c.singleton],g);function h(a,b,c){return b=i(b),e.format(a,b,c)}function i(a){return"g"===a?j():"G"===a||"GT"===a?l():"r"===a||"R"===a?"ddd, dd MMM yyyy HH':'mm':'ss 'GMT'":"s"===a||"m"===a||"y"===a?a.toUpperCase():a}function j(){return k("d")+" "+k("t")}function k(a){return e.culture().calendar.patterns[a]}function l(){return k("d")+" "+k("T")}function m(a,b){return a=a,!b&&n(a)?[a.toString()]:a.toExponential().split(/[eE]/)}function n(a){if(0===a)return!0;var b=Math.abs(a);return b<1e10&&b>1e-6}function o(a,b){var c=b.substr(1);return p(q(a,c.length>0?parseInt(c,10):void 0))}function p(a){var b=a.indexOf(".");return"n"+(b>-1?a.length-1-b:0)}
function q(a,b){var c=Number(a);if(isNaN(c))return a;var d,e=m(c);if(Math.abs(c)<1&&e&&e.length>1){var f=Math.floor(parseFloat(e[0])).toString().length,g=e[0].toString().length>f?e[0].toString().length-f-1:0,h=f+g,i=Math.abs(parseFloat(e[1])),j=i+(b>h?h:b)-1;d=c.toFixed(j>20?20:j)}else d=Math.abs(c)>=1||!b?0===b||b?c.toFixed(b>20?20:b):c.toString():c.toPrecision(b);var k=c.toString();return k.length<d.length?k:d}return g});
define('system/diagnostics/log-message',["require","exports","lodash","system/lang/object","system/text/formatter"],function(require,exports,a,b,c){"use strict";var d=function(){function d(a,b,c,d,e){void 0===e&&(e=""),this.level=a,this.source=b,this.text=c,this.timestamp=d?new Date(d):new Date,this.context=e}return d.fromJson=function(a){return new d(a.level,a.source,a.text,a.timestamp,a.context)},d.fromJsonCollection=function(b){return a.map(b,d.fromJson)},d.prototype.fullSource=function(){return this.context?this.source+" ["+this.context+"]":this.source},d.prototype.toJson=function(){return{timestamp:this.timestamp.toISOString(),level:this.level,source:this.source,text:this.text,context:this.context}},d.prototype.getFormattedTimestamp=function(){return b.resolve(c).format(this.timestamp,"f")},d.prototype.getLevelCaption=function(a){return e(a,this.level)},d}();function e(b,c){var d=a.find(b,{value:c});return d?d.text:c}return d});
define('system/diagnostics/logger',["require","exports","lodash","./log-message"],function(require,exports,a,b){"use strict";var c={trace:5,debug:4,info:3,warn:2,error:1,fatal:0},d=function(){function a(a,b,c){this.id=a,this.messageLogged=b,this.level=c}return a.prototype.log=function(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];e(this,a,b)},a.prototype.trace=function(){for(var b=[],c=0;c<arguments.length;c++)b[c-0]=arguments[c];e(this,a.levels.trace,b)},a.prototype.debug=function(){for(var b=[],c=0;c<arguments.length;c++)b[c-0]=arguments[c];e(this,a.levels.debug,b)},a.prototype.info=function(){for(var b=[],c=0;c<arguments.length;c++)b[c-0]=arguments[c];e(this,a.levels.info,b)},a.prototype.warn=function(){for(var b=[],c=0;c<arguments.length;c++)b[c-0]=arguments[c];e(this,a.levels.warn,b)},a.prototype.error=function(){for(var b=[],c=0;c<arguments.length;c++)b[c-0]=arguments[c];e(this,a.levels.error,b)},a.prototype.fatal=function(){for(var b=[],c=0;c<arguments.length;c++)b[c-0]=arguments[c]
;e(this,a.levels.fatal,b)},a.prototype.isTraceEnabled=function(){return f(this,a.levels.trace)},a.prototype.isDebugEnabled=function(){return f(this,a.levels.debug)},a.prototype.isInfoEnabled=function(){return f(this,a.levels.info)},a.prototype.isWarnEnabled=function(){return f(this,a.levels.warn)},a.prototype.isErrorEnabled=function(){return f(this,a.levels.error)},a.prototype.isFatalEnabled=function(){return f(this,a.levels.fatal)},a}();d.levels={trace:"trace",debug:"debug",info:"info",warn:"warn",error:"error",fatal:"fatal"};function e(a,c,d){if(f(a,c)){var e=new b(c,a.id,g(d).join(" "));a.messageLogged.raise(a,e)}}function f(a,b){return c[b]<=c[a.level]}function g(b){return a.map(b,function(b){return a.isObject(b)?JSON.stringify(b):a.isNull(b)?"":a.isUndefined(b)?"":b.toString()})}return d});
define('config/storage-config',["require","exports","application/application-context"],function(require,exports,a){"use strict";function b(){var b=a.session,c=b.apiServer.toUpperCase(),d=b.datasourceId.toUpperCase(),e=b.userId.toUpperCase(),f="Meridium APM("+c+", "+d+", "+e+")";return{name:f,description:f}}exports.documentStorage=b});
define('system/data/document-storage',["require","exports","jquery","config/storage-config","localforage"],function(require,exports,a,b){"use strict";var c=require("localforage");return function(){function d(d){var e=a.extend({},b.documentStorage(),{storeName:"data"});this.prefix=d+"__",this.instance=c.createInstance(e)}return d.prototype.getItem=function(b){var c=a.Deferred();return this.instance.getItem(this.prefix+b).then(c.resolve.bind(c),c.reject.bind(c)),c.promise()},d.prototype.setItem=function(b,c){var d=a.Deferred();return this.instance.setItem(this.prefix+b,c).then(d.resolve.bind(d),d.reject.bind(d)),d.promise()},d.prototype.removeItem=function(b){var c=a.Deferred();return this.instance.removeItem(this.prefix+b).then(c.resolve.bind(c),c.reject.bind(c)),c.promise()},d}()});
define('system/data/client-preferences',["require","exports","system/data/document-storage","system/lang/ioc"],function(require,exports,a,b){"use strict";var c=function(){function b(){this.documentStorage=new a("client_preferences")}return b.prototype.retrievePreferences=function(a){return this.documentStorage.getItem(a)},b.prototype.savePreference=function(a,b){return this.documentStorage.setItem(a,b)},b.prototype.deletePreference=function(a){return this.documentStorage.removeItem(a)},b}();return c=__decorate([b.singleton],c)});
define('system/diagnostics/log-service',["require","exports","lodash","jquery","system/lang/object","system/lang/ioc","system/data/document-storage","system/data/client-preferences","./log-message","./logger"],function(require,exports,a,b,c,d,e,f,g,h){"use strict";var i={id:"log_config",level:h.levels.error,size:1e3},j=function(){function d(){this.clientPreferences=c.resolve(f),this.logStorage=new e("log"),this.messages=[]}return d.prototype.initializeLogConfig=function(a){return void 0===a&&(a=b.Deferred()),k(this).done(l.bind(null,this,a)),a.promise()},d.prototype.trimLog=function(){for(;this.messages.length>i.size;)this.messages.shift();return b.Deferred().resolve().promise()},d.prototype.saveConfig=function(b){return b=a.extend({},i,b),this.clientPreferences.savePreference(i.id,b)},d.prototype.saveMessage=function(a){var c=b.Deferred();this.messages.push(a.toJson()),this.trimLog(),this.logStorage.setItem("messages",this.messages).done(c.resolve.bind(c)).fail(o)},d.prototype.getAllMessages=function(){var a;try{
return a=this.messages.slice(0),a.reverse(),a=g.fromJsonCollection(a||[]),Promise.resolve(a)}catch(a){return console.error(a),Promise.reject(a)}},d.prototype.clearLog=function(){return this.messages=[],Promise.resolve(this.logStorage.setItem("messages",this.messages))},d}();j=__decorate([d.singleton],j);function k(a){return a.clientPreferences.retrievePreferences(i.id)}function l(a,b,c){c?n(a).done(b.resolve.bind(b,c)):a.saveConfig(i).done(m.bind(null,a,b,i))}function m(a,b,c){n(a).done(b.resolve.bind(b,c))}function n(a){return a.logStorage.getItem("messages").done(function(b){b&&(a.messages=b)}).fail(console.error)}function o(a,b){console.error(b),a.reject(b)}return j});
define('system/diagnostics/log-manager',["require","exports","lodash","system/lang/object","./logger","./log-service","system/lang/event"],function(require,exports,a,b,c,d,e){"use strict";var f=function(){function f(){this.defaultLevel=c.levels.error,this.level=this.defaultLevel,this.loggers={},this.nestedContexts=[],this.messageCache=[],this.messageLogged=new e,this.messageLogged.add(this.cacheMessage,this)}return f.prototype.cacheMessage=function(a,b){b.context=this.currentContext(),this.messageCache.push(b)},f.prototype.initialize=function(){var a=b.resolve(d);return a.trimLog(),a.initializeLogConfig().done(g.bind(null,this)).fail(h)},f.prototype.saveConfig=function(){return b.resolve(d).saveConfig().fail(h)},f.prototype.getLogger=function(a){var b=this.loggers[a];return b||(b=new c(a,this.messageLogged,this.level),this.loggers[a]=b),b},f.prototype.setLevel=function(b){this.level=b,a.each(this.loggers,function(a){return a.level=b})},f.prototype.pushContext=function(a){this.nestedContexts.push(k(a))},
f.prototype.popContext=function(){this.nestedContexts.pop()},f.prototype.currentContext=function(){return this.nestedContexts[this.nestedContexts.length-1]},f}();function g(a,b){a.setLevel(c.levels[b.level]),i(a),a.messageLogged.add(function(b,c){c.context=a.currentContext(),j(a,c)},a)}function h(a){console.error(a)}function i(b){b.messageLogged.remove(b.cacheMessage,b),a.each(b.messageCache,j.bind(null,b))}function j(a,c){b.resolve(d).saveMessage(c)}function k(b){return a.isObject(b)?JSON.stringify(b):b.toString()}return new f});
define('shell/models/admin-apps-blacklist',["require","exports"],function(require,exports){"use strict";function a(){return[{id:"unitsofConversion.0",label:"",path:"",icon:""},{id:"usermanagement.0",label:"",path:"",icon:""},{id:"functionalUsers.0",label:"",path:"",icon:""},{id:"tenantsetup.0",label:"",path:"",icon:""},{id:"auditlog.0",label:"",path:"",icon:""},{id:"tenantpreference.0",label:"",path:"",icon:""}]}exports.adminAppsBlacklist=a});
define('shell/builders/href-builder',["require","exports","lodash"],function(require,exports,a){"use strict";var b="#app-hub";function c(a,b){var c=f(a.path,b);return c&&a.customConfig&&"meridium"===a.customConfig.source?d(c):c?h(c):""}exports.buildHref=c;function d(a){return e(a)?g(a):i(a)}function e(a){return 0===a.lastIndexOf("!",0)||"!"===a.charAt(1)}function f(a,b){return a?a.replace(b,""):""}exports.removeContextPath=f;function g(a){return"!"===a.charAt(1)?a.substr(1):a}function h(a){return a?b+a:""}function i(a){return a?"#"+a:""}function j(c){if(!c)return"";var d=a.startsWith(c,b),f=a.startsWith(c,"#")&&!d;return e(c)?"/"+c:f?c.substr(1):d?c.substr(b.length):c}exports.normalizeRouteStrings=j});
define('shell/builders/icon-builder',["require","exports"],function(require,exports){"use strict";function a(a,c){return b(a.customConfig&&a.customConfig.icon?a.customConfig.icon:a.icon?a.icon:c)}exports.buildIcon=a;function b(a){return a&&0===a.lastIndexOf("fa-",0)&&(a="fa "+a),a||""}});
define('shell/models/app-overrides',["require","exports","ramda"],function(require,exports,a){"use strict";function b(b){return a.find(function(a){return!!a.id&&a.id===b},c())}exports.getAppOverride=b;function c(){return[{id:"dashboardmicroapp.0",label_key:"GE_DASHBOARDS"}]}});
define('shell/builders/leftnav-utilities',["require","exports","ramda","../models/app"],function(require,exports,a,b){"use strict";function c(a,b){var c=60;a.setOrderUnderParent(b);var d=c*a.getOrderUnderParent();a.setUpperEdgePosition(d)}exports.setUpperEdges=c;function d(c){var d=a.equals(b.App.empty());return c.filter(function(b){return!!b.getApps().length&&!a.all(d,b.getApps())})}exports.deleteEmptyFolders=d});
define('shell/builders/leftnav-builder',["require","exports","../models/folder","../models/app","./admin-apps-builder","system/diagnostics/log-manager","../models/admin-apps-blacklist","./href-builder","./icon-builder","../models/app-overrides","application/application-context","./leftnav-utilities"],function(require,exports,a,b,c,d,e,f,g,h,i,j){"use strict";var k=d.getLogger("security/view-models/application-reset"),l="icon-plus ic-nav",m=9;return function(){function d(a,b,c){this.windowNavApps=a,this.addAdminApps(),this.folders=[],this.translator=b,this.contextPath=c,this.hasAppsWithoutParent=!1}return d.prototype.build=function(){var a=[];return this.checkForAppsWithoutParent(),this.findFolders(a),this.createFolders(a),this.createAdminFolder(),this.createAppsFolder(),this.addAppsToFolders(),this.addAppsWithoutParent(),this.folders=j.deleteEmptyFolders(this.folders),this.folders.sort(this.sortItems),this.folders.forEach(this.setUpperEdges),this.folders},d.prototype.addAdminApps=function(){if(i.isAppHub){
var a=new c.AdminAppsBuilder;this.windowNavApps=a.buildAdminApps(this.windowNavApps)}},d.prototype.sortItems=function(a,b){if(a.getOrderUnderParent()===b.getOrderUnderParent()){if(a.getCaption().toUpperCase()<b.getCaption().toUpperCase())return-1;if(a.getCaption().toUpperCase()>b.getCaption().toUpperCase())return 1}return a.getOrderUnderParent()-b.getOrderUnderParent()},d.prototype.setUpperEdges=function(a,b){a.setOrderUnderParent(b);var c=60*a.getOrderUnderParent();a.setUpperEdgePosition(c)},d.prototype.createFolders=function(a){a.forEach(this.createFolder.bind(this))},d.prototype.createFolder=function(b){try{var c=this.getTranslation(this,b),d=c||b.label||"",e=g.buildIcon(b,l),f=b.id,h=this.getAppOrder(b);this.folders.length<=this.getFolderLimit()&&f&&this.folders.push(new a.Folder(c,d,e,f,h))}catch(a){this.logError(a)}},d.prototype.getAppOrder=function(a){return a.customConfig&&a.customConfig.order_under_parent?a.customConfig.order_under_parent:0},
d.prototype.createAdminFolder=function(){var b={id:"adminFolder",label_key:"ADMIN",label:"Admin",icon:"icon-user-nav ic-nav",path:""},c=this.getTranslation(this,b),d=c||b.label,e=g.buildIcon(b,l),f=this.folders.length;this.folders.push(new a.Folder(c,d,e,"administration.0",f))},d.prototype.checkForAppsWithoutParent=function(){this.windowNavApps.forEach(this.checkForAppWithoutParent.bind(this))},d.prototype.checkForAppWithoutParent=function(a){(!a.customConfig||a.customConfig&&!a.customConfig.parent)&&(this.hasAppsWithoutParent=!0)},d.prototype.getFolderLimit=function(){return this.hasAppsWithoutParent?m-2:m-1},d.prototype.createAppsFolder=function(){var b={id:"appsFolder",label_key:"APPS",label:"Apps",icon:"icon-left-nav-apps ic-nav",path:""},c=this.getTranslation(this,b),d=c,e=g.buildIcon(b,l),f=this.folders.length;this.folders.push(new a.Folder(c,d,e,"appsfolder.0",f))},d.prototype.addAppsWithoutParent=function(){var a=this.folders[this.folders.length-1]
;this.windowNavApps.forEach(this.addAppWithoutParent.bind(null,this,a)),a.getApps().sort(this.sortItems)},d.prototype.addAppWithoutParent=function(a,b,c){try{if(a.isParent(b,c)||!a.hasParent(c)&&!a.isAdminManagerPageApp(c)&&!a.isAdminApp(c)){var d=a.toApp(a,c);b.getApps().push(d)}}catch(b){a.logError(b)}},d.prototype.isAdminApp=function(a){var b=!1;return e.adminAppsBlacklist().forEach(function(c){if(a.id===c.id)return void(b=!0)}),b},d.prototype.hasParent=function(a){return!!(a.id&&a.customConfig&&a.customConfig.parent)},d.prototype.isParent=function(a,b){return!!(b.id&&b.customConfig&&b.customConfig.parent&&a.getId()===b.customConfig.parent+".0")},d.prototype.addAppsToFolders=function(){this.folders.forEach(this.addApps.bind(this))},d.prototype.addApps=function(a){this.windowNavApps.forEach(this.addApp.bind(this,a)),a.getApps().sort(this.sortItems)},d.prototype.addApp=function(a,b){if(this.isParent(a,b)){var c=this.toApp(this,b);a.getApps().push(c)}},d.prototype.toApp=function(a,c){
try{var d=f.buildHref(c,a.contextPath),e=g.buildIcon(c,"sprite-ic ic-s-asm"),h=a.getTranslation(a,c),i=[];c.items&&(i=a.buildSubApps(a,c.items));var j=this.getAppOrder(c),k=c.id;return new b.App(d,e,h,i,j,k)}catch(a){return this.logError(a),b.App.empty()}},d.prototype.isAdminManagerPageApp=function(a){return!!a.customConfig&&""===a.customConfig.parent},d.prototype.buildSubApps=function(a,b){var c=[];return b.forEach(a.buildSubApp.bind(null,a,c)),c},d.prototype.buildSubApp=function(a,b,c){var d=a.toApp(a,c);b.push(d)},d.prototype.getTranslation=function(a,b){var c=h.getAppOverride(b.id);return c?a.translator.translate(c.label_key):b.label_key?a.translator.translate(b.label_key):b.label?b.label:""},d.prototype.findFolders=function(a){this.windowNavApps.forEach(this.findFolder.bind(null,a))},d.prototype.findFolder=function(a,b){b.id&&b.customConfig&&"root"===b.customConfig.parent&&a.push(b)},d.prototype.logError=function(a){a&&k.error(a.stack)},d}()});
define('system/hardware/device',["require","exports","detect"],function(require,exports){"use strict";var a=require("detect");return function(){function b(b){this.userAgent=b||navigator.userAgent,this.parsedUserAgent=a.parse(this.userAgent)}return b.prototype.isMobile=function(){return this.isMobileApp()},b.prototype.isMobileApp=function(){return void 0!==window.cordova},b.prototype.isWindowsApp=function(){return!!window.MSApp},b.prototype.isAndroid=function(){return/Android/i.test(this.userAgent)},b.prototype.isIOS=function(){return/iPhone|iPad|iPod/i.test(this.userAgent)},b.prototype.isIE=function(){return/Trident/i.test(this.userAgent)&&!/MSIE/i.test(this.userAgent)},b.prototype.isEdge=function(){return/EDGE/i.test(this.userAgent)},b.prototype.isChromeOnAndroid=function(){return!!this.canReadBrowserAndOS()&&("CHROME"===this.parsedUserAgent.browser.family.toUpperCase()&&"ANDROID"===this.parsedUserAgent.os.family.toUpperCase())},b.prototype.canReadBrowserAndOS=function(){
return!(!this.parsedUserAgent.browser.family||!this.parsedUserAgent.os.family)},b.prototype.innerWidth=function(){return window.innerWidth},b.prototype.outerWidth=function(){return window.outerWidth},b.prototype.screenWidth=function(){return window.screen.width},b.prototype.innerHeight=function(){return window.innerHeight},b.prototype.pixelRatio=function(){return window.devicePixelRatio},b.prototype.deviceInnerWidth=function(){return this.roundUp(this.innerWidth()*this.pixelRatio())},b.prototype.roundUp=function(a){return Math.ceil(a)},b.prototype.deviceOuterWidth=function(){return this.roundUp(this.outerWidth()*this.pixelRatio())},b.prototype.deviceScreenWidth=function(){return this.roundUp(this.screenWidth()*this.pixelRatio())},b.prototype.isChrome=function(){return/Chrome/i.test(this.userAgent)},b}()});
define('security/model/licenses',['require','application/application-context'],function(require){"use strict";var a=require("application/application-context");function b(module){return!!a.licensedModules.findById(module)}return{hasModule:b,hasRCM:b.bind(null,"RCM"),hasRBI:b.bind(null,"RBI"),has581:b.bind(null,"RBI_581"),hasSIS:b.bind(null,"SIS"),hasHazards:b.bind(null,"Hazards"),hasASM:b.bind(null,"ASM"),hasASO:b.bind(null,"ASO"),hasPolicyManager:b.bind(null,"PolicyManager"),hasCalibration:b.bind(null,"Calibration"),hasPLA:b.bind(null,"PLA"),hasPROACT:b.bind(null,"PROACT"),hasReliability:b.bind(null,"Reliability"),hasLCC:b.bind(null,"LCC"),hasInspection:b.bind(null,"Inspection"),hasCompliance:b.bind(null,"Inspection"),hasTM:b.bind(null,"TM"),hasOPR:b.bind(null,"OPR"),hasLM:b.bind(null,"LM"),hasMetrics:b.bind(null,"Metrics"),hasDeveloper:b.bind(null,"Developers"),hasAHM:b.bind(null,"AHM"),hasGE_M2M:b.bind(null,"GE_M2M"),hasAMS:b.bind(null,"AMS_Asset_Portal"),hasASI:b.bind(null,"SAP_Content_for_ASI"),hasGAA:b.bind(null,"GAA"),
hasGAAWind:b.bind(null,"GAA_WIND"),hasPDIOPC:b.bind(null,"PDI_OPC_XI"),hasCognitive:b.bind(null,"Cognitive"),hasELog:b.bind(null,"eLog"),hasMoc:b.bind(null,"MOC"),hasPipeline:b.bind(null,"PipelineManagement"),hasEssentials:b.bind(null,"Essentials"),hasComplianceManagement:b.bind(null,"Compliance_Management")}});
define('security/model/module-access',['require','ramda','application/application-context','security/model/licenses'],function(require){"use strict";var a=require("ramda"),b=require("application/application-context"),c=require("security/model/licenses");function d(a){return a.vw}function e(c){return a.isEmpty(a.difference(c,a.pluck("familyId")(a.filter(d,b.user.privileges))))}function f(a,d){return!(a&&!c.hasModule(a))&&!(d&&!b.user.isSuperUser&&!e(d))}return{hasAccess:f,hasAsiAccess:f.bind(null,"SAP_Content_for_ASI",["MI_IMPPACKG","MI_MAINTPLN"]),hasAsmAccess:f.bind(null,null,["MI_ASTSTRAT","MI_PRPSTRAT","MI_ACTSTRAT","MI_FAILRISK","MI_ACTION","MI_RISKASSE","MI_RISK","MI_ACTIONRV","MI_FAILRSKR","MI_STRATREV","MI_RSKASREV","MI_SYSSTRAT","MI_UNTSTRAT","MIR_IMPLACT","MIR_WSPRASM"]),hasFmeaAccess:f.bind(null,"RCM",["MI_RCMTMPLT","MI_RCMEQPMT","MI_RCMFMODE","MI_RCMFEFFT","MI_RECRCM"]),hasRcmAccess:f.bind(null,"RCM",["MI_RCMTMPLT","MI_RCMFUNCN","MI_RCMEQPMT","MI_RCMFFAIL","MI_RCMFMODE","MI_RCMFEFFT","MI_RECRCM"]),hasRecommendationManagerAccess:f.bind(null,null,["MI Recommendation"])}});
define('security/model/groups',['require','lodash','application/application-context'],function(require){"use strict";var a=require("lodash"),b=require("application/application-context");function c(){return!!b.user.isSuperUser}function d(c){return!!a.find(b.user.groups||[],{id:c})}return{isSuperUser:c,hasMIOperatorRoundsMobileUser:d.bind(null,"MI Operator Rounds Mobile User"),hasMIOperatorRoundsAdministrator:d.bind(null,"MI Operator Rounds Administrator"),hasMIRoundsDesignerViewer:d.bind(null,"MI Rounds Designer Viewer"),hasMICalibrationUser:d.bind(null,"MI Calibration User"),hasMICalibrationViewer:d.bind(null,"MI Calibration Viewer"),hasMISecurityRole:d.bind(null,"MI Security Role"),hasMIConfigurationRole:d.bind(null,"MI Configuration Role"),hasMIPowerUserRole:d.bind(null,"MI Power User Role"),hasMIAHIAdmin:d.bind(null,"MI AHI Administrator"),hasMIAHIUserRole:d.bind(null,"MI AHI User"),hasMIAHIViewerRole:d.bind(null,"MI AHI Viewer"),hasMISISViewer:d.bind(null,"MI SIS Viewer"),hasMIMOCViewer:d.bind(null,"MI MOC Viewer"),
hasMIAMSAdmin:d.bind(null,"MI AMS Asset Portal Administrator"),hasMIAMSPowerUserRole:d.bind(null,"MI AMS Asset Portal Power User"),hasMIAMSUserRole:d.bind(null,"MI AMS Asset Portal User"),hasMIAMSViewerRole:d.bind(null,"MI AMS Asset Portal Viewer"),hasMIGEAdmin:d.bind(null,"MI GE Administrator"),hasMIGEUserRole:d.bind(null,"MI GE User"),hasMISISUser:d.bind(null,"MI SIS User"),hasMISISEngineer:d.bind(null,"MI SIS Engineer"),hasMIMOCUser:d.bind(null,"MI MOC User"),hasMIHAZViewer:d.bind(null,"MI Hazards Viewer"),hasMIHAZOwner:d.bind(null,"MI HA Owner"),hasMIHAZMember:d.bind(null,"MI HA Member"),hasMIHAZFacilitator:d.bind(null,"MI HA Facilitator"),hasMIHAZAdmin:d.bind(null,"MI HA Administrator"),hasMIGEViewerRole:d.bind(null,"MI GE Viewer"),hasMIPolicyDesigner:d.bind(null,"MI Policy Designer"),hasMIPolicyUser:d.bind(null,"MI Policy User"),hasMIPolicyViewer:d.bind(null,"MI Policy Viewer"),hasMIPolicyAdministrator:d.bind(null,"MI Policy Administrators"),
hasMIPDIAdmin:d.bind(null,"MI Process Data Integration Administrator"),hasMIACAAdministrator:d.bind(null,"MI ACA Administrator"),hasMIACAOwner:d.bind(null,"MI ACA Owner"),hasMIACAMember:d.bind(null,"MI ACA Member"),hasMIASIAdministrator:d.bind(null,"MI ASI Administrator"),hasMIASMAdministrator:d.bind(null,"MI ASM Management Administrator"),hasMICalibrationAdministrator:d.bind(null,"MI Calibration Administrator"),hasMIRCMAdministrator:d.bind(null,"MI RCM Administrator"),hasMIHAAdministrator:d.bind(null,"MI HA Administrator"),hasMIMetricsAdministrator:d.bind(null,"MI Metrics Administrator"),hasMIProductionLossAccountingAdministrator:d.bind(null,"MI Production Loss Accounting Administrator"),hasMIPROACTAdmin:d.bind(null,"MI PROACT Admin"),hasMISISAdministrator:d.bind(null,"MI SIS Administrator"),hasMIMOCAdministrator:d.bind(null,"MI MOC Administrator"),hasMIMOCApprover:d.bind(null,"MI MOC Approver"),hasAPMNowAdmin:d.bind(null,"MI APMNow Admin"),
hasLubricationManagementUser:d.bind(null,"MI Lubrication Management User"),hasLubricationManagementAdmin:d.bind(null,"MI Lubrication Management Administrator"),hasDataLoaderUserRole:d.bind(null,"MI CMMS Interface User"),hasDataLoaderAdminRole:d.bind(null,"MI CMMS Interface Administrator"),hasGaaAdministrator:d.bind(null,"MI Generation Management Administrator"),hasGaaAnalyst:d.bind(null,"MI Generation Management Analyst"),hasGaaViewer:d.bind(null,"MI Generation Management"),hasCognitiveAdministrator:d.bind(null,"MI Cognitive Administrator"),hasCognitiveUser:d.bind(null,"MI Cognitive User"),hasMAPMSecurityGroup:d.bind(null,"MAPM Security Group"),hasELogAdministrator:d.bind(null,"MI eLog Administrator"),hasELogContributor:d.bind(null,"MI eLog Contributor"),hasELogViewer:d.bind(null,"MI eLog Viewer"),hasLCCAdministrator:d.bind(null,"MI LCC Administrator"),hasLCCUser:d.bind(null,"MI LCC User"),hasLCCViewer:d.bind(null,"MI LCC Viewer"),
hasReliabilityAdministrator:d.bind(null,"MI Reliability Administrator"),hasReliabilityUser:d.bind(null,"MI Reliability User"),hasReliabilityViewer:d.bind(null,"MI Reliability Viewer"),hasMITMAdministrator:d.bind(null,"MI Thickness Monitoring Administrator"),hasMITMInspector:d.bind(null,"MI Thickness Monitoring Inspector"),hasMITMUser:d.bind(null,"MI Thickness Monitoring User"),hasMITMViewer:d.bind(null,"MI Thickness Monitoring Viewer"),hasMIRBIAdmin:d.bind(null,"MI RBI Administrator"),hasMIRBIAnalyst:d.bind(null,"MI RBI Analyst"),hasMIRBIViewer:d.bind(null,"MI RBI Viewer"),hasMIInspection:d.bind(null,"MI Inspection"),hasMIInspectionViewer:d.bind(null,"MI Inspection Viewer"),hasMIPROACTTeamMember:d.bind(null,"MI PROACT Team Member"),hasMIPROACTViewer:d.bind(null,"MI PROACT Viewer"),hasMIProductionLossAccountingManager:d.bind(null,"MI Production Loss Accounting Manager"),hasMIProductionLossAccountingService:d.bind(null,"MI Production Loss Accounting Service"),
hasMIProductionLossAccountingUser:d.bind(null,"MI Production Loss Accounting User"),hasGAAWindAdmin:d.bind(null,"MI GAA Wind Administrator"),hasGAAWindSuperAdmin:d.bind(null,"MI GAA Wind Super Administrator"),hasGAAWindAnalysts:d.bind(null,"MI GAA Wind Analyst"),hasGAAWindOperator:d.bind(null,"MI GAA Wind Operator")}});
define('security/model/roles',['require','lodash','application/application-context'],function(require){"use strict";var a=require("lodash"),b=require("application/application-context");function c(c){return!!a.find(b.user.roles||[],{id:c})}return{hasDataLoaderUserRole:c.bind(null,"MI Data Loader User"),hasDataLoaderAdminRole:c.bind(null,"MI Data Loader Admin")}});
define('system/react/react-common',["require","exports","ramda"],function(require,exports,a){"use strict";function b(b,c){return a.merge({target:b},c)}exports.newEvent=b;function c(a,b){return function(c){b(c[a])}}exports.withEventProperty=c;function d(a,b){return function(c){b(c.target[a],c)}}exports.withTargetProperty=d;function e(b,c,d){return d.length?d.map(b):c?a.of(c()):[]}exports.mapOrDefault=e;function f(a,b,c){return null!==c&&void 0!==c?a(c):b?b():""}exports.elementOrDefault=f;function g(a,b){return f(a,void 0,b)}exports.elementOrNothing=g});
define('admin-menu/views/components/menu-application-settings',['require','ramda','react','system/react/react-common','application/application-events','security/model/licenses','security/model/groups'],function(require){"use strict";var a=require("ramda"),b=require("react"),c=require("system/react/react-common"),d=require("application/application-events"),e=require("security/model/licenses"),f=require("security/model/groups"),g="../Subsystems/ApplicationSettings/Content/ApplicationSettingsOverview.htm",h="APPLICATION_SETTINGS",i="tab-icon-application-settings",j=b.DOM.ul,k=b.DOM.li,l=b.DOM.a,m=b.DOM.i,n=b.DOM.header,o=b.DOM.nav,p=b.DOM.abbr,q=b.DOM.footer;function r(a){var b=a.vm,c=b.appSettingsMenu();if(s(c))return t(b,c);u()}function s(b){return a.any(a.propEq("enabled",!0),b)}function t(a,b){return a.setTitle(h,i),a.activateHelp(g),v(a,b)}function u(){Object.resolve(d).navigate.raise("access-denied")}function v(a,b){var c=w.bind(null,a);return j({className:"block-group list-unstyled"},b.map(c))}function w(a,b){return k({className:b.enabled?"block":"hidden",key:b.href},l({style:x(b),href:b.href,icon:b.icon},y(b,a)),B(b,a))}function x(a){return{width:"80px",cursor:"pointer",
textDecoration:"none"}}function y(a,b){return a.icon?z(a):A(a,b)}function z(a){return n({className:"header"},o(null,m({className:a.icon})))}function A(a,b){return n({className:"header"},o(null,p({className:"abbr"},b.translate(a.abbr))))}function B(a,b){return q({className:"footer"},l({href:a.href},b.translate(a.caption)))}return r});
define('system/mobile/device-connectivity',["require","exports","system/lang/ioc","system/lang/ioc","system/lang/ioc","application/application-events","bluebird","ramda"],function(require,exports,a,b,c,d,e,f){"use strict";var g=function(){function a(){this.userSetToOffline=!1,this.applicationEvents=c.resolve(d)}return a.prototype.getManualOfflineStatus=function(){return this.userSetToOffline},a.prototype.setManualOfflineStatus=function(a){this.userSetToOffline=a,this.hasPredixSDKInstalled()?this.queryConnectivity().catch(this.handleConnectivityFailure.bind(null,this)).then(this.handleConnectivityResponse.bind(null,this)):this.applicationEvents.connectionChanged.raise(this,{connected:!this.userSetToOffline})},a.prototype.hasPredixSDKInstalled=function(){return!!window.PredixSDK},a.prototype.queryConnectivity=function(){return new e(function(a,b){window.PredixSDK.queryConnectivity(a,b)})},a.prototype.handleConnectivityResponse=function(a,b){var c=window;a.deviceIsOnline(b)&&(b=a.resetConnectivityWithToggle(a,b)),
c.broadcaster.fireEvent("PredixSDK.ReachabilityChanged",{ReachabilityStatus:b})},a.prototype.deviceIsOnline=function(a){return f.contains("Online",a)},a.prototype.resetConnectivityWithToggle=function(a,b){b=a.getStateAsArray(b);var c=f.indexOf("Online",b);return a.userSetToOffline===!0&&(b[c]="Offline"),b},a.prototype.getStateAsArray=function(a){return"string"==typeof a&&(a=a.split(",")),a},a.prototype.handleConnectivityFailure=function(a){console.log("An error occurred")},a}();return g=__decorate([a.singleton,b.dependsOn(d)],g)});
define('system/http/predix-mobile-ajax-client',["require","exports","system/diagnostics/log-manager","application/application-context","system/mobile/device-connectivity","system/lang/object","ramda"],function(require,exports,a,b,c,d,e){"use strict";var f=a.getLogger("system/http/ajax-client"),g=59900,h={timeout:g,headers:{"Content-Type":"application/json",timeout:g}},i="apm",j="api/core/utility/unauthorizedping",k="",l=function(){function a(){}return a.prototype.baseUrl=function(){return k+i+"/"},a.useSecureConnection=function(a){},a.setServer=function(a){k=a},a.addAjaxOption=function(a,b){var c={};c[a]=b,$.extend(h,c)},a.clearHeaders=function(){},a.prototype.url=function(a){return a=this.trimSlash(a),a=k+i+"/"+a,a=encodeURI(decodeURI(a))},a.prototype.get=function(a,b){return f.info("ajax GET",a),a=this.url(a),m("GET","text",b,{},a)},a.prototype.post=function(a,b,c){return f.info("ajax POST",b,c),a=this.url(a),m("POST","text",c,b,a)},a.prototype.put=function(a,b,c){return f.info("ajax PUT",b,c),a=this.url(a),
m("PUT","text",c,b,a)},a.prototype.delete=function(a,b){return f.info("ajax DELETE",a),a=this.url(a),m("DELETE","text",b,{},a)},a.prototype.getBinary=function(a,b){return f.info("ajax binary GET",a),a=this.url(a),m("GET","blob",b,{},a)},a.isMultiTenant=function(){return!!window.nav},a.prototype.trimSlash=function(a){return a&&"/"===a.charAt(0)&&(a=a.substring(0).slice(1)),a},a}();function m(a,b,f,g,i){var j=$.extend(!0,{},h,f),k=$.Deferred(),l=window,m=new l.PredixRequest(a,i),p=d.resolve(c);return m.responseType=b,q(m,j),m.onComplete=x.bind(null,k.resolve.bind(k),k.reject.bind(k),a,i),m.onError=y.bind(null,k.reject.bind(k),i),m.beforeSend=o(m,p.getManualOfflineStatus()),"GET"===a?m.send():f&&!e.isNil(f.data)?m.send(f.data):m.send(g),n(k,m)}function n(a,b){var c=a.promise();return c.abort=b.abort,c}function o(a,b){return b?p.bind(null,a):null}function p(a){console.log("Aborting"),a.abort(),a.onComplete({statusCode:-1,error:"error"})}function q(a,b){
e.mapObjIndexed(r.bind(null,a),b.headers)}function r(a,b,c){a.setRequestHeader(c,b)}function s(a){return a>=200&&a<300||304===a}function t(a,b,c,d){if(null===b.data||""===b.data)try{c(null,null,a)}catch(a){console.log("error from success callback for url: "+d),console.log("response: "+JSON.stringify(b)),console.log("error: "+a)}else if("string"==typeof b.data)try{c(JSON.parse(b.data),null,a)}catch(a){console.log("error from success callback for url: "+d),console.log("response: "+JSON.stringify(b)),console.log("error: "+a)}else try{c(b.data,null,a)}catch(c){console.log("error from success callback for url: "+d),console.log("response: "+JSON.stringify(b),null,a),console.log("error: "+c)}}function u(a,b,c,d){var e="error";try{console.log("====jqXHR: "+JSON.stringify(a)),console.log("====text: "+e),console.log("====Error thrown "+d+" === "+b),c(a,e,b)}catch(a){console.log("error from fail callback for url: "+d),console.log("error: "+a)}}function v(a){
w(a,j)||(b.connectionStatus.lastResponse=new Date)}function w(a,b){return a.indexOf(b)>-1}function x(a,b,c,d,e){console.log("====SUCCESS "+c+" RESPONSE FROM URL: "+d+" === "+e.data),v(d);var f=s(e.statusCode),g={status:e.statusCode};f===!0?t(g,e,a,d):u(g,e.data,b,d)}function y(a,b,c){console.log("====FAIL RESPONSE FROM URL: "+b+" === "+JSON.stringify(c)),u({status:c.statusCode,statusText:c.error},c.error,a,b)}return l});
define('system/http/binary-transport',['require','jquery'],function(require){"use strict";require("jquery").ajaxTransport("+binary",function(a,b,c){if(window.FormData&&(a.dataType&&"binary"===a.dataType||a.data&&(window.ArrayBuffer&&a.data instanceof ArrayBuffer||window.Blob&&a.data instanceof Blob)))return{send:function(b,c){var d=new XMLHttpRequest,e=a.url,f=a.type,g=a.async||!0,h=a.responseType||"blob",i=a.data||null,j=a.username||null,k=a.password||null;d.addEventListener("load",function(){var b={};b[a.dataType]=d.response,c(d.status,d.statusText,b,d.getAllResponseHeaders())}),d.open(f,e,g,j,k);for(var l in b)b.hasOwnProperty(l)&&d.setRequestHeader(l,b[l]);d.responseType=h,d.send(i)},abort:function(){c.abort()}}})});
define('system/http/ajax-client',["require","exports","lodash","jquery","system/lang/ioc","application/application-events","system/diagnostics/log-manager","system/hardware/device","system/mobile/device-connectivity","system/http/predix-mobile-ajax-client","system/lang/object","./binary-transport"],function(require,exports,a,b,c,d,e,f,g,h,i){"use strict";require("./binary-transport");var j=k()?59900:3e5;function k(){return!!window.nav}var l=e.getLogger("system/http/ajax-client"),m={contentType:"application/json",dataType:"json",cache:!0,timeout:j,headers:{timeout:j}},n={useSecureConnection:"https:"===location.protocol,server:null},o=function(){function c(){}return c.useSecureConnection=function(a){n.useSecureConnection=a,l.info("connectionOptions.useSecureConnection",a)},c.setServer=function(a){c.useSecureConnection(r(a)),a=v(a),a=w(a),n.server=a,l.info("connectionOptions.server",a)},c.server=function(){return n.server},c.secureConnection=function(){return n.useSecureConnection},c.addHeader=function(a,c){
var d={};d[a]=c,m.headers=m.headers||{},b.extend(m.headers,d),l.info("adding to ajaxOptions.headers",a,c)},c.clearHeaders=function(){m.headers=void 0,l.info("ajaxOptions.headers cleared")},c.headers=function(){return b.extend({},m.headers)},c.promise=function(a,b){var c=a.promise();return c.request={abort:b.abort},c},c.prototype.url=function(a){return q(this,a)},c.prototype.get=function(a,c){a=q(this,a);var d="GET",e=b.extend({},m,{url:a,type:d});return l.info("ajax GET",e.url),y(e,c)},c.prototype.getBinary=function(a,c){a=this.url(a);var d="GET",e="binary",f=!1,g=b.extend({},m,{url:a,type:d,dataType:e,processData:f});return delete g.contentType,l.info("ajax binary GET",g.url),y(g,c)},c.prototype.post=function(c,d,e){c=q(this,c),d=a.isObject(d)?JSON.stringify(d):d;var f="POST",g=b.extend({},m,{url:c,type:f,data:d});return l.info("ajax POST",d,e),y(g,e)},c.prototype.put=function(c,d,e){return l.info("ajax PUT",d,e),c=q(this,c),y(b.extend({},m,{url:c,type:"PUT",
data:a.isObject(d)?JSON.stringify(d):d}),e)},c.prototype.delete=function(a,c){a=q(this,a);var d=b.extend({},m,{url:a,type:"DELETE"});return l.info("ajax DELETE",d.url),y(d,c)},c.isMultiTenant=function(){return k()},c.prototype.protocol=function(){return n.useSecureConnection?"https":"http"},c.prototype.baseUrl=function(){return z(this)},c}();o=__decorate([c.dependsOn(d)],o),o.factory=function(){return p()?new h:new o};function p(){return!!window.PredixSDK}function q(a,b){return b=(new f).isMobileApp()?z(a)+"meridium/"+A(b):A(b)}function r(a){return s(a)?u(a):x()}function s(a){return!!a&&(t(a)||u(a))}function t(a){return a.toLowerCase().indexOf("http://")>-1}function u(a){return a.toLowerCase().indexOf("https://")>-1}function v(a){return a?a.toLowerCase().replace("https://","").replace("http://",""):a}function w(a){return a?a.toString().replace(/\//g,""):a}function x(){return"https:"===location.protocol}function y(a,c){var d=i.resolve(f),e=i.resolve(g)
;return d.isMobile()&&e.getManualOfflineStatus()?b.ajax({beforeSend:function(a){a.abort("error")}}):b.ajax(b.extend({},a,c))}function z(a){return n.server?a.protocol()+"://"+n.server+"/":""}function A(a){return a&&"/"===a.charAt(0)&&(a=a.substring(0).slice(1)),a}return o});
define('admin-menu/predix/predix-operations-security',["require","exports","system/http/ajax-client","ramda"],function(require,exports,a,b){"use strict";var c=function(){function a(){}return a.hasSmartSignalTenantAccess=function(){if(e())return f("ssTenantMicroapp.0")},a.hasSmartSignalHostAccess=function(){if(e())return f("ssHostMicroapp.0")},a.hasSmartSignalMaintenanceAccess=function(){if(e())return f("ssMaintenanceMicroApp.0")},a.hasSmartSignalMappingsAccess=function(){if(e())return f("ssAnalyticMicroapp.0")},a.hasSmartSignalMonitorAccess=function(){if(e())return f("ssMonitorUIMicroapp.0")},a.hasTimeSeriesAccess=function(){if(e())return f("timeseriesmicroapp.0")},a.hasDataIngestionAccess=function(){if(e())return f("dataIngestion.0")},a.hasSmartSignalAssetAccess=function(){if(e())return d("ssAnalyticMicroapp.0","ssAnalyticMicroapp.0.1")},a.hasExtensibilityToolAccess=function(){if(e())return f("apmproductmicroapp.0")},a.hasProductPackagesAccess=function(){if(e())return f("apmproductupgrademicroapp.0")},
a.hasTagMapperAccess=function(){if(e())return f("tagmapper-ui.0")},a.hasAccess=function(a){if(e())return f(a)},a}();function d(a,c){var d=b.find(b.propEq("id",a))(g());if(d&&d.items){return!!b.find(b.propEq("id",c))(d.items)}return!1}function e(){return a.isMultiTenant()&&!!g()}function f(a){return!!b.find(b.propEq("id",a))(g())}function g(){return b.path(["nav","main","items"],window)}return c});
define('admin-menu/views/components/menu-configuration-manager',['require','react','ramda','system/react/react-common','application/application-events','application/application-context','security/model/groups','system/http/ajax-client','admin-menu/predix/predix-operations-security'],function(require){"use strict";var a=require("react"),b=require("ramda"),c=require("system/react/react-common"),d=require("application/application-events"),e=require("application/application-context"),f=require("security/model/groups"),g=require("system/http/ajax-client"),h=require("admin-menu/predix/predix-operations-security"),i="../Subsystems/FoundationConfiguration/Content/ConfigurationManagerOverview.htm",j="CONFIGURATION_MANAGER",k="tab-icon-data-config",l=a.DOM.ul,m=a.DOM.li,n=a.DOM.a,o=a.DOM.i,p=a.DOM.header,q=a.DOM.nav,r=a.DOM.abbr,s=a.DOM.footer;function t(a){var b=a.vm;if(b.validateContent())return u()?v(b):void w()}function u(){return f.isSuperUser()||f.hasMIConfigurationRole()||f.hasMISecurityRole()||f.hasMIPowerUserRole()||f.hasAPMNowAdmin()}function v(a){return a.setTitle(j,k),a.activateHelp(i),x(a)}function w(){Object.resolve(d).navigate.raise("access-denied")}function x(a){var b=E(a),c=y.bind(null,a);return l({className:"block-group list-unstyled"},b.map(c))}
function y(a,b){return m({className:b.enabled?"block":"hidden",key:b.href},n({style:z(b),href:b.href,icon:b.icon},A(b,a)),D(b,a))}function z(a){return{width:"80px",cursor:"pointer",textDecoration:"none"}}function A(a,b){return a.icon?B(a):C(a,b)}function B(a){return p({className:"header"},q(null,o({className:a.icon})))}function C(a,b){return p({className:"header"},q(null,r({className:"abbr"},b.translate(a.abbr))))}function D(a,b){return s({className:"footer"},n({href:a.href},b.translate(a.caption)))}function E(a){var c=f.isSuperUser()||f.hasMIConfigurationRole(),d=[{caption:a.translate("FMLY_MGMT_TAB"),href:"#dcm/family-management",icon:"admin-icon-FamilyManagement",enabled:c||f.hasAPMNowAdmin()},{caption:a.translate("SYSTEM_CODES_AND_TABLES"),href:"#dcm/system-codes-tables",icon:"admin-icon-SystemCodesandTables",enabled:c||f.hasAPMNowAdmin()},{caption:a.translate("UNITS_OF_MEASURE_AND_CONVERSIONS"),href:"#dcm/units-of-measure",icon:"admin-icon-UnitsofMeasureandConversion",
enabled:c||f.hasAPMNowAdmin()},{caption:a.translate("MANAGE_TRANSLATIONS"),href:"#dcm/manage-translations",icon:"admin-icon-ManageTranslations",done:"yes",enabled:c&&!g.isMultiTenant()},{caption:a.translate("IMPORT"),href:"#export-import/import",icon:"admin-icon-Import",enabled:c||f.hasMISecurityRole()},{caption:a.translate("EXPORT_EXPORT"),href:"#export-import/export",icon:"admin-icon-Export",enabled:c||f.hasMISecurityRole()},{caption:a.translate("DCM_CONTENT_VALID"),href:"#dcm/content-validation",icon:"admin-icon-ContentValidation2",enabled:c&&!g.isMultiTenant()},{caption:a.translate("SITES"),href:"#security/manager/site",icon:"admin-icon-DataFilters",enabled:c||f.hasAPMNowAdmin()},{caption:a.translate("DATA_PERMISSIONS"),href:"#security/manager/fmlypriv",icon:"admin-icon-DataPermissions",enabled:c||f.hasAPMNowAdmin()||f.hasMISecurityRole()},{caption:a.translate("CONTENT_CHANGE_MANAGEMENT"),href:"#content-management",icon:"admin-icon-ContentManagement",
enabled:c&&!g.isMultiTenant()&&1!==e.hostingEnvironment},{caption:a.translate("EXTENSIBILITY_TOOL"),href:"#app-hub/products/#",icon:"admin-icon-Extensibility-Tools",enabled:u()&&h.hasExtensibilityToolAccess()}];return b.reject(b.propEq("enabled",!1),d)}return t});
define('admin-menu/views/components/menu-operations-manager',['require','react','ramda','system/react/react-common','application/application-events','system/hardware/device','security/model/licenses','security/model/groups','system/http/ajax-client','admin-menu/predix/predix-operations-security'],function(require){"use strict";var a=require("react"),b=require("ramda"),c=require("system/react/react-common"),d=require("application/application-events"),e=require("system/hardware/device"),f=require("security/model/licenses"),g=require("security/model/groups"),h=require("system/http/ajax-client"),i=require("admin-menu/predix/predix-operations-security"),j="../Subsystems/Operations/Content/OperationsManagerOverview.htm",k="OPERATIONS_MANAGER",l="tab-icon-operations-manager",m=a.DOM.ul,n=a.DOM.li,o=a.DOM.a,p=a.DOM.i,q=a.DOM.header,r=a.DOM.nav,s=a.DOM.abbr,t=a.DOM.footer;function u(a){if(E())return v(a.vm);x()}function v(a){return a.setTitle(k,l),a.activateHelp(j),w(a)}function w(a){var b=H(a),c=y.bind(null,a);return m({className:"block-group list-unstyled"},b.map(c))}function x(){Object.resolve(d).navigate.raise("access-denied")}function y(a,b){return n({className:b.enabled?"block":"hidden",key:b.href},o({style:z(b),href:b.href,icon:b.icon},A(b,a)),D(b,a))}function z(a){return{
width:"80px",cursor:"pointer",textDecoration:"none"}}function A(a,b){return a.icon?B(a):C(a,b)}function B(a){return q({className:"header"},r(null,p({className:a.icon})))}function C(a,b){return q({className:"header"},r(null,s({className:"abbr"},b.translate(a.abbr))))}function D(a,b){return t({className:"footer"},o({href:a.href},b.translate(a.caption)))}function E(){return g.isSuperUser()||g.hasMIConfigurationRole()||g.hasAPMNowAdmin()}function F(){return g.isSuperUser()||g.hasMIConfigurationRole()}function G(){return!Object.resolve(e).isMobile()&&(g.isSuperUser()||g.hasMIConfigurationRole())}function H(a){var c=[{caption:a.translate("LICENSING"),href:"#licensing",icon:"admin-icon-Licensing",enabled:F()},{caption:a.translate("APMCONNECT_EAM_JOBS"),href:"#connect-eam-jobs",icon:"admin-icon-DataImport",enabled:E()},{caption:a.translate("ASSET_HIERARCHY_CONFIG"),href:"#operations-manager/asset-hierarchy",icon:"admin-icon-AssetHierarchy",enabled:E()},{caption:a.translate("CONNECTIONS"),
href:"#connections",icon:"admin-icon-Connections",enabled:F()},{caption:a.translate("CROSS_DOMAIN_CONFIG"),href:"#operations-manager/crossdomain",icon:"admin-icon-cross-domain-configuration",enabled:F()&&!h.isMultiTenant()},{caption:a.translate("SEC_SHELL_DATA_SOURCES"),href:"#operations-manager/datasource",icon:"admin-icon-DataSources",enabled:G()&&!h.isMultiTenant()},{caption:a.translate("HOSTNAMES"),href:"#operations-manager/hostnames",icon:"admin-icon-HostName",enabled:F()&&!h.isMultiTenant()},{caption:a.translate("EMAIL_SETTINGS"),href:"#operations-manager/emailsettings",icon:"admin-icon-EmailSettings",enabled:F()&&!h.isMultiTenant()||g.hasAPMNowAdmin()},{caption:a.translate("GIS_CONFIGURATION"),href:"#gis-config",icon:"admin-icon-GISConfiguration",enabled:F()&&!h.isMultiTenant()},{caption:a.translate("INGESTION_SETUP"),href:"#app-hub/dataingestion",icon:"admin-icon-Asset-Ingestion",enabled:E()&&i.hasDataIngestionAccess()},{caption:a.translate("MONITORING"),href:"#monitoring",
icon:"admin-icon-Monitoring",enabled:F()&&!h.isMultiTenant()},{caption:a.translate("QUERY_TIMEOUTS"),href:"#query-timeout",icon:"admin-icon-QueryTimeouts",enabled:E()},{caption:a.translate("REFDOCSERVER"),href:"#refdoc-server-config",icon:"admin-icon-SQLServerReport",enabled:F()},{caption:a.translate("RISK_MATRIX"),href:"#risk-matrix",icon:"admin-icon-RiskMatrix",enabled:E()},{caption:a.translate("SCHEDULE_LOGS"),href:"#scheduling/dashboard",icon:"admin-icon-Scheduling",enabled:E()},{caption:a.translate("SEARCH_CONFIG"),href:"#operations-manager/search-config",icon:"admin-icon-Search",enabled:E()},{caption:a.translate("SMARTSIGNAL_HOSTS"),href:"#app-hub/ss-host",icon:"admin-icon-SmartSignal-Hosts",enabled:E()&&i.hasSmartSignalHostAccess()},{caption:a.translate("SMARTSIGNAL_MAPPINGS"),href:"#app-hub/ss-analytic",icon:"admin-icon-SmartSignal-Mappings",enabled:E()&&i.hasSmartSignalMappingsAccess()},{caption:a.translate("SMARTSIGNAL_TENANTS"),href:"#app-hub/ss-tenant",
icon:"admin-icon-SmartSignal-Tenants",enabled:E()&&i.hasSmartSignalTenantAccess()},{caption:a.translate("SMARTSIGNAL_MAINTENANCE"),href:"#app-hub/ss-maintenance",icon:"admin-icon-SmartSignal-Maintenance",enabled:E()&&i.hasSmartSignalMaintenanceAccess()},{caption:a.translate("SMARTSIGNAL_ASSETS"),href:"#app-hub/ss-analytic/#/uploadassets",icon:"admin-icon-SmartSignal-Mappings",enabled:E()&&i.hasSmartSignalAssetAccess()},{caption:a.translate("SMARTSIGNAL_DEPLOYMENTS"),href:"#app-hub/apm-sm-monitor-ui",icon:"fa fa-heartbeat",enabled:E()&&i.hasSmartSignalMonitorAccess()},{caption:a.translate("REPORT_CONFIGURATION"),href:"#report-config",icon:"admin-icon-Content-Management2",enabled:F()},{caption:a.translate("STRATEGY_MACROS"),href:"#operations-manager/macros",icon:"admin-icon-MappingandFiltering",enabled:E()},{caption:a.translate("TIME_SERIES_DATA"),href:"#app-hub/datasources",icon:"admin-icon-Time-Series-Data",enabled:E()&&i.hasTimeSeriesAccess()},{
caption:a.translate("APM_System_Monitoring"),href:"#apmmonitoring",icon:"admin-icon-Monitoring",enabled:F()&&!h.isMultiTenant()},{caption:a.translate("GE_ASSET_VIEW_TITLE"),href:"#systems-and-tags/assets-view",icon:"admin-icon-SystemsandTags",enabled:F()&&!h.isMultiTenant()},{caption:a.translate("PRODUCT_PACKAGES"),href:"#app-hub/products/#/upgrade",icon:"admin-icon-Product-Packages",enabled:E()&&i.hasProductPackagesAccess()},{caption:a.translate("TAG_ASSET_MAPPER"),href:"#app-hub/tagmapper/#",icon:"admin-icon-SystemsandTags",enabled:i.hasTagMapperAccess()}];return b.reject(b.propEq("enabled",!1),c)}return u});
define('admin-menu/views/components/menu-security-manager',['require','ramda','react','system/react/react-common','application/application-events','security/model/groups'],function(require){"use strict";var a=require("ramda"),b=require("react"),c=require("system/react/react-common"),d=require("application/application-events"),e=require("security/model/groups"),f="../Subsystems/SecurityManager/Content/SecurityManagerOverview.htm",g="SEC_SHELL_SECURITY_MGR",h="tab-icon-security-manager",i=b.DOM.ul,j=b.DOM.li,k=b.DOM.a,l=b.DOM.i,m=b.DOM.header,n=b.DOM.nav,o=b.DOM.abbr,p=b.DOM.footer;function q(a){if(C())return r(a.vm);t()}function r(a){return a.setTitle(g,h),a.activateHelp(f),s(a)}function s(a){var b=D(a),c=u.bind(null,a);return i({className:"block-group list-unstyled"},b.map(c))}function t(){Object.resolve(d).navigate.raise("access-denied")}function u(a,b){return b.visible?v(b,a):""}function v(a,b){return j({className:a.enabled?"block":"hidden",key:a.href},k({style:w(a),href:a.href,icon:a.icon},x(a,b)),A(a,b))}function w(a){return{width:"80px",cursor:"pointer",textDecoration:"none"}}function x(a,b){return a.icon?y(a):z(a,b)}function y(a){return m({
className:"header"},n(null,l({className:a.icon})))}function z(a,b){return m({className:"header"},n(null,o({className:"abbr"},b.translate(a.abbr))))}function A(a,b){return p({className:"footer"},k({href:a.href},b.translate(a.caption)))}function B(){return e.isSuperUser()||e.hasMISecurityRole()}function C(){return e.isSuperUser()||e.hasMISecurityRole()||e.hasAPMNowAdmin()}function D(b){var c=[{caption:b.translate("USERS"),href:"#security/manager/user",icon:"admin-icon-User",enabled:B(),visible:!0},{caption:b.translate("GROUPS"),href:"#security/manager/group",icon:"admin-icon-Groups",enabled:B(),visible:!0},{caption:b.translate("ROLES"),href:"#security/manager/role",icon:"admin-icon-Roles",enabled:B(),visible:!0},{caption:b.translate("SEC_SHELL_PWD_POLICY"),href:"#security/manager/password",icon:"admin-icon-PasswordPolicy",enabled:B(),visible:!0},{caption:b.translate("LDAP"),href:"#security/manager/ldap",icon:"admin-icon-LDAP",enabled:B(),visible:b.notMobile()},{
caption:b.translate("USER_DEFAULTS"),href:"#security/manager/userdefaults",icon:"admin-icon-DataPermissions",enabled:C(),visible:!0}];return a.reject(a.either(a.propEq("visible",!1),a.propEq("enabaled",!1)),c)}return q});
define('admin-menu/views/admin-menu-view',['require','react','system/react/react-common','application/application-events','./components/menu-application-settings','./components/menu-configuration-manager','./components/menu-operations-manager','./components/menu-security-manager'],function(require){"use strict";var a=require("react"),b=require("system/react/react-common"),c=require("application/application-events"),d=require("./components/menu-application-settings"),e=require("./components/menu-configuration-manager"),f=require("./components/menu-operations-manager"),g=require("./components/menu-security-manager"),h=b.withEventProperty,i=a.DOM.div;function j(a){return k([l(a.vm)])}function k(a){return i({className:"admin-menu-shell"},i({className:"admin-menu"},a))}function l(a){switch(a.currentUrl()){case"application-settings":return m(a);case"data-configuration":return n(a);case"operations-manager":return o(a);case"security-manager":return p(a);default:q()}}function m(b){return a.createElement(d,{vm:b,key:null})}function n(b){return a.createElement(e,{vm:b,key:null})}function o(b){return a.createElement(f,{vm:b,key:null})}function p(b){return a.createElement(g,{vm:b,key:null})}function q(){Object.resolve(c).navigate.raise("url-not-supported")}return j});
define('system/collections/list',["require","exports","jquery","knockout","system/lang/object"],function(require,exports,a,b,c){"use strict";return function(){function d(a){void 0===a&&(a=[]),this.items=a}return d.indexOf=function(b,c){var d=-1;return a.isArray(b)===!1?d:(a.each(b,function(a,b){if(c(b,a)===!0)return d=a,!1}),d)},d.sort=function(a,c,d,e){function f(a,b){return a&&b||!a&&!b?0:a?1:-1}function g(a,b){return a===b?0:a<b?-1:1}function h(a,b){var c=a.toString().toLocaleLowerCase(),d=b.toString().toLocaleLowerCase();return c===d?0:c<d?-1:1}function i(a,i){var j=b.utils.unwrapObservable(d?a[d]:a),k=b.utils.unwrapObservable(d?i[d]:i);e=e||typeof j;var l;switch(e){case"boolean":l=f(j,k);break;case"number":l=j-k;break;case"datetime":l=g(j,k);break;default:l=h(j,k)}return c||(l=0-l),l}a.sort(i)},d.fillArray=function(a,b,c){for(;b--;)a[b]=c;return a},d.prototype.count=function(){return this.items.length},d.prototype.add=function(a){this.items[this.count()]=a},d.prototype.item=function(a){
return a<0&&(a+=this.count()),this.items[a]},d.prototype.clear=function(){this.items.length=0},d.prototype.indexOf=function(a){return this.items.indexOf(a)},d.prototype.contains=function(a){return this.indexOf(a)!==-1},d.prototype.addRange=function(a){a.forEach(this.add,this)},d.prototype.forEach=function(a,b){for(var c=0;c!==this.count();c++)a.call(b,this.item(c),c,this)},d.prototype.map=function(a,b){for(var d=c.resolve(this.constructor),e=0;e!==this.count();e++)d.add(a.call(b,this.item(e),e,this));return d},d.prototype.take=function(a){var b;return b=a>=0?this.items.slice(0,a):this.items.slice(a),c.resolve(this.constructor,b)},d.prototype.shift=function(){return this.items.shift()},d.prototype.pop=function(){return this.items.pop()},d.prototype.moveToEnd=function(a){this.remove(a),this.add(a)},d.prototype.remove=function(a){var b=this.indexOf(a);b!==-1&&this.items.splice(b,1)},d.prototype.createArrayIndex=function(a,b){var c={};if(a)for(var d=0;d<a.length;d++)c[a[d][b]]=a[d]
;return c},d}()});
define('system/collections/observable-list',["require","exports","knockout"],function(require,exports,a){"use strict";return function(){function b(b){void 0===b&&(b=[]),this.items=a.observableArray(b)}return b.prototype.count=function(){return this.items().length},b.prototype.item=function(a){return this.items()[a]},b.prototype.add=function(a){this.items.push(a)},b.prototype.remove=function(a){return this.items.remove(a)},b.prototype.clear=function(){this.items([])},b.prototype.indexOf=function(a){return this.items.indexOf(a)},b.prototype.moveUp=function(a){var b=this.items.indexOf(a);0!==b&&(this.items()[b]=this.items()[b-1],this.items()[b-1]=a,this.items.valueHasMutated())},b.prototype.moveDown=function(a){var b=this.items.indexOf(a);b!==this.items().length-1&&(this.items()[b]=this.items()[b+1],this.items()[b+1]=a,this.items.valueHasMutated())},b.prototype.dispose=function(){this.items([])},b}()});
define('system/knockout/change-tracker',["require","exports","knockout","ramda"],function(require,exports,a,b){"use strict";var c=function(){function b(b,c,f){void 0===c&&(c=a.toJSON),void 0===f&&(f=!1),this.hashFunction=c,this.objectToTrack=b,this.lastCleanState=a.observable(),f||this.lastCleanState(e(this)),this.isDirty=a.computed(d.bind(null,this))}return b.prototype.markCurrentStateAsClean=function(){this.lastCleanState(e(this))},b.prototype.dispose=function(){this.isDirty.dispose(),this.lastCleanState(null)},b}();function d(a){return e(a)!==a.lastCleanState()}function e(a){var c=a.hashFunction.apply(a.objectToTrack);return b.is(Object,c)?JSON.stringify(c):c}return c});
define('system/lang/functional',['require','ramda'],function(require){"use strict";var a=require("ramda");function b(){}function c(b,c){return a.is(Function,c[b])?c[b]():c[b]}function d(a,b){return console[a](b),b}function e(a){return a}function f(){return Array.prototype.join.call(arguments,"")}function g(b){if(a.is(Function,b)){var c=Array.prototype.slice.call(arguments,1);return setTimeout(function(){b.apply(void 0,c)},1)}}var h=a.either(a.identity,function(){return{}}),i=a.either(a.identity,function(){return[]});return{noop:b,identity:a.identity,areSame:a.identical,result:a.curry(c),log:d.bind(null,"log"),trace:d.bind(null,"trace"),warn:d.bind(null,"warn"),error:d.bind(null,"error"),debug:e,str:f,defer:g,defaultToObject:h,defaultToArray:i}});
define('system/knockout/knockout-manager',["require","exports","knockout","system/collections/list","system/collections/observable-list","./change-tracker","system/lang/functional"],function(require,exports,a,b,c,d){"use strict";var e=require("system/lang/functional");return function(){function f(a){void 0===a&&(a=e.noop),this.observables=new b,this.computeds=new b,this.subscriptions=new b,this.tracker=new d(this,a),this.isDirty=this.tracker.isDirty}return f.prototype.observable=function(){var b=a.observable.apply(null,Array.prototype.splice.call(arguments,0));return this.observables.add(b),b},f.prototype.observableArray=function(){var b=a.observableArray.apply(null,Array.prototype.splice.call(arguments,0));return this.observables.add(b),b},f.prototype.observableList=function(a){var b=new c(a);return this.observables.add(b),b},f.prototype.computed=function(b){var c=a.computed.apply(null,Array.prototype.splice.call(arguments,0));return this.computeds.add(c),c},f.prototype.pureComputed=function(b){
var c=a.pureComputed.apply(null,Array.prototype.splice.call(arguments,0));return this.computeds.add(c),c},f.prototype.subscribe=function(a,b,c,d){var e=a.subscribe(b,c,d);return this.subscriptions.add(e),e},f.prototype.dispose=function(){this.disposeSubscriptions(),this.disposeComputeds(),this.disposeObservables(),this.tracker.dispose()},f.prototype.disposeSubscriptions=function(){this.subscriptions.forEach(function(a){a.dispose()}),this.subscriptions.clear()},f.prototype.disposeComputeds=function(){this.computeds.forEach(function(a){a.dispose()}),this.computeds.clear()},f.prototype.disposeObservables=function(){this.observables.forEach(function(a){a.dispose?a.dispose():a(null)}),this.observables.clear()},f.prototype.createHash=function(){return this.observables.items.map(function(a){return a()})},f}()});
define('system/error/error-message',["require","exports"],function(require,exports){"use strict";return function(){function a(a,b,c){void 0===c&&(c=null),this.code=a,this.message=b,this.detail=c}return a.fromHttpResponse=function(b,c,d){if(c.responseText){var e=d?d+c.responseText:c.responseText;return new a(b,this.fromDetail(e),c.responseText)}var e=d?d+c.statusText:c.statusText;return new a(b,e)},a.fromDetail=function(a){return a=a.replace("\r\n"," ").replace("\n","").replace("\r",""),a.length>512&&(a=a.substring(0,510)+".."),a},a}()});
define('spa/conductor',["require","exports","jquery","system/lang/ioc","system/diagnostics/log-manager","application/application-events","system/error/error-message","system/globalization/translator"],function(require,exports,a,b,c,d,e,f){"use strict";var g=c.getLogger("spa/conductor"),h="FND1",i="PAGE_NOT_LOADED",j=function(){function b(a,b){this.errorOccured=a.errorOccured,this.translator=b}return b.prototype.activateScreen=function(a,b){try{return k(this,a,b)}catch(a){l(this,a)}},b.prototype.createArgumentArray=function(a,b){return void 0===b&&(b=[]),g.isTraceEnabled()&&g.trace("create argument array"),a?(a.named&&b.push(a.named),Array.prototype.push.apply(b,a.positional),b):b},b.prototype.reuseScreen=function(a,b,c){try{return m(this,a,b,c)}catch(a){l(this,a)}},b.prototype.deactivateScreen=function(a){try{n(a)}catch(a){l(this,a)}},b.prototype.canUnloadScreen=function(a){try{return o(a)}catch(a){return l(this,a),!1}},b.prototype.attachScreen=function(a,b,c){try{p(a,b,c)}catch(a){l(this,a)}},
b.prototype.detachScreen=function(a){try{q(a)}catch(a){l(this,a)}},b.prototype.canReuseScreen=function(a,b,c){try{return r(this,a,b,c)}catch(a){return l(this,a),!1}},b.prototype.openScreen=function(a,b){try{s(this,a,b)}catch(a){l(this,a)}},b.prototype.loadScreen=function(a,b){try{t(this,a,b)}catch(a){l(this,a)}},b.prototype.closeScreen=function(a){try{u(a)}catch(a){l(this,a)}},b.prototype.unloadScreen=function(a){try{v(a)}catch(a){l(this,a)}},b.prototype.changeScreen=function(b,d,e,f){void 0===e&&(e={});var h=d.screen,i={isClosing:!0,checkForReuse:!0,checkForUnload:!1};if(c.pushContext(w(b)+" from "+w(h)),a.extend(i,f),i.checkForReuse&&this.canReuseScreen(h,b,e))return g.isDebugEnabled()&&g.debug("Reusing previous screen."),void this.reuseScreen(h,d,e);this.openScreen(b,e),this.loadScreen(b,e),this.deactivateScreen(h),this.activateScreen(b,e),this.detachScreen(d),this.attachScreen(b,d,e.url),i.isClosing&&b!==h&&(g.isDebugEnabled()&&g.debug("closing previous screen."),
this.unloadScreen(h),this.closeScreen(h)),c.popContext()},b.prototype.hideScreen=function(a){this.deactivateScreen(a.screen),this.detachScreen(a)},b.prototype.clearScreen=function(a){this.changeScreen(null,a),a.screen=null},b.prototype.showScreen=function(a,b){this.activateScreen(a.screen),this.attachScreen(a.screen,a,b)},b}();j=__decorate([b.dependsOn(d,f)],j);function k(a,b,c){if(g.isTraceEnabled()&&g.trace("activating screen"),(!b||!b.isActive)&&b&&(b.isActive=!0,b.activate)){var d=a.createArgumentArray(c);return b.activate.apply(b,d)}}function l(a,b){var c,d;c=b&&b.message?b.message:b instanceof Object?JSON.stringify(b):b,d=b.stack?b.stack:(new Error).stack;var f=a.translator.translate(i),g=new e(h,f,c+"\n"+d);a.errorOccured.raise(a,g)}function m(a,b,c,d){if(g.isTraceEnabled()&&g.trace("reuse screen"),b.reuse){var e=a.createArgumentArray(d,[c,d.url]);return b.reuse.apply(b,e)}}function n(a){g.isTraceEnabled()&&g.trace("deactivating screen"),a&&!a.isActive||a&&(a.isActive=!1,
a.deactivate&&a.deactivate())}function o(a){return g.isTraceEnabled()&&g.trace("can deactivate screen"),!a||!a.canUnload||a.canUnload()}function p(a,b,c){a&&a.isAttached===!0||(g.isTraceEnabled()&&g.trace("attaching screen"),a&&a.attach&&(a.attach(b,c),b.screen=a,a.isAttached=!0))}function q(a){g.isTraceEnabled()&&g.trace("detaching screen"),a&&a.screen&&(a&&a.screen&&!a.screen.isAttached||a.screen.detach&&(a.screen.detach(a),a.screen.isAttached=!1))}function r(a,b,c,d){var e=!0;if(g.isTraceEnabled()&&g.trace("can reuse screen: ",w(c)),!c||!b||c.constructor!==b.constructor)return!1;if(c.canReuse){var f=a.createArgumentArray(d);e=c.canReuse.apply(c,f)}else c.reuse||(e=!1);return e!==!1}function s(a,b,c){if(g.isTraceEnabled()&&g.trace("opening screen"),b&&!b.isOpen){if(b.open){var d=a.createArgumentArray(c);d[d.length]=c.url,b.open.apply(b,d)}b.isOpen=!0}}function t(a,b,c){if(g.isTraceEnabled()&&g.trace("load screen"),b&&!b.isLoaded){if(b.load){var d=a.createArgumentArray(c)
;b.load.apply(b,d)}b.isLoaded=!0}}function u(a){g.isTraceEnabled()&&g.trace("closing screen"),a&&a.isOpen&&(a.close&&a.close(),a.isOpen=!1)}function v(a){g.isTraceEnabled()&&g.trace("unload screen"),a&&a.isLoaded&&(a.unload&&a.unload(),a.isLoaded=!1)}function w(a){return a?a.constructor&&a.constructor.name?a.constructor.name:a.constructor?a.constructor:a.toString():a}return j});
define('spa/region',["require","exports","jquery"],function(require,exports,a){"use strict";var b=8,c=function(){function a(a){this.element=null,this.$element=null,this.setElement(a),this.activeContainer=null,this.screen=null}return a.prototype.setElement=function(a){var b=d(a);this.element=e(b),this.$element=h(b),i(this)},a.prototype.attach=function(a){this.clear(),this.activeContainer=j(),k(this,a),l(this)},a.prototype.clear=function(){this.activeContainer&&(n(this),i(this))},a.prototype.remove=function(){if(!this.$element)throw new Error("region.$element is null");this.$element.remove()},a.prototype.dispose=function(){this.clear(),this.detach(),this.screen=null},a.prototype.detach=function(){this.element=null,this.$element=null},a.prototype.removeAndDispose=function(){this.remove(),this.dispose()},a}();function d(a){return a||document.createElement("div")}function e(a){return f(a)?g(a):a}function f(b){return b instanceof a}function g(a){return a.get(0)}function h(b){return f(b)?b:a(b)}
function i(a){if(!a.$element)throw new Error("region.$element is null");a.$element.empty()}function j(){var a=document.createElement("div");return a.classList.add("region"),a}function k(b,c){a(b.activeContainer).append(c)}function l(a){if(m(a.element)){if(!a.$element)throw new Error("region.$element is null");a.$element.after(a.activeContainer)}else{if(!a.element)throw new Error("region.element is null");a.element.appendChild(a.activeContainer)}}function m(a){return!!a&&a.nodeType===b}function n(b){a(b.activeContainer).remove(),b.activeContainer=null}return c});
/**
 * @license RequireJS text 2.0.9 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */
/*jslint regexp: true */
/*global require, XMLHttpRequest, ActiveXObject,
  define, window, process, Packages,
  java, location, Components, FileUtils */

define('text',['module'], function (module) {
    'use strict';

    var text, fs, Cc, Ci, xpcIsWindows,
        progIds = ['Msxml2.XMLHTTP', 'Microsoft.XMLHTTP', 'Msxml2.XMLHTTP.4.0'],
        xmlRegExp = /^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,
        bodyRegExp = /<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,
        hasLocation = typeof location !== 'undefined' && location.href,
        defaultProtocol = hasLocation && location.protocol && location.protocol.replace(/\:/, ''),
        defaultHostName = hasLocation && location.hostname,
        defaultPort = hasLocation && (location.port || undefined),
        buildMap = {},
        masterConfig = (module.config && module.config()) || {};

    text = {
        version: '2.0.9',

        strip: function (content) {
            //Strips <?xml ...?> declarations so that external SVG and XML
            //documents can be added to a document without worry. Also, if the string
            //is an HTML document, only the part inside the body tag is returned.
            if (content) {
                content = content.replace(xmlRegExp, "");
                var matches = content.match(bodyRegExp);
                if (matches) {
                    content = matches[1];
                }
            } else {
                content = "";
            }
            return content;
        },

        jsEscape: function (content) {
            return content.replace(/(['\\])/g, '\\$1')
                .replace(/[\f]/g, "\\f")
                .replace(/[\b]/g, "\\b")
                .replace(/[\n]/g, "\\n")
                .replace(/[\t]/g, "\\t")
                .replace(/[\r]/g, "\\r")
                .replace(/[\u2028]/g, "\\u2028")
                .replace(/[\u2029]/g, "\\u2029");
        },

        createXhr: masterConfig.createXhr || function () {
            //Would love to dump the ActiveX crap in here. Need IE 6 to die first.
            var xhr, i, progId;
            if (typeof XMLHttpRequest !== "undefined") {
                return new XMLHttpRequest();
            } else if (typeof ActiveXObject !== "undefined") {
                for (i = 0; i < 3; i += 1) {
                    progId = progIds[i];
                    try {
                        xhr = new ActiveXObject(progId);
                    } catch (e) {}

                    if (xhr) {
                        progIds = [progId];  // so faster next time
                        break;
                    }
                }
            }

            return xhr;
        },

        /**
         * Parses a resource name into its component parts. Resource names
         * look like: module/name.ext!strip, where the !strip part is
         * optional.
         * @param {String} name the resource name
         * @returns {Object} with properties "moduleName", "ext" and "strip"
         * where strip is a boolean.
         */
        parseName: function (name) {
            var modName, ext, temp,
                strip = false,
                index = name.indexOf("."),
                isRelative = name.indexOf('./') === 0 ||
                             name.indexOf('../') === 0;

            if (index !== -1 && (!isRelative || index > 1)) {
                modName = name.substring(0, index);
                ext = name.substring(index + 1, name.length);
            } else {
                modName = name;
            }

            temp = ext || modName;
            index = temp.indexOf("!");
            if (index !== -1) {
                //Pull off the strip arg.
                strip = temp.substring(index + 1) === "strip";
                temp = temp.substring(0, index);
                if (ext) {
                    ext = temp;
                } else {
                    modName = temp;
                }
            }

            return {
                moduleName: modName,
                ext: ext,
                strip: strip
            };
        },

        xdRegExp: /^((\w+)\:)?\/\/([^\/\\]+)/,

        /**
         * Is an URL on another domain. Only works for browser use, returns
         * false in non-browser environments. Only used to know if an
         * optimized .js version of a text resource should be loaded
         * instead.
         * @param {String} url
         * @returns Boolean
         */
        useXhr: function (url, protocol, hostname, port) {
            var uProtocol, uHostName, uPort,
                match = text.xdRegExp.exec(url);
            if (!match) {
                return true;
            }
            uProtocol = match[2];
            uHostName = match[3];

            uHostName = uHostName.split(':');
            uPort = uHostName[1];
            uHostName = uHostName[0];

            return (!uProtocol || uProtocol === protocol) &&
                   (!uHostName || uHostName.toLowerCase() === hostname.toLowerCase()) &&
                   ((!uPort && !uHostName) || uPort === port);
        },

        finishLoad: function (name, strip, content, onLoad) {
            content = strip ? text.strip(content) : content;
            if (masterConfig.isBuild) {
                buildMap[name] = content;
            }
            onLoad(content);
        },

        load: function (name, req, onLoad, config) {
            //Name has format: some.module.filext!strip
            //The strip part is optional.
            //if strip is present, then that means only get the string contents
            //inside a body tag in an HTML string. For XML/SVG content it means
            //removing the <?xml ...?> declarations so the content can be inserted
            //into the current doc without problems.

            // Do not bother with the work if a build and text will
            // not be inlined.
            if (config.isBuild && !config.inlineText) {
                onLoad();
                return;
            }

            masterConfig.isBuild = config.isBuild;

            var parsed = text.parseName(name),
                nonStripName = parsed.moduleName +
                    (parsed.ext ? '.' + parsed.ext : ''),
                url = req.toUrl(nonStripName),
                useXhr = (masterConfig.useXhr) ||
                         text.useXhr;

            //Load the text. Use XHR if possible and in a browser.
            if (!hasLocation || useXhr(url, defaultProtocol, defaultHostName, defaultPort)) {
                text.get(url, function (content) {
                    text.finishLoad(name, parsed.strip, content, onLoad);
                }, function (err) {
                    if (onLoad.error) {
                        onLoad.error(err);
                    }
                });
            } else {
                //Need to fetch the resource across domains. Assume
                //the resource has been optimized into a JS module. Fetch
                //by the module name + extension, but do not include the
                //!strip part to avoid file system issues.
                req([nonStripName], function (content) {
                    text.finishLoad(parsed.moduleName + '.' + parsed.ext,
                                    parsed.strip, content, onLoad);
                });
            }
        },

        write: function (pluginName, moduleName, write, config) {
            if (buildMap.hasOwnProperty(moduleName)) {
                var content = text.jsEscape(buildMap[moduleName]);
                write.asModule(pluginName + "!" + moduleName,
                               "define(function () { return '" +
                                   content +
                               "';});\n");
            }
        },

        writeFile: function (pluginName, moduleName, req, write, config) {
            var parsed = text.parseName(moduleName),
                extPart = parsed.ext ? '.' + parsed.ext : '',
                nonStripName = parsed.moduleName + extPart,
                //Use a '.js' file name so that it indicates it is a
                //script that can be loaded across domains.
                fileName = req.toUrl(parsed.moduleName + extPart) + '.js';

            //Leverage own load() method to load plugin value, but only
            //write out values that do not have the strip argument,
            //to avoid any potential issues with ! in file names.
            text.load(nonStripName, req, function (value) {
                //Use own write() method to construct full module value.
                //But need to create shell that translates writeFile's
                //write() to the right interface.
                var textWrite = function (contents) {
                    return write(fileName, contents);
                };
                textWrite.asModule = function (moduleName, contents) {
                    return write.asModule(moduleName, fileName, contents);
                };

                text.write(pluginName, nonStripName, textWrite, config);
            }, config);
        }
    };

    if (masterConfig.env === 'node' || (!masterConfig.env &&
            typeof process !== "undefined" &&
            process.versions &&
            !!process.versions.node &&
            !process.versions['node-webkit'])) {
        //Using special require.nodeRequire, something added by r.js.
        fs = require.nodeRequire('fs');

        text.get = function (url, callback, errback) {
            try {
                var file = fs.readFileSync(url, 'utf8');
                //Remove BOM (Byte Mark Order) from utf8 files if it is there.
                if (file.indexOf('\uFEFF') === 0) {
                    file = file.substring(1);
                }
                callback(file);
            } catch (e) {
                errback(e);
            }
        };
    } else if (masterConfig.env === 'xhr' || (!masterConfig.env &&
            text.createXhr())) {
        text.get = function (url, callback, errback, headers) {
            var xhr = text.createXhr(), header;
            xhr.open('GET', url, true);

            //Allow plugins direct access to xhr headers
            if (headers) {
                for (header in headers) {
                    if (headers.hasOwnProperty(header)) {
                        xhr.setRequestHeader(header.toLowerCase(), headers[header]);
                    }
                }
            }

            //Allow overrides specified in config
            if (masterConfig.onXhr) {
                masterConfig.onXhr(xhr, url);
            }

            xhr.onreadystatechange = function (evt) {
                var status, err;
                //Do not explicitly handle errors, those should be
                //visible via console output in the browser.
                if (xhr.readyState === 4) {
                    status = xhr.status;
                    if (status > 399 && status < 600) {
                        //An http 4xx or 5xx error. Signal an error.
                        err = new Error(url + ' HTTP status: ' + status);
                        err.xhr = xhr;
                        errback(err);
                    } else {
                        callback(xhr.responseText);
                    }

                    if (masterConfig.onXhrComplete) {
                        masterConfig.onXhrComplete(xhr, url);
                    }
                }
            };
            xhr.send(null);
        };
    } else if (masterConfig.env === 'rhino' || (!masterConfig.env &&
            typeof Packages !== 'undefined' && typeof java !== 'undefined')) {
        //Why Java, why is this so awkward?
        text.get = function (url, callback) {
            var stringBuffer, line,
                encoding = "utf-8",
                file = new java.io.File(url),
                lineSeparator = java.lang.System.getProperty("line.separator"),
                input = new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(file), encoding)),
                content = '';
            try {
                stringBuffer = new java.lang.StringBuffer();
                line = input.readLine();

                // Byte Order Mark (BOM) - The Unicode Standard, version 3.0, page 324
                // http://www.unicode.org/faq/utf_bom.html

                // Note that when we use utf-8, the BOM should appear as "EF BB BF", but it doesn't due to this bug in the JDK:
                // http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4508058
                if (line && line.length() && line.charAt(0) === 0xfeff) {
                    // Eat the BOM, since we've already found the encoding on this file,
                    // and we plan to concatenating this buffer with others; the BOM should
                    // only appear at the top of a file.
                    line = line.substring(1);
                }

                if (line !== null) {
                    stringBuffer.append(line);
                }

                while ((line = input.readLine()) !== null) {
                    stringBuffer.append(lineSeparator);
                    stringBuffer.append(line);
                }
                //Make sure we return a JavaScript string and not a Java string.
                content = String(stringBuffer.toString()); //String
            } finally {
                input.close();
            }
            callback(content);
        };
    } else if (masterConfig.env === 'xpconnect' || (!masterConfig.env &&
            typeof Components !== 'undefined' && Components.classes &&
            Components.interfaces)) {
        //Avert your gaze!
        Cc = Components.classes,
        Ci = Components.interfaces;
        Components.utils['import']('resource://gre/modules/FileUtils.jsm');
        xpcIsWindows = ('@mozilla.org/windows-registry-key;1' in Cc);

        text.get = function (url, callback) {
            var inStream, convertStream, fileObj,
                readData = {};

            if (xpcIsWindows) {
                url = url.replace(/\//g, '\\');
            }

            fileObj = new FileUtils.File(url);

            //XPCOM, you so crazy
            try {
                inStream = Cc['@mozilla.org/network/file-input-stream;1']
                           .createInstance(Ci.nsIFileInputStream);
                inStream.init(fileObj, 1, 0, false);

                convertStream = Cc['@mozilla.org/intl/converter-input-stream;1']
                                .createInstance(Ci.nsIConverterInputStream);
                convertStream.init(inStream, "utf-8", inStream.available(),
                Ci.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER);

                convertStream.readString(inStream.available(), readData);
                convertStream.close();
                inStream.close();
                callback(readData.value);
            } catch (e) {
                throw new Error((fileObj && fileObj.path || '') + ': ' + e);
            }
        };
    }
    return text;
});


define('text!system/ui/views/dialog.html',[],function () { return '<div class="pattern pattern-dialog" >\r\n    <div class="dialog-opacity-style"></div>\r\n    <div class="dialog-wrapper">\r\n        <section class="title">\r\n            <div class="title-wrapper">\n                <div class="title-container" data-bind="text: title, attr: {title: title}"></div>\n            </div>\r\n            <span class="close-dialog icon-close-popup"\r\n            \tdata-bind="click: closeDialog, visible: showCloseIcon"></span>\r\n        </section>\r\n        <section class="content dialog-content"></section>\r\n    </div>\r\n</div>';});

define('system/ui/dialog-view-model',["require","exports","jquery","knockout","spa/conductor","spa/region","application/application-events","system/lang/object","text!./views/dialog.html"],function(require,exports,a,b,c,d,e,f){"use strict";var g=require("text!./views/dialog.html"),h=0,i=function(){function i(a,g,h){void 0===h&&(h=null),this.options=h,this.content=a,this.title=g,this.showHelp=b.observable(!0),this.showClose=b.observable(!0),this.showCloseIcon=b.observable(!1),this.showCheck=b.observable(!0),this.applicationEvents=f.resolve(e),this.dialogShellRegion=new d(null),this.dialogContentRegion=new d(null),this.$wrapper=null,this.conductor=f.resolve(c)}return i.prototype.show=function(){var c=document.createElement("div");document.body.appendChild(c),this.dialogShellRegion.setElement(c),this.dialogShellRegion.attach(a(g)),b.applyBindings(this,this.dialogShellRegion.activeContainer),this.$wrapper=this.dialogShellRegion.$element.find(".dialog-wrapper");var d=this.$wrapper.find(".dialog-content")
;if(this.dialogContentRegion.setElement(d),this.options?(this.options.height&&this.$wrapper.css("height",this.options.height),this.options.width&&this.$wrapper.css("width",this.options.width),this.options.noPadding?d.addClass("dialog-no-padding"):j(this,d)):j(this,d),this.options&&this.options.hasOwnProperty("closeIcon")){var e=this.options.closeIcon||!1;this.showCloseIcon(e)}h++,this.dialogShellRegion.$element.find(".dialog-opacity-style").css("z-index",h.toString()+"98"),this.dialogShellRegion.$element.find(".dialog-opacity-style").on("touchstart",m.bind(null)),this.$wrapper.css("z-index",h.toString()+"99"),this.conductor.changeScreen(this.content,this.dialogContentRegion),l(this),this.applicationEvents.windowResized.add(l,this,this),this.$wrapper.find("div.dialog-message-box div.btn.btn-primary").each(n.bind(null)),this.$wrapper.find(".okButtonClass").hover(o.bind(null,this),p.bind(null,this)),this.$wrapper.find(".cancelButtonClass").hover(o.bind(null,this),p.bind(null,this)),
q(this)},i.prototype.closeDialog=function(){r(this),k(this),h--},i.prototype.centerDialog=function(){l(this)},i.prototype.setContent=function(a){this.content=a,this.conductor.changeScreen(this.content,this.dialogContentRegion),l(this)},i}();function j(a,b){a.$wrapper.find(".title").addClass("title-with-padding"),b.addClass("dialog-with-padding")}function k(a){a.dialogShellRegion.$element.find(".dialog-opacity-style").off("touchstart"),a.conductor.clearScreen(a.dialogContentRegion),b.cleanNode(a.dialogShellRegion.activeContainer),a.dialogShellRegion.clear(),a.dialogShellRegion.$element.remove(),a.applicationEvents.windowResized.remove(a),a.applicationEvents.navigate.remove(a)}function l(b){var c,d,e,f,g,h;window.scrollTo(0,0),e=window.innerHeight?window.innerHeight:a(window).height(),f=window.innerWidth?window.innerWidth:a(window).width(),h=b.$wrapper.outerHeight(),g=b.$wrapper.outerWidth(),c=Math.max(0,(e-h)/2+a(window).scrollTop()),d=Math.max(0,(f-g)/2+a(window).scrollLeft()),
b.$wrapper.css("top",c+"px"),b.$wrapper.css("left",d+"px")}function m(a){a.preventDefault(),a.stopPropagation()}function n(b,c){var d=a(c);d.attr("tabindex",b+1),"OK"===d.text()&&(d.addClass("okButtonClass"),d.focus()),"Cancel"===d.text()&&d.addClass("cancelButtonClass")}function o(b){a(b).focus()}function p(b){a(b).blur()}function q(b){b.$wrapper.keydown(function(b){var c=a(b.currentTarget).find("input, select, textarea, button"),d=c.first(),e=c.last();9===(b.which||b.keyCode)&&(b.shiftKey&&d.length&&d.is(":focus")&&(b.preventDefault(),e.focus()),!b.shiftKey&&e.length&&e.is(":focus")&&(b.preventDefault(),d.focus()))})}function r(a){a.$wrapper.off("keydown")}return i});

define('text!system/ui/views/message-box.html',[],function () { return '<div class="dialog-message-box">\r\n    <div class="message-text-container">\r\n        <i class="message-icon" data-bind="css:icon"></i>\r\n        <div class="main-message" data-bind="html:message"></div>\r\n    </div>    \r\n    <section class="button-align message-box-button-container" data-bind="foreach: buttons">\r\n        <div class="btn btn-primary" data-bind="text: name,\r\n            css: $parent.buttonStyle,\r\n            event: { \'keydown\': $parent.buttonKeyDown.bind($parent) },\r\n            click: $parent.buttonClicked.bind($parent, $index())"></div>\r\n    </section>\r\n</div>';});

define('system/ui/message-box',["require","exports","jquery","system/lang/object","spa/knockout/knockout-view-model","system/knockout/knockout-manager","system/globalization/translator","system/ui/dialog-view-model","text!./views/message-box.html"],function(require,exports,a,b,c,d,e,f){"use strict";var g=require("text!./views/message-box.html"),h=9,i=13,j=function(c){__extends(j,c);function j(a,f,h,i){var j=c.call(this,g)||this;return j.kom=new d,j.message=a,j.title=f,j.buttons=j.kom.observableArray(h),j.icon=i||"icon-node-warning",j.dfd=null,j.dialog=null,j.translator=b.resolve(e),j.$element=null,j.buttonStyle=j.kom.pureComputed(k.bind(null,j)),j.canSave=!0,j}return j.show=function(a,b,c,d,e){return c=c||[{name:q("OK")}],new j(a,b,c,d).showMessage(e)},j.showOk=function(a,b,c){var d=[{name:q("OK")}];return j.show(a,b,d,c)},j.showOkCancel=function(a,b,c){var d=[{name:q("OK")},{name:q("CANCEL")}];return j.show(a,b,d,c)},j.showYesNo=function(a,b,c){var d=[{name:q("YES")},{name:q("NO")}];return j.show(a,b,d,c)},
j.showYesNoCancel=function(a,b,c){var d=[{name:q("YES")},{name:q("NO")},{name:q("CANCEL")}];return j.show(a,b,d,c)},j.showUnsavedChanges=function(a){var b=q("UNSAVED_CHANGES_DIALOG_TITLE"),c=q("UNSAVED_CHANGES_DIALOG_MESSAGE"),d=[{name:q("UNSAVED_CHANGES_DIALOG_DONT_SAVE_BTN")},{name:q("UNSAVED_CHANGES_DIALOG_SAVE_BTN")}],e={showCloseIcon:!0,buttonIndex:1,applyUnsavedChangesDialogStyling:!0,canSave:!0};return r(a)&&(e.canSave=!1,c=q("UNSAVED_CHANGES_DIALOG_NO_SAVE_MESSAGE"),d=[{name:q("UNSAVED_CHANGES_DIALOG_CONTINUE_BTN")},{name:q("UNSAVED_CHANGES_DIALOG_GO_BACK_BTN")}]),j.show(c,b,d,"",e)},j.prototype.showMessage=function(b){var c=!!b&&b.showCloseIcon,d=b?b.buttonIndex:0,e=!!b&&b.applyUnsavedChangesDialogStyling;return this.dialog=new f(this,this.title,{closeIcon:c}),this.dfd=a.Deferred(),this.dialog.show(),this.$element=this.dialog.$wrapper.find(".dialog-message-box"),l(this,e),m(this,d),c&&o(this),r(b)&&(this.canSave=!1),this.dfd},j.prototype.buttonClicked=function(a){
this.dialog.closeDialog(),1===a&&this.canSave===!1?s(this):this.dfd.resolve(a)},j.prototype.buttonKeyDown=function(b,c){var d=a(c.target),e=this.$element.find(".message-box-button-container > .btn");if(c.keyCode===i)return d.click(),!1;if(c.keyCode===h){if(d.is(":last-of-type")&&c.shiftKey===!1)return e.first().focus(),!1;if(d.is(":first-of-type")&&c.shiftKey===!0)return e.last().focus(),!1}return!0},j.prototype.unload=function(){this.kom.dispose()},j}(c);function k(a){var b=a.buttons().length;return 2===b?"two-buttons":3===b?"three-buttons":""}function l(a,b){var c=a.$element.parents(".dialog-content");c.addClass("message-box-content"),c.siblings(".title").addClass("message-box-title"),a.dialog.centerDialog(),b&&(c.removeClass("dialog-with-padding"),a.dialog.$wrapper.find(".title-wrapper").addClass("unsaved-dialog-title"),a.dialog.$wrapper.find("section.title").removeClass("title-with-padding"),a.$element.find(".main-message").addClass("message-with-padding"),
a.$element.find(".message-box-button-container").addClass("unsaved-dialog-button-container"))}function m(b,c){var d=b.$element.find(".message-box-button-container > .btn");d[c].focus(),1===c&&(a(d[c]).addClass("activeBtn"),d.on("mouseenter",n.bind(null,d)))}function n(b){a(b[1]).hasClass("activeBtn")&&(a(b[1]).removeClass("activeBtn"),b.off("mouseenter"))}function o(a){a.dialog.$wrapper.find(".icon-close-popup").on("click",p.bind(null,a))}function p(a){a.dfd.reject()}function q(a){return b.resolve(e).translate(a)}function r(a){return a&&void 0!==a.canSave&&null!==a.canSave&&"false"===a.canSave.toString().toLowerCase()}function s(a){p(a)}return j});
define('dcm/services/content-validation-service',['require','system/http/ajax-client'],function(require){"use strict";var a=require("system/http/ajax-client");function b(a){this.ajaxClient=a,this.base_url="api/core/contentvalidation/"}return b.dependsOn=[a],b.prototype.getStatus=function(){var a=this.base_url+"status";return this.ajaxClient.get(a)},b.prototype.enableContent=function(){var a=this.base_url+"enable";return this.ajaxClient.post(a)},b.prototype.disableContent=function(){var a=this.base_url+"disable";return this.ajaxClient.post(a)},b.prototype.getSummary=function(){var a=this.base_url+"summary";return this.ajaxClient.get(a)},b.prototype.exportSummary=function(){var a=this.base_url+"summary/export";return this.ajaxClient.get(a)},b});
define('admin-menu/view-models/admin-menu-view-model',['require','system/lang/private','ramda','bluebird','spa/react/react-view-model','../views/admin-menu-view','system/globalization/translator','system/hardware/device','application/application-events','application/application-context','security/model/licenses','security/model/groups','system/ui/message-box','system/http/ajax-client','dcm/services/content-validation-service'],function(require){"use strict";var a=require("system/lang/private"),b=require("ramda"),c=require("bluebird"),d=require("spa/react/react-view-model"),e=require("../views/admin-menu-view"),f=require("system/globalization/translator"),g=require("system/hardware/device"),h=require("application/application-events"),i=require("application/application-context"),j=require("security/model/licenses"),k=require("security/model/groups"),l=require("system/ui/message-box"),m=require("system/http/ajax-client"),n=require("dcm/services/content-validation-service");function o(){p.call(this,e)}var p=Object.inherit(d,o),q=o.prototype;q.currentUrl=function(){var a=location.hash.split(";"),b=parseInt(location.hash[1])+1,c=a[b].split("=")[1],d=c.split("/")[1];return"admin-menu"===d&&c.split("/")[2]?c.split("/")[2]:d},q.translate=function(a){return Object.resolve(f).translate(a)},q.notMobile=function(){return!Object.resolve(g).isMobile()},q.setTitle=function(a,b){var c=Object.resolve(h)
;c.titleChanged.raise(this.translate(a),this),c.iconChanged.raise(b,this)},q.activateHelp=function(a){i.help.helpContext=a},q.validateContent=function(){var a=Object.resolve(n);return c.resolve(a.getSummary()).then(r.bind(null,this))};function r(a,b){return b.length&&s(a),!0}function s(a){l.showYesNo(a.translate("DCM_CONTENT_VALIDATION_WARNING_MSG"),a.translate("APPLY_WARNING"),"fa fa-warning").done(function(a){if(!a){Object.resolve(h).navigate.raise("#dcm/content-validation")}})}o.hasAppSettingsAccess=function(){var a=x();return b.any(b.propEq("enabled",!0),a)},o.hasConfigurationAccess=function(){return k.isSuperUser()||k.hasMIConfigurationRole()||k.hasMISecurityRole()||k.hasAPMNowAdmin()},o.hasOperationsAccess=function(){return k.isSuperUser()||k.hasMIConfigurationRole()||k.hasAPMNowAdmin()},o.hasSecurityAccess=function(){return k.isSuperUser()||k.hasMISecurityRole()||k.hasAPMNowAdmin()},q.appSettingsMenu=function(){return x()};function t(){
return k.hasMITMAdministrator()||k.hasMIRBIAdmin()||k.hasMITMUser()||k.hasMIInspection()||k.hasMIInspectionViewer()||k.hasMITMInspector()||k.hasMIRBIAnalyst()}function u(){return k.isSuperUser()||k.hasMIPolicyAdministrator()}function v(){return k.hasMITMAdministrator()||k.hasMIRBIAdmin()||k.hasMITMUser()||k.hasMITMViewer()||k.hasMIInspection()||k.hasMITMInspector()||k.hasMIRBIAnalyst()}function w(){return k.hasMITMAdministrator()||k.hasMIRBIAdmin()||k.hasMITMUser()||k.hasMIRBIAnalyst()||k.hasMIRBIViewer()||k.hasMIInspection()||k.hasMITMInspector()}function x(){var a=Object.resolve(f),c=k.isSuperUser()||k.hasMIConfigurationRole(),d=[{caption:a.translate("ASSET_HEALTH_MANAGER"),href:"#health/admin/event-mapping",abbr:a.translate("AHM"),enabled:j.hasAHM()&&(k.isSuperUser()||k.hasMIAHIAdmin())},{caption:a.translate("ASSET_STRATEGY_MANAGEMENT"),href:"#strategy/admin",abbr:a.translate("ASM"),enabled:j.hasASM()&&(c||k.hasMIASMAdministrator())},{
caption:a.translate("ASSET_STRATEGY_IMPLEMENTATION"),href:"#strategy/asi/admin",abbr:a.translate("ASI"),enabled:j.hasASM()&&(c||k.hasMIASIAdministrator())},{caption:a.translate("CALIBRATION_MANAGEMENT"),href:"#calibration/admin/queryPaths",abbr:a.translate("CM"),enabled:j.hasCalibration()&&(c||k.hasMICalibrationAdministrator())},{caption:a.translate("CONTENT_CHANGE_MANAGEMENT"),href:"#content-management/admin",abbr:a.translate("CCM"),enabled:c},{caption:a.translate("ELOG"),href:"#elog/admin/shifts",abbr:a.translate("ELOG"),enabled:j.hasELog()&&(c||k.hasELogAdministrator())},{caption:a.translate("GENERATION_AVAILABILITY_ANALYSIS"),href:"#gaa/admin/settings",abbr:a.translate("GAA"),enabled:j.hasGAA()&&(c||k.hasGaaAdministrator())},{caption:a.translate("GENERATION_AVAILABILITY_ANALYSIS_WIND"),href:"#gaa-wind/admin/settings",abbr:a.translate("GAA_WIND"),enabled:j.hasGAAWind()&&(k.isSuperUser()||k.hasGAAWindAdmin()||k.hasGAAWindSuperAdmin())},{caption:a.translate("HAZARDS_ANALYSIS"),
href:"#asset-safety/hazards/admin",abbr:a.translate("HA"),enabled:j.hasHazards()&&(c||k.hasMIHAAdministrator())},{caption:a.translate("INSPECTION_MANAGEMENT"),href:"#im-admin-preferences/inspection-configuration",abbr:a.translate("IM"),enabled:j.hasInspection()&&(c||t())},{caption:a.translate("LAYERS_OF_PROTECTION_ANALYSIS"),href:"#asset-safety/lopa/admin",abbr:a.translate("LOPA"),enabled:(j.hasSIS()||j.hasHazards())&&(c||k.hasMISISAdministrator()||k.hasMIHAAdministrator())},{caption:a.translate("MANAGEMENT_OF_CHANGE"),href:"#asset-safety/moc/admin",abbr:a.translate("MOC"),enabled:j.hasMoc()&&(c||k.hasMIMOCAdministrator())},{caption:a.translate("POLICY_MANAGER"),href:"#policy/admin",abbr:a.translate("PD"),enabled:j.hasPolicyManager()&&u()},{caption:a.translate("PERFORMANCE_MONITORING"),href:"#monitoring/admin/perf-mon",abbr:a.translate("PM"),enabled:k.isSuperUser()&&!m.isMultiTenant()},{caption:a.translate("PRODUCTION_LOSS_ANALYSIS"),href:"#pla/admin/products",abbr:a.translate("PLA"),
enabled:j.hasPLA()&&(c||k.hasMIProductionLossAccountingAdministrator())},{caption:a.translate("AC_DESIGNER"),href:"#rounds/admin",abbr:a.translate("RD"),enabled:k.isSuperUser()||k.hasMIOperatorRoundsAdministrator()||k.hasLubricationManagementAdmin()},{caption:a.translate("RISK_BASED_INSPECTION"),href:"#rbi-admin-preferences/global-preferences",abbr:a.translate("RBI"),enabled:(j.hasRBI()||j.has581())&&(c||w())},{caption:a.translate("RCA_ANALYSIS"),href:"#failure-elimination/rca/admin",abbr:a.translate("RCA"),enabled:j.hasPROACT()&&(c||k.hasMIPROACTAdmin())},{caption:a.translate("SIS_MANAGEMENT"),href:"#asset-safety/sis/admin",abbr:a.translate("SIS"),enabled:j.hasSIS()&&(c||k.hasMISISAdministrator())},{caption:a.translate("THICKNESS_MONITORING"),href:"#tm-admin-preferences/global-preferences",abbr:a.translate("TM"),enabled:j.hasTM()&&(c||v())},{caption:a.translate("RELIABILITY_ANALYTICS"),href:"#failure-elimination/ra/admin",abbr:a.translate("RA"),
enabled:j.hasReliability()&&(c||k.hasReliabilityAdministrator())}];return b.reject(b.propEq("enabled",!1),d)}return o});
define('shell/security/on-prem-app-security',["require","exports","system/hardware/device","application/application-context","security/model/licenses","security/model/module-access","security/model/groups","security/model/roles","admin-menu/view-models/admin-menu-view-model"],function(require,exports,a,b){"use strict";var c=require("security/model/licenses"),d=require("security/model/module-access"),e=require("security/model/groups"),f=require("security/model/roles"),g=require("admin-menu/view-models/admin-menu-view-model"),h=function(){function h(){this.device=new a}return h.prototype.isIMEnabled=function(){return c.hasInspection()&&(e.isSuperUser()||e.hasMITMAdministrator()||e.hasMIRBIAdmin()||e.hasMITMUser()||e.hasMIInspection()||e.hasMIInspectionViewer()||e.hasMITMInspector()||e.hasMIRBIAnalyst())},h.prototype.isCMEnabled=function(){
return c.hasComplianceManagement()&&(e.isSuperUser()||e.hasMITMAdministrator()||e.hasMIRBIAdmin()||e.hasMITMUser()||e.hasMIInspection()||e.hasMIInspectionViewer()||e.hasMITMInspector()||e.hasMIRBIAnalyst())},h.prototype.isTMEnabled=function(){return c.hasTM()&&(e.isSuperUser()||e.hasMITMAdministrator()||e.hasMIRBIAdmin()||e.hasMITMUser()||e.hasMITMViewer()||e.hasMIInspection()||e.hasMITMInspector()||e.hasMIRBIAnalyst())},h.prototype.isRBIEnabled=function(){return(c.hasRBI()||c.has581())&&(e.isSuperUser()||e.hasMITMAdministrator()||e.hasMIRBIAdmin()||e.hasMITMUser()||e.hasMIRBIAnalyst()||e.hasMIRBIViewer()||e.hasMIInspection()||e.hasMITMInspector())},h.prototype.isAdminEnabled=function(){return g.hasSecurityAccess()||g.hasOperationsAccess()||g.hasConfigurationAccess()||g.hasAppSettingsAccess()},h.prototype.isELogEnabled=function(){return c.hasELog()&&(e.isSuperUser()||e.hasELogAdministrator()||e.hasELogContributor()||e.hasELogViewer())},h.prototype.isLCCEnabled=function(){
return c.hasLCC()&&(e.isSuperUser()||e.hasLCCAdministrator()||e.hasLCCUser()||e.hasLCCViewer())},h.prototype.isReliabilityEnabled=function(){return c.hasReliability()&&(e.isSuperUser()||e.hasReliabilityAdministrator()||e.hasReliabilityUser()||e.hasReliabilityViewer())},h.prototype.isPROACTEnabled=function(){return c.hasPROACT()&&(e.isSuperUser()||e.hasMIPROACTAdmin()||e.hasMIPROACTTeamMember()||e.hasMIPROACTViewer())},h.prototype.isPLAEnabled=function(){return c.hasPLA()&&(e.isSuperUser()||e.hasMIProductionLossAccountingAdministrator()||e.hasMIProductionLossAccountingManager()||e.hasMIProductionLossAccountingService()||e.hasMIProductionLossAccountingUser())},h.prototype.isPolicyEnabled=function(){return c.hasPolicyManager()&&(e.isSuperUser()||e.hasMIPolicyDesigner()||e.hasMIPolicyUser()||e.hasMIPolicyViewer())},h.prototype.isAHMEnabled=function(){return c.hasAHM()&&(e.isSuperUser()||e.hasMIAHIAdmin()||e.hasMIAHIUserRole()||e.hasMIAHIViewerRole())},h.prototype.isSISEnabled=function(){
return c.hasSIS()&&(e.isSuperUser()||e.hasMISISUser()||e.hasMISISViewer()||e.hasMISISAdministrator()||e.hasMISISEngineer())},h.prototype.isHAZEnabled=function(){return c.hasHazards()&&(e.isSuperUser()||e.hasMIHAAdministrator()||e.hasMIHAZViewer()||e.hasMIHAZOwner()||e.hasMIHAZMember()||e.hasMIHAZFacilitator())},h.prototype.isMOCEnabled=function(){return c.hasMoc()&&(e.isSuperUser()||e.hasMIMOCApprover()||e.hasMIMOCAdministrator()||e.hasMIMOCViewer()||e.hasMIMOCUser())},h.prototype.isGEEnabled=function(){return c.hasGE_M2M()&&(e.isSuperUser()||e.hasMIGEAdmin()||e.hasMIGEUserRole()||e.hasMIGEViewerRole())},h.prototype.isAMSEnabled=function(){return c.hasAMS()&&(e.isSuperUser()||e.hasMIAMSAdmin()||e.hasMIAMSUserRole()||e.hasMIAMSViewerRole()||e.hasMIAMSPowerUserRole())},h.prototype.isRDCEnabled=function(){return(c.hasOPR()||c.hasLM())&&(e.isSuperUser()||e.hasMIOperatorRoundsMobileUser()||e.hasLubricationManagementUser()||e.hasMAPMSecurityGroup())},h.prototype.isRDEnabled=function(){
return(c.hasOPR()||c.hasLM())&&(e.isSuperUser()||e.hasMIOperatorRoundsAdministrator()||e.hasLubricationManagementAdmin()||e.hasMIRoundsDesignerViewer())},h.prototype.isCalibrationEnabled=function(){return c.hasCalibration()&&(e.isSuperUser()||e.hasMICalibrationUser()||e.hasMICalibrationAdministrator()||e.hasMICalibrationViewer())},h.prototype.isACAEnabled=function(){return e.isSuperUser()||e.hasMIACAAdministrator()||e.hasMIACAMember()||e.hasMIACAOwner()},h.prototype.isRecommendationEnabled=function(){return e.isSuperUser()||e.hasMIACAAdministrator()||e.hasMIACAMember()||e.hasMIACAOwner()},h.prototype.isRscriptsEnabled=function(){return!c.hasEssentials()},h.prototype.hasFmeaAccess=function(){return d.hasFmeaAccess()},h.prototype.hasRcmAccess=function(){return d.hasRcmAccess()},h.prototype.hasMobileProofTestDataCollection=function(){return c.hasSIS()},h.prototype.hasAsmAccess=function(){return d.hasAsmAccess()},h.prototype.hasRecommendationManagerAccess=function(){
return d.hasRecommendationManagerAccess()},h.prototype.hasAsi=function(){return d.hasAsiAccess()},h.prototype.hasPipelineManagement=function(){return c.hasPipeline()},h.prototype.hasSecurityManager=function(){return g.hasSecurityAccess()&&!b.isAppHub&&!b.hasPredixSDKInstalled()},h.prototype.hasOperationsAccess=function(){return g.hasOperationsAccess()},h.prototype.hasConfigurationAccess=function(){return g.hasConfigurationAccess()},h.prototype.hasApplicationSettingsAccess=function(){return g.hasAppSettingsAccess()},h.prototype.hasDatasetAccess=function(){return!this.device.isMobileApp()},h.prototype.hasDataloaderAccess=function(){return(e.isSuperUser()||f.hasDataLoaderUserRole()||f.hasDataLoaderAdminRole()||e.hasDataLoaderUserRole()||e.hasDataLoaderAdminRole())&&(c.hasModule("APM_Connect_Basic")||c.hasModule("APM_Connect_Plus")||c.hasModule("APM_Connect_Studio"))},h.prototype.hasCognitive=function(){
return c.hasCognitive()&&(e.isSuperUser()||e.hasCognitiveUser()||e.hasCognitiveAdministrator())},h.prototype.hasDataHub=function(){return c.hasCognitive()},h.prototype.hasGaa=function(){return c.hasGAA()&&(e.isSuperUser()||e.hasGaaViewer()||e.hasGaaAnalyst()||e.hasGaaAdministrator())},h.prototype.isLopaEnabled=function(){return this.isSISEnabled()||this.isHAZEnabled()},h.prototype.hasGaaWind=function(){return c.hasGAAWind()&&(e.isSuperUser()||e.hasGAAWindAdmin()||e.hasGAAWindSuperAdmin()||e.hasGAAWindAnalysts()||e.hasGAAWindOperator())},h.prototype.isMobileApp=function(){return this.device.isMobileApp()},h}();exports.OnPremAppSecurity=h});
define('shell/security/default-on-prem-apps',["require","exports"],function(require,exports){"use strict";var a=function(){function a(){}return a.standardApps=function(){var a={enabled:!0};return{ADVANCED_SEARCH:a,CATALOG:a,TEAMS:a,DATASETS:a,GENERAL_DASHBOARDS:a,HYPERLINK_UTILITY:a,ERRORS:a,GRAPHS:a,QUERIES:a,MAPS:a,R_SCRIPTS:a,REPORTS:a,SCRIPTS:a,INSPECTION_FIELD_DATA_COLLECTION:a,LAYERS_OF_PROTECTION_ANALYSIS:a}},a.mobileApps=function(){var a={enabled:!0};return{AC_DATA_COLLECTION:a,INSPECTION_FIELD_DATA_COLLECTION:a,INSPECTION_MANAGEMENT:a,MOBILE_PROOF_TEST_DATA_COLLECTION:a,SIS_MANAGEMENT:a}},a}();exports.DefaultOnPremApps=a});
define('shell/security/left-nav-security-configuration',["require","exports","lodash","./on-prem-app-security","./default-on-prem-apps"],function(require,exports,a,b,c){"use strict";var d=function(){function d(){this.onPremAppSecurity=new b.OnPremAppSecurity}return d.prototype.configuration=function(){var b={ASSET_CRITICALITY_ANALYSIS:{enabled:this.onPremAppSecurity.isACAEnabled()},FAILURE_MODES_AND_EFFECTS_ANALYSIS:{enabled:this.onPremAppSecurity.hasFmeaAccess()},RELIABILITY_CENTERED_MAINTENANCE:{enabled:this.onPremAppSecurity.hasRcmAccess()},RISK_BASED_INSPECTION:{enabled:this.onPremAppSecurity.isRBIEnabled()},MOBILE_PROOF_TEST_DATA_COLLECTION:{enabled:this.onPremAppSecurity.hasMobileProofTestDataCollection()},SIS_MANAGEMENT:{enabled:this.onPremAppSecurity.isSISEnabled()},HAZARDS_ANALYSIS:{enabled:this.onPremAppSecurity.isHAZEnabled()},LOPA:{enabled:this.onPremAppSecurity.isSISEnabled()||this.onPremAppSecurity.isHAZEnabled()},MANAGEMENT_OF_CHANGE:{enabled:this.onPremAppSecurity.isMOCEnabled()},ASSET_STRATEGY_MANAGEMENT:{
enabled:this.onPremAppSecurity.hasAsmAccess()},ASSET_STRATEGY_IMPLEMENTATION:{enabled:this.onPremAppSecurity.hasAsi()},POLICY_MANAGER:{enabled:this.onPremAppSecurity.isPolicyEnabled()},AC_DATA_COLLECTION:{enabled:this.onPremAppSecurity.isRDCEnabled()},AC_DESIGNER:{enabled:this.onPremAppSecurity.isRDEnabled()},INSPECTION_MANAGEMENT:{enabled:this.onPremAppSecurity.isIMEnabled()},COMPLIANCE_MANAGEMENT:{enabled:this.onPremAppSecurity.isCMEnabled()},THICKNESS_MONITORING:{enabled:this.onPremAppSecurity.isTMEnabled()},PIPELINE_MANAGEMENT:{enabled:this.onPremAppSecurity.hasPipelineManagement()},CALIBRATION_MANAGEMENT:{enabled:this.onPremAppSecurity.isCalibrationEnabled()},ASSET_HEALTH_MANAGER:{enabled:this.onPremAppSecurity.isAHMEnabled()},GE_ANALYTICS:{enabled:this.onPremAppSecurity.isGEEnabled()},AMS_ANALYTICS:{enabled:this.onPremAppSecurity.isAMSEnabled()},METRICS_AND_SCORECARDS:{enabled:!0},PRODUCTION_LOSS_ANALYSIS:{enabled:this.onPremAppSecurity.isPLAEnabled()},ROOT_CAUSE_ANALYSIS:{
enabled:this.onPremAppSecurity.isPROACTEnabled()},RELIABILITY_ANALYTICS:{enabled:this.onPremAppSecurity.isReliabilityEnabled()},ADMIN:{enabled:this.onPremAppSecurity.isAdminEnabled()},SECURITY_MANAGER:{enabled:this.onPremAppSecurity.hasSecurityManager()},OPERATIONS_MANAGER:{enabled:this.onPremAppSecurity.hasOperationsAccess()},CONFIGURATION_MANAGER:{enabled:this.onPremAppSecurity.hasConfigurationAccess()},APPLICATION_SETTINGS:{enabled:this.onPremAppSecurity.hasApplicationSettingsAccess()},DATASETS:{enabled:this.onPremAppSecurity.hasDatasetAccess()},DATA_LOADERS:{enabled:this.onPremAppSecurity.hasDataloaderAccess()},DATA_EXTRACTORS:{enabled:this.onPremAppSecurity.hasDataloaderAccess()},COGNITIVE_ANALYTICS:{enabled:this.onPremAppSecurity.hasCognitive()},DATA_HUB:{enabled:this.onPremAppSecurity.hasDataHub()},GENERATION_AVAILABILITY_ANALYSIS:{enabled:this.onPremAppSecurity.hasGaa()},LIFE_CYCLE_COST_ANALYSIS:{enabled:this.onPremAppSecurity.isLCCEnabled()},ELOG:{
enabled:this.onPremAppSecurity.isELogEnabled()},ACTION_MANAGEMENT:{enabled:this.onPremAppSecurity.hasAsmAccess()||this.onPremAppSecurity.hasRecommendationManagerAccess()},LAYERS_OF_PROTECTION_ANALYSIS:{enabled:this.onPremAppSecurity.isLopaEnabled()},GENERATION_AVAILABILITY_ANALYSIS_WIND:{enabled:this.onPremAppSecurity.hasGaaWind()},INSPECTION_FIELD_DATA_COLLECTION:{enabled:this.onPremAppSecurity.isIMEnabled()},R_SCRIPTS:{enabled:this.onPremAppSecurity.isRscriptsEnabled()}};return this.onPremAppSecurity.isMobileApp()?a.assignInWith(c.DefaultOnPremApps.mobileApps(),b,this.filterOutNonDefaultApps):a.assignIn(c.DefaultOnPremApps.standardApps(),b)},d.prototype.filterOutNonDefaultApps=function(b,c,d){var e={enabled:!1};return a.isUndefined(b)?e:c},d}();exports.LeftNavSecurityConfiguration=d});
define('shell/security/left-nav-security',["require","exports","./left-nav-security-configuration","lodash"],function(require,exports,a,b){"use strict";return function(){function c(){var c=new a.LeftNavSecurityConfiguration;b.assignIn(this,c.configuration())}return c.prototype.applySecurity=function(a){var b=this;return a.filter(function(a){return!(!a.customConfig||!a.customConfig.parent||"root"!==a.customConfig.parent)||!(!a.customConfig||"meridium"!==a.customConfig.source||!a.label_key)&&b.hasAccess(a.label_key)})},c.prototype.noAccess=function(module){return!this[module].enabled},c.prototype.hasAccess=function(module){return!!this[module]&&!!this[module].enabled},c}()});
define('shell/security/nav-profile-security',["require","exports","ramda","../builders/href-builder"],function(require,exports,a,b){"use strict";var c=window;function d(c,d,f){var g=["Predix Administrator","userpreference","userprofile","intelligence.0","forecast.0","optimize.0"];return f=b.normalizeRouteStrings(f),a.contains(d,g)||!!a.find(e.bind(null,f),c)}exports.appExistsInWindowNav=d;function e(d,e){var f=c.nav.contextPath,g=b.removeContextPath(e.path||"",f);return!(!g||g!==d)||!!e.items&&!!a.find(function(a){var c=b.removeContextPath(a.path||"",f);return!(!c||c!==d)},e.items)}});
define('shell/adapters/navigation-profile-adapter',["require","exports","../models/folder","../models/app","../security/nav-profile-security","../builders/leftnav-utilities"],function(require,exports,a,b,c,d){"use strict";var e=function(){function e(){}return e.prototype.toModel=function(a){var b=this,c=JSON.parse(a.navigationProfile),e=c.map(function(a){return b.toFolder(a)});return e=d.deleteEmptyFolders(e)},e.prototype.toFolder=function(b){var c=this,d=b.apps.map(function(a){return c.toApp(a)}),e=new a.Folder(b.name,b.caption,b.icon,b.id,b.orderUnderParent);return e.setApps(d),e},e.prototype.toApp=function(a){var b=this,c=a.subApps.map(function(a){return b.tryCreateApp(a)});return this.tryCreateApp(a,c)},e.prototype.tryCreateApp=function(a,d){var e=window,f=e.nav.main.items;return c.appExistsInWindowNav(f,a.id,a.href)?this.createApp(a,d):b.App.empty()},e.prototype.createApp=function(a,c){return new b.App(a.href,a.icon,a.caption,c||[],a.orderUnderParent,a.id)},e}();exports.NavigationProfileAdapter=e});
define('shell/dtos/navigation-profile-dto',["require","exports"],function(require,exports){"use strict";var a=function(){function a(a){this.navigationProfile=a}return a}();exports.NavigationProfileDto=a});

define('text!shell/nav-config/configurations/apm.json',[],function () { return '[\r\n  {\r\n    "name": "Health",\r\n    "caption": "Health",\r\n    "icon": "icon-risk",\r\n    "id": "healthfolder.0",\r\n    "orderUnderParent": 0,\r\n    "apps": [\r\n      {\r\n        "href": "#app-hub/alerttemplates/#/alerts",\r\n        "icon": "fa fa-file-text",\r\n        "caption": "Alert Templates",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "alerttemplatesmicroapp.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/alarms/#",\r\n        "icon": "icon-alert-small",\r\n        "caption": "Alerts",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "alarmsmicroapp.0"\r\n      },\r\n      {\r\n        "href": "#/ams/overview",\r\n        "icon": "icon-ams-analytics",\r\n        "caption": "AMS Analytics",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "ams-analytics-microapp.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/analysis/#",\r\n        "icon": "icon-predix-analysis",\r\n        "caption": "Analysis",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "analysismicroapp.0"\r\n      },\r\n      {\r\n        "href": "#/health/overview",\r\n        "icon": "ic-p-ahm",\r\n        "caption": "Asset Health Manager",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "asset-health-manager-microapp.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/assetmgmt/#",\r\n        "icon": "icon-predix-assets",\r\n        "caption": "Assets",\r\n        "subApps": [\r\n          {\r\n            "href": "#app-hub/assetmgmt/#/assetMgmt",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Asset Instances",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "assetmanagement.0.0"\r\n          },\r\n          {\r\n            "href": "#app-hub/assetmgmt/#/groups",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Groups",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "assetmanagement.0.1"\r\n          },\r\n          {\r\n            "href": "#app-hub/assetmgmt/#/classifications",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Classifications",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "assetmanagement.0.2"\r\n          },\r\n          {\r\n            "href": "#app-hub/assetmgmt/#/templates",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Templates",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "assetmanagement.0.3"\r\n          },\r\n          {\r\n            "href": "#app-hub/assetmgmt/#/networks",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Networks",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "assetmanagement.0.4"\r\n          },\r\n          {\r\n            "href": "#app-hub/assetmgmt/#/search",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Search",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "assetmanagement.0.5"\r\n          }\r\n        ],\r\n        "orderUnderParent": 0,\r\n        "id": "assetmanagement.0"\r\n      },\r\n      {\r\n        "href": "#/asset-safety/calibration/calibration-mgmt",\r\n        "icon": "sprite-ic ic-s-cm",\r\n        "caption": "Calibration Management",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "calibration-mgmt-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/elog/dashboard/0",\r\n        "icon": "icon-elog",\r\n        "caption": "eLog",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "elog-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/ge/overview",\r\n        "icon": "icon-ge-analytics",\r\n        "caption": "GE Analytics",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "ge-analytics-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/rounds/dashboard/user",\r\n        "icon": "icon-rounds-new",\r\n        "caption": "Rounds Data Collection",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "rounds-data-collection-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/rounds/dashboard/admin",\r\n        "icon": "icon-route-designer-new",\r\n        "caption": "Rounds Designer",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "rounds-designer-microapp.0"\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    "name": "Reliability",\r\n    "caption": "Reliability",\r\n    "icon": "icon-strategy-nav",\r\n    "id": "reliabilityfolder.0",\r\n    "orderUnderParent": 1,\r\n    "apps": [\r\n      {\r\n        "href": "#app-hub/caf/#/",\r\n        "icon": "icon-predix-analytics",\r\n        "caption": "Analytics",\r\n        "subApps": [\r\n          {\r\n            "href": "#app-hub/caf/#/analytics",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Analytics Templates",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "analyticsmicroapp.0.0"\r\n          },\r\n          {\r\n            "href": "#app-hub/caf/#/orchestration",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Orchestrations",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "analyticsmicroapp.0.1"\r\n          },\r\n          {\r\n            "href": "#app-hub/caf/#/deployment",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Deployments",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "analyticsmicroapp.0.2"\r\n          },\r\n          {\r\n            "href": "#app-hub/caf/#/analyticApplicability",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Asset Filters",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "analyticsmicroapp.0.3"\r\n          },\r\n          {\r\n            "href": "#app-hub/caf/#/assetFiltersConfig",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Configurations",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "analyticsmicroapp.0.4"\r\n          }\r\n        ],\r\n        "orderUnderParent": 0,\r\n        "id": "analyticsmicroapp.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/casetemplates/#/cases",\r\n        "icon": "fa fa-file-text",\r\n        "caption": "Case Templates",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "casetemplatesmicroapp.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/cases/#/unclaimed",\r\n        "icon": "icon-predix-cases",\r\n        "caption": "Cases",\r\n        "subApps": [\r\n          {\r\n            "href": "#app-hub/cases/#/unclaimed",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Unclaimed Cases",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "casesmicroapp.0.0"\r\n          },\r\n          {\r\n            "href": "#app-hub/cases/#/open",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Open Cases",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "casesmicroapp.0.2"\r\n          },\r\n          {\r\n            "href": "#app-hub/cases/#/awaiting",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Awaiting Cases",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "casesmicroapp.0.3"\r\n          },\r\n          {\r\n            "href": "#app-hub/cases/#/closed",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Closed Cases",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "casesmicroapp.0.4"\r\n          },\r\n          {\r\n            "href": "#app-hub/cases/#/all",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "All Cases",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "casesmicroapp.0.5"\r\n          }\r\n        ],\r\n        "orderUnderParent": 0,\r\n        "id": "casesmicroapp.0"\r\n      },\r\n      {\r\n        "href": "#/cognitive/overview",\r\n        "icon": "icon-cognitive-analytics",\r\n        "caption": "Cognitive Analytics",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "cognitive-analytics-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/gaa/dashboard/0",\r\n        "icon": "icon-gaa-module",\r\n        "caption": "Generation Availability Analysis",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "general-avail-analysis-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/failure-elimination/pla/dashboard/0",\r\n        "icon": "sprite-ic ic-p-pla",\r\n        "caption": "Production Loss Analysis",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "production-loss-analysis-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/gaa-wind/dashboard/0",\r\n        "icon": "icon-gaa-wind",\r\n        "caption": "Generation Availability Analysis Wind",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "gaa-wind-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/reliability/dashboard/0",\r\n        "icon": "sprite-ic ic-p-ra",\r\n        "caption": "Reliability Analytics",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "reliability-analytics-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/failure-elimination/rca/dashboard/0",\r\n        "icon": "sprite-ic ic-p-rca",\r\n        "caption": "Root Cause Analysis",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "rootcause-analysis-microapp.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/apm-sm-monitor-ui/#/",\r\n        "icon": "fa fa-heartbeat",\r\n        "caption": "SmartSignal Deployments",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "ssMonitorUIMicroapp.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/ss-maintenance/#/",\r\n        "icon": "fa fa-wrench",\r\n        "caption": "SmartSignal Maintenance",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "ssMaintenanceMicroApp.0"\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    "name": "Strategy",\r\n    "caption": "Strategy",\r\n    "icon": "icon-strategy",\r\n    "id": "strategyfolder.0",\r\n    "orderUnderParent": 2,\r\n    "apps": [\r\n      {\r\n        "href": "#/action-management",\r\n        "icon": "icon-recommendation-manager",\r\n        "caption": "Action Management",\r\n        "subApps": [ ],\r\n        "orderUnderParent": 0,\r\n        "id": "recommendation-management-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/aca",\r\n        "icon": "sprite-ic ic-r-aca",\r\n        "caption": "Asset Criticality Analysis",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "acamicroapp.0"\r\n      },\r\n      {\r\n        "href": "#/asi/overview",\r\n        "icon": "sprite-ic ic-s-asi",\r\n        "caption": "Asset Strategy Implementation",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "asset-strategy-implementation-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/strategy/overview",\r\n        "icon": "sprite-ic ic-s-asm",\r\n        "caption": "Asset Strategy Management",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "asset-strategy-management-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/fmea/overview",\r\n        "icon": "sprite-ic ic-r-rca",\r\n        "caption": "Failure Modes and Effects Analysis",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "fmea-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/lcc/dashboard/0",\r\n        "icon": "icon-lcc",\r\n        "caption": "Life Cycle Cost Analysis",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "lcc-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/rcm/overview",\r\n        "icon": "sprite-ic ic-r-rcm",\r\n        "caption": "Reliability Centered Maintenance",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "rcm-microapp.0"\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    "name": "Integrity",\r\n    "caption": "Integrity",\r\n    "icon": "icon-plus",\r\n    "id": "integrityfolder.0",\r\n    "orderUnderParent": 3,\r\n    "apps": [\r\n      {\r\n        "href": "#/cm/overview",\r\n        "icon": "icon-compliance",\r\n        "caption": "Compliance Management",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "compliance-mgmt-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/asset-safety/hazards/overview",\r\n        "icon": "sprite-ic ic-r-ha",\r\n        "caption": "Hazards Analysis",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "hazards-analysis-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/im/offline/overview",\r\n        "icon": "icon-inspection-field-data-collection",\r\n        "caption": "Inspection Field Data Collection",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "inspection-field-data-collection-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/im/functionallocation/0/overview",\r\n        "icon": "sprite-ic ic-s-im",\r\n        "caption": "Inspection Management",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "inspection-mgmt-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/asset-safety/lopa/overview",\r\n        "icon": "icon-lopa",\r\n        "caption": "Layers of Protection Analysis",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "layers-protection-analysis-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/asset-safety/moc/overview",\r\n        "icon": "icon-moc",\r\n        "caption": "Management of Change",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "moc-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/asset-safety/sis/overview/offline",\r\n        "icon": "icon-proof-test",\r\n        "caption": "Mobile Proof Test",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "mobile-proof-test-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/rbi/unit",\r\n        "icon": "sprite-ic ic-r-rbi",\r\n        "caption": "Risk Based Inspection",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "rbimicroapp.0"\r\n      },\r\n      {\r\n        "href": "#/asset-safety/sis/overview",\r\n        "icon": "sprite-ic ic-r-sism",\r\n        "caption": "SIS Management",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "sis-mgmt-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/tm/unit",\r\n        "icon": "sprite-ic ic-s-tm",\r\n        "caption": "Thickness Monitoring",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "thickness-monitoring-microapp.0"\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    "name": "Tools",\r\n    "caption": "Tools",\r\n    "icon": "icon-tools",\r\n    "id": "toolsfolder.0",\r\n    "orderUnderParent": 4,\r\n    "apps": [\r\n      {\r\n        "href": "#/advsearch",\r\n        "icon": "sprite-ic icon-advanced-search",\r\n        "caption": "Advanced Search",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "advsearch-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/catalog",\r\n        "icon": "sprite-ic ic-t-cat",\r\n        "caption": "Catalog",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "catalog-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/connect-data-import",\r\n        "icon": "icon-data-loaders",\r\n        "caption": "Data Loaders",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "data-loaders-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/dataset/overview",\r\n        "icon": "sprite-ic ic-t-dat",\r\n        "caption": "Datasets",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "datasets-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/log",\r\n        "icon": "sprite-ic ic-t-err",\r\n        "caption": "Errors",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "errors-microapp.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/dashboards/#",\r\n        "icon": "icon-predix-dashboards",\r\n        "caption": "GE Dashboards",\r\n        "subApps": [\r\n          {\r\n            "href": "#app-hub/dashboards/#/cards",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Card Library",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "dashboardmicroapp.0.0"\r\n          }\r\n        ],\r\n        "orderUnderParent": 0,\r\n        "id": "dashboardmicroapp.0"\r\n      },\r\n      {\r\n        "href": "#/dashboard",\r\n        "icon": "icon-general-dashboards",\r\n        "caption": "General Dashboards",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "general-dashboard-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/graph",\r\n        "icon": "sprite-ic ic-t-gra",\r\n        "caption": "Graphs",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "graphs-microapp.0"\r\n      },\r\n      {\r\n        "href": "!shell/hyperlink",\r\n        "icon": "icons-hyperlink-utility-icon",\r\n        "caption": "Hyperlink Utility",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "hyperlink-utility-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/maps",\r\n        "icon": "icon-map-module",\r\n        "caption": "Maps",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "maps-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/metrics/home",\r\n        "icon": "sprite-ic ic-p-mas",\r\n        "caption": "Metrics and Scorecards",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "metrics-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/policy/overview",\r\n        "icon": "icon-policy-new",\r\n        "caption": "Policy Designer",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "policy-manager-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/query",\r\n        "icon": "sprite-ic ic-t-que",\r\n        "caption": "Queries",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "queries-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/rscript",\r\n        "icon": "icon-r-node",\r\n        "caption": "R Scripts",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "rsciprts-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/ssrs",\r\n        "icon": "sprite-ic ic-t-rep",\r\n        "caption": "Reports",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "reports-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/script",\r\n        "icon": "icon-scripts",\r\n        "caption": "Scripts",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "scripts-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/teams/-1",\r\n        "icon": "icon-resources",\r\n        "caption": "Teams",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "teams-microapp.0"\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    "name": "Admin",\r\n    "caption": "Admin",\r\n    "icon": "icon-user-nav ic-nav",\r\n    "id": "administration.0",\r\n    "orderUnderParent": 5,\r\n    "apps": [\r\n      {\r\n        "href": "#/admin-menu/application-settings",\r\n        "icon": "sprite-ic ic-a-smfc",\r\n        "caption": "Application Settings",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "application-settings.0"\r\n      },\r\n      {\r\n        "href": "#/admin-menu/data-configuration",\r\n        "icon": "sprite-ic ic-a-cm",\r\n        "caption": "Configuration Manager",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "configuration-manager.0"\r\n      },\r\n      {\r\n        "href": "#/admin-menu/operations-manager",\r\n        "icon": "sprite-ic ic-a-om",\r\n        "caption": "Operations Manager",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "operations-manager.0"\r\n      },\r\n      {\r\n        "href": "",\r\n        "icon": "icon-predix-admin",\r\n        "caption": "Predix Administrator",\r\n        "subApps": [\r\n          {\r\n            "href": "#app-hub/audit/#/auditlog",\r\n            "icon": "fa fa-table",\r\n            "caption": "Audit Logs",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "auditlog.0"\r\n          },\r\n          {\r\n            "href": "#app-hub/admin/#/users",\r\n            "icon": "fa fa-table",\r\n            "caption": "Users",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "usermanagement.0.0"\r\n          },\r\n          {\r\n            "href": "#app-hub/preferences/#/tenant",\r\n            "icon": "fa fa-cog",\r\n            "caption": "Tenant Preferences",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "preferencesMicroApp.0"\r\n          },\r\n          {\r\n            "href": "#app-hub/admin/#/groups",\r\n            "icon": "fa fa-cog",\r\n            "caption": "User Groups",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "usermanagement.0.2"\r\n          },\r\n          {\r\n            "href": "#app-hub/admin/#/permission-sets",\r\n            "icon": "fa fa-cog",\r\n            "caption": "Permission Sets",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "usermanagement.0.1"\r\n          }\r\n        ],\r\n        "orderUnderParent": 0,\r\n        "id": "Predix Administrator"\r\n      },\r\n      {\r\n        "href": "#app-hub/tenantsetup/#/",\r\n        "icon": "fa fa-cogs",\r\n        "caption": "Setup",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "tenantsetup.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/unitsofconversion/#/",\r\n        "icon": "fa fa-cog",\r\n        "caption": "Units of Measure Conversions",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "unitsofConversion.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/preferences/#/user",\r\n        "icon": "icon-predix-user-preferences",\r\n        "caption": "User Preferences",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "userpreference"\r\n      },\r\n      {\r\n        "href": "#app-hub/user",\r\n        "icon": "icon-predix-user-profile-icon",\r\n        "caption": "User Profile",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "userprofile"\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    "name": "Apps",\r\n    "caption": "Apps",\r\n    "icon": "icon-left-nav-apps ic-nav",\r\n    "id": "appsfolder.0",\r\n    "orderUnderParent": 6,\r\n    "apps": [\r\n      {\r\n        "href": "#app-hub/dataingestion/#",\r\n        "icon": "fa fa-exchange",\r\n        "caption": "Asset Ingestion",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "dataIngestion.0"\r\n      }\r\n    ]\r\n  }\r\n]\r\n';});


define('text!shell/nav-config/configurations/pe.json',[],function () { return '[\r\n  {\r\n    "name": "Essentials",\r\n    "caption": "Essentials",\r\n    "icon": "icon-zoom-control ic-nav",\r\n    "id": "healthfolder.0",\r\n    "orderUnderParent": 0,\r\n    "apps": [\r\n      {\r\n        "href": "#app-hub/dashboards/#",\r\n        "icon": "icon-predix-dashboards",\r\n        "caption": "GE Dashboards",\r\n        "subApps": [\r\n          {\r\n            "href": "#app-hub/dashboards/#/cards",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Card Library",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "dashboardmicroapp.0.0"\r\n          },\r\n          {\r\n            "href": "#app-hub/dashboards/#/favorites",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Favorites",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "dashboardmicroapp.0.1"\r\n          }\r\n        ],\r\n        "orderUnderParent": 0,\r\n        "id": "dashboardmicroapp.0"\r\n      },\r\n      {\r\n        "href": "#/dashboard",\r\n        "icon": "icon-general-dashboards",\r\n        "caption": "General Dashboards",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "general-dashboard-microapp.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/alarms/#",\r\n        "icon": "icon-alert-small",\r\n        "caption": "Alerts",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "alarmsmicroapp.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/analysis/#",\r\n        "icon": "icon-predix-analysis",\r\n        "caption": "Analysis",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "analysismicroapp.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/cases/#/unclaimed",\r\n        "icon": "icon-predix-cases",\r\n        "caption": "Cases",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "casesmicroapp.0"\r\n      },\r\n      {\r\n        "href": "#/action-management",\r\n        "icon": "icon-recommendation-manager",\r\n        "caption": "Action Management",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "recommendation-management-microapp.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/hmi/#/all",\r\n        "icon": "fa fa-desktop",\r\n        "caption": "HMI",\r\n        "subApps": [\r\n          {\r\n            "href": "#app-hub/hmi/#/all",\r\n            "caption": "Mimic + Alarms",\r\n            "id": "mimic+alarms-app.0.0"\r\n          },\r\n          {\r\n            "href": "#app-hub/hmi/#/mimic",\r\n            "caption": "Mimic",\r\n            "id": "mimic+alarms-app.0.1"\r\n          },\r\n          {\r\n            "href": "#app-hub/hmi/#/alarms",\r\n            "caption": "Alarms",\r\n            "id": "mimic+alarms-app.0.2"\r\n          }\r\n        ],\r\n        "orderUnderParent": 0,\r\n        "id": "mimic+alarms-app.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/assetmgmt/#",\r\n        "icon": "icon-predix-assets",\r\n        "caption": "Assets",\r\n        "subApps": [\r\n          {\r\n            "href": "#app-hub/assetmgmt/#/assetMgmt",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Asset Instances",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "assetmanagement.0.0"\r\n          },\r\n          {\r\n            "href": "#app-hub/assetmgmt/#/groups",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Groups",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "assetmanagement.0.1"\r\n          },\r\n          {\r\n            "href": "#app-hub/assetmgmt/#/classifications",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Classifications",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "assetmanagement.0.2"\r\n          },\r\n          {\r\n            "href": "#app-hub/assetmgmt/#/templates",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Templates",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "assetmanagement.0.3"\r\n          },\r\n          {\r\n            "href": "#app-hub/assetmgmt/#/networks",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Networks",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "assetmanagement.0.4"\r\n          },\r\n          {\r\n            "href": "#app-hub/assetmgmt/#/search",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Search",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "assetmanagement.0.5"\r\n          }\r\n        ],\r\n        "orderUnderParent": 0,\r\n        "id": "assetmanagement.0"\r\n      },\r\n      {\r\n        "href": "#/aca",\r\n        "icon": "sprite-ic ic-r-aca",\r\n        "caption": "Asset Criticality Analysis",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "acamicroapp.0"\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    "name": "Tools",\r\n    "caption": "Tools",\r\n    "icon": "icon-tools",\r\n    "id": "toolsfolder.0",\r\n    "orderUnderParent": 4,\r\n    "apps": [\r\n      {\r\n        "href": "#/catalog",\r\n        "icon": "sprite-ic ic-t-cat",\r\n        "caption": "Catalog",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "catalog-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/connect-data-import",\r\n        "icon": "icon-data-loaders",\r\n        "caption": "Data Loaders",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "data-loaders-microapp.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/hmidesigner/#/mimic-management",\r\n        "icon": "fa fa-desktop",\r\n        "caption": "HMI Designer",\r\n        "subApps": [\r\n          {\r\n            "href": "#app-hub/hmidesigner/#/mimic-management",\r\n            "icon": "fa fa-paint-brush",\r\n            "caption": "Mimic Management",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "hmidesigner-app.0"\r\n          }\r\n        ],\r\n        "orderUnderParent": 0,\r\n        "id": "mimic+alarms-app.0"\r\n      },\r\n      {\r\n        "href": "#/metrics/home",\r\n        "icon": "sprite-ic ic-p-mas",\r\n        "caption": "Metrics and Scorecards",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "metrics-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/policy/overview",\r\n        "icon": "icon-policy-new",\r\n        "caption": "Policy Designer",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "policy-manager-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/query",\r\n        "icon": "sprite-ic ic-t-que",\r\n        "caption": "Queries",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "queries-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/graph",\r\n        "icon": "sprite-ic ic-t-gra",\r\n        "caption": "Graphs",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "graphs-microapp.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/caf/#/",\r\n        "icon": "icon-predix-analytics",\r\n        "caption": "Analytics",\r\n        "subApps": [\r\n          {\r\n            "href": "#app-hub/caf/#/analytics",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Analytics Templates",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "analyticsmicroapp.0.0"\r\n          },\r\n          {\r\n            "href": "#app-hub/caf/#/orchestration",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Orchestrations",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "analyticsmicroapp.0.1"\r\n          },\r\n          {\r\n            "href": "#app-hub/caf/#/deployment",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Deployments",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "analyticsmicroapp.0.2"\r\n          },\r\n          {\r\n            "href": "#app-hub/caf/#/analyticApplicability",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Asset Filters",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "analyticsmicroapp.0.3"\r\n          },\r\n          {\r\n            "href": "#app-hub/caf/#/assetFiltersConfig",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Configurations",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "analyticsmicroapp.0.4"\r\n          }\r\n        ],\r\n        "orderUnderParent": 0,\r\n        "id": "analyticsmicroapp.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/alerttemplates/#/alerts",\r\n        "icon": "fa fa-file-text",\r\n        "caption": "Alert Templates",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "alerttemplatesmicroapp.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/casetemplates/#/cases",\r\n        "icon": "fa fa-file-text",\r\n        "caption": "Case Templates",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "casetemplatesmicroapp.0"\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    "name": "Admin",\r\n    "caption": "Admin",\r\n    "icon": "icon-user-nav ic-nav",\r\n    "id": "administration.0",\r\n    "orderUnderParent": 5,\r\n    "apps": [\r\n      {\r\n        "href": "#/admin-menu/application-settings",\r\n        "icon": "sprite-ic ic-a-smfc",\r\n        "caption": "Application Settings",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "application-settings.0"\r\n      },\r\n      {\r\n        "href": "#/admin-menu/data-configuration",\r\n        "icon": "sprite-ic ic-a-cm",\r\n        "caption": "Configuration Manager",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "configuration-manager.0"\r\n      },\r\n      {\r\n        "href": "#/admin-menu/operations-manager",\r\n        "icon": "sprite-ic ic-a-om",\r\n        "caption": "Operations Manager",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "operations-manager.0"\r\n      },\r\n      {\r\n        "href": "",\r\n        "icon": "icon-predix-admin",\r\n        "caption": "Predix Administrator",\r\n        "subApps": [\r\n          {\r\n            "href": "#app-hub/audit/#/auditlog",\r\n            "icon": "fa fa-table",\r\n            "caption": "Audit Logs",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "auditlog.0"\r\n          },\r\n          {\r\n            "href": "#app-hub/admin/#/users",\r\n            "icon": "fa fa-table",\r\n            "caption": "Users",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "usermanagement.0.0"\r\n          },\r\n          {\r\n            "href": "#app-hub/preferences/#/tenant",\r\n            "icon": "fa fa-cog",\r\n            "caption": "Tenant Preferences",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "preferencesMicroApp.0"\r\n          },\r\n          {\r\n            "href": "#app-hub/admin/#/groups",\r\n            "icon": "fa fa-cog",\r\n            "caption": "User Groups",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "usermanagement.0.2"\r\n          },\r\n          {\r\n            "href": "#app-hub/admin/#/permission-sets",\r\n            "icon": "fa fa-cog",\r\n            "caption": "Permission Sets",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "usermanagement.0.1"\r\n          }\r\n        ],\r\n        "orderUnderParent": 0,\r\n        "id": "Predix Administrator"\r\n      },\r\n      {\r\n        "href": "#app-hub/tenantsetup/#/",\r\n        "icon": "fa fa-cogs",\r\n        "caption": "Setup",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "tenantsetup.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/unitsofconversion/#/",\r\n        "icon": "icon-predix-user-preferences",\r\n        "caption": "Units of Measure Conversions",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "unitsofConversion.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/preferences/#/user",\r\n        "icon": "icon-predix-user-preferences",\r\n        "caption": "User Preferences",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "userpreference"\r\n      },\r\n      {\r\n        "href": "#app-hub/user",\r\n        "icon": "icon-predix-user-profile-icon",\r\n        "caption": "User Profile",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "userprofile"\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    "name": "Apps",\r\n    "caption": "Apps",\r\n    "icon": "icon-left-nav-apps ic-nav",\r\n    "id": "appsfolder.0",\r\n    "orderUnderParent": 6,\r\n    "apps": [\r\n      {\r\n        "href": "#app-hub/dataingestion/#",\r\n        "icon": "fa fa-exchange",\r\n        "caption": "Asset Ingestion",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "dataIngestion.0"\r\n      }\r\n    ]\r\n  }\r\n]\r\n';});


define('text!shell/nav-config/configurations/pe-apm.json',[],function () { return '[\r\n  {\r\n    "name": "Essentials",\r\n    "caption": "Essentials",\r\n    "icon": "icon-zoom-control ic-nav",\r\n    "id": "essentialsfolder.0",\r\n    "orderUnderParent": 0,\r\n    "apps": [\r\n      {\r\n        "href": "#app-hub/dashboards/#",\r\n        "icon": "icon-predix-dashboards",\r\n        "caption": "GE Dashboards",\r\n        "subApps": [\r\n          {\r\n            "href": "#app-hub/dashboards/#/cards",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Card Library",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "dashboardmicroapp.0.0"\r\n          },\r\n          {\r\n            "href": "#app-hub/dashboards/#/favorites",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Favorites",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "dashboardmicroapp.0.1"\r\n          }\r\n        ],\r\n        "orderUnderParent": 0,\r\n        "id": "dashboardmicroapp.0"\r\n      },\r\n      {\r\n        "href": "#/dashboard",\r\n        "icon": "icon-general-dashboards",\r\n        "caption": "General Dashboards",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "general-dashboard-microapp.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/alarms/#",\r\n        "icon": "icon-alert-small",\r\n        "caption": "Alerts",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "alarmsmicroapp.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/analysis/#",\r\n        "icon": "icon-predix-analysis",\r\n        "caption": "Analysis",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "analysismicroapp.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/cases/#/unclaimed",\r\n        "icon": "icon-predix-cases",\r\n        "caption": "Cases",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "casesmicroapp.0"\r\n      },\r\n      {\r\n        "href": "#/action-management",\r\n        "icon": "icon-recommendation-manager",\r\n        "caption": "Action Management",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "recommendation-management-microapp.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/hmi/#/all",\r\n        "icon": "fa fa-desktop",\r\n        "caption": "HMI",\r\n        "subApps": [\r\n          {\r\n            "href": "#app-hub/hmi/#/all",\r\n            "caption": "Mimic + Alarms",\r\n            "id": "mimic+alarms-app.0.0"\r\n          },\r\n          {\r\n            "href": "#app-hub/hmi/#/mimic",\r\n            "caption": "Mimic",\r\n            "id": "mimic+alarms-app.0.1"\r\n          },\r\n          {\r\n            "href": "#app-hub/hmi/#/alarms",\r\n            "caption": "Alarms",\r\n            "id": "mimic+alarms-app.0.2"\r\n          }\r\n        ],\r\n        "orderUnderParent": 0,\r\n        "id": "mimic+alarms-app.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/assetmgmt/#",\r\n        "icon": "icon-predix-assets",\r\n        "caption": "Assets",\r\n        "subApps": [\r\n          {\r\n            "href": "#app-hub/assetmgmt/#/assetMgmt",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Asset Instances",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "assetmanagement.0.0"\r\n          },\r\n          {\r\n            "href": "#app-hub/assetmgmt/#/groups",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Groups",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "assetmanagement.0.1"\r\n          },\r\n          {\r\n            "href": "#app-hub/assetmgmt/#/classifications",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Classifications",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "assetmanagement.0.2"\r\n          },\r\n          {\r\n            "href": "#app-hub/assetmgmt/#/templates",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Templates",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "assetmanagement.0.3"\r\n          },\r\n          {\r\n            "href": "#app-hub/assetmgmt/#/networks",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Networks",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "assetmanagement.0.4"\r\n          },\r\n          {\r\n            "href": "#app-hub/assetmgmt/#/search",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Search",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "assetmanagement.0.5"\r\n          }\r\n        ],\r\n        "orderUnderParent": 0,\r\n        "id": "assetmanagement.0"\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    "name": "Health",\r\n    "caption": "Health",\r\n    "icon": "icon-risk",\r\n    "id": "healthfolder.0",\r\n    "orderUnderParent": 0,\r\n    "apps": [\r\n      {\r\n        "href": "#/ams/overview",\r\n        "icon": "icon-ams-analytics",\r\n        "caption": "AMS Analytics",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "ams-analytics-microapp.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/analysis/#",\r\n        "icon": "fa fa-area-chart fa",\r\n        "caption": "Analysis",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "analysismicroapp.0"\r\n      },\r\n      {\r\n        "href": "#/health/overview",\r\n        "icon": "ic-p-ahm",\r\n        "caption": "Asset Health Manager",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "asset-health-manager-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/asset-safety/calibration/calibration-mgmt",\r\n        "icon": "sprite-ic ic-s-cm",\r\n        "caption": "Calibration Management",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "calibration-mgmt-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/elog/dashboard/0",\r\n        "icon": "icon-elog",\r\n        "caption": "eLog",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "elog-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/ge/overview",\r\n        "icon": "icon-ge-analytics",\r\n        "caption": "GE Analytics",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "ge-analytics-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/rounds/dashboard/user",\r\n        "icon": "icon-rounds-new",\r\n        "caption": "Rounds Data Collection",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "rounds-data-collection-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/rounds/dashboard/admin",\r\n        "icon": "icon-route-designer-new",\r\n        "caption": "Rounds Designer",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "rounds-designer-microapp.0"\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    "name": "Reliability",\r\n    "caption": "Reliability",\r\n    "icon": "icon-strategy-nav",\r\n    "id": "reliabilityfolder.0",\r\n    "orderUnderParent": 1,\r\n    "apps": [\r\n      {\r\n        "href": "#/cognitive/overview",\r\n        "icon": "icon-cognitive-analytics",\r\n        "caption": "Cognitive Analytics",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "cognitive-analytics-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/gaa/dashboard/0",\r\n        "icon": "icon-gaa-module",\r\n        "caption": "Generation Availability Analysis",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "general-avail-analysis-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/gaa-wind/dashboard/0",\r\n        "icon": "icon-gaa-wind",\r\n        "caption": "Generation Availability Analysis Wind",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "gaawind-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/failure-elimination/pla/dashboard/0",\r\n        "icon": "sprite-ic ic-p-pla",\r\n        "caption": "Production Loss Analysis",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "production-loss-analysis-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/reliability/dashboard/0",\r\n        "icon": "sprite-ic ic-p-ra",\r\n        "caption": "Reliability Analytics",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "reliability-analytics-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/failure-elimination/rca/dashboard/0",\r\n        "icon": "sprite-ic ic-p-rca",\r\n        "caption": "Root Cause Analysis",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "rootcause-analysis-microapp.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/apm-sm-monitor-ui/#/",\r\n        "icon": "fa fa-heartbeat",\r\n        "caption": "SmartSignal Deployments",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "ssMonitorUIMicroapp.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/ss-maintenance/#/",\r\n        "icon": "fa fa-wrench",\r\n        "caption": "SmartSignal Maintenance",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "ssMaintenanceMicroApp.0"\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    "name": "Strategy",\r\n    "caption": "Strategy",\r\n    "icon": "icon-strategy",\r\n    "id": "strategyfolder.0",\r\n    "orderUnderParent": 2,\r\n    "apps": [\r\n      {\r\n        "href": "#/asi/overview",\r\n        "icon": "sprite-ic ic-s-asi",\r\n        "caption": "Asset Strategy Implementation",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "asset-strategy-implementation-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/strategy/overview",\r\n        "icon": "sprite-ic ic-s-asm",\r\n        "caption": "Asset Strategy Management",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "asset-strategy-management-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/fmea/overview",\r\n        "icon": "sprite-ic ic-r-rca",\r\n        "caption": "Failure Modes and Effects Analysis",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "fmea-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/lcc/dashboard/0",\r\n        "icon": "icon-lcc",\r\n        "caption": "Life Cycle Cost Analysis",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "lcc-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/rcm/overview",\r\n        "icon": "sprite-ic ic-r-rcm",\r\n        "caption": "Reliability Centered Maintenance",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "rcm-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/aca",\r\n        "icon": "sprite-ic ic-r-aca",\r\n        "caption": "Asset Criticality Analysis",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "acamicroapp.0"\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    "name": "Integrity",\r\n    "caption": "Integrity",\r\n    "icon": "icon-plus",\r\n    "id": "integrityfolder.0",\r\n    "orderUnderParent": 3,\r\n    "apps": [\r\n      {\r\n        "href": "#/cm/overview",\r\n        "icon": "icon-compliance",\r\n        "caption": "Compliance Management",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "compliance-mgmt-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/asset-safety/hazards/overview",\r\n        "icon": "sprite-ic ic-r-ha",\r\n        "caption": "Hazards Analysis",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "hazards-analysis-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/im/offline/overview",\r\n        "icon": "icon-inspection-field-data-collection",\r\n        "caption": "Inspection Field Data Collection",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "inspection-field-data-collection-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/im/functionallocation/0/overview",\r\n        "icon": "sprite-ic ic-s-im",\r\n        "caption": "Inspection Management",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "inspection-mgmt-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/asset-safety/lopa/overview",\r\n        "icon": "icon-lopa",\r\n        "caption": "Layers of Protection Analysis",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "layers-protection-analysis-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/asset-safety/moc/overview",\r\n        "icon": "icon-moc",\r\n        "caption": "Management of Change",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "moc-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/asset-safety/sis/overview/offline",\r\n        "icon": "icon-proof-test",\r\n        "caption": "Mobile Proof Test",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "mobile-proof-test-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/rbi/unit",\r\n        "icon": "sprite-ic ic-r-rbi",\r\n        "caption": "Risk Based Inspection",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "rbimicroapp.0"\r\n      },\r\n      {\r\n        "href": "#/asset-safety/sis/overview",\r\n        "icon": "sprite-ic ic-r-sism",\r\n        "caption": "SIS Management",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "sis-mgmt-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/tm/unit",\r\n        "icon": "sprite-ic ic-s-tm",\r\n        "caption": "Thickness Monitoring",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "thickness-monitoring-microapp.0"\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    "name": "Tools",\r\n    "caption": "Tools",\r\n    "icon": "icon-tools",\r\n    "id": "toolsfolder.0",\r\n    "orderUnderParent": 4,\r\n    "apps": [\r\n      {\r\n        "href": "#/catalog",\r\n        "icon": "sprite-ic ic-t-cat",\r\n        "caption": "Catalog",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "catalog-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/connect-data-import",\r\n        "icon": "icon-data-loaders",\r\n        "caption": "Data Loaders",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "data-loaders-microapp.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/hmidesigner/#/mimic-management",\r\n        "icon": "fa fa-desktop",\r\n        "caption": "HMI Designer",\r\n        "subApps": [\r\n          {\r\n            "href": "#app-hub/hmidesigner/#/mimic-management",\r\n            "icon": "fa fa-paint-brush",\r\n            "caption": "Mimic Management",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "mimic+alarms-app.0"\r\n          }\r\n        ],\r\n        "orderUnderParent": 0,\r\n        "id": "hmidesigner-app.0"\r\n      },\r\n      {\r\n        "href": "#/graph",\r\n        "icon": "sprite-ic ic-t-gra",\r\n        "caption": "Graphs",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "graphs-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/metrics/home",\r\n        "icon": "sprite-ic ic-p-mas",\r\n        "caption": "Metrics and Scorecards",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "metrics-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/policy/overview",\r\n        "icon": "icon-policy-new",\r\n        "caption": "Policy Designer",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "policy-manager-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/query",\r\n        "icon": "sprite-ic ic-t-que",\r\n        "caption": "Queries",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "queries-microapp.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/caf/#/",\r\n        "icon": "icon-predix-analytics",\r\n        "caption": "Analytics",\r\n        "subApps": [\r\n          {\r\n            "href": "#app-hub/caf/#/analytics",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Analytics Templates",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "analyticsmicroapp.0.0"\r\n          },\r\n          {\r\n            "href": "#app-hub/caf/#/orchestration",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Orchestrations",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "analyticsmicroapp.0.1"\r\n          },\r\n          {\r\n            "href": "#app-hub/caf/#/deployment",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Deployments",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "analyticsmicroapp.0.2"\r\n          },\r\n          {\r\n            "href": "#app-hub/caf/#/analyticApplicability",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Asset Filters",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "analyticsmicroapp.0.3"\r\n          },\r\n          {\r\n            "href": "#app-hub/caf/#/assetFiltersConfig",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Configurations",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "analyticsmicroapp.0.4"\r\n          }\r\n        ],\r\n        "orderUnderParent": 0,\r\n        "id": "analyticsmicroapp.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/alerttemplates/#/alerts",\r\n        "icon": "fa fa-file-text",\r\n        "caption": "Alert Templates",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "alerttemplatesmicroapp.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/casetemplates/#/cases",\r\n        "icon": "fa fa-file-text",\r\n        "caption": "Case Templates",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "casetemplatesmicroapp.0"\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    "name": "Admin",\r\n    "caption": "Admin",\r\n    "icon": "icon-user-nav ic-nav",\r\n    "id": "administration.0",\r\n    "orderUnderParent": 5,\r\n    "apps": [\r\n      {\r\n        "href": "#/admin-menu/application-settings",\r\n        "icon": "sprite-ic ic-a-smfc",\r\n        "caption": "Application Settings",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "application-settings.0"\r\n      },\r\n      {\r\n        "href": "#/admin-menu/data-configuration",\r\n        "icon": "sprite-ic ic-a-cm",\r\n        "caption": "Configuration Manager",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "configuration-manager.0"\r\n      },\r\n      {\r\n        "href": "#/admin-menu/operations-manager",\r\n        "icon": "sprite-ic ic-a-om",\r\n        "caption": "Operations Manager",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "operations-manager.0"\r\n      },\r\n      {\r\n        "href": "",\r\n        "icon": "icon-predix-admin",\r\n        "caption": "Predix Administrator",\r\n        "subApps": [\r\n          {\r\n            "href": "#app-hub/audit/#/auditlog",\r\n            "icon": "fa fa-table",\r\n            "caption": "Audit Logs",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "auditlog.0"\r\n          },\r\n          {\r\n            "href": "#app-hub/admin/#/users",\r\n            "icon": "fa fa-table",\r\n            "caption": "Users",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "usermanagement.0.0"\r\n          },\r\n          {\r\n            "href": "#app-hub/preferences/#/tenant",\r\n            "icon": "fa fa-cog",\r\n            "caption": "Tenant Preferences",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "preferencesMicroApp.0"\r\n          },\r\n          {\r\n            "href": "#app-hub/admin/#/groups",\r\n            "icon": "fa fa-cog",\r\n            "caption": "User Groups",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "usermanagement.0.2"\r\n          },\r\n          {\r\n            "href": "#app-hub/admin/#/permission-sets",\r\n            "icon": "fa fa-cog",\r\n            "caption": "Permission Sets",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "usermanagement.0.1"\r\n          }\r\n        ],\r\n        "orderUnderParent": 0,\r\n        "id": "Predix Administrator"\r\n      },\r\n      {\r\n        "href": "#app-hub/tenantsetup/#/",\r\n        "icon": "fa fa-cogs",\r\n        "caption": "Setup",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "tenantsetup.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/unitsofconversion/#/",\r\n        "icon": "fa fa-cog",\r\n        "caption": "Units of Measure Conversions",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "unitsofConversion.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/preferences/#/user",\r\n        "icon": "icon-predix-user-preferences",\r\n        "caption": "User Preferences",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "userpreference"\r\n      },\r\n      {\r\n        "href": "#app-hub/user",\r\n        "icon": "icon-predix-user-profile-icon",\r\n        "caption": "User Profile",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "userprofile"\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    "name": "Apps",\r\n    "caption": "Apps",\r\n    "icon": "icon-left-nav-apps ic-nav",\r\n    "id": "appsfolder.0",\r\n    "orderUnderParent": 6,\r\n    "apps": [\r\n      {\r\n        "href": "#app-hub/dataingestion/#",\r\n        "icon": "fa fa-exchange",\r\n        "caption": "Asset Ingestion",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "dataIngestion.0"\r\n      }\r\n    ]\r\n  }\r\n]\r\n';});


define('text!shell/nav-config/configurations/pe-opm.json',[],function () { return '[\r\n  {\r\n    "name": "Essentials",\r\n    "caption": "Essentials",\r\n    "icon": "icon-zoom-control ic-nav",\r\n    "id": "essentialsfolder.0",\r\n    "orderUnderParent": 0,\r\n    "apps": [\r\n      {\r\n        "href": "#app-hub/dashboards/#",\r\n        "icon": "icon-predix-dashboards",\r\n        "caption": "GE Dashboards",\r\n        "subApps": [\r\n          {\r\n            "href": "#app-hub/dashboards/#/cards",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Card Library",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "dashboardmicroapp.0.0"\r\n          },\r\n          {\r\n            "href": "#app-hub/dashboards/#/favorites",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Favorites",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "dashboardmicroapp.0.1"\r\n          }\r\n        ],\r\n        "orderUnderParent": 0,\r\n        "id": "dashboardmicroapp.0"\r\n      },\r\n      {\r\n        "href": "#/dashboard",\r\n        "icon": "icon-general-dashboards",\r\n        "caption": "General Dashboards",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "general-dashboard-microapp.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/alarms/#",\r\n        "icon": "icon-alert-small",\r\n        "caption": "Alerts",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "alarmsmicroapp.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/analysis/#",\r\n        "icon": "icon-predix-analysis",\r\n        "caption": "Analysis",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "analysismicroapp.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/cases/#/unclaimed",\r\n        "icon": "icon-predix-cases",\r\n        "caption": "Cases",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "casesmicroapp.0"\r\n      },\r\n      {\r\n        "href": "#/action-management",\r\n        "icon": "icon-recommendation-manager",\r\n        "caption": "Action Management",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "recommendation-management-microapp.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/hmi/#/all",\r\n        "icon": "fa fa-desktop",\r\n        "caption": "HMI",\r\n        "subApps": [\r\n          {\r\n            "href": "#app-hub/hmi/#/all",\r\n            "caption": "Mimic + Alarms",\r\n            "id": "mimic+alarms-app.0.0"\r\n          },\r\n          {\r\n            "href": "#app-hub/hmi/#/mimic",\r\n            "caption": "Mimic",\r\n            "id": "mimic+alarms-app.0.1"\r\n          },\r\n          {\r\n            "href": "#app-hub/hmi/#/alarms",\r\n            "caption": "Alarms",\r\n            "id": "mimic+alarms-app.0.2"\r\n          }\r\n        ],\r\n        "orderUnderParent": 0,\r\n        "id": "mimic+alarms-app.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/assetmgmt/#",\r\n        "icon": "icon-predix-assets",\r\n        "caption": "Assets",\r\n        "subApps": [\r\n          {\r\n            "href": "#app-hub/assetmgmt/#/assetMgmt",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Asset Instances",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "assetmanagement.0.0"\r\n          },\r\n          {\r\n            "href": "#app-hub/assetmgmt/#/groups",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Groups",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "assetmanagement.0.1"\r\n          },\r\n          {\r\n            "href": "#app-hub/assetmgmt/#/classifications",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Classifications",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "assetmanagement.0.2"\r\n          },\r\n          {\r\n            "href": "#app-hub/assetmgmt/#/templates",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Templates",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "assetmanagement.0.3"\r\n          },\r\n          {\r\n            "href": "#app-hub/assetmgmt/#/networks",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Networks",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "assetmanagement.0.4"\r\n          },\r\n          {\r\n            "href": "#app-hub/assetmgmt/#/search",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Search",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "assetmanagement.0.5"\r\n          }\r\n        ],\r\n        "orderUnderParent": 0,\r\n        "id": "assetmanagement.0"\r\n      },\r\n      {\r\n        "href": "#/aca",\r\n        "icon": "sprite-ic ic-r-aca",\r\n        "caption": "Asset Criticality Analysis",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "acamicroapp.0"\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    "name": "Intelligence",\r\n    "caption": "Intelligence",\r\n    "icon": "icon-strategy-nav",\r\n    "id": "intelligence.0",\r\n    "orderUnderParent": 0,\r\n    "apps": [\r\n      {\r\n        "href": "#app-hub/alarms/#",\r\n        "icon": "icon-alert-small",\r\n        "caption": "KPI Alerts",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "alarmsmicroapp.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/dashboards/#",\r\n        "icon": "icon-predix-dashboards",\r\n        "caption": "KPI Dashboards",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "dashboardmicroapp.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/analysis/#",\r\n        "icon": "icon-predix-analysis",\r\n        "caption": "KPI Analysis",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "analysismicroapp.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/analysis/#",\r\n        "icon": "icon-predix-analysis",\r\n        "caption": "KPI Benchmarking",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "analysismicroapp.0"\r\n      },\r\n      {\r\n        "href": "#access-denied",\r\n        "icon": "sprite-ic ic-t-que",\r\n        "caption": "Process Troubleshooter",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "analysismicroapp.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/dashboards/#",\r\n        "icon": "icon-predix-dashboards",\r\n        "caption": "Control Loop Performance (GE Dashboards)",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "dashboardmicroapp.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/cases/#/unclaimed",\r\n        "icon": "icon-predix-cases",\r\n        "caption": "Case Collaboration",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "casesmicroapp.0"\r\n      },\r\n      {\r\n        "href": "#/action-management",\r\n        "icon": "icon-recommendation-manager",\r\n        "caption": "Action Management",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "recommendation-management-microapp.0"\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    "name": "Forecast",\r\n    "caption": "Forecast",\r\n    "icon": "icon-strategy",\r\n    "id": "Forecast.0",\r\n    "orderUnderParent": 0,\r\n    "apps": [\r\n      {\r\n        "href": "#app-hub/caf/#/",\r\n        "icon": "icon-predix-analytics",\r\n        "caption": "Process Digital Twins",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "analyticsmicroapp.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/alarms/#",\r\n        "icon": "icon-alert-small",\r\n        "caption": "Predictive KPI Alerts",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "alarmsmicroapp.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/dashboards/#",\r\n        "icon": "icon-predix-dashboards",\r\n        "caption": "Forecasting KPI Dashboards",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "dashboardmicroapp.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/analysis/#",\r\n        "icon": "icon-predix-analysis",\r\n        "caption": "Forecasting KPI Analysis",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "analysismicroapp.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/analysis/#",\r\n        "icon": "icon-predix-analysis",\r\n        "caption": "What-If KPI Analysis",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "analysismicroapp.0"\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    "name": "Optimize",\r\n    "caption": "Optimize",\r\n    "icon": "icon-plus",\r\n    "id": "Optimize.0",\r\n    "orderUnderParent": 0,\r\n    "apps": [\r\n      {\r\n        "href": "#app-hub/caf/#/",\r\n        "icon": "icon-predix-analytics",\r\n        "caption": "Decision Support Optimizers",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "analyticsmicroapp.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/caf/#/",\r\n        "icon": "icon-predix-analytics",\r\n        "caption": "Closed Loop Control Optimizers",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "analyticsmicroapp.0"\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    "name": "Tools",\r\n    "caption": "Tools",\r\n    "icon": "icon-tools",\r\n    "id": "toolsfolder.0",\r\n    "orderUnderParent": 4,\r\n    "apps": [\r\n      {\r\n        "href": "#/catalog",\r\n        "icon": "sprite-ic ic-t-cat",\r\n        "caption": "Catalog",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "catalog-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/connect-data-import",\r\n        "icon": "icon-data-loaders",\r\n        "caption": "Data Loaders",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "data-loaders-microapp.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/hmidesigner/#/mimic-management",\r\n        "icon": "fa fa-desktop",\r\n        "caption": "HMI Designer",\r\n        "subApps": [{\r\n          "href": "#app-hub/hmidesigner/#/mimic-management",\r\n          "icon": "fa fa-desktop",\r\n          "caption": "Mimic Management",\r\n          "subApps": [],\r\n          "orderUnderParent": 0,\r\n          "id": "hmidesigner-app.0"\r\n        }],\r\n        "orderUnderParent": 0,\r\n        "id": "mimic+alarms-app.0"\r\n      },\r\n      {\r\n        "href": "#/metrics/home",\r\n        "icon": "sprite-ic ic-p-mas",\r\n        "caption": "Metrics and Scorecards",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "metrics-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/policy/overview",\r\n        "icon": "icon-policy-new",\r\n        "caption": "Policy Designer",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "policy-manager-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/query",\r\n        "icon": "sprite-ic ic-t-que",\r\n        "caption": "Queries",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "queries-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/graph",\r\n        "icon": "sprite-ic ic-t-gra",\r\n        "caption": "Graphs",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "graphs-microapp.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/caf/#/",\r\n        "icon": "icon-predix-analytics",\r\n        "caption": "Analytics",\r\n        "subApps": [\r\n          {\r\n            "href": "#app-hub/caf/#/analytics",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Analytics Templates",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "analyticsmicroapp.0.0"\r\n          },\r\n          {\r\n            "href": "#app-hub/caf/#/orchestration",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Orchestrations",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "analyticsmicroapp.0.1"\r\n          },\r\n          {\r\n            "href": "#app-hub/caf/#/deployment",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Deployments",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "analyticsmicroapp.0.2"\r\n          },\r\n          {\r\n            "href": "#app-hub/caf/#/analyticApplicability",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Asset Filters",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "analyticsmicroapp.0.3"\r\n          },\r\n          {\r\n            "href": "#app-hub/caf/#/assetFiltersConfig",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Configurations",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "analyticsmicroapp.0.4"\r\n          }\r\n        ],\r\n        "orderUnderParent": 0,\r\n        "id": "analyticsmicroapp.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/alerttemplates/#/alerts",\r\n        "icon": "fa fa-file-text",\r\n        "caption": "Alert Templates",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "alerttemplatesmicroapp.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/casetemplates/#/cases",\r\n        "icon": "fa fa-file-text",\r\n        "caption": "Case Templates",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "casetemplatesmicroapp.0"\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    "name": "Admin",\r\n    "caption": "Admin",\r\n    "icon": "icon-user-nav ic-nav",\r\n    "id": "administration.0",\r\n    "orderUnderParent": 5,\r\n    "apps": [\r\n      {\r\n        "href": "#/admin-menu/application-settings",\r\n        "icon": "sprite-ic ic-a-smfc",\r\n        "caption": "Application Settings",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "application-settings.0"\r\n      },\r\n      {\r\n        "href": "#/admin-menu/data-configuration",\r\n        "icon": "sprite-ic ic-a-cm",\r\n        "caption": "Configuration Manager",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "configuration-manager.0"\r\n      },\r\n      {\r\n        "href": "#/admin-menu/operations-manager",\r\n        "icon": "sprite-ic ic-a-om",\r\n        "caption": "Operations Manager",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "operations-manager.0"\r\n      },\r\n      {\r\n        "href": "",\r\n        "icon": "icon-predix-admin",\r\n        "caption": "Predix Administrator",\r\n        "subApps": [\r\n          {\r\n            "href": "#app-hub/audit/#/auditlog",\r\n            "icon": "fa fa-table",\r\n            "caption": "Audit Logs",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "auditlog.0"\r\n          },\r\n          {\r\n            "href": "#app-hub/admin/#/users",\r\n            "icon": "fa fa-table",\r\n            "caption": "Users",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "usermanagement.0.0"\r\n          },\r\n          {\r\n            "href": "#app-hub/preferences/#/tenant",\r\n            "icon": "fa fa-cog",\r\n            "caption": "Tenant Preferences",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "preferencesMicroApp.0"\r\n          },\r\n          {\r\n            "href": "#app-hub/admin/#/groups",\r\n            "icon": "fa fa-cog",\r\n            "caption": "User Groups",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "usermanagement.0.2"\r\n          },\r\n          {\r\n            "href": "#app-hub/admin/#/permission-sets",\r\n            "icon": "fa fa-cog",\r\n            "caption": "Permission Sets",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "usermanagement.0.1"\r\n          }\r\n        ],\r\n        "orderUnderParent": 0,\r\n        "id": "Predix Administrator"\r\n      },\r\n      {\r\n        "href": "#app-hub/tenantsetup/#/",\r\n        "icon": "fa fa-cogs",\r\n        "caption": "Setup",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "tenantsetup.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/unitsofconversion/#/",\r\n        "icon": "icon-predix-user-preferences",\r\n        "caption": "Units of Measure Conversions",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "unitsofConversion.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/preferences/#/user",\r\n        "icon": "icon-predix-user-preferences",\r\n        "caption": "User Preferences",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "userpreference"\r\n      },\r\n      {\r\n        "href": "#app-hub/user",\r\n        "icon": "icon-predix-user-profile-icon",\r\n        "caption": "User Profile",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "userprofile"\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    "name": "Apps",\r\n    "caption": "Apps",\r\n    "icon": "icon-left-nav-apps ic-nav",\r\n    "id": "appsfolder.0",\r\n    "orderUnderParent": 6,\r\n    "apps": [\r\n      {\r\n        "href": "#app-hub/dataingestion/#",\r\n        "icon": "fa fa-exchange",\r\n        "caption": "Asset Ingestion",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "dataIngestion.0"\r\n      }\r\n    ]\r\n  }\r\n]\r\n';});


define('text!shell/nav-config/configurations/pe-apm-opm.json',[],function () { return '[\r\n  {\r\n    "name": "Essentials",\r\n    "caption": "Essentials",\r\n    "icon": "icon-zoom-control ic-nav",\r\n    "id": "essentialsfolder.0",\r\n    "orderUnderParent": 0,\r\n    "apps": [\r\n      {\r\n        "href": "#app-hub/dashboards/#",\r\n        "icon": "icon-predix-dashboards",\r\n        "caption": "GE Dashboards",\r\n        "subApps": [\r\n          {\r\n            "href": "#app-hub/dashboards/#/cards",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Card Library",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "dashboardmicroapp.0.0"\r\n          },\r\n          {\r\n            "href": "#app-hub/dashboards/#/favorites",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Favorites",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "dashboardmicroapp.0.1"\r\n          }\r\n        ],\r\n        "orderUnderParent": 0,\r\n        "id": "dashboardmicroapp.0"\r\n      },\r\n      {\r\n        "href": "#/dashboard",\r\n        "icon": "icon-general-dashboards",\r\n        "caption": "General Dashboards",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "general-dashboard-microapp.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/alarms/#",\r\n        "icon": "icon-alert-small",\r\n        "caption": "Alerts",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "alarmsmicroapp.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/analysis/#",\r\n        "icon": "icon-predix-analysis",\r\n        "caption": "Analysis",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "analysismicroapp.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/cases/#/unclaimed",\r\n        "icon": "icon-predix-cases",\r\n        "caption": "Cases",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "casesmicroapp.0"\r\n      },\r\n      {\r\n        "href": "#/action-management",\r\n        "icon": "icon-recommendation-manager",\r\n        "caption": "Action Management",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "recommendation-management-microapp.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/hmi/#/all",\r\n        "icon": "fa fa-desktop",\r\n        "caption": "HMI",\r\n        "subApps": [\r\n          {\r\n            "href": "#app-hub/hmi/#/all",\r\n            "caption": "Mimic + Alarms",\r\n            "id": "mimic+alarms-app.0.0"\r\n          },\r\n          {\r\n            "href": "#app-hub/hmi/#/mimic",\r\n            "caption": "Mimic",\r\n            "id": "mimic+alarms-app.0.1"\r\n          },\r\n          {\r\n            "href": "#app-hub/hmi/#/alarms",\r\n            "caption": "Alarms",\r\n            "id": "mimic+alarms-app.0.2"\r\n          }\r\n        ],\r\n        "orderUnderParent": 0,\r\n        "id": "mimic+alarms-app.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/assetmgmt/#",\r\n        "icon": "icon-predix-assets",\r\n        "caption": "Assets",\r\n        "subApps": [\r\n          {\r\n            "href": "#app-hub/assetmgmt/#/assetMgmt",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Asset Instances",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "assetmanagement.0.0"\r\n          },\r\n          {\r\n            "href": "#app-hub/assetmgmt/#/groups",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Groups",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "assetmanagement.0.1"\r\n          },\r\n          {\r\n            "href": "#app-hub/assetmgmt/#/classifications",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Classifications",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "assetmanagement.0.2"\r\n          },\r\n          {\r\n            "href": "#app-hub/assetmgmt/#/templates",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Templates",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "assetmanagement.0.3"\r\n          },\r\n          {\r\n            "href": "#app-hub/assetmgmt/#/networks",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Networks",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "assetmanagement.0.4"\r\n          },\r\n          {\r\n            "href": "#app-hub/assetmgmt/#/search",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Search",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "assetmanagement.0.5"\r\n          }\r\n        ],\r\n        "orderUnderParent": 0,\r\n        "id": "assetmanagement.0"\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    "name": "Health",\r\n    "caption": "Health",\r\n    "icon": "icon-risk",\r\n    "id": "healthfolder.0",\r\n    "orderUnderParent": 0,\r\n    "apps": [\r\n      {\r\n        "href": "#/ams/overview",\r\n        "icon": "icon-ams-analytics",\r\n        "caption": "AMS Analytics",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "ams-analytics-microapp.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/analysis/#",\r\n        "icon": "fa fa-area-chart fa",\r\n        "caption": "Analysis",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "analysismicroapp.0"\r\n      },\r\n      {\r\n        "href": "#/health/overview",\r\n        "icon": "ic-p-ahm",\r\n        "caption": "Asset Health Manager",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "asset-health-manager-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/asset-safety/calibration/calibration-mgmt",\r\n        "icon": "sprite-ic ic-s-cm",\r\n        "caption": "Calibration Management",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "calibration-mgmt-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/elog/dashboard/0",\r\n        "icon": "icon-elog",\r\n        "caption": "eLog",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "elog-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/ge/overview",\r\n        "icon": "icon-ge-analytics",\r\n        "caption": "GE Analytics",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "ge-analytics-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/rounds/dashboard/user",\r\n        "icon": "icon-rounds-new",\r\n        "caption": "Rounds Data Collection",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "rounds-data-collection-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/rounds/dashboard/admin",\r\n        "icon": "icon-route-designer-new",\r\n        "caption": "Rounds Designer",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "rounds-designer-microapp.0"\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    "name": "Reliability",\r\n    "caption": "Reliability",\r\n    "icon": "icon-strategy-nav",\r\n    "id": "reliabilityfolder.0",\r\n    "orderUnderParent": 1,\r\n    "apps": [\r\n      {\r\n        "href": "#/cognitive/overview",\r\n        "icon": "icon-cognitive-analytics",\r\n        "caption": "Cognitive Analytics",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "cognitive-analytics-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/gaa/dashboard/0",\r\n        "icon": "icon-gaa-module",\r\n        "caption": "Generation Availability Analysis",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "general-avail-analysis-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/gaa-wind/dashboard/0",\r\n        "icon": "icon-gaa-wind",\r\n        "caption": "Generation Availability Analysis Wind",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "gaa-wind-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/failure-elimination/pla/dashboard/0",\r\n        "icon": "sprite-ic ic-p-pla",\r\n        "caption": "Production Loss Analysis",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "production-loss-analysis-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/reliability/dashboard/0",\r\n        "icon": "sprite-ic ic-p-ra",\r\n        "caption": "Reliability Analytics",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "reliability-analytics-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/failure-elimination/rca/dashboard/0",\r\n        "icon": "sprite-ic ic-p-rca",\r\n        "caption": "Root Cause Analysis",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "rootcause-analysis-microapp.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/apm-sm-monitor-ui/#/",\r\n        "icon": "fa fa-heartbeat",\r\n        "caption": "SmartSignal Deployments",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "ssMonitorUIMicroapp.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/ss-maintenance/#/",\r\n        "icon": "fa fa-wrench",\r\n        "caption": "SmartSignal Maintenance",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "ssMaintenanceMicroApp.0"\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    "name": "Strategy",\r\n    "caption": "Strategy",\r\n    "icon": "icon-strategy",\r\n    "id": "strategyfolder.0",\r\n    "orderUnderParent": 2,\r\n    "apps": [\r\n      {\r\n        "href": "#/asi/overview",\r\n        "icon": "sprite-ic ic-s-asi",\r\n        "caption": "Asset Strategy Implementation",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "asset-strategy-implementation-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/strategy/overview",\r\n        "icon": "sprite-ic ic-s-asm",\r\n        "caption": "Asset Strategy Management",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "asset-strategy-management-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/fmea/overview",\r\n        "icon": "sprite-ic ic-r-rca",\r\n        "caption": "Failure Modes and Effects Analysis",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "fmea-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/lcc/dashboard/0",\r\n        "icon": "icon-lcc",\r\n        "caption": "Life Cycle Cost Analysis",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "lcc-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/rcm/overview",\r\n        "icon": "sprite-ic ic-r-rcm",\r\n        "caption": "Reliability Centered Maintenance",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "rcm-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/aca",\r\n        "icon": "sprite-ic ic-r-aca",\r\n        "caption": "Asset Criticality Analysis",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "acamicroapp.0"\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    "name": "Integrity",\r\n    "caption": "Integrity",\r\n    "icon": "icon-plus",\r\n    "id": "integrityfolder.0",\r\n    "orderUnderParent": 3,\r\n    "apps": [\r\n      {\r\n        "href": "#/cm/overview",\r\n        "icon": "icon-compliance",\r\n        "caption": "Compliance Management",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "compliance-mgmt-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/asset-safety/hazards/overview",\r\n        "icon": "sprite-ic ic-r-ha",\r\n        "caption": "Hazards Analysis",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "hazards-analysis-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/im/offline/overview",\r\n        "icon": "icon-inspection-field-data-collection",\r\n        "caption": "Inspection Field Data Collection",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "inspection-field-data-collection-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/im/functionallocation/0/overview",\r\n        "icon": "sprite-ic ic-s-im",\r\n        "caption": "Inspection Management",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "inspection-mgmt-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/asset-safety/lopa/overview",\r\n        "icon": "icon-lopa",\r\n        "caption": "Layers of Protection Analysis",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "layers-protection-analysis-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/asset-safety/moc/overview",\r\n        "icon": "icon-moc",\r\n        "caption": "Management of Change",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "moc-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/asset-safety/sis/overview/offline",\r\n        "icon": "icon-proof-test",\r\n        "caption": "Mobile Proof Test",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "mobile-proof-test-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/rbi/unit",\r\n        "icon": "sprite-ic ic-r-rbi",\r\n        "caption": "Risk Based Inspection",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "rbimicroapp.0"\r\n      },\r\n      {\r\n        "href": "#/asset-safety/sis/overview",\r\n        "icon": "sprite-ic ic-r-sism",\r\n        "caption": "SIS Management",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "sis-mgmt-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/tm/unit",\r\n        "icon": "sprite-ic ic-s-tm",\r\n        "caption": "Thickness Monitoring",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "thickness-monitoring-microapp.0"\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    "name": "OPM",\r\n    "caption": "OPM",\r\n    "icon": "icon-tools",\r\n    "id": "OPMFolder.0",\r\n    "orderUnderParent": 4,\r\n    "apps": [\r\n      {\r\n        "href": "",\r\n        "icon": "icon-strategy-nav",\r\n        "caption": "Intelligence",\r\n        "subApps": [\r\n          {\r\n            "href": "#app-hub/alarms/#",\r\n            "icon": "icon-alert-small",\r\n            "caption": "KPI Alerts",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "alarmsmicroapp.0"\r\n          },\r\n          {\r\n            "href": "#app-hub/dashboards/#",\r\n            "icon": "icon-predix-dashboards",\r\n            "caption": "KPI Dashboards",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "dashboardmicroapp.0"\r\n          },\r\n          {\r\n            "href": "#app-hub/analysis/#",\r\n            "icon": "icon-predix-analysis",\r\n            "caption": "KPI Analysis",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "analysismicroapp.0"\r\n          },\r\n          {\r\n            "href": "#app-hub/analysis/#",\r\n            "icon": "icon-predix-analysis",\r\n            "caption": "KPI Benchmarking",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "analysismicroapp.0"\r\n          },\r\n          {\r\n            "href": "#access-denied",\r\n            "icon": "sprite-ic ic-t-que",\r\n            "caption": "Process Troubleshooter",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "analysismicroapp.0"\r\n          },\r\n          {\r\n            "href": "#app-hub/dashboards/#",\r\n            "icon": "icon-predix-dashboards",\r\n            "caption": "Control Loop Performance (GE Dashboards)",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "dashboardmicroapp.0"\r\n          },\r\n          {\r\n            "href": "#app-hub/cases/#/unclaimed",\r\n            "icon": "icon-predix-cases",\r\n            "caption": "Case Collaboration",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "casesmicroapp.0"\r\n          },\r\n          {\r\n            "href": "#/action-management",\r\n            "icon": "icon-recommendation-manager",\r\n            "caption": "Action Management",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "recommendation-management-microapp.0"\r\n          }\r\n        ],\r\n        "orderUnderParent": 0,\r\n        "id": "intelligence.0"\r\n      },\r\n      {\r\n        "href": "",\r\n        "icon": "icon-strategy",\r\n        "caption": "Forecast",\r\n        "subApps": [\r\n          {\r\n            "href": "#app-hub/caf/#/",\r\n            "icon": "icon-predix-analytics",\r\n            "caption": "Process Digital Twins",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "analyticsmicroapp.0"\r\n          },\r\n          {\r\n            "href": "#app-hub/alarms/#",\r\n            "icon": "icon-alert-small",\r\n            "caption": "Predictive KPI Alerts",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "alarmsmicroapp.0"\r\n          },\r\n          {\r\n            "href": "#app-hub/dashboards/#",\r\n            "icon": "icon-predix-dashboards",\r\n            "caption": "Forecasting KPI Dashboards",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "dashboardmicroapp.0"\r\n          },\r\n          {\r\n            "href": "#app-hub/analysis/#",\r\n            "icon": "icon-predix-analysis",\r\n            "caption": "Forecasting KPI Analysis",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "analysismicroapp.0"\r\n          },\r\n          {\r\n            "href": "#app-hub/analysis/#",\r\n            "icon": "icon-predix-analysis",\r\n            "caption": "What-If KPI Analysis",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "analysismicroapp.0"\r\n          }\r\n        ],\r\n        "orderUnderParent": 0,\r\n        "id": "forecast.0"\r\n      },\r\n      {\r\n        "href": "",\r\n        "icon": "icon-plus",\r\n        "caption": "Optimize",\r\n        "subApps": [\r\n          {\r\n            "href": "#app-hub/caf/#/",\r\n            "icon": "icon-predix-analytics",\r\n            "caption": "Decision Support Optimizers",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "analyticsmicroapp.0"\r\n          },\r\n          {\r\n            "href": "#app-hub/caf/#/",\r\n            "icon": "icon-predix-analytics",\r\n            "caption": "Closed Loop Control Optimizers",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "analyticsmicroapp.0"\r\n          }\r\n        ],\r\n        "orderUnderParent": 0,\r\n        "id": "optimize.0"\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    "name": "Tools",\r\n    "caption": "Tools",\r\n    "icon": "icon-tools",\r\n    "id": "toolsfolder.0",\r\n    "orderUnderParent": 4,\r\n    "apps": [\r\n      {\r\n        "href": "#/catalog",\r\n        "icon": "sprite-ic ic-t-cat",\r\n        "caption": "Catalog",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "catalog-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/connect-data-import",\r\n        "icon": "icon-data-loaders",\r\n        "caption": "Data Loaders",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "data-loaders-microapp.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/hmidesigner/#/mimic-management",\r\n        "icon": "fa fa-desktop",\r\n        "caption": "HMI Designer",\r\n        "subApps": [\r\n          {\r\n            "href": "#app-hub/hmidesigner/#/mimic-management",\r\n            "icon": "fa fa-paint-brush",\r\n            "caption": "Mimic Management",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "mimic+alarms-app.0"\r\n          }\r\n        ],\r\n        "orderUnderParent": 0,\r\n        "id": "hmidesigner-app.0"\r\n      },\r\n      {\r\n        "href": "#/graph",\r\n        "icon": "sprite-ic ic-t-gra",\r\n        "caption": "Graphs",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "graphs-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/metrics/home",\r\n        "icon": "sprite-ic ic-p-mas",\r\n        "caption": "Metrics and Scorecards",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "metrics-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/policy/overview",\r\n        "icon": "icon-policy-new",\r\n        "caption": "Policy Designer",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "policy-manager-microapp.0"\r\n      },\r\n      {\r\n        "href": "#/query",\r\n        "icon": "sprite-ic ic-t-que",\r\n        "caption": "Queries",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "queries-microapp.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/caf/#/",\r\n        "icon": "icon-predix-analytics",\r\n        "caption": "Analytics",\r\n        "subApps": [\r\n          {\r\n            "href": "#app-hub/caf/#/analytics",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Analytics Templates",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "analyticsmicroapp.0.0"\r\n          },\r\n          {\r\n            "href": "#app-hub/caf/#/orchestration",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Orchestrations",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "analyticsmicroapp.0.1"\r\n          },\r\n          {\r\n            "href": "#app-hub/caf/#/deployment",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Deployments",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "analyticsmicroapp.0.2"\r\n          },\r\n          {\r\n            "href": "#app-hub/caf/#/analyticApplicability",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Asset Filters",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "analyticsmicroapp.0.3"\r\n          },\r\n          {\r\n            "href": "#app-hub/caf/#/assetFiltersConfig",\r\n            "icon": "sprite-ic ic-s-asm",\r\n            "caption": "Configurations",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "analyticsmicroapp.0.4"\r\n          }\r\n        ],\r\n        "orderUnderParent": 0,\r\n        "id": "analyticsmicroapp.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/alerttemplates/#/alerts",\r\n        "icon": "fa fa-file-text",\r\n        "caption": "Alert Templates",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "alerttemplatesmicroapp.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/casetemplates/#/cases",\r\n        "icon": "fa fa-file-text",\r\n        "caption": "Case Templates",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "casetemplatesmicroapp.0"\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    "name": "Admin",\r\n    "caption": "Admin",\r\n    "icon": "icon-user-nav ic-nav",\r\n    "id": "administration.0",\r\n    "orderUnderParent": 5,\r\n    "apps": [\r\n      {\r\n        "href": "#/admin-menu/application-settings",\r\n        "icon": "sprite-ic ic-a-smfc",\r\n        "caption": "Application Settings",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "application-settings.0"\r\n      },\r\n      {\r\n        "href": "#/admin-menu/data-configuration",\r\n        "icon": "sprite-ic ic-a-cm",\r\n        "caption": "Configuration Manager",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "configuration-manager.0"\r\n      },\r\n      {\r\n        "href": "#/admin-menu/operations-manager",\r\n        "icon": "sprite-ic ic-a-om",\r\n        "caption": "Operations Manager",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "operations-manager.0"\r\n      },\r\n      {\r\n        "href": "",\r\n        "icon": "icon-predix-admin",\r\n        "caption": "Predix Administrator",\r\n        "subApps": [\r\n          {\r\n            "href": "#app-hub/audit/#/auditlog",\r\n            "icon": "fa fa-table",\r\n            "caption": "Audit Logs",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "auditlog.0"\r\n          },\r\n          {\r\n            "href": "#app-hub/admin/#/users",\r\n            "icon": "fa fa-table",\r\n            "caption": "Users",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "usermanagement.0.0"\r\n          },\r\n          {\r\n            "href": "#app-hub/preferences/#/tenant",\r\n            "icon": "fa fa-cog",\r\n            "caption": "Tenant Preferences",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "preferencesMicroApp.0"\r\n          },\r\n          {\r\n            "href": "#app-hub/admin/#/groups",\r\n            "icon": "fa fa-cog",\r\n            "caption": "User Groups",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "usermanagement.0.2"\r\n          },\r\n          {\r\n            "href": "#app-hub/admin/#/permission-sets",\r\n            "icon": "fa fa-cog",\r\n            "caption": "Permission Sets",\r\n            "subApps": [],\r\n            "orderUnderParent": 0,\r\n            "id": "usermanagement.0.1"\r\n          }\r\n        ],\r\n        "orderUnderParent": 0,\r\n        "id": "Predix Administrator"\r\n      },\r\n      {\r\n        "href": "#app-hub/tenantsetup/#/",\r\n        "icon": "fa fa-cogs",\r\n        "caption": "Setup",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "tenantsetup.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/unitsofconversion/#/",\r\n        "icon": "fa fa-cog",\r\n        "caption": "Units of Measure Conversions",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "unitsofConversion.0"\r\n      },\r\n      {\r\n        "href": "#app-hub/preferences/#/user",\r\n        "icon": "icon-predix-user-preferences",\r\n        "caption": "User Preferences",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "userpreference"\r\n      },\r\n      {\r\n        "href": "#app-hub/user",\r\n        "icon": "icon-predix-user-profile-icon",\r\n        "caption": "User Profile",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "userprofile"\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    "name": "Apps",\r\n    "caption": "Apps",\r\n    "icon": "icon-left-nav-apps ic-nav",\r\n    "id": "appsfolder.0",\r\n    "orderUnderParent": 6,\r\n    "apps": [\r\n      {\r\n        "href": "#app-hub/dataingestion/#",\r\n        "icon": "fa fa-exchange",\r\n        "caption": "Asset Ingestion",\r\n        "subApps": [],\r\n        "orderUnderParent": 0,\r\n        "id": "dataIngestion.0"\r\n      }\r\n    ]\r\n  }\r\n]\r\n';});

define('shell/models/custom-nav-configurations',["require","exports","text!../nav-config/configurations/apm.json","text!../nav-config/configurations/pe.json","text!../nav-config/configurations/pe-apm.json","text!../nav-config/configurations/pe-opm.json","text!../nav-config/configurations/pe-apm-opm.json"],function(require,exports){"use strict";var a=require("text!../nav-config/configurations/apm.json"),b=require("text!../nav-config/configurations/pe.json"),c=require("text!../nav-config/configurations/pe-apm.json"),d=require("text!../nav-config/configurations/pe-apm-opm.json"),e=require("text!../nav-config/configurations/pe-opm.json");function f(){return[{id:"apm",displayValue:"APM",config:a},{id:"pe",displayValue:"Predix Essentials",config:b},{id:"pe-apm",displayValue:"Predix Essentials & APM",config:c},{id:"pe-apm-opm",displayValue:"Predix Essentials, APM & OPM",config:d},{id:"pe-opm",displayValue:"Predix Essentials & OPM",config:e}]}exports.getCustomNavigationConfigurations=f});
define('shell/nav-config/nav-config-loader',["require","exports","../adapters/navigation-profile-adapter","../dtos/navigation-profile-dto","../models/custom-nav-configurations","ramda"],function(require,exports,a,b,c,d){"use strict";function e(e){var f=new a.NavigationProfileAdapter,g=d.find(d.propEq("id",e||""),c.getCustomNavigationConfigurations());return g?f.toModel(new b.NavigationProfileDto(g.config)):null}exports.loadNavConfig=e});

define('text!shell/views/leftnav.html',[],function () { return '<div class="left-nav-main-menu" data-bind="clickBubble: false">\r\n    <div class="left-nav-risk app-folder" data-bind="attr: { title: translate(\'RISK\') }, click: toggleMenu.bind($root, \'risk\'), css: { selected: isRiskMenuVisible }">\r\n        <i class="icon-risk ic-nav"></i>\r\n        <a class="text-style" data-bind="text: translate(\'RISK\')"></a>\r\n    </div>\r\n    <div class="left-nav-strategy app-folder" data-bind="attr: { title: translate(\'STRATEGY\') }, click: toggleMenu.bind($root, \'strategy\'), css: { selected: isStrategyMenuVisible }">\r\n        <i class="icon-strategy-nav ic-nav"></i>\r\n        <a class="text-style" data-bind="text: translate(\'STRATEGY\')"></a>\r\n    </div>\r\n    <div class="left-nav-performance app-folder" data-bind="attr: { title: translate(\'PERFORMANCE\') }, click: toggleMenu.bind($root, \'performance\'), css: { selected: isPerformanceMenuVisible }">\r\n        <i class="icon-performance ic-nav"></i>\r\n        <a class="text-style" data-bind="text: translate(\'PERFORMANCE\')"></a>\r\n    </div>\r\n    <div class="left-nav-operations app-folder" data-bind="attr: { title: translate(\'OPERATIONS\') }, click: toggleMenu.bind($root, \'operations\'), css: { selected: isOperationalToolsMenuVisible }">\r\n        <i class="icon-plus ic-nav"></i>\r\n        <a class="text-style" data-bind="text: translate(\'OPERATIONS\')"></a>\r\n    </div>\r\n    <div class="left-nav-tools app-folder" data-bind="attr: { title: translate(\'ANALYTICS\') }, click: toggleMenu.bind($root, \'analytics\'), css: { selected: isAnalyticsMenuVisible }">\r\n        <i class="icon-graph-view ic-nav"></i>\r\n        <a class="text-style" data-bind="text: translate(\'ANALYTICS\')"></a>\r\n    </div>\r\n    <div class="left-nav-tools app-folder" data-bind="attr: { title: translate(\'TOOLS\') }, click: toggleMenu.bind($root, \'tools\'), css: { selected: isToolsMenuVisible }">\r\n        <i class="icon-tools ic-nav"></i>\r\n        <a class="text-style" data-bind="text: translate(\'TOOLS\')"></a>\r\n    </div>  \r\n    <div class="left-nav-admin app-folder" data-bind="attr: { title: translate(\'ADMIN\') }, click: toggleMenu.bind($root, \'admin\'),\r\n                                                      css: { selected: isAdminMenuVisible },\r\n                                                      visible: !security.noAccess(\'ADMIN\')">\r\n        <i class="icon-user-nav fa-lg ic-nav"></i>\r\n        <a class="text-style" data-bind="text: translate(\'ADMIN\')"></a>\r\n    </div>\r\n    <div class="left-nav-signout app-folder" data-bind="attr: { title: translate(\'SIGN_OUT\') }, click: signOut">\r\n        <i class="icon-signout ic-nav"></i>\r\n        <a class="text-style" data-bind="text: translate(\'SIGN_OUT\')"></a>\r\n    </div>\r\n</div>\r\n<div class="apps-list" data-bind="visible: isRiskMenuVisible">\r\n    <div class="left-subnav">\r\n        <ul>\r\n            <li data-bind="css: { \'no-access\': security.noAccess(\'ASSET_CRITICALITY_ANALYSIS\') }">\r\n                <a href="#aca" target="tab">\r\n                    <i class="sprite-ic ic-r-aca"></i>\r\n                    <span data-bind="text: translate(\'ASSET_CRITICALITY_ANALYSIS\')"></span>\r\n                </a>\r\n            </li>\r\n            <li data-bind="css: { \'no-access\': security.noAccess(\'FAILURE_MODES_AND_EFFECTS_ANALYSIS\') }">\r\n                <a href="#fmea/overview" target="tab">\r\n                    <i class="sprite-ic ic-r-rca"></i>\r\n                    <span data-bind="text: translate(\'FAILURE_MODES_AND_EFFECTS_ANALYSIS\')"></span>\r\n                </a>\r\n            </li>\r\n            <li data-bind="css: { \'no-access\': security.noAccess(\'HAZARDS_ANALYSIS\') }">\r\n                <a href="#asset-safety/hazards/overview" target="tab">\r\n                    <i class="sprite-ic ic-r-ha"></i>\r\n                    <span data-bind="text: translate(\'HAZARDS_ANALYSIS_LEFT\')"></span>\r\n                </a>\r\n            </li>\r\n            <li data-bind="css: { \'no-access\': security.noAccess(\'LOPA\') }">\r\n                <a href="#asset-safety/lopa/overview" target="tab">\r\n                    <i class="icon-lopa"></i>\r\n                    <span data-bind="text: translate(\'LOPA\')"></span>\r\n                </a>\r\n            </li>\r\n            <li data-bind="css: { \'no-access\': security.noAccess(\'RELIABILITY_CENTERED_MAINTENANCE\') }">\r\n                <a href="#rcm/overview" target="tab">\r\n                    <i class="sprite-ic ic-r-rcm"></i>\r\n                    <span data-bind="text: translate(\'RELIABILITY_CENTERED_MAINTENANCE\')"></span>\r\n                </a>\r\n            </li>\r\n            <li data-bind="css: { \'no-access\': security.noAccess(\'RISK_BASED_INSPECTION\') }">\r\n                <a href="#rbi/unit" target="tab">\r\n                    <i class="sprite-ic ic-r-rbi"></i>\r\n                    <span data-bind="text: translate(\'RISK_BASED_INSPECTION\')"></span>\r\n                </a>\r\n            </li>        \r\n\r\n            <li data-bind="css: { \'no-access\': security.noAccess(\'SIS_MANAGEMENT\') }">\r\n                <a href="#asset-safety/sis/overview" target="tab">\r\n                    <i class="sprite-ic ic-r-sism"></i>\r\n                    <span data-bind="text: translate(\'SIS_MANAGEMENT\')"></span>\r\n                </a>\r\n            </li>  \r\n           </ul>\r\n    </div>\r\n</div>\r\n<div class="apps-list strat-list" data-bind="visible: isStrategyMenuVisible">\r\n    <div class="left-subnav">\r\n        <ul>\r\n            <li data-bind="css: { \'no-access\': security.noAccess(\'ASSET_STRATEGY_IMPLEMENTATION\') }">\r\n                <a href="#asi/overview" target="tab">\r\n                    <i class="sprite-ic ic-s-asi"></i>\r\n                    <span data-bind="text: translate(\'ASSET_STRATEGY_IMPLEMENTATION\')">Asset Strategy Implementation</span>\r\n                </a>\r\n            </li>\r\n            <li data-bind="css: { \'no-access\': security.noAccess(\'ASSET_STRATEGY_MANAGEMENT\') }">\r\n                <a href="#strategy/overview" target="tab">\r\n                    <i class="sprite-ic ic-s-asm"></i>\r\n                    <span data-bind="text: translate(\'ASSET_STRATEGY_MANAGEMENT\')"></span>\r\n                </a>\r\n            </li>\r\n            <li data-bind="css: { \'no-access\': security.noAccess(\'CALIBRATION_MANAGEMENT\') }">\r\n                <a href="#asset-safety/calibration/calibration-mgmt" target="tab">\r\n                    <i class="sprite-ic ic-s-cm"></i>\r\n                    <span data-bind="text: translate(\'CALIBRATION_MANAGEMENT\')"></span>\r\n                </a>\r\n            </li>\r\n            <li data-bind="css: { \'no-access\': security.noAccess(\'INSPECTION_MANAGEMENT\') }">\r\n                <a href="#im/offline/overview" target="tab">\r\n                    <i class="icon-inspection-field-data-collection"></i>\r\n                    <span data-bind="text: translate(\'INSPECTION_FIELD_DATA_COLLECTION\')"></span>\r\n                </a>\r\n            </li>\r\n            <li data-bind="css: { \'no-access\': security.noAccess(\'INSPECTION_MANAGEMENT\') }">\r\n                <a href="#im/functionallocation/0/overview" target="tab">\r\n                    <i class="sprite-ic ic-s-im"></i>\r\n                    <span data-bind="text: translate(\'INSPECTION_MANAGEMENT\')"></span>\r\n                </a>\r\n            </li>\r\n            <li data-bind="css: { \'no-access\': security.noAccess(\'MOBILE_PROOF_TEST_DATA_COLLECTION\') }">\r\n                <a href="#asset-safety/sis/overview/offline" target="tab">\r\n                    <i class="sprite-ic ic-r-sism"></i>\r\n                    <span data-bind="text: translate(\'MOBILE_PROOF_TEST_DATA_COLLECTION\')"></span>\r\n                </a>\r\n            </li>            \r\n            <li data-bind="css: { \'no-access\': security.noAccess(\'AC_DATA_COLLECTION\') }">\r\n                <a href="#rounds/dashboard/user" target="tab">\r\n                    <i class="icon-rounds-new"></i>\r\n                    <span data-bind="text: translate(\'AC_DATA_COLLECTION\')"></span>\r\n                </a>\r\n            </li>\r\n            <li data-bind="css: { \'no-access\': security.noAccess(\'AC_DESIGNER\') }">\r\n                <a href="#rounds/dashboard/admin" target="tab">\r\n                    <i class="icon-route-designer-new"></i>\r\n                    <span data-bind="text: translate(\'AC_DESIGNER\')"></span>\r\n                </a>\r\n            </li>            \r\n            <li data-bind="css: { \'no-access\': security.noAccess(\'THICKNESS_MONITORING\') }">\r\n                <a href="#tm/unit" target="tab">\r\n                    <i class="sprite-ic ic-s-tm"></i>\r\n                    <span data-bind="text: translate(\'THICKNESS_MONITORING\')"></span>\r\n                </a>\r\n            </li>           \r\n        </ul>\r\n    </div>\r\n</div>\r\n<div class="apps-list performance-list" data-bind="visible: isPerformanceMenuVisible">\r\n    <div class="left-subnav">\r\n        <ul>\r\n            <li data-bind="css: { \'no-access\': security.noAccess(\'AMS_ANALYTICS\') }">\r\n                <a href="#ams/overview" target="tab">\r\n                    <i class="icon-ams-analytics"></i>\r\n                    <span data-bind="text: translate(\'AMS_ANALYTICS\')"></span>\r\n                </a>\r\n            </li>\r\n            <li data-bind="css: { \'no-access\': security.noAccess(\'ASSET_HEALTH_MANAGER\') }">\r\n                <a href="#health/overview" target="tab">\r\n                    <i class="ic-p-ahm"></i>\r\n                    <span data-bind="text: translate(\'ASSET_HEALTH_MANAGER\')"></span>\r\n                </a>\r\n            </li>\r\n            <li data-bind="css: { \'no-access\': security.noAccess(\'GE_ANALYTICS\') }">\r\n                <a href="#ge/overview" target="tab">\r\n                    <i class="icon-ge-analytics"></i>\r\n                    <span data-bind="text: translate(\'GE_ANALYTICS\')"></span>\r\n                </a>\r\n            </li>\r\n            <li data-bind="css: { \'no-access\': security.noAccess(\'GENERATION_AVAILABILITY_ANALYSIS\') }">\r\n                <a href="#gaa/dashboard/0" target="tab">\r\n                    <i class="icon-gaa-module"></i>\r\n                    <span data-bind="text: translate(\'GENERATION_AVAILABILITY_ANALYSIS\')"></span>\r\n                </a>\r\n            </li>\r\n            <li data-bind="css: { \'no-access\': security.noAccess(\'GENERATION_AVAILABILITY_ANALYSIS_WIND\') }">\r\n                <a href="#gaa-wind/dashboard/0" target="tab">\r\n                    <i class="icon-gaa-wind"></i>\r\n                    <span data-bind="text: translate(\'GENERATION_AVAILABILITY_ANALYSIS_WIND\')"></span>\r\n                </a>\r\n            </li>\r\n            <li data-bind="css: { \'no-access\': security.noAccess(\'LIFE_CYCLE_COST_ANALYSIS\') }">\r\n                <a href="#lcc/dashboard/0" target="tab">\r\n                    <i class="icon-lcc"></i>\r\n                    <span data-bind="text: translate(\'LIFE_CYCLE_COST_ANALYSIS\')"></span>\r\n                </a>\r\n            </li>\r\n            <li data-bind="css: { \'no-access\': security.noAccess(\'PRODUCTION_LOSS_ANALYSIS\') }">\r\n                <a href="#failure-elimination/pla/dashboard/0" target="tab">\r\n                    <i class="sprite-ic ic-p-pla"></i>\r\n                    <span data-bind="text: translate(\'PRODUCTION_LOSS_ANALYSIS\')"></span>\r\n                </a>\r\n            </li>\r\n            <li>\r\n                <a href="#recommendation-management" target="tab">\r\n                    <i class="icon-recommendation-manager"></i>\r\n                    <span data-bind="text: translate(\'RECOMMENDATION_MANAGEMENT\')"></span>\r\n                </a>\r\n            </li>\r\n            <li data-bind="css: { \'no-access\': security.noAccess(\'RELIABILITY_ANALYTICS\') }">\r\n                <a href="#reliability/dashboard/0" target="tab">\r\n                    <i class="sprite-ic ic-p-ra"></i>\r\n                    <span data-bind="text: translate(\'RELIABILITY_ANALYTICS\')"></span>\r\n                </a>\r\n            </li>\r\n            <li data-bind="css: { \'no-access\': security.noAccess(\'ROOT_CAUSE_ANALYSIS\') }">\r\n                <a href="#failure-elimination/rca/dashboard/0" target="tab">\r\n                    <i class="sprite-ic ic-p-rca"></i>\r\n                    <span data-bind="text: translate(\'ROOT_CAUSE_ANALYSIS\')"></span>\r\n                </a>\r\n            </li>\r\n        </ul>\r\n    </div>\r\n</div>\r\n<div class="apps-list analytics-list" data-bind="visible: isAnalyticsMenuVisible">\r\n    <div class="left-subnav">\r\n        <ul>\r\n            <!--<li>\r\n                <a href="#bi/dashboard" target="tab">\r\n                    <i class="icon-bi-reports"></i>\r\n                    <span data-bind="text: translate(\'BI_REPORTS\')"></span>\r\n                </a>\r\n            </li>-->\r\n            <li data-bind="css: { \'no-access\': security.noAccess(\'COGNITIVE_ANALYTICS\') }">\r\n                <a href="#cognitive/overview" target="tab">\r\n                    <i class="icon-cognitive-analytics"></i>\r\n                    <span data-bind="text: translate(\'COGNITIVE_ANALYTICS\')"></span>\r\n                </a>\r\n            </li>\r\n            <li>\r\n                <a href="#dashboard" target="tab">\r\n                    <i class="ic-dashboard"></i>\r\n                    <span data-bind="text: translate(\'DASHBOARDS\')"></span>\r\n                </a>\r\n            </li>\r\n            <li>\r\n                <a href="#graph" target="tab">\r\n                    <i class="sprite-ic ic-t-gra"></i>\r\n                    <span data-bind="text: translate(\'GRAPHS\')"></span>\r\n                </a>\r\n            </li>\r\n            <li data-bind="css: { \'no-access\': security.noAccess(\'METRICS_AND_SCORECARDS\') }">\r\n                <a href="#metrics/home" target="tab">\r\n                    <i class="sprite-ic ic-p-mas"></i>\r\n                    <span data-bind="text: translate(\'METRICS_AND_SCORECARDS\')"></span>\r\n                </a>\r\n            </li>\r\n            <li>\r\n                <a href="#ssrs" target="tab">\r\n                    <i class="sprite-ic ic-t-rep"></i>\r\n                    <span data-bind="text: translate(\'REPORTS\')"></span>\r\n                </a>\r\n            </li>\r\n            <!--<li data-bind="css: { \'no-access\': security.noAccess(\'DATA_HUB\') }">\r\n                <a href="#data-hub/overview" target="tab">\r\n                    <i class="icon-data-hub"></i>\r\n                    <span data-bind="text: translate(\'DATA_HUB\')"></span>\r\n                </a>\r\n            </li>-->          \r\n        </ul>\r\n    </div>\r\n</div>\r\n<div class="apps-list tools-list" data-bind="visible: isToolsMenuVisible">\r\n    <div class="left-subnav">\r\n        <ul>\r\n            <li>\r\n                <a href="#advsearch" target="tab">\r\n                    <i class="sprite-ic icon-advanced-search"></i>\r\n                    <span data-bind="text: translate(\'ADVANCED_SEARCH\')"></span>\r\n                </a>\r\n            </li>\r\n            <li>\r\n                <a href="#catalog" target="tab">\r\n                    <i class="sprite-ic ic-t-cat"></i>\r\n                    <span data-bind="text: translate(\'CATALOG\')"></span>\r\n                </a>\r\n            </li>\r\n            <li data-bind="css: { \'no-access\': security.noAccess(\'DATA_LOADERS\') }">\r\n                <a href="#connect-data-import" target="tab">\r\n                    <i class="icon-data-loaders"></i>\r\n                    <span data-bind="text: translate(\'DATA_LOADERS\')"></span>\r\n                </a>\r\n            </li>\r\n            <li data-bind="css: { \'no-access\': security.noAccess(\'DATA_EXTRACTORS\') }">\r\n                <a href="#extractions/logs" target="tab">\r\n                    <i class="icon-data-loaders"></i>\r\n                    <span data-bind="text: translate(\'DATA_EXTRACTORS\')"></span>\r\n                </a>\r\n            </li>\r\n            <li data-bind="css: { \'no-access\': security.noAccess(\'DATASETS\') }">\r\n                <a href="#dataset/overview" target="tab">\r\n                    <i class="sprite-ic ic-t-dat"></i>\r\n                    <span data-bind="text: translate(\'DATASETS\')"></span>\r\n                </a>\r\n            </li>\r\n            <li>\r\n                <a href="#log" target="tab">\r\n                    <i class="sprite-ic ic-t-err"></i>\r\n                    <span data-bind="text: translate(\'ERRORS\')"></span>\r\n                </a>\r\n            </li>\r\n            <li>\r\n                <a href="#" data-bind="click: hyperlinkUtility">\r\n                    <i class="icons-hyperlink-utility-icon"></i>\r\n                    <span data-bind="text: translate(\'HYPERLINK_UTILITY\')"></span>\r\n                </a>\r\n            </li>\r\n            <li>\r\n                <a href="#maps" target="tab">\r\n                    <i class="icon-map-module"></i>\r\n                    <span data-bind="text: translate(\'MAPS\')"></span>\r\n                </a>\r\n            </li>\r\n            <li data-bind="css: { \'no-access\': security.noAccess(\'POLICY_MANAGER\') && security.noAccess(\'RISK_BASED_INSPECTION\') && security.noAccess(\'GENERATION_AVAILABILITY_ANALYSIS\') && security.noAccess(\'PIPELINE_MANAGEMENT\') }">\r\n                <a href="#policy/overview" target="tab">\r\n                    <i class="icon-policy-new"> </i>\r\n                    <span data-bind="text: translate(\'POLICY_MANAGER\')"></span>\r\n                </a>\r\n            </li>\r\n            <li>\r\n                <a href="#query" target="tab">\r\n                    <i class="sprite-ic ic-t-que"></i>\r\n                    <span data-bind="text: translate(\'QUERIES\')"></span>\r\n                </a>\r\n            </li>         \r\n            <li data-bind="css: { \'no-access\': security.noAccess(\'R_SCRIPTS\')}">\r\n                <a href="#rscript" target="tab">\r\n                    <i class="icon-r-node"></i>\r\n                    <span data-bind="text: translate(\'R_SCRIPTS\')"></span>\r\n                </a>\r\n            </li>\r\n            <li>\r\n                <a href="#script" target="tab">\r\n                    <i class="icon-scripts"></i>\r\n                    <span data-bind="text: translate(\'SCRIPTS\')"></span>\r\n                </a>\r\n            </li>          \r\n        </ul>\r\n    </div>\r\n</div>\r\n\r\n<div class="apps-list admin-list" data-bind="visible: isAdminMenuVisible">\r\n    <div class="left-subnav">\r\n        <ul>\r\n            <li data-bind="css: { \'no-access\': security.noAccess(\'APPLICATION_SETTINGS\') }">\r\n                <a href="#admin-menu/application-settings" target="tab">\r\n                    <i class="sprite-ic ic-a-smfc"></i>\r\n                    <span data-bind="text: translate(\'APPLICATION_SETTINGS\')"></span>\r\n                </a>\r\n            </li>\r\n            <li data-bind="css: { \'no-access\': security.noAccess(\'CONFIGURATION_MANAGER\') }">\r\n                <a href="#admin-menu/data-configuration" target="tab">\r\n                    <i class="sprite-ic ic-a-cm"></i>\r\n                    <span data-bind="text: translate(\'CONFIGURATION_MANAGER\')"></span>\r\n                </a>\r\n            </li>\r\n            <li data-bind="css: { \'no-access\': security.noAccess(\'OPERATIONS_MANAGER\') }">\r\n                <a href="#admin-menu/operations-manager" target="tab">\r\n                    <i class="sprite-ic ic-a-om"></i>\r\n                    <span data-bind="text: translate(\'OPERATIONS_MANAGER\'), title: translate(\'OPERATIONS_MANAGER\')"></span>\r\n                </a>\r\n            </li>\r\n            <li data-bind="css: { \'no-access\': security.noAccess(\'SECURITY_MANAGER\') }">\r\n                <a href="#admin-menu/security-manager" target="tab">\r\n                    <i class="sprite-ic ic-a-sm"></i>\r\n                    <span data-bind="text: translate(\'SECURITY_MANAGER\')"></span>\r\n                </a>\r\n            </li>\r\n        </ul>\r\n    </div>\r\n</div>\r\n\r\n<div class="apps-list operation-list" data-bind="visible: isOperationalToolsMenuVisible">\r\n    <div class="left-subnav">\r\n        <ul>\r\n            <li data-bind="css: { \'no-access\': security.noAccess(\'ELOG\') }">\r\n                <a href="#elog/dashboard/0" target="tab">\r\n                    <i class="sprite-ic ic-a-smfc"></i>\r\n                    <span data-bind="text: translate(\'ELOG\')"></span>\r\n                </a>\r\n            </li>\r\n            <li data-bind="css: {\'no-access\': security.noAccess(\'MOC\') }">\r\n                <a href="#asset-safety/moc/overview" target="tab">\r\n                    <i class="sprite-ic ic-r-sism"></i>\r\n                    <span data-bind="text: translate(\'MOC\')"></span>\r\n                </a>\r\n            </li>  \r\n         </ul>\r\n    </div>\r\n</div>\r\n\r\n';});

define('system/lang/interface',['lodash'],function(){"use strict";var a=require("lodash");function b(a,b,c){this.name=a,this.methods=b||[],this.properties=c||[]}b.prototype.implementedBy=function(a){c(this,a),d(this,a)};function c(b,c){var d,e;for(d=0;d<b.methods.length;d++){if(e=b.methods[d],a.isUndefined(c[e]))throw"Missing method "+e;if(!a.isFunction(c[e]))throw e+" is not a function"}return!0}function d(b,c){var d,e;for(d=0;d<b.properties.length;d++)if(e=b.properties[d],a.isUndefined(c[e]))throw"Missing property "+e;return!0}return b});
define('security/model/i-login-strategy',['require','exports','module','system/lang/interface'],function(require,exports,module){"use strict";return new(require("system/lang/interface"))(module.id,["start","showPrompt","login","dispose","getMeridiumResource","setAjaxClientServerFromVm","changePassword"],["meridiumResourceLoaded","loginDeferred"])});
define('system/http/ajax-request',['require','lodash','system/http/ajax-client','mi-assert'],function(require){"use strict";var a=require("lodash"),b=require("system/http/ajax-client"),c=require("mi-assert");function d(a,c,d,e){this.ajaxClient=Object.resolve(b),this.method=a,this.url=c,this.data=d||null,this.options=e||null}d.get=function(a,b){return new d("get",a,null,b)},d.post=function(a,b,c){return new d("post",a,b,c)},d.put=function(a,b,c){return new d("put",a,b,c)},d.delete=function(a,b){return new d("delete",a,null,b)},d.prototype.send=function a(b){var c;if("get"===this.method)c=this.ajaxClient.get(this.url,this.options);else if("post"===this.method)c=this.ajaxClient.post(this.url,this.data,this.options);else if("put"===this.method)c=this.ajaxClient.put(this.url,this.data,this.options);else{if("delete"!==this.method)throw"Unknown request method: "+this.method;c=this.ajaxClient.delete(this.url,this.options)}return b&&c.fail(this.onFail(b)),c},d.prototype.onFail=function a(b){return c.isObject(b,"dfd"),e.bind(null,b,this)};function e(b,e,f){c.isObject(b,"dfd"),
c.instanceOf(e,d,"request"),c.isObject(f,"response"),a.isFunction(b.promise)?b.reject(e,f):b.reject({request:e,response:f})}return d});
define('system/lang/converter',['require','system/text/parser','globalize'],function(require){"use strict";var a=require("system/text/parser"),b=require("globalize");function c(){}c.prototype.toNullable=function a(b){return b?b:null},c.prototype.toObject=function a(b,c){return b?b:c},c.prototype.toString=function a(b,c){return void 0===b||null===b?void 0!==c?c:"":b.toString()},c.prototype.toNullableString=function a(b){return c.prototype.toString(b,null)},c.prototype.toBoolean=function a(b,c){return void 0!==b&&(b===c||b===!0)},c.prototype.toNullableBoolean=function a(b,c){return void 0!==c||void 0!==b&&null!==b?b===c||b===!0:null},c.prototype.toInteger=function a(b,c){var d=parseInt(b,10);return c=c||0,isNaN(d)?c:d},c.prototype.toFloat=function a(b,c){var d=parseFloat(b);return arguments.length<2&&(c=0),isNaN(d)?c:d},c.prototype.toDate=function a(b,c,e){return d(b,c,e)},c.prototype.toNullableDate=function a(b,c){return d(b,c,null)};function d(b,c,d){return c=c||"yyyy-MM-ddTHH:mm:ss.fff",d=Object.defaultValue(d,null),
null===b||void 0===b?d:b instanceof Date?b:a.parseDate(b,c)||a.parseDate(b,"yyyy-MM-ddTHH:mm:ss.fff")||d}return c.prototype.toDateString=function a(c,d){return d=d||"S",b.format(c,d)},c.prototype.toNullableInteger=function a(b){var c=parseFloat(b);return isNaN(c)?null:c},c.prototype.toNullableFloat=function a(b){return this.toFloat(b,null)},new c});
define('security/services/role-dto',['require','system/lang/converter','./user-dto','./group-dto'],function(require){"use strict";var a=require("system/lang/converter");function b(b){b=b||{},this.id=a.toString(b.id),this.key=a.toString(b.key)||"0",this.caption=a.toString(b.caption),this.description=a.toString(b.description),this.users=require("./user-dto").fromDataCollection(b.users),this.groups=require("./group-dto").fromDataCollection(b.groups)}return b.fromDataCollection=function a(c){if(void 0!==c){var d,e=[];for(d=0;d<c.length;d++)e[e.length]=new b(c[d]);return e}},b});
define('security/services/group-dto',['require','system/lang/converter','./user-dto','./role-dto'],function(require){"use strict";var a=require("system/lang/converter");function b(b){b=b||{},this.id=a.toString(b.id),this.key=a.toString(b.key)||"0",this.caption=a.toString(b.caption),this.description=a.toString(b.description),this.isActive=a.toBoolean(b.isActive),this.parentKey=a.toString(b.parentKey)||"0",this.lockSeq=a.toString(b.lockSeq)||"0",this.users=require("./user-dto").fromDataCollection(b.users),this.roles=require("./role-dto").fromDataCollection(b.roles)}return b.fromDataCollection=function a(c){if(void 0!==c){var d,e=[];for(d=0;d<c.length;d++)e[e.length]=new b(c[d]);return e}},b});
define('security/services/usersite-dto',['require','system/lang/converter'],function(require){"use strict";var a=require("system/lang/converter");function b(b){b=b||{},this.key=a.toString(b.key)||"0",this.siteKey=a.toString(b.siteKey)||"0",this.userKey=a.toString(b.userKey)||"0",this.viewOnly=a.toBoolean(b.viewOnly)||!1,this.siteName=a.toString(b.siteName),this.userName=a.toString(b.userName),this.lockSeq=a.toString(b.lockSeq)||"0"}return b.fromDataCollection=function a(c){if(c){var d,e=[];for(d=0;d<c.length;d++)e[e.length]=new b(c[d]);return e}},b});
define('security/services/fmlypriv-dto',['require','system/lang/converter'],function(require){"use strict";var a=require("system/lang/converter");function b(b){b=b||{},this.key=a.toString(b.key),this.userKey=a.toString(b.userKey),this.userDisplay=a.toString(b.userDisplay),this.groupKey=a.toString(b.groupKey),this.groupDisplay=a.toString(b.groupDisplay),this.familyKey=a.toString(b.familyKey),this.familyId=a.toString(b.familyId),this.familyDisplay=a.toString(b.familyDisplay),this.privilege=a.toInteger(b.privilege),this.ins=b.privilege===(b.privilege=1|b.privilege),this.vw=b.privilege===(b.privilege=2|b.privilege),this.upd=b.privilege===(b.privilege=4|b.privilege),this.del=b.privilege===(b.privilege=8|b.privilege),this.hash=this.ins+this.vw+this.upd+this.del,this.isDirty=!1,this.isDeleted=!1}return b.fromDataCollection=function a(c){if(void 0!==c){var d,e=[];for(d=0;d<c.length;d++)e[e.length]=new b(c[d]);return e}},b});
define('security/services/user-dto',['require','./group-dto','./usersite-dto','./role-dto','./fmlypriv-dto','system/lang/converter'],function(require){"use strict";var a=require("./group-dto"),b=require("./usersite-dto"),c=require("./role-dto"),d=require("./fmlypriv-dto"),e=require("system/lang/converter");function f(f){f=f||{};var g=f.formats||{};this.key=e.toString(f.key),this.id=e.toString(f.id),this.lastName=e.toString(f.lastName),this.firstName=e.toString(f.firstName),this.initial=e.toString(f.initial),this.displayName=this.lastName+", "+this.firstName+" "+this.initial,this.fullDisplayName=this.lastName+", "+this.firstName+" ("+this.id+")",this.contentGuid=e.toString(f.contentGuid),this.cultureId=e.toString(f.cultureId),this.timezoneId=e.toString(f.timezoneId),this.ianaTimezoneId=e.toString(f.timezoneIanaId),this.defaultSiteKey=void 0===f.defaultSiteKey?"0":e.toString(f.defaultSiteKey),this.queryPrivilege=e.toString(f.queryPrivilege),this.isActive=e.toBoolean(f.isActive),this.isSuperUser=e.toBoolean(f.isSuperUser),this.isCatalogAdmin=e.toBoolean(f.isCatalogAdmin),
this.isConfigAdmin=e.toBoolean(f.isConfigAdmin),this.isPowerUser=e.toBoolean(f.isPowerUser),this.isSecurityAdmin=e.toBoolean(f.isSecurityAdmin),this.daysLeft=e.toString(f.daysLeft),this.address1=e.toString(f.address1),this.address2=e.toString(f.address2),this.areaOfResponsibility=e.toString(f.areaOfResponsibility),this.badgeId=e.toString(f.badgeId),this.businessUnit=e.toString(f.businessUnit),this.city=e.toString(f.city),this.comments=e.toString(f.comments),this.company=e.toString(f.company),this.country=e.toString(f.country),this.department=e.toString(f.department),this.domain=e.toString(f.domain),this.email=e.toString(f.email),this.facility=e.toString(f.facility),this.faxNumber=e.toString(f.faxNumber),this.siteCode=e.toString(f.siteCode),this.formats={longDate:g.longDate||"D",shortDate:g.shortDate||"d",longTime:g.longTime||"T",shortTime:g.shortTime||"t",dateTime:g.dateTime||"dt"},this.groups=a.fromDataCollection(f.groups),this.sites=b.fromDataCollection(f.sites),
this.roles=c.fromDataCollection(f.roles),this.privileges=d.fromDataCollection(f.privileges),this.newPassword=e.toString(f.newPassword),this.unhashedPassword=e.toString(f.unhashedPassword),this.password=e.toString(f.password),this.phoneNumber=e.toString(f.phoneNumber),this.phoneNumber2=e.toString(f.phoneNumber2),this.postalCode=e.toString(f.postalCode),this.state=e.toString(f.state),this.title=e.toString(f.title),this.uomConversionSetId=e.toString(f.uomConversionSetId),this.hasThumbnailPhoto=e.toBoolean(f.hasThumbnailPhoto),this.mustChangePassword=e.toBoolean(f.mustChangePassword),this.isLocked=e.toBoolean(f.isLocked),this.failedLogins=e.toString(f.failedLogins),this.userLockSeq=e.toString(f.userLockSeq),this.hrLockSeq=e.toString(f.hrLockSeq),this.isSelected=!1,this.isDirty=!1}return f.fromDataCollection=function a(b){if(b){var c,d=[];for(c=0;c<b.length;c++)d[d.length]=new f(b[c]);return d}},f});
define('security/services/systemcode-dto',[],function(){"use strict";function a(a){this.description=void 0===a?"":void 0===a.description?"":a.description,this.caption=void 0===a?"":void 0===a.caption?"":a.caption,this.isDefault=void 0===a?"":void 0===a.isDefault?"":a.isDefault,this.value=void 0===a?"":void 0===a.value?"":a.value}return a.fromDataCollection=function b(c){var d,e=[];for(d=0;d<c.length;d++)e[e.length]=new a(c[d]);return e},a});
define('security/services/uomconversionset-dto',[],function(){"use strict";function a(a){this.description=void 0===a?"":void 0===a.description?"":a.description,this.id=void 0===a?"":void 0===a.id?"":a.id,this.key=void 0===a?"":void 0===a.key?"":a.key}return a.fromDataCollection=function b(c){var d,e=[];for(d=0;d<c.length;d++)e[e.length]=new a(c[d]);return e},a});
define('security/services/session-dto',[],function(){"use strict";function a(a,b){this.datasourceId=a.datasourceId||"",this.cultureId=a.cultureId||"",this.userKey=a.userKey||"",this.id=a.sessionId,this.userId=a.userId,this.apiServer=b,this.licensedCultureId=a.licensedCultureId,this.sessionTimeout=a.sessionTimeout,this.userSites=a.userSites,this.mustChangePassword=a.mustChangePassword,this.isLicenseExpired=a.isLicenseExpired,this.lockoutAttempts=a.lockoutAttempts,this.lockoutTimeout=a.lockoutTimeout}return a});
define('security/services/culture-dto',[],function(){"use strict";function a(a){this.name=void 0===a?"":void 0===a.name?"":a.name,this.id=void 0===a?"":void 0===a.id?"":a.id}return a.fromDataCollection=function b(c){var d,e=[];for(d=0;d<c.length;d++)e[e.length]=new a(c[d]);return e},a});
define('security/services/timezone-dto',[],function(){"use strict";function a(a){this.name=void 0===a?"":void 0===a.name?"":a.name,this.id=void 0===a?"":void 0===a.id?"":a.id,this.supportsDST=a&&a.supportsDST}return a.fromDataCollection=function b(c){var d,e=[];for(d=0;d<c.length;d++)e[e.length]=new a(c[d]);return e},a});
define('security/services/appconfig-dto',['require','system/lang/converter'],function(require){"use strict";var a=require("system/lang/converter");function b(b){b=b||{},this.key=a.toString(b.key),this.configType=a.toString(b.configType),this.name=a.toString(b.name),this.description=a.toString(b.description),this.value=a.toString(b.value),this.itemType=a.toString(b.itemType),this.defaultValue=a.toString(b.defaultValue),this.minValue=a.toString(b.minValue),this.maxValue=a.toString(b.maxValue),this.unitOfMeasure=a.toString(b.unitOfMeasure)}return b.fromDataCollection=function a(c){if(void 0!==c){var d,e=[];for(d=0;d<c.length;d++)e[e.length]=new b(c[d]);return e}},b});
define('security/services/entityfamily-dto',['require','system/lang/converter'],function(require){"use strict";var a=require("system/lang/converter");function b(b){b=b||{},this.id=a.toString(b.id),this.description=a.toString(b.description),this.defaultCaption=a.toString(b.defaultCaption),this.databaseTableName=a.toString(b.databaseTableName),this.caption=a.toString(b.caption),this.description=a.toString(b.description),this.isBaselineFamily=a.toString(b.isBaselineFamily),this.isRuleLock=a.toString(b.isRuleLock),this.isSystemFamily=a.toString(b.isSystemFamily),this.key=a.toString(b.key),this.parentKey=a.toString(b.parentKey),this.updateDate=a.toString(b.updateDate),this.updateUser=a.toString(b.updateUser),this.status=a.toString(b.status),this.securityPrivileges=a.toString(b.securityPrivileges),this.redirectionUrl=a.toString(b.redirectionUrl),this.useUrlRedirection=a.toString(b.useUrlRedirection),this.isauditable=a.toString(b.isauditable)}return b.fromDataCollection=function a(c){var d,e=[];for(d=0;d<c.length;d++)e[e.length]=new b(c[d]);return e},b});
define('security/services/family-dto',['require','system/lang/converter'],function(require){"use strict";var a=require("system/lang/converter");function b(b){b=b||{},this.id=a.toString(b.id),this.description=a.toString(b.description),this.defaultCaption=a.toString(b.defaultCaption),this.databaseTableName=a.toString(b.databaseTableName),this.caption=a.toString(b.caption),this.description=a.toString(b.description),this.isBaselineFamily=a.toString(b.isBaselineFamily),this.isRuleLock=a.toString(b.isRuleLock),this.isSystemFamily=a.toString(b.isSystemFamily),this.key=a.toString(b.key),this.parentKey=a.toString(b.parentKey),this.updateDate=a.toString(b.updateDate),this.updateUser=a.toString(b.updateUser),this.status=a.toString(b.status),this.securityPrivileges=a.toString(b.securityPrivileges),this.redirectionUrl=a.toString(b.redirectionUrl),this.useUrlRedirection=a.toString(b.useUrlRedirection),this.isauditable=a.toString(b.isauditable)}return b.fromDataCollection=function a(c){var d,e=[];for(d=0;d<c.length;d++)e[e.length]=new b(c[d]);return e},b});
define('system/collections/key-id-list',['require','lodash'],function(require){"use strict";var a=require("lodash");function b(a){this.items=a}return b.prototype.findByKey=function(b){return a.find(this.items,{key:b})||null},b.prototype.findById=function(b){return a.find(this.items,{id:b})||null},b});
define('security/services/ldap-settings-dto',['require','system/lang/converter'],function(require){"use strict";var a=require("system/lang/converter");function b(b){b=b||{},this.enableLdapIntegration=a.toBoolean(b.enableLDAPIntegration),this.createUsersWithoutDomain=a.toBoolean(b.createUsersWithoutDomain),this.enableInterfaceLog=a.toBoolean(b.enableInterfaceLog),this.enableInformationalMessage=a.toBoolean(b.enableInformationalMessage),this.enableAPMSecurity=a.toBoolean(b.enableAPMSecurity),this.enablePasswordChange=a.toBoolean(b.enablePasswordChange),this.enableEmailNotification=a.toBoolean(b.enableEmailNotification.emailNotification),this.userGroupList=b.enableEmailNotification.userGroupList}return b.fromDataCollection=function a(c){if(void 0!==c){var d,e=[];for(d=0;d<c.length;d++)e[e.length]=new b(c[d]);return e}},b});
define('security/services/site-dto',['require','./usersite-dto','system/lang/converter'],function(require){"use strict";var a=require("./usersite-dto"),b=require("system/lang/converter");function c(c){c=c||{},this.name=b.toString(c.name),this.key=b.toString(c.key)||"0",this.lockSeq=b.toString(c.lockSeq),this.users=a.fromDataCollection(c.users)}return c.fromDataCollection=function a(b){if(b){var d,e=[];for(d=0;d<b.length;d++)e[e.length]=new c(b[d]);return e}},c});
define('security/services/ldap-property-dto',['require','system/lang/converter'],function(require){"use strict";var a=require("system/lang/converter");function b(b){b=b||{},this.key=a.toString(b.key)||"0",this.ldapName=a.toString(b.ldapName),this.apmName=a.toString(b.apmName)}return b.fromDataCollection=function a(c){if(void 0!==c){var d,e=[];for(d=0;d<c.length;d++)e[e.length]=new b(c[d]);return e}},b});
define('security/services/domain-user-dto',['require','system/lang/converter'],function(require){"use strict";var a=require("system/lang/converter");function b(b){b=b||{},this.key=a.toString(b.key)||"0",this.id=a.toString(b.id),this.firstName=a.toString(b.firstName),this.lastName=a.toString(b.lastName)}return b.fromDataCollection=function a(c){if(void 0!==c){var d,e=[];for(d=0;d<c.length;d++)e[e.length]=new b(c[d]);return e}},b});
define('security/services/domain-dto',['require','system/lang/converter','./ldap-property-dto','./domain-user-dto'],function(require){"use strict";var a=require("system/lang/converter");function b(b){b=b||{},this.key=a.toString(b.key)||"0",this.allUserFilter=a.toString(b.allUserFilter),this.singleUserFilter=a.toString(b.singleUserFilter),this.domainName=a.toString(b.domainName),this.rootCaption=a.toString(b.rootCaption),this.domainNetBiosName=a.toString(b.domainNetBiosName),this.domainCaption=a.toString(b.domainCaption),this.domainGroupFilter=a.toString(b.domainGroupFilter),this.lockSeq=a.toString(b.lockSeq),this.defaultMappedSite=a.toString(b.defaultMappedSite),this.propertyMappings=require("./ldap-property-dto").fromDataCollection(b.propertyMappings),this.users=require("./domain-user-dto").fromDataCollection(b.users)}return b.fromDataCollection=function a(c){if(void 0!==c){var d,e=[];for(d=0;d<c.length;d++)e[e.length]=new b(c[d]);return e}},b});
define('security/services/cross-domain-dto',[],function(){"use strict";function a(a){a=a||{},this.name=a.name||"",this.userName=a.userName||"",this.password=a.password||"",this.type=a.type}return a.fromDataCollection=function b(c){var d,e=[];for(d=0;d<c.length;d++)e[e.length]=new a(c[d]);return e},a});
define('security/services/security-service',['require','jquery','system/http/ajax-client','system/http/ajax-request','./user-dto','./group-dto','./role-dto','./systemcode-dto','./uomconversionset-dto','./session-dto','./culture-dto','./timezone-dto','./appconfig-dto','./entityfamily-dto','./family-dto','./fmlypriv-dto','system/collections/key-id-list','./ldap-settings-dto','./site-dto','./usersite-dto','./domain-dto','./cross-domain-dto','system/hardware/device'],function(require){"use strict"
;var a=require("jquery"),b=require("system/http/ajax-client"),c=require("system/http/ajax-request"),d=require("./user-dto"),e=require("./group-dto"),f=require("./role-dto"),g=require("./systemcode-dto"),h=require("./uomconversionset-dto"),i=require("./session-dto"),j=require("./culture-dto"),k=require("./timezone-dto"),l=require("./appconfig-dto"),m=require("./entityfamily-dto"),n=require("./family-dto"),o=require("./fmlypriv-dto"),p=require("system/collections/key-id-list"),q="api/core/security",r="api/core/appconfig",s="api/core/security/priv",t="api/core/uom",u="api/core/globalization",v="api/core/metadata",w="api/core/systemcode",x=require("./ldap-settings-dto"),y="api/core/preference/",z=require("./site-dto"),A=require("./usersite-dto"),B="api/core/license/modules",C="api/scheduling/ldap",D="api/core/security/hostingEnv",E=require("./domain-dto"),F=require("./cross-domain-dto"),G="api/core/security/crossdomain",H=require("system/hardware/device");function I(a){this.ajaxClient=a}
I.dependsOn=[b],I.prototype.url=function(a){return this.ajaxClient.url(q+a)},I.prototype.login=function(c,d,e){var f=a.Deferred();return this.ajaxClient.post(q+J(),{DatasourceId:c,Id:d,Password:e}).done(function(a){f.resolve(new i(a,b.server()))}).fail(function(a){f.reject(a)}),f.promise()};function J(){var a=new H,b="/browserlogin";return a.isIOS()&&(b="/login"),b}I.prototype.getSession=function(){var c=a.Deferred();return this.ajaxClient.get("api/core/security/session").done(function(a){c.resolve(new i(a,b.server()))}).fail(function(a){c.reject(a)}),c.promise()},I.prototype.ssologin=function(b){var c=a.Deferred();return this.ajaxClient.get(q+"/ssologin/?url="+b).done(function(a){c.resolve(a)}).fail(function(a){if(a.status)if(200===a.status){var b=a.responseText.indexOf('"'),d=a.responseText.indexOf('"',b+1),e=a.responseText.substring(b+1,d);console.log(e),c.resolve(e)}else c.reject(a);else c.reject(a)}),c.promise()},I.prototype.logout=function(){var b=a.Deferred()
;return this.ajaxClient.get(q+"/logout").done(b.resolve.bind(b)).fail(b.reject.bind(b)),b.promise()},I.prototype.getUsers=function(b,c){var e=a.Deferred(),f=b?"smallObject=true":"smallObject=false",g=c?"activeOnly=true":"activeOnly=false",h="?"+f+"&"+g;return this.ajaxClient.get(q+"/user/"+h,{}).done(function(a){e.resolve(new d.fromDataCollection(a))}).fail(function(a){e.reject(a)}),e.promise()},I.prototype.getUsersPage=function(b,c,e,f){var g=a.Deferred(),h="?statusFilter="+e+"&searchValue="+encodeURIComponent(f);return this.ajaxClient.get(q+"/userpage/"+b+"/"+c+h,{}).done(function(a){g.resolve(new d.fromDataCollection(a))}).fail(function(a){g.reject(a)}),g.promise()},I.prototype.getUser=function(b){var c=a.Deferred();return this.ajaxClient.get(q+"/user/"+b,{}).done(function(a){c.resolve(new d(a))}).fail(function(a){c.reject(a)}),c.promise()},I.prototype.getHostingEnv=function(){var b=a.Deferred();return this.ajaxClient.get(D,{}).done(function(a){b.resolve(a)}).fail(function(a){
b.reject(a)}),b.promise()},I.prototype.getSessionUser=function(){var b=a.Deferred();return this.ajaxClient.get(q+"/sessionuser/",{}).done(function(a){b.resolve(new d(a))}).fail(function(a){b.reject(a)}),b.promise()},I.prototype.postUser=function(b){var c=a.Deferred();return this.ajaxClient.post(q+"/user",b).done(function(a){c.resolve(a)}).fail(function(a){c.reject(a)}),c.promise()},I.prototype.putUser=function(b){var c=a.Deferred();return this.ajaxClient.put(q+"/user",b).done(function(a){c.resolve(a)}).fail(function(a){c.reject(a)}),c.promise()},I.prototype.changePassword=function(b){var c=a.Deferred();return this.ajaxClient.post(q+"/change",b).done(function(a){c.resolve(a)}).fail(function(a){c.reject(a)}),c.promise()},I.prototype.getSystemCodes=function(b){var c=a.Deferred();return this.ajaxClient.get(w+"/code/table/?tableId="+b,{}).done(function(a){c.resolve(new g.fromDataCollection(a))}).fail(function(a){c.reject(a)}),c.promise()},I.prototype.getUomConversionSets=function(){
var b=a.Deferred();return this.ajaxClient.get(t+"/conversionset",{}).done(function(a){b.resolve(new h.fromDataCollection(a))}).fail(function(a){b.reject(a)}),b.promise()},I.prototype.getCultures=function(){var b=a.Deferred();return this.ajaxClient.get(u+"/culture",{}).done(function(a){b.resolve(new j.fromDataCollection(a))}).fail(function(a){b.reject(a)}),b.promise()},I.prototype.getTimezones=function(){var b=a.Deferred();return this.ajaxClient.get(u+"/timezone",{}).done(function(a){b.resolve(new k.fromDataCollection(a))}).fail(function(a){b.reject(a)}),b.promise()},I.prototype.getGroups=function(b,c){var d=a.Deferred(),f=b?"smallObject=true":"smallObject=false",g=c?"activeOnly=true":"activeOnly=false",h="?"+f+"&"+g;return this.ajaxClient.get(q+"/group/"+h,{}).done(function(a){d.resolve(new e.fromDataCollection(a))}).fail(function(a){d.reject(a)}),d.promise()},I.prototype.getGroupChildren=function(b){var c=a.Deferred()
;return this.ajaxClient.get(q+"/groups/children/"+b,{}).done(function(a){c.resolve(new e.fromDataCollection(a))}).fail(function(a){c.reject(a)}),c.promise()},I.prototype.getGroupParents=function(){var b=a.Deferred();return this.ajaxClient.get(q+"/groups/parents",{}).done(function(a){b.resolve(new e.fromDataCollection(a))}).fail(function(a){b.reject(a)}),b.promise()},I.prototype.getGroup=function(b){var c=a.Deferred();return this.ajaxClient.get(q+"/group/"+b,{}).done(function(a){c.resolve(new e(a))}).fail(function(a){c.reject(a)}),c.promise()},I.prototype.checkGroupPriv=function(b){var c=a.Deferred();return this.ajaxClient.get(q+"/groupPriv/"+b,{}).done(function(a){c.resolve(a)}).fail(function(a){c.reject(a)}),c.promise()},I.prototype.postGroup=function(b){var c=a.Deferred();return this.ajaxClient.post(q+"/group",b).done(function(a){c.resolve(a)}).fail(function(a){c.reject(a)}),c.promise()},I.prototype.putGroup=function(b){var c=a.Deferred()
;return this.ajaxClient.put(q+"/group",b).done(function(a){c.resolve(a)}).fail(function(a){c.reject(a)}),c.promise()},I.prototype.deleteGroup=function(b){var c=a.Deferred();return this.ajaxClient.delete(q+"/group/"+b).done(function(a){c.resolve(a)}).fail(function(a){c.reject(a)}),c.promise()},I.prototype.getRoles=function(){var b=a.Deferred();return this.ajaxClient.get(q+"/roles",{}).done(function(a){b.resolve(new f.fromDataCollection(a))}).fail(function(a){b.reject(a)}),b.promise()},I.prototype.getRole=function(b){var c=a.Deferred();return this.ajaxClient.get(q+"/role/"+b,{}).done(function(a){c.resolve(new f(a))}).fail(function(a){c.reject(a)}),c.promise()},I.prototype.postRole=function(b){var c=a.Deferred();return this.ajaxClient.post(q+"/role",b).done(function(a){c.resolve(a)}).fail(function(a){c.reject(a)}),c.promise()},I.prototype.putRole=function(b){var c=a.Deferred();return this.ajaxClient.put(q+"/role",b).done(function(a){c.resolve(a)}).fail(function(a){c.reject(a)}),
c.promise()},I.prototype.deleteRole=function(b){var c=a.Deferred();return this.ajaxClient.delete(q+"/role/"+b).done(function(a){c.resolve(a)}).fail(function(a){c.reject(a)}),c.promise()},I.prototype.getRoleUsers=function(b){var c=a.Deferred();return this.ajaxClient.get(q+"/roleuser/"+b,{}).done(function(a){c.resolve(new d.fromDataCollection(a))}).fail(function(a){c.reject(a)}),c.promise()},I.prototype.getUserRoles=function(b){var c=a.Deferred();return this.ajaxClient.get(q+"/userRole/"+b,{}).done(function(a){c.resolve(new f.fromDataCollection(a))}).fail(function(a){c.reject(a)}),c.promise()},I.prototype.getRoleGroups=function(b){var c=a.Deferred();return this.ajaxClient.get(q+"/rolegroup/"+b,{}).done(function(a){c.resolve(new e.fromDataCollection(a))}).fail(function(a){c.reject(a)}),c.promise()},I.prototype.addRoleUsers=function(b){var c=a.Deferred();return this.ajaxClient.post(q+"/roleuser",b).done(function(a){c.resolve(a)}).fail(function(a){c.reject(a)}),c.promise()},
I.prototype.addRoleGroups=function(b){var c=a.Deferred();return this.ajaxClient.post(q+"/rolegroup",b).done(function(a){c.resolve(a)}).fail(function(a){c.reject(a)}),c.promise()},I.prototype.deleteRoleUsers=function(b,c){var d=a.Deferred();return this.ajaxClient.delete(q+"/roleuser/"+b+"/"+c).done(function(a){d.resolve(a)}).fail(function(a){d.reject(a)}),d.promise()},I.prototype.deleteRoleGroups=function(b,c){var d=a.Deferred();return this.ajaxClient.delete(q+"/rolegroup/"+b+"/"+c).done(function(a){d.resolve(a)}).fail(function(a){d.reject(a)}),d.promise()},I.prototype.setLdapPreference=function b(c){var d=a.Deferred(),e=y;return this.ajaxClient.put(e,c).fail(function(a){"OK"!==a.statusText?d.reject(a):d.resolve()}),d.promise()},I.prototype.getLdapSettings=function(){var b="/ldap/settings",c=a.Deferred(),d=q+b;return this.ajaxClient.get(d).done(function(a){c.resolve(new x(a))}).fail(function(a){c.reject(a)}),c.promise()},I.prototype.getDomains=function(){
var b="/ldap/domains",c=a.Deferred(),d=q+b;return this.ajaxClient.get(d).done(function(a){c.resolve(E.fromDataCollection(a))}).fail(function(a){c.reject(a)}),c.promise()},I.prototype.getLdapSchedule=function(){var b=a.Deferred();return this.ajaxClient.get(C,{}).done(function(a){b.resolve(a)}).fail(function(a){b.reject(a)}),b.promise()},I.prototype.postDomain=function(b){var c=a.Deferred();return this.ajaxClient.post(q+"/ldap/domains/",b).done(function(a){c.resolve(a)}).fail(function(a){c.reject(a)}),c.promise()},I.prototype.deleteDomain=function(b){var c=a.Deferred();return this.ajaxClient.delete(q+"/ldap/domains/"+b).done(function(a){c.resolve(a)}).fail(function(a){c.reject(a)}),c.promise()},I.prototype.putDomain=function(b){var c=a.Deferred();return this.ajaxClient.put(q+"/ldap/domains",b).done(function(a){c.resolve(a)}).fail(function(a){c.reject(a)}),c.promise()},I.prototype.getDomain=function(b){var c="/ldap/domains/"+b,d=a.Deferred(),e=q+c
;return this.ajaxClient.get(e).done(function(a){d.resolve(new E(a))}).fail(function(a){d.reject(a)}),d.promise()},I.prototype.runLdap=function(){var b="/ldap/run",c=a.Deferred(),d=q+b;return this.ajaxClient.post(d).done(function(a){c.resolve(a)}).fail(function(a){c.reject(a)}),c.promise()},I.prototype.postPhoto=function(b){var c=a.Deferred();return this.ajaxClient.post(q+"/userphoto/"+b).done(function(a){c.resolve(a)}).fail(function(a){c.reject(a)}),c.promise()},I.prototype.postPhoto2=function(b,c,d,e){var f=a.Deferred();return this.ajaxClient.post(q+"/userphoto2?sessionId="+b+"&key="+c,d,{processData:!1,contentType:"application/octet-stream",xhr:function(){var a=new window.XMLHttpRequest;return a.upload.addEventListener("progress",function(a){if(a.lengthComputable){var b=Math.round(100*a.loaded/a.total);f.notify(b)}},!1),a.upload.addEventListener("load",function(){f.notify(100)},!1),a}}).done(f.resolve.bind(f)).fail(f.reject.bind(f)),f.promise()},I.prototype.deletePhoto=function(b){
var c=a.Deferred();return this.ajaxClient.delete(q+"/userphoto/"+b).done(function(a){c.resolve(a)}).fail(function(a){c.reject(a)}),c.promise()},I.prototype.getPasswordConfigs=function(){var b=a.Deferred();return this.ajaxClient.get(r+"/3",{}).done(function(a){b.resolve(new l.fromDataCollection(a))}).fail(function(a){b.reject(a)}),b.promise()},I.prototype.putPasswordConfigs=function(b){var c=a.Deferred();return this.ajaxClient.put(r+"/3",b).done(function(a){c.resolve(a)}).fail(function(a){c.reject(a)}),c.promise()},I.prototype.getMonitoringConfigs=function(){var b=a.Deferred();return this.ajaxClient.get(r+"/8",{}).done(function(a){b.resolve(new l.fromDataCollection(a))}).fail(function(a){b.reject(a)}),b.promise()},I.prototype.putMonitoringConfigs=function(b){var c=a.Deferred();return this.ajaxClient.put(r+"/8",b).done(function(a){c.resolve(a)}).fail(function(a){c.reject(a)}),c.promise()},I.prototype.getUserDefaults=function(){var b=a.Deferred()
;return this.ajaxClient.get(r+"/6",{}).done(function(a){b.resolve(new l.fromDataCollection(a))}).fail(function(a){b.reject(a)}),b.promise()},I.prototype.putUserDefaults=function(b){var c=a.Deferred();return this.ajaxClient.put(r+"/6",b).done(function(a){c.resolve(a)}).fail(function(a){c.reject(a)}),c.promise()},I.prototype.getFmlyPrivs=function(b){var c=a.Deferred(),d=s+"s/"+b;return this.ajaxClient.get(d).done(function(a){c.resolve(o.fromDataCollection(a))}),c.promise()},I.prototype.getFmlyPrivsAndChildren=function(b){var c=a.Deferred(),d=s+"s/"+b+"/true";return this.ajaxClient.get(d).done(function(a){c.resolve(o.fromDataCollection(a))}),c.promise()},I.prototype.searchFamilies=function b(c,d,e){var f=v+"/families/search?searchValue="+c+"&pageSize="+d+"&pageNum="+e+"&isFromDCM=true",g=a.Deferred();return this.ajaxClient.get(f,{}).done(function(b){b&&b.length?g.resolve(a.map(b,function(a){return new m(a)})):g.resolve(null)}).fail(function(a){g.reject(a)}),g.promise()},
I.prototype.postFmlyPriv=function(b){var c=a.Deferred();return this.ajaxClient.post(s,b).done(function(a){c.resolve(a)}).fail(function(a){c.reject(a)}),c.promise()},I.prototype.putFmlyPriv=function(b){var c=a.Deferred();return this.ajaxClient.put(s,b).done(function(a){c.resolve(a)}).fail(function(a){c.reject(a)}),c.promise()},I.prototype.deleteFmlyPriv=function(b){var c=a.Deferred();return this.ajaxClient.delete(s+"/"+b).done(function(a){c.resolve(a)}).fail(function(a){c.reject(a)}),c.promise()},I.prototype.getFamilies=function(){var b=a.Deferred();return this.ajaxClient.get(v+"/families?isFromDCM=true",{}).done(function(a){b.resolve(new n.fromDataCollection(a))}).fail(function(a){b.reject(a)}),b.promise()},I.prototype.getEntityFamiliesRoot=function(){var b=a.Deferred();return this.ajaxClient.get(v+"/entityfamiliesRoot?isFromDCM=true",{}).done(function(a){b.resolve(new m.fromDataCollection(a))}).fail(function(a){b.reject(a)}),b.promise()},I.prototype.getRelationshipFamilies=function(){
var b=a.Deferred();return this.ajaxClient.get(v+"/relationshipfamilies?isFromDCM=true",{}).done(function(a){b.resolve(new n.fromDataCollection(a))}).fail(function(a){b.reject(a)}),b.promise()},I.prototype.getEntityFamilies=function(b){var c=a.Deferred();return this.ajaxClient.get(v+"/entityfamiliesChild/"+b+"?isFromDCM=true",{}).done(function(a){c.resolve(new m.fromDataCollection(a))}).fail(function(a){c.reject(a)}),c.promise()},I.prototype.getLicensedModules=function b(){var d=a.Deferred();return c.get(B).send(d).done(K.bind(null,d)),d.promise()};function K(a,b){var c=new p(b);a.resolve(c)}return I.prototype.getSites=function(){var b=a.Deferred();return this.ajaxClient.get(q+"/sites",{}).done(function(a){b.resolve(new z.fromDataCollection(a))}).fail(function(a){b.reject(a)}),b.promise()},I.prototype.getSite=function(b){var c=a.Deferred();return this.ajaxClient.get(q+"/site/"+b,{}).done(function(a){c.resolve(new z(a))}).fail(function(a){c.reject(a)}),c.promise()},
I.prototype.postSite=function(b){var c=a.Deferred();return this.ajaxClient.post(q+"/site",b).done(function(a){c.resolve(new z(a))}).fail(function(a){c.reject(a)}),c.promise()},I.prototype.putSite=function(b){var c=a.Deferred();return this.ajaxClient.put(q+"/site",b).done(function(a){c.resolve(a)}).fail(function(a){c.reject(a)}),c.promise()},I.prototype.deleteSite=function(b){var c=a.Deferred();return this.ajaxClient.delete(q+"/site/"+b).done(function(a){c.resolve(a)}).fail(function(a){c.reject(a)}),c.promise()},I.prototype.getSiteUsers=function(b){var c=a.Deferred();return this.ajaxClient.get(q+"/siteusers/"+b,{}).done(function(a){c.resolve(new A.fromDataCollection(a))}).fail(function(a){c.reject(a)}),c.promise()},I.prototype.getUserSites=function(b){var c=a.Deferred();return this.ajaxClient.get(q+"/usersites/"+b,{}).done(function(a){c.resolve(new A.fromDataCollection(a))}).fail(function(a){c.reject(a)}),c.promise()},I.prototype.getCrossDomainAll=function(){
var b=a.Deferred(),c=q+"/crossdomain";return this.ajaxClient.get(c).done(function(a){b.resolve(F.fromDataCollection(a))}).fail(function(a){b.reject(a)}),b.promise()},I.prototype.getCrossDomain=function(b){var c="?name="+b,d=a.Deferred(),e=q+"/crossdomain"+c;return this.ajaxClient.get(e).done(function(a){d.resolve(new F(a))}).fail(function(a){d.reject(a)}),d.promise()},I.prototype.putCrossDomain=function(b){var c=a.Deferred();return this.ajaxClient.put(q+"/crossdomain/UpdateCrossDomain",b).done(function(a){c.resolve(a)}).fail(function(a){c.reject(a)}),c.promise()},I.prototype.deleteCrossDomain=function(b){var c=a.Deferred();return this.ajaxClient.put(q+"/crossdomain",b).done(function(a){c.resolve(a)}).fail(function(a){c.reject(a)}),c.promise()},I.prototype.postCrossDomain=function(b){var c=a.Deferred();return this.ajaxClient.post(q+"/crossdomain",b).done(function(a){c.resolve(a)}).fail(function(a){c.reject(a)}),c.promise()},I});
define('system/globalization/resource-file',[],function(){"use strict";function a(a){this.culture=a}return a.prototype.name=function(){var a=this.culture||"en";return"en"===a?"resources.json":"resources."+a+".json"},a.prototype.url=function(a){return a+"/"+this.name()+"?v="+window.appInfo.version},a});
define('system/globalization/globalize-resource-file',[],function(){"use strict";function a(a){this.culture=a}return a.prototype.name=function(){return"globalize.culture."+(this.culture||"en")+".js"},a.prototype.url=function(a){return a+"/"+this.name()},a});
define('system/globalization/datetime-resource-file',[],function(){"use strict";function a(a){this.culture=a}return a.prototype.name=function(){return"bootstrap-datetimepicker."+(this.culture||"en")+".js"},a.prototype.url=function(a){return a+"/"+this.name()},a});
define('system/globalization/resource-service',['require','exports','module','lodash','jquery','./resource-file','system/http/ajax-client','system/diagnostics/log-manager','./globalize-resource-file','./datetime-resource-file'],function(require,exports,module){"use strict";var a=require("lodash"),b=require("jquery"),c=require("./resource-file"),d=require("system/http/ajax-client"),e=require("system/diagnostics/log-manager"),f=e.getLogger(module.id),g=require("./globalize-resource-file"),h=require("./datetime-resource-file"),i="i18n/resources",j="i18n/globalize",k="i18n/datetime";function l(a,b){this.meridiumResourcePath=a||"",this.libraryResourcePaths=b||{}}l.factory=function(){return new l(i,{globalize:j,datetime:k})},l.prototype.getMeridiumResource=function(a,d){var e=new c(a.next());return d=d||b.Deferred(),m(this,e).done(n.bind(null,this,d,a,e)).fail(o.bind(null,this,d,a,e)),d.promise()},l.prototype.getGlobalizeResource=function(a,c){var d=new g(a.next());return c=c||b.Deferred(),""!==d.culture&&"en"!==d.culture?p(this,d).done(function(){f.debug("Loaded resource file",d.name()),c.resolve(d.culture)}).fail(q.bind(null,this,c,a,d)):c.resolve("en"),c.promise()},
l.prototype.getDateTimeResource=function(a,c){var d=new h(a.next());return c=c||b.Deferred(),""!==d.culture&&"en"!==d.culture&&"en-US"!==d.culture?r(this,d).done(function(){f.debug("Loaded resource file",d.name()),c.resolve(d.culture)}).fail(s.bind(null,this,c,a,d)):c.resolve("en"),c.promise()};function m(a,c){var e=Object.resolve(d),f=a.meridiumResourcePath;return b.ajax({url:c.url(f),type:"GET",dataType:"json",timeout:3e4,cache:!0})}function n(b,c,d,e,g){a.isObject(g)?(f.debug("Loaded resource file",e.name()),c.resolve(g)):o(b,c,d,e)}function o(a,b,c,d){f.debug("Could not find resource file",d.name()),c.cultures.length?a.getMeridiumResource(c,b):b.reject("No resource file found")}function p(a,c){return b.ajax({url:c.url(a.libraryResourcePaths.globalize),dataType:"script",cache:!0})}function q(a,b,c,d){f.debug("Could not find resource file",d.name()),c.cultures.length?a.getGlobalizeResource(c,b):b.reject("No resource file found")}function r(a,c){var d=b.Deferred()
;return require([c.url(a.libraryResourcePaths.datetime)],function(){d.resolve()},function(){d.reject()}),d.promise()}function s(a,b,c,d){f.debug("Could not find resource file",d.name()),c.cultures.length?a.getDateTimeResource(c,b):b.reject("No resource file found")}return l});
define('system/globalization/culture-list',[],function(){"use strict";function a(a){this.cultures=b(a)}a.prototype.next=function(){return this.cultures.shift()};function b(a){return a?"en"===a?[a]:a.indexOf("-")!==-1?[a,a.split("-")[0],"en"]:[a,"en"]:[""]}return a});
define('security/offline-login/context/offline-login-context',[],function(){"use strict";function a(){b(this)}function b(a){a.user={password:null},a.datasources=null,a.locale=null}return a.prototype.reset=function(){b(this)},new a});
define('logging/error-notification-handler',['require','jquery','knockout','spa/ko/knockout-view-model','system/lang/event'],function(require){"use strict";var a=require("jquery"),b=require("knockout"),c=require("spa/ko/knockout-view-model"),d=require("system/lang/event"),e=[];function f(){g.call(this)}var g=Object.inherit(c,f);f.prototype.addError=function a(b){b&&(b.errorCode=b.errorCode||"",b.errorMessage=b.errorMessage||"",b.errorDetail=b.errorDetail||"",b.date=b.date||h(),b.time=b.time||i(new Date))},f.prototype.getErrorsLog=function a(b,c){return e},f.prototype.getErrorById=function b(c){return a.grep(e,function(a){return a.number===parseInt(c.logId)})};function h(){var a=new Date;return a.getMonth()+1+"/"+a.getDate()+"/"+a.getFullYear().toString().substr(2,2)}function i(a){var b=a.getHours(),c=a.getMinutes(),d=b>=12?"pm":"am";return b%=12,b=b?b:12,c=c<10?"0"+c:c,b+":"+c+" "+d}return f.singleton=!0,f});
!function(a){"use strict";if("function"==typeof define&&define.amd)define('ui/elements/date-time/bootstrap-datetimepicker',["jquery","moment","lodash","system/text/formatter","system/lang/converter","system/globalization/translator","system/hardware/device","system/text/parser"],a);else{if(!jQuery)throw"bootstrap-datetimepicker requires jQuery to be loaded first";if(!moment)throw"bootstrap-datetimepicker requires moment.js to be loaded first";a(jQuery,moment,_)}}(function(a,b,c,d,e,f,g,h){"use strict";if(void 0===b)throw alert("momentjs is required"),new Error("momentjs is required");var i=0,j=b,k=Object.resolve(d),l=Object.resolve(f),m=function(b,d){var e=a.fn.datetimepicker.defaults,f={time:"icon-time-units",date:"icon-calendar",up:"icon-up-arrow",down:"icon-arrow"},m=new g,n=this,o=!1,p=function(){var b=!1,c;if(t(),c=k.cultureInfo().calendar.patterns,r(c),n.use24hours=n.format.toLowerCase().indexOf("t")<1,null===k.cultureInfo().calendar.AM&&null===k.cultureInfo().calendar.AM&&(n.use24hours=!0),
n.component&&(b=n.component.find("span")),n.options.pickTime&&b&&b.addClass(n.options.icons.time),n.options.pickDate&&b&&(b.removeClass(n.options.icons.time),b.addClass(n.options.icons.date)),n.options.widgetParent="string"==typeof n.options.widgetParent&&n.options.widgetParent||n.element.parents().filter(function(){return"scroll"===a(this).css("overflow-y")}).get(0)||"body",n.widget=a(da()).appendTo(n.options.widgetParent),n.options.useSeconds&&!n.use24hours&&n.widget.width(300),s(),n.options.disabledDates=ba(n.options.disabledDates),n.options.enabledDates=ba(n.options.enabledDates),q(),""!==n.options.defaultDate&&""===u().val()&&n.setValue(n.options.defaultDate),1!==n.options.minuteStepping){var d=n.options.minuteStepping;n.date.minutes(Math.round(n.date.minutes()/d)*d%60).seconds(0)}},q=function(){n.startViewMode=n.viewMode,n.setMinDate(n.options.minDate),n.setMaxDate(n.options.maxDate),E(),F(),H(),I(),J(),D(),T(),U()},r=function(a){n.format||(n.format=n.options.pickDate?a.d:"",
n.options.pickDate&&n.options.pickTime&&(n.format+=" "),n.format+=n.options.pickTime?a.t:"",n.options.useSeconds&&(~a.t.indexOf(" tt")?n.format=n.format.split(" tt")[0]+":ss tt":~a.t.indexOf(" t")?n.format=n.format.split(" t")[0]+":ss t":n.format+=":ss"))},s=function(){if(n.minViewMode=n.options.minViewMode||0,"string"==typeof n.minViewMode)switch(n.minViewMode){case"months":n.minViewMode=1;break;case"years":n.minViewMode=2;break;default:n.minViewMode=0}if(n.viewMode=n.options.viewMode||0,"string"==typeof n.viewMode)switch(n.viewMode){case"months":n.viewMode=1;break;case"years":n.viewMode=2;break;default:n.viewMode=0}},t=function(){if(n.options=a.extend({},e,d),n.options.icons=a.extend({},f,n.options.icons),n.element=a(b),n.elementZIndexOrig=n.element.css("z-index"),n.elementPosOrig=n.element.css("position"),n.blockout=a('<div class="datepicker-screen-freeze"></div>'),v(),!n.options.pickTime&&!n.options.pickDate)throw new Error("Must choose at least one picker");n.id=i++,
j.locale(n.options.language),n.date=j(),n.unset=!1,n.isInput=n.element.is("input"),n.component=!1,n.element.hasClass("input-group")&&(0===n.element.find(".datepickerbutton").size()?n.component=n.element.find("[class^='input-group-']"):n.component=n.element.find(".datepickerbutton")),n.format=n.options.format,n.placePosition=""},u=function(){var a;if(n.isInput)return n.element;if(a=n.element.find(".datepickerinput"),0===a.size())a=n.element.find("input");else if(!a.is("input"))throw new Error('CSS class "datepickerinput" cannot be applied to non input element');return a},v=function(){var a;a=n.element.is("input")?n.element.data():n.element.find("input").data(),void 0!==a.dateFormat&&(n.options.format=a.dateFormat),void 0!==a.datePickdate&&(n.options.pickDate=a.datePickdate),void 0!==a.datePicktime&&(n.options.pickTime=a.datePicktime),void 0!==a.dateUseminutes&&(n.options.useMinutes=a.dateUseminutes),void 0!==a.dateUseseconds&&(n.options.useSeconds=a.dateUseseconds),
void 0!==a.dateUsecurrent&&(n.options.useCurrent=a.dateUsecurrent),void 0!==a.dateMinutestepping&&(n.options.minuteStepping=a.dateMinutestepping),void 0!==a.dateMindate&&(n.options.minDate=a.dateMindate),void 0!==a.dateMaxdate&&(n.options.maxDate=a.dateMaxdate),void 0!==a.dateShowtoday&&(n.options.showToday=a.dateShowtoday),void 0!==a.dateCollapse&&(n.options.collapse=a.dateCollapse),void 0!==a.dateLanguage&&(n.options.language=a.dateLanguage),void 0!==a.dateDefaultdate&&(n.options.defaultDate=a.dateDefaultdate),void 0!==a.dateDisableddates&&(n.options.disabledDates=a.dateDisableddates),void 0!==a.dateEnableddates&&(n.options.enabledDates=a.dateEnableddates),void 0!==a.dateIcons&&(n.options.icons=a.dateIcons),void 0!==a.dateUsestrict&&(n.options.useStrict=a.dateUsestrict),void 0!==a.dateDirection&&(n.options.direction=a.dateDirection),void 0!==a.dateSidebyside&&(n.options.sideBySide=a.dateSidebyside)},w=function(){
var b="absolute",c=n.component?n.component.offset():n.element.offset(),d=a(window);n.width=n.component?n.component.outerWidth():n.element.outerWidth(),c.top=c.top+n.element.outerHeight(),n.placePosition,y(c,d),z(c),void 0!==n.options.width&&n.widget.width(n.options.width),"left"===n.options.orientation&&(n.widget.addClass("left-oriented"),c.left=c.left-n.widget.width()+20),Y()&&(b="fixed",c.top-=d.scrollTop(),c.left-=d.scrollLeft()),d.width()<c.left+n.widget.outerWidth()?(c.right=d.width()-c.left-n.width,c.left="auto",n.widget.addClass("pull-right")):(c.right="auto",n.widget.removeClass("pull-right")),n.widget.css({position:b,top:c.top,left:c.left,right:c.right})},x=function(){c.defer(function(){window.scrollTo(0,0),n.widget.css("top",Math.max(0,(a(window).height()-n.widget.outerHeight())/2+a(window).scrollTop())+"px"),n.widget.css("left",Math.max(0,(a(window).width()-n.widget.outerWidth())/2+a(window).scrollLeft())+"px")})},y=function(b,c){
var d=b.top+n.widget.height()>c.height()+c.scrollTop()&&n.widget.height()+n.element.outerHeight()<b.top,e=!(b.top>0&&b.left>0&&b.top+n.widget.height()<c.height());"up"===n.options.direction?n.placePosition="top":"bottom"===n.options.direction?n.placePosition="bottom":"auto"===n.options.direction&&(d?n.placePosition="top":e?(x(),a(n.widget).addClass("remove-arrow")):n.placePosition="bottom")},z=function(a){"top"===n.placePosition?(a.top-=n.widget.height()+n.element.outerHeight()+15,n.widget.addClass("top").removeClass("bottom")):(a.top+=1,n.widget.addClass("bottom").removeClass("top"))},A=function(a){n.element.trigger({type:"dp.clear",date:j(n.date),oldDate:j(a)})},B=function(a,b){if(o)o=!1;else if(j(n.date).isSame(j(a)))return;n.element.trigger({type:"dp.change",date:j(n.date),oldDate:j(a)}),"change"!==b&&n.element.change()},C=function(a){o=!0,n.element.trigger({type:"dp.error",date:j(a)})},D=function(a){j.locale(n.options.language);var b=a,c;b||(b=u().val(),b&&(c=S(b,n.format,b),
c instanceof Date||!n.options.oldFormat||n.format===n.options.oldFormat||(c=S(b,n.options.oldFormat,b)),n.date=j(c)),n.date||(n.date=j())),n.viewDate=j(n.date).startOf("month"),G(),K()},E=function(){j.locale(n.options.language);var b=a("<tr>"),c=j.weekdaysMin(),d;if(0===j().localeData()._week.dow)for(d=0;d<7;d++)b.append('<th class="dow">'+c[d]+"</th>");else for(d=1;d<8;d++)7===d?b.append('<th class="dow">'+c[0]+"</th>"):b.append('<th class="dow">'+c[d]+"</th>");n.widget.find(".datepicker-days thead").append(b)},F=function(){j.locale(n.options.language);for(var a="",b=0,c=j.monthsShort();b<12;)a+='<span class="month">'+c[b++]+"</span>";n.widget.find(".datepicker-months td").append(a)},G=function(){if(n.options.pickDate){j.locale(n.options.language);var b=n.viewDate.year(),c=n.viewDate.month(),d=n.options.minDate.year(),e=n.options.minDate.month(),f=n.options.maxDate.year(),g=n.options.maxDate.month(),h,i,k,l=[],m,o,p,q,r,s,t=j.months()
;for(n.widget.find(".datepicker-days").find(".disabled").removeClass("disabled"),n.widget.find(".datepicker-months").find(".disabled").removeClass("disabled"),n.widget.find(".datepicker-years").find(".disabled").removeClass("disabled"),n.widget.find(".datepicker-days th:eq(1)").text(t[c]+" "+b),i=j(n.viewDate).subtract(1,"months"),q=i.daysInMonth(),i.date(q),i.startOf("week"),(b===d&&c<=e||b<d)&&n.widget.find(".datepicker-days th:eq(0)").addClass("disabled"),(b===f&&c>=g||b>f)&&n.widget.find(".datepicker-days th:eq(2)").addClass("disabled"),k=j(i).add(42,"d");i.isBefore(k);){if(i.weekday()===j().startOf("week").weekday()&&(m=a("<tr>"),l.push(m)),o="",i.year()<b||i.year()===b&&i.month()<c?o+=" old":(i.year()>b||i.year()===b&&i.month()>c)&&(o+=" new"),i.isSame(j({y:n.date.year(),M:n.date.month(),d:n.date.date()}))&&(o+=" active"),!_(i,"day")&&aa(i)||(o+=" disabled"),n.options.showToday===!0&&i.isSame(j(),"day")&&(o+=" today"),
n.options.daysOfWeekDisabled)for(p in n.options.daysOfWeekDisabled)if(i.day()===n.options.daysOfWeekDisabled[p]){o+=" disabled";break}m.append('<td class="day'+o+'">'+i.date()+"</td>"),h=i.date(),i.add(1,"d"),h===i.date()&&i.add(1,"d")}for(n.widget.find(".datepicker-days tbody").empty().append(l),s=n.date.year(),t=n.widget.find(".datepicker-months").find("th:eq(1)").text(b).end().find("span").removeClass("active"),s===b&&t.eq(n.date.month()).addClass("active"),s-1<d&&n.widget.find(".datepicker-months th:eq(0)").addClass("disabled"),s+1>f&&n.widget.find(".datepicker-months th:eq(2)").addClass("disabled"),p=0;p<12;p++)b===d&&e>p||b<d?a(t[p]).addClass("disabled"):(b===f&&g<p||b>f)&&a(t[p]).addClass("disabled");for(l="",b=10*parseInt(b/10,10),r=n.widget.find(".datepicker-years").find("th:eq(1)").text(b+"-"+(b+9)).end().find("td"),n.widget.find(".datepicker-years").find("th").removeClass("disabled"),d>b&&n.widget.find(".datepicker-years").find("th:eq(0)").addClass("disabled"),
f<b+9&&n.widget.find(".datepicker-years").find("th:eq(2)").addClass("disabled"),b-=1,p=-1;p<11;p++)l+='<span class="year'+(p===-1||10===p?" old":"")+(s===b?" active":"")+(b<d||b>f?" disabled":"")+'">'+b+"</span>",b+=1;r.html(l)}},H=function(){j.locale(n.options.language);var a=n.widget.find(".timepicker .timepicker-hours table"),b="",c,d,e;if(a.parent().hide(),n.use24hours)for(c=0,d=0;d<6;d+=1){for(b+="<tr>",e=0;e<4;e+=1)b+='<td class="hour">'+ca(c.toString())+"</td>",c++;b+="</tr>"}else for(c=1,d=0;d<3;d+=1){for(b+="<tr>",e=0;e<4;e+=1)b+='<td class="hour">'+ca(c.toString())+"</td>",c++;b+="</tr>"}a.html(b)},I=function(){var a=n.widget.find(".timepicker .timepicker-minutes table"),b="",c=0,d,e,f=n.options.minuteStepping;for(a.parent().hide(),1===f&&(f=5),d=0;d<Math.ceil(60/f/4);d++){for(b+="<tr>",e=0;e<4;e+=1)c<60?(b+='<td class="minute">'+ca(c.toString())+"</td>",c+=f):b+="<td></td>";b+="</tr>"}a.html(b)},J=function(){
var a=n.widget.find(".timepicker .timepicker-seconds table"),b="",c=0,d,e;for(a.parent().hide(),d=0;d<3;d++){for(b+="<tr>",e=0;e<4;e+=1)b+='<td class="second">'+ca(c.toString())+"</td>",c+=5;b+="</tr>"}a.html(b)},K=function(){if(n.date){var a=n.widget.find(".timepicker span[data-time-component]"),b=n.date.hours(),c="AM";n.use24hours?(n.widget.find(".timepicker-hour").addClass("hour-fix"),n.widget.find(".timepicker-minute").addClass("hour-fix"),n.widget.find(".timepicker-second").addClass("hour-fix")):(b>=12&&(c="PM"),0===b?b=12:12!==b&&(b%=12),n.widget.find(".timepicker [data-action=togglePeriod]").text(c)),a.filter("[data-time-component=hours]").text(ca(b)),a.filter("[data-time-component=minutes]").text(ca(n.date.minutes())),a.filter("[data-time-component=seconds]").text(ca(n.date.second()))}},L=function(b){b.stopPropagation(),b.preventDefault(),n.unset=!1;var c=a(b.target).closest("span, td, th, button"),d,e,f,g,h=j(n.date);c.hasClass("close-button")&&n.hide(),
c.hasClass("clear-date-button")&&(n.setDate(S("",void 0,"")),n.hide(),A()),1===c.length&&M(b,c,d,e,f,g,h)},M=function(a,b,c,d,e,f,g){if(!b.is(".disabled"))switch(b[0].nodeName.toLowerCase()){case"th":switch(b[0].className){case"switch":T(1);break;case"prev":case"next":e=ea.modes[n.viewMode].navStep,"prev"===b[0].className&&(e*=-1),n.viewDate.add(e,ea.modes[n.viewMode].navFnc),G()}break;case"span":b.is(".month")?(c=b.parent().find("span").index(b),n.viewDate.month(c)):(d=parseInt(b.text(),10)||0,n.viewDate.year(d)),n.viewMode===n.minViewMode&&(n.date=j({y:n.viewDate.year(),M:n.viewDate.month(),d:n.viewDate.date(),h:n.date.hours(),m:n.date.minutes(),s:n.date.seconds()}),B(g,a.type),Z()),T(-1),G();break;case"td":b.is(".day")&&(f=parseInt(b.text(),10)||1,c=n.viewDate.month(),d=n.viewDate.year(),b.is(".old")?0===c?(c=11,d-=1):c-=1:b.is(".new")&&(11===c?(c=0,d+=1):c+=1),n.date=j({y:d,M:c,d:f,h:n.date.hours(),m:n.date.minutes(),s:n.date.seconds()}),n.viewDate=j({y:d,M:c,d:Math.min(28,f)}),
G(),Z(),B(g,a.type),n.hide())}},N={incrementHours:function(){$("add","hours",1)},incrementMinutes:function(){$("add","minutes",n.options.minuteStepping)},incrementSeconds:function(){$("add","seconds",1)},decrementHours:function(){$("subtract","hours",1)},decrementMinutes:function(){$("subtract","minutes",n.options.minuteStepping)},decrementSeconds:function(){$("subtract","seconds",1)},togglePeriod:function(){var a=n.date.hours();a>=12?a-=12:a+=12,n.date.hours(a)},showPicker:function(){n.widget.find(".timepicker > div:not(.timepicker-picker)").hide(),n.widget.find(".timepicker .timepicker-picker").show()},showHours:function(){n.widget.find(".timepicker .timepicker-picker").hide(),n.widget.find(".timepicker .timepicker-hours").show()},showMinutes:function(){n.widget.find(".timepicker .timepicker-picker").hide(),n.widget.find(".timepicker .timepicker-minutes").show()},showSeconds:function(){n.widget.find(".timepicker .timepicker-picker").hide(),
n.widget.find(".timepicker .timepicker-seconds").show()},selectHour:function(b){var c=n.widget.find(".timepicker [data-action=togglePeriod]").text(),d=parseInt(a(b.target).text(),10);"PM"===c&&(d+=12),n.date.hours(d),N.showPicker.call(n)},selectMinute:function(b){n.date.minutes(parseInt(a(b.target).text(),10)),N.showPicker.call(n)},selectSecond:function(b){n.date.seconds(parseInt(a(b.target).text(),10)),N.showPicker.call(n)}},O=function(b){var c=j(n.date),d=a(b.currentTarget).data("action"),e=N[d].apply(n,arguments);return P(b),n.date||(n.date=j({y:1970})),Z(),K(),B(c,b.type),e},P=function(a){a.stopPropagation(),a.preventDefault()},Q=function(a){27===a.keyCode&&n.hide()},R=function(b){j.locale(n.options.language);var c=a(b.target),d=j(n.date),e=j(S(c.val(),n.format,c.val()));e.isValid()&&!_(e)&&aa(e)?(D(),n.setValue(e),B(d,b.type),Z()):(n.viewDate=d,n.unset=!0,B(d,b.type),C(e))},S=function(a,b,c){return b=b||"yyyy-MM-ddTHH:mm:ss.fff",c=Object.defaultValue(c,null),
null===a||void 0===a?c:a instanceof Date?a:h.parseDate(a,b)||h.parseDate(a,"yyyy-MM-ddTHH:mm:ss.fff")||h.parseDate(a)||null},T=function(a){a&&(n.viewMode=Math.max(n.minViewMode,Math.min(2,n.viewMode+a))),n.widget.find(".datepicker > div").hide().filter(".datepicker-"+ea.modes[n.viewMode].clsName).show()},U=function(){var b,c,d,e,f;n.widget.on("click",".datepicker *, .close-button, .clear-date-button",a.proxy(L,this)),n.widget.on("click","[data-action]",a.proxy(O,this)),n.widget.on("mousedown",a.proxy(P,this)),n.element.on("keydown",a.proxy(Q,this)),n.options.pickDate&&n.options.pickTime&&n.widget.on("click.togglePicker",".accordion-toggle",function(g){if("top"===n.placePosition&&setTimeout(function(){w()},250),g.stopPropagation(),b=a(this),c=b.closest("ul"),d=c.find(".in"),e=c.find(".collapse:not(.in)"),d&&d.length){if((f=d.data("collapse"))&&f.transitioning)return;d.collapse("hide"),e.collapse("show"),b.find("span").toggleClass(n.options.icons.time+" "+n.options.icons.date),
n.element.find("[class^='input-group-'] span").toggleClass(n.options.icons.time+" "+n.options.icons.date)}}),n.isInput?m.isMobile()?n.element.on({focus:a.proxy(n.show,this),change:a.proxy(R,this)}):n.element.on({focus:a.proxy(n.show,this),change:a.proxy(R,this),blur:a.proxy(n.hide,this)}):(n.element.on({change:a.proxy(R,this)},"input"),n.component?n.component.on("click",a.proxy(n.show,this)):n.element.on("click",a.proxy(n.show,this)))},V=function(){a(window).on("resize.datetimepicker"+n.id,a.proxy(w,this)),n.isInput||a(document).on("mousedown.datetimepicker"+n.id,a.proxy(n.hide,this))},W=function(){n.widget.off("click",".datepicker *, .close-button, .clear-date-button",n.click),n.widget.off("click","[data-action]"),n.widget.off("mousedown",n.stopEvent),n.options.pickDate&&n.options.pickTime&&n.widget.off("click.togglePicker"),n.isInput?n.element.off({focus:n.show,change:n.change}):(n.element.off({change:n.change},"input"),
n.component?n.component.off("click",n.show):n.element.off("click",n.show))},X=function(){a(window).off("resize.datetimepicker"+n.id),n.isInput||a(document).off("mousedown.datetimepicker"+n.id)},Y=function(){if(n.element){var b=n.element.parents(),c=!1,d;for(d=0;d<b.length;d++)if("fixed"===a(b[d]).css("position")){c=!0;break}return c}return!1},Z=function(){j.locale(n.options.language);var a="";n.unset||(a=k.format(n.date.toDate(),n.format)),u().val(a),n.element.data("date",a),n.options.pickTime||n.hide()},$=function(a,b,c){j.locale(n.options.language);var d;if("add"===a?(d=j(n.date),23===d.hours()&&d.add(c,b),d.add(c,b)):d=j(n.date).subtract(c,b),_(j(d.subtract(c,b)))||_(d))return void C(k.format(d.toDate(),n.format));"add"===a?n.date.add(c,b):n.date.subtract(c,b),n.unset=!1},_=function(a,b){j.locale(n.options.language);var c=n.options.maxDate,d=n.options.minDate;return b&&(c=j(c).endOf(b),d=j(d).startOf(b)),
!(!a.isAfter(c)&&!a.isBefore(d))||n.options.disabledDates!==!1&&n.options.disabledDates[k.format(a,"yyyy-MM-dd")]===!0},aa=function(a){return j.locale(n.options.language),n.options.enabledDates===!1||n.options.enabledDates[k.format(a,"yyyy-MM-dd")]===!0},ba=function(a){var b,c={},d=0,e;for(e=0;e<a.length;e++)b=j(a[e]),b.isValid()&&(c[k.format(b.toDate(),"yyyy-MM-dd")]=!0,d++);return d>0&&c},ca=function(a){return a=a.toString(),a.length>=2?a:"0"+a},da=function(){if(n.options.pickDate&&n.options.pickTime){var a="";return a='<div class="bootstrap-datetimepicker-widget'+(n.options.sideBySide?" timepicker-sbs":"")+' dropdown-menu" style="z-index:99999 !important;">',
n.options.sideBySide?a+='<div class="row"><div class="col-sm-6 datepicker">'+ea.template+'</div><div class="col-sm-6 timepicker">'+fa.getTemplate()+"</div></div>":a+='<ul class="list-unstyled"><li'+(n.options.collapse?' class="collapse in"':"")+'><div class="datepicker">'+ea.template+'</div></li><li class="picker-switch accordion-toggle"><a class="btn btn-icon" style="width:100%; padding-top:5px;"><span class="'+n.options.icons.time+'"></span></a></li><li'+(n.options.collapse?' class="collapse"':"")+'><div class="timepicker">'+fa.getTemplate()+"</div></li></ul>"+ea.buttonsTemplate,a+="</div>"}return n.options.pickTime?'<div class="bootstrap-datetimepicker-widget dropdown-menu"><div class="timepicker">'+fa.getTemplate()+"</div>"+ea.buttonsTemplate+"</div>":'<div class="bootstrap-datetimepicker-widget dropdown-menu"><div class="datepicker">'+ea.template+"</div>"+ea.buttonsTemplate+"</div>"},ea={modes:[{clsName:"days",navFnc:"month",navStep:1},{clsName:"months",navFnc:"year",navStep:1},{
clsName:"years",navFnc:"year",navStep:10}],headTemplate:'<thead><tr><th class="prev"><i class="icon-back-arrow"></i></th><th colspan="5" class="switch"></th><th class="next"><i class="icon-right-arrow"></i></th></tr></thead>',contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>'},fa={hourTemplate:'<span data-action="showHours" data-time-component="hours" class="timepicker-hour"></span>',minuteTemplate:'<span data-action="showMinutes" data-time-component="minutes" class="timepicker-minute"></span>',secondTemplate:'<span data-action="showSeconds"  data-time-component="seconds" class="timepicker-second"></span>'};ea.template='<div class="datepicker-days"><table class="table-condensed">'+ea.headTemplate+'<tbody></tbody></table></div><div class="datepicker-months"><table class="table-condensed">'+ea.headTemplate+ea.contTemplate+'</table></div><div class="datepicker-years"><table class="table-condensed">'+ea.headTemplate+ea.contTemplate+"</table></div>",
ea.buttonsTemplate='<div class="block-group date-picker-buttons"><button class="clear-date-button btn btn-default block">'+l.translate("CLEAR")+'</button><button class="close-button btn btn-default block">'+l.translate("CLOSE")+"</button> </div>",fa.getTemplate=function(){
return'<div class="timepicker-picker"><table class="table-condensed"><tr><td><a href="#" class="btn  btn-icon" data-action="incrementHours"><span style="box-shadow:none; font-size:18px;" class="'+n.options.icons.up+'"></span></a></td><td class="separator"></td><td>'+(n.options.useMinutes?'<a href="#" class="btn btn-icon" data-action="incrementMinutes"><span style="box-shadow:none; font-size:18px;" class="'+n.options.icons.up+'"></span></a>':"")+"</td>"+(n.options.useSeconds?'<td class="separator"></td><td><a href="#" class="btn btn-icon" data-action="incrementSeconds"><span style="box-shadow:none; font-size:18px;" class="'+n.options.icons.up+'"></span></a></td>':"")+(n.use24hours?"":'<td class="separator"></td>')+"</tr><tr><td>"+fa.hourTemplate+'</td> <td class="separator">:</td><td>'+(n.options.useMinutes?fa.minuteTemplate:'<span class="timepicker-minute">00</span>')+"</td> "+(n.options.useSeconds?'<td class="separator">:</td><td>'+fa.secondTemplate+"</td>":"")+(n.use24hours?"":'<td class="separator"></td><td><button type="button" class="btn btn-primary" style="min-width: 0;" data-action="togglePeriod"></button></td>')+'</tr><tr><td><a href="#" class="btn btn-icon" data-action="decrementHours"><span style="box-shadow:none; font-size:18px;" class="'+n.options.icons.down+'"></span></a></td><td class="separator"></td><td>'+(n.options.useMinutes?'<a href="#" class="btn btn-icon" data-action="decrementMinutes"><span style="box-shadow:none; font-size:18px;" class="'+n.options.icons.down+'"></span></a>':"")+"</td>"+(n.options.useSeconds?'<td class="separator"></td><td><a href="#" class="btn btn-icon" data-action="decrementSeconds"><span class="'+n.options.icons.down+'"></span></a></td>':"")+(n.use24hours?"":'<td class="separator"></td>')+'</tr></table></div><div class="timepicker-hours" data-action="selectHour"><table class="table-condensed"></table></div><div class="timepicker-minutes" data-action="selectMinute"><table class="table-condensed"></table></div>'+(n.options.useSeconds?'<div class="timepicker-seconds" data-action="selectSecond"><table class="table-condensed"></table></div>':"")
},n.destroy=function(){W(),X(),n.widget.remove(),n.blockout&&n.blockout.remove(),n.element.removeData("DateTimePicker"),n.component&&n.component.removeData("DateTimePicker")},n.show=function(b){if(n.options.useCurrent&&""===u().val()){if(1!==n.options.minuteStepping){var c=j(),d=n.options.minuteStepping;c.minutes(Math.round(c.minutes()/d)*d%60).seconds(0),n.setValue(k.format(c.toDate(),n.format))}else n.setValue(k.format(new Date,n.format));B("",b.type)}n.blockout=a('<div class="datepicker-screen-freeze"></div>').appendTo("body"),m.isMobile()&&n.blockout.click(function(){a(n.blockout).remove(),n.hide()}),n.widget.hasClass("picker-open")?(n.widget.hide(),n.widget.removeClass("picker-open")):(n.widget.show(),n.blockout.show(),n.widget.css("visibility","visible"),n.element.css("z-index",99999),a("input.form-control").css("z-index",2),n.element.css("position","relative"),n.widget.addClass("picker-open")),n.height=n.component?n.component.outerHeight():n.element.outerHeight(),w(),
n.element.trigger({type:"dp.show",date:j(n.date)}),V(),b&&P(b)},n.disable=function(){var a=n.element.find("input");a.prop("disabled")||a.prop("disabled",!0)},n.enable=function(){var a=n.element.find("input");a.prop("disabled")&&a.prop("disabled",!1)},n.hide=function(a){m.isMobile()?setTimeout(n.hide_function.bind(null,this,a),500):n.hide_function(a)},n.hide_function=function(b){if(!b||!a(b.target).is("#"+n.element.attr("id"))){var c=n.widget.find(".collapse"),d,e;for(d=0;d<c.length;d++)if((e=c.eq(d).data("collapse"))&&e.transitioning)return;n.widget.hide(),n.widget.css("visiblity","hidden"),n.widget.removeClass("picker-open"),n.viewMode=n.startViewMode,n.blockout&&(n.blockout.remove(),m.isMobile()&&n.blockout.off("click")),m.isMobile()&&a(n.element).blur(),n.element.css("z-index",n.elementZIndexOrig),n.element.css("position",n.elementPosOrig),T(),n.element.trigger({type:"dp.hide",date:j(n.date)}),X()}},n.setValue=function(a){j.locale(n.options.language),a?n.unset=!1:(n.unset=!0,Z()),
j.isMoment(a)||(a=j(a instanceof Date?a:S(a,n.format,a))),a.isValid()?(n.date=a,Z(),n.viewDate=j({y:n.date.year(),M:n.date.month()}),G(),K()):C(a)},n.getDate=function(){return n.unset?null:j(n.date)},n.setDate=function(a){var b=j(n.date);a?n.setValue(a):n.setValue(null),B(b,"function")},n.setDisabledDates=function(a){n.options.disabledDates=ba(a),n.viewDate&&D()},n.setEnabledDates=function(a){n.options.enabledDates=ba(a),n.viewDate&&D()},n.setMaxDate=function(a){void 0!==a&&(n.options.maxDate=j(a),n.viewDate&&D())},n.setMinDate=function(a){void 0!==a&&(n.options.minDate=j(a),n.viewDate&&D())},p()};a.fn.datetimepicker=function(b){function c(c){var d=a(c);d.data("DateTimePicker")||d.data("DateTimePicker",new m(c,b))}return this.each(c.bind(null,this))},a.fn.datetimepicker.defaults={pickDate:!0,pickTime:!0,useMinutes:!0,useSeconds:!1,useCurrent:!0,minuteStepping:1,minDate:new j({y:1900}),maxDate:(new j).add(1e3,"y"),showToday:!0,collapse:!0,language:"en",defaultDate:"",disabledDates:!1,
enabledDates:!1,icons:{},useStrict:!1,direction:"auto",sideBySide:!1,daysOfWeekDisabled:!1,widgetParent:!1}});
define('ui/elements/date-time/date-time-control',['require','exports','module','lodash','jquery','logging/error-notification-handler','system/diagnostics/log-manager','system/lang/event','system/hardware/device','ui/elements/date-time/bootstrap-datetimepicker'],function(require,exports,module){"use strict";var a=require("lodash"),b=require("jquery"),c=require("logging/error-notification-handler"),d=require("system/diagnostics/log-manager"),e=d.getLogger(module.id),f=require("system/lang/event"),g=require("system/hardware/device");require("ui/elements/date-time/bootstrap-datetimepicker");function h(a){this.element=a,this.options=null,this.picker=null,this.changed=new f,this.invalid=new f,this.clear=new f,this.blur=new f,this.hide=new f,this.inputGroup=null,this.input=null,this.addon=null,this.button=null,this.icon=null,this.$input=null,this.$addon=null,this.markValid=!1,this.errorNotificationHandler=Object.resolve(c)}h.culture="",h.setCulture=function(a){try{h.culture=a}catch(a){B(this,a)}},h.prototype.initHTML=function(){try{i(this)}catch(a){B(this,a)}},h.prototype.initialize=function(a){try{j(this,a)}catch(a){B(this,a)}},h.prototype.setValue=function(a){try{this.picker&&this.picker.setDate(a)}catch(a){B(this,a)}},
h.prototype.enable=function(){try{r(this,!1)}catch(a){B(this,a)}},h.prototype.disable=function(){try{r(this,!0)}catch(a){B(this,a)}},h.prototype.dispose=function(){try{k(this)}catch(a){B(this,a)}finally{l(this)}};function i(a){Element.clearDom(a.element),a.inputGroup=Element.build("div",a.element,["input-group","date"]),a.input=Element.build("input",a.inputGroup,["form-control"],{type:"text"}),a.addon=Element.build("span",a.inputGroup,["input-group-btn"]),a.button=Element.build("button",a.addon,["btn","btn-icon"]),a.icon=Element.build("span",a.button),a.$input=b(a.input),a.$addon=b(a.addon)}function j(a,b){if(b){var c;a.options&&(c=a.options.format),a.options=b,a.options.oldFormat=c}l(a),o(a),p(a)}function k(a){a.changed.remove(),a.changed=null,a.invalid.remove(),a.invalid=null,a.clear.remove(),a.clear=null,l(a)}function l(a){m(a),n(a)}function m(a){a.$addon.off(),a.$input.off()}function n(a){a.picker&&(a.picker.destroy(),a.picker=null)}function o(a){
a.options.pickDate?(a.icon.classList.add("icon-calendar"),a.icon.classList.remove("icon-time-units")):(a.icon.classList.add("icon-time-units"),a.icon.classList.remove("icon-calendar"))}function p(a){a.picker=q(a),r(a,a.options.disabled),s(a)}function q(a){return a.$input.datetimepicker({pickDate:a.options.pickDate,pickTime:a.options.pickTime,useMinutes:a.options.useMinutes,useSeconds:a.options.useSeconds,minuteStepping:a.options.minuteStep,format:a.options.format,oldFormat:a.options.oldFormat,language:h.culture,useCurrent:a.options.useCurrent}),a.$input.data("DateTimePicker")}function r(a,b){a.picker&&b?a.picker.disable():a.picker&&!b&&a.picker.enable(),a.input.disabled=b,a.button.disabled=b}function s(a){a.$addon.click(u.bind(null,a)),a.$input.change(v),a.$input.on("dp.change",w.bind(null,a)),a.$input.on("blur",x.bind(null,a)),a.$input.on("dp.error",z.bind(null,a)),a.$input.on("dp.hide",y.bind(null,a)),a.$input.on("dp.clear",A.bind(null,a)),t(a)}function t(a){
Object.resolve(g).isMobile()&&(a.input.readOnly=!0)}function u(a){a.input.focus()}function v(a){a.stopPropagation()}function w(c,d){var e=d.oldDate?d.oldDate.toDate():null,f=d.date?d.date.toDate():null;a.defer(function(){b(c.input).removeClass("date-error"),c.input.style.border="1px solid #c0c5c5",c.input.style.padding="10px"}),c.changed.raise(c,e,f)}function x(a,b){a.blur.raise(a),b.stopPropagation()}function y(a,b){a.hide.raise(),b.stopPropagation()}function z(c,d){c.input.value||!c.input.value&&c.element.required?(c.invalid.raise(c,c.input.value),a.defer(function(){c.markValid||b(c.input).addClass("date-error")})):c.changed.raise(c,null,null)}function A(a,b){a.clear.raise(),b.stopPropagation()}function B(a,b){e.error(b.stack),a.errorNotificationHandler.addError({errorMessage:b.message,errorDetail:b.stack})}return h});
define('system/data/memory-object-storage',["require","exports"],function(require,exports){"use strict";var a=function(){function a(){}return a.prototype.getItem=function(a){var b=this.store[a];return void 0===b?null:b},a.prototype.setItem=function(a,b){this.store[a]=b},a.prototype.removeItem=function(a){delete this.store[a]},a}();exports.MemoryObjectStorage=a});
define('system/data/persistent-object-storage',["require","exports"],function(require,exports){"use strict";var a=function(){function a(a){this.store=a}return a.prototype.getItem=function(a){var b=this.store.getItem(a);return null===b?b:JSON.parse(b)},a.prototype.setItem=function(a,b){this.store.setItem(a,null===b?b:JSON.stringify(b))},a.prototype.removeItem=function(a){this.store.removeItem(a)},a}();exports.PersistentObjectStorage=a});
define('system/data/session-storage',["require","exports"],function(require,exports){"use strict";var a=function(){function a(){}return a.prototype.getItem=function(a){return sessionStorage.getItem(a)},a.prototype.setItem=function(a,b){sessionStorage.setItem(a,b)},a.prototype.removeItem=function(a){sessionStorage.removeItem(a)},a}();exports.SessionStorage=a});
define('system/data/local-storage',["require","exports"],function(require,exports){"use strict";var a=function(){function a(){}return a.prototype.getItem=function(a){return localStorage.getItem(a)},a.prototype.setItem=function(a,b){localStorage.setItem(a,b)},a.prototype.removeItem=function(a){localStorage.removeItem(a)},a}();exports.LocalStorage=a});
define('system/data/namespace-object-storage',["require","exports"],function(require,exports){"use strict";var a=function(){function a(a,b){this.namespace=a,this.store=b}return a.prototype.getItem=function(a){return this.store.getItem(this.toKey(a))},a.prototype.toKey=function(a){return this.namespace+"|"+a},a.prototype.setItem=function(a,b){this.store.setItem(this.toKey(a),b)},a.prototype.removeItem=function(a){this.store.removeItem(this.toKey(a))},a}();exports.NamespaceObjectStorage=a});
define('system/data/object-storage-factory',["require","exports","./memory-object-storage","./persistent-object-storage","./session-storage","./local-storage","./namespace-object-storage"],function(require,exports,a,b,c,d,e){"use strict";function f(){return new a.MemoryObjectStorage}exports.newMemoryStorage=f;function g(){return new b.PersistentObjectStorage(new c.SessionStorage)}exports.newSessionStorage=g;function h(){return new b.PersistentObjectStorage(new d.LocalStorage)}exports.newLocalStorage=h;function i(a,b){return new e.NamespaceObjectStorage(a,b)}exports.addNamespace=i});
define('security/model/saved-session',['require','exports','module','system/diagnostics/log-manager','ramda'],function(require,exports,module){"use strict";var a=require("system/diagnostics/log-manager"),b=a.getLogger(module.id),c=require("ramda"),d="meridium-session",e="meridium-culture",f="meridium-user-name",g="meridium-server-name",h="meridium-data-source",i="DSClipboard",j="meridium-logged-in-users",k=1e3,l=60,m=60,n=24;function o(){}o.prototype.saveSession=function(a){try{sessionStorage.setItem(d,JSON.stringify(a)),s(a.userId)}catch(a){b.error("Failed to save session to session storage - error:",a)}},o.prototype.getAllLoggedUsers=function(){return c.map(c.prop("userId"),p())};function p(){return JSON.parse(localStorage.getItem(j))}function q(a){localStorage.setItem(j,JSON.stringify(a))}var r=c.propEq("userId");function s(a){var b=p()||[],d=Date.now(),e=null,f=null;e=c.find(r(a),b),c.isNil(e)?b.push({userId:a,signin:d}):e.signin=d,f=t(b),q(f)}function t(a){return c.filter(u,a)}function u(a){return Date.now()-new Date(a.signin)<k*l*m*n*30}return o.prototype.getSession=function(){
try{return sessionStorage.getItem(d)}catch(a){return b.error("Failed to get session from session storage - error:",a),!1}},o.prototype.deleteSession=function(){try{sessionStorage.removeItem(d),sessionStorage.removeItem(i)}catch(a){b.error("Failed to remove session from session storage - error:",a)}},o.prototype.saveUserCulture=function(a){try{localStorage.setItem(e,a.licensedCultureId)}catch(a){b.error("Failed to save user culture to local storage - error:",a)}},o.prototype.getUserCulture=function(){try{return localStorage.getItem(e)}catch(a){return b.error("Failed to get user culture from local storage - error:",a),""}},o.prototype.saveUserId=function(a){try{localStorage.setItem(f,a)}catch(a){b.error("Failed to save user ID to local storage - error:",a)}},o.prototype.getUserId=function(){try{return localStorage.getItem(f)}catch(a){b.error("Failed to get user ID from local storage - error:",a)}},o.prototype.saveApiServer=function(a){try{localStorage.setItem(g,a)}catch(a){
b.error("Failed to save API server to local storage - error:",a)}},o.prototype.getApiServer=function(){try{return localStorage.getItem(g)}catch(a){b.error("Failed to get API server from local storage - error:",a)}},o.prototype.saveDatasource=function(a){try{localStorage.setItem(h,a)}catch(a){b.error("Failed to save datasource to local storage - error:",a)}},o.prototype.getDatasource=function(){try{return localStorage.getItem(h)}catch(a){return b.error("Failed to get datasource from local storage - error:",a),""}},new o});
define('security/view-models/application-reset',["require","exports","system/http/ajax-client","system/diagnostics/log-manager","system/data/object-storage-factory","application/application-context","../model/saved-session"],function(require,exports,a,b,c,d){"use strict";var e=require("../model/saved-session"),f=b.getLogger("security/view-models/application-reset");return function(){function b(){}return b.prototype.reset=function(){this.logSessionLogout(),e.deleteSession(),this.clearAjaxHeaders(),this.clearSavedTabIds(),this.asyncRefresh()},b.prototype.deleteSession=function(){e.deleteSession()},b.prototype.logSessionLogout=function(){f.info("Logged out session",e.getSession())},b.prototype.clearAjaxHeaders=function(){f.debug("SavedSession.getUserId() clearAjaxHeaders() :: "+e.getUserId()),a.clearHeaders()},b.prototype.clearSavedTabIds=function(){c.addNamespace("tab-bar",c.newSessionStorage()).removeItem("tab-ids")},b.prototype.asyncRefresh=function(){_.delay(this.refresh,250)},b.prototype.refresh=function(){var a=window
;f.debug("refresh() before redirect :: "+e.getUserId()+" / window.location :: "+window.location.toString()+" / window.location.pathname :: "+window.location.pathname.toString()),d.isAppHub?a.location="/logout":a.location=window.location.href.split("#")[0]},b}()});

define('text!licensing/views/licensing.html',[],function () { return '<div class="block licensing">\r\n    <mi-header>\r\n        <mi-breadcrumb delimiter="\\" id="licensing-breadcrumb" showfulltext></mi-breadcrumb>\r\n        <mi-title data-bind="attr : {title : translator.translate(\'ACTIVATE_LICENSES\')}"></mi-title>\r\n        <mi-tool-bar class="pull-right">\r\n            <button class="btn btn-text" data-bind="event: { click: $root.triggerLicenseDialog }, text: translator.translate(\'LOAD_LICENSE\')"></button>\r\n        </mi-tool-bar>\r\n    </mi-header>\r\n\r\n\r\n    <div class="licensing-inner block">\r\n        <div class="table-container">\r\n            <mi-resultgrid allowcolumnresizing=true\r\n                           allowcolumnreordering=true\r\n                           selectionmode=\'single\'\r\n                           showgroupingpanel=true\r\n                           hascolumnchooser=true>\r\n            </mi-resultgrid>\r\n\r\n        </div>\r\n\r\n    </div>\r\n\r\n</div>';});

define('licensing/services/licensing-service',['require','jquery','system/http/ajax-client','system/lang/object'],function(require){"use strict";var a=require("jquery"),b=require("system/http/ajax-client"),c="api/core/license/",d="installedModules",e="activateLicense";require("system/lang/object");function f(a){this.ajaxClient=a}return f.dependsOn=[b],f.prototype.getLicenses=function(){var b=this,e=a.Deferred(),f=c+d;return b.ajaxClient.get(f).done(function(a){e.resolve(a)}).fail(function(a){e.reject(a)}),e.promise()},f.prototype.saveLicenseActivatedata=function(b,d){var f=this,g={cache:!1,data:d,contentType:!1,processData:!1},h=a.Deferred(),i=c+e+"/"+b;return f.ajaxClient.post(i,"",g).done(function(a){h.resolve(a)}).fail(function(a){h.reject(a)}),h.promise()},f});
define('licensing/models/licensing-model',['require','knockout','kobindings','knockoutvalidation','system/globalization/translator'],function(require){"use strict";var a=require("knockout");require("kobindings"),require("knockoutvalidation");var b=require("system/globalization/translator");function c(){var c=this;c.translator=Object.resolve(b),c.customerPin=a.observable().extend({required:{message:c.translator.translate("LICENSE_REQ_CUSTPIN")}}),c.licenseFile=a.observable().extend({required:!0})}return c});

define('text!licensing/views/licensing-dialog.html',[],function () { return '<!-- This style will be removed later.  -->\r\n<div class="licensing licensing-form-container" data-bind="loading:isBusy">\r\n\r\n    <div class="content-section-1" data-bind="validationOptions: { insertMessages:false, decorateInputElement:true, decorateElement : true ,errorClass:\'has-error\', errorElementClass: \'has-error\',errorsAsTitle : false }">\r\n        <form role="form" id="licensingForm" class="block" novalidate="novalidate">\r\n            <div class="form-group" data-bind="validationElement: licensingModel.customerPin">\r\n                <label for="customerPin" class="control-label" data-bind="text:translator.translate(\'CUSTOMER_PIN\')+ \' *\'"></label>\r\n                <input type="text" class="form-control" id="customerPin" data-bind="value:licensingModel.customerPin, valueUpdate: \'input\'">\r\n                <span class="help-block" data-bind="validationMessage: licensingModel.customerPin"></span>\r\n            </div>\r\n            <div class="form-group" data-bind="validationElement: licensingModel.licenseFile">\r\n                <label for="licenseFile" class="control-label" data-bind="text:translator.translate(\'LICENSE_FILE\')"></label>\r\n                <input type="file" class="form-control" id="licenseFile" accept="text/plain" data-bind="value:licensingModel.licenseFile">\r\n                <div><small  data-bind="text:translator.translate(\'LICENSING_COMPLT_FILE\')"></small></div>\r\n            </div>\r\n\r\n        </form>\r\n    </div>\r\n\r\n\r\n    <div class="pull-right">\r\n        <button type="button" class="btn btn-default" data-bind="click:addLicense.bind($root),text:translator.translate(\'FAMILY_STATE_MANAGEMENT_BTN_OK\')"></button>\r\n        <button type="button" class="btn btn-default" data-bind="click:cancel.bind($root),text:translator.translate(\'FAMILY_STATE_MANAGEMENT_BTN_CANCEL\')"></button>\r\n    </div>\r\n\r\n</div>';});

define('licensing/licensing-dialog-view-model',['require','jquery','knockout','spa/ko/knockout-view-model','system/knockout/knockout-manager','application/application-events','system/ui/dialog-view-model','licensing/models/licensing-model','licensing/services/licensing-service','text!./views/licensing-dialog.html','system/error/error-message','system/globalization/translator','toastr','knockoutvalidation'],function(require){"use strict";var a=require("jquery"),b=require("knockout"),c=require("spa/ko/knockout-view-model"),d=require("system/knockout/knockout-manager"),e=require("application/application-events"),f=require("system/ui/dialog-view-model"),g=require("licensing/models/licensing-model"),h=require("licensing/services/licensing-service"),i=require("text!./views/licensing-dialog.html"),j=require("system/error/error-message"),k=require("system/globalization/translator"),l=require("toastr"),m="meridium-session";require("knockoutvalidation");function n(a,c,d,e){var f=this;o.call(this,i),f.isBusy=b.observable(!1),f.translator=c,f.kom=a,f.applicationEvents=d,f.titleChanged=d.titleChanged,f.licensingService=e,f.licensingModel=null,f.dialog=null}n.dependsOn=[d,k,e,h];var o=Object.inherit(c,n);n.prototype.attach=function a(b){var c=this;o.prototype.attach.call(this,b),c.region=b},n.prototype.show=function b(c,d){var e=this;return e.licensingModel=new g,e.dialog=new f(this,c,{
height:"45%",width:"50%"}),e.dialog.show(),e.dfd=a.Deferred(),e.dfd.promise()},n.prototype.addLicense=function a(c,d){var e=!0,f=null,g=c.region.$element.find("#licensingForm");if(f=b.validation.group(c.licensingModel),f().length>0)return e=!1,f.showAllMessages(),!1;if(e||e&&13===d.which){var h=c.licensingModel.licenseFile();h&&(p(c,h)?(g.on("submit",c.uploadLicenseActivation()),c.isBusy(!0)):g.off("submit",c.uploadLicenseActivation))}},n.prototype.uploadLicenseActivation=function a(){var b=this,c=b.region.$element.find("#licensingForm"),d=new FormData(c[0]),e=b.region.$element.find("#licenseFile")[0];d.append(" ",e.files[0]),b.licensingService.saveLicenseActivatedata(b.licensingModel.customerPin(),d).done(function(){l.success(b.translator.translate("LICENSE_ACT_SUCCESS_MSG")),b.dialog.closeDialog(),b.isBusy(!1),b.dfd.resolve()}).fail(function(a){q(b,a),b.isBusy(!1),b.dfd.reject()})},n.prototype.cancel=function a(){this.dialog.closeDialog(),this.dfd.reject()};function p(a,b){var c=!1
;return b?b.indexOf(".txt")>=0&&(c=!0):alert(a.translator.translate("LICENSING_FILE_EXTENSION_ALERT")),!!c||(b?(alert(a.translator.translate("LICENSING_FILE_EXTENSION_ALERT")),!1):void 0)}function q(a,b){var c=2,d=b.statusText,e=new j(c,d);a.applicationEvents.errorOccured.raise(a,e)}return n});
define('dcm/utility/utility',['require','lodash','jquery','system/lang/object','knockout','system/globalization/translator','application/application-events','application/application-context','xss'],function(require){"use strict";var a=require("lodash"),b=require("jquery");require("system/lang/object");var c=require("knockout"),d=Object.resolve(require("system/globalization/translator")),e=require("application/application-events"),f=require("application/application-context"),g=require("xss");function h(){var a=this;a.groupsToVerify=[],a.moduleListAndGroups={systemcodetable:["MI Configuration Role","MI APMNow Admin"],familymanagement:["MI Configuration Role","MI APMNow Admin"],uom:["MI Configuration Role","MI APMNow Admin"],ssrs:["MI Configuration Role"],scheduling:["MI Configuration Role","MI APMNow Admin"],activatelicense:["MI Configuration Role"],monitoring:["MI Configuration Role"],querytimeout:["MI Configuration Role","MI APMNow Admin"],importexport:["MI Configuration Role","MI Security Role","MI Power User Role"]},a.listVal=[d.translate("ASSOC_PAGE_ALL_THE_TIME"),d.translate("ASSOC_PAGE_ONE_RECORD_SELECTED"),d.translate("ASSOC_PAGE_SUPER_OR_MIPOWERUSER")]}
h.prototype.userHasAccess=function b(c,module){var d=this,e=!1,f=a.map(c.groups,"id");return d.groupsToVerify=[],!!c.isSuperUser||(d.groupsToVerify=d.moduleListAndGroups[module.toLowerCase()],a.each(f,function(b){a.includes(d.groupsToVerify,b)&&(e=!0)}),e)},h.prototype.groupCheck=function b(){var c,d=a.map(f.user.groups,"id");return a.each(d,function(b){a.includes("MI APMNow Admin",b)&&(c=!0)}),c},h.prototype.rectifyXSSAttack=function a(c){var d="function"==typeof c,e;if(e=g(d?c():c),e.indexOf("href")>-1){""===b(e).attr("href")&&(e=e.replace(/href/g,""))}return d?c(e):e},h.prototype.setQueryParameters=function b(d,e){var f,g,h,i=d;i.queryHasPrompt(!0);for(var j=0;j<e.length;j++)h=""!==e[j].id?e[j].id:""!==e[j].caption?e[j].caption:e[j].fieldId,f={id:e[j].id,displayCaption:h,fieldId:e[j].fieldId,value:c.observable(""),paramValueFamilyFields:c.observableArray([])},g=k(i,e[j]),f.paramValueFamilyFields(a.filter(i.familyFields,l.bind(null,g))),f.paramValueFamilyFields.splice(0,0,{key:"",
caption:""}),f.value.subscribe(m.bind(null,i)),i.queryParameters.push(f)},h.prototype.setListValueWithParameters=function a(b){for(var c="",d=b,e=d.queryParameters(),f=0;f<e.length;f++)c+=e[f].id+" ~ "+e[f].fieldId+" ~ "+e[f].value(),f!==e.length-1&&(c+="|");d.validValueInput(c)},h.prototype.setCascadingList=function a(b,c,d){var e,f,g=b;d&&(e=d.query.layout.queryContainer,f=e.parmContainer.parmDesigns,g.validValue("QueryList"),g.validValueInput(d.path),g.queryHasPrompt(!0),g.queryParameters(i(g,c.listValue,f)),g.behaviorChanges(!1))};function i(b,d,e){for(var f=d.split("|"),g=b,h=[],i,n,o,p,q,r=0;r<f.length;r++)i=f[r].split("~"),n={id:i[0].trim(),fieldId:i[1].trim(),value:c.observable(i[2].trim()),paramValueFamilyFields:c.observableArray([])},p=j(e,n.fieldId),q=""!==p.id?p.id:""!==p.caption?p.caption:p.fieldId,n.displayCaption=q,o=k(g,p),n.paramValueFamilyFields(a.filter(g.familyFields,l.bind(null,o))),n.paramValueFamilyFields.splice(0,0,{key:"",caption:""}),
n.value.subscribe(m.bind(null,g)),h.push(n);return h}function j(a,b){for(var c=0;c<a.length;c++)if(a[c].fieldId===b)return a[c]}function k(a,b){var c=a;if(b)for(var d=0;d<c.dataTypes.length;d++)if(c.dataTypes[d].text===b.dataType)return c.dataTypes[d].id}function l(a,b){return b.dataType===a}function m(a){a.behaviorChanges(!0)}return h});
define('ui/elements/breadcrumb-item/view-model',['jquery','system/lang/converter'],function(){"use strict";var a=require("jquery"),b=require("system/lang/converter"),c=Object.create(HTMLElement.prototype);c.createdCallback=function(){var b,c,e;this.$el=a(this),this.className="breadcrumb-item",b=document.createElement("span"),this.appendChild(b),c=document.createElement("span"),c.className="text",b.appendChild(c),e=document.createElement("span"),e.className="delimiter",b.appendChild(e),this.delimiter=this.getDelimiter(),this.isActive=this.getIsActive(),d(this)},c.attachedCallback=function(){this.firstElementChild.addEventListener("click",this)},c.attributeChangedCallback=function(a,b,c){"delimiter"===a?(this.delimiter=c,f(c)):"active"===a&&(this.isActive=this.getIsActive(),this.isActive===!0?g(this):h(this))},c.handleEvent=function(a){var b;"click"===a.type&&(b=new CustomEvent("click",{detail:this.value,bubbles:!0}),this.dispatchEvent(b))},c.getDelimiter=function a(){return this.getAttribute("delimiter")},c.getIsActive=function a(){
return b.toBoolean(this.getAttribute("active"),"true")};function d(a){a._value=null,Element.defineProperty(a,"value",{get:function(){return this._value}.bind(a),set:function(a){this._value=a,e(this),f(this)}.bind(a)})}function e(a){var b;a.value&&(b=a.value.displayValue,a.querySelector(".text").textContent=b)}function f(a){a.value&&(a.querySelector(".delimiter").textContent=" "+a.delimiter+" ")}function g(a){a.$el.css("display","inline-block")}function h(a){a.$el.css("display","none")}return document.registerElement("mi-breadcrumb-item",{prototype:c}),c});
define('ui/elements/more-options-item/view-model',['jquery','system/lang/converter'],function(){"use strict";var a=require("jquery"),b=require("system/lang/converter"),c=Object.create(HTMLElement.prototype);c.createdCallback=function(){var b,c,e;this.$el=a(this),this.className="moreoptions-item",this.display="block",e=document.createElement("span"),e.className="icon",c=document.createElement("span"),c.className="text",this.appendChild(e),this.appendChild(c),d(this)},c.attachedCallback=function(){},c.attributeChangedCallback=function(a,b,c){};function d(a){a._value=null,Element.defineProperty(a,"value",{get:function(){return this._value}.bind(a),set:function(a){this._value=a,e(this,a)}.bind(a)})}function e(a,b){var c;a.value&&(a.querySelector(".text").textContent=b.text,a.querySelector(".icon").className=b.icon)}return document.registerElement("mi-more-options-item",{prototype:c}),c});
define('ui/elements/more-options/more-options',['require','lodash','jquery','system/lang/converter','system/globalization/translator','../more-options-item/view-model'],function(require){"use strict";var a=require("lodash"),b=require("jquery"),c=require("system/lang/converter"),d=require("system/globalization/translator");require("../more-options-item/view-model");var e=Object.create(HTMLElement.prototype);e.createdCallback=function(){var c,d;c=this,c.internalIcon=null,c._disabled=b(c).is("[disabled]"),c._noaccess=null,c._text=null,this.isOpen=!1,this._options=[],o(this),b(this).empty(),d=i(this),this.appendChild(d),this.resizeProxy=b.proxy(a.debounce(this.resize,100),this),this.scrollProxy=b.proxy(this.scroll,this),this.ctrlOffset=null,this.ctrlWidth=null,this.optionsWidth=null,this.optionsHeight=null,this.optionsTop=null,this.optionsLeft=null,this.outerContainer=null,this.docClickHandler=h.bind(null,this),Element.defineProperty(c,"moreoptionsCB",{get:g.bind(null,c),set:c.handlemoreoptionsCB.bind(c)}),Element.defineProperty(c,"options",{get:function(){return c._options}.bind(c),set:function(a){f(c,a)}.bind(c)}),
Element.defineProperty(c,"icon",{get:function(){return c.internalIcon}.bind(c),set:function(a){j(c,a)}.bind(c)}),Element.defineProperty(c,"text",{get:function(){return c._text}.bind(c),set:function(a){k(c,a)}.bind(c)}),Element.defineProperty(c,"disabled",{get:function(){return c._disabled}.bind(c),set:function(a){l(c,a)}.bind(c)}),Element.defineProperty(c,"noaccess",{get:function(){return c._noaccess}.bind(c),set:function(a){m(c,a)}.bind(c)}),Element.defineProperty(c,"tooltip",{get:function(){}.bind(c),set:function(a){n.call(null,c,a)}.bind(c)}),c.internalIcon||j(c,null)},e.attachedCallback=function(){u(this).addEventListener("mousedown",this),b(document).on("mousedown.mi_opt",this.docClickHandler)},e.attributeChangedCallback=function(a,b,d){var e=this;if("disabled"===a){l(e,c.toBoolean(d,"true"))}else if("noaccess"===a){var f=c.toBoolean(d,"true");m(e,f)}else"icon"===a?j(e,d):"text"===a&&k(e,d)},e.handlemoreoptionsCB=function(a,b){this.callback=a};function f(a,b){a._options=b}
e.detachedCallback=function(){var a=u(this);a&&a.removeEventListener("mousedown",this),b(document).off("mousedown.mi_opt",this.docClickHandler),b(this.contentContainer).remove(),this.isOpen=!1},e.handleEvent=function(a){"mousedown"===a.type&&(a.stopPropagation(),this.loader&&this.reload())},e.optionClicked=function(a,b){b.stopPropagation(),a.disabled!==!0&&a.noaccess!==!0&&(s(this),Object.tryMethod(this,"callback",a))},e.reload=function(){this.load().done()},e.load=function(){var a;return this.disabled?b.Deferred().done().promise():this.loader?this.isOpen?(b(window).off("resize",this.resizeProxy),b(this).parents().off("scroll",this.scrollProxy),a=this.loader(),a.done(s.bind(null,this)),a.promise()):(b(window).on("resize",this.resizeProxy.bind(null,this)),b(this).parents().on("scroll",this.scrollProxy.bind(null,this)),a=this.loader(),a.done(r.bind(null,this)),a.promise()):b.Deferred().done().promise()},e.resize=function(a){b(a).find(".mi-more-options-icon").is(":visible")?v(this):s(a)},
e.deallocateMem=function(){var a=this;a.internalIcon=null,a.isOpen=null,a.ctrlOffset=null,a.ctrlWidth=null,a.optionsWidth=null,a.optionsHeight=null,a.optionsTop=null,a.optionsLeft=null,a.outerContainer=null,a.disabled=null,a.options=null,a.contentContainer&&(a.contentContainer=null),a.isClicked&&(a.isClicked=null),a.callback=null,a.loader=null,a.scrollProxy=null,a.resizeProxy=null,a.icon=null,a.tooltip=null},e.scroll=function(a){s(a),a.isOpen=!1};function g(a){return a.handlemoreoptionsCB}function h(a,c){a.isClicked?a.isClicked=!1:a.isOpen&&(b(c.target).hasClass("more-options-content")||(b(".more-options-outer-container").remove(),a.isOpen=!1))}function i(a){var b,c,d,e;return b=document.createElement("button"),b.className="mi-more-options-icon btn btn-icon",c=document.createElement("i"),b.appendChild(c),b}function j(a,c){a.internalIcon=c?c.trim():"icon-options",b(a).find("button i").removeAttr("class").addClass(a.internalIcon)}function k(a,c){c&&(a._text=c.trim(),
b(a).find("button").text(a._text),b(a).find("button").attr("title",a._text),b(a).find("button").append('<i class="icon-tree-collapse"></i>'),b(a).find("button").removeClass("btn-icon").addClass("btn-text"))}function l(a,c){void 0!==c&&(a._disabled=c),a._disabled?b(a).find("button").addClass("disabled"):b(a).find("button").removeClass("disabled")}function m(a,c){a._noaccess=c,c?b(a).find("button").addClass("no-access"):b(a).find("button").removeClass("no-access")}function n(a,c){c&&b(a).find("button").attr("title",c)}function o(a){a._loader=null,Element.defineProperty(a,"loader",{get:p.bind(null,a),set:q.bind(null,a)})}function p(a){return a._loader}function q(a,b){a._loader=b}function r(a,c){var d,e,f,g,h,i,j,k=u(a),l=0;if(a._options=c,!c.length)return void(a.isOpen=!1);if(a.isOpen=!a.isOpen,a.isClicked=!0,b(document).trigger("mousedown.mi_opt"),f=document.createElement("div"),b(f).addClass("more-options-outer-container"),a.contentContainer=b(f),g=document.createElement("ul"),
b(g).addClass("more-options-content"),k){for(d=0;d<c.length;d++)e=document.createElement("mi-more-options-item"),h=document.createElement("li"),c[d].disabled&&b(h).addClass("disabled"),c[d].noaccess?l++:(h.addEventListener("mousedown",function(a){a.stopPropagation()}.bind(a),!1),h.addEventListener("click",function(c){if("click"===c.type){var d=b(c.currentTarget).find("mi-more-options-item")[0].value;a.optionClicked(d,c)}}.bind(a),!1),t(a,e,d,c.length),h.appendChild(e),g.appendChild(h),e.value=c[d]);0!==c.length&&c.length===l&&(e=document.createElement("mi-more-options-item"),h=document.createElement("li"),b(h).addClass("no-access"),h.appendChild(e),g.appendChild(h))}f.appendChild(g),document.body.appendChild(f),v(a)}function s(a){a.isOpen=!a.isOpen,b(a.contentContainer).remove()}function t(a,b,c,d){var e,f;b.setAttribute("index",c)}function u(a){var b=a.querySelectorAll(".mi-more-options-icon");return 0===b.length?null:b[b.length-1]}function v(a){var c=50,d,e;w(a),x(a),
a.ctrlOffset&&a.ctrlOffset.top+a.optionsHeight+c>=b(window).height()?(y(a),b(a.outerContainer).find(".more-options-content").css({"box-shadow":"0px 0px 12px 6px rgba(0, 0, 0, 0.175)","-webkit-box-shadow":"0px 0px 12px 6px rgba(0, 0, 0, 0.175)"})):z(a),a.height&&b(a.outerContainer).find(".more-options-content").css({maxHeight:a.height})}function w(a){a.outerContainer=b(a.contentContainer),a.ctrlOffset=b(a).find(".mi-more-options-icon").offset(),a.ctrlWidth=b(a).find(".mi-more-options-icon").width(),b(a.outerContainer).css({position:"absolute"}),a.optionsWidth=b(a.outerContainer).width(),a.optionsHeight=b(a.outerContainer).height()}function x(a){b(a.outerContainer).find(".more-options-content").removeClass("top-left top-right bottom-left bottom-right")}function y(a){var b;a.ctrlOffset&&(b=a.ctrlOffset.top-a.optionsHeight-10,a.ctrlOffset&&a.ctrlOffset.left+a.ctrlWidth-a.optionsWidth<80?A(a,"top-left",b):B(a,"top-right",b))}function z(a){var b;a.ctrlOffset&&(b=a.ctrlOffset.top+50-6,
a.ctrlOffset&&a.ctrlOffset.left+a.ctrlWidth-a.optionsWidth<80?A(a,"bottom-left",b):B(a,"bottom-right",b))}function A(a,b,c){var d;d=a.ctrlOffset.left,C(a,b),D(a,d,c)}function B(a,b,c){var d;d=a.ctrlOffset.left-Math.abs(a.ctrlWidth-a.optionsWidth),d=a.text?d+37:d,C(a,b),D(a,d,c)}function C(a,c){var d;d=b(a.outerContainer).find(".more-options-content"),b(d).addClass(c)}function D(a,c,d){b(a.outerContainer).css({left:c,top:d})}return document.registerElement("mi-more-options-noko",{prototype:e}),e});
define('ui/elements/breadcrumb/view-model',['require','jquery','system/lang/converter','system/globalization/translator','ui/elements/breadcrumb-item/view-model','ui/elements/more-options/more-options'],function(require){"use strict";var a=require("jquery"),b=require("system/lang/converter"),c=require("system/globalization/translator");require("ui/elements/breadcrumb-item/view-model"),require("ui/elements/more-options/more-options");var d=Object.create(HTMLElement.prototype);d.createdCallback=function(){var a,b;e(this),a=document.createElement("div"),a.className="breadcrumb-group-container",this.appendChild(a),b=document.createElement("div"),b.className="breadcrumb-group",a.appendChild(b),this.delimiter=this.getDelimiter(),this.loader&&this.reload()},d.attachedCallback=function(){r(this).addEventListener("click",this)},d.attributeChangedCallback=function(a,b,c){},d.handleEvent=function(a){"click"===a.type&&"MI-BREADCRUMB-ITEM"===a.target.tagName&&q(this,a)},d.reload=function(){this.load().done()},d.pause=function(){this.paused=!0},d.resume=function(){this.paused=!1},d.load=function(){var b;return this.loader?(this.pause(),b=this.loader(),b.done(l.bind(null,this)),
b.promise()):a.Deferred().done().promise()},d.getDelimiter=function a(){return this.getAttribute("delimiter")},d.moreOptionsLoader=function(){var b=a.Deferred(),c,d=[],e;for(c=0;c<this.data.length-2;c++)e={},a.extend(e,this.data[c]),e.type="text",e.text=m(this.data[c].text,this),d.push(e);return b.resolve(d),b};function e(a){a.paused=!1,a._loader=null,Element.defineProperty(a,"loader",{get:f.bind(null,a),set:g.bind(null,a)}),a._value=null,Element.defineProperty(a,"value",{get:h.bind(null,a),set:i.bind(null,a)}),Element.defineProperty(a,"items",{get:j.bind(null,a),set:k.bind(null,a)})}function f(a){return a._loader}function g(a,b){a._loader=b,a.reload()}function h(a){return a._value}function i(a,b){a._value=b}function j(a){var b=r(a),c,d=[],e;if(b)for(c=b.querySelectorAll("mi-breadcrumb-item"),e=0;e<c.length;e++)d[d.length]=c[e].value;return d}function k(a,b){var c=r(a);c&&(Element.clearDom(c),b&&l(a,b))}function l(a,b){var c,d,e=r(a),f=a.getAttribute("delimiter");if(a.data=b,
e)for(b.length>2&&n(a,e),c=0;c<b.length;c++)d=document.createElement("mi-breadcrumb-item"),p(a,d,c,b.length),e.appendChild(d),b[c].displayValue=m(b[c].text,a),d.value=b[c]}function m(a,b){var c,d=10,e=d/2,f=a.length,g=e,h=a.length-e;return f>d&&null===b.getAttribute("showfulltext")?a.substr(0,g)+"..."+a.substr(h,f):a}function n(b,c){var d=a("<div/>").attr("data-bind","halt-bindings").css("display","inline-block"),e=a("<mi-more-options-noko/>");e.prop("icon","icon-more"),window.CustomElements&&!window.CustomElements.useNative&&window.CustomElements.upgrade(e.get(0)),b.moreOptions=e.get(0),b.moreOptions.loader=b.moreOptionsLoader.bind(b),d.append(e),b.moreOptions.moreoptionsCB(o.bind(null,b)),c.appendChild(d[0])}function o(a,b){a.selectedCallback&&a.selectedCallback(b)}function p(a,b,c,d){var e,f;b.setAttribute("index",c),b.setAttribute("delimiter",a.delimiter),c>d-3?b.setAttribute("active","true"):b.setAttribute("active","false")}function q(a,b){
a.selectedCallback&&a.selectedCallback(b.detail)}function r(a){var b=a.querySelectorAll(".breadcrumb-group");return 0===b.length?null:b[b.length-1]}return document.registerElement("mi-breadcrumb",{prototype:d}),d});

define('text!ui/elements/header/header-template.html',[],function () { return '<div class="header-container">\r\n</div>';});


define('text!ui/elements/header/title/title-template.html',[],function () { return '<div class="title-container">\r\n    <h1></h1>\r\n</div>';});

define('ui/elements/header/title/title-view-model',['require','jquery','text!./title-template.html'],function(require){"use strict";var a=require("jquery"),b=require("text!./title-template.html"),c={};c.prototype=Object.create(HTMLElement.prototype),c.prototype.createdCallback=function(){var c=this,e="",f=null;a(c).html(b),(e=a(c).attr("title"))&&(c.querySelector("h1").textContent=e,d(c))},c.prototype.attributeChangedCallback=function(a,b,c){var e=this;"title"===a&&(e.querySelector("h1").textContent=c,d(e))},c.prototype.repaint=function(){d(this)};function d(b){for(var c=e(b),d=0,h=f(b),i,j=0;j<h;j++)i=a(a(b).nextAll().not("mi-sub-title, .custom-subtitle")[j]),d+=a(i).innerWidth();d=d+30+"px"||"30px",g(b,c,d)}function e(b){return a(b).parent().find("mi-icon .icon-container").css("width")||"0px"}function f(b){return a(b).nextAll().not("mi-sub-title, .custom-subtitle").length}function g(b,c,d){a(b).find(".title-container").css("width","calc(100% - "+c+" - "+d+")")}function h(a,b){a.querySelector("h1").textContent=b}return document.registerElement("mi-title",{prototype:c.prototype
}),c});

define('text!ui/elements/header/sub-title/sub-title-template.html',[],function () { return '<div class="sub-title-container">\r\n    <h3></h3>\r\n</div>';});

define('ui/elements/header/sub-title/sub-title-view-model',['require','jquery','text!./sub-title-template.html'],function(require){"use strict";var a=require("jquery"),b=require("text!./sub-title-template.html"),c={};c.prototype=Object.create(HTMLElement.prototype),c.prototype.createdCallback=function(){var c=this,f="",g=null;Object.defineProperty(c,"subtitle",{get:function(){return c.internalSubTitle}.bind(c),set:function(a){d.call(null,c,a)}.bind(c)}),a(c).html(b),f=a(c).attr("subtitle"),a(c).attr("title",f),f&&(a(c).find("h3").html(f),e(c))},c.prototype.attributeChangedCallback=function(b,c,d){var f=this;"subtitle"===b&&(a(f).find("h3").html(d),a(f).attr("title",d),e(f))},c.prototype.repaint=function(){e(this)};function d(b,c){a(b).find("h3").html(c),a(b).attr("title",c),e(b)}function e(b){for(var c=f(b),d=0,e=g(b),i,j=0;j<e;j++)i=a(a(b).nextAll()[j]),d+=a(i).width();d=d+30+"px"||"30px",h(b,c,d)}function f(b){return a(b).parent().find("mi-icon .icon-container").css("width")||"0px"}function g(b){return a(b).nextAll().length}function h(b,c,d){
a(b).find(".sub-title-container").css("width","calc(100% - "+c+" - "+d+")")}return document.registerElement("mi-sub-title",{prototype:c.prototype}),c});

define('text!ui/elements/header/icon/icon-template.html',[],function () { return '<div class="icon-container">\r\n    <button  class=" btn btn-icon">\r\n        <i></i>\r\n    </button>\r\n</div>\r\n\r\n';});

define('ui/elements/header/icon/icon-view-model',['require','jquery','text!./icon-template.html'],function(require){"use strict";var a=require("jquery"),b=require("text!./icon-template.html"),c={};c.prototype=Object.create(HTMLElement.prototype),c.prototype.createdCallback=function(){var c=this,e=this,f="",g=null;Object.defineProperty(c,"icon",{get:function(){return c.internalIcon}.bind(c),set:function(a){d.call(null,c,a)}.bind(c)}),a(c).html(b),f=a(c).attr("icon"),f?a(c).find("button i").addClass(f):a(c).find("button i").addClass("icon-less-than")},c.prototype.attributeChangedCallback=function(b,c,d){var e=this;"icon"===b&&a(e).find("button i").removeClass().addClass(d)};function d(b,c){c?a(b).find("button i").removeClass().addClass(c):a(b).find("button i").removeClass().addClass("icon-less-than")}return document.registerElement("mi-icon",{prototype:c.prototype}),c});
define('ui/elements/header/header-view-model',['require','jquery','text!./header-template.html','ui/elements/header/title/title-view-model','ui/elements/header/sub-title/sub-title-view-model','ui/elements/header/icon/icon-view-model','ui/elements/breadcrumb/view-model'],function(require){"use strict";var a=require("jquery"),b=require("text!./header-template.html");require("ui/elements/header/title/title-view-model"),require("ui/elements/header/sub-title/sub-title-view-model"),require("ui/elements/header/icon/icon-view-model"),require("ui/elements/breadcrumb/view-model");var c={};c.prototype=Object.create(HTMLElement.prototype),c.prototype.createdCallback=function(){a(this).wrapInner(b)},c.prototype.attachedCallback=function(){var b=this;this.icon=a(this).find("mi-icon")[0],this.breadcrumbEl=a(this).find("mi-breadcrumb")[0],this.titleEl=a(this).find("mi-title")[0],this.breadcrumbEl?this.titleEl||f(this):e(this),a(this.icon).on("click",function(){b.dispatchEvent(new CustomEvent("icon-clicked",{bubbles:!0}))});var c=a(this).find("mi-title")[0];c&&d(c);var g=a(this).find("mi-sub-title")[0];g&&d(g)};function d(a){a.observer=new MutationObserver(function(a,b){a.forEach(function(a){a.target.repaint(a.target)})}.bind(a));var b={attributes:!0,
childList:!0,characterData:!1};a.observer.observe(a,b)}function e(b){var c=a(b).find(".header-container");a(c).prepend('<div class="breadcrumb-group-container">    <div class="breadcrumb-group" style="display: none;"></div>   </div>'),a(b.icon).find(".icon-container").css("margin-top","-24px")}function f(b){a(b.breadcrumbEl).find(".breadcrumb-group").css("margin-top","24px")}return document.registerElement("mi-header",{prototype:c.prototype}),c});

define('text!ui/elements/resultgrid/resultgrid-template.html',[],function () { return '\r\n<div class="rg-header">\r\n    <div data-bind="halt-bindings" class="rg-pager" >\r\n        <mi-select data-bind="miproperty:{\r\n                           options: listObjects,\r\n                           optionsText: \'displayName\',\r\n                           optionsValue: optionsValue,\r\n                           value: selectedValue,\r\n                           editable: false\r\n                           }">\r\n        </mi-select>\r\n        <div class="totalCount">\r\n            <div data-bind="text: $root.translator.translate(\'OF\')"></div>\r\n            <div data-bind="text: customTotalCount"></div> \r\n            <div data-bind="text: $root.translator.translate(\'RECORDS\')"></div>\r\n         </div>\r\n      </div>\r\n   \r\n        <!--<button class="btn btn-icon pull-right rg-filter" data-bind="attr: {title : \'Filter\'}">\r\n            <i class="icon-collection-filter" ></i>\r\n        </button>-->\r\n    </div>\r\n<div class="gridContainer" style="display:block;height:100%;width:100%;"></div>\r\n<div class="rg-footer">\r\n    <div class="rg-controls" >\r\n        <span class="dxDataGridTotalCount pull-left" style="height: 25px;display:none;"></span>\r\n    </div>\r\n\r\n</div>';});

define('ui/elements/resultgrid/resultgrid-service',['require','jquery','system/lang/object','system/http/ajax-client'],function(require){"use strict";var a=require("jquery");require("system/lang/object");var b=require("system/http/ajax-client");function c(a){this.ajaxClient=a,this.API_URL="api/core/command/query"}return c.dependsOn=[b],c.prototype.getData=function(b){var c=a.Deferred(),d=this.API_URL,e={CommandText:b.query,Parameters:[],StartRow:b.startRow,MaxRows:b.maxRows};return this.ajaxClient.post(d,e).done(function(a){c.resolve(a)}).fail(function(a){c.reject(a.statusText)}),c.promise()},c});
define('ui/elements/page-filter/page-filter-remote',['require','jquery'],function(require){"use strict";var a=require("jquery");function b(){this.pageFilter=null}b.prototype.connect=function a(b){this.pageFilter=c(b)};function c(b){var c;return c=a(b).closest("mi-page-filter").get(0)||null,null===c?a(b).closest("mi-et-page-filter").get(0)||null:c}return b.prototype.isConnected=function a(){return null!==this.pageFilter},b});
define('ui/elements/page-filter/page-filter-connection',['require','./page-filter-remote'],function(require){"use strict";var a=require("./page-filter-remote");function b(){this.callback=null,this.element=null,this.filter=null,this.remote=Object.resolve(a)}return b.prototype.open=function a(b,c){this.callback=b,this.element=c,this.remote.connect(c),this.filter=this.remote.pageFilter,this.remote.isConnected()?this.filter.connect(this):this.publish()},b.prototype.close=function a(){this.filter&&this.filter.disconnect(this),this.filter=null,this.element=null,this.callback=null},b.prototype.publish=function a(b){this.callback(b)},b.prototype.isSame=function a(b){return this===b},b});
define('query/services/dto/column-dto',['require','system/lang/converter'],function(require){"use strict";var a=require("system/lang/converter");function b(b){b=b||{},this.caption=a.toString(b.caption),this.defaultCaption=a.toString(b.defaultCaption),this.dataType=a.toString(b.dataType),this.isInactive=a.toBoolean(b.isInactive),this.id=a.toString(b.id)}return b.fromDataCollection=function a(c){if(c){var d,e=[];for(d=0;d<c.length;d++)e[e.length]=new b(c[d]);return e}},b});
define('query/services/dto/table-design-dto',['require','system/lang/converter','./column-dto'],function(require){"use strict";var a=require("system/lang/converter"),b=require("./column-dto");function c(c){c=c||{},c.showAllFields||c.showAllFields===!1||(c.showAllFields=!0),c.showDataFields||c.showDataFields===!1||(c.showDataFields=!1),c.showInactiveFields||c.showInactiveFields===!1||(c.showInactiveFields=!1),c.showSystemFields||c.showSystemFields===!1||(c.showSystemFields=!1),this.alias=a.toString(c.alias),this.caption=a.toString(c.caption),this.defaultCaption=a.toString(c.defaultCaption),this.datasheetId=a.toString(c.datasheetId),this.id=a.toString(c.id),this.key=a.toString(c.key),this.layoutX=a.toInteger(c.layoutX),this.layoutY=a.toInteger(c.layoutY),this.name=a.toString(c.name),this.queryColumns=b.fromDataCollection(c.queryColumns),this.showAllFields=a.toBoolean(c.showAllFields),this.showDataFields=a.toBoolean(c.showDataFields),this.showInactiveFields=a.toBoolean(c.showInactiveFields),this.showSystemFields=a.toBoolean(c.showSystemFields),
this.storedQueryPath=a.toString(c.storedQueryPath),this.tableType=a.toString(c.tableType),this.queryColumns&&(this.queryColumns=this.queryColumns.sort(d))}c.fromDataCollection=function a(b){if(b){var d,e=[];for(d=0;d<b.length;d++)e[e.length]=new c(b[d]);return e}};function d(a,b){var c=a.caption.toLowerCase(),d=b.caption.toLowerCase(),e=!1,f=!1;return c.indexOf("[")===-1&&c.indexOf("{")===-1||(e=!0,c=c.slice(1,c.length-1)),d.indexOf("[")===-1&&d.indexOf("{")===-1||(f=!0,d=d.slice(1,d.length-1)),e&&f||!e&&!f?c===d?0:c<d?-1:1:e?-1:1}return c});
define('query/services/dto/query-criteria-dto',['require','lodash','system/lang/converter'],function(require){"use strict";var a=require("lodash"),b=require("system/lang/converter");function c(b){b=b||{},this.expressions=a.isArray(b.expressions)?b.expressions:[b.expressions]}return c.fromDataCollection=function a(b){if(b){var d,e=[];for(d=0;d<b.length;d++)e[e.length]=b[d]?new c(b[d]):null;return e}},c});
define('query/services/dto/column-design-dto',['require','lodash','system/lang/converter','./column-dto','./query-criteria-dto'],function(require){"use strict";var a=require("lodash"),b=require("system/lang/converter"),c=require("./column-dto"),d=require("./query-criteria-dto");function e(e){e=e||{},this.alias=b.toString(e.alias,null),this.caption=b.toString(e.caption,null),this.defaultCaption=b.toString(e.defaultCaption,null),this.criterias=a.isArray(e.criterias)?e.criterias:[e.criterias],this.crosstab=b.toString(e.crosstab),this.dataType=b.toString(e.dataType),this.display=b.toBoolean(e.display),this.expressionText=b.toString(e.expressionText),this.hyperlink=b.toString(e.hyperlink),this.id=b.toString(e.id,null),this.include=b.toBoolean(e.include),this.key=b.toString(e.key),this.layoutWidth=b.toInteger(e.layoutWidth,40),this.resultFilterExpression=b.toString(e.resultFilterExpression),this.sortIndex=b.toInteger(e.sortIndex),this.sortOrder=b.toString(e.sortOrder),this.tableDesignKey=b.toString(e.tableDesignKey),this.total=b.toString(e.total),this.resultSortIndex=b.toInteger(e.resultSortIndex),
this.resultSortOrder=b.toString(e.resultSortOrder),this.appendTo=new c(e.appendTo),this.updateTo=e.updateTo,this.simpleCriteria=d.fromDataCollection(e.simpleCriteria)}return e.fromDataCollection=function a(b){if(b){var c,d=[];for(c=0;c<b.length;c++)d[d.length]=new e(b[c]);return d}},e});
define('query/services/dto/operand-dto',['require','system/lang/converter'],function(require){"use strict";var a=require("system/lang/converter");function b(b){b=b||{},this.tableDesignKey=a.toString(b.tableDesignKey),this.columnId=a.toString(b.columnId),this.charOperand=a.toString(b.charOperand)}return b.fromDataCollection=function a(c){if(c){var d,e=[];for(d=0;d<c.length;d++)e[e.length]=new b(c[d]);return e}},b});
define('query/services/dto/condition-dto',['require','system/lang/converter','./operand-dto'],function(require){"use strict";var a=require("system/lang/converter"),b=require("./operand-dto");function c(c){c=c||{},this.leftOperand=new b(c.leftOperand),this.operator=a.toString(c.operator),this.rightOperand=new b(c.rightOperand),this.nextOperator=a.toString(c.nextOperator)}return c.fromDataCollection=function a(b){if(b){var d,e=[];for(d=0;d<b.length;d++)e[e.length]=new c(b[d]);return e}},c});
define('query/services/dto/join-design-dto',['require','system/lang/converter','./condition-dto'],function(require){"use strict";var a=require("system/lang/converter"),b=require("./condition-dto");function c(c){c=c||{},this.conditions=b.fromDataCollection(c.conditions),this.isMiJoin=a.toBoolean(c.isMiJoin),this.joinSucc=a.toBoolean(c.joinSucc),this.joinType=a.toString(c.joinType),this.key=a.toInteger(c.key),this.leftDesignKey=a.toInteger(c.leftDesignKey),this.relDesignKey=a.toInteger(c.relDesignKey),this.rightDesignKey=a.toInteger(c.rightDesignKey),this.joinDesignKey=a.toInteger(c.joinDesignKey)}return c.fromDataCollection=function a(b){if(b){var d,e=[];for(d=0;d<b.length;d++)e[e.length]=new c(b[d]);return e}},c});
define('query/services/dto/parameter-value-dto',['require','system/lang/converter'],function(require){"use strict";var a=require("system/lang/converter");function b(b){b=b||{},this.value=a.toString(b.value),this.displayValue=a.toString(b.displayValue)}return b.fromDataCollection=function a(c){if(c){var d,e=[];for(d=0;d<c.length;d++)e[e.length]=new b(c[d]);return e}},b});
define('query/services/dto/parameter-design-dto',['require','lodash','system/lang/converter','./parameter-value-dto'],function(require){"use strict";var a=require("lodash"),b=require("system/lang/converter"),c=require("./parameter-value-dto");function d(a){a=a||{},this.id=b.toString(a.id,null),this.dataType=b.toString(a.dataType),this.caption=b.toString(a.caption),this.defaultValue=b.toNullableString(a.defaultValue),this.isHidden=b.toBoolean(a.isHidden),this.familyId=b.toString(a.familyId),this.fieldId=b.toString(a.fieldId),this.isMultiValue=b.toBoolean(a.isMultiValue),this.list=b.toObject(a.list,[]),this.localizedCaption=b.toString(a.localizedCaption),this.codeTable=b.toString(a.codeTable),this.referenceCode=b.toString(a.referenceCode),this.referenceTable=b.toString(a.referenceTable),this.query=b.toString(a.query),this.isExclusive=b.toBoolean(a.isExclusive),this.parmValues=c.fromDataCollection(a.parmValues),this.parmPrompts=b.toObject(a.parmPrompts,[]),this.isAssetHierarchy=b.toBoolean(a.isAssetHierarchy),this.assetHierarchyCaption=b.toString(a.assetHierarchyCaption),
this.all=b.toBoolean(a.all),this.child=b.toBoolean(a.child),this.parent=b.toBoolean(a.parent),this.current=b.toBoolean(a.current),this.isGis=b.toBoolean(a.isGis),this.format=b.toBoolean(a.format),this.alias=b.toString(a.alias),this.distance=b.toString(a.distance),this.entyKey=b.toBoolean(a.entyKey),this.justTheDate=b.toBoolean(a.justTheDate)}return d.fromDataCollection=function a(b){if(b){var c,e=[];for(c=0;c<b.length;c++)e[e.length]=new d(b[c]);return e}},d.prototype.copyPromptValues=function b(c){this.parmPrompts=a.map(c.parmPrompts)},d});
define('query/services/dto/parameter-container-dto',['require','lodash','system/lang/converter','./parameter-design-dto'],function(require){"use strict";var a=require("lodash"),b=require("system/lang/converter"),c=require("./parameter-design-dto");function d(a){a=a||{},this.hasDependencies=b.toBoolean(a.hasDependencies),this.parmDesigns=c.fromDataCollection(a.parmDesigns)}d.prototype.copyPromptValues=function b(c){var d=e.bind(null,c);a.forEach(this.parmDesigns,d)};function e(b,c){var d=c.copyPromptValues.bind(c);a(b.parmDesigns).filter({id:c.id}).take(1).forEach(d)}return d});
define('query/services/dto/query-container-dto',['require','system/lang/converter','./table-design-dto','./column-design-dto','./join-design-dto','./parameter-container-dto'],function(require){"use strict";var a=require("system/lang/converter"),b=require("./table-design-dto"),c=require("./column-design-dto"),d=require("./join-design-dto"),e=require("./parameter-container-dto");function f(f){f=f||{},this.columnDesigns=c.fromDataCollection(f.columnDesigns),this.isCaseInsensitive=a.toBoolean(f.isCaseInsensitive),this.isChanged=a.toBoolean(f.isChanged),this.isDeleteForce=a.toBoolean(f.isDeleteForce),this.isDistinct=a.toBoolean(f.isDistinct),this.isFormatted=a.toBoolean(f.isFormatted),this.isTop=a.toBoolean(f.isTop),this.isUomVisible=a.toBoolean(f.isUomVisible),this.joinDesigns=d.fromDataCollection(f.joinDesigns),this.pageSize=a.toInteger(f.pageSize),this.parmContainer=new e(f.parmContainer),this.queryText=a.toString(f.queryText),this.queryType=a.toString(f.queryType),this.showTotals=a.toBoolean(f.showTotals),this.sqlChanged=a.toBoolean(f.sqlChanged),this.designChanged=a.toBoolean(f.designChanged),this.startPage=a.toInteger(f.startPage),
this.tableDesigns=b.fromDataCollection(f.tableDesigns),this.topRows=a.toInteger(f.topRows),this.uniqueId=a.toString(f.uniqueId),this.catalogPath=a.toString(f.catalogPath),this.asyncQueryRowLimit=a.toInteger(f.asyncQueryRowLimit),this.tableDesigns&&this.tableDesigns.sort(g),this.appendSource=new b(f.appendSource),this.predecessorSource=new b(f.predecessorSource),this.successorSource=new b(f.successorSource),this.designStatus=f.designStatus,this.loadStatus=f.loadStatus}function g(a,b){var c=a.caption.toLowerCase(),d=b.caption.toLowerCase();return c.indexOf("[")===-1&&c.indexOf("{")===-1||(c=c.slice(1,c.length-1)),d.indexOf("[")===-1&&d.indexOf("{")===-1||(d=d.slice(1,d.length-1)),c===d?0:c<d?-1:1}return f});
define('catalog/services/dto/catalog-item-dto',['require','system/lang/converter'],function(require){"use strict";var a=require("system/lang/converter");function b(b){b=b||{},this.key=a.toString(b.key),this.id=a.toString(b.id),this.caption=a.toString(b.caption),this.defaultCaption=a.toString(b.defaultCaption),this.description=a.toString(b.description),this.path=a.toString(b.path),this.folderKey=a.toString(b.folderKey),this.itemType=a.toInteger(b.itemType),this.ownerKey=a.toString(b.ownerKey),this.ownerId=a.toString(b.ownerId),this.lockSeq=a.toString(b.lockSeq),this.query=a.toObject(b.query),this.dataset=a.toObject(b.dataset),this.createDate=a.toDate(b.createDate),this.createUser=a.toString(b.createUser),this.updateDate=a.toDate(b.updateDate),this.updateUser=a.toString(b.updateUser),this.ownerDisplay=a.toString(b.ownerDisplay),this.creatorDisplay=a.toString(b.creatorDisplay),this.updatorDisplay=a.toString(b.updatorDisplay)}return b.fromDataCollection=function a(c){if(c){var d,e=[];for(d=0;d<c.length;d++)e[e.length]=new b(c[d]);return e}},b});
define('catalog/services/dto/folder-dto',['require','jquery','system/lang/converter','./catalog-item-dto'],function(require){"use strict";var a=require("jquery"),b=require("system/lang/converter"),c=require("./catalog-item-dto");function d(c){var e=[];c=c||{},this.key=b.toString(c.key),this.id=b.toString(c.id),this.description=b.toString(c.description),this.caption=b.toString(c.caption),this.folderType=b.toInteger(c.folderType),this.hasChildren=b.toBoolean(c.hasChildren),this.ownerKey=b.toString(c.ownerKey),this.ownerId=b.toString(c.ownerId),this.parentKey=b.toString(c.parentKey),this.path=b.toString(c.path),this.privilege=b.toInteger(c.privilege),this.spread=b.toInteger(c.spread),this.updateDate=b.toDate(c.updateDate),this.updateUser=b.toString(c.updateUser),this.lockSeq=b.toString(c.lockSeq),this.ownerDisplay=b.toString(c.ownerDisplay),this.updatorDisplay=b.toString(c.updatorDisplay),c.children&&(e=a.map(c.children,function(a){return new d(b.toObject(a,{}))})),this.children=e}return d});
define('catalog/services/dto/folder-priv-dto',['require','system/lang/converter'],function(require){"use strict";var a=require("system/lang/converter");function b(b){b=b||{},this.key=a.toString(b.key,"0"),this.userKey=a.toString(b.userKey,"0"),this.userDisplay=a.toString(b.userDisplay),this.groupKey=a.toString(b.groupKey,"0"),this.groupDisplay=a.toString(b.groupDisplay),this.folderKey=a.toString(b.folderKey,"0"),this.privilege=a.toInteger(b.privilege),this.spread=a.toInteger(b.spread)}return b});
define('catalog/services/dto/user-pref-dto',['require','system/lang/converter'],function(require){"use strict";var a=require("system/lang/converter");function b(b){b=b||{},this.key=a.toString(b.key),this.userKey=a.toString(b.userKey),this.prefType=a.toInteger(b.prefType),this.name=a.toString(b.name),this.value=a.toString(b.value)}return b.fromDataCollection=function a(c){if(c){var d,e=[];for(d=0;d<c.length;d++)e[e.length]=new b(c[d]);return e}},b});
define('catalog/services/dto/nav-dto',['require','system/lang/converter'],function(require){"use strict";var a=require("system/lang/converter");function b(b){b=b||{},this.key=a.toString(b.key),this.caption=a.toString(b.caption)}return b.fromDataCollection=function a(c){if(void 0!==c){var d,e=[];for(d=0;d<c.length;d++)e[e.length]=new b(c[d]);return e}},b});
define('catalog/services/dto/catalog-item-result-grid-dto',['require','system/lang/converter'],function(require){"use strict";var a=require("system/lang/converter");function b(b){b=b||{},this.type="",this.linkValue="",b.itemType===-1?(this.type="#query/",this.linkValue=b.key):b.itemType===-2?(this.type="#graph/",this.linkValue=b.key):b.itemType===-3?(this.type="#ssrs/viewer/",this.linkValue=b.path+"\\"+a.toString(b.id)):b.itemType===-5?(this.type="#dataset/",this.linkValue=b.key):b.itemType===-9&&(this.type="#dashboard/",this.linkValue=b.key),this.name=a.toString(b.id),this.path="<a href='"+this.type+a.toString(this.linkValue)+"'>"+a.toString(b.path)+"</a>",this.creator=a.toString(b.ownerId),this.date=a.toDate(b.createDate)}return b.fromDataCollection=function a(c){var d,e=[];for(d=0;d<c.length;d++)e[d]=new b(c[d]);return e},b});
define('catalog/services/catalog-service',['require','lodash','jquery','system/http/ajax-client','./dto/folder-dto','./dto/catalog-item-dto','./dto/folder-priv-dto','./dto/user-pref-dto','./dto/nav-dto','./dto/catalog-item-result-grid-dto'],function(require){"use strict";var a=require("lodash"),b=require("jquery"),c=require("system/http/ajax-client"),d=require("./dto/folder-dto"),e=require("./dto/catalog-item-dto"),f=require("./dto/folder-priv-dto"),g=require("./dto/user-pref-dto"),h=require("./dto/nav-dto"),i=require("./dto/catalog-item-result-grid-dto"),j="api/core/userpref/",k="api/core/command/",l="api/core/catalog/",m="22",n="api/core/localizer",o=n+"/translations/objectKey/{0}?localizableType={1}&defaultValue={2}";function p(a){this.ajaxClient=a}p.dependsOn=[c],p.prototype.getAllFolders=function a(){var c=l+"folders/all/",e=b.Deferred();return this.ajaxClient.get(c,{}).done(function(a){var c=b.map(a,function(a){return new d(a)});e.resolve(c)}).fail(function(a){e.reject(a)}),e.promise()},p.prototype.getFolder=function a(c){var e=l+"folder/"+c,f=b.Deferred();return this.ajaxClient.get(e,{}).done(function(a){f.resolve(new d(a))}).fail(function(a){f.reject(a)}),f.promise()},
p.prototype.getFoldersPaginate=function a(c,e,f){var g=l+"folders/"+c+"/pageSize/"+e+"/pageNum/"+f,h=b.Deferred();return this.ajaxClient.get(g,{}).done(function(a){a&&a.length&&0!==a.length?h.resolve(b.map(a,function(a){return new d(a)})):h.resolve(null)}).fail(function(a){h.reject(a)}),h.promise()},p.prototype.getFolderRoots=function a(){var c=b.Deferred(),e=l+"folder/roots";return this.ajaxClient.get(e,{}).done(function(a){a&&a.length&&0!==a.length?c.resolve(b.map(a,function(a){return new d(a)})):c.resolve(null)}).fail(function(a){c.reject(a)}),c.promise()},p.prototype.getPublicFolder=function a(){var c=l+"folder/public/",e=b.Deferred();return this.ajaxClient.get(c,{}).done(function(a){e.resolve(new d(a))}).fail(function(a){e.reject(a)}),e.promise()},p.prototype.getPersonalFolder=function a(){var c=l+"folder/personal/",e=b.Deferred();return this.ajaxClient.get(c,{}).done(function(a){e.resolve(new d(a))}).fail(function(a){e.reject(a)}),e.promise()},
p.prototype.getBaselineFolder=function a(){var c=l+"folder/baseline/",e=b.Deferred();return this.ajaxClient.get(c,{}).done(function(a){e.resolve(new d(a))}).fail(function(a){e.reject(a)}),e.promise()},p.prototype.getFolderParents=function a(c){var e=b.Deferred(),f=l+"folder/parents?path="+c;return this.ajaxClient.get(f,{}).done(function(a){e.resolve(b.map(a,function(a){return new d(a)}))}).fail(function(a){e.reject(a)}),e.promise()},p.prototype.searchFolders=function a(c,e,f){var g=l+"folders/search?searchValue="+c+"&pageSize="+e+"&pageNum="+f,h=b.Deferred();return this.ajaxClient.get(g,{}).done(function(a){a&&a.length?h.resolve(b.map(a,function(a){return new d(a)})):h.resolve(null)}).fail(function(a){h.reject(a)}),h.promise()},p.prototype.postFolder=function a(c){var d=b.Deferred(),e=l+"folder/";return this.ajaxClient.post(e,c).done(function(a){d.resolve(a)}).fail(function(a){d.reject(a)}),d.promise()},p.prototype.postQuery=function a(c){var d=b.Deferred(),e=k+"discover"
;return this.ajaxClient.post(e,c).done(function(a){d.resolve(a)}).fail(function(a){d.reject(a)}),d.promise()},p.prototype.putFolder=function a(c){var d=b.Deferred(),e=l+"folder/";return this.ajaxClient.put(e,c).done(function(a){d.resolve(a)}).fail(function(a){d.reject(a)}),d.promise()},p.prototype.deleteFolder=function a(c){var d=b.Deferred(),e=l+"folder/";return this.ajaxClient.delete(e+c).done(function(a){d.resolve(a)}).fail(function(a){d.reject(a)}),d.promise()},p.prototype.copyFolder=function a(c,d){var e=b.Deferred(),f=l+"folder/copy/"+c+"/"+d;return this.ajaxClient.post(f).done(function(a){e.resolve(a)}).fail(function(a){e.reject(a)}),e.promise()},p.prototype.moveFolder=function a(c,d){var e=b.Deferred(),f=l+"folder/move/"+c+"/"+d;return this.ajaxClient.post(f).done(function(a){e.resolve(a)}).fail(function(a){e.reject(a)}),e.promise()},p.prototype.getCatalogItems=function a(d){var f=b.Deferred(),g=l+"items/"+d;return this.ajaxClient.get(g,{}).done(function(a){
c.isMultiTenant()&&(a=a.filter(function(a){return a.itemType!==-12||"Role"!==a.id})),f.resolve(b.map(a,function(a){return new e(a)}))}).fail(function(a){f.reject(a)}),f.promise()},p.prototype.getCatalogItem=function a(b){var c=l+"item/";return this.ajaxClient.get(c+b)},p.prototype.getCatalogItemId=function a(b,c){var d=l+"item/"+b+"?id="+c;return this.ajaxClient.get(d)},p.prototype.getCatalogItemKey=function a(b){var c=l+"itemkey?path="+b;return this.ajaxClient.get(c)},p.prototype.getCatalogItemByPath=function a(b){var c=l+"item?path="+encodeURIComponent(b);return this.ajaxClient.get(c)},p.prototype.CanUpdateCatalogItem=function a(b){var c=l+"item/can-update/"+b;return this.ajaxClient.get(c)},p.prototype.postCatalogItem=function a(c){var d=b.Deferred(),e=l+"item/";return this.ajaxClient.post(e,c).done(function(a){d.resolve(a)}).fail(function(a){d.reject(a)}),d.promise()},p.prototype.putCatalogItem=function a(c){var d=b.Deferred(),e=l+"item/"
;return this.ajaxClient.put(e,c).done(function(a){d.resolve(a)}).fail(function(a){d.reject(a)}),d.promise()},p.prototype.copyCatalogItems=function a(c,d){var e=b.Deferred(),f=l+"items/copy/"+d;return this.ajaxClient.post(f,c).done(function(a){e.resolve(a)}).fail(function(a){e.reject(a)}),e.promise()},p.prototype.moveCatalogItems=function a(c,d){var e=b.Deferred(),f=l+"items/move/"+d;return this.ajaxClient.post(f,c).done(function(a){e.resolve(a)}).fail(function(a){e.reject(a)}),e.promise()},p.prototype.deleteCatalogItem=function a(c){var d=b.Deferred(),e=l+"item/";return this.ajaxClient.delete(e+c).done(function(a){d.resolve(a)}).fail(function(a){d.reject(a)}),d.promise()},p.prototype.searchCatalogItems=function a(c,d,e,f){var g=b.Deferred(),h,i,j,k;return c=c||"0",d=d||"",e=void 0===e||e,e=e?"True":"False",f=f||0,h="?searchValue="+d,i="&searchSubFolders="+e,j="&itemType="+f,k=l+"items/search/"+c+h+i+j,this.ajaxClient.get(k,{}).done(q.bind(null,this,g)).fail(function(a){g.reject(a)}),
g.promise()};function q(a,b,c){b.resolve(e.fromDataCollection(c))}p.prototype.getFolderPrivs=function a(c){var d=l+"privs/"+c,e=b.Deferred();return this.ajaxClient.get(d,{}).done(function(a){var c=b.map(a,function(a){return new f(a)});e.resolve(c)}).fail(function(a){e.reject(a)}),e.promise()},p.prototype.postFolderPriv=function a(c){var d=b.Deferred(),e=l+"priv";return this.ajaxClient.post(e,c).done(function(a){d.resolve(a)}).fail(function(a){d.reject(a)}),d.promise()},p.prototype.putFolderPriv=function a(c){var d=b.Deferred(),e=l+"priv";return this.ajaxClient.put(e,c).done(function(a){d.resolve(a)}).fail(function(a){d.reject(a)}),d.promise()},p.prototype.deleteFolderPriv=function a(c){var d=b.Deferred(),e=l+"priv/"+c;return this.ajaxClient.delete(e).done(function(a){d.resolve(a)}).fail(function(a){d.reject(a)}),d.promise()},p.prototype.getPreference=function a(c,d){var e=b.Deferred(),f=j+"get/"+c+"/1?name="+d;return this.ajaxClient.get(f,{}).done(function(a){e.resolve(new g(a))
}).fail(function(a){e.reject(a)}),e.promise()},p.prototype.setPreference=function a(c){var d=b.Deferred(),e=j+"set";return this.ajaxClient.post(e,c).done(function(a){d.resolve(a)}).fail(function(a){d.reject(a)}),d.promise()};function r(a,b){a.resolve(i.fromDataCollection(b))}p.prototype.getTranslation=function(a,c,d){var e=b.Deferred(),f=s(a,d);return this.ajaxClient.get(f,{}).done(t.bind(null,e,c,d)).fail(function(a){e.reject(a)}),e.promise()};function s(a,b){return o.replace("{0}",encodeURIComponent(a)).replace("{1}",encodeURIComponent(m)).replace("{2}",encodeURIComponent(b))}function t(b,c,d,e){var f=a.find(e,{cultureId:c});f&&(d=f.value),b.resolve(d)}return p});
define('query/services/dto/rowset-dto',['require','system/lang/converter'],function(require){"use strict";var a=require("system/lang/converter");function b(b){b=b||{},this.columns=a.toObject(b.columns),this.familyMappings=a.toObject(b.familyMappings),this.rowColumns=a.toObject(b.rowColumns),this.rows=a.toObject(b.rows),this.totalRows=a.toInteger(b.totalRows)}return b.fromDataCollection=function a(c){if(c){var d,e=[];for(d=0;d<c.length;d++)e[e.length]=new b(c[d]);return e}},b});
define('query/services/dto/query-result-dto',[],function(){"use strict";function a(){this.rowCount=0,this.columns=[],this.rows=[],this.timeoutExceeded=!1}return a});
define('query/model/query-result',['require','ramda','system/lang/private','mi-assert'],function(require){"use strict";var a=require("ramda"),b=require("system/lang/private"),c=require("mi-assert");function d(){b(this).rowCount=0,b(this).columns=[],b(this).rows=[],b(this).timeoutExceeded=!1}var e=d.prototype;e.getRowCount=function(){return b(this).rowCount},e.setRowCount=function(a){c.isNumber(a,"rowCount"),b(this).rowCount=a},e.getColumns=function(){return b(this).columns},e.setColumns=function(a){c.isArray(a,"columns"),b(this).columns=a},e.getVisibleColumns=function(){var c=b(this).columns;return a.filter(f,c)};function f(a){return a.getIsDisplayed()}return e.getRows=function(){return b(this).rows},e.setRows=function(a){c.isArray(a,"rows"),b(this).rows=a},e.getTimeoutExceeded=function(){return b(this).timeoutExceeded},e.setTimeoutExceeded=function(a){c.isBoolean(a,"timeoutExceeded"),b(this).timeoutExceeded=a},d});
define('query/services/dto/column-result-dto',[],function(){"use strict";function a(){this.typeName="",this.alias="",this.localizedAlias="",this.isDisplayed=!0,this.fieldDataType="",this.hyperlinkFormat="",this.columnDesignKey=-1,this.fieldKey="",this.fieldId="",this.caption="",this.defaultCaption="",this.displayUomCaption="",this.displayUomDefaultCaption="",this.storageUomCaption="",this.storageUomDefaultCaption=""}return a});
define('query/model/column-result',['require','system/lang/private','mi-assert'],function(require){"use strict";var a=require("system/lang/private"),b=require("mi-assert");function c(){a(this).typeName="",a(this).alias="",a(this).localizedAlias="",a(this).isDisplayed=!0,a(this).fieldDataType="",a(this).hyperlinkFormat="",a(this).columnDesignKey=-1,a(this).fieldKey="",a(this).fieldId="",a(this).caption="",a(this).defaultCaption="",a(this).displayUomCaption="",a(this).displayUomDefaultCaption="",a(this).storageUomCaption="",a(this).storageUomDefaultCaption="",a(this).format=""}var d=c.prototype;return d.getTypeName=function(){return a(this).typeName},d.setTypeName=function(c){b.isString(c,"typeName"),a(this).typeName=c},d.getAlias=function(){return a(this).alias},d.setAlias=function(c){b.isString(c,"alias"),a(this).alias=c},d.getLocalizedAlias=function(){return a(this).localizedAlias},d.setLocalizedAlias=function(c){b.isString(c,"localizedAlias"),a(this).localizedAlias=c},d.getIsDisplayed=function(){return a(this).isDisplayed},d.setIsDisplayed=function(c){
b.isBoolean(c,"isDisplayed"),a(this).isDisplayed=c},d.getFieldDataType=function(){return a(this).fieldDataType},d.setFieldDataType=function(c){b.isString(c,"fieldDataType"),a(this).fieldDataType=c},d.getHyperlinkFormat=function(){return a(this).hyperlinkFormat},d.setHyperlinkFormat=function(c){b.isString(c,"hyperlinkFormat"),a(this).hyperlinkFormat=c},d.getFormat=function(){return a(this).format},d.setFormat=function(c){b.isString(c,"format"),a(this).format=c},d.getColumnDesignKey=function(){return a(this).columnDesignKey},d.setColumnDesignKey=function(c){b.isNumber(c,"columnDesignKey"),a(this).columnDesignKey=c},d.getFieldKey=function(){return a(this).fieldKey},d.setFieldKey=function(c){b.isString(c,"fieldKey"),a(this).fieldKey=c},d.getFieldId=function(){return a(this).fieldId},d.setFieldId=function(c){b.isString(c,"fieldId"),a(this).fieldId=c},d.getCaption=function(){return a(this).caption},d.setCaption=function(c){b.isString(c,"caption"),a(this).caption=c},
d.getDefaultCaption=function(){return a(this).defaultCaption},d.setDefaultCaption=function(c){b.isString(c,"defaultCaption"),a(this).defaultCaption=c},d.getDisplayUomCaption=function(){return a(this).displayUomCaption},d.setDisplayUomCaption=function(c){b.isString(c,"displayUomCaption"),a(this).displayUomCaption=c},d.getDisplayUomDefaultCaption=function(){return a(this).displayUomDefaultCaption},d.setDisplayUomDefaultCaption=function(c){b.isString(c,"displayUomDefaultCaption"),a(this).displayUomDefaultCaption=c},d.getStorageUomCaption=function(){return a(this).storageUomCaption},d.setStorageUomCaption=function(c){b.isString(c,"storageUomCaption"),a(this).storageUomCaption=c},d.getStorageUomDefaultCaption=function(){return a(this).storageUomDefaultCaption},d.setStorageUomDefaultCaption=function(c){b.isString(c,"storageUomDefaultCaption"),a(this).storageUomDefaultCaption=c},d.setFormat=function(c){b.isString(c,"format"),a(this).format=c},c});
define('query/adapters/column-result-adapter',['require','ramda','mi-assert','system/lang/converter','../services/dto/column-result-dto','../model/column-result'],function(require){"use strict";var a=require("ramda"),b=require("mi-assert"),c=require("system/lang/converter"),d=require("../services/dto/column-result-dto"),e=require("../model/column-result");function f(a){var e=new d;return b.isObject(a,"data"),e.typeName=c.toString(a.typeName),e.alias=c.toString(a.alias),e.localizedAlias=c.toString(a.localizedAlias),e.isDisplayed=c.toBoolean(a.isDisplayed),e.fieldDataType=c.toString(a.fieldDataType),e.hyperlinkFormat=c.toString(a.hyperlink),e.columnDesignKey=c.toInteger(a.columnDesignKey,-1),e.fieldKey=c.toString(a.fieldKey),e.fieldId=c.toString(a.fieldId),e.caption=c.toString(a.caption),e.defaultCaption=c.toString(a.defaultCaption),e.displayUomCaption=c.toString(a.displayUomCaption),e.displayUomDefaultCaption=c.toString(a.displayUomDefaultCaption),e.storageUomCaption=c.toString(a.storageUomCaption),e.storageUomDefaultCaption=c.toString(a.storageUomDefaultCaption),e.format=c.toString(a.format),e}function g(a){var c=new e
;return b.instanceOf(a,d,"dto"),c.setTypeName(a.typeName),c.setAlias(a.alias),c.setLocalizedAlias(a.localizedAlias),c.setIsDisplayed(a.isDisplayed),c.setFieldDataType(a.fieldDataType),c.setHyperlinkFormat(a.hyperlinkFormat),c.setColumnDesignKey(a.columnDesignKey),c.setFieldKey(a.fieldKey),c.setFieldId(a.fieldId),c.setCaption(a.caption),c.setDefaultCaption(a.defaultCaption),c.setDisplayUomCaption(a.displayUomCaption),c.setDisplayUomDefaultCaption(a.displayUomDefaultCaption),c.setStorageUomCaption(a.storageUomCaption),c.setStorageUomDefaultCaption(a.storageUomDefaultCaption),c.setFormat(a.format),c}return{deserialize:f,deserializeArray:a.map(f),toModel:g,toModelArray:a.map(g)}});
define('query/services/dto/row-dto',[],function(){"use strict";function a(){this.cells=[]}return a});
define('query/model/row',['require','ramda','system/lang/private','mi-assert'],function(require){"use strict";var a=require("ramda"),b=require("system/lang/private"),c=require("mi-assert");function d(){b(this).cells=[]}var e=d.prototype;e.getCells=function(){return b(this).cells},e.setCells=function(a){c.isArray(a,"cells"),b(this).cells=a},e.getVisibleCells=function(){var c=b(this).cells;return a.filter(f,c)};function f(a){return a.isVisible()}return d});
define('query/services/dto/cell-dto',[],function(){"use strict";function a(){this.dbValue=null,this.value="",this.utcValue="",this.backColor=""}return a});
define('system/lang/string',[],function(){"use strict";String.prototype.toStaticHTML=function(){return window.toStaticHTML?window.toStaticHTML(this).trim():this.trim()},String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)},String.prototype.startsWith=function(a,b){void 0===b&&(b=!0);var c=b?a.toLowerCase():a,d=a.length;return(b?this.toLowerCase():this).substr(0,d)===c},String.prototype.format=function(){var a=arguments,b=/\{(\d|\d\d)\}/g,c=/\d+/;return this.replace(b,function(b){var d=1*b.match(c)[0];return void 0!==a[d]?a[d]:""===a[d]?"":b})},String.isNullOrWhitespace=function(a){return void 0===a||null===a||("string"!=typeof a&&(a=a.toString()),""===a.trim())},String.compare=function(a,b){return void 0!==a&&null!==a&&void 0!==b&&null!==b&&a.toLocaleLowerCase().localeCompare(b.toLocaleLowerCase())},String.escapeRegex=function(a){return String(a).replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")},String.prototype.endsWith=function(a,b){
var c=this.toString();("number"!=typeof b||!isFinite(b)||Math.floor(b)!==b||b>c.length)&&(b=c.length),b-=a.length;var d=c.lastIndexOf(a,b);return d!==-1&&d===b}});
define('query/model/cell',['require','system/lang/private','mi-assert','./column-result','system/lang/converter','system/text/formatter','application/application-context','system/lang/string'],function(require){"use strict";var a=require("system/lang/private"),b=require("mi-assert"),c=require("./column-result"),d=require("system/lang/converter"),e=require("system/text/formatter"),f=require("application/application-context");require("system/lang/string");function g(){a(this).column=null,a(this).dbValue=null,a(this).value="",a(this).utcValue="",a(this).backColor="",a(this).hyperlinkRoute="",a(this).formatter=Object.resolve(e)}var h=g.prototype;return h.getColumn=function(){return a(this).column},h.setColumn=function(d){b.instanceOf(d,c,"column"),a(this).column=d},h.getDbValue=function(){var b=a(this).column,c=a(this).dbValue;if(!b)return c;switch(b.getTypeName()){case"System.DateTime":return d.toDate(c);case"System.Integer":return d.toNullableInteger(c);case"System.Double":return d.toNullableFloat(c);case"System.Boolean":return d.toBoolean(c);case"System.String":return"Boolean"===b.getFieldDataType()?c===!0||"Y"===c:d.toString(c);default:return c}},
h.setDbValue=function(b){a(this).dbValue=b},h.getValue=function(){var b=a(this).value,c=this.getDbValue(),d=a(this).column,e=a(this).formatter,g=f.user.formats.dateTime;if(!d||b)return b;switch(d.getTypeName()){case"System.DateTime":return c?e.format(c,g):"";case"System.Integer":case"System.Double":return null===c?c:e.format(c,"g");default:return c?c.toString():""}},h.setValue=function(c){b.isString(c,"value"),a(this).value=c},h.getUtcValue=function(){return a(this).utcValue},h.setUtcValue=function(c){b.isString(c,"utcValue"),a(this).utcValue=c},h.getBackColor=function(){return a(this).backColor},h.setBackColor=function(c){b.isString(c,"backColor"),a(this).backColor=c},h.getHyperlinkRoute=function(){return a(this).hyperlinkRoute},h.setHyperlinkRoute=function(c){b.isString(c,"hyperlinkRoute"),a(this).hyperlinkRoute=c},h.isVisible=function(){return a(this).column.getIsDisplayed()},g});
define('query/adapters/cell-adapter',['require','ramda','mi-assert','system/lang/converter','../services/dto/cell-dto','../model/cell'],function(require){"use strict";var a=require("ramda"),b=require("mi-assert"),c=require("system/lang/converter"),d=require("../services/dto/cell-dto"),e=require("../model/cell");function f(a){var e=new d;return b.isObject(a,"data"),void 0===a.dbValue?e.dbValue=null:e.dbValue=a.dbValue,e.value=c.toString(a.value),e.utcValue=c.toString(a.utcValue),e.backColor=c.toString(a.backColor),e}var g=a.addIndex(a.map);function h(a,c){return b.isArray(c,"dtos"),g(i.bind(null,a),c)}function i(a,c,f){var g=new e;return b.instanceOf(c,d,"dto"),g.setDbValue(c.dbValue),g.setValue(c.value),g.setUtcValue(c.utcValue),g.setBackColor(c.backColor),g.setColumn(a[f]),g}return{deserialize:f,deserializeArray:a.map(f),toModel:i,toModelArray:h}});
define('query/adapters/row-adapter',['require','ramda','mi-assert','system/lang/converter','../services/dto/row-dto','../model/row','./cell-adapter'],function(require){"use strict";var a=require("ramda"),b=require("mi-assert"),c=require("system/lang/converter"),d=require("../services/dto/row-dto"),e=require("../model/row"),f=require("./cell-adapter");function g(a){var e=new d,g=c.toObject(a.cells,[]);return b.isObject(a,"data"),e.cells=f.deserializeArray(g),e}function h(c,d){return b.isArray(d,"dtos"),a.map(i.bind(null,c),d)}function i(a,c){var g=new e,h,i;for(b.instanceOf(c,d,"dto"),b.isArray(a,"columnResults"),h=f.toModelArray(a,c.cells),i=0;i<h.length;i++)j(h,a[i],h[i]);return g.setCells(h),g}function j(a,b,c){var d=k(b,a);c.setHyperlinkRoute(d)}function k(b,c){var d=b.getHyperlinkFormat(),e=l(c);return a.all(n,e)?"":d.format.apply(d,e)}function l(b){return a.map(m,b)}function m(a){return a.getValue()}function n(a){return!a}return{deserialize:g,deserializeArray:a.map(g),toModel:i,toModelArray:h}});
define('query/adapters/query-result-adapter',['require','ramda','mi-assert','system/lang/converter','../services/dto/query-result-dto','../model/query-result','./column-result-adapter','./row-adapter'],function(require){"use strict";var a=require("ramda"),b=require("mi-assert"),c=require("system/lang/converter"),d=require("../services/dto/query-result-dto"),e=require("../model/query-result"),f=require("./column-result-adapter"),g=require("./row-adapter");function h(a){var e=new d,h=c.toObject(a.columns,[]),i=c.toObject(a.rows,[]);return b.isObject(a,"data"),e.rowCount=c.toInteger(a.rowCount),e.columns=f.deserializeArray(h),e.rows=g.deserializeArray(i),e.timeoutExceeded=c.toBoolean(a.timeoutExceeded),e}function i(a){b.instanceOf(a,d,"dto");var c=new e;return c.setRowCount(a.rowCount),c.setColumns(f.toModelArray(a.columns)),c.setRows(g.toModelArray(c.getColumns(),a.rows)),c.setTimeoutExceeded(a.timeoutExceeded),c}return{deserialize:h,deserializeArray:a.map(h),toModel:i,toModelArray:a.map(i)}});
define('query/services/dto/table-dto',['require','system/lang/converter','./column-dto'],function(require){"use strict";var a=require("system/lang/converter"),b=require("./column-dto");function c(c){c=c||{},this.caption=a.toString(c.caption),this.defaultCaption=a.toString(c.defaultCaption),this.id=a.toString(c.id),this.queryColumns=b.fromDataCollection(c.queryColumns),this.tableType=a.toString(c.tableType),this.queryColumns&&(this.queryColumns=this.queryColumns.sort(d))}c.fromDataCollection=function a(b){if(b){var d,e=[];for(d=0;d<b.length;d++)e[e.length]=new c(b[d]);return e}};function d(a,b){var c=a.caption.toLowerCase(),d=b.caption.toLowerCase(),e=!1,f=!1;return c.indexOf("[")===-1&&c.indexOf("{")===-1||(e=!0,c=c.slice(1,c.length-1)),d.indexOf("[")===-1&&d.indexOf("{")===-1||(f=!0,d=d.slice(1,d.length-1)),e&&f||!e&&!f?c===d?0:c<d?-1:1:e?-1:1}return c});
define('query/services/dto/join-source-dto',['require','system/lang/converter','./table-dto'],function(require){"use strict";var a=require("system/lang/converter"),b=require("./table-dto");function c(c){c=c||{},this.entFamilyCaption=a.toString(c.entFamilyCaption),this.entFamilyId=a.toString(c.entFamilyId),this.joinSucc=a.toBoolean(c.joinSucc),this.relFamilyCaption=a.toString(c.relFamilyCaption),this.relFamilyId=a.toString(c.relFamilyId),this.entTableData=new b(c.entTableData),this.relTableData=new b(c.relTableData)}return c.fromDataCollection=function a(b){if(b){var d,e=[];for(d=0;d<b.length;d++)e[e.length]=new c(b[d]);return e}},c});
define('query/services/dto/hyperlink-route-dto',['require','system/lang/converter'],function(require){"use strict";var a=require("system/lang/converter");function b(b){b=b||{},this.key=a.toString(b.key),this.featureKey=a.toString(b.featureKey),this.sortOrder=a.toInteger(b.sortOrder),this.caption=a.toString(b.caption),this.pattern=a.toString(b.pattern),this.parm1Caption=a.toString(b.parm1Caption),this.parm2Caption=a.toString(b.parm2Caption),this.parm3Caption=a.toString(b.parm3Caption)}return b.fromDataCollection=function a(c){if(c){var d,e=[];for(d=0;d<c.length;d++)e[e.length]=new b(c[d]);return e}},b});
define('query/services/dto/hyperlink-feature-dto',['require','system/lang/converter'],function(require){"use strict";var a=require("system/lang/converter");function b(b){b=b||{},this.key=a.toString(b.key),this.id=a.toString(b.id),this.sortOrder=a.toInteger(b.sortOrder),this.caption=a.toString(b.caption)}return b.fromDataCollection=function a(c){if(c){var d,e=[];for(d=0;d<c.length;d++)e[e.length]=new b(c[d]);return e}},b});
define('query/services/dto/hyperlink-container-dto',['require','system/lang/converter','./hyperlink-route-dto','./hyperlink-feature-dto'],function(require){"use strict";var a=require("system/lang/converter"),b=require("./hyperlink-route-dto"),c=require("./hyperlink-feature-dto");function d(a){a=a||{},this.features=c.fromDataCollection(a.features),this.routes=b.fromDataCollection(a.routes)}return d});
define('query/services/query-service',['require','lodash','jquery','system/http/ajax-client','./dto/rowset-dto','./dto/query-container-dto','../adapters/query-result-adapter','./dto/table-dto','./dto/table-design-dto','./dto/column-dto','./dto/join-source-dto','./dto/hyperlink-container-dto','system/lang/converter'],function(require){"use strict";var a=require("lodash"),b=require("jquery"),c=require("system/http/ajax-client"),d=require("./dto/rowset-dto"),e=require("./dto/query-container-dto"),f=require("../adapters/query-result-adapter"),g=require("./dto/table-dto"),h=require("./dto/table-design-dto"),i=require("./dto/column-dto"),j=require("./dto/join-source-dto"),k=require("./dto/hyperlink-container-dto"),l="api/core/queryengine",m="api/core/url",n=require("system/lang/converter");function o(a){this.ajaxClient=a}o.dependsOn=[c],o.prototype.evaluateQuerySql=function a(c){var d=b.Deferred(),e=l+"/evaluate/string",f=b.Deferred();return this.ajaxClient.post(e,{value:c}).done(function(a){d.resolve(a)}).fail(function(a){d.reject(a)}),d.promise()},o.prototype.getPromptArrayFromQueryString=function a(b){var c=/^p\d+$/,d=[],e,f,g=[],h=0,i=0;for(var j in b)b.hasOwnProperty(j)&&c.test(j)&&d.push(j);for(d.sort(),h=0;h<d.length;h++){if(e=d[h],f=e.match(/\d+/)[0],h.toString()!==f)for(i=h,
i=0;i<f;i++)g.push(null);g.push(b[e])}return g},o.prototype.evaluateQueryContainer=function a(c){var d=b.Deferred(),e=l+"/evaluate/container",f=b.Deferred();return this.ajaxClient.post(e,c).done(function(a){d.resolve(a)}).fail(function(a){d.reject(a)}),d.promise()},o.prototype.executeQuerySql=function a(c){var e=b.Deferred(),f=l+"/execute/string",g=b.Deferred();return this.ajaxClient.post(f,{value:c}).done(function(a){e.resolve(new d(a))}).fail(function(a){e.reject(a)}),e.promise()},o.prototype.executeQueryContainer=function a(c){var e=b.Deferred(),f=l+"/execute/container",g=b.Deferred();return this.ajaxClient.post(f,c).done(function(a){e.resolve(new d(a))}).fail(function(a){e.reject(a)}),e.promise()},o.prototype.executeQueryContainerSync=function a(c){var d=b.Deferred(),e=l+"/executesync/container";return this.ajaxClient.post(e,c).done(function(a){d.resolve(f.deserialize(a))}).fail(function(a){d.reject(a)}),d.promise()},o.prototype.getEntitySources=function c(){
var d=l+"/entitysources/all",e=b.Deferred();return this.ajaxClient.get(d,{}).done(function(b){var c=a.map(b,function(a){return new g(a)});c.sort(p),e.resolve(c)}).fail(function(a){e.reject(a)}),e.promise()},o.prototype.getEntitySource=function a(c){var d=l+"/entitysource?entityFamilyId="+c,e=b.Deferred();return this.ajaxClient.get(d,{}).done(function(a){var b=new h(a);e.resolve(b)}).fail(function(a){e.reject(a)}),e.promise()},o.prototype.getJoinSources=function a(c){var d=l+"/joinsources?entFamilyId="+c,e=b.Deferred();return this.ajaxClient.get(d,{}).done(function(a){var c=b.map(a,function(a){return new j(a)});e.resolve(c)}).fail(function(a){e.reject(a)}),e.promise()},o.prototype.joinsourcesForRf=function a(c){var d=l+"/joinsources_for_rf?relFamilyId="+c,e=b.Deferred();return this.ajaxClient.get(d,{}).done(function(a){var c=b.map(a,function(a){return new j(a)});e.resolve(c)}).fail(function(a){e.reject(a)}),e.promise()},o.prototype.getJoinSource=function a(c,d,e,f){var g,h=b.Deferred()
;return f=f!==!1||f,g=l+"/joinsource?predFamilyId="+c+"&relFamilyId="+d+"&succFamilyId="+e+"&getSuccessor="+f,this.ajaxClient.get(g,{}).done(function(a){var b=new j(a);h.resolve(b)}).fail(function(a){h.reject(a)}),h.promise()},o.prototype.getRelSources=function a(){var c,d=b.Deferred();return c=l+"/relsources/all",this.ajaxClient.get(c,{}).done(function(a){var c=b.map(a,function(a){return new g(a)});c.sort(p),d.resolve(c)}).fail(function(a){d.reject(a)}),d.promise()},o.prototype.getRelSource=function a(c){var d=l+"/relsource?relFamilyId="+c,e=b.Deferred();return this.ajaxClient.get(d,{}).done(function(a){var b=new h(a);e.resolve(b)}).fail(function(a){e.reject(a)}),e.promise()},o.prototype.compileString=function a(c){var d=b.Deferred(),f=l+"/compilestring/",g=b.Deferred(),h;return this.ajaxClient.post(f,{value:c}).done(function(a){h=new e(a),d.resolve(h)}).fail(function(a){d.reject(a)}),d.promise()},o.prototype.compileContainer=function a(c){
var d=b.Deferred(),e=l+"/compilecontainer/",f=b.Deferred();return this.ajaxClient.post(e,c).done(function(a){d.resolve(a)}).fail(function(a){d.reject(a)}),d.promise()},o.prototype.recompileContainer=function a(c){var d=b.Deferred(),f=l+"/recompilecontainer/",g=b.Deferred();return this.ajaxClient.post(f,c).done(function(a){d.resolve(new e(a))}).fail(function(a){d.reject(a)}),d.promise()},o.prototype.compileContainerParameters=function a(c){var d=b.Deferred(),f=l+"/compileparameters/",g=b.Deferred();return this.ajaxClient.post(f,c).done(function(a){d.resolve(new e(a))}).fail(function(a){d.reject(a)}),d.promise()},o.prototype.compileParameterDesign=function a(c){var d=b.Deferred(),e=l+"/compileparamdesign/",f=b.Deferred();return this.ajaxClient.post(e,c).done(function(a){d.resolve(a)}).fail(function(a){d.reject(a)}),d.promise()},o.prototype.getQueryAsSource=function a(c){var d=l+"/querysource?catalogItemPath="+encodeURIComponent(c),e=b.Deferred()
;return this.ajaxClient.get(d,{}).done(function(a){var b=new h(a);e.resolve(b)}).fail(function(a){e.reject(a)}),e.promise()},o.prototype.getDatasheets=function a(c){var d=l+"/datasheets?fmlyId="+c,e=b.Deferred();return this.ajaxClient.get(d,{}).done(function(a){e.resolve(a)}).fail(function(a){e.reject(a)}),e.promise()},o.prototype.getDatasheetColumns=function a(c,d){var e=l+"/datasheetColumns?fmlyId="+c+"&datasheetCaption="+d,f=b.Deferred();return this.ajaxClient.get(e,{}).done(function(a){var c=b.map(a,function(a){return new i(a)});c.sort(p),f.resolve(c)}).fail(function(a){f.reject(a)}),f.promise()},o.prototype.convertSimpleCriteria=function a(c,d,e){var f=b.Deferred(),g=l+"/convertcriteria?columnIdx="+d.toString()+"&criteriaIdx="+e.toString();return this.ajaxClient.post(g,c).done(function(a){f.resolve(a)}).fail(function(a){f.reject(a)}),f.promise()},o.prototype.convertSimpleCriteriaText=function a(c,d,e,f,g){var h=b.Deferred(),i=l+"/convertsimplecriteriatext"
;return this.ajaxClient.post(i,{queryContainer:c,toDisplay:d,columnKey:e,criteriaIndex:f,factorTexts:g}).done(function(a){h.resolve(a)}).fail(function(a){h.reject(a)}),h.promise()},o.prototype.convertCriteriaText=function a(c,d,e,f,g){var h=b.Deferred(),i=l+"/convertcriteriatext";return this.ajaxClient.post(i,{queryContainer:c,toDisplay:d,columnKey:e,criteriaIndex:f,factorText:g}).done(function(a){h.resolve(a)}).fail(function(a){h.reject(a)}),h.promise()},o.prototype.convertExpressionText=function a(c,d,e,f,g){var h=b.Deferred(),i=l+"/convertexpressiontext";return this.ajaxClient.post(i,{queryContainer:c,toDisplay:d,columnKey:e,criteriaIndex:f,factorText:g}).done(function(a){h.resolve(a)}).fail(function(a){h.reject(a)}),h.promise()},o.prototype.getUrlContainer=function a(){var c=m+"/hyperlink/container",d=b.Deferred();return this.ajaxClient.get(c,{}).done(function(a){var b=new k(a);d.resolve(b)}).fail(function(a){d.reject(a)}),d.promise()};function p(a,b){
var c=a.caption.toLowerCase(),d=b.caption.toLowerCase();return c.indexOf("[")===-1&&c.indexOf("{")===-1||(c=c.slice(1,c.length-1)),d.indexOf("[")===-1&&d.indexOf("{")===-1||(d=d.slice(1,d.length-1)),c===d?0:c<d?-1:1}return o});
define('catalog/services/catalog-constants',[],function(){"use strict";function a(){this.FOLDER_TYPE_PERSONAL=0,this.FOLDER_TYPE_BASELINE=1,this.FOLDER_TYPE_PUBLIC=2,this.FOLDER_PRIV_NONE=0,this.FOLDER_PRIV_CREATE=1,this.FOLDER_PRIV_VIEW=2,this.FOLDER_PRIV_EDIT_OWN=4,this.FOLDER_PRIV_EDIT_ALL=8,this.FOLDER_PRIV_DELETE_OWN=16,this.FOLDER_PRIV_DELETE_ALL=32,this.ITEM_TYPE_NONE=0,this.ITEM_TYPE_QUERY=-1,this.ITEM_TYPE_GRAPH=-2,this.ITEM_TYPE_REPORT=-3,this.ITEM_TYPE_SEARCH=-4,this.ITEM_TYPE_DATASET=-5,this.ITEM_TYPE_METRICVIEW=-6,this.ITEM_TYPE_EXPLORER=-7,this.ITEM_TYPE_PROJECT=-8,this.ITEM_TYPE_DASHBOARD=-9,this.ITEM_TYPE_R_SCRIPT=-10,this.ITEM_TYPE_SCRIPT=-11,this.QUERY_TYPE_NONE=0,this.QUERY_TYPE_SELECT=1,this.QUERY_TYPE_UPDATE=2,this.QUERY_TYPE_DELETE=3,this.QUERY_TYPE_APPEND=4,this.QUERY_TYPE_TRANSFORM=5,this.QUERY_TYPE_IN=6,this.QUERY_TYPE_AGGREGATE=7,this.GRP_CATALOG_ADMIN="MI Catalog Administrator",this.GRP_POWER_USER="MI Power User Role",this.KEY_PUBLIC_FOLDER="-1",this.KEY_BASELINE_FOLDER="-41",
this.KEY_PERSONAL_FOLDER="-999999999",this.CATALOG_PREFERENCE=1}return a});
define('query/services/dto/query-state-dto',['require','system/lang/converter','./query-container-dto'],function(require){"use strict";var a=require("system/lang/converter"),b=require("./query-container-dto");function c(a){a=a||{},this.version=2,this.queryContainer=new b(a.queryContainer)}return c});
define('query/model/parameter-value-model',['require','knockout'],function(require){"use strict";var a=require("knockout");function b(b){b=b||{},this.value=a.observable(b.value),this.displayValue=a.observable(b.displayValue)}return b});
define('query/adapters/parameter-value-adapter',['require','../services/dto/parameter-value-dto','../model/parameter-value-model'],function(require){"use strict";var a=require("../services/dto/parameter-value-dto"),b=require("../model/parameter-value-model");function c(){}return c.toModelObject=function a(c){return new b(c)},c.toModelObjectArray=function a(b){var c=0,d=[];if(b&&b.length){for(c=0;c!==b.length;c++)d.push(this.toModelObject(b[c]));return d}},c.toDTO=function b(c){var d=new a;return c=c||{},d.value=c.value(),d.displayValue=c.displayValue(),d},c.toDTOArray=function a(b){var c=0,d=[];if(b&&b.length){for(c=0;c!==b.length;c++)d.push(this.toDTO(b[c]));return d}},c});
define('query/model/parameter-design-model',['require','knockout','../adapters/parameter-value-adapter'],function(require){"use strict";var a=require("knockout"),b=require("../adapters/parameter-value-adapter");function c(c){c=c||{},this.id=a.observable(c.id),this.dataType=a.observable(c.dataType),this.caption=a.observable(c.caption),this.defaultValue=a.observable(c.defaultValue),this.isHidden=a.observable(c.isHidden),this.familyId=a.observable(c.familyId),this.fieldId=a.observable(c.fieldId),this.isMultiValue=a.observable(c.isMultiValue),this.list=a.observableArray(c.list),this.localizedCaption=a.observable(c.localizedCaption),this.codeTable=a.observable(c.codeTable),this.referenceCode=a.observable(c.referenceCode),this.referenceTable=a.observable(c.referenceTable),this.query=a.observable(c.query),this.isExclusive=a.observable(c.isExclusive),this.parameterValues=a.observableArray(b.toModelObjectArray(c.parmValues)),this.parameterPrompts=a.observableArray(c.parmPrompts),this.isAssetHierarchy=a.observable(c.isAssetHierarchy),this.child=a.observable(c.child),
this.parent=a.observable(c.parent),this.all=a.observable(c.all),this.current=a.observable(c.current),this.isGis=a.observable(c.isGis),this.format=a.observable(c.foramt),this.alias=a.observable(c.alias),this.distance=a.observable(c.distance),this.entyKey=a.observable(c.entyKey),this.justTheDate=a.observable(c.justTheDate),this.defaultValues=a.computed({read:e.bind(null,this),write:f.bind(null,this),owner:this}),this.isExclusive.subscribe(d.bind(null,this))}function d(a,b){b||a.isMultiValue(!1)}function e(a){var b=a.defaultValue();return b?b.toString().split("|"):[]}function f(a,b){b.length>1?a.defaultValue(b.join("|")):a.defaultValue(b[0])}return c});
define('query/adapters/parameter-design-adapter',['require','../services/dto/parameter-design-dto','../model/parameter-design-model','./parameter-value-adapter'],function(require){"use strict";var a=require("../services/dto/parameter-design-dto"),b=require("../model/parameter-design-model"),c=require("./parameter-value-adapter");function d(){}return d.toModelObject=function a(c){return new b(c)},d.toModelObjectArray=function a(b){var c=0,d=[];if(b&&b.length){for(c=0;c!==b.length;c++)d.push(this.toModelObject(b[c]));return d}},d.toDTO=function b(d){var e=new a,f=d.parameterPrompts();return d=d||{},e.id=d.id()||null,e.dataType=d.dataType(),e.caption=d.caption(),e.defaultValue=d.defaultValue(),e.isHidden=d.isHidden(),e.familyId=d.familyId(),e.fieldId=d.fieldId(),e.isMultiValue=d.isMultiValue(),e.list=d.list(),e.localizedCaption=d.localizedCaption(),e.codeTable=d.codeTable(),e.referenceCode=d.referenceCode(),e.referenceTable=d.referenceTable(),e.query=d.query(),e.isExclusive=d.isExclusive(),e.parmValues=c.toDTOArray(d.parameterValues()),e.isAssetHierarchy=d.isAssetHierarchy(),e.isAssetHierarchy?(e.parmPrompts="0"===f[0]||0===f[0]?["-1"]:f,
e.assetHierarchyCaption=d.assetHierarchyCaption):e.parmPrompts=f,e.child=d.child(),e.parent=d.parent(),e.all=d.all(),e.current=d.current(),e.isGis=d.isGis(),e.format=d.format(),e.alias=d.alias(),e.distance=d.distance(),e.entyKey=d.entyKey(),e.justTheDate=d.justTheDate(),e},d.toDTOArray=function a(b){var c=0,d=[];if(b&&b.length){for(c=0;c!==b.length;c++)d.push(this.toDTO(b[c]));return d}},d});

define('text!query/execution/views/query-prompt.html',[],function () { return '<div class="query-prompt"\r\n     data-bind="foreach: prompts">\r\n    <div class="form-group"\r\n         data-bind="css: { \'has-error\': !$root.validatePrompt($data) }">\r\n        <!-- ko ifnot: isHidden -->\r\n            <label data-bind="text: caption"></label>\r\n            <!-- ko if: options && options.length -->\r\n                <!-- ko if: isExclusive -->\r\n                    <!-- ko if: isMultiValue -->\r\n                        <mi-select data-bind="miproperty: {\r\n                                                  options: options,\r\n                                                  multiple: true,\r\n                                                  optionsText: \'displayValue\',\r\n                                                  optionsValue: \'value\',\r\n                                                  optionsCaption: \'\',\r\n                                                  selectedOptions: values\r\n                                              },\r\n                                              event: {\r\n                                                  selected: $root.multiSelectValueChanged.bind($root)\r\n                                   }">\r\n                        </mi-select>\r\n                    <!-- /ko -->\r\n                    <!-- ko ifnot: isMultiValue -->\r\n                        <mi-select data-bind="miproperty: {\r\n                                                  options: options,\r\n                                                  multiple: false,\r\n                                                  optionsText: \'displayValue\',\r\n                                                  optionsValue: \'value\',\r\n                                                  optionsCaption: \'\',\r\n                                                  value: value\r\n                                    }">\r\n                        </mi-select>\r\n                    <!-- /ko -->\r\n                <!-- /ko -->\r\n                <!-- ko ifnot: isExclusive -->\r\n                    <!-- ko if: isMultiValue -->\r\n                        <mi-select data-bind="miproperty: {\r\n                                                  options: options,\r\n                                                  multiple: true,\r\n                                                  optionsText: \'displayValue\',\r\n                                                  optionsValue: \'value\',\r\n                                                  optionsCaption: \'\',\r\n                                                  selectedOptions: values\r\n                                              },\r\n                                              event: {\r\n                                                  selected: $root.multiSelectValueChanged.bind($root)\r\n                                   }">\r\n                        </mi-select>\r\n                    <!-- /ko -->\r\n                    <!-- ko ifnot: isMultiValue -->\r\n                        <mi-multi-value data-bind="miproperty: {\r\n                                                  options: cboOptions,\r\n                                                  multiple: false,\r\n                                                  optionsText: \'displayValue\',\r\n                                                  optionsValue: \'value\',\r\n                                                  optionsCaption: \'\',\r\n                                                  value: value\r\n                                    }">\r\n                        </mi-multi-value>\r\n                    <!-- /ko -->\r\n                <!-- /ko -->\r\n            <!-- /ko -->\r\n            <!-- ko ifnot: (options && options.length) -->\r\n                <!-- ko if: isAssetHierarchy -->\r\n                    <mi-asset-context dialog data-bind="value: value"></mi-asset-context>\r\n                <!-- /ko -->\r\n                <!-- ko ifnot: isAssetHierarchy -->\r\n                    <div data-bind="template: valueTemplate"></div>\r\n                <!-- /ko -->\r\n            <!-- /ko -->\r\n        <!-- /ko -->\r\n    </div>\r\n\r\n    <!-- ko if: validationMessage -->\r\n        <p class="invalid-value bg-danger text-danger">\r\n            <button type="button"\r\n                    class="close"\r\n                    data-bind="click: $root.clearPromptValidationMessage($data),\r\n                               attr: { \'aria-label\': $root.translate(\'CLOSE\')}">\r\n                <span aria-hidden="true">&times;</span>\r\n            </button>\r\n            <span data-bind="text: validationMessage" />\r\n        </p>\r\n    <!-- /ko -->\r\n</div>\r\n\r\n<script type="text/html" id="prompt-text-template">\r\n    <input type="text" class="form-control" data-bind="value: value" />\r\n</script>\r\n<script type="text/html" id="prompt-number-template">\r\n    <input type="text"\r\n           class="form-control"\r\n           data-bind="textInput: value" />\r\n</script>\r\n<script type="text/html" id="prompt-datetime-template">\r\n    <mi-date-time pick-time="true"\r\n                  use-seconds="true"\r\n                  data-bind="value: value,\r\n                             attr: { format: $root.format }" />\r\n</script>\r\n<script type="text/html" id="prompt-date-template">\r\n    <mi-date-time pick-time="false"\r\n                  data-bind="value: value,\r\n                             attr: { format: $root.dateFormat }" />\r\n</script>';});

define('assets/services/asset-context-dto',['require','system/globalization/translator','system/lang/converter'],function(require){"use strict";var a=require("system/globalization/translator"),b=require("system/lang/converter");function c(a){a=a||{},this.entityKey=b.toString(a.entityKey),this.description="-1"===this.entityKey?d("ASSET_HIERARCHY_ROOT"):b.toString(a.description),this.type=b.toString(a.type),this.familyId=b.toString(a.familyId),this.siteKey=b.toString(a.siteKey)}c.fromDataCollection=function a(b){for(var d=[],e=0;e<b.length;e++)d[d.length]=new c(b[e]);return d},c.fromHierarchyDTO=function a(b){return b?new c({entityKey:b.entityKey,description:b.description,type:"Hierarchy",familyId:b.familyId,siteKey:b.siteKey}):c.default()},c.fromGroupDTO=function a(b){return new c(b?{entityKey:b.entityKey,description:b.groupid,type:"Group",siteKey:b.siteKey}:{type:"Group"})},c.default=function a(b){var e=d("ASSET_HIERARCHY_ROOT");return new c({entityKey:b||"-1",description:e,type:"Hierarchy"})};function d(b){return Object.resolve(a).translate(b)}return c});

define('text!ui/elements/select/template.html',[],function () { return '<div class="mi-select-container" data-bind="event:{click:toggleOptions,\r\n                                                    mousedown:handleMouseDown},\r\n    css:{\'disabled\':disabled,\'open\':isOpen,\'required\': isRequired }">\r\n    <div data-bind="css:{\'active\':isOpen}" class="mi-dropdown-selector">\r\n        <div data-bind="visible:multiple,\r\n    event:{click:toggleSelectAll},\r\n    css:{\'dx-checkbox-indeterminate\':selectedOptions().length && selectedOptions().length !== options().length ,\r\n        \'dx-checkbox-checked\':selectedOptions().length === options().length}" \r\n             class="pull-left dx-select-checkbox dx-datagrid-checkbox-size dx-widget dx-checkbox" tabindex="0" onclick="void(0)">\r\n            <div class="dx-checkbox-container">\r\n                <span class="dx-checkbox-icon"></span>\r\n            </div>\r\n        </div>\r\n        <input type="text" class="mi-selected-value-text pull-left"\r\n               data-bind="value:text,\r\n    valueUpdate:\'keyup\',\r\n    attr:{\'readonly\':(!editable() || disabled() || multiple() || isMobile),\r\n           \'title\': text},\r\n    css:{\'multi\':multiple},\r\n    event: {keyup: handleKeyUpOnTextInput,\r\n            keydown:handleKeyDownOnTextInput,\r\n            click:handleKeyUpOnTextInput,\r\n            mousedown:handleKeyUpOnTextInput},\r\n    hasFocus:textFocus" /> \r\n        <i class="icon-arrow pull-right"></i>\r\n        <!--disable:(!editable() || disabled() || multiple())<span class="mi-selected-value-text pull-left" data-bind="text:selectedValueText()"></span> <span class="fa fa-angle-down pull-right"></span>-->\r\n    </div>\r\n\r\n</div>';});


define('text!ui/elements/select/options-template.html',[],function () { return '<div data-bind="visible:isOpen(),event:{mousedown:$root.handleMouseDown}" class="mi-select-options-container">\r\n\r\n    <p class="mi-select-caption" data-bind="visible:optionsCaption() && optionsCaption().trim(),text:optionsCaption,event:{\r\n                                    click:function(data,event){selectValue($root,null,event);}},\r\n                                    css:{\'mi-select-option\':optionsCaption}\r\n                                "></p>\r\n\r\n    <!-- ko ifnot:optionsGroup -->\r\n    <!-- ko foreach:filteredOptions -->\r\n    <p class="mi-select-option" data-bind="html:$parent.wrapOptionText($data),event:{\r\n                                                    click:function(data,event){$parent.selectValue($parent,data,event);}},\r\n                                                    css:{\'active\':$parent.isActive($data)},\r\n                                                    attr:{\'data-index\':$index()}">\r\n    </p>\r\n    <!-- /ko -->\r\n    <!-- /ko -->\r\n    <!-- ko if:optionsGroup -->\r\n    <!-- ko foreach:Object.keys(filteredOptions()) -->\r\n\r\n    <strong class="mi-select-group-title" data-bind="text:$data,visible:$data !== \'undefined\',click:$root.handleMouseDown"></strong>\r\n    <!-- ko foreach:$root.filteredOptions()[$data] -->\r\n    <p class="mi-select-option" data-bind="html:$root.wrapOptionText($data),event:{\r\n                                                                            click:function(data,event){$root.selectValue($root,data,event);}},\r\n                                                                            css:{\'active\':$root.isActive($data)},\r\n                                                                            attr:{\'data-index\':$index()}">\r\n    </p>\r\n    <!-- /ko -->\r\n    <!-- /ko -->\r\n    <!-- /ko -->\r\n</div>\r\n';});

define('system/knockout/bindings/halt-bindings',['require','knockout'],function(require){"use strict";var a=require("knockout");a.bindingHandlers["halt-bindings"]||(a.bindingHandlers["halt-bindings"]={init:function(){return{controlsDescendantBindings:!0}}});function b(a){return Element.build("div",a,null,{"data-bind":"halt-bindings: true"})}return{createElement:b}});
define('ui/elements/select/mi-property',['require','lodash','jquery','knockout'],function(require){"use strict";var a=require("lodash"),b=require("jquery"),c=require("knockout"),d="property-changed-event-handlers",e=1;if(!c.bindingHandlers.miproperty){c.bindingHandlers.miproperty={init:function(e,f){var h,i=b(e),j={},k=g(f());a.each(k,function(b,c){h=function(b,d){var e=f()[c];a.isFunction(e)&&e(d)},j[c]=h,i.on("attributes."+c+":changed",h),i.on("properties."+c+":changed",h)}),c.utils.domData.set(e,d,j),c.utils.domNodeDisposal.addDisposeCallback(e,function(){var b=c.utils.domData.get(e,d);a.each(f(),function(a,c){i.off("attributes."+c+":changed",b[c]),i.off("properties."+c+":changed",b[c])})})},update:function(d,h){var i,j=g(h());f(d,!1),a.each(j,function(f,g){i=c.unwrap(f),"object"==typeof i&&!a.isEqual(b(d).data(g.toLowerCase()),i)||""===i?(b(d).data(g.toLowerCase(),i),b(d).attr("data-"+g.toLowerCase(),e),e++):(b(d).data(g.toLowerCase(),i),b(d).attr("data-"+g.toLowerCase(),i))}),f(d,!0)}};var f=function(a,d){if(b(a).find(".mi-select-container")[0]){
var e=c.contextFor(b(a).find(".mi-select-container")[0]).$data;e.propertiesUpdateDone&&e.propertiesUpdateDone(d)}},g=function(a){for(var b={},c=["addCaption","multiple","editable","value","selectedOptions","optionsCaption","optionsText","optionsValue","optionsGroup","disabled","required","options"],d=0;d<c.length;d++)void 0!==a[c[d]]&&(b[c[d]]=a[c[d]]);return b}}});
define('ui/elements/select/element',['require','lodash','jquery','jquery','knockout','system/lang/converter','system/knockout/knockout-manager','system/knockout/bindings/halt-bindings','./mi-property'],function(require){"use strict";var a=require("lodash"),b=require("jquery"),c=require("jquery"),d=require("knockout"),e=require("system/lang/converter"),f=require("system/knockout/knockout-manager");require("system/knockout/bindings/halt-bindings"),require("./mi-property");function g(a,b){var c=Object.create(HTMLElement.prototype);c.createdCallback=function(){this.implementation=Object.resolve(b,this),this.implementation.element=this,Object.tryMethod(this.implementation,"created")},c.attachedCallback=function(){this.implementation&&Object.tryMethod(this.implementation,"attached")},c.detachedCallback=function(){this.implementation&&(Object.tryMethod(this.implementation,"detached"),this.implementation=null)},c.attributeChangedCallback=function(a,b,c){Object.tryMethod(this.implementation,a.toLowerCase()+"Changed",b,c)},c.getControl=function(){return this.implementation},Element.registerElement(a,{prototype:c})}var h=function(){function a(a,b,c){this.kom=Object.resolve(f),
this.properties=[],this.view=a,this.preserveContext=b||!1,this.appendAfterBindings=c||!1,this.container=null,this.element=null,this.state=null}a.prototype.created=function(){Object.tryMethod(this,"beforeCreated"),c(this),Object.tryMethod(this,"afterCreated")},a.prototype.attached=function(){Object.tryMethod(this,"beforeAttached"),e(this),Object.tryMethod(this,"afterAttached")},a.prototype.detached=function(){Object.tryMethod(this,"beforeDetached"),g(this),Object.tryMethod(this,"afterDetached"),this.kom.dispose(),this.kom=null,this.properties=null,this.view=null,this.preserveContext=null,this.appendAfterBindings=null,this.state=null,this.container=null},a.prototype.bindAttribute=function(a,c,d,e){var f=e||!1;this["data-"+a.toLowerCase()+"Changed"]=function(c,d){var e=b(this.element).data(a.toLowerCase());this[a]&&this[a](e)}.bind(this),this.kom.subscribe(this[a],function(c){f||b(this.element).trigger("attributes."+a+":changed",[c])},this),d&&this.kom.subscribe(this[a],d,this),
void 0===b(this.element).attr("data-"+a.toLowerCase())?this.element.setAttribute("data-"+a.toLowerCase(),c):this[a](b(this.element).data(a.toLowerCase()))},a.prototype.bindProperty=function(a,c,d,e){this[a]=this.kom.observable();var f=e||!1;Object.defineProperty(this.element,a,{get:function(){return this[a]()}.bind(this),set:function(b){this[a]&&this[a](b)}.bind(this)}),this.properties.push(a),this.kom.subscribe(this[a],function(c){f||b(this.element).trigger("properties."+a+":changed",[c])},this),d&&this.kom.subscribe(this[a],d,this),this[a](Object.defaultValue(this.element[a],c))},a.prototype.bindArrayProperty=function(a,c,d,e){this[a]=this.kom.observableArray();var f=e||!1;Object.defineProperty(this.element,a,{get:function(){return this[a]()}.bind(this),set:function(b){this[a](b)}.bind(this)}),this.properties.push(a),this.kom.subscribe(this[a],function(c){f||b(this.element).trigger("properties."+a+":changed",[c])},this),d&&this.kom.subscribe(this[a],d,this),
this[a](Object.defaultValue(this.element[a],c))};function c(a){a.state="created";var c=document.createElement("div"),d=b(c),e=b(a.view);a.preserveContext||d.attr("data-bind","halt-bindings"),d.append(e),a.appendAfterBindings||b(a.element).empty().append(d),a.container=c}function e(a){if("detached"===a.state){var c=document.createElement("div"),e=b(c),f=b(a.view);a.preserveContext||e.attr("data-bind","halt-bindings"),e.append(f),a.appendAfterBindings||b(a.element).empty().append(e),a.container=c}a.state="attached",d.applyBindingsToDescendants(a,a.container),a.appendAfterBindings&&b(a.element).empty().append(a.container)}function g(a){a.state="detached",d.cleanNode(a.container),b(a.container).remove()}function h(a,b){delete a[b]}return a}();function i(b,d){window.CustomElements&&(window.CustomElements.useNative||(a.isArray(b)?j(b,d):a.isString(b)?k(b,d):b instanceof c?l(b):m(b)))}function j(a,b){for(var c=0;c!==a.length;c++)i(a[c],b)}function k(a,c){c&&c.$element&&(c=c.$element),
l(b(a,c))}function l(a){a.each(function(a,b){m(b)})}function m(a){window.CustomElements.upgrade(a)}function n(b,c,d,e){var f,g=document.createElement(b);if(c&&c.appendChild(g),d)for(f=0;f!==d.length;f++)g.classList.add(d[f]);return e&&a.each(e,function(a,b){e.hasOwnProperty(b)&&g.setAttribute(b,a)}),g}function o(a,b,c){var d=a.getAttribute(b);return d?e.toBoolean(d,"true"):c}function p(a,b,c){var d=a.getAttribute(b);return d?e.toInteger(d):c}function q(a,b,c){var d=a.getAttribute(b);return d?e.toString(d):c}function r(a){for(;a.firstChild;)a.removeChild(a.firstChild)}return{register:g,ViewModel:h,upgrade:i,build:n,booleanAttribute:o,intAttribute:p,stringAttribute:q,clearDom:r}});
define('ui/elements/select/view-model',['require','lodash','jquery','text!./template.html','text!./options-template.html','knockout','spa/region','./element','system/hardware/device','system/lang/string','system/lang/object'],function(require){"use strict";var a=require("lodash"),b=require("jquery"),c=require("text!./template.html"),d=require("text!./options-template.html"),e=require("knockout"),f=require("spa/region"),g=require("./element"),h=Object.resolve(require("system/hardware/device"));require("system/lang/string"),require("system/lang/object");function i(a){j.call(this,c,!1,!1);var b=this;this.element=a,this.isOpen=null,this.selectedItem=null,this.text=null,this.showAllOptions=null,this.textFocus=null,this.keyPressed=null,this.optionsValue=null,this.optionsText=null,this.optionsGroup=null,this.multiple=null,this.optionsCaption=null,this.options=null,this.value=null,this.required=null,this.disabled=null,this.editable=null,this.selectedOptions=null,this.isRequired=null,this.currentText=null,this.currentMatchedOptions=null,this._selectedOptions=[],this.updated_selectedOptions=!1,this.propertiesUpdateDone=!0,this.selectedValueText=null,this.filteredOptions=null,this.isMobile=h.isMobile(),
this.optionsRegion=new f("","blah"),b.optionsContainerDiv=null,this.isClicked=!1,this.documentHandlerFn=w.bind(null,b),this.isRequiredSubscriber=null,this.filteredOptionsSubscriber=null}var j=Object.inherit(g.ViewModel,i);function k(b){if(!b.options)return[];var c=[].concat(b.options()),d=b.text(),f=[],g=b.optionsGroup(),h=c,i=[],j,k=b.optionsCaption(),n,o;if(c&&c.length)if(i=m(b,h,d),j=k!==d,!b.showAllOptions()&&("object"!=typeof b.options()[0]||b.optionsText())&&b.text()&&"object"!=typeof b.text()&&j&&b.keyPressed()&&(d=l(d),n=new RegExp(d.trim(),"i"),o=e.utils.arrayFilter(c,function(a){var c=b.getOptionText(a);return n.test(c)}),(!i||i&&o.length>1)&&(h=o.length?o:c)),"object"==typeof h[0]&&g){var p=a.groupBy(h,g),q={undefined:[]};f=p?p:q}else f=h;return f}function l(a){return a=a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}i.prototype.beforeAttached=function(){var c=this;this.init(),b(document).off("mousedown",this.documentHandlerFn).on("mousedown",this.documentHandlerFn),
this.bindAttribute("multiple",!1,C.bind(null,this),!0),this.bindAttribute("editable",!0,null,!0),this.bindAttribute("value",null,D.bind(null,this),!0),this.bindAttribute("selectedOptions",[],E.bind(null,this),!0),this.bindAttribute("optionsCaption",null,null,!0),this.bindAttribute("optionsText",null,null,!0),this.bindAttribute("optionsValue",null,null,!0),this.bindAttribute("optionsGroup",null,null,!0),this.bindAttribute("disabled",!1,q.bind(null,c),!0),this.bindAttribute("required",!1,null,!0),this.bindAttribute("options",[],B.bind(null,c),!0),this.resizeProxy=b.proxy(a.debounce(this.resize,100),this),this.scrollProxy=b.proxy(this.resize,this)},i.prototype.init=function a(){var b=this;this.isOpen=e.observable(!1),this.keyPressed=e.observable(),this.selectedItem=e.observable(),this.text=e.observable(),this.showAllOptions=e.observable(!1),this.textFocus=e.observable(),this.optionsValue=e.observable(),this.optionsText=e.observable(),this.optionsGroup=e.observable(),
this.multiple=e.observable(!1),this.optionsCaption=e.observable(""),this.options=e.observableArray([]),this.value=e.observable(),this.required=e.observable(!1),this.disabled=e.observable(!1),this.editable=e.observable(!0),this.selectedOptions=e.observableArray([]),this.propertiesUpdateDone=e.observable(!0),this.isRequired=e.computed(o.bind(b,b)),this.isRequiredSubscriber=this.isRequired.subscribe(r.bind(b,b)),this.selectedValueText=e.computed(y.bind(null,this)),this.filteredOptions=e.computed(k.bind(null,this)),this.filteredOptionsSubscriber=this.filteredOptions.subscribe(p.bind(b,b))};function m(b,c,d){return d!==b.currentText&&(b.currentText=d,b.currentMatchedOptions=a.find(c,n.bind(b,b,d))),b.currentMatchedOptions}function n(a,b,c){var d=a.getOptionText(c);return d&&d.toString()===b.toString()}function o(a){return a.required()&&!a.hasValue()}function p(a,b){a.setOptionContainerPosition.bind(null,a)(b),M.bind(null,a)(b)}function q(a,c){
c?b(a.element).addClass("mi-select-disabled"):b(a.element).removeClass("mi-select-disabled")}function r(a,c){a.isRequired()?b(a.element).addClass("mi-select-required"):b(a.element).removeClass("mi-select-required")}i.prototype.afterAttached=function(){var a=this},i.prototype.afterDetached=function(){this.isOpen(!1),b(this.optionsContainerDiv).remove(),this.isOpen=null,this.selectedItem=null,this.text=null,this.showAllOptions=null,this.textFocus=null,this.optionsValue=null,this.optionsText=null,this.optionsGroup=null,this.multiple=null,this.optionsCaption=null,this.options=null,this.value=null,this.required=null,this.disabled=null,this.editable=null,this.selectedOptions=null,this.isRequired=null,this.keyPressed=null,this.selectedValueText=null,this.filteredOptions=null,b(document).off("mousedown",this.documentHandlerFn),this.isRequiredSubscriber&&this.isRequiredSubscriber.dispose(),this.filteredOptionsSubscriber&&this.filteredOptionsSubscriber.dispose()},
i.prototype.selectValue=function(c,d,e){if(e&&(e.preventDefault(),e.stopPropagation()),c.disabled())return!1;if(c.multiple()){if(c.multiple()){if(!d)return!0;var f=c.selectedOptions(),g=f||[],h=c.getOptionValue(d);b.inArray(h,c.selectedOptions())===-1?(c._selectedOptions.push(d),g.push(h)):(c._selectedOptions=b.grep(c._selectedOptions,function(a){return c.getOptionValue(a)!==h}),g=b.grep(g,function(a){return a!==h})),c.updated_selectedOptions=!0,c.selectedOptions(g),b(c.element).trigger("properties.selectedOptions:changed",[g]),c.textFocus(!0)}}else{var i;if(c.selectedItem(d),a.isEqual(d,c.value()))y(c);else{if(d){var j=c.getOptionValue(d);return i=j,c.isOpen(!1),u(c),c.value&&c.value(j),b(c.element).trigger("properties.value:changed",[i]),b(c.element).trigger("selected",[c.value?c.value():c.value]),!0}c.value("");var k=c.optionsCaption()?c.optionsCaption():"";c.text(k),i="",b(c.element).trigger("properties.value:changed",[i])}c.textFocus(!0),c.isOpen(!1),u(c),
b(c.element).trigger("selected",[c.value()])}return!0},i.prototype.toggleSelectAll=function(a,c){var d=this;if(d.disabled())return!0;if(d.selectedOptions().length||d.selectedOptions().length===d.options().length)d._selectedOptions=[],d.updated_selectedOptions=!0,d.selectedOptions([]),b(d.element).trigger("properties.selectedOptions:changed",[[]]);else if(!d.selectedOptions().length){var e=s(d.options(),d.getOptionValue.bind(d));d._selectedOptions=d.options(),d.updated_selectedOptions=!0,d.selectedOptions(e),b(d.element).trigger("properties.selectedOptions:changed",[e])}return!0};function s(a,b){var c=[],d;for(d=0;d<a.length;d++)c.push(b(a[d]));return c}i.prototype.toggleOptions=function(a,c){c.stopPropagation();var d=this;return!(d.disabled()||d.options()&&!d.options().length)&&(d.isClicked=!0,b(document).trigger("mousedown",[d.element]),this.showAllOptions(!0),d.isOpen()?(u(d),b(d.element).trigger("selected",[d.multiple()?d.selectedOptions():d.value()])):(F(d),t(d)),
d.isOpen()||b(d.optionsContainerDiv).css("visibility","hidden"),d.textFocus()||d.textFocus(!0),d.isOpen(!d.isOpen()),!0)};function t(a){b(a.element).parents().on("scroll",a.scrollProxy)}function u(a){b(a.optionsContainerDiv).css("visibility","hidden"),b(a.element).parents().off("scroll",a.scrollProxy),L(a)}i.prototype.showOptions=function(a){var c=this;this.showAllOptions(c.multiple()),this.isOpen()||13===a.keyCode||c.disabled()||(b(c.optionsContainerDiv).css("visibility","hidden"),c.isClicked=!0,b(document).trigger("mousedown",[c.element]),this.isOpen(!0),F(this),t(c))},i.prototype.handleMouseDown=function a(b,c){return c.stopPropagation(),!0},i.prototype.handleKeyUpOnTextInput=function a(b,c){return c.stopPropagation(),this.isOpen()||this.keyPressed(!1),"keyup"===c.type&&this.keyPressed(!0),this.showOptions(c),!0},i.prototype.handleKeyDownOnTextInput=function a(c,d){var e=this,f;if(d.stopPropagation(),b(e.element).trigger("textChange",[d]),9===d.keyCode)e.isOpen(!1),u(e),f=!e.text(),
y(e),b(e.element).trigger("selected",[e.multiple()?e.selectedOptions():e.value()]),x(e,f);else{if(8===d.keyCode&&(e.multiple()||e.disabled()))return!1;this.showAllOptions(e.multiple()),J.bind(null,e)(d)}return!0},i.prototype.getValue=function(a){return"function"==typeof a?a():a},i.prototype.getReturnValue=function(a,b){return"function"==typeof a?b?a.call(b,b):b:b?b[a]:b},i.prototype.getOptionText=function(a){var b=this;return a&&b.optionsText()?b.getValue(b.getReturnValue(b.optionsText(),a)):a},i.prototype.getOptionValue=function(a){var b=this;return a&&b.optionsValue()?b.getValue(b.getReturnValue(b.optionsValue(),a)):a},i.prototype.hasValue=function(){var a=this;if(a.multiple()){if(a.selectedOptions()&&0===a.selectedOptions().length)return!1}else if(!a.value())return!1;return!0},i.prototype.isActive=function(c){var d=this
;return d.multiple()?b.inArray(d.getOptionValue(c),d.selectedOptions())!==-1:"object"!=typeof d.value()||d.optionsValue()?d.getOptionValue(c)===d.value():a.isEqual(c,d.value())},i.prototype.resize=function(){this.isOpen(!1),v(this)},i.prototype.wrapOptionText=function(a){var b=this,c=b.getOptionText(a),d=b.text(),e,f=c,g=b.options(),h;return h=m(b,g,d),c&&d&&d.trim()&&!h&&(d=l(d),e=new RegExp(d,"gi"),c&&"string"==typeof c&&(c=R(c)),f=c.replace(e,function(a){return"<b>"+a+"</b>"}),f=f.replace(/ /g,"&nbsp;")),f&&"string"==typeof f&&(f=R(f)),f},i.prototype.setFocus=function b(){var c=this;a.defer(c.showOptions.bind(c,{}))};function v(a){u(a)}function w(a,c){var d;a.isClicked?a.isClicked=!1:(a.isOpen&&a.isOpen()&&(a.isOpen(!1),u(a),b(a.element).trigger("selected",[a.multiple()?a.selectedOptions():a.value()]),d=!a.text()),y(a),x(a,d))}function x(a,c){
if(c)if(a.multiple()||null!==a.optionsCaption()&&""!==a.optionsCaption()||!a.options()||!a.options().length)!a.multiple()&&a.options()&&a.options().length&&(a.value(""),b(a.element).trigger("properties.value:changed",[""]));else{var d=a.getOptionValue(a.options()[0]);a.value(d),b(a.element).trigger("properties.value:changed",[d])}}function y(a,c){if(a.options){var d=null,e=a.options(),f=null,g=null,h="";if(!a.multiple()&&(null===a.optionsCaption()||""===a.optionsCaption())&&!a.value()&&a.options()&&e.length&&a.propertiesUpdateDone()){var i=a.getOptionValue(e[0]);a.value(i),b(a.element).trigger("properties.value:changed",[i])}if(a.multiple()){if(a.options()&&e.length&&a.selectedOptions()&&a.selectedOptions().length){var j=a.selectedOptions(),k="",l;return k=s(a._selectedOptions,a.getOptionText.bind(a)).join(" | "),h=k,a.text(h),h}}else if((null!==a.value()||""!==a.value())&&a.options()&&e.length){for(var m=0;m<e.length;m++)if(g=A(a,e[m],a.value())){d=g;break}
if(d)return h=a.getOptionText(d),a.text(h),h}return h=a.optionsCaption()||"",a.text(h),h}}function z(a,b,c){for(var d=[],e,f=0;f<c.length;f++){var g=c[f];if(null!==g)for(var h=0;h<b.length;h++)if(e=A(a,b[h],g)){d.push(e);break}}return d}function A(b,c,d){var e=b.getOptionValue(c),f=null;return void 0===d||null===d||void 0===e||null===e?f:("function"==typeof d.numericValue&&null!==d.numericValue()&&(d=d.numericValue()),b.optionsValue()?e.toString()===d.toString()&&(f=c):c===d.toString()?f=c:"object"==typeof d&&a.isEqual(d,c)&&(f=c),f)}function B(a,b){b.length||(a.value,a.selectedOptions&&a.selectedOptions([])),a.multiple()&&a.selectedOptions&&(a.updated_selectedOptions||(a._selectedOptions=z(a,b,a.selectedOptions()),y(a)),a.updated_selectedOptions=!1)}function C(a){}function D(a,c){null!==c&&b(a.element).trigger("valueChange",[c])}function E(a,c){if(a.multiple()){var d=a.options();a.updated_selectedOptions||(a._selectedOptions=z(a,d,c)),a.updated_selectedOptions=!1,
b(a.element).trigger("valueChange",[c])}}function F(a){a.optionsCaption()===a.text()&&a.text(""),G(a),a.setOptionContainerPosition(a),setTimeout(function(a){if("function"==typeof a.options&&"function"==typeof a.text){var c=m(a,a.options(),a.text());a.text()&&a.optionsCaption()!==a.text()&&c&&!a.isMobile&&b(a.element).find(".mi-selected-value-text").select()}}.bind(a,a),100)}function G(a){var c,f;b("body").find(".select-outer-container").length?c=b("body").find(".select-outer-container"):(c=document.createElement("div"),b(c).addClass("select-outer-container"),document.body.appendChild(c)),a.optionsContainerDiv||(f=document.createElement("div"),a.optionsContainerDiv=f,b(f).css("visibility","hidden"),b(c).append(f),a.optionsRegion.setElement(f),a.optionsRegion.attach(d),e.applyBindings(a,a.optionsRegion.activeContainer))}i.prototype.setOptionContainerPosition=function(a){var c,d,e,f,g,h,i,j=a.optionsContainerDiv;if(j){if(e=b(a.element).outerHeight(),
c=b(a.container).find(".mi-dropdown-selector").offset(),d=b(a.container).find(".mi-dropdown-selector").width(),!c)return;a.topOffset=c?c.top:0,a.leftOffset=c?c.left:0,b(j).css({position:"absolute","min-width":d,"z-index":1e5}),b(a.element).closest(".dialog-wrapper").length>0&&b(j).css({"max-width":d}),setTimeout(H.bind(null,a,j,c,d,e),1)}};function H(a,c,d,e,f){var g=b(c).outerWidth(),i=b(c).outerHeight(),j,k,l=b(c).find(".mi-select-options-container");l.removeClass("top-left top-right bottom-left bottom-right"),!a.isMobile&&h.innerHeight()<700&&b(".select-outer-container .mi-select-options-container").css("max-height","200px"),d.top+i+50>=b(window).height()?(j=d.top-i-20,d.left+e-g<80?(k=d.left,l.addClass("top-left")):(k=d.left-Math.abs(e-g),l.addClass("top-right"))):(j=a.topOffset+f+10,d.left+e-g<80?(k=d.left,l.addClass("bottom-left")):(k=d.left-Math.abs(e-g)+7,l.addClass("bottom-right"))),b(c).css({left:k,top:j,visibility:"visible"}),
b(c).find(".mi-select-option").hasClass("focus")||!a.multiple||a.multiple()||Q(a,"active")}function I(a){}function J(a,b){switch(b.keyCode){case 40:b.preventDefault(),O(a,b);break;case 38:b.preventDefault(),P(a,b);break;case 13:b.preventDefault(),K(a,b);break;default:return}}function K(a,c){var d=a.optionsContainerDiv,f=b(d).find(".mi-select-option.focus");if(f.length&&e.contextFor(b(f[0]).get(0))){var g=e.contextFor(b(f[0]).get(0)).$data;b(f[0]).hasClass("mi-select-caption")&&(g=null),a.selectValue(a,g,c),a.multiple()||(a.isOpen(!1),v(a),b(a.element).trigger("selected",[a.value()]),a.textFocus(!0))}}function L(a){var c=a.optionsContainerDiv;b(c).find(".mi-select-option").removeClass("focus")}function M(a){setTimeout(N.bind(null,a),10)}function N(a){if(!a.options||a.multiple&&a.multiple()||a.isOpen&&!a.isOpen())return!1;var c=a.options(),d=a.text(),e=!1,f=a.optionsContainerDiv;if(c&&c.length&&(e=m(a,c,d)),!e&&d&&d!==a.optionsCaption()){L(a);var g=a.optionsCaption()?1:0
;b(b(f).find(".mi-select-option")[g]).addClass("focus"),Q(a)}else e&&d&&d!==a.optionsCaption()&&(L(a),b(b(f).find(".mi-select-option")).filter(function(){return b(this).text()===d}).addClass("focus"),Q(a));!d&&a.value()&&(L(a),a.value()&&Q(a,"active"))}function O(a){var c=a.optionsContainerDiv,d=b(c).find(".mi-select-option.focus"),e=b(c).find(".mi-select-option.active"),f;b(c).find(".mi-select-option").removeClass("focus"),f=d.length&&b(d).nextAll(".mi-select-option:first").length?b(d).nextAll(".mi-select-option:first"):d.length&&!b(d).nextAll(".mi-select-option:first").length?b(b(c).find(".mi-select-option")[0]):e.length?b(e).nextAll(".mi-select-option:first"):b(b(c).find(".mi-select-option")[0]),f.addClass("focus");var g=a.options(),h=a.text(),i;g&&g.length&&((i=m(a,g,h))||a.optionsCaption()&&a.optionsCaption()===h)&&a.text(f.text()),Q(a)}function P(a){var c=a.optionsContainerDiv,d=b(c).find(".mi-select-option.focus"),e=b(c).find(".mi-select-option.active"),f
;b(c).find(".mi-select-option").removeClass("focus"),f=d.length&&b(d).prevAll(".mi-select-option:first").length?b(d).prevAll(".mi-select-option:first"):d.length&&!b(d).prevAll(".mi-select-option:first").length?b(c).find(".mi-select-option").last():e.length?b(e).prevAll(".mi-select-option:first"):b(b(c).find(".mi-select-option")[0]),f.addClass("focus");var g=a.options(),h=a.text(),i;g&&g.length&&((i=m(a,g,h))||a.optionsCaption()&&a.optionsCaption()===h)&&a.text(f.text()),Q(a)}function Q(a,c){var d=a.optionsContainerDiv,e=c||"focus",f=b(d).find(".mi-select-option."+e);f&&f[0]&&(f[0].parentNode.scrollTop=f[0].offsetTop)}function R(a){return a.replace(/<([a-z]+)([^>]*[^\/])?>(?![\s\S]*<\/\1)/gi,function(a){return b("<div/>").text(a).html()})}return g.register("mi-select",i),i});

define('text!ui/elements/multi-value/template.html',[],function () { return '<div class="mi-multi-value-container" data-bind="visible:visible,css:{\'disabled\':disabled,\'open\':isOpen,\'required\':isRequired}">\r\n    <div data-bind="css:{\'active\':isOpen},clickBubble: false, hasFocus:textFocus, event:{\r\n            keyup: handleKeyUpOnTextInput,\r\n            keydown:handleKeyDownOnTextInput,\r\n            click:handleKeyUpOnTextInput,\r\n            mousedown:handleKeyUpOnTextInput\r\n         }" class="mi-multi-value-selector">\r\n        <input type="text" class="mi-multi-value-selected-value-text pull-left" data-bind="value:text,\r\n                                                                                            valueUpdate:\'keyup\',\r\n             \r\n                                                                                            attr:{\'readonly\':(disabled() || multiple() || isMobile),\r\n                                                                                                   \'disabled\':disabled()},\r\n                                                                                            event:{keyup: handleKeyUpOnTextInput}" />\r\n        <!--<span class="mi-multi-value-selected-value-text pull-left" data-bind="text:selectedValueText"></span>-->\r\n        <i class="icon-arrow pull-right"></i>\r\n    </div>\r\n</div>';});


define('text!ui/elements/multi-value/options-template.html',[],function () { return '<div data-bind="visible:isOpen(),event:{mousedown:function(data,event){event.stopPropagation();}}" class="mi-multi-value-options-container">\r\n    <p class="mi-multi-value-option mi-multi-value-input" data-bind="event:{mousedown:inputMouseDown}">\r\n        <input type="text" data-bind="attr:{ placeholder: addCaptionText}, value:addValue,event:{\'keydown\':addValueUpdate}" />\r\n    </p>\r\n\r\n   <!-- ko if:optionsCaption -->\r\n    <p class="mi-multi-value-option mi-multi-value-caption" data-bind="text:optionsCaption,\r\n                                                                       event:{click:function(data,event){$root.selectValue($root,null,event);}}"></p>\r\n    <!-- /ko -->\r\n\r\n    <!-- ko foreach:filteredOptions -->\r\n    <p class="mi-multi-value-option" data-bind="text:$parent.getOptionText($data),\r\n                                            event:{click:function(data,event){$root.selectValue($root,data,event);}},\r\n                                            css:{\'active\':$parent.isActive($data)}">\r\n\r\n    </p>\r\n    <!-- /ko -->\r\n     \r\n   \r\n\r\n  \r\n\r\n</div>\r\n';});

define('ui/elements/multi-value/view-model',['require','lodash','jquery','text!./template.html','text!./options-template.html','knockout','spa/region','system/globalization/translator','../select/element','system/hardware/device'],function(require){"use strict";var a=require("lodash"),b=require("jquery"),c=require("text!./template.html"),d=require("text!./options-template.html"),e=require("knockout"),f=require("spa/region"),g=require("system/globalization/translator"),h=require("../select/element"),i=Object.resolve(require("system/hardware/device"));function j(){k.call(this,c,!1,!0);var a=this;this.translator=Object.resolve(g),this.optionsValue=e.observable(),this.optionsText=e.observable(),this.multiple=e.observable(!1),this.optionsCaption=e.observable(""),this.options=e.observableArray([]),this.value=e.observable(),this.required=e.observable(!1),this.disabled=e.observable(!1),this.visible=e.observable(!0),this.selectedOptions=e.observableArray([]),this.autoAdd=e.observable(!0),this.onOptionAdd=e.observable(),this.addCaption=e.observable(this.translator.translate("MULTI_VALUE_ADD_OPTION_PLACEHOLDER")),this.text=e.observable(),this.textFocus=e.observable(!1),this.keyPressed=e.observable(!1),
this.currentText=null,this.isOpen=e.observable(!1),this.selectedItem=e.observable(),this.addValue=e.observable(),this.optionsRegion=new f,this.isClicked=!1,this.isMobile=i.isMobile(),this.isRequired=e.computed(p.bind(a,a)),this.isRequiredSubscriber=this.isRequired.subscribe(q.bind(a,a)),this.addCaptionText=e.computed(o.bind(null,this)),this.selectedValueText=e.computed(u.bind(null,this)),this.filteredOptions=e.computed(l.bind(null,this)),this.addValueUpdate=r,this.addValueSubscription=this.addValue.subscribe(a.addOption,this),this.documentHandlerFn=s.bind(null,a),this.filteredOptionsSubscriber=null}var k=Object.inherit(h.ViewModel,j);j.prototype.beforeAttached=function(){var a=this;this.filteredOptionsSubscriber=this.filteredOptions.subscribe(n.bind(a,a)),b(document).on("mousedown",this.documentHandlerFn)},j.prototype.afterDetached=function(){var a=this;b(window).off("resize",a.resizeProxy),b(a.element).parents().off("scroll",a.scrollProxy),b(a.element).off(),
b(document).off("mousedown",a.documentHandlerFn),a.translator=null,a.optionsValue=null,a.optionsText=null,a.multiple=null,a.optionsCaption=null,a.options=null,a.value=null,a.required=null,a.disabled=null,a.visible=null,a.selectedOptions=null,a.autoAdd=null,a.onOptionAdd=null,a.addCaption=null,a.text=null,a.textFocus=null,a.keyPressed=null,a.currentText=null,a.isOpen=null,a.selectedItem=null,a.addValue=null,a.optionsRegion&&(a.optionsRegion.detach(),a.optionsRegion=null),a.isClicked=null,a.isMobile=null,a.isRequired&&(a.isRequired.dispose(),a.isRequired=null),a.isRequiredSubscriber&&(a.isRequiredSubscriber.dispose(),a.isRequiredSubscriber=null),a.addCaptionText&&(a.addCaptionText.dispose(),a.addCaptionText=null),a.selectedValueText&&(a.selectedValueText.dispose(),a.selectedValueText=null),a.filteredOptions&&(a.filteredOptions.dispose(),a.filteredOptions=null),a.addValueUpdate=null,a.addValueSubscription&&(a.addValueSubscription.dispose(),a.addValueSubscription=null),
a.documentHandlerFn=null,a.filteredOptionsSubscriber&&(a.filteredOptionsSubscriber.dispose(),a.filteredOptionsSubscriber=null),a.resizeProxy=null,a.scrollProxy=null,a.optionsContainerDiv=null},j.prototype.inputMouseDown=function(a,b){b.stopPropagation(),b.target.focus()};function l(a){if(!a.options)return[];var b=[].concat(a.options()),c=a.text(),d=[],f=b,g=[],h,i=a.optionsCaption(),j,k;return b&&b.length?(g=F(a,f,c),h=i!==c,a.text()&&h&&a.keyPressed()&&(c=m(c),j=new RegExp(c.trim(),"i"),k=e.utils.arrayFilter(b,function(b){var c=a.getOptionText(b);return j.test(c)}),(!g||g&&k.length>1)&&(f=k.length?k:b)),d=null!==f?f:b):void 0}function m(a){return null!==a&&(a=a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")),a}function n(a,b){a.setOptionContainerPosition.bind(null,a)()}function o(a){return a.addCaption()||a.translator.translate("MULTI_VALUE_ADD_OPTION_PLACEHOLDER")}function p(a){return a.required()&&!a.hasValue()}function q(a,c){
a.isRequired()?b(a.element).addClass("mi-multi-value-required"):b(a.element).removeClass("mi-multi-value-required")}j.prototype.hasValue=function a(){var b=this;if(b.multiple()){if(b.selectedOptions()&&b.selectedOptions().length)return!1}else if(!b.value())return!1;return!0},j.prototype.addOption=function a(c){var d=c,e=this;if(c){if(("object"==typeof e.options()[0]||e.optionsText())&&(d={},d[e.optionsText()]=c,d[e.optionsValue()]=c),e.onOptionAdd(d),e.options.push(d),e.multiple()){if(e.multiple()){var f=e.selectedOptions();f.push(e.getOptionValue(d)),e.text(f),e.selectedOptions(f),b(e.element).trigger("properties.selectedOptions:changed",[e.selectedOptions()])}}else e.selectedItem(d),e.value(e.getOptionValue(d)),b(e.element).trigger("properties.value:changed",[e.value()]);e.addValue("")}};function r(a,b){switch(b.keyCode){case 13:b.target.blur(),b.target.focus();break;case 9:a.toggleOptions();break;case 40:b.preventDefault(),P(a,b,!0);break;case 38:b.preventDefault(),Q(a,b)}return!0}
function s(a){a.isClicked?a.isClicked=!1:(a.isOpen()&&(a.isOpen(!1),E(a),b(a.element).trigger("selected",[a.multiple()?a.selectedOptions():a.value()])),u(a))}j.prototype.afterAttached=function(){},j.prototype.afterCreated=function(){},j.prototype.beforeCreated=function(){var c=this;this.bindAttribute("optionsText",null),this.bindAttribute("optionsValue",null),this.bindAttribute("optionsCaption",null),this.bindAttribute("addCaption",null),this.bindAttribute("options",[],w.bind(null,this),!0),this.bindAttribute("value",null,z.bind(null,this),!0),this.bindAttribute("selectedOptions",[],null,!0),this.bindAttribute("disabled",!1),this.bindAttribute("required",!1),this.bindAttribute("visible",!0),this.bindAttribute("multiple",!1,x.bind(null,this)),this.bindAttribute("autoAdd",!0),this.bindAttribute("onOptionAdd",null),this.resizeProxy=b.proxy(a.debounce(this.resize.bind(null,this),100),this),this.scrollProxy=b.proxy(this.scrollHandler,this),
b(this.element).on("properties.options:changed",function(a,b){}.bind(this)),b(this.element).on("properties.value:changed",z.bind(null,this)),b(this.element).on("properties.multiple:changed",function(a,b){}.bind(this)),b(this.element).on("properties.size:changed",function(a,b){}.bind(this)),b(this.element).on("properties.selectedOptions:changed",A.bind(null,this))},j.prototype.selectValue=function(c,d,e){if(e&&(e.preventDefault(),e.stopPropagation()),c.disabled())return!1;if(c.multiple()){if(c.multiple()){if(!d)return!0;var f=c.selectedOptions(),g=f||[],h=c.getOptionValue(d);b.inArray(h,c.selectedOptions())===-1?g.push(h):g=b.grep(g,function(a){return a!==h}),c.selectedOptions(g),b(c.element).trigger("properties.selectedOptions:changed",[g]),c.textFocus(!0)}}else{var i;if(c.selectedItem(d),a.isEqual(d,c.value()))u(c);else{if(d){var j=c.getOptionValue(d);return i=j,c.textFocus(!0),c.isOpen(!1),E(c),c.value&&c.value(j),b(c.element).trigger("properties.value:changed",[i]),
b(c.element).trigger("selected",[c.value?c.value():c.value]),!0}c.value("");var k=c.optionsCaption()?c.optionsCaption():"";c.text(k),i="",b(c.element).trigger("properties.value:changed",[i])}c.textFocus(!0),c.isOpen(!1),E(c),b(c.element).trigger("selected",[c.value()])}return!0},j.prototype.toggleOptions=function(a,c){var d=this;return c&&c.stopPropagation(),d.disabled()||d.options()&&!d.options().length?(d.textFocus(!0),E(d),d.isOpen(!1),!1):(d.isClicked=!0,b(document).trigger("mousedown",[d.element]),d.isOpen()?(E(d),b(d.element).trigger("selected",[d.multiple()?d.selectedOptions():d.value()])):(C(d),D(d)),d.isOpen()||b(d.optionsContainerDiv).css("visibility","hidden"),d.textFocus()||d.textFocus(!0),d.isOpen(!d.isOpen()),!0)};function t(a){e.cleanNode(a.optionsRegion.activeContainer),b(".multi-value-outer-container").remove(),b(window).off("resize",a.resizeProxy),b(a.element).parents().off("scroll",a.scrollProxy)}function u(a){if(a.options){var b=null,c=a.options(),d=null,e=null,f=""
;if(a.multiple()){if(c&&a.selectedOptions()&&a.selectedOptions().length){for(var g=a.selectedOptions(),h="",i=0;i<g.length;i++){for(var j=g[i],k=0;k<c.length;k++)if(e=v(a,c[k],j)){b=e;break}var l=h?", ":"";h+=l+a.getOptionText(b)}return a.text(g),h}}else if(a.value()&&c){for(var m=0;m<c.length;m++)if(e=v(a,c[m],a.value())){b=e;break}if(b)return f=a.getOptionText(b),a.text(f),f}return f=a.optionsCaption()||"",a.text(f),f}}function v(b,c,d){var e=b.getOptionValue(c),f=null;return b.optionsValue()?e.valueOf()===d.valueOf()&&(f=c):c.valueOf()===d.valueOf()?f=c:"object"==typeof d&&a.isEqual(d,c)&&(f=c),f}j.prototype.getValue=function(a){var b=a;return"function"==typeof a&&(b=a()),b},j.prototype.getReturnValue=function(a,b){return"function"==typeof a?a.call(b,b):b?b[a]:b},j.prototype.getOptionText=function(a){var b=this;return b.optionsText()?b.getValue(b.getReturnValue(b.optionsText(),a)):a},j.prototype.getOptionValue=function(a){var b=this
;return b.optionsValue()?b.getValue(b.getReturnValue(b.optionsValue(),a)):a},j.prototype.isActive=function(c){var d=this;return d.multiple()?b.inArray(d.getOptionValue(c),d.selectedOptions())!==-1:null===d.getOptionValue(c)||null===d.value()?d.getOptionValue(c)===d.value():"object"!=typeof d.value()||d.optionsValue()?d.getOptionValue(c).valueOf()===d.value().valueOf():a.isEqual(c,d.value())},j.prototype.resize=function(a){a.isMobile||(a.isOpen(!1),t(a))},j.prototype.scrollHandler=function(){this.isOpen(!1),t(this)};function w(){}function x(a){}function y(a){}function z(a,c){b(a.element).trigger("valueChange",[c])}function A(a,b,c){}function B(a){this.option=a,this.isSelected=e.observable(!1)}function C(a){a.optionsRegion.$element.hasClass("multi-value-outer-container")&&a.optionsRegion.$element.remove();var c;c=document.createElement("div"),a.optionsContainerDiv=c,b(c).addClass("multi-value-outer-container"),document.body.appendChild(c),a.optionsRegion.setElement(c),
a.optionsRegion.attach(d),e.applyBindings(a,a.optionsRegion.activeContainer),a.setOptionContainerPosition(a)}j.prototype.setOptionContainerPosition=function(a){var c,d,e=30,f,g,h,i,j=a.optionsContainerDiv;j&&(c=b(a.container).find(".mi-multi-value-selector").offset(),d=b(a.container).find(".mi-multi-value-selector").width(),a.topOffset=c.top,a.leftOffset=c.left,b(j).css({position:"absolute","min-width":d,"z-index":1e5}),setTimeout(function(){f=b(j).width(),g=b(j).height(),b(j).find(".mi-multi-value-options-container").removeClass("top-left top-right bottom-left bottom-right"),c.top+g+50>=b(window).height()?(h=c.top-g-20,c.left+d-f<80?(i=c.left,b(j).find(".mi-multi-value-options-container").addClass("top-left")):(i=c.left-Math.abs(d-f),b(j).find(".mi-multi-value-options-container").addClass("top-right"))):(h=a.topOffset+e+10,c.left+d-f<80?(i=c.left,b(j).find(".mi-multi-value-options-container").addClass("bottom-left")):(i=c.left-Math.abs(d-f),
b(j).find(".mi-multi-value-options-container").addClass("bottom-right"))),b(j).css({left:i,top:h})},1))},j.prototype.showOptions=function a(c){var d=this;this.isOpen()||13===c.keyCode||d.disabled()||(b(d.optionsContainerDiv).css("visibility","hidden"),d.isClicked=!0,b(document).trigger("mousedown",[d.element]),this.isOpen(!0),C(this),D(d))},j.prototype.handleKeyUpOnTextInput=function a(b,c){return c.stopPropagation(),this.isOpen()||this.keyPressed(!1),"keyup"===c.type&&this.keyPressed(!0),this.showOptions(c),!0},j.prototype.handleKeyDownOnTextInput=function a(c,d){var e=this;if(d.stopPropagation(),b(e.element).trigger("textChange",[d]),9===d.keyCode)e.isOpen(!1),E(e),u(e),b(e.element).trigger("selected",[e.multiple()?e.selectedOptions():e.value()]);else{if(8===d.keyCode&&(e.multiple()||e.disabled()))return!1;H.bind(null,e)(d)}return!0};function D(a){b(a.element).parents().on("scroll",a.scrollProxy)}function E(a){b(a.optionsContainerDiv).css("visibility","hidden"),
b(a.element).parents().off("scroll",a.scrollProxy),J(a)}function F(b,c,d){return d!==b.currentText&&(b.currentText=d,b.currentMatchedOptions=a.find(c,G.bind(b,b,d))),b.currentMatchedOptions}function G(a,b,c){var d=a.getOptionText(c);return d&&d.toString()===b.toString()}function H(a,b){switch(b.keyCode){case 40:b.preventDefault(),P(a,b);break;case 38:b.preventDefault(),Q(a,b);break;case 13:b.preventDefault(),I(a,b);break;default:return}}function I(a,c){var d=a.optionsContainerDiv,f=b(d).find(".mi-multi-value-option.focus");if(f.length&&e.contextFor(b(f[0]).get(0))){var g=e.contextFor(b(f[0]).get(0)).$data;if(b(f[0]).hasClass("mi-multi-value-caption"))g=null;else if(K(a,f))return void L(a,f);a.selectValue(a,g,c),a.multiple()||(a.isOpen(!1),E(a),b(a.element).trigger("selected",[a.value()]),a.textFocus(!0))}}function J(a){var c=a.optionsContainerDiv;b(c).find("mi-multi-value-option").removeClass("focus")}function K(a,c){return b(c[0]).hasClass("mi-multi-value-input")}function L(a,c){
b(c[0]).find("input").focus()}function M(a,b){if(K(a,b))return L(a,b),!0;a.textFocus(!0)}function N(a){setTimeout(O.bind(null,a),10)}function O(a){if(!a.options||a.multiple&&a.multiple())return!1;var c=a.options(),d=a.selectedValueText(),e=!1,f=a.optionsContainerDiv;if(c&&c.length&&(e=F(a,c,d)),!e&&d&&d!==a.optionsCaption()){J(a);var g=a.optionsCaption()?1:0;b(b(f).find(".mi-multi-value-option")[g]).addClass("focus"),R(a)}else e&&d&&d!==a.optionsCaption()&&(J(a),b(b(f).find(".mi-multi-value-option")).filter(function(){return b(this).text()===d}).addClass("focus"),R(a));!d&&a.value()&&(J(a),a.value()&&R(a,"active"))}function P(a,c,d){var e=a.optionsContainerDiv,f=b(e).find(".mi-multi-value-option.focus"),g=b(e).find(".mi-multi-value-option.active"),h;b(e).find(".mi-multi-value-option").removeClass("focus"),
h=f.length&&b(f).nextAll(".mi-multi-value-option:first").length?b(f).nextAll(".mi-multi-value-option:first"):f.length&&!b(f).nextAll(".mi-multi-value-option:first").length?b(b(e).find(".mi-multi-value-option")[0]):g.length?b(g).nextAll(".mi-multi-value-option:first"):b(b(e).find(".mi-multi-value-option")[d?1:0]),h.addClass("focus"),M(a,h);var i=a.options(),j=a.selectedValueText(),k;i&&i.length&&((k=F(a,i,j))||a.optionsCaption()&&a.optionsCaption()),R(a)}function Q(a){var c=a.optionsContainerDiv,d=b(c).find(".mi-multi-value-option.focus"),e=b(c).find(".mi-multi-value-option.active"),f;b(c).find(".mi-multi-value-option").removeClass("focus"),f=d.length&&b(d).prevAll(".mi-multi-value-option:first").length?b(d).prevAll(".mi-multi-value-option:first"):d.length&&!b(d).prevAll(".mi-multi-value-option:first").length?b(c).find(".mi-multi-value-option").last():e.length?b(e).prevAll(".mi-multi-value-option:first"):b(b(c).find(".mi-multi-value-option")[0]),f.addClass("focus"),M(a,f)
;var g=a.options(),h=a.selectedValueText(),i;g&&g.length&&((i=F(a,g,h))||a.optionsCaption()&&a.optionsCaption()),R(a)}function R(a,c){var d=a.optionsContainerDiv,e=c||"focus",f=b(d).find(".mi-multi-value-option."+e);f&&f[0]&&(f[0].parentNode.scrollTop=f[0].offsetTop)}function S(a){return a.replace(/<([a-z]+)([^>]*[^\/])?>(?![\s\S]*<\/\1)/gi,function(a){return b("<div/>").text(a).html()})}return h.register("mi-multi-value",j),j});
define('assets/services/hierarchy-dto',['require','system/lang/converter'],function(require){"use strict";var a=require("system/lang/converter");function b(b){this.entityKey=a.toString(b.entityKey),this.description=a.toString(b.description),this.familyKey=a.toString(b.familyKey),this.familyId=a.toString(b.familyId),this.siteKey=a.toNullableString(b.siteKey),this.hasChildren=null,b.childCount&&(this.hasChildren=a.toInteger(b.childCount)>0),b.hierarchyPath&&(this.hierarchyPath=a.toString(b.hierarchyPath))}return b.fromDataCollection=function a(c){for(var d=[],e=0;e<c.length;e++)d[d.length]=new b(c[e]);return d},b});
define('assets/services/hierarchy-paging-dto',[],function(){"use strict";function a(a){this.page=a.page||1,this.pageSize=a.per_page||25,this.data=null}return a});
define('assets/services/taxonomy-dto',['require','lodash','system/lang/converter'],function(require){"use strict";var a=require("lodash"),b=require("system/lang/converter");function c(a,c){this.code=b.toString(a),this.description=b.toString(c),this.children=[]}return c.fromDataCollection=function b(d){for(var e=[],f=a.values(a.groupBy(d,"categoryCode")),g,h,i,j,k=0;k<f.length;k++){g=new c(f[k][0].categoryCode,f[k][0].categoryDescription),e[e.length]=g,h=a.values(a.groupBy(f[k],"classCode"));for(var l=0;l<h.length;l++){i=new c(h[l][0].classCode,h[l][0].classDescription),g.children[g.children.length]=i;for(var m=0;m<h[l].length;m++)j=new c(h[l][m].typeCode,h[l][m].typeDescription),i.children[i.children.length]=j}}return e},c});
define('assets/models/family',['require','system/lang/converter'],function(require){"use strict";var a=require("system/lang/converter");function b(b){b=b||{},this.key=a.toString(b.key),this.id=a.toString(b.id),this.caption=a.toString(b.caption)}return b.fromDataCollection=function a(c){var d,e=[];for(d=0;d<c.length;d++)e[d]=new b(c[d]);return e},b});
define('assets/models/field',['require','system/lang/converter'],function(require){"use strict";var a=require("system/lang/converter");function b(b){this.key=a.toString(b.key),this.caption=a.toString(b.caption)}return b});
define('assets/models/hierarchy-configuration',['require','system/lang/converter','assets/models/family','assets/models/field','system/knockout/knockout-manager'],function(require){"use strict";var a=require("system/lang/converter"),b=require("assets/models/family"),c=require("assets/models/field"),d=require("system/knockout/knockout-manager");function e(e){var h,i;if(e=e||{},this.kom=Object.resolve(d),this.entityKey=a.toString(e.entityKey),this.displayFieldKey=this.kom.observable(a.toString(e.displayFieldKey)),this.parentDisplayFieldKey=this.kom.observable(a.toString(e.parentDisplayFieldKey)),this.parentKey=this.kom.observable(a.toString(e.parentKey)),this.childKey=this.kom.observable(a.toString(e.childKey)),i=[],e.children)for(h=0;h<e.children.length;h++)i[i.length]=new b(e.children[h]);if(this.children=this.kom.observableArray(i),this.relationshipKey=this.kom.observable(a.toString(e.relationshipKey)),i=[],e.relationships)for(h=0;h<e.relationships.length;h++)i[i.length]=new b(e.relationships[h]);if(this.relationships=this.kom.observableArray(i),this.taxonomyCategoryFieldKey=this.kom.observable(a.toString(e.taxonomyCategoryFieldKey)),
this.parentTaxonomyCategoryFieldKey=this.kom.observable(a.toString(e.parentTaxonomyCategoryFieldKey)),this.taxonomyClassFieldKey=this.kom.observable(a.toString(e.taxonomyClassFieldKey)),this.parentTaxonomyClassFieldKey=this.kom.observable(a.toString(e.parentTaxonomyClassFieldKey)),this.taxonomyTypeFieldKey=this.kom.observable(a.toString(e.taxonomyTypeFieldKey)),this.parentTaxonomyTypeFieldKey=this.kom.observable(a.toString(e.parentTaxonomyTypeFieldKey)),this.level=this.kom.observable(a.toInteger(e.level)),i=[],e.fields)for(h=0;h<e.fields.length;h++)i[i.length]=new c(e.fields[h]);if(this.fields=this.kom.observableArray(i),i=[],e.parentFields)for(h=0;h<e.parentFields.length;h++)i[i.length]=new c(e.parentFields[h]);this.parentFields=this.kom.observableArray(i),this.isNotRecursive=this.kom.computed(g.bind(null,this)),this.kom.tracker.hashFunction=f.bind(null,this),this.kom.tracker.markCurrentStateAsClean()}e.prototype.isDirty=function(){return this.kom.isDirty()},
e.prototype.markClean=function(){this.kom.tracker.markCurrentStateAsClean()},e.prototype.dispose=function(){this.kom.dispose()};function f(a){var b;return b={level:a.level(),displayField:a.displayFieldKey(),parentFamilyKey:a.parentKey(),childFamilyKey:a.childKey(),relationshipKey:a.relationshipKey(),taxonomyCategeoryField:a.taxonomyCategoryFieldKey(),taxonomyClassField:a.taxonomyClassFieldKey(),taxonomyTypeField:a.taxonomyTypeFieldKey(),parentDisplayField:a.parentDisplayFieldKey(),parentTaxonomyCategeoryField:a.parentTaxonomyCategoryFieldKey(),parentTaxonomyClassField:a.parentTaxonomyClassFieldKey(),parentTaxonomyTypeField:a.parentTaxonomyTypeFieldKey()},JSON.stringify(b)}function g(a){return 0===a.level()&&a.parentKey()!==a.childKey()}return e});
define('assets/models/hierarchy-config-dto',[],function(){"use strict";function a(a){a=a||{},this.entityKey=a.entityKey,this.displayFieldKey=a.displayFieldKey(),this.parentKey=a.parentKey(),this.childKey=a.childKey(),this.relationshipKey=a.relationshipKey(),this.taxonomyCategoryFieldKey=a.taxonomyCategoryFieldKey(),this.taxonomyClassFieldKey=a.taxonomyClassFieldKey(),this.taxonomyTypeFieldKey=a.taxonomyTypeFieldKey(),this.level=a.level(),this.parentDisplayFieldKey=a.parentDisplayFieldKey(),this.parentTaxonomyCategoryFieldKey=a.parentTaxonomyCategoryFieldKey(),this.parentTaxonomyClassFieldKey=a.parentTaxonomyClassFieldKey(),this.parentTaxonomyTypeFieldKey=a.parentTaxonomyTypeFieldKey()}return a});
define('assets/adapters/hierarchy-config-adapter',['require','assets/models/hierarchy-configuration','assets/models/hierarchy-config-dto'],function(require){"use strict";var a=require("assets/models/hierarchy-configuration"),b=require("assets/models/hierarchy-config-dto");function c(){}return c.fromDTOArray=function(b){var c,d,e=[];for(c=0;c<b.length;c++)d=new a(b[c]),e[e.length]=d;return e},c.toDTO=function(a){return new b(a)},c});
define('assets/services/hierarchy-service',['require','jquery','system/http/ajax-client','assets/services/hierarchy-dto','assets/services/hierarchy-paging-dto','assets/services/taxonomy-dto','assets/services/asset-context-dto','assets/adapters/hierarchy-config-adapter','assets/models/family','assets/models/field','system/globalization/translator','application/application-context'],function(require){"use strict";var a=require("jquery"),b=require("system/http/ajax-client"),c=require("assets/services/hierarchy-dto"),d=require("assets/services/hierarchy-paging-dto"),e=require("assets/services/taxonomy-dto"),f=require("assets/services/asset-context-dto"),g=require("assets/adapters/hierarchy-config-adapter"),h=require("assets/models/family"),i=require("assets/models/field"),j=require("system/globalization/translator"),k=require("application/application-context"),l="api/common/assethierarchy/",m="MI_AST_GRP",n="api/core/userpref",o="asset-hierarchy-key",p=7;function q(a,b){this.ajaxClient=a,this.request=null,this.translator=b}q.dependsOn=[b,j],q.prototype.get=function(){var b=a.Deferred();return this.ajaxClient.get(l).done(A.bind(null,b)).fail(b.reject.bind(b)),b},q.prototype.children=function b(c,d,e,f,g,h){var i=a.Deferred(),j=l+"children";return c&&(j+="/"+c.toString()),
j+="?taxonomyCategory="+d+"&taxonomyClass="+e+"&taxonomyType="+f+"&page="+g+"&pageSize="+h,this.request=this.ajaxClient.get(j),this.request.done(v.bind(null,this,i)),this.request.fail(t.bind(null,i)),i.promise()},q.prototype.childrenFilteredBySites=function(b,c,d,e,f,g,h){var i=a.Deferred(),j=l+"children";return b&&(j+="/"+b.toString()),j+="?taxonomyCategory="+c+"&taxonomyClass="+d+"&taxonomyType="+e+"&page="+f+"&pageSize="+g,this.request=this.ajaxClient.post(j,h),this.request.done(v.bind(null,this,i)),this.request.fail(t.bind(null,i)),i.promise()},q.prototype.search=function b(c,d,e){var f=a.Deferred(),g=l;return g+="search?term="+encodeURIComponent(c)+"&page="+d+"&pageSize="+e,this.ajaxClient.get(g).done(w.bind(null,this,f)).fail(f.reject.bind(f)),f.promise()},q.prototype.searchFilteredBySites=function(b,c,d,e){var f=a.Deferred(),g=l;return g+="search?term="+encodeURIComponent(b)+"&page="+c+"&pageSize="+d,this.ajaxClient.post(g,e).done(w.bind(null,this,f)).fail(f.reject.bind(f)),
f.promise()},q.prototype.assets=function b(c,d){var e,f=a.Deferred(),g=l+"assets/"+c.toString();if(d&&d.length>0)for(e=0;e<d.length;e++)g+=(0===e?"?":"&")+"families="+d[e].toString();return this.ajaxClient.get(g).done(u.bind(null,f)).fail(f.reject.bind(f)),f.promise()},q.prototype.assetsFilteredBySites=function b(c,d){var e=a.Deferred(),f=l+"assets/"+c.toString();return this.ajaxClient.post(f,d).done(u.bind(null,e)).fail(e.reject.bind(e)),e.promise()},q.prototype.abort=function a(){this.request&&this.request.abort()},q.prototype.taxonomy=function b(){var c=a.Deferred();return this.ajaxClient.get(l+"taxonomy").done(x.bind(null,c)).fail(c.reject.bind(c)),c.promise()},q.prototype.path=function b(c){var d=a.Deferred();return c&&"-1"!==c&&"0"!==c?(this.request=this.ajaxClient.get(l+"path/"+c),this.request.done(y.bind(null,this,d)),this.request.fail(d.reject.bind(d)),d.promise()):(setTimeout(y.bind(null,this,d,[]),0),d.promise())},q.prototype.pathAll=function b(c,d){
var e=a.Deferred(),f=l+"pathAll/"+d;return this.ajaxClient.post(f,c).done(z.bind(null,this,e)).fail(e.reject.bind(e)),e.promise()},q.prototype.families=function(){var b=a.Deferred();return this.ajaxClient.get(l+"families").done(B.bind(null,b)).fail(b.reject.bind(b)),b.promise()},q.prototype.relationships=function(b){var c=a.Deferred();return this.ajaxClient.get(l+"families/"+b.toString()).done(B.bind(null,c)).fail(c.reject.bind(c)),c.promise()},q.prototype.getPartialFamily=function(b){var c=a.Deferred();return this.ajaxClient.get(l+"family/"+b.toString()).done(D.bind(null,c)).fail(c.reject.bind(c)),c.promise()},q.prototype.relationshipsById=function(){var b=a.Deferred();return this.ajaxClient.get(l+"families/"+m).done(B.bind(null,b)).fail(b.reject.bind(b)),b.promise()},q.prototype.relatedFamilies=function(b,c){var d=l+"families/"+b.toString()+"/"+c.toString(),e=a.Deferred();return this.ajaxClient.get(d).done(B.bind(null,e)).fail(e.reject.bind(e)),e.promise()},
q.prototype.familyFields=function(b){var c=a.Deferred();return this.ajaxClient.get(l+"families/"+b.toString()+"/fields").done(C.bind(null,c)).fail(c.reject.bind(c)),c.promise()},q.prototype.updateConfiguration=function(a){return this.ajaxClient.put(l,a)},q.prototype.rebuild=function(){return this.ajaxClient.post(l+"rebuild")},q.prototype.storeAssetHierarchyKey=function(a){return this.ajaxClient.post(n+"/set",r(a))};function r(a){return{userKey:s(),prefType:p,name:o,value:a}}function s(){return k.user.key}function t(a,b,c,d){"abort"!==c&&a.reject(b,c,d)}function u(a,b){a.resolve(c.fromDataCollection(b))}function v(a,b,e){var f;a.request=null,f=new d(e),f.data=c.fromDataCollection(e.data),b.resolve(f)}function w(a,b,e){var f;f=new d(e),f.data=c.fromDataCollection(e.data),b.resolve(f)}function x(a,b){a.resolve(e.fromDataCollection(b))}function y(a,b,c){var d=f.fromDataCollection(c);d.unshift({description:a.translator.translate("ASSET_HIERARCHY_ROOT"),entityKey:"-1"}),b.resolve(d)}
function z(a,b,c){b.resolve(f.fromDataCollection(c))}function A(a,b){a.resolve(g.fromDTOArray(b))}function B(a,b){var c,d=[];for(c=0;c<b.length;c++)d[d.length]=new h(b[c]);a.resolve(d)}function C(a,b){var c,d=[];for(c=0;c<b.length;c++)d[d.length]=new i(b[c]);a.resolve(d)}function D(a,b){var c={},d=0;for(c.relationships=[],c.parentFields=[],d=0;d<b.parentFields.length;d++)c.parentFields[c.parentFields.length]=new i(b.parentFields[d]);for(d=0;d<b.relationships.length;d++)c.relationships[c.relationships.length]=new h(b.relationships[d]);a.resolve(c)}return q});

define('text!assets/views/asset-hierarchy-control-filter.html',[],function () { return '<div class="filter-trigger-container">\r\n    <button class="btn btn-default btn--bare actionable actionable--secondary filter-trigger-btn">\r\n        <i class="icon-collection-filter"></i>\r\n        <span class="filter-txt label--inline" for="filter-icon">Filter</span>\r\n    </button>\r\n    <button class="ahc-filters-clear-btn pull-right hide">Clear</button>\r\n</div>\r\n<div class="uacb-filter-popup hide"></div>';});

define('assets/asset-hierarchy-control-filter',['require','jquery','assets/services/hierarchy-service','spa/ko/knockout-view-model','system/knockout/knockout-manager','system/globalization/translator','text!./views/asset-hierarchy-control-filter.html'],function(require){"use strict";var a=require("jquery"),b=require("assets/services/hierarchy-service"),c=require("spa/ko/knockout-view-model"),d=require("system/knockout/knockout-manager"),e=require("system/globalization/translator"),f=require("text!./views/asset-hierarchy-control-filter.html");function g(a,c,g){h.call(this,f),this.service=Object.resolve(b),this.translator=Object.resolve(e),this.categories=null,this.classes=null,this.types=null,this.currentCategory=a,this.currentClass=c,this.currentType=g,this.kom=Object.resolve(d)}var h=Object.inherit(c,g);g.prototype.load=function a(){this.categories=this.kom.observableArray(),this.classes=this.kom.computed(m.bind(null,this)),this.types=this.kom.computed(n.bind(null,this)),this.service.taxonomy().done(l.bind(null,this))},g.prototype.attach=function b(c){c.attach(a(f)),h.prototype.attach.call(this,c),c.element.querySelector(".apply").addEventListener("click",this),c.$element.addClass("asset-hierarchy-filter-popover")},
g.prototype.detach=function(a){a.element.querySelector(".apply").removeEventListener("click",this),h.prototype.detach(a)},g.prototype.unload=function a(){this.kom.dispose()},g.prototype.translate=function a(b){return this.translator.translate(b)},g.prototype.handleEvent=function b(c){"click"===c.type&&c.target.classList.contains("apply")&&(a(".hierarchy-control-filter")[0].closeFilter(),a(".hierarchy-control-filter").trigger("filter-closed"))};function i(a,b){var c,d;for(c=a.currentCategory().code,d=0;d<b.length;){if(b[d].code===c){a.currentCategory(b[d]);break}d++}}function j(a){var b,c,d;for(b=a.currentCategory(),c=a.currentClass().code,d=0;d<b.children.length;){if(b.children[d].code===c){a.currentClass(b.children[d]);break}d++}}function k(a){var b,c,d;for(b=a.currentClass(),c=a.currentType().code,d=0;d<b.children.length;){if(b.children[d].code===c){a.currentType(b.children[d]);break}d++}}function l(a,b){a.currentCategory()&&i(a,b),a.currentClass()&&j(a),a.currentType()&&k(a),
a.categories(b)}function m(a){return a.currentCategory()?a.currentCategory().children:[]}function n(a){return a.currentClass()?a.currentClass().children:[]}return g});

define('text!assets/views/asset-hierarchy-control.html',[],function () { return '<asset-hierarchy-control data-bind="attr:{enableMultiSelect:settings.multiSelect}"></asset-hierarchy-control>\r\n';});


define('text!assets/views/asset-hierarchy-control-search.html',[],function () { return '<input placeholder="Search" type="text" class="ahc-search-input text-input" />\r\n<i class="ahc-search-icon icon-global-search"></i>\r\n<i class="ahc-search-clear-icon icon-multiply icon-close hide"></i>';});

define('ui/elements/list-group-item/view-model',['system/globalization/translator'],function(){"use strict";var a=require("system/globalization/translator"),b=Object.create(HTMLElement.prototype);b.createdCallback=function(){var b,d,e,f,g;this.translator=Object.resolve(a),this.className="list-group-item",b=document.createElement("div"),b.classList.add("background-div"),this.appendChild(b),d=document.createElement("div"),d.classList.add("block-group"),d.classList.add("mi-li-body"),this.appendChild(d),e=document.createElement("div"),e.setAttribute("name","selector"),d.appendChild(e),l(this),e=document.createElement("div"),g=document.createElement("span"),f=document.createElement("span"),g.setAttribute("name","text"),f.setAttribute("name","custom-icon"),g.classList.add("system-ellipsis-text"),e.appendChild(f),e.appendChild(g),d.appendChild(e),this._listItemIcon=f,m(this),c(this)},b.attachedCallback=function(){this.querySelector(".mi-li-body").addEventListener("click",this)},b.attributeChangedCallback=function(a,b,c){
"selector"===a||"multiselect"===a||"radio-child-only"===a?l(this):"checked"===a?r(this,c):"description"===a&&this.value?q(this):"icon-class"===a?s(this,c):"has-children"===a?m(this):"use-html"===a?q(this):"disabled"===a?n(this,c):"disabledicon"===a&&o(this,c)},b.handleEvent=function(a){"click"===a.type?t(this,a):"change"===a.type&&u(this,a)};function c(a){a._value=null,Element.defineProperty(a,"value",{get:f.bind(null,a),set:g.bind(null,a)}),Element.defineProperty(a,"listItemIcon",{get:d.bind(null,a),set:e.bind(null,a)})}function d(a){return a._listItemIcon}function e(a,b){}function f(a){return a._value}function g(a,b){a._value=b,q(a),m(a)}function h(a,b,c){var d=document.createElement("span"),e=document.createElement("input");"true"===a.getAttribute("multiselect")?(e.type="checkbox",d.classList.add("custom-checkbox")):e=i(a,e),a.getAttribute("checked")?e.checked="true"===a.getAttribute("checked"):e.checked=!1,e.setAttribute("selector",!0),b.appendChild(d),b.appendChild(e),
c.classList.add("selector-seperator")}function i(a,b){var c=!!a.querySelector("i.icon-right-arrow"),d=a.getAttribute("radio-child-only");return b=j(b),d&&c&&(b.style.visibility="hidden"),b}function j(a){return a.type="radio",a.name="list-group-radio",a}function k(a,b,c){var d=document.createElement("i");d.className="icon-plus",d.title=a.translator.translate("ADD_ASSET"),b.appendChild(d),c.classList.add("selector-seperator")}function l(a){var b=a.getAttribute("selector"),c,d=a.querySelector('[name="selector"]'),e=a.querySelector('[name="text"]');d.hasChildNodes()&&(c=d.querySelector("input"),c&&c.removeEventListener("checked",a),d.innerHTML=""),"toggle"===b?h(a,d,e):"addOnly"===b&&k(a,d,e)}function m(a){var b,c,d,e,f=a.querySelector(".mi-li-body");c=a.getAttribute("has-children"),c?"true"===c?d=!0:(e=a.value[c],d=e instanceof Function?e():e):d=!1,d&&!f.querySelector('i[name="icon"]')?(b=document.createElement("i"),b.className=a.getAttribute("icon-class"),
b.title=a.translator.translate("EXPAND"),b.setAttribute("name","icon"),f.appendChild(b)):d||(b=f.querySelector('i[name="icon"]'))&&f.removeChild(b)}function n(a,b){b===!0||"true"===b?a.classList.add("disabled"):b!==!1&&"false"!==b||a.classList.remove("disabled")}function o(a,b){b===!0||"true"===b?a.classList.add("disabledIcon"):b!==!1&&"false"!==b||a.classList.remove("disabledIcon")}function p(a){var b,c=a.querySelector(".mi-li-body");c.querySelector('i[name="icon"]')||(b=document.createElement("i"),b.className=a.getAttribute("icon-class"),b.setAttribute("name","icon"),c.appendChild(b))}function q(a){var b,c,d=a.getAttribute("description")||"description",e=a.getAttribute("use-html");a.value&&(b=a.value[d],c=b instanceof Function?b.call(a.value):b,e?a.querySelector('[name="text"]').innerHTML=c:a.querySelector('[name="text"]').textContent=c)}function r(a,b){var c=a.querySelector('[name="selector"] input');c&&(c.checked="false"!==b,
c.checked?c.previousSibling.classList.add("checked"):c.previousSibling.classList.remove("checked"))}function s(a,b){var c=a.querySelector('[name="icon"]');null!==c?c.className=b:(p(a),c=a.querySelector('[name="icon"]'),c.className=b)}function t(a,b){var c;if(b.cancelBubble=!0,b.preventDefault=!0,c=new CustomEvent("click",{bubbles:!0,cancelable:!0}),"selector"===b.target.getAttribute("name")||"selector"===b.target.parentElement.getAttribute("name"))if("INPUT"===b.target.tagName)"radio"!==b.target.getAttribute("type")&&"checkbox"!==b.target.getAttribute("type")||(c.selecting=b.target.checked);else if("I"===b.target.tagName){if("true"===a.getAttribute("disabledicon"))return;c.selecting=!0}a.dispatchEvent(c)}function u(a,b){var c,d;c=b.target.checked,a.setAttribute("checked",b.target.checked),d=b.target.checked,c!==d&&(b.target.checked=c)}return document.registerElement("mi-li",{prototype:b}),b});
define('ui/elements/searchbox/view-model',['lodash','jquery','system/globalization/translator'],function(){"use strict";var a=require("lodash"),b=require("jquery"),c=require("system/globalization/translator"),d=Object.create(HTMLElement.prototype),e=["key","description","page","page-size","scroll-percent","use-html","multiselect","selector"];d.createdCallback=function(){var b;this.classList.add("btn"),this.classList.add("btn-icon"),b=document.createElement("i"),b.className="icon-search",this.appendChild(b),this.search=a.debounce(q,500),this._searchDiv=null,this._searchList=null,this._value="",Element.defineProperty(this,"value",{get:o.bind(null,this),set:p.bind(null,this)}),this._closeSearchBind=this.closeSearch.bind(this),this._resizeBind=i.bind(null,this),this.isInToolbar=!1,this.disabled=!1,this.translator=null},d.attachedCallback=function(){this.addEventListener("click",this),window.addEventListener("resize",this._resizeBind),this.translator=Object.resolve(c),this.title=f(this,"SEARCH")},d.detachedCallback=function(){this._searchDiv&&j(this),
window.removeEventListener("resize",this._resizeBind),this.isInToolbar&&this._searchList&&k(this)},d.handleEvent=function(a){"input"===a.type?(this._value=a.target.value,n(this)):"click"===a.type&&"I"===a.target.tagName&&(a.target.classList.contains("icon-multiply")?r(this):a.target.classList.contains("icon-search")&&!this.disabled&&(w(this,a),g(this)))},d.attributeChangedCallback=function(b,c,d){var f;"delay"===b?this.search=a.debounce(q,d):"disabled"===b?this.disabled="true"===d:this.searchDiv&&(f=this.searchDiv.querySelector(".search-list"))&&e.indexOf(b)>-1&&f.setAttribute(b,d)},d.closeSearch=function(a){if(""===this._value)if(this._searchList&&"none"!==b(this._searchList).css("display")){if(a.target===this._searchDiv.querySelector("input"))return;this._searchDiv&&""===this._searchDiv.querySelector("input").value&&(j(this),k(this))}else{
if(a&&"blur"!==a.type&&(a.target===this||a.target.parentElement===this||a.target===this._searchDiv||a.target.parentElement===this._searchDiv))return;j(this)}},d.toggleEnabled=function(a){var b=this.querySelector("Search");b.disabled="true"===a},d.toggleSearch=function(){g(this)};function f(a,b){return a.translator.translate(b.toUpperCase())}function g(a){var b;a._searchDiv||a.isInToolbar&&a._searchList?(r(a),j(a),k(a)):(a._searchDiv=document.createElement("div"),a._searchDiv.className="mi-searchbox","MI-TOOL-BAR"!==a.parentElement.tagName?a.parentElement.appendChild(a._searchDiv):a.parentElement.parentElement.insertBefore(a._searchDiv,a.parentElement.nextElementSibling),b=document.createElement("input"),b.setAttribute("type","text"),b.className="form-control mi-searchbox",b.value=a.value,b.addEventListener("blur",a._closeSearchBind),a._searchDiv.appendChild(b),b.focus(),b=document.createElement("i"),b.className="icon-multiply",a._searchDiv.appendChild(b),b.addEventListener("click",a),
"true"!==a.getAttribute("custom-search")&&(b=document.createElement("mi-list-group"),Element.upgrade(b),b.classList.add("search-list"),b.classList.add("dropdown-menu-left"),s(a,b),b.loader=t.bind(null,a),"MI-TOOL-BAR"!==a.parentElement.tagName?a._searchDiv.appendChild(b):(a.isInToolbar=!0,a._searchDiv.parentElement.insertBefore(b,a._searchDiv.nextElementSibling),a._searchList=b,a._searchList.searchResult=a._searchList.parentElement.searchResult,h(a,b)),i(a)),m(a),l(a),a._searchDiv.addEventListener("input",a))}function h(a){a._searchList.addEventListener("click",function(b){b.target===this?g(a):"MI-LI"===b.target.tagName&&w(a,b)})}function i(a){var c;"true"!==a.getAttribute("custom-search")&&(c=a.parentElement)&&("MI-TOOL-BAR"===c.nodeName&&(c=c.parentElement),a._searchDiv&&(a.isInToolbar?a._searchList&&(a._searchList.style.height=(c.clientHeight-77).toString()+"px",b(a._searchList).css("position","absolute"),"relative"===b(c).css("position")?(b(a._searchList).css("top",77),
b(a._searchList).css("left",0)):(b(a._searchList).css("top",b(c).position().top+77),b(a._searchList).css("left",b(c).position().left)),a._searchList.style.width=c.clientWidth.toString()+"px"):(a._searchList=a._searchDiv.querySelector(".search-list"),a._searchList.style.height=(c.clientHeight-46-35).toString()+"px")))}function j(a){a._searchDiv&&(a._searchDiv.removeEventListener("click",a),a._searchDiv.removeEventListener("input",a),a._searchDiv.querySelector("input").removeEventListener("blur",a._closeSearchBind),Element.clearDom(a._searchDiv),a._searchDiv.parentElement.removeChild(a._searchDiv),a._searchDiv=null,l(a))}function k(a){a._searchList&&(a._searchList.removeEventListener("click",a),Element.clearDom(a._searchList),b(a._searchList).remove(),a._searchList=null,l(a))}function l(a){var b=new CustomEvent("resize",{bubbles:!0});b.open=null!==a._searchDiv,a.dispatchEvent(b)}function m(a){
a.value.length>0?a._searchDiv.querySelector("i").style.display="inline-block":a._searchDiv.querySelector("i").style.display="none"}function n(a){m(a),a.search(a)}function o(a){return a._value}function p(a,b){a._value=b||"",""===a._value||a._searchDiv||g(a),a._searchDiv&&(a._searchDiv.querySelector("input").value=a._value,n(a))}function q(a){var b;a.searchCallback&&a._searchDiv&&("true"===a.getAttribute("custom-search")?(b=a._searchDiv.querySelector("input"),a.searchCallback(b.value)):(a._searchList.value=null,a._searchList.reload()))}function r(a){a.value="",q(a),a._searchDiv.querySelector(".mi-searchbox input").focus()}function s(a,b){var c,d;for(c=0;c<e.length;c++)(d=a.getAttribute(e[c]))&&b.setAttribute(e[c],d)}function t(a,c,d){var e=a._searchDiv.querySelector("input");return e&&a.searchCallback?a.searchCallback(e.value,c,d).done(u.bind(null,a)):b.Deferred().resolve().promise()}function u(a,b){var c
;a._searchDiv&&(c=a.isInToolbar?a._searchList:a._searchDiv.querySelector(".search-list"))&&(b&&b.length>0?c.classList.add("open"):c.classList.remove("open"))}function v(a){for(var b=a.hasAttribute("multiselect")?a.querySelectorAll("mi-li[checked]"):a.querySelectorAll(".active"),c=[],d=0;d<b.length;d++)c.push(b[d].value);return c}function w(a,b){var c;c=new CustomEvent("search-selected",{bubbles:!0}),c.searchResult=v(b.currentTarget),a.dispatchEvent(c)}return document.registerElement("mi-searchbox",{prototype:d}),d});
define('ui/elements/tool-bar/view-model',['lodash','jquery'],function(){"use strict";var a=require("lodash"),b=require("jquery"),c=Object.create(HTMLElement.prototype);c.createdCallback=function(){var b,c;this._closeOverflowBind=m.bind(null,this),this.$filter=null,this.popoverId=null,b=document.createElement("button"),b.className="more-options-icon btn btn-primary btn-icon dropdown-toggle",this.appendChild(b),c=document.createElement("icon"),c.className="icon-options",b.appendChild(c),this.throttledPositionEllipsis=a.throttle(this.positionEllipsis.bind(this),650)},c.attachedCallback=function(){a.defer(q.bind(null,this)),window.addEventListener("resize",this),document.querySelector("body").addEventListener("click",this._closeOverflowBind),this.addEventListener("click",this)},c.detachedCallback=function(){var a;window.removeEventListener("resize",this),document.querySelector("body").removeEventListener("click",this._closeOverflowBind),this.$filter&&(a=document.querySelector(this.popOverId),a&&a.parentElement.removeChild(a),
this.$filter=null)},c.showElement=function(a,b){for(var c=this.firstElementChild;c;)d(c,a)&&e(c,b),null!==c&&(c=c.nextElementSibling)};function d(a,b){return a.className.split(" ").indexOf(b)>=0}function e(a,c){c?b(a).addClass("overflow").removeClass("no-access"):b(a).addClass("no-access").removeClass("overflow")}c.handleEvent=function(b){var c,d,e,f;if("resize"===b.type&&b.target===window)this.throttledPositionEllipsis(),a.defer(q.bind(null,this));else if("click"===b.type){if(c=this.querySelector(".more-options-icon"),d=document.querySelector(this.popOverId),b.target===c||c.contains(b.target))l(this);else if(d&&d.contains(b.target)){for(f=b.target;f&&!e;)f.original&&(e=f.original),f=f.parentElement;e&&(b.cancelBubble=!0,e.dispatchEvent(new CustomEvent("click",{bubble:!0})))}b.target.parentElement.classList.contains("tool-bar-overflow")&&this._closeOverflowBind(this,b)}},c.positionEllipsis=function(){
var a=this.firstElementChild,b=this.querySelector(".more-options-icon"),c=document.querySelector(".content").getBoundingClientRect(),d=0,e=5,l,m=!1,n,o,p,q,r;if(r=this,null!==this.offsetParent)if(p=this.parentElement.getBoundingClientRect(),l="MI-TREE"===this.parentElement.tagName,this.$filter&&this.$filter.popover("hide"),a&&a!==b){for(n=b.getBoundingClientRect(),q=c.width===p.width||l?p.width-n.width-e:p.left+p.width-n.width-e,o=a.getBoundingClientRect(),d=h(r,b,o,p),a=this.firstElementChild;a;)o=a.getBoundingClientRect(),j(a,b,o,p)&&(i(a)?d>0?(m=!0,a.classList.add("overflow"),f(a),d--,d=h(r,b,o,p)):(g(a),a.classList.remove("overflow")):k(a,this)?(m=!0,a.classList.add("overflow")):(g(a),a.classList.remove("overflow"))),null!==a&&(a=a.nextElementSibling);m?(b.style.visibility="visible",b.style.left=q.toString()+"px"):b.style.visibility="hidden"}else;};function f(a){var c=b(a);""===c.next().text()||c.hasClass("more-options-icon")||c.next().css({"margin-right":"20px"})}function g(a){
var c=b(a),d=[];c.hasClass("overflow")&&c.attr("style",""),c.parent().children().each(function(a,c){"right"!==b(this).css("float")||b(this).hasClass("overflow")||d.push(b(this))}),b.each(d,function(a){0!==a&&b(this).attr("style","")})}function h(a,b,c,d){var e,f=0;for(e=a.firstElementChild;e;)j(e,b,c,d)&&k(e,a)&&i(e)&&f++,e=e.nextElementSibling;return f}function i(a){return"right"===b(a).css("float")}function j(a,b,c,d){var e="addItem"===a.getAttribute("data-action");return a!==b&&c.width!==d.width&&!e}function k(a,c){var d=b(a).position().top>b(c).position().top+b(c).height();return a.classList.contains("overflow")&&!a.classList.contains("dropdown-toggle")&&(b(a).removeClass("overflow"),d=b(a).position().top>b(c).position().top+b(c).height(),b(a).addClass("overflow")),d}function l(a){if(!a.$filter){var c,d;a.$filter=b(a.querySelector(".more-options-icon")),a.$filter.popover({placement:"bottom",container:"body",content:" "}),a.$filter.on("shown.bs.popover",a,n),
a.$filter.on("hide.bs.popover",a,o),a.$filter.on("hidden.bs.popover",a,p),a.$filter.popover("show"),setTimeout(function(){c=parseInt(b(a.popOverId).css("left")),d=parseInt(b(a.popOverId).width()),b(a.popOverId).css("left",c-(d-30))},250)}}function m(a,b){var c;if(a.$filter){if(!(c=document.querySelector(a.popOverId))||c.contains(b.target)||b.target===a)return;a.$filter.popover("hide")}}function n(a){var b=a.data,c,d=b.querySelectorAll(".overflow"),e,f;for(b.popOverId="#"+a.target.attributes["aria-describedby"].value,c=document.querySelector(b.popOverId+" .popover-content"),c.classList.add("tool-bar-overflow"),e=0;e<d.length;e++)f=d[e].cloneNode(),f.original=d[e],c.appendChild(f),f.textContent=f.getAttribute("title");c.addEventListener("click",b)}function o(a){var b=a.data,c;c=document.querySelector(b.popOverId+" .popover-content"),c&&c.addEventListener("click",b),b.$filter.off("shown.bs.popover",n),b.$filter.off("hide.bs.popover",o)}function p(a){var b=a.data
;b.$filter&&(b.$filter.off("hidden.bs.popover",p),b.$filter.popover("destroy"),b.$filter=null,b.popoverId=null)}function q(a){a&&a.positionEllipsis&&a.positionEllipsis instanceof Function&&a.positionEllipsis()}return document.registerElement("mi-tool-bar",{prototype:c}),c});
define('ui/elements/tool-bar-filter/view-model',['require','jquery','spa/conductor','spa/region','system/globalization/translator'],function(require){"use strict";var a=require("jquery"),b=require("spa/conductor"),c=require("spa/region"),d=require("system/globalization/translator"),e=Object.create(HTMLElement.prototype);e.createdCallback=function(){var a;h(this),this.classList.add("btn"),this.classList.add("btn-default"),this.classList.add("btn-icon"),a=document.createElement("i"),a.className="icon-collection-filter",this.appendChild(a),this.region=null,this.translator=null},e.attachedCallback=function(){this.addEventListener("click",this),document.querySelector("body").addEventListener("click",this._closeFilterBind),this.translator=Object.resolve(d),this.title=f(this,"FILTER")},e.detachedCallback=function(){var a;"true"!==this.getAttribute("custom-filter")&&(this.$filter&&(a=document.querySelector(this.popOverId),a&&a.parentElement.removeChild(a),this.$filter=null),this.conductor.unloadScreen(this.filterViewModel),this.conductor.closeScreen(this.filterViewModel)),
document.querySelector("body").removeEventListener("click",this._closeFilterBind)},e.handleEvent=function(a){"click"===a.type&&(a.target!==this&&a.target.parentElement!==this||g(this))},e.openFilter=function(){g(this)},e.closeFilter=function(){i(this)};function f(a,b){return a.translator.translate(b.toUpperCase())}function g(b){if("true"===b.getAttribute("custom-filter"))b.filterViewModel();else{if(b.$filter)return;b.$filter=a(b),b.$filter.popover({placement:"bottom",content:" ",container:"body"}),b.$filter.on("shown.bs.popover",b,l),b.$filter.on("hide.bs.popover",b,m),b.$filter.on("hidden.bs.popover",b,n),b.$filter.popover("show")}}function h(a){a.conductor=Object.resolve(b),a._closeFilterBind=i.bind(null,a),a.$filter=null,a.popoverId=null,a._filterViewModel=null,Element.defineProperty(a,"filterViewModel",{get:j.bind(null,a),set:k.bind(null,a)})}function i(a,b){var c;if(a.$filter){if(!(c=document.querySelector(a.popOverId))||c.contains(b.target)||b.target===a)return
;a.$filter.popover("hide")}}function j(a){return a._filterViewModel}function k(a,b){b?(a._filterViewModel=b,"true"!==a.getAttribute("custom-filter")&&(a.conductor.openScreen(a._filterViewModel),a.conductor.loadScreen(a._filterViewModel))):a._filterViewModel=null}function l(b){var d=b.data;d.region=new c,d.popOverId="#"+b.target.getAttribute("aria-describedby"),d.region.setElement(a(d.popOverId+" .popover-content")),d.conductor.activateScreen(d.filterViewModel),d.conductor.attachScreen(d.filterViewModel,d.region)}function m(a){var b=a.data;b.conductor.deactivateScreen(b.filterViewModel),b.conductor.detachScreen(b.region),b.$filter.off("shown.bs.popover",l),b.$filter.off("hide.bs.popover",m)}function n(a){var b=a.data;b.$filter&&(b.$filter.off("hidden.bs.popover",n),b.$filter.popover("destroy"),b.$filter=null,b.popoverId=null,b.dispatchEvent(new CustomEvent("filter-closed",{bubbles:!0})))}return document.registerElement("mi-tool-bar-filter",{prototype:e}),e});
define('ui/elements/list-group/view-model',['require','jquery','ramda','lodash','system/lang/converter','system/globalization/translator','ui/elements/list-group-item/view-model','ui/elements/searchbox/view-model','ui/elements/tool-bar/view-model','ui/elements/tool-bar-filter/view-model'],function(require){"use strict";var a=require("jquery"),b=require("ramda"),c=require("lodash"),d=require("system/lang/converter"),e=require("system/globalization/translator"),f=["key","description","selector","multiselect","has-children","use-html","delay","custom-search","radio-child-only"];require("ui/elements/list-group-item/view-model"),require("ui/elements/searchbox/view-model"),require("ui/elements/tool-bar/view-model"),require("ui/elements/tool-bar-filter/view-model");var g=Object.create(HTMLElement.prototype);g.selectRadioButton=function(a,b){E(this,a,b,!0)},g.createdCallback=function(){var a,b,c,d,e,f,g;j(this),this.classList.add("nav-list-group"),c=this.querySelector("mi-tool-bar"),c||(c=document.createElement("mi-tool-bar"),this.appendChild(c)),this.filterViewModel&&this.classList.add("show-filter"),e=document.createElement("mi-tool-bar-filter"),e.filterViewModel=this.filterViewModel,f=this.getAttribute("custom-filter"),
"true"===f&&e.setAttribute("custom-filter","true"),c.insertBefore(e,c.firstChild),this.searchCallback&&this.classList.add("show-search-button"),d=document.createElement("mi-searchbox"),d.searchCallback=this.searchCallback,c.insertBefore(d,c.firstChild),B(this,d),"false"!==this.getAttribute("allow-add")&&this.classList.add("allow-add"),c.insertBefore(N(this,"addItem","NEWITEM","icon-plus"),c.firstChild),a=document.createElement("div"),a.className="list-group",b=this.getAttribute("selector"),"addOnly"!==b&&"toggle"!==b||(a.className+=" selectable"),this.appendChild(a),g=document.createElement("div"),g.className="loading-small",this.appendChild(g),this.loader&&this.reload(),this.addEventListener("search-selected",this)},g.attachedCallback=function(){var a=U(this),b=this.querySelector("mi-tool-bar");a.addEventListener("scroll",this),a.addEventListener("click",this),b.addEventListener("click",this),b.addEventListener("resize",this),b.addEventListener("filter-closed",this),T(this)},
g.attributeChangedCallback=function(a,b,c){var d=U(this),e;"selector"===a&&d&&("addOnly"===c||"toggle"===c?d.classList.add("selectable"):d.classList.remove("selectable")),"allow-add"===a&&("false"===c?this.classList.remove("allow-add"):this.classList.add("allow-add")),"custom-filter"===a&&(e=this.querySelector("mi-tool-bar mi-tool-bar-filter"))&&e.setAttribute(a,c),A(this,a,c,d)},g.handleEvent=function(a){var b;"scroll"===a.type?J(this,a):"click"===a.type?C(a.target)?(E(this,D(a.target).value,a.selecting),h(this,a)):"BUTTON"===a.target.nodeName?(b=a.target.getAttribute("data-action"),S(this,b,a)):"I"===a.target.tagName&&"BUTTON"===a.target.parentElement.tagName&&(b=a.target.parentElement.getAttribute("data-action"),S(this,b,a)):"resize"===a.type?T(this):"filter-closed"===a.type?this.reload():"search-selected"===a.type&&(W.call(null,this,a.searchResult),x.call(null,this,this.searchResult))};function h(a,b){F(a)&&D(b.target).value&&!b.selecting&&i(a)&&l(a,k(a))}function i(a){
return t(a)&&c.includes(t(a),k(a))}g.reload=function(){var a=U(this);a&&(this.resume(),Element.clearDom(a),this.setAttribute("page","1"),a.scrollTop=0,this.loader&&this.load().done(M.bind(null,this)))},g.pause=function(){this.paused=!0},g.resume=function(){this.paused=!1},g.load=function(){var b=this.getAttribute("page"),c=L(this),d;return this.loader?(this.pause(),this.classList.add("loading"),T(this),d=this.loader(b,c),d.done(I.bind(null,this)),d.always(V.bind(null,this)),d.promise()):a.Deferred().done().promise()},g.scrollIntoView=function(){var a,b,c,d,e=U(this);e&&(a=e.querySelector("mi-li.active"),a?(b=a.parentNode,d=a.getBoundingClientRect(),c=b.getBoundingClientRect(),(d.top<c.top||d.top>c.bottom)&&(b.scrollTop=a.offsetTop-b.offsetTop)):e.firstElementChild&&(e.firstElementChild.scrollTop=0))},g.addItem=function(){this.dispatchEvent(new CustomEvent("add-item",{bubbles:!0}))},g.loadState=function(a){var b=this.querySelector("mi-tool-bar mi-searchbox");a=a||{},
a.value&&(this.value=a.value),a.searchTerm&&(b.value=a.searchTerm)},g.saveState=function(){var a=this.querySelector("mi-tool-bar mi-searchbox");return{value:this.value,searchTerm:a.value}};function j(a){a.translator=Object.resolve(e),a.paused=!1,a.searchResult=[],a._loader=null,Element.defineProperty(a,"loader",{get:q.bind(null,a),set:r.bind(null,a)}),a._value=null,Element.defineProperty(a,"value",{get:s.bind(null,a),set:E.bind(null,a)}),Element.defineProperty(a,"items",{get:t.bind(null,a),set:u.bind(null,a)}),Element.defineProperty(a,"selectedItems",{get:v.bind(null,a),set:x.bind(null,a)}),a._filterViewModel=null,Element.defineProperty(a,"filterViewModel",{get:O.bind(null,a),set:P.bind(null,a)}),a._searchCallback=null,Element.defineProperty(a,"searchCallback",{get:Q.bind(null,a),set:R.bind(null,a)}),a._listItemIconCallback=null,Element.defineProperty(a,"listItemIconCallback",{get:o.bind(null,a),set:p.bind(null,a)})}function k(a){var b=m(a);if(b)return b.selectedRadioButton}
function l(a,b){var c=m(a);c&&(c.selectedRadioButton=b)}function m(a){var b=n(a);if(b)return b[0]}function n(b){var c=b.parentElement,d;if(c)return d=a(c).siblings()}function o(a){return a._listItemIconCallback}function p(a,b){a._listItemIconCallback=b||null}function q(a){return a._loader}function r(a,b){a._loader=b,a.reload()}function s(a){return a._value}function t(a){var b=U(a),c,d=[],e;if(b)for(c=b.querySelectorAll("mi-li"),e=0;e<c.length;e++)d[d.length]=c[e].value;return d}function u(a,b){var c=U(a);c&&(Element.clearDom(c),b&&y(a,b))}function v(a){var b=U(a),c,d=[],e;if(b)for(c=b.querySelectorAll('mi-li[checked="true"]'),e=0;e<c.length;e++)d[d.length]=c[e].value;return d}function w(a){var b,c,d=U(a);if(d&&(b=d.querySelectorAll('mi-li[checked="true"]'),b.length>0))for(c=0;c<b.length;c++)b[c].setAttribute("checked","false")}function x(a,b){var c,d;if(w(a),b)for(c=0;c<b.length;c++)(d=H(a,b[c]))&&d.setAttribute("checked","true")}function y(a,b){var c,d,e=U(a),f;if(e){
for(f=document.createDocumentFragment(),z(b,e),c=0;c<b.length;c++)d=document.createElement("mi-li"),d.setAttribute("icon-class","icon-right-arrow"),f.appendChild(d),d.value=b[c],d.value.hasOwnProperty("disabled")&&d.setAttribute("disabled","true"===d.value.disabled||d.value.disabled),d.value.hasOwnProperty("disabledIcon")&&d.setAttribute("disabledIcon","true"===d.value.disabledIcon||d.value.disabledIcon),Object.tryMethod(a,"_listItemIconCallback",d.listItemIcon,b[c]),B(a,d);var g=new CustomEvent("loaded",{bubbles:!0,cancelable:!0,detail:{frag:f}});a.dispatchEvent(g),e.appendChild(f),a.searchResult.length&&x(a,a.searchResult)}}function z(a,b){if(0===a.length){var c=b.parentElement,d,e;c&&(c.parentElement&&(c=c.parentElement,c.previousSibling&&(c=c.previousSibling)),"MI-PATH-HISTORY"===c.nodeName&&(d=c.children[0].children,e=d[d.length-1],e.setAttribute("icon-class","")))}}function A(a,b,c,d){var e,g,h;if(d&&f.indexOf(b)>-1){for(e=d.getElementsByTagName("mi-li"),
g=0;g<e.length;g++)e[g].setAttribute(b,c);h=a.querySelector("mi-tool-bar mi-searchbox"),h&&h.setAttribute(b,c)}}function B(a,b){var c,d;for(c=0;c<f.length;c++)(d=a.getAttribute(f[c]))&&b.setAttribute(f[c],d)}function C(a){return"MI-LI"===a.tagName||"MI-LI"===a.parentNode.tagName||"MI-LI"===a.parentNode.parentNode.tagName||"MI-LI"===a.parentNode.parentNode.parentNode.tagName}function D(a){for(var b=a;"MI-LI"!==b.tagName;)b=b.parentNode;return b}function E(a,b,c,d){if(b){var e,f,g;if(g=new CustomEvent("selecting",{bubbles:!0,cancelable:!0}),g.selecting=c,g.newValue=b,a.dispatchEvent(g)){if(f=a.getElementsByClassName("active"),f&&f.length>0&&f[0].classList.remove("active"),a._value=b,b)if(F(a)&&b&&c&&l(a,b),void 0!==(e=H(a)))a._value=e.value,e.classList.add("active"),a.scrollIntoView();else{var h=a.querySelector("mi-list-group");h&&void 0!==h&&(a._value=h.value,h.classList.add("active"),a.scrollIntoView())}
return a.value&&void 0!==e?(e.getAttribute("multiselect")&&("true"===e.getAttribute("checked")?e.setAttribute("checked","false"):e.setAttribute("checked","true")),d?(e.setAttribute("checked","true"),G(a,c,!0),!0):(F(a)?G(a,c,!0):G(a,c),!0)):(null!==a.value&&void 0!==a.value||G(a,c),!1)}}}function F(a){return b.any(b.propEq("name","radio-child-only"),a.attributes)}function G(a,b,c){var d=new CustomEvent("change",{bubbles:!0,cancelable:!0});a.dispatchEvent(d),d=new CustomEvent("selected",{bubbles:!0,cancelable:!0}),d.preventListGroupNull=c,d.selecting=b,a.dispatchEvent(d)}function H(a,b){var c=0,d=U(a),e,f,g;if(d&&(e=d.querySelectorAll("mi-li"))&&0!==e.length){for(b=b||a.value,f=a.getAttribute("key")||"entityKey",g=b[f];c<e.length&&g!==e[c].value[f];)c++;return e[c]}}function I(a,b){var c=U(a);c&&"1"===a.getAttribute("page")&&Element.clearDom(c),b&&(y(a,b),b.length===L(a)&&a.resume())}function J(a,b){
var c=b.target,e=d.toFloat(a.getAttribute("scroll-percent")||"0.75"),f=(c.offsetHeight+c.scrollTop)/c.scrollHeight;!a.paused&&f>=e&&(K(a),a.load())}function K(a){var b=d.toInteger(a.getAttribute("page")||"1");b++,a.setAttribute("page",b.toString())}function L(a){var b=a.getAttribute("page-size")||"25";return d.toInteger(b)}function M(a){a.value&&(E(a,a.value)||(a.paused?a.value=null:(K(a),a.load().done(M.bind(null,a)))))}function N(a,b,c,d){var e=document.createElement("button"),f=document.createElement("i");return e.className="btn btn-default btn-icon",e.setAttribute("data-action",b),e.title=a.translator.translate(c),f.className=d,e.appendChild(f),e}function O(a){return a._filterViewModel}function P(a,b){var c=a.querySelector("mi-tool-bar mi-tool-bar-filter");b?a.classList.add("show-filter"):a.classList.remove("show-filter"),c&&(c.filterViewModel=b),a._filterViewModel=b}function Q(a){return a._searchCallback}function R(a,b){var c=a.querySelector("mi-tool-bar mi-searchbox")
;b?a.classList.add("show-search-button"):a.classList.remove("show-search-button"),c&&(c.searchCallback=b),a._searchCallback=b}function S(a,b,c){b&&a[b]&&a[b](c)}function T(a){var b,c=a.querySelector("mi-tool-bar"),d=U(a);c&&(b=a.querySelector("mi-tool-bar").clientHeight,a.classList.contains("loading")&&(b+=16),d.style.height="calc(100% - "+(b+1)+"px)")}function U(a){var b=a.querySelectorAll(".list-group");return 0===b.length?null:b[b.length-1]}function V(a){a.classList.remove("loading"),T(a)}function W(a,b){var c,d,e=0;for(c=0;c<b.length;c++){for(d=0;d<a.searchResult.length;d++)if(a.searchResult[d].key===b[c].key){e++;break}0===e&&a.searchResult.push(b[c])}}return document.registerElement("mi-list-group",{prototype:g}),g});
define('ui/elements/path-history/view-model',['require','lodash','jquery','ui/elements/list-group-item/view-model','ui/elements/list-group/view-model'],function(require){"use strict";var a=require("lodash"),b=require("jquery");require("ui/elements/list-group-item/view-model"),require("ui/elements/list-group/view-model");var c=["key","description","selector","multiselect","checked","has-children","use-html","page-size","delay","radio-child-only"],d=Object.create(HTMLElement.prototype);d.createdCallback=function(){var a;this.style.display="block",a=document.createElement("div"),a.className="list-group",this.appendChild(a),Element.defineProperty(this,"value",{get:k.bind(null,this),set:l.bind(null,this)}),Element.defineProperty(this,"listGroup",{get:m.bind(null,this),set:n}),this._loader=null,Element.defineProperty(this,"loader",{get:o.bind(null,this),set:p.bind(null,this)}),this._listItemIconCallback=null,Element.defineProperty(this,"listItemIconCallback",{get:g.bind(null,this),set:h.bind(null,this)}),this._selectedRadioButton=null,Element.defineProperty(this,"selectedRadioButton",{get:e.bind(null,this),set:f.bind(null,this)})}
;function e(a){return a._selectedRadioButton}function f(a,b){a._selectedRadioButton=b}function g(a){return a._listItemIconCallback}function h(a,b){a._listItemIconCallback=b||null}d.attachedCallback=function(){this.firstElementChild.addEventListener("click",this)},d.attributeChangedCallback=function(a,b,d){var e,f;if(c.indexOf(a)>-1)for(f=this.firstElementChild.getElementsByTagName("mi-li"),e=0;e<f.length;e++)"description"!==a&&"use-html"!==a||f[e].setAttribute(a,d),f[e].listGroup.setAttribute(a,d)},d.handleEvent=function(a){var b;"click"===a.type&&(a.cancelBubble=!0,a.preventDefault=!0,b=new CustomEvent("click",{bubbles:!0}),b.data=a.target.value,this.dispatchEvent(b),i(this))};function i(a){if(a.selectedRadioButton){var c=b(a).siblings(),d,f,g;c&&(d=b(a).siblings()[0]),d&&(f=d.children),f&&(g=f[0]),g&&e(a)&&j(a,g)}}d.contains=function(a){var b,c=this.value;for(b=0;b<c.length;b++)if(a===c[b].value)return!0;return!1},d.push=function(a){var b;b=document.createElement("mi-li"),
this.firstElementChild.appendChild(b),b.classList.add("selected"),null!==a.hasChildren&&b.setAttribute("icon-class","icon-arrow"),this.getAttribute("description")&&b.setAttribute("description",this.getAttribute("description")),this.getAttribute("use-html")&&b.setAttribute("use-html",this.getAttribute("use-html")),b.setAttribute("has-children",!0),b.value=a,b.listGroup=r(this,a),Object.tryMethod(this,"_listItemIconCallback",b.listItemIcon,a),q(this),j(this,b.listGroup)};function j(b,c){c&&b.selectedRadioButton&&a.includes(c.items,b.selectedRadioButton)&&c.selectRadioButton(b.selectedRadioButton,!0)}d.pop=function(){var a=this.firstElementChild,b=a.getElementsByTagName("mi-li");b.length>1&&(a.removeChild(b[b.length-1]),q(this))},d.moveBack=function(a){var b=this.firstElementChild,c=b.getElementsByTagName("mi-li"),d,e;if(a instanceof Object)for(;c&&c[c.length-1].value!==a;)b.removeChild(c[c.length-1]),q(this);else for(c=c.splice(a+1),d=0;d<c.length;d++)b.removeChild(c[d]),q(this)
;(e=b.querySelector("mi-li:last-of-type").listGroup)&&(e._value=null)},d.clear=function(){this.firstElementChild.innerHTML=""};function k(a){var b=a.firstElementChild.getElementsByTagName("mi-li"),c=[],d;for(d=0;d<b.length;d++)c[c.length]=b[d].value;return c}function l(a,b){var c,d,e=a.firstElementChild,f=!1;if(b instanceof Array){for(d=e.getElementsByTagName("mi-li"),c=0;c<b.length;c++)c>=d.length?(a.push(b[c]),f=!0):b[c]!==d[c].value&&(d[c].value=b[c],d[c].listGroup.reload(),f=!0);if(b.length<d.length){for(f=!0,c=d.length-1;c>b.length-1;c--)e.removeChild(d[c]);d[d.length-1].listGroup.value=null}f&&q(a)}else a.firstChild.innerHTML="",b&&a.push(b),q(a)}function m(a){var b=a.firstElementChild.getElementsByTagName("mi-li"),c=[],d;for(d=0;d<b.length;d++)c[c.length]=b[d].listGroup;return c}function n(){}function o(a){return a._loader}function p(a,b){var c,d=a.firstElementChild.getElementsByTagName("mi-li");for(a._loader=b,
c=0;c<d.length;c++)d[c].listGroup.listItemIconCallback=a.listItemIconCallback,d[c].listGroup.loader=b?b.bind(null,c):null}function q(a){var b=new CustomEvent("change",{bubbles:!0});a.dispatchEvent(b)}function r(a,b){var d=document.createElement("mi-list-group"),e=a.firstElementChild.getElementsByTagName("mi-li").length-1,f;for(f=0;f<c.length;f++)t(a,d,c[f]);return d.setAttribute("allow-add","false"),b&&b.loader?d.loader=b.loader.bind(null,e):a.loader&&(d.loader=a.loader.bind(null,e)),d.listItemIconCallback=a.listItemIconCallback,d.addEventListener("change",s),d}function s(a){a.cancelBubble=!0,a.preventDefault()}function t(a,b,c){var d=a.getAttribute(c);d&&b.setAttribute(c,d)}return document.registerElement("mi-path-history",{prototype:d}),d});
define('ui/elements/tree/view-model',['require','jquery','system/globalization/translator','ui/elements/path-history/view-model','ui/elements/searchbox/view-model','ui/elements/list-group/view-model','ui/elements/tool-bar/view-model','ui/elements/tool-bar-filter/view-model'],function(require){"use strict";var a=require("jquery"),b=require("system/globalization/translator"),c=["key","description","page","page-size","scroll-percent","selector","multiselect","checked","has-children","use-html","delay","radio-child-only"];require("ui/elements/path-history/view-model"),require("ui/elements/searchbox/view-model"),require("ui/elements/list-group/view-model"),require("ui/elements/tool-bar/view-model"),require("ui/elements/tool-bar-filter/view-model");var d=Object.create(HTMLElement.prototype);d.createdCallback=function(){var a,b,c,d,f,h;g(this),b=this.querySelector("mi-tool-bar"),b||(b=document.createElement("mi-tool-bar"),Element.upgrade(b),this.appendChild(b)),this.filterViewModel&&this.classList.add("show-filter"),d=document.createElement("mi-tool-bar-filter"),Element.upgrade(d),d.classList.add("default-buttons-left"),d.filterViewModel=this.filterViewModel,f=this.getAttribute("custom-filter"),"true"===f&&d.setAttribute("custom-filter","true"),
b.insertBefore(d,b.firstChild),this.searchCallback&&this.classList.add("show-search-button"),c=document.createElement("mi-searchbox"),Element.upgrade(c),c.classList.add("default-buttons-left"),c.searchCallback=e.bind(null,this),c.setAttribute("custom-search","true"),c.setAttribute("no-auto-close","true"),b.insertBefore(c,b.firstChild),p(this,c),"false"!==this.getAttribute("allow-add")&&this.classList.add("allow-add"),b.insertBefore(C(this,"addItem","NEWITEM","icon-plus"),b.firstChild),b.insertBefore(C(this,"togglePathHistory","HIDE","icon-up-arrow","hide-button"),b.firstChild),b.insertBefore(C(this,"backInHistory","BACK","icon-back-arrow","back-button"),b.firstChild),a=document.createElement("section"),a.className="nav-list-group",this.appendChild(a),this.pathHistory=document.createElement("mi-path-history"),Element.upgrade(this.pathHistory),this.pathHistory.loader=this._loader,this.pathHistory.value=this._value,this.pathHistory.className="expanded",a.appendChild(this.pathHistory),
p(this,this.pathHistory),h=document.createElement("div"),h.className="tree-list-control",a.appendChild(h),this._value&&x(this)},d.attachedCallback=function(){var a=this.querySelector("section.nav-list-group"),b=this.querySelector("mi-tool-bar");a.addEventListener("selecting",this),a.addEventListener("selected",this),a.addEventListener("click",this),b.addEventListener("click",this),b.addEventListener("resize",this),b.addEventListener("filter-closed",this),this.pathHistory.addEventListener("change",this),B(this)},d.attributeChangedCallback=function(a,b,d){var e,f;"root-name"===a?B(this,d):"allow-add"===a?"false"===d?this.classList.remove("allow-add"):this.classList.add("allow-add"):"custom-filter"===a?(f=this.querySelector("mi-tool-bar mi-tool-bar-filter"))&&f.setAttribute(a,d):c.indexOf(a)>-1&&(this.pathHistory.setAttribute(a,d),(e=this.querySelector("mi-tool-bar mi-searchbox"))&&e.setAttribute(a,d))},d.handleEvent=function(a){
"selecting"===a.type?D(this,a):"selected"===a.type?E(this,a):"click"===a.type?q(this,a):"change"===a.type?x(this):"resize"===a.type&&a.target!==window?t(this,a):"filter-closed"===a.type?this.refreshAll():"focus"===a.type&&a.target.parentElement.classList.contains("mi-searchbox")?(this.pathHistory.value=this.pathHistory.value[0],this.pathHistory.firstElementChild.firstElementChild.style.display="none",setTimeout(t.bind(null,this),0)):"blur"===a.type&&a.target.classList.contains("mi-searchbox")&&t(this)},d.togglePathHistory=function(){var a=!this.pathHistory.classList.contains("expanded"),b=this.querySelector('button[data-action="togglePathHistory"]');b.firstElementChild.className=a?"icon-up-arrow":"icon-arrow",b.title=this.translator.translate(a?"HIDE":"SHOW"),this.pathHistory.className=a?"expanded":"collapsed",t(this)},d.backInHistory=function(){var a=this.value;a.length>1&&w(this,a[a.length-2])},d.refresh=function(){var a=this.value,b=a[a.length-1]
;1===a.length?this.reload():(this.pathHistory.pop(),this.pathHistory.push(b))},d.refreshAll=function(){var a=this.pathHistory.listGroup,b;if(a.length<=1)this.reload();else{for(b=0;b<a.length;b++)a[b].items=null,a[b].resume();a[a.length-1].reload()}},d.reload=function(){A(this)&&this.pathHistory.clear(),B(this)},d.addItem=function(){this.dispatchEvent(new CustomEvent("add-item",{bubble:!0}))},d.loadState=function(a){var b;a=a||{},a.searchTerm&&(b=this.querySelector("mi-searchbox"),b._value=a.searchTerm,b.toggleSearch(),this.searchTerm=a.searchTerm,t(this),this.preSearchValue=a.preSearchValue),this.value=a.value,a.searchTerm&&(this.pathHistory.firstElementChild.firstElementChild.style.display="none")},d.saveState=function(){return{preSearchValue:this.preSearchValue,value:this.value,searchTerm:this.searchTerm}};function e(a,b){a.pathHistory.clear(),a.pathHistory.value={description:b,loader:a._searchCallback.bind(null,b)},a.searchTerm=b,
a.pathHistory.firstElementChild.firstElementChild.style.display="none",t(a)}function f(a){var b,c;a.preSearchValue&&(a.pathHistory.clear(),a.pathHistory.value=a.preSearchValue,a.preSearchValue=null,a.searchTerm="",a.querySelector("mi-searchbox").value=null,b=a.pathHistory.firstElementChild.firstElementChild,b&&(b.style.display="block"),c=new CustomEvent("search-closed",{bubbles:!0}),a.dispatchEvent(c),t(a))}function g(a){a.translator=Object.resolve(b),a._loader=null,a.preSearchValue=null,a.searchTerm="",Element.defineProperty(a,"loader",{get:j.bind(null,a),set:k.bind(null,a)}),a._value=null,Element.defineProperty(a,"value",{get:l.bind(null,a),set:m.bind(null,a)}),Element.defineProperty(a,"listGroup",{get:n.bind(null,a),set:o}),a._filterViewModel=null,Element.defineProperty(a,"filterViewModel",{get:F.bind(null,a),set:G.bind(null,a)}),a._searchCallback=null,Element.defineProperty(a,"searchCallback",{get:H.bind(null,a),set:I.bind(null,a)}),a._listItemIconCallback=null,
Element.defineProperty(a,"listItemIconCallback",{get:h.bind(null,a),set:i.bind(null,a)})}function h(a){return a._listItemIconCallback}function i(a,b){a._listItemIconCallback=b||null,a.pathHistory&&(a.pathHistory.listItemIconCallback=b)}function j(a){return a.pathHistory?a.pathHistory.loader:a._loader}function k(a,b){a.pathHistory&&(a.pathHistory.listItemIconCallback=a._listItemIconCallback,a.pathHistory.loader=b),a._loader=b}function l(a){return a.pathHistory?a.pathHistory.value:a._value}function m(a,b){a.pathHistory&&b&&(a.pathHistory.value=b),a._value=b}function n(a){return a.querySelector(".tree-list-control mi-list-group")}function o(){}function p(a,b){var d,e;for(d=0;d<c.length;d++)(e=a.getAttribute(c[d]))&&b.setAttribute(c[d],e)}function q(a,b){var c;"BUTTON"===b.target.nodeName?(c=b.target.getAttribute("data-action"),r(a,c,b)):"I"===b.target.tagName&&"BUTTON"===b.target.parentElement.tagName?(c=b.target.parentElement.getAttribute("data-action"),
r(a,c,b)):"MI-PATH-HISTORY"===b.target.tagName&&b.data&&w(a,b.data)}function r(a,b,c){b&&a[b]&&a[b](c)}function s(a,b){a.preSearchValue=a.pathHistory.value,b.target._searchDiv&&(b.target._searchDiv.querySelector("input").addEventListener("focus",a),b.target._searchDiv.querySelector("input").addEventListener("blur",a))}function t(b,c){var d=b.querySelector(".tree-list-control"),e=b.querySelector("section.nav-list-group"),g=e.firstElementChild,h=b.children,i=b.querySelector("mi-tool-bar"),j=0,k;if(d){if(c&&(c.open===!1?f(b):s(b,c)),i){for(k=0;k<h.length;k++)h[k]!==e&&(j+=a(h[k]).outerHeight());e.style.height="calc(100% - "+j+"px)"}for(j=0;g;)g!==d&&(j+=g.clientHeight),g=g.nextElementSibling;j=j.toString()+"px",d.style.height="calc(100% - "+j+")"}}function u(a,b){var c,d;for(c=new CustomEvent("navigating",{bubbles:!0,cancelable:!0}),c.newValue=[],d=0;d<a.length&&a[d]!==b;)c.newValue[c.newValue.length]=a[d],d++;return void 0!==b&&(c.newValue[c.newValue.length]=b),c}function v(a,b){
var c,d=a.pathHistory.listGroup[a.pathHistory.listGroup.length-1];b&&b.preventListGroupNull||(d.selectedItems=null),c=new CustomEvent("navigated",{bubbles:!0}),a.dispatchEvent(c)}function w(a,b){var c;c=u(a.value,b),a.dispatchEvent(c)&&(a.pathHistory.moveBack(b),v(a))}function x(a){y(a),z(a)}function y(b){var c=a("button.hide-button",b),d=a("button.back-button",b);c.addClass("pull-right"),1===b.pathHistory.value.length?(d.addClass("disabled"),c.addClass("disabled")):(d.removeClass("disabled"),c.removeClass("disabled"))}function z(a){var b=a.pathHistory.listGroup[a.pathHistory.listGroup.length-1],c=a.querySelector(".tree-list-control");b&&(c.firstElementChild&&c.removeChild(c.firstElementChild),c.appendChild(b),t(a),0!==b.items.length||b.paused?b.scrollIntoView():b.load())}function A(a){return a.getAttribute("root-name")||a.getAttribute("title")}function B(a,b){var c,d,e=a.getAttribute("description")||"description",f=b||A(a);if(f)d=a.value,0===d.length?(c={},c[e]=f,
a.value=c):(d[0]instanceof Object||(d[0]={}),d[0][e]=f,a.value=d);else if(a.value.length>0)return void(a.value=a.value[0])}function C(a,b,c,d,e){var f=document.createElement("button"),g=document.createElement("i");return f.className="btn btn-default btn-icon default-buttons-left "+(e||""),f.setAttribute("data-action",b),f.title=a.translator.translate(c),g.className=d,f.appendChild(g),f}function D(a,b){var c;b.selecting!==!0&&b.selecting!==!1&&(b.cancelBubble=!0,c=u(a.value,b.newValue),a.dispatchEvent(c)||b.preventDefault())}function E(a,b){var c;if(b.target.classList.contains("search-list"))return void(b.cancelBubble=!0);null!==b.selecting&&void 0!==b.selecting||(b.cancelBubble=!0,a.pathHistory.push(b.target.value),v(a,b),a.preSearchValue&&(c=new CustomEvent("search-selected",{bubbles:!0}),c.searchResult=[b.target.value],a.dispatchEvent(c)))}function F(a){return a._filterViewModel}function G(a,b){var c=a.querySelector("mi-tool-bar mi-tool-bar-filter")
;b?a.classList.add("show-filter"):a.classList.remove("show-filter"),c&&(c.filterViewModel=b),a._filterViewModel=b}function H(a){return a._searchCallback}function I(a,b){b?a.classList.add("show-search-button"):a.classList.remove("show-search-button"),a._searchCallback=b}return Element.registerElement("mi-tree",{prototype:d}),d});

define('text!ui/elements/filter/filter-btn-no-ko-view.html',[],function () { return '<div class="icon-filter-container">\r\n    <button class="icon-container btn btn-icon">\r\n        <i class="icon-collection-filter"></i>\r\n    </button>\r\n</div>\r\n';});


define('text!ui/elements/filter/filter-body-no-ko-view.html',[],function () { return '<!--<mi-select data-optionscaption="Select" data-selectedoptions="" data-disabled="false" data-required="false" data-visible="true" data-multiple="false"></mi-select>-->\r\n<div class="filter-container">\r\n\r\n    <div class="filters-noko">\r\n        <!--<div class="clear-all">\r\n            <a></a>\r\n        </div>-->\r\n        <div class="tag-section tag-area">\r\n        </div>\r\n        <div class="filter-content">\r\n            <div class="sort-header ">\r\n                \r\n            </div>\r\n        </div>\r\n        <div class="filter-header">\r\n            <header></header>\r\n            <header class="dotted-border"> </header>\r\n        </div>\r\n        <div class="filter-body">\r\n            \r\n        </div>\r\n    </div>\r\n</div>\r\n';});


define('text!ui/elements/filter/filter-group-no-ko-view.html',[],function () { return '<div class="filter-section">\r\n    <header></header>\r\n    <div class="filter-item">\r\n        <form class="form-item">\r\n            <div>\r\n                <!--<mi-checkbox data-bind="miCheckboxProperty: {checked: isSelected, text: text}"></mi-checkbox>-->\r\n            </div>\r\n        </form>\r\n        <div class="second-dotted-border"></div>\r\n    </div>\r\n</div>';});

define('ui/elements/filter/filter-item-no-ko',['require'],function(require){"use strict";function a(a,b){a=a||null,this.caption=b,this.value=a.value,this.text=a.text,this.isSelected=a.isSelected}return a});
define('ui/elements/filter/filter-group-no-ko',['require','./filter-item-no-ko'],function(require){"use strict";var a=require("./filter-item-no-ko");function b(b){var c;for(b=b||null,this.caption=b.caption,this.type=b.type,this.items=[],this.hideCaption=b.hideCaption,c=0;c<b.options.length;c++)this.items.push(new a(b.options[c].option,this.caption))}return b});
define('ui/elements/filter/filter-collection-no-ko',['require','./filter-group-no-ko'],function(require){"use strict";var a=require("./filter-group-no-ko");function b(){this.filterGroups=[]}return b.prototype.populateGroups=function(b){var c,d;for(c=0;c<b.filteroptions.length;c++)d=new a(b.filteroptions[c]),this.filterGroups.push(d)},b.prototype.clear=function(){this.filterGroups=[]},b});

define('text!ui/elements/checkbox/template.html',[],function () { return '<div class="checkbox-noko-container">\r\n    <input type="checkbox" />\r\n    <label class="">\r\n        <span class="checkbox-label"></span>\r\n        <span class="chkbox-text"></span>\r\n    </label>\r\n   \r\n</div>';});

define('ui/elements/checkbox/view-model',['require','jquery','text!./template.html','knockout'],function(require){"use strict";var a=require("jquery"),b=require("text!./template.html"),c=require("knockout"),d=Object.create(HTMLElement.prototype);d.createdCallback=function(){this.implementation=Object.resolve(e),this.implementation.element=this,this.implementation.$element=a(this),Object.tryMethod(this.implementation,"created")},d.attachedCallback=function(){Object.tryMethod(this.implementation,"attached")},d.detachedCallback=function(){Object.tryMethod(this.implementation,"detached")},d.attributeChangedCallback=function(a,b,c){Object.tryMethod(this.implementation,a+"Changed",b,c)};function e(){this.element=null,this.$element=null,this.$input=null,this.$container=b,this.inputChangeHandler=f.bind(null,this),this.init={}}e.prototype.created=function b(){var c=this;this.Node=document.createElement("div"),a(this.Node).append(),a(this.element).empty().append(this.$container),this.$input=this.$element.find('input[type="checkbox"]'),this.$label=this.$element.find("label")
;var d=this.getGuid();this.$input.attr("id",d),this.$label.attr("for",d),this.setAccessor("text",g.bind(this,this,"text")),this.setAccessor("checked",g.bind(this,this,"checked")),this.setAccessor("disabled",g.bind(this,this,"disabled")),this.setAccessor("value",g.bind(this,this,"value")),this.setAccessor("name",g.bind(this,this,"name"))},e.prototype.attached=function a(){this.$input.on("change",this.inputChangeHandler)},e.prototype.detached=function a(){this.$input.off("change",this.inputChangeHandler)};function f(a,b){a.$element.parents("mi-widget").length&&b.stopPropagation(),a.checked(b.currentTarget.checked),a.$element.trigger("checkedChange",[b.currentTarget.checked,a.value()])}function g(a,b,c){return"text"===b?void a.$element.find(".chkbox-text").html(c):"checked"===b?void(a.$input.get(0).checked="checked"===c||h(c)):"disabled"===b?void a.$input.prop("disabled",h(c)):void(a.$input&&a.$input.prop(b,c))}function h(a){return"false"!==a&&a!==!1&&("true"===a||a===!0)}
e.prototype.setAccessor=function(a,b){this[a]=c.observable(),Object.defineProperty(this.element,a,{get:i.bind(this,this,a),set:j.bind(this,this,a)}),this[a+"Changed"]=k.bind(this,this,a),this[a].subscribe(l.bind(this,this,b)),this[a](this.element.getAttribute(a))};function i(a,b){return a[b]()}function j(a,b,c){a[b](c)}function k(a,b,c,d){a[b](d)}function l(a,b,c){b&&b.call(a,c)}return e.prototype.getGuid=function a(){return this.s4()+this.s4()+"-"+this.s4()+"-"+this.s4()+"-"+this.s4()+"-"+this.s4()+this.s4()+this.s4()},e.prototype.s4=function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)},Element.registerElement("mi-checkbox-noko",{prototype:d}),e});

define('text!ui/elements/radio/template.html',[],function () { return '<div class="radio-noko-container">\r\n    <input type="radio" tabindex="0" />\r\n    <label class="">\r\n        <span class="radio-label"></span>\r\n        <span class="radio-text"></span>\r\n    </label>\r\n\r\n</div>';});

define('ui/elements/radio/view-model',['require','jquery','text!./template.html','knockout'],function(require){"use strict";var a=require("jquery"),b=require("text!./template.html"),c=require("knockout"),d=Object.create(HTMLElement.prototype);d.createdCallback=function(){this.implementation=Object.resolve(e),this.implementation.element=this,this.implementation.$element=a(this),Object.tryMethod(this.implementation,"created")},d.attachedCallback=function(){Object.tryMethod(this.implementation,"attached")},d.detachedCallback=function(){Object.tryMethod(this.implementation,"detached")},d.attributeChangedCallback=function(a,b,c){Object.tryMethod(this.implementation,a+"Changed",b,c)};function e(){this.element=null,this.$element=null,this.$input=null,this.$container=b,this.init={}}e.prototype.created=function(){var b=this;this.Node=document.createElement("div"),a(this.Node).append(this.$container),a(this.element).html(this.Node),this.$input=this.$element.find('input[type="radio"]'),this.$label=this.$element.find("label");var c=this.getGuid();this.$input.attr("id",c),
this.$label.attr("for",c),this.$input.on("change",function(a){b.checked(a.currentTarget.checked),b.$element.trigger("checkedChange",[a.currentTarget.checked,b.value(),b.name()])}),this.setAccessor("text",f.bind(this,this,"text")),this.setAccessor("checked",f.bind(this,this,"checked")),this.setAccessor("value",f.bind(this,this,"value")),this.setAccessor("name",f.bind(this,this,"name"))};function f(a,b,c){return a.init[b]&&"null"!==c?"text"===b?void a.$element.find(".radio-text").html(c):"checked"===b?void(a.$input.get(0).checked=g(c)):"disabled"===b?void a.$input.prop("disabled",g(c)):void(a.$input&&a.$input.prop(b,c)):void(a.init[b]=!0)}function g(a){if(!a)return!1;var b=a.toString();return"false"!==b&&"true"===b}return e.prototype.setAccessor=function(a,b){this[a]=c.observable(),this[a+"_canSet"]=!0,Object.defineProperty(this.element,a,{get:function(){return this[a]()}.bind(this),set:function(b){this[a+"_canSet"]=!1,this[a](b),this.element.setAttribute(a,b)}.bind(this)}),
this[a+"Changed"]=function(b,c){this[a+"_canSet"]=!1,this[a](c),this.element[a]=c}.bind(this),this[a].subscribe(function(c){b&&b.call(this,c),this.element.setAttribute(a,c),this.element[a]=c}.bind(this)),this[a](this.element.getAttribute(a)),b&&b.call(this,this.element.getAttribute(a))},e.prototype.attached=function(){},e.prototype.getGuid=function a(){return this.s4()+this.s4()+"-"+this.s4()+"-"+this.s4()+"-"+this.s4()+"-"+this.s4()+this.s4()+this.s4()},e.prototype.s4=function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)},Element.registerElement("mi-radio-noko",{prototype:d}),e});
define('ui/elements/filter/filter-no-ko',['require','lodash','jquery','text!./filter-btn-no-ko-view.html','text!./filter-body-no-ko-view.html','text!./filter-group-no-ko-view.html','./filter-collection-no-ko','system/lang/converter','system/globalization/translator','spa/conductor','spa/region','ui/elements/select/view-model','ui/elements/checkbox/view-model','ui/elements/radio/view-model'],function(require){"use strict";var a=require("lodash"),b=require("jquery"),c=require("text!./filter-btn-no-ko-view.html"),d=require("text!./filter-body-no-ko-view.html"),e=require("text!./filter-group-no-ko-view.html"),f=require("./filter-collection-no-ko"),g=require("system/lang/converter"),h=require("system/globalization/translator"),i=require("spa/conductor"),j=require("spa/region");require("ui/elements/select/view-model"),require("ui/elements/checkbox/view-model"),require("ui/elements/radio/view-model");var k=Object.create(HTMLElement.prototype);k.createdCallback=function(){var c=this;this.resizeProxy=b.proxy(a.debounce(this.resize,100),this),this.scrollProxy=b.proxy(this.scroll,this),this.translator=Object.resolve(h),this.isClicked=!1,this.element=this,this.$element=null,this.isVisible=!1,this.isFilterScrollable=this.getFilterScrollable(),this.loader=null,this.filterOptions=[],this.filterCollection=new f,this.filterVMRegion=null,this.tags=[],
this.customHTML=this.getAttribute("custom-html"),this.customFilter=this.getAttribute("custom-filter"),this.documentClickHandlerFn=r.bind(null,this),c.conductor=Object.resolve(i),c._filterViewModel=null,Element.defineProperty(c,"filterViewModel",{get:n.bind(null,c),set:o.bind(null,c)}),this._loader=null,Element.defineProperty(c,"loader",{get:t.bind(null,c),set:u.bind(null,c)}),this.callback=null,Element.defineProperty(c,"filterCB",{get:function(){return c.callback},set:function(a){c.callback=a}}),this._popupWidth=null,Element.defineProperty(c,"popupWidth",{get:function(){return c._popupWidth},set:function(a){c._popupWidth=a}}),this._showHeading=!0,Element.defineProperty(c,"showHeading",{get:function(){return c._showHeading},set:function(a){void 0!==a&&(c._showHeading=g.toBoolean(a,"true"))}}),this._showTags=!0,Element.defineProperty(c,"showTags",{get:function(){return c._showTags},set:function(a){void 0!==a&&(c._showTags=g.toBoolean(a,"true"))}}),this._maxHeight=null,
Element.defineProperty(c,"maxHeight",{get:function(){return c._maxHeight},set:function(a){c._maxHeight=a}}),this._internalIcon=null,Element.defineProperty(c,"icon",{get:function(){return c._internalIcon}.bind(c),set:function(a){l(c,a)}.bind(c)}),this._disabled=b(this).is("[disabled]"),Element.defineProperty(c,"disabled",{get:function(){return c._disabled}.bind(c),set:function(a){m(c,a)}.bind(c)}),c._internalIcon&&l(c,c._internalIcon)},k.attachedCallback=function(){this.setElement(),this.htmlToDisplay=this.element.innerHTML,this.element.innerHTML=c,this.attachClickHandlers(),l(this,this._internalIcon),m(this,this._disabled)},k.detachedCallback=function(){this.customFilter&&(q(this),this.conductor.unloadScreen(this.filterViewModel),this.conductor.closeScreen(this.filterViewModel)),b(document).find("#shell-screen").off("mousedown.mifilter touchstart click",this.documentClickHandlerFn),W(this),this.resizeProxy=null,this.scrollProxy=null,this.translator=null,this.isClicked=null,
this.isVisible=!1,this.isFilterScrollable=null,this.loader=null,this.filterOptions=null,this.filterCollection&&(this.filterCollection.clear(),this.filterCollection=null),this.filterVMRegion=null,this.tags=null,this.customHTML=null,this.customFilter=null,this.documentClickHandlerFn=null,this.conductor=null,this._loader=null,this.callback=null,this._popupWidth=null,this._showHeading=null,this._showTags=null,this._maxHeight=null,this._internalIcon=null,this._disabled=null,this._filterViewModel=null,this.filterViewModel=null,this.$element=null},k.attributeChangedCallback=function(a,b,c){var d=this;"custom-html"===a?(d.customHTML=c,W(d),"true"===c&&z(d)):"custom-filter"===a?(d.customFilter=c,W(d),"true"===c&&d.isVisible&&(d.conductor.openScreen(d._filterViewModel),d.conductor.loadScreen(d._filterViewModel),z(d))):"icon"===a?l(d,c):"disabled"===a&&m(d,c)};function l(a,c){a._internalIcon=c?c.trim():"icon-collection-filter",b(a).find("button i").removeAttr("class").addClass(a._internalIcon)}
function m(a,c){void 0!==c&&(a._disabled=c),a._disabled?b(a).find("button").addClass("disabled"):b(a).find("button").removeClass("disabled")}k.load=function(){var a;return this.loader?(a=this.loader(),a.promise()):b.Deferred().done().promise()},k.setElement=function(){this.$element=b(this.element)},k.attachClickHandlers=function(){this.$element.find(".icon-container").on("click",v.bind(null,this)),b(document).find("#shell-screen").on("mousedown.mifilter touchstart click",this.documentClickHandlerFn),this.find=s.bind(null,this)},k.detachClickHandlers=function(){},k.resize=function(a){b(a).find(".icon-container").is(":visible")&&a.isVisible&&X(this)},k.scroll=function(a){g.toBoolean(a.isFilterScrollable,"true")?a.resize(a):(w(a),a.isVisible=!1)},k.getFilterScrollable=function(){return this.getAttribute("isfilterscrollable")||!0},k.closeFilter=function(){w(this)};function n(a){return a._filterViewModel}function o(a,b){b?(a._filterViewModel=b,
"true"===a.getAttribute("custom-filter")&&(a.conductor.openScreen(a._filterViewModel),a.conductor.loadScreen(a._filterViewModel))):a._filterViewModel=null}function p(a){var c=new j;a.filterVMRegion=c,c.setElement(b(".filter-outer-container .filters-noko")),a.conductor.activateScreen(a.filterViewModel),a.conductor.attachScreen(a.filterViewModel,c)}function q(a){a.conductor.deactivateScreen(a.filterVMRegion),a.conductor.detachScreen(a.filterVMRegion)}function r(a,c,d){a.isClicked?a.isClicked=!1:b(".filter-outer-container").find(c.target).length||b(".filter-outer-container").find(d).length||b(c.target).closest(".icon-filter-container").length||w(a)}function s(a,c){return b(a.htmlToDisplay).find(c)[0]}function t(a){return a._loader}function u(a,b){a._loader=b,a.isPopulated=!1,a.filterCollection&&a.filterCollection.clear()}function v(a,b){b.stopPropagation(),a._disabled||(a.isVisible?w(a):x(a))}function w(a){a.isVisible=!1,b(window).off("resize",a.resizeProxy.bind(null,a)),
b(a).parents().off("scroll",a.scrollProxy.bind(null,a)),a.contentContainer&&b(a.contentContainer).off(" click","**"),"true"===a.customFilter&&q(a),W(a)}function x(a){a.isClicked=!0,a.isVisible=!0,b(document).find("#shell-screen").trigger("mousedown.mifilter"),"true"===a.customHTML||"true"===a.customFilter?z(a):a.load().done(y.bind(null,a))}function y(a,b){a.filterOptions=b,z(a)}function z(a){V(a),"true"===a.customHTML?b(".filter-outer-container .filters-noko").empty().append(a.htmlToDisplay):"true"===a.customFilter?p(a):(a.filterOptions.sortOptions&&a.filterOptions.sortOptions.length?B(a):b(".filter-outer-container .sort-header").hide(),E(a)),Y(a),X(a),A(a)}function A(a){null!==a._maxHeight&&b(".filter-outer-container .filter-body").css({"max-height":a._maxHeight+"px"})}function B(a){var c=b(".filter-outer-container .sort-header")[0],d,e;for(b(c).append('<mi-select class="sort-dropdown"></mi-select>'),d=b(c).find(".sort-dropdown")[0],e=0;e<a.filterOptions.sortOptions.length;e++);
b(d).data("options",a.filterOptions.sortOptions),b(d).attr("data-options",JSON.stringify(a.filterOptions.sortOptions)),C(a)}function C(a){b(".filter-outer-container .sort-header .sort-dropdown").on("valueChange",function(c){c.preventDefault(),D(a,"sort",b(this).val())})}function D(a,b,c){Object.tryMethod(a,"callback",b,c)}function E(a){a.isPopulated||(F(a),a.isPopulated=!0),G(a),L(a),a.contentContainer.find(".clear-all a").on("click",Q.bind(null,a))}function F(a){a.filterCollection.populateGroups(a.filterOptions)}function G(a){var b,c=a.filterCollection,d=c.filterGroups;for(a.tags=[],b=0;b<d.length;b++)H(a,d[b],b)}function H(a,c,d){var f=a.contentContainer.find(".filter-body").get(0),g=b(e),h,i,j;if(g.data("group-index",d),i=g.find("header"),j=g.find(".form-item div").get(0),I(i,c.caption),"select"===a.filterCollection.filterGroups[d].type)J(a,j,c,d);else for(h=0;h<c.items.length;h++)K(a,j,c.items[h],h,d);b(f).append(g)}function I(a,c){b(a).append(c)}function J(a,c,d,e){
for(var f=d.hideCaption?b('<mi-select data-optionsvalue="value" data-optionstext="text"></mi-select><br />').data({"group-index":e}):b('<mi-select data-optionsvalue="value" data-optionstext="text" data-optionscaption="'+a.filterCollection.filterGroups[e].caption+'"></mi-select><br />').data({"group-index":e}),g=0;g<d.items.length;g++)if(d.items[g].isSelected){b(f[0]).data("value",d.items[g].value),b(f[0]).attr("data-value",d.items[g].value),T(a,{target:f[0]},d.items[g].value,d.caption,d.items[g].text);break}b(f).data("options",d.items),b(f).attr("data-options",JSON.stringify(d.items)),b(c).append(f)}function K(a,c,d,e,f){var g,h;"checkbox"===a.filterCollection.filterGroups[f].type?g=b('<mi-checkbox-noko  value="'+d.value+'" text="'+d.text+'" ></mi-checkbox-noko><br />').data({"group-index":f,"item-index":e,item:d
}):"radio"===a.filterCollection.filterGroups[f].type&&(g=b('<mi-radio-noko  value="'+d.value+'" text="'+d.text+'" name="'+a.filterCollection.filterGroups[f].caption+'" ></mi-radio-noko>').data({"group-index":f,"item-index":e,item:d})),b(c).append(g),d.isSelected&&"checkbox"===a.filterCollection.filterGroups[f].type?(T(a,{target:g[0]},d.value,h,d.text),b(g[0]).attr("checked",d.isSelected)):d.isSelected&&"radio"===a.filterCollection.filterGroups[f].type&&(h=a.filterCollection.filterGroups[f].caption,T(a,{target:g[0]},d.value,h,d.text),g[0].setAttribute("checked",d.isSelected)),b(c).append(g)}function L(a){var b=a.contentContainer.find(".filter-body"),c,d,e;c=b.find("mi-checkbox-noko"),c&&(Element.upgrade(c),c.on("checkedChange",O.bind(null,a))),d=b.find("mi-radio-noko"),d&&(Element.upgrade(d),d.on("checkedChange",N.bind(null,a))),(e=b.find("mi-select"))&&(Element.upgrade(e),e.on("valueChange",M.bind(null,a)))}function M(c,d,e){d.preventDefault()
;var f=b(d.target).data(),g=parseInt(f["group-index"]),h=c.filterCollection.filterGroups[g],i=h.caption;if(e){R(c,i);var j=a.find(h.items,function(a){if(a&&a.value===e)return a});T(c,d,e,i,j.text)}else{P(c,e);var k=b(d.target).data("tag");k&&k.remove()}for(var l=h.type,m=c.filterCollection.filterGroups[g].items,n,o=0;o<m.length;o++)m[o].isSelected=!1,void 0!==m[o].value&&null!==m[o].value&&void 0!==e&&null!==e&&m[o].value.toString()===e.toString()&&(m[o].isSelected=!0,n=m[o]);c.filterCollection.filterGroups[g].items=m,S(c,l,n)}function N(a,c,d,e,f){if(d)R(a,f),T(a,c,e,f,e);else{P(a,e);b(c.target).data("tag").remove()}for(var g=b(c.target).data(),h=parseInt(g["group-index"]),i=a.filterCollection.filterGroups[h],j=i.type,k=a.filterCollection.filterGroups[h].items,l,m=0;m<k.length;m++)k[m].isSelected=!1;a.filterCollection.filterGroups[h].items=k,a.filterCollection.filterGroups[h].items[g["item-index"]].isSelected=d,g.item.isSelected=d,S(a,j,g.item)}function O(a,c,d,e){var f=c.target.text
;if(d)T(a,c,e,null,f);else{P(a,e);b(c.target).data("tag").remove()}var g=b(c.target).data(),h=parseInt(g["group-index"]),i=a.filterCollection.filterGroups[h],j=i.type;a.filterCollection.filterGroups[h].items[parseInt(g["item-index"])].isSelected=d,g.item.isSelected=d,S(a,j,g.item)}function P(a,b){var c=a.tags.indexOf(b);c>=0&&a.tags.splice(c,1),a.tags.length||(a.contentContainer.find(".tag-section").hide(),a.contentContainer.find(".clear-all").hide(),Y(a),X(a))}function Q(a){for(var c=a.contentContainer.find(".tag-section").find(".tag"),d=0;d<c.length;d++){var e=b(c[d]).data();U(a,e.value,e.item,{target:c[d]})}}function R(a,b){var c=a.contentContainer.find(".tag-section").find('.tag[name="'+b+'"]'),d=c.data("value"),e=a.tags.indexOf(d);a.tags.splice(e,1),c.remove()}function S(a,b,c){var d,e=a.filterCollection,f=e.filterGroups;Object.tryMethod(a,"callback",b,c,a.tags)}function T(a,c,d,e,f){a.contentContainer.find(".tag-section").show(),a.contentContainer.find(".clear-all").show(),
a.tags.push(d);var g=b('<div class="tag tag-style"><span><span>'+f+'</span></span><i class="icon-node-error icon-style"></i></div>');g.attr("name",e).data({value:d,item:c}).find(".icon-style").on("click",U.bind(null,a,d,c)),b(c.target).data("tag",g),g.appendTo(a.contentContainer.find(".tag-section"))}function U(a,c,d,e){b(e.target).closest(".tag").remove(),P(a,c);var f=b(d.target).data(),g=parseInt(f["group-index"]),h=a.filterCollection.filterGroups[g],i=h.type;if("checkbox"===i||"radio"===i?d.target.checked=!1:(b(d.target).data("value",""),b(d.target).attr("data-value","")),"checkbox"===i)a.filterCollection.filterGroups[g].items[parseInt(f["item-index"])].isSelected=!1;else if("radio"===i||"select"===i){for(var j=a.filterCollection.filterGroups[g].items,k=0;k<j.length;k++)j[k].isSelected=!1;a.filterCollection.filterGroups[g].items=j}S(a,i,b(d.target).data().item)}function V(a){var c,e;e=b(".content-wrapper"),c=document.createElement("div"),b(c).addClass("filter-outer-container"),
a.contentContainer=b(c),b(e).after(c),b(c).append(d).on("mousedown.mifilter",function a(b){b.stopPropagation()}),b(c).find(".clear-all a").html(a.translator.translate("MF_CLEAR_ALL")),b(b(c).find(".filter-header header")[0]).text(a.translator.translate("FILTER_HEADER_CAPTION")),b(b(c).find(".filter-header")[0]).removeClass("hide"),a.contentContainer.find(".tag-section").removeClass("hide"),a.showHeading||b(b(c).find(".filter-header")[0]).addClass("hide"),a.showTags||a.contentContainer.find(".tag-section").hide().addClass("hide")}function W(a){b(".filter-outer-container").remove()}function X(a){var c=50,d,e;Y(a),Z(a),a.ctrlOffset&&a.ctrlOffset.top+a.filtersHeight+c>=b(window).height()?$(a):_(a),b(window).on("resize",a.resizeProxy.bind(null,a)),b(a).parents().on("scroll",a.scrollProxy.bind(null,a))}function Y(a){a.outerContainer=b(a.contentContainer),a.ctrlOffset=b(a).find(".icon-container").offset(),a.ctrlWidth=b(a).find(".icon-container").width()+25,
null!==a._popupWidth&&b(a.outerContainer).find(".filters-noko").css("width",a._popupWidth+"px"),b(a.outerContainer).css({position:"absolute"}),a.filtersWidth=b(a.outerContainer).find(".filters-noko").width(),a.filtersHeight=b(a.outerContainer).find(".filters-noko").height()}function Z(a){b(a.outerContainer).find(".filters-noko").removeClass("top-left top-right bottom-left bottom-right")}function $(a){var b;a.ctrlOffset&&(b=a.ctrlOffset.top-a.filtersHeight-10,a.ctrlOffset&&a.ctrlOffset.left+a.ctrlWidth-a.filtersWidth<80?aa(a,"top-left",b):ba(a,"top-right",b))}function _(a){var b;a.ctrlOffset&&(b=a.ctrlOffset.top+50-6,a.ctrlOffset&&a.ctrlOffset.left+a.ctrlWidth-a.filtersWidth<80?aa(a,"bottom-left",b):ba(a,"bottom-right",b))}function aa(a,b,c){var d;d=a.ctrlOffset.left,ca(a,b),da(a,d,c)}function ba(a,b,c){var d;d=a.ctrlOffset.left-Math.abs(a.ctrlWidth-a.filtersWidth),null!==a._popupWidth&&(d-=12),ca(a,b),da(a,d,c)}function ca(a,c){var d;d=b(a.outerContainer).find(".filters-noko"),
b(d).addClass(c)}function da(a,c,d){b(a.outerContainer).css({left:c,top:d})}return document.registerElement("mi-filter-no-ko",{prototype:k}),k});
define('assets/asset-hierarchy-control',['require','jquery','spa/ko/knockout-view-model','system/knockout/knockout-manager','spa/region','application/application-events','application/application-context','assets/services/hierarchy-service','assets/asset-hierarchy-control-filter','assets/services/asset-context-dto','system/globalization/translator','toastr','text!./views/asset-hierarchy-control.html','text!./views/asset-hierarchy-control-filter.html','text!./views/asset-hierarchy-control-search.html','ramda','devExWebJS','ui/elements/tree/view-model','ui/elements/filter/filter-no-ko','ui/elements/searchbox/view-model','unified-asset-context-browser'],function(require){"use strict";var a=require("jquery"),b=require("spa/ko/knockout-view-model"),c=require("system/knockout/knockout-manager"),d=require("spa/region"),e=require("application/application-events"),f=require("application/application-context"),g=require("assets/services/hierarchy-service"),h=require("assets/asset-hierarchy-control-filter"),i=require("assets/services/asset-context-dto"),j=require("system/globalization/translator"),k=require("toastr"),l=require("text!./views/asset-hierarchy-control.html"),m=require("text!./views/asset-hierarchy-control-filter.html"),n=require("text!./views/asset-hierarchy-control-search.html"),o=require("ramda");require("devExWebJS"),require("ui/elements/tree/view-model"),require("ui/elements/filter/filter-no-ko"),require("ui/elements/searchbox/view-model"),require("unified-asset-context-browser");var p={selector:"none",multiSelect:!1},q=500,r=500,s=1;function t(a,b,c){u.call(this,l),this.service=a,this.tree=null,this.translator=b,
this.kom=c,this.filter=null,this.category=null,this.class=null,this.type=null,this.applyingFilter=!1,this.errorOccured=Object.resolve(e).errorOccured,this.sites=null,this.searchSelectedKey=null,this.selectChildren=null,this.disableSelectAllChildren=null,this.searchTerm=null,this.currentContext=[],this.contextNodes={},this.selectedAsset=null,this.filterConfigLoaded=!1}var u=Object.inherit(b,t);t.dependsOn=[g,j,c],t.create=function b(c){var d=Object.resolve(t);return d.settings=a.extend(null,p,c),d},t.prototype.load=function(){var a=this;this.category=this.kom.observable(),this.class=this.kom.observable(),this.type=this.kom.observable(),this.filter=new h(this.category,this.class,this.type),this.selectChildren=this.kom.observable(this.settings.selectChildren),this.disableSelectAllChildren=this.kom.observable(!0)},t.prototype.attach=function a(b,c){var e=this;this.settings.contentArea?(this.region=new d,this.region.setElement(b.$element.find(this.settings.contentArea))):this.region=b,
u.prototype.attach.call(this,this.region),this.contextBrowser=this.region.$element.find("asset-hierarchy-control")[0],this.isFirstLoad=!0,this.filterConfigLoaded=!1,Element.upgrade(this.contextBrowser),this.contextBrowser.filterTemplate=m,this.contextBrowser.searchTemplate=n,this.contextBrowser.spinnerTemplate='<span class="loading-med loading-active center-block" ></span>',this.contextBrowser.enableMultiSelect="addOnly"===this.settings.selector,this.contextBrowser.itemSelectorIcon='<i class="icon-plus"></i>',this.contextBrowser.addToolbarButton(v(this)),this.contextBrowser.itemExpandCB=G.bind(null,this),this.contextBrowser.filterConfig=y.bind(null,this),this.contextBrowser.filterCB=w.bind(null,this),this.contextBrowser.searchCB=F.bind(null,this),this.contextBrowser.addEventListener("selected",this),this.contextBrowser.addEventListener("search-cleared",this),!c&&z(this),this.disableSelectAllChildren.subscribe(function(a){
e.region&&e.region.$element&&e.region.$element.find(".add-all-children-btn").attr("disabled",!!a)})};function v(b){var c=a('<button><i class="icon-plus"></i></button>').addClass("btn btn-default btn-icon add-all-children-btn").attr("title",b.translate("ADD_ALL_CHILDREN")).attr("disabled",b.disableSelectAllChildren()).on("click",b.addAllChildren.bind(null,b));return b.settings.enableAddAllChildren&&!b.selectChildren()?c[0]:a("<span></span>")[0]}function w(a,b,c){var d,e,f;c&&(d=c[0],e=c[1],f=c[2]),a.applyingFilter=!0,a.category(d||null),a.class(e||null),a.type(f||null),!c&&a.contextBrowser.selected&&"-1"!==a.contextBrowser.selected&&"0"!==a.contextBrowser.selected?a.service.path(a.contextBrowser.selected).done(x.bind(null,a)):z(a)}function x(a,b){if(a.contextBrowser){if(b.length>1){for(var c=[],d=0;d<b.length;d++)b[d].name=b[d].description,b[d].key=b[d].entityKey,b[d].parentKey="-1",b[d].hasChildren=!0,c.push(b[d]);a.currentContext=[].concat(c),a.isFirstLoad=!0,
a.pathToNavigateInitial=c,J(a,a.pathToNavigateInitial).then(function(){z(a).done(function(){a.contextBrowser.navigate(c)})})}}else z(a)}function y(a,b){a.service.taxonomy().done(function(c){a.filterConfigLoaded=!0;var d=[{id:"CATEGORY",title:a.translate("TAXONOMY_CATEGORY"),defaultCaption:a.translate("SEL_TAX_CAT_CAP"),visible:!0},{id:"CLASS",title:a.translate("TAXONOMY_CLASS"),defaultCaption:a.translate("SEL_TAX_CLS_CAP"),visible:!0},{id:"TYPE",title:a.translate("TAXONOMY_TYPE"),defaultCaption:a.translate("SEL_TAX_TYP_CAP"),visible:!0}];b.resolve(c,d);var e=[a.category(),a.class(),a.type()];e[0]&&a.contextBrowser.filter(e)})}function z(b,c,d){var e=a.Deferred(),f=[{name:"Home",description:"Home",entityKey:"-1",key:"-1",hasChildren:!0,canOpen:!1,isExpanded:void 0===d}];return f=c===!1?[]:f,b.contextBrowser&&b.contextBrowser.init(f,!0),e.resolve(f),e}t.prototype.handleEvent=function(a){"selected"!==a.type||this.searchTerm?"filter-closed"===a.type?(this.applyingFilter=!0,
z(this)):"selected"===a.type&&this.searchTerm?B(this,a):"search-cleared"===a.type&&C(this):(this.service.abort(),this.disableSelectAllChildren(!this.settings.multiSelect))};function A(a){return 1===a.newValue.length}function B(a,b){var c=a.contextBrowser.selectedAsset,d=c.entityKey;a.searchSelectedKey=d}function C(a){var b=null===a.contextBrowser.selectedAsset||"-1"===a.contextBrowser.selectedAsset.key&&a.contextBrowser.selectedAsset.key!==a.contextBrowser.selectedAssetKey?a.selectedAsset:a.contextBrowser.selectedAsset,c=b?b.entityKey:"-1";O(a)&&(c="-1"),a.searchTerm=null,a.service.path(c).done(D.bind(null,a))}function D(a,b){if(a.contextBrowser)if(b.length>1){for(var c=[],d=0;d<b.length;d++)b[d].name=b[d].description,b[d].key=b[d].entityKey,b[d].parentKey="-1",b[d].hasChildren=!0,c.push(b[d]);a.currentContext=[].concat(c),a.isFirstLoad=!0,a.pathToNavigateInitial=c,J(a,a.pathToNavigateInitial).then(function(){z(a).done(function(){a.contextBrowser.navigate(c)})})}else z(a)}
t.prototype.detach=function a(){this.service.abort(),this.region.$element.find(".hierarchy-control-filter").off("filter-closed"),this.contextBrowser.removeEventListener("selected",this),this.contextBrowser=null,this.toolbar=null,this.filterElem=null,this.searchElem=null,this.searchTerm=null,this.applyingFilter=!1,this.currentContext=[],this.contextNodes={},this.category(null),this.class(null),this.type(null),u.prototype.detach.call(this,this.region),this.region=null,this.filterConfigLoaded=!1},t.prototype.unload=function a(){this.kom.dispose()},t.prototype.translate=function(a){return this.translator.translate(a)},t.prototype.loadcontext=function(a){this.contextBrowser.selected=a,this.service.path(a).done(N.bind(null,this)).fail(P.bind(null,this))};var E=o.cond([[o.or(o.equals("0"),o.equals(0)),o.always(null)],[o.T,o.identity()]]);t.prototype.setSiteFilter=function(a){a&&(this.sites=o.map(E,a))},t.prototype.loadState=function(a){a=a||{tree:{value:i.default()}},
this.category(a.category),this.class(a.class),this.type(a.type),this.searchTerm=a.searchTerm,this.selectedAsset=a.context},t.prototype.saveState=function(){var a=null===this.contextBrowser.selectedAsset||null!==this.contextBrowser.selectedAsset&&"-1"===this.contextBrowser.selectedAsset.key&&this.contextBrowser.selectedAsset.key!==this.contextBrowser.selectedAssetKey;return{category:this.category(),class:this.class(),type:this.type(),context:a?this.selectedAsset:this.contextBrowser.selectedAsset,searchTerm:this.searchTerm}},t.prototype.getContextValue=function(){var a=null===this.contextBrowser.selectedAsset||"-1"===this.contextBrowser.selectedAsset.key&&this.contextBrowser.selectedAsset.key!==this.contextBrowser.selectedAssetKey;return i.fromHierarchyDTO(a?this.selectedAsset:this.contextBrowser.selectedAsset)},t.prototype.addAllChildren=function(a,b){var c=new CustomEvent("selectallchildren",{bubbles:!0,cancelable:!0,detail:a.contextBrowser.selectedAsset})
;a.contextBrowser&&a.contextBrowser.dispatchEvent(c)};function F(b,c,d,e,f){var g=a.Deferred();return e=s,f=r,b.searchTerm=c,c&&o.isNil(b.sites)?b.service.search(c,e,f).done(L.bind(null,b,g)).fail(P.bind(null,b)):c&&!o.isNil(b.sites)?b.service.search(c,e,f).done(M.bind(null,b,g,b.sites)).fail(P.bind(null,b)):g.resolve(),g}function G(b,c,d,e,g){var h="",i="",j="",k=d||a.Deferred(),l;return b.contextBrowser?(l=c||f.assetcontext)?b.contextNodes[l.entityKey]?(o.isNil(b.sites)?H(b,k,l,b.contextNodes[l.entityKey]):I(b,k,l,b.sites,b.contextNodes[l.entityKey]),delete b.contextNodes[l.entityKey],k):(b.category()&&(h=b.category().code),b.class()&&(i=b.class().code),b.type()&&(j=b.type().code),o.isNil(b.sites)?b.service.children(l.entityKey,h,i,j,s,q).done(H.bind(null,b,k,l)).fail(P.bind(null,b)):b.service.children(l.entityKey,h,i,j,s,q,b.sites).done(I.bind(null,b,k,l,b.sites)).fail(P.bind(null,b)),k):(setTimeout(H.bind(null,b,k,{data:[]})),k):(setTimeout(k.reject.bind(k),0),k)}
function H(a,b,c,d){for(var e=!1,f=a.currentContext&&a.currentContext.length>1,g=!1,h=0,i=0;i<a.currentContext.length-1;i++)a.currentContext[i].entityKey===c.entityKey&&(g=!0,h=i);var j=d.data.map(function(b){return b.name=b.description,b.key=a.searchTerm?R():b.entityKey,b.parentKey=a.searchTerm?c.key:c.entityKey,b.hasChildren=!!b.hasChildren,g&&!e&&f&&!a.searchTerm&&a.currentContext[h].entityKey===b.parentKey&&a.currentContext[h+1].entityKey===b.entityKey&&(e=!0),b});if(!e&&f&&g&&!a.searchTerm&&!a.applyingFilter){var k=a.currentContext[h+1];j.push(k)}if(j.length>=q){var l=a.searchTerm?c.key:c.entityKey,m={key:l.toString()+"_more_data",isAlertMessage:!0,name:a.translate("ASSET_HIERARCHY_TOO_MANY_MSG"),pathLabel:a.translate("ASSET_HIERARCHY_TOO_MANY_SUGGESTION"),parentKey:l};j.push(m)}b.resolve(j),a.category()&&0===d.data.length&&a.applyingFilter?z(a,!1):a.applyingFilter=!1}function I(a,b,c,d,e){o.forEach(K.bind(null,d),e.data)
;for(var f=!1,g=a.currentContext&&a.currentContext.length>1,h=!1,i=0,j=0;j<a.currentContext.length-1;j++)a.currentContext[j].entityKey===c.entityKey&&(h=!0,i=j);var k=e.data.map(function(b){return b.name=b.description,b.key=a.searchTerm?R():b.entityKey,b.parentKey=a.searchTerm?c.key:c.entityKey,b.hasChildren=!!b.hasChildren,b.canOpen=!b.disabledIcon,h&&!f&&g&&!a.searchTerm&&a.currentContext[i].entityKey===b.parentKey&&a.currentContext[i+1].entityKey===b.entityKey&&(f=!0),b});if(!f&&g&&h&&!a.searchTerm&&!a.applyingFilter){var l=a.currentContext[i+1];k.push(l)}if(k.length>=q){var m=a.searchTerm?c.key:c.entityKey,n={key:m.toString()+"_more_data",isAlertMessage:!0,name:a.translate("ASSET_HIERARCHY_TOO_MANY_MSG"),pathLabel:a.translate("ASSET_HIERARCHY_TOO_MANY_SUGGESTION"),parentKey:m};k.push(n)}b.resolve(k),a.category()&&0===e.data.length&&a.applyingFilter?z(a,!1):a.applyingFilter=!1}function J(b,c){var d=c.filter(function(a){return a.entityKey!==c[c.length-1].entityKey})
;return a.when.apply(a,d.map(function(a){return b.service.children(a.entityKey,"","","",s,q)})).then(function(){for(var a=0;a<d.length;a++)b.contextNodes[d[a].key]=arguments[a]})}function K(a,b){b.disabledIcon=!o.contains(b.siteKey,a)}function L(a,b,c){if(b.resolve(c.data),a.searchSelectedKey=null,a.contextBrowser){var d=c.data.map(function(a){return a.name=a.description,a.key=R(),a.parentKey="-1",a.hasChildren=!!a.hasChildren,a.pathLabel=a.hierarchyPath,a});if(d.length>=r){var e={key:R()+"_more_data",isAlertMessage:!0,name:a.translate("ASSET_HIERARCHY_TOO_MANY_MSG"),pathLabel:a.translate("ASSET_HIERARCHY_TOO_MANY_SUGGESTION"),parentKey:"-1"};d.push(e)}a.contextBrowser.init(d)}}function M(a,b,c,d){if(o.forEach(K.bind(null,c),d.data),b.resolve(d.data),a.searchSelectedKey=null,a.contextBrowser){var e=d.data.map(function(a){return a.name=a.description,a.key=R(),a.parentKey="-1",a.hasChildren=!!a.hasChildren,a.canOpen=!a.disabledIcon,a.pathLabel=a.hierarchyPath,a});if(e.length>=r){var f={
key:R()+"_more_data",isAlertMessage:!0,name:a.translate("ASSET_HIERARCHY_TOO_MANY_MSG"),pathLabel:a.translate("ASSET_HIERARCHY_TOO_MANY_SUGGESTION"),parentKey:"-1"};e.push(f)}a.contextBrowser.init(e)}}function N(a,b){var c;if(a&&a.contextBrowser){for(var d=[],e=0;e<b.length;e++)b[e].name=b[e].description,b[e].key=b[e].entityKey,b[e].parentKey="-1",b[e].hasChildren=!0,d.push(b[e]);c=[a.category(),a.class(),a.type()],a.currentContext=[].concat(d),a.pathToNavigateInitial=d,a.searchTerm&&null!==a.searchTerm?a.contextBrowser.search(a.searchTerm):c[0]?(z(a,!0,!1),a.filterConfigLoaded&&a.contextBrowser.filter(c)):J(a,a.pathToNavigateInitial).then(function(){z(a).done(function(){a.isFirstLoad?a.contextBrowser.navigate(d):a.pathToNavigateInitial=d})})}}function O(b){return!!a(b.region.element).parents(".asset-finder-screen").length}function P(a,b,c,d){d&&"abort"!==d&&k.error(d,void 0,{positionClass:"toast-top-right "})}function Q(){
return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function R(){return Q()+Q()+""+Q()+Q()+Q()+Q()+Q()+Q()}return t});
define('system/http/es6-ajax-request',['require','./ajax-request','bluebird'],function(require){"use strict";var a=require("./ajax-request"),b=require("bluebird");function c(a,b,c,e){d.call(this,a,b,c,e),this.xhr=null}var d=Object.inherit(a,c);c.get=function(a,b){return new c("get",a,null,b)},c.post=function(a,b,d){return new c("post",a,b,d)},c.put=function(a,b,d){return new c("put",a,b,d)},c.delete=function(a,b){return new c("delete",a,null,b)},c.prototype.send=function(){return this.xhr=d.prototype.send.call(this),b.resolve(this.xhr).catch(e.bind(null,this))};function e(a,b){return{request:a,response:b}}return c});
define('assets/services/asset-dto',['require','system/lang/converter'],function(require){"use strict";var a=require("system/lang/converter");function b(b){b=b||{},this.entityKey=a.toString(b.entityKey),this.equipmentId=a.toString(b.equipmentId),this.groupid=a.toString(b.equipmentId),this.familyId=a.toString(b.familyId),this.siteKey=a.toInteger(b.siteKey)}return b.fromDataCollection=function a(c){var d,e=[];for(d=0;d<c.length;d++)e[d]=new b(c[d]);return e},b.fromSelectedAsset=function a(c){return new b({entityKey:c.entityKey,equipmentId:c.description,familyId:c.familyId,siteKey:c.siteKey})},b.fromSelectedAssetArray=function a(c){return c.map(b.fromSelectedAsset)},b});
define('assets/services/asset-group-dto',['require','system/lang/converter','assets/services/asset-dto','assets/services/hierarchy-dto','assets/models/family','system/lang/string'],function(require){"use strict";var a=require("system/lang/converter"),b=require("assets/services/asset-dto"),c=require("assets/services/hierarchy-dto"),d=require("assets/models/family");require("system/lang/string");function e(e){e=e||{},this.entityKey=a.toString(e.entityKey),this.groupid=a.toString(e.groupid),this.createdBy=a.toString(e.createdBy),this.modifiedBy=a.toString(e.lastUpdatedBy),this.modifiedOn=a.toDate(e.lastUpdatedDate),this.groupdesc=a.toString(e.groupdesc),this.catalogKey=a.toInteger(e.catalogKey),this.catalogPath=a.toString(e.catalogPath),this.siteKey=a.toInteger(e.siteKey),this.equipmentCount=a.toInteger(e.equipmentCount),this.relationships=e.relationships?d.fromDataCollection(e.relationships):[],this.equipments=e.equipments?b.fromDataCollection(e.equipments):[],this.corrosionloops=e.corrosionloops?f(e.corrosionloops):[],this.hierarchyparents=e.hierarchyparents?c.fromDataCollection(e.hierarchyparents):[],this.selected=null}e.fromDataCollection=function a(b){
var c,d=[];for(c=0;c<b.length;c++)d[c]=new e(b[c]);return d},e.fromAssetContextDTO=function a(b){return new e({entityKey:b.entityKey,createdBy:b.createdBy,groupid:b.description})};function f(b){var c,d=[];for(c=0;c<b.length;c++)d[c]=a.toString(b[c]);return d}return e});
define('system/lang/url-codec',["require","exports"],function(require,exports){"use strict";var a=[],b=/\[\]$/,c=/\[/,d=/\]$/,e=function(){function b(){}return b.encode=function(b){return a=[],h("",b).join("&")},b.decode=function(a){return i(a)},b}();function f(a){return"[object Array]"===Object.prototype.toString.call(a)}function g(b,c){c="function"==typeof c?c():null===c?"":void 0===c?"":c,a[a.length]=encodeURIComponent(b)+"="+encodeURIComponent(c)}function h(c,d){var e,i;if(c)if(f(d))for(e=0,i=d.length;e<i;e++)b.test(c)?g(c,d[e]):h(c+"["+("object"==typeof d[e]?e:"")+"]",d[e]);else if(d&&"[object Object]"===String(d))for(var j in d)d.hasOwnProperty(j)&&h(c+"["+j+"]",d[j]);else g(c,d);else if(f(d))for(e=0,i=d.length;e<i;e++)g(d[e].name,d[e].value);else for(var j in d)d.hasOwnProperty(j)&&h(j,d[j]);return a}function i(a){var b={};return a?(a.split("&").forEach(j.bind(null,b)),b):b}function j(a,b){var e=b.split("="),f=decodeURIComponent(e[0]),g=typeof a,h=f.split("]["),i=h.length-1
;if(c.test(h[0])&&d.test(h[i])){h[i]=h[i].replace(d,"");var j=h.shift();null!==j&&(h=j.split("[").concat(h),i=h.length-1)}else i=0;if(2===e.length){var k=decodeURIComponent(e[1]);if(i)for(var l=0;l<=i;l++)f=""===h[l]?g.length:h[l],g=g[f]=l<i?g[f]||(h[l+1]&&isNaN(h[l+1])?{}:[]):k;else"[object Array]"===Object.prototype.toString.call(a[f])?a[f].push(k):!{}.hasOwnProperty.call(a,f)?a[f]=k:a[f]=[a[f],k]}}return e});
define('assets/services/group-service',['require','jquery','system/http/ajax-client','assets/services/asset-group-dto','assets/services/asset-dto','assets/services/hierarchy-dto','security/services/site-dto','catalog/services/dto/user-pref-dto','system/lang/url-codec'],function(require){"use strict";var a=require("jquery"),b=require("system/http/ajax-client"),c=require("assets/services/asset-group-dto"),d=require("assets/services/asset-dto"),e=require("assets/services/hierarchy-dto"),f="api/common/assetgroup",g="api/core/security",h=require("security/services/site-dto"),i=require("catalog/services/dto/user-pref-dto"),j="api/core/userpref/",k=require("system/lang/url-codec");function l(a){this.ajaxClient=a,this.request=null}l.dependsOn=[b],l.prototype.abort=function a(){this.request&&this.request.abort()},l.prototype.getAllGroups=function(b,c,d,e,g,h){var i=a.Deferred(),j="",k="",l;for(d=d||[],l=0;l<d.length;l++)j+="&keys="+d[l];return h=h?"&searchterm="+h:"",e=e?"&relationshipId="+e:"",g=g?"&byCurrUser="+g:"",k="?page="+b+"&pageSize="+c+j+e+g+h,this.ajaxClient.get(f+k).done(n.bind(null,i)).fail(i.reject.bind(i)),i.promise()},l.prototype.getGroupDetails=function b(c){var d=a.Deferred()
;return this.ajaxClient.get(f+"/"+c.toString()).done(o.bind(null,d)).fail(u.bind(null,d)),d.promise()},l.prototype.assets=function b(c,d,e){var g=a.Deferred();return this.ajaxClient.get(f+"/"+c+"/assets?page="+d+"&pageSize="+e).done(q.bind(null,g)).fail(g.reject.bind(g)),g.promise()},l.prototype.allAssets=function b(c){var d=a.Deferred();return this.ajaxClient.get(f+"/"+c+"/assets").done(q.bind(null,d)).fail(d.reject.bind(d)),d.promise()},l.prototype.assetsByKey=function b(c){var d=a.Deferred();return this.ajaxClient.get(f+"/"+c+"/assetsbykey").done(q.bind(null,d)).fail(d.reject.bind(d)),d.promise()},l.prototype.getGroupDetailsWithPaging=function(b,c,d){var e=a.Deferred(),g=this;return this.request=this.ajaxClient.get(f+"/"+b.toString()+"?page="+c.toString()+"&pageSize="+d.toString()).done(o.bind(null,e)).fail(e.reject.bind(e)).always(p.bind(null,g)),e.promise()},l.prototype.addGroup=function b(c){var d=a.Deferred()
;return this.ajaxClient.post(f,c).done(o.bind(null,d)).fail(d.reject.bind(d)),d.promise()},l.prototype.editGroup=function b(c){var d=a.Deferred();return this.ajaxClient.put(f,c).done(t.bind(null,d)).fail(d.reject.bind(d)),d.promise()},l.prototype.removeGroup=function b(c){var d=a.Deferred();return this.ajaxClient.delete(f+"/"+c.toString()).done(t.bind(null,d)).fail(d.reject.bind(d)),d.promise()},l.prototype.addAssets=function b(c,d,e){var g=a.Deferred();return e=e?"?contextKey="+e.toString():"",this.ajaxClient.post(f+"/"+c.toString()+"/assets"+e,d).done(t.bind(null,g)).fail(g.reject.bind(g)),g.promise()},l.prototype.removeAssets=function b(c,d){var e=a.Deferred(),g=null,h,i=[],j;for(j=d.splice(0,50);j&&j.length>0;)h=j.map(m),g=k.encode({keys:h}),i[i.length]=this.ajaxClient.delete(f+"/"+c.toString()+"/assets?"+g),j=d.splice(0,50);return a.when.apply(a,i).done(t.bind(null,e)).fail(e.reject.bind(e)),e.promise()},l.prototype.addAssociations=function b(c,d){var e=a.Deferred()
;return this.ajaxClient.post(f+"/"+c+"/hierarchy",d).done(t.bind(null,e)).fail(e.reject.bind(e)),e.promise()},l.prototype.removeAssociations=function b(c,d){var e=a.Deferred(),g=null;return g=k.encode({keys:d}),this.ajaxClient.delete(f+"/"+c+"/hierarchy?"+g).done(t.bind(null,e)).fail(e.reject.bind(e)),e.promise()},l.prototype.getAssociations=function b(c){var d=a.Deferred();return this.ajaxClient.get(f+"/"+c.toString()+"/hierarchy").done(s.bind(null,d)).fail(d.reject.bind(d)),d.promise()},l.prototype.getSites=function b(){var c=a.Deferred();return this.ajaxClient.get(g+"/sites",{}).done(r.bind(null,c)).fail(c.reject.bind(c)),c.promise()},l.prototype.getPreference=function b(c,d){var e=a.Deferred(),f=j+"get/"+c+"/1?name="+d;return this.ajaxClient.get(f,{}).done(t.bind(null,e)).fail(e.reject.bind(e)),e.promise()},l.prototype.setPreference=function b(c){var d=a.Deferred(),e=j+"set";return this.ajaxClient.post(e,c).done(t.bind(null,d)).fail(d.reject.bind(d)),d.promise()},
l.prototype.copyGroup=function b(c){var d=a.Deferred();return this.ajaxClient.post(f+"/copy",c).done(o.bind(null,d)).fail(u.bind(null,d)),d.promise()},l.prototype.checkPermission=function(){var b=a.Deferred();return this.ajaxClient.get(f+"/permission").done(b.resolve.bind(b)).fail(b.reject.bind(b)),b.promise()};function m(a){return a.entityKey||a}function n(a,b){a.resolve(c.fromDataCollection(b))}function o(a,b){a.resolve(new c(b))}function p(a){a.request=null}function q(a,b){a.resolve(d.fromDataCollection(b))}function r(a,b){a.resolve(h.fromDataCollection(b))}function s(a,b){a.resolve(e.fromDataCollection(b))}function t(a,b){a.resolve(b)}function u(a,b,c,d){a.reject(b,c,d)}return l});

define('text!assets/views/asset-group-control.html',[],function () { return '<div data-bind="if: settings.loadAssets, style: { height: settings.loadAssets ? \'100%\' : 0 }">\r\n    <mi-tree description="groupid"\r\n             custom-filter="true"\r\n             data-bind="attr: { \'root-name\': translate(\'ASSET_GROUPS\'), multiselect: settings.multiSelect, \'allow-add\': settings.allowAdd, \'has-children\': settings.hasChildren }">\r\n        <mi-tool-bar>\r\n            <!-- ko if: settings.enableAddAllChildren === true -->\r\n            <button class="btn btn-default btn-icon" data-bind="click: addAllChildren, attr: { title: translate(\'ADD_ALL_CHILDREN\'), disabled: disableSelectAllChildren }">\r\n                <i class="icon-plus"></i>\r\n            </button>\r\n            <!-- /ko -->\r\n        </mi-tool-bar>\r\n    </mi-tree>\r\n</div>\r\n\r\n<div data-bind="ifnot: settings.loadAssets, style: { height: !settings.loadAssets ? \'100%\' : 0 }">\r\n<mi-list-group description="groupid"\r\n               custom-filter="true"\r\n               data-bind="attr: { selector: settings.selector, multiselect: settings.multiSelect, \'allow-add\': settings.allowAdd, \'has-children\': settings.hasChildren }">\r\n</mi-list-group>\r\n</div>\r\n';});


define('text!assets/views/hierarchy-finder.html',[],function () { return '<section class="asset-hierarchy-finder">\r\n    <section class="hierarchy-control"></section>\r\n    <section class="well tag-section" data-bind="foreach: results">\r\n        <span class="tag" data-bind="click: $root.removeSelection.bind($root)">\r\n            <span class="block-group">\r\n                <span data-bind="text: description"></span>\r\n                <i class="icon-multiply"></i>\r\n            </span>\r\n        </span>\r\n    </section>\r\n    <div class="controls">\r\n        <button type="button" class="btn  btn-text  btn-secondary" data-bind="click: cancel, text: translate(\'CANCEL\')"></button>\r\n        <button type="button" class="btn btn-text" data-bind="click: done, text: translate(\'OK\'), enable: hasSelection"></button>        \r\n    </div>\r\n</section>\r\n';});

define('assets/models/selected-asset',[],function(){"use strict";function a(a,b,c,d,e){this.entityKey=a,this.description=b,this.family=c,this.familyId=d,this.siteKey=e?e:0}return a});
define('assets/adapters/selected-asset-adapter',['require','assets/models/selected-asset'],function(require){"use strict";var a=require("assets/models/selected-asset");function b(){}return b.fromAssetDTO=function b(c){return new a(c.entityKey,c.equipmentId,"",c.familyId,c.siteKey)},b.fromAssetDTOArray=function a(c){return c.map(b.fromAssetDTO)},b.fromHierarchyDTO=function b(c){return new a(c.entityKey,c.description,c.family,c.familyId,c.siteKey)},b.fromAssetGroupDTO=function b(c){return new a(c.entityKey,c.groupid,"","",c.siteKey)},b.fromHierarchyDTOArray=function a(c){return c.map(b.fromHierarchyDTO)},b});
define('assets/hierarchy-finder',['require','jquery','knockout','system/knockout/knockout-manager','spa/ko/knockout-view-model','assets/asset-hierarchy-control','system/ui/dialog-view-model','text!./views/hierarchy-finder.html','system/globalization/translator','assets/adapters/selected-asset-adapter'],function(require){"use strict";var a=require("jquery"),b=require("knockout"),c=require("system/knockout/knockout-manager"),d=require("spa/ko/knockout-view-model"),e=require("assets/asset-hierarchy-control"),f=require("system/ui/dialog-view-model"),g=require("text!./views/hierarchy-finder.html"),h=require("system/globalization/translator"),i=require("assets/adapters/selected-asset-adapter");function j(){k.call(this,g),this.dialog=null,this.dfd=null,this.translator=Object.resolve(h),this.kom=Object.resolve(c),this.results=null,this.existing=[],this.assetHierarchyControl=null,this.settings={multiSelect:!0,contentArea:".hierarchy-control",selector:"addOnly"}}var k=Object.inherit(d,j);j.prototype.show=function b(c,d){var e={height:"90%",width:"40%"};return d===!1&&(this.settings.multiSelect=d),c=c||[],c.map instanceof Function?this.existing=c.map(i.fromHierarchyDTO):this.existing=[i.fromHierarchyDTO(c)],this.dialog=new f(this,this.translator.translate("HIERARCHY_FINDER"),e),
this.dialog.show(),this.dfd=a.Deferred(),this.dfd.promise()},j.prototype.close=function a(){this.dialog=null},j.prototype.load=function a(){this.results=this.kom.observableArray(this.existing),this.hasSelection=this.kom.computed(l.bind(null,this)),this.assetHierarchyControl=e.create(this.settings),this.assetHierarchyControl.load()},j.prototype.attach=function a(b){k.prototype.attach.apply(this,arguments),this.assetHierarchyControl.attach(b),this.assetHierarchyControl.loadState(),this.assetHierarchyControl.contextBrowser.addEventListener("multiSelected",this),this.assetHierarchyControl.contextBrowser.addEventListener("search-selected",this)},j.prototype.detach=function a(){this.assetHierarchyControl.contextBrowser.removeEventListener("multiSelected",this),this.assetHierarchyControl.contextBrowser.removeEventListener("search-selected",this),this.assetHierarchyControl.detach(),k.prototype.detach.apply(this,arguments)},j.prototype.unload=function a(){this.kom.dispose(),
"resolved"!==this.dfd.state()&&this.dfd.reject(),this.dfd=null,this.assetHierarchyControl.unload(),this.assetHierarchyControl=null,this.existing=null},j.prototype.handleEvent=function(a){"multiSelected"===a.type?o(this,a.detail):"search-selected"===a.type&&o(this,a.searchResult[0])},j.prototype.done=function a(){this.settings.multiSelect?this.dfd.resolve(this.results()):this.dfd.resolve(this.results()[0]),this.dialog.closeDialog()},j.prototype.cancel=function a(){this.dialog.closeDialog()},j.prototype.translate=function a(b){return this.translator.translate(b)},j.prototype.removeSelection=function a(c,d){var e=b.dataFor(d.target);d.target.classList.contains("icon-multiply")&&e.entityKey&&n(this,e.entityKey)};function l(a){return a.results().length>0}function m(a,b){for(var c=0;c<a.length&&a[c].entityKey!==b;)c++;return c===a.length?-1:c}function n(a,b){var c=0;(c=m(a.results(),b))>-1&&a.results.splice(c,1)}function o(a,b){
b&&(a.settings.multiSelect?m(a.results(),b.entityKey)===-1&&a.results.push(i.fromHierarchyDTO(b)):a.results.splice(0,1,i.fromHierarchyDTO(b)))}return j});

define('text!assets/views/group-filter.html',[],function () { return '<section class="group-filter">\r\n    <section class="form-group">\r\n        <label class="control-label" for="relationships" data-bind="text: $root.translate(\'ASSET_HIERARCHY_RELATIONSHIP_FIELD\')"></label>\r\n        <select class="form-control"\r\n                name="relationships"\r\n                data-bind="options: relationships, optionsText: \'caption\', optionsValue: \'id\', value: $root.selectedFamily, optionsCaption: $root.translate(\'ASSET_HIERARCHY_RELATIONSHIP_CAPTION\')"></select>\r\n    </section>\r\n\r\n    <section class="hierarchy">\r\n        <button class="hierarchy-filter btn btn-default" data-bind="click: editHierarchy, text: translate(\'HIERARCHY_FILTER\')"></button>\r\n        <div class="hierarchy-list">\r\n            <ul data-bind="foreach: results, click: removeHierarchyFilter">\r\n                <li class="list-group-item"><i class="icon-multiply"></i><span data-bind="text: description"></span></li>\r\n            </ul>\r\n        </div>\r\n    </section>\r\n\r\n    <section class="my-groups">\r\n        <mi-checkbox data-bind="miCheckboxProperty: {\r\n                            checked: filterByCurrUser,\r\n                            disable: false,\r\n                            value: filterByCurrUser,\r\n                            text: translate(\'MY_GROUPS\')}">\r\n        </mi-checkbox>\r\n    </section>\r\n\r\n    <div class="controls">\r\n        <button type="button" class="btn  btn-text  btn-secondary" data-bind="click: cancel, text: translate(\'CLOSE\')"></button>\r\n        <button type="button" class="btn btn-text" data-bind="click: done, text: translate(\'DONE\')"></button>\r\n    </div>\r\n</section>\r\n';});


define('text!ui/elements/checkbox/checkbox-template.html',[],function () { return '<script id="mi-checkbox-tmpl" type="text/html">\r\n    <div class="checkbox-container">\r\n        <input type="checkbox" data-bind="checked: $root.checked,disable: $root.disable,value:$root.value, attr:{id:$data.id, required: $root.required}, checkedValue: $root.checkedValue " />\r\n        <label data-bind="attr:{for:$data.id}">\r\n            <span class="checkbox-label" ></span>\r\n            <span class="chkbox-text" data-bind="text:$root.text"></span>\r\n        </label>       \r\n    </div>\r\n</script>';});

define('ui/elements/checkbox/checkbox-view-model',['require','lodash','jquery','text!./checkbox-template.html','knockout'],function(require){"use strict";var a=require("lodash"),b=require("jquery"),c=require("text!./checkbox-template.html"),d=require("knockout");d.bindingHandlers.miCheckboxProperty={createNodes:function(a,b){document.getElementById("mi-checkbox-tmpl")||document.body.insertAdjacentHTML("beforeend",c),d.applyBindingsToNode(a,{template:{name:"mi-checkbox-tmpl"}},b)},init:function(a,c){var e=c();return e.id=d.bindingHandlers.miCheckboxProperty.getGuid(),e.textClick=function a(c,d){if(this.disable)return!1;"function"==typeof this.checked?this.checked(!this.checked()):"boolean"==typeof this.checked&&(b(d.target).parent().find("input").prop("checked",!this.checked),this.checked=!this.checked)},d.bindingHandlers.miCheckboxProperty.createNodes(a,e),{controlsDescendantBindings:!0}},getGuid:function a(){return this.s4()+this.s4()+"-"+this.s4()+"-"+this.s4()+"-"+this.s4()+"-"+this.s4()+this.s4()+this.s4()},s4:function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)},
update:function(c,e){var f,g=b(c).find('input[type="checkbox"]');a.each(e(),function(a,e){f=d.unwrap(a),"disable"===e?g.prop("disabled",f):"checked"===e?f!==!0&&f!==!1||g.prop("checked",f):"text"===e&&b(c).find(".chkbox-text").html(f)})}};var e=Object.create(HTMLElement.prototype);document.registerElement("mi-checkbox",{prototype:e})});
define('assets/group-filter-view-model',['require','jquery','knockout','spa/ko/knockout-view-model','system/ui/dialog-view-model','system/globalization/translator','assets/hierarchy-finder','assets/services/hierarchy-service','text!./views/group-filter.html','ui/elements/checkbox/checkbox-view-model'],function(require){"use strict";var a=require("jquery"),b=require("knockout"),c=require("spa/ko/knockout-view-model"),d=require("system/ui/dialog-view-model"),e=require("system/globalization/translator"),f=require("assets/hierarchy-finder"),g=require("assets/services/hierarchy-service"),h=require("text!./views/group-filter.html");require("ui/elements/checkbox/checkbox-view-model");function i(){j.call(this,h),this.dialog=null,this.dfd=null,this.existing=[],this.relationships=[],this.family=null,this.selectedFamily=null,this.service=Object.resolve(g),this.translator=Object.resolve(e),this.results=null,this.finder=null,this.byCurrUser=null,this.filterByCurrUser=!1}var j=Object.inherit(c,i);i.prototype.show=function b(c,e,f){var g={height:"70%",width:"40%"};return c&&c instanceof Array?this.existing=c:this.existing=c?[c]:[],this.family=e,this.byCurrUser=f,this.dialog=new d(this,this.translator.translate("GROUP_FILTER"),g),this.dialog.show(),this.dfd=a.Deferred(),this.dfd.promise()},
i.prototype.close=function a(){this.dialog=null},i.prototype.load=function c(){this.finder=new f,a.isArray(this.existing)?this.results=b.observableArray(this.existing):this.results=b.observableArray([this.existing]),this.selectedFamily=b.observable(this.family),this.relationships=b.observableArray([]),this.filterByCurrUser=b.observable(this.byCurrUser),this.service.relationshipsById().done(k.bind(null,this))},i.prototype.attach=function a(){j.prototype.attach.apply(this,arguments)},i.prototype.detach=function a(){j.prototype.detach.apply(this,arguments)},i.prototype.unload=function a(){this.dialog=null,this.dfd=null,this.existing=[],this.existing=null,this.results([]),this.results=null,this.finder.close(),this.finder=null,this.selectedFamily(null),this.family=null,this.filterByCurrUser(null)},i.prototype.done=function a(){var b={family:this.selectedFamily(),results:this.results(),byCurrUser:this.filterByCurrUser()};this.dfd.resolve(b),this.dialog.closeDialog()},
i.prototype.cancel=function a(){this.dialog.closeDialog()},i.prototype.translate=function a(b){return this.translator.translate(b)},i.prototype.editHierarchy=function a(){this.finder.show(this.results()).done(l.bind(null,this))},i.prototype.removeHierarchyFilter=function c(d,e){var f=b.dataFor(e.target),g=0;if(a(e.target).hasClass("icon-multiply"))for(g=0;g<this.results().length;g++)this.results()[g].entityKey===f.entityKey&&this.results.splice(g,1)};function k(a,b){a.relationships(b),a.selectedFamily(a.family),a.filterByCurrUser(a.byCurrUser)}function l(a,b){a.results(b)}return i});
define('assets/asset-group-control',['require','jquery','bluebird','system/http/es6-ajax-request','spa/ko/knockout-view-model','spa/region','assets/services/group-service','assets/services/hierarchy-service','assets/services/asset-group-dto','assets/services/asset-context-dto','text!./views/asset-group-control.html','system/globalization/translator','assets/group-filter-view-model','system/error/error-message','application/application-events','application/application-context','catalog/services/dto/user-pref-dto','system/knockout/knockout-manager','catalog/services/catalog-constants','ui/elements/list-group/view-model','ui/elements/tree/view-model','ui/elements/tool-bar/view-model'],function(require){"use strict";var a=require("jquery"),b=require("bluebird"),c=require("system/http/es6-ajax-request"),d=require("spa/ko/knockout-view-model"),e=require("spa/region"),f=require("assets/services/group-service"),g=require("assets/services/hierarchy-service"),h=require("assets/services/asset-group-dto"),i=require("assets/services/asset-context-dto"),j=require("text!./views/asset-group-control.html"),k=require("system/globalization/translator"),l=require("assets/group-filter-view-model"),m=require("system/error/error-message"),n=require("application/application-events"),o=require("application/application-context"),p=require("catalog/services/dto/user-pref-dto"),q=require("system/knockout/knockout-manager"),r=require("catalog/services/catalog-constants");require("ui/elements/list-group/view-model"),require("ui/elements/tree/view-model"),require("ui/elements/tool-bar/view-model");var s={multiSelect:!1,selector:"none",contentArea:"",allowAdd:!1,loadAssets:!0,
hasChildren:!1};function t(a,b,c,d){u.call(this,j),this.user=o.user,this.constants=new r,this.groupService=a,this.hierarchyService=Object.resolve(g),this.translator=b,this.settings=null,this.selectedHierarchy=null,this.selectedFamily=null,this.filter=null,this.groupElement=null,this.appEvents=c,this.delayed=!1,this.filterByCurrUser=!1,this.kom=d,this.selectChildren=null,this.disableSelectAllChildren=null}var u=Object.inherit(d,t,q);t.dependsOn=[f,k,n,q],t.create=function b(c){var d=Object.resolve(t);return d.settings=a.extend(null,s,c),d.filter=new l,d},t.prototype.addAllChildren=function(){var a=new CustomEvent("selectallchildren",{bubbles:!0,cancelable:!0});this.groupElement.dispatchEvent(a)},t.prototype.attach=function a(b){var c;this.disableSelectAllChildren=this.kom.observable(!0),this.settings.contentArea?(c=new e,c.setElement(b.$element.find(this.settings.contentArea))):c=b,u.prototype.attach.call(this,c),this.groupElement=c.$element.find("mi-tree, mi-list-group")[0],
Element.upgrade(this.groupElement),v(this).then(E.bind(null,this)).then(w.bind(null,this))};function v(a){return b.resolve(a.groupService.getPreference(a.user.key,"groups-by-user"))}function w(a){null!==a.groupElement&&(a.groupElement.loader=a.loadGroup.bind(a),a.groupElement.addEventListener("search-selected",a),a.groupElement.addEventListener("filter-closed",a),a.groupElement.addEventListener("navigating",a),a.groupElement.addEventListener("navigated",a),a.settings.loadAssets?a.groupElement.searchCallback=a.searchGroupTree.bind(a):a.groupElement.searchCallback=a.searchGroupList.bind(a),a.groupElement.filterViewModel=a.editFilter.bind(a),a.groupElement.setAttribute("allow-add",a.settings.allowAdd))}t.prototype.handleEvent=function(a){"navigating"===a.type?(3===a.newValue.length&&a.preventDefault(),
this.disableSelectAllChildren(x(a))):"navigated"===a.type&&2===a.target.pathHistory.listGroup.length?a.target.pathHistory.listGroup[1].setAttribute("has-children","false"):"search-selected"===a.type?this.loadcontext(a.searchResult[0]):"filter-closed"===a.type&&(this.applyingFilter=!0)};function x(a){return 1===a.newValue.length}t.prototype.detach=function a(b){var c;this.groupElement.removeEventListener("search-selected",this),this.groupElement.removeEventListener("filter-closed",this),this.groupElement.removeEventListener("navigating",this),this.groupElement.removeEventListener("navigated",this),this.groupElement=null,this.settings.contentArea?(c=new e,c.setElement(b.$element.find(this.settings.contentArea))):c=b,this.filter&&this.filter.close(),c.screen&&u.prototype.detach.call(this,c)},t.prototype.unload=function a(){this.filter&&(this.filter.close(),this.filter=null)},t.prototype.translate=function a(b){return this.translator.translate(b)},t.prototype.editFilter=function a(){
this.filter.show(this.selectedHierarchy,this.selectedFamily,this.filterByCurrUser).done(y.bind(null,this)).fail(B.bind(null,this))},t.prototype.searchGroupTree=function(a,b,c,d){return this.groupService.getAllGroups(c,d,z(this),this.selectedFamily,this.filterByCurrUser,a).fail(B.bind(null,this)).promise()},t.prototype.searchGroupList=function(a,b,c){return this.groupService.getAllGroups(b,c,z(this),this.selectedFamily,this.filterByCurrUser,a).fail(B.bind(null,this)).promise()},t.prototype.loadGroup=function b(c,d,e){var f=a.Deferred();return void 0===e?this.groupService.getAllGroups(c,d,z(this),this.selectedFamily,this.filterByCurrUser).done(f.resolve.bind(f)).fail(B.bind(null,this)):0===c?this.groupService.getAllGroups(d,e,z(this),this.selectedFamily,this.filterByCurrUser).done(f.resolve.bind(f)).fail(B.bind(null,this)):this.groupService.assets(this.groupElement.value[c].entityKey,d,e).done(f.resolve.bind(f)).fail(B.bind(null,this)),f.promise()},t.prototype.loadcontext=function(a){
a&&(this.settings.loadAssets?C(this,a):D(this,a))},t.prototype.getContextValue=function(){return this.loadAssets?i.fromGroupDTO(this.groupElement.value[this.groupElement.value.length-1]):i.fromGroupDTO(this.groupElement.value||this.groupElement.items[0])},t.prototype.setValue=function(a,b){var c=b.originalEvent.searchResult[0];c&&(this.groupElement.value=c,this.groupElement.reload())},t.prototype.loadState=function(a){a=a||{},this.selectedHierarchy=a.hierarchy,this.selectedFamily=a.family,this.filterByCurrUser=a.byCurrUser,this.groupElement.loadState(a.groupElement)},t.prototype.saveState=function(){return{hierarchy:this.selectedHierarchy,family:this.selectedFamily,byCurrUser:this.filterByCurrUser,groupElement:this.groupElement.saveState()}};function y(a,b){a.selectedFamily=b.family,a.selectedHierarchy=b.results,a.filterByCurrUser!==b.byCurrUser&&(a.filterByCurrUser=b.byCurrUser,F(a)),a.groupElement.reload()}function z(a){
return a.selectedHierarchy?a.selectedHierarchy instanceof Array?0===a.selectedHierarchy.length?null:a.selectedHierarchy.map(A):[a.selectedHierarchy.entityKey]:null}function A(a){return a.entityKey}function B(a,b,c,d){if("abort"!==d){var e=new m("AG1",d,(new Error).stack);a.appEvents.errorOccured.raise(a,e)}}function C(a,b){"-1"===b.entityKey?a.groupElement.value&&a.groupElement.value.length>0&&(a.groupElement.value=a.groupElement.value[0]):a.groupElement.value[1]=h.fromAssetContextDTO(b)}function D(a,b){var c=h.fromAssetContextDTO(b);a.groupElement.value=c,a.groupElement.reload();var d=a.groupElement.querySelector("mi-list-group");d&&(Element.upgrade(d),d.value=c,d.reload())}function E(a,b){b&&b.value&&(a.filterByCurrUser="True"===b.value)}function F(a){var b=new p;b.userKey=a.user.key,b.prefType=a.constants.CATALOG_PREFERENCE,b.name="groups-by-user",b.value=a.filterByCurrUser,a.groupService.setPreference(b)}return t});
define('system/ui/dialog-box',['require','lodash','jquery','system/ui/dialog-view-model','system/lang/object'],function(require){"use strict";var a=require("lodash"),b=require("jquery"),c=require("system/ui/dialog-view-model");require("system/lang/object");function d(a,b,c){e.call(this,a,b,c),this.handlingButtonClick=!1,this.dfd=null,this.showHelp(!1),this.showClose(!1),this.showCheck(!1)}var e=Object.inherit(c,d);d.prototype.show=function(){return e.prototype.show.call(this),f(this),this.dialogContentRegion.$element.css("overflow-y","auto").addClass("dialog-box"),this.dfd=b.Deferred(),this.dfd.promise()},d.prototype.setContent=function(a){e.prototype.setContent.call(this,a)};function f(c){if(c.options&&c.options.buttons){var d=c.options.buttons||[],e=c.dialogShellRegion.$element.find(".dialog-wrapper");if(d.length>0){var f=b('<div class="button-bar clearfix text-right"></div>').appendTo(e);a.each(d,function(a,d){var e=a.cssClass?a.cssClass:"btn-default";b('<button class="btn pull-right '+e+'"><span>'+a.name+"</span></button>").on("click",g.bind(null,c,d,a.value||a.name)).appendTo(f)}),
b('<div class="clearfix"></div>').appendTo(f),c.centerDialog()}}}function g(a,c,d){if(!a.handlingButtonClick){a.handlingButtonClick=!0;var e=Object.tryMethod(a.content,d);if(e===!1)return void(a.handlingButtonClick=!1);b.when(e).done(function(b){a.dfd.resolve(c,d,b),a.closeDialog(),a.handlingButtonClick=!1}).fail(function(b){a.options.closeOnReject&&(a.dfd.reject(c,d,b),a.closeDialog()),a.handlingButtonClick=!1})}}d.prototype.closeDialog=function(){h(this),e.prototype.closeDialog.apply(this,arguments)};function h(c){var d=c.dialogShellRegion.$element.find(".dialog-wrapper"),e=b(".button-bar",d),f=e.find("button");a.each(f,i),e.remove(),c.centerDialog()}function i(a){b(a).off().remove()}return d});
define('assets/models/selected-asset-results',['require','knockout'],function(require){"use strict";var a=require("knockout");function b(){this.existing=null,this.selected=null,this.arrayChangeSubscription=null,this.added=[],this.removed=[]}b.prototype.init=function b(d){var e,f=[];if(this.existing=d,d)for(e=0;e<d.length;e++)f[f.length]=d[e];this.selected=a.observableArray(f),this.arrayChangeSubscription=this.selected.subscribe(c.bind(null,this),null,"arrayChange")},b.prototype.dispose=function a(){this.selected([]),this.selected=null,this.arrayChangeSubscription.dispose(),this.arrayChangeSubscription=null};function c(a,b){var c;for(c=0;c<b.length;c++)"added"===b[c].status?f(a,b[c].value):e(a,b[c].value.entityKey)}function d(a,b){for(var c=0,d=!1;c<a.length&&!d;)d=a[c].entityKey===b,c++;return d?a[c-1]:void 0}function e(a,b){var c=0,e=!1,f;if(f=d(a.existing,b))a.removed.push(f);else for(c=0,e=!1;c<a.added.length&&!e;)e=a.added[c].entityKey===b,e&&a.added.splice(c,1),c++}function f(a,b){var c=0,e=!1;if(d(a.existing,b.entityKey))for(c=0,
e=!1;c<a.removed.length&&!e;)e=a.removed[c].entityKey===b.entityKey,e&&a.removed.splice(c,1),c++;else d(a.added,b.entityKey)||a.added.push(b)}return b});

define('text!ui/elements/asset-context/template.html',[],function () { return '<div class="asset-context-selection static">\r\n  <div class="navigation">\r\n    <ul class="nav nav-pills assetMenu pull-left" data-bind="click: menuClick">\r\n      <li data-bind="css: {active: activePill() === hierarchy.url }">\r\n        <a data-bind="attr: { \'data-menu-item\': hierarchy.url, href: hierarchy.href, title: translator.translate(\'ASSET_HIERARCHY\') }, text: translator.translate(\'ASSET_HIERARCHY\')">\r\n        </a>\r\n      </li>\r\n      <li data-bind="css: {active: activePill() === group.url }">\r\n        <a data-bind="attr: { href: group.href, \'data-menu-item\': group.url, title: translator.translate(\'ASSET_GROUP\') }, text: translator.translate(\'ASSET_GROUP\')">\r\n        </a>\r\n      </li>\r\n    </ul>          \r\n  </div>\r\n  <section class="block-group context-select">\r\n    <section class="asset-content">\r\n      <section class="asset-hierarchy-control" data-bind="visible: $root.activePill() === \'hierarchy\'"></section>\r\n      <section class="asset-group-explorer" data-bind="visible: $root.activePill() === \'group\'"></section>\r\n    </section>\r\n  </section>\r\n</div>\r\n';});

define('assets/services/asset-context-service',['require','lodash','jquery','system/http/ajax-client','assets/services/asset-context-dto','application/application-context'],function(require){"use strict";var a=require("lodash"),b=require("jquery"),c=require("system/http/ajax-client"),d=require("assets/services/asset-context-dto"),e=require("application/application-context"),f="api/common/assetcontext/";function g(a){this.ajaxClient=a,this.request=null}g.dependsOn=[c],g.prototype.getcontext=function c(d){var e=b.Deferred();return this.request&&this.abort(),d&&"-1"!==d&&"0"!==d?this.request=this.ajaxClient.get(f+d).done(k.bind(null,this,e)).fail(l.bind(null,this,e)):(this.request="home",a.defer(j,this,e,"-1")),e.promise()},g.prototype.abort=function(){this.request&&this.request.abort?this.request.abort():"home"===this.request&&(this.request="home-abort")},g.prototype.getAssetContextPreference=function(){var a=f+"preference/"+i(),c=b.Deferred();return this.ajaxClient.get(a).done(k.bind(null,this,c)).fail(l.bind(null,this,c)),c.promise()},g.prototype.getAssetContextAppHub=function(){var a=f+"apphub/"+i(),c=b.Deferred()
;return this.ajaxClient.get(a).done(h.bind(null,c)).fail(l.bind(null,this,c)),c.promise()};function h(a,b){return a.resolve(b)}g.prototype.setAssetContextAppHub=function(a){var c=f+"apphub/"+a,d=b.Deferred();return this.ajaxClient.put(c).done(k.bind(null,this,d)).fail(l.bind(null,this,d)),d.promise()};function i(){return e.user.key}function j(a,b,c){"home-abort"!==a.request&&b.resolve(d.default(c)),a.request=null}function k(a,b,c){a.request=null,b.resolve(new d(c))}function l(a,b,c,e){a.request=null,404===c.status?b.resolve(d.default()):"abort"!==e&&b.reject()}return g});
define('ui/elements/asset-context/view-model',['require','lodash','jquery','assets/asset-hierarchy-control','assets/asset-group-control','system/ui/dialog-box','system/globalization/translator','assets/models/selected-asset-results','knockout','text!./template.html','spa/region','application/application-context','assets/services/asset-context-dto','assets/services/hierarchy-dto','assets/services/asset-group-dto','assets/services/asset-context-service','ramda'],function(require){"use strict";var a=require("lodash"),b=require("jquery"),c=require("assets/asset-hierarchy-control"),d=require("assets/asset-group-control"),e=require("system/ui/dialog-box"),f=require("system/globalization/translator"),g=require("assets/models/selected-asset-results"),h=require("knockout"),i=require("text!./template.html"),j=require("spa/region"),k=require("application/application-context"),l=require("assets/services/asset-context-dto"),m=require("assets/services/hierarchy-dto"),n=require("assets/services/asset-group-dto"),o=require("assets/services/asset-context-service"),p=require("ramda"),q=["selector","multiselect","allowAdd"],r={};r.prototype=Object.create(HTMLElement.prototype),r.prototype.createdCallback=function(){this.element=this,this.translator=Object.resolve(f),this.results=null,this.dialog=null,this.existing=[],this.activePill=null,this.internalvalue=null,this.showAsDialog=null,this.assetContextService=Object.resolve(o),this.group={
href:"#assets/group",title:this.translator.translate("ASSET_GROUP"),url:"group",screen:null},this.hierarchy={href:"#assets/hierarchy",title:this.translator.translate("ASSET_HIERARCHY"),url:"hierarchy",screen:null},Object.defineProperty(this,"value",{get:K.bind(null,this),set:this.setContext.bind(this)}),this.delayload=Element.booleanAttribute(this,"delayload")},r.prototype.setContext=function(c){var d=new b.Deferred,e;return c&&(e=c.entityKey||c)?this.internalvalue&&"-1"!==this.internalvalue.entityKey&&L(this.internalvalue.entityKey,e)?(a.defer(d.resolve,this.internalvalue),d.promise()):(s(this,c),z(this,c,d),d.promise()):(a.defer(d.resolve,this.internalvalue),d.promise())};function s(a,b){"string"==typeof b&&B(a,b)}r.prototype.attachedCallback=function(){Element.clearDom(this),"true"===this.getAttribute("data-open")?(this.load(),this.attach(new j(b(this)))):T(this)},r.prototype.disableStuff=function(a,b){if(a!==!1||b!==!1){var c=this.region.element.querySelector(".assetMenu")
;a===!0?(P(this),M(this),this.region.element.querySelector(".asset-hierarchy-control").style.display="none",c.removeChild(c.firtElementChild),this.activePill("hierarchy")):b===!0&&(R(this),N(this),this.region.element.querySelector(".asset-group-explorer").removeAttribute("data-bind"),c.removeChild(c.lastElementChild),this.activePill("group")),c.classList.add("not-active")}},r.prototype.detachedCallback=function(){this.region&&(this.detach(),this.unload())},r.prototype.attributeChangedCallback=function(a,b,c){this.delayload===!1&&("entitykey"===a?z(this,c):"loadassets"===a?(this.group.screen.settings.loadAssets="true"===c,this.group.screen.settings.hasChildren="true"===c,this.group.screen.detach(this.region),this.group.screen.attach(this.region)):"selectchildren"===a?this.hierarchy.screen.selectChildren(c):"multiselect"===a&&(this.hierarchy.screen.settings.multiSelect="true"===c),H(this,a,c))},r.prototype.menuClick=function a(b,c){var d,e,f;c.preventDefault(),
c.stopImmediatePropagation(),f=c.target.getAttribute("data-menu-item"),e="hierarchy"===f?this.hierarchy:this.group,d=new CustomEvent("menu-changing",{bubbles:!0,cancelable:!0,detail:{menu:e}}),this.dispatchEvent(d),d.returnValue===!1||d.defaultPrevented||("hierarchy"===f?this.showHierarchy():this.showGroup())},r.prototype.load=function(){var a,b,e,f;for(this.results=new g,this.results.init(),this.results.existing=this.existing,this.activePill=h.observable("hierarchy"),f=this.getAttribute("data-open"),this.showAsDialog=h.observable(!f),a=0;a<this.existing.length;a++)this.results.selected.push(this.existing[a]);b={multiSelect:!1,selectedItems:this.results.selected,selectable:!1,contentArea:".asset-hierarchy-control",enableAddAllChildren:null!==this.getAttribute("enableAddAllChildren"),selectChildren:null!==this.getAttribute("selectChildren")},e={multiSelect:!1,selectedItems:this.results.selected,selectable:!1,contentArea:".asset-group-explorer",
loadAssets:null!==this.getAttribute("loadassets"),enableAddAllChildren:null!==this.getAttribute("enableAddAllChildren"),allowAdd:null!==this.getAttribute("allow-add")},this.hierarchy.screen=c.create(b),this.hierarchy.screen.load(),this.group.screen=d.create(e)},r.prototype.attach=function(a){this.region=a,this.region.attach(b(i)),this.region.$element.find(".region").attr("data-bind","halt-bindings"),this.region.element.addEventListener("change",this),this.delayload===!1&&(h.applyBindingsToDescendants(this,this.region.element.querySelector(".region")),O(this),Q(this),I(this),Element.raiseEvent(this.group.screen.groupElement.querySelector("mi-tool-bar"),"resize",{}))},r.prototype.detach=function(){P(this),R(this),h.cleanNode(this.region.element),this.region.clear(),this.region=null},r.prototype.handleEvent=function(a){
"navigated"===a.type?this.group.screen&&a.target===this.group.screen.groupElement?w(this):u(this):"selected"===a.type&&"group"!==this.activePill()&&this.group.screen&&a.target!==this.group.screen.groupElement?u(this):"selected"===a.type&&"group"===this.activePill()?v(this):"loaded"===a.type?J(this,a):"click"===a.type?x(this):"change"===a.type&&a.target!==this&&a.stopImmediatePropagation()},r.prototype.unload=function a(){M(this),N(this)},r.prototype.translateText=function a(b){return this.translator.translate(b)},r.prototype.done=function a(){this.dialog||y(this)},r.prototype.showHierarchy=function a(){this.activePill(this.hierarchy.url),Element.raiseEvent(this,"menu-change",{menu:this.hierarchy})},r.prototype.showGroup=function a(){this.activePill(this.group.url),Element.raiseEvent(this,"menu-change",{menu:this.group}),Element.raiseEvent(this.group.screen.groupElement.querySelector("mi-tool-bar"),"resize",{})},r.prototype.setSiteFilter=function(a){
this.hierarchy.screen.setSiteFilter(a)},r.prototype.loadState=function(a){var c,d;return a=a||{},a.hierarchy=a.hierarchy||{},a.group=a.group||{},a.hierarchy.value=null,a.group.value=null,this.hierarchy.screen.loadState(a.hierarchy),this.group.screen.loadState(a.group),c=a.value,c?d=this.setContext(c):(d=b.Deferred(),d.resolve(),a.menu===this.group.url?(this.activePill(this.group.url),this.group.screen.groupElement.addEventListener("loaded",this),this.group.screen.groupElement.reload()):(this.activePill(this.hierarchy.url),this.value=t(this)?k.assetcontext:l.default())),d.promise()},r.prototype.saveState=function(){return{hierarchy:this.hierarchy.screen.saveState(),group:this.group.screen.saveState(),value:this.internalvalue,menu:this.activePill()}},r.prototype.href=function(){return this.activePill()===this.hierarchy.url?this.hierarchy.href+"/"+this.value.entityKey:this.group.href+"/"+this.value.entityKey};function t(a){if(p.isNil(a.parentElement))return!1
;if(p.isNil(a.parentElement.parentElement))return!1;if(p.isNil(a.parentElement.parentElement.parentElement))return!1;var b=a.parentElement.parentElement.parentElement;return b.classList.contains("assets-shell-screen")&&!b.classList.contains("asset-finder-screen")}function u(a){var c=a.hierarchy.screen.contextBrowser.selectedAsset;A(a,l.fromHierarchyDTO(c)),b(a.element).find("span.context-id").text(a.internalvalue.description)}function v(a){a.group.screen.groupElement.value&&(A(a,l.fromGroupDTO(a.group.screen.groupElement.value)),b(a.element).find("span.context-id").text(a.internalvalue.description))}function w(a){var c=a.group.screen.groupElement.value.length-1,d=a.group.screen.groupElement.value[c];A(a,l.fromGroupDTO(d)),b(a.element).find("span.context-id").text(a.internalvalue.description)}function x(a){var c={height:"90%",width:"auto",buttons:[{name:a.translator.translate("DONE"),value:"done",cssClass:"btn-primary"}]},d=a.translator.translate("ASSET_HIERARCHY")
;null!==a.getAttribute("dialog")?(a.dialog=new e(a,d,c),a.dialog.show(),a.loadState()):(a.region||a.attach(new j(b(a.querySelector(".asset-context-selection")))),b(a.element).find("div.asset-context-selection").show())}function y(a){b(a.element).find("div.asset-context-selection").removeAttr("style")}function z(a,b,c){var d;b instanceof l?setTimeout(F.bind(null,a,c,b),0):b instanceof m?(d=l.formHierarchyDTO(b),setTimeout(F.bind(null,a,c,d),0)):b instanceof n?(d=l.fromGroupDTO(b),setTimeout(F.bind(null,a,c,d),0)):b.entityKey?a.assetContextService.getcontext(b.entityKey).done(F.bind(null,a,c)).fail(c.reject.bind(c)):a.assetContextService.getcontext(b).done(F.bind(null,a,c)).fail(c.reject.bind(c))}function A(a,b){(!a.internalvalue&&a.internalvalue!==b||a.internalvalue.entityKey!==b.entityKey)&&(a.internalvalue=b,G(a))}function B(a,b){(!a.internalvalue&&a.internalvalue!==b||a.internalvalue.entityKey!==b.entityKey)&&(a.internalvalue=b)}function C(a){var b=a.value||[{}]
;return 0===b.length?"":b[b.length-1].entityKey||""}function D(a){var b=a.selectedAsset;return b?b.entityKey:""}function E(a,b){var c,d,e,f;(a.region||a.dialog)&&(c="Hierarchy"===b.type,f=a.hierarchy.screen.contextBrowser,c?(a.activePill(a.hierarchy.url),D(f)!==b.entityKey&&a.hierarchy.screen.loadcontext(b.entityKey)):(a.activePill(a.group.url),e=a.group.screen.groupElement,e.value&&e.value.entityKey===b.entityKey||a.group.screen.loadcontext(b)))}function F(a,c,d){null===d&&(d=k.assetcontext||l.default()),E(a,d),A(a,d),a.internalvalue&&b(a.element).find("span.context-id").text(a.internalvalue.description),c&&c.resolve(d)}function G(a){Element.raiseEvent(a,"change",a.internalvalue)}function H(a,b,c){var d,e,f,g,h;if(q.indexOf(b)>-1){for(h=a.querySelector("asset-hierarchy-control"),"selector"===b&&h&&(h.enableMultiSelect="addOnly"===c),d=a.getElementsByTagName("mi-list-group"),e=0;e<d.length;e++)null!==c?d[e].setAttribute(b,c):d[e].removeAttribute(b)
;for(f=a.querySelectorAll("mi-tool-bar mi-searchbox"),e=0;e<f.length;e++)null!==c?f[e].setAttribute(b,c):f[e].removeAttribute(b);for(g=a.getElementsByTagName("mi-tree"),e=0;e<g.length;e++)"groupid"===g[e].getAttribute("description")&&"selector"===b&&(c="none"),null!==c?g[e].setAttribute(b,c):g[e].removeAttribute(b)}}function I(a){var b;for(b=0;b<q.length;b++)H(a,q[b],a.getAttribute(q[b]))}function J(a,b){if(null!==b.detail.frag.querySelector("mi-li")){var c=b.detail.frag.querySelector("mi-li").value;a.value=c,a.group.screen&&a.group.screen.groupElement.removeEventListener("loaded",a)}}function K(a){return a.internalvalue}function L(a,b){return a="0"===a?"-1":a,b="0"===b?"-1":b,a===b}function M(a){a.hierarchy.screen&&(a.hierarchy.screen.unload(),a.hierarchy.screen=null)}function N(a){a.group.screen&&(a.group.screen.unload(),a.group.screen=null)}function O(a){a.hierarchy.screen.attach(a.region,!0),a.hierarchy.screen.contextBrowser.addEventListener("selected",a)}function P(a){
a.hierarchy.screen&&(a.hierarchy.screen.contextBrowser.removeEventListener("selected",a),a.hierarchy.screen.detach(a.region))}function Q(a){var b;a.group.screen.attach(a.region),b=null!==a.getAttribute("loadassets"),b?a.group.screen.groupElement.addEventListener("navigated",a):a.group.screen.groupElement.addEventListener("selected",a)}function R(a){a.group.screen&&(a.group.screen.groupElement.removeEventListener("navigated",a),a.group.screen.groupElement.removeEventListener("selected",a),a.group.screen.detach(a.region))}function S(a){var c=k.assetcontext||l.default();F(a,b.Deferred(),c)}function T(a){var b,c,d,e,f;f=document.createElement("div"),f.className="region",b=document.createElement("div"),f.appendChild(b),c=document.createElement("button"),c.className="btn btn-default",b.appendChild(c),e=document.createElement("span"),e.className="context-id",c.appendChild(e),c.addEventListener("click",a),d=document.createElement("i"),d.className="ds ds-assethierachy ds-dashboard-style",
c.appendChild(d),a.appendChild(f),b=document.createElement("div"),b.className="asset-context-selection",a.appendChild(b),S(a)}return document.registerElement("mi-asset-context",{prototype:r.prototype}),r});
define('ui/elements/date-time/element',['require','exports','module','lodash','jquery','logging/error-notification-handler','system/diagnostics/log-manager','system/lang/converter','./date-time-control'],function(require,exports,module){"use strict";var a=require("lodash"),b=require("jquery"),c=require("logging/error-notification-handler"),d=require("system/diagnostics/log-manager"),e=d.getLogger(module.id),f=require("system/lang/converter"),g=require("./date-time-control"),h=Object.create(HTMLElement.prototype);h.createdCallback=function(){m(this),this.rebuild=a.debounce(U.bind(null,this),100),this.errorNotificationHandler=Object.resolve(c)},h.attachedCallback=function(){try{i(this)}catch(a){V(a,this)}},h.detachedCallback=function(){try{j(this)}catch(a){V(a,this)}finally{Element.clearDom(this)}},h.attributeChangedCallback=function(a,b,c){try{k(this,a,b,c)}catch(a){V(a,this)}};function i(a){a.control=new g(a),o(a),a.control.initHTML(),a.control.initialize({pickDate:a.pickDate,pickTime:a.pickTime,useMinutes:a.useMinutes,useSeconds:a.useSeconds,minuteStep:a.minuteStep,format:a.format,disabled:a.disabled,required:a.required,defaultDate:a.value,useCurrent:a.useCurrent}),
a.control.changed.add(E,null,a),a.control.blur.add(F,null,a),a.control.invalid.add(H,null,a),a.control.hide.add(G,null,a),a.control.clear.add(I,null,a)}function j(a){a.control.dispose(),a.control=null,Element.clearDom(a)}function k(a,b,c,d){"value"===b?(c=f.toNullableDate(c),d=f.toNullableDate(d),L(a,c,d)):"format"===b?a.format=p(a):"pick-date"===b?a.pickDate=q(a):"pick-time"===b?a.pickTime=r(a):"use-minutes"===b?a.useMinutes=s(a):"use-seconds"===b?a.useSeconds=t(a):"minute-step"===b?a.minuteStep=u(a):"disabled"===b?a.disabled=v(a):"required"===b?a.required=x(a):"populate-empty"===b&&(a.useCurrent=w(a)),l(a)}function l(a){a._properties.value&&a.control.picker.setValue(a.control.picker.date.toDate())}function m(b){b._properties={pickDate:!0,pickTime:!0,useMinutes:!0,useSeconds:!1,minuteStep:1,format:"",disabled:!1,required:!1,useCurrent:!0,oldValue:null},a.each(b._properties,n.bind(null,b)),b._properties.value=f.toDate(),Element.defineProperty(b,"value",{get:A.bind(null,b,"value"),
set:C.bind(null,b)})}function n(a,b,c){Object.defineProperty(a,c,{get:A.bind(null,a,c),set:B.bind(null,a,c)})}function o(a){a._properties.format=p(a),a._properties.pickDate=q(a),a._properties.pickTime=r(a),a._properties.useMinutes=s(a),a._properties.useSeconds=t(a),a._properties.minuteStep=u(a),a._properties.disabled=v(a),a._properties.value=f.toDate(z(a),void 0,z(a)),a._properties.required=x(a),a._properties.useCurrent=w(a),a._properties.oldValue=a._properties.value}function p(a){return Element.stringAttribute(a,"format",a.format)}function q(a){return y(a,"pick-date",a.pickDate)}function r(a){return y(a,"pick-time",a.pickTime)}function s(a){return y(a,"use-minutes",a.useMinutes)}function t(a){return y(a,"use-seconds",a.useSeconds)}function u(a){return Element.intAttribute(a,"minute-step",a.minuteStep)}function v(a){return Element.booleanAttribute(a,"disabled")}function w(a){return!Element.booleanAttribute(a,"populate-empty")}function x(a){return Element.booleanAttribute(a,"required")}
function y(a,b,c){var d=a.getAttribute(b);return d?f.toBoolean(d,"true"):c}function z(a){return Element.stringAttribute(a,"value",a.value)}function A(a,b){return a._properties[b]}function B(a,b,c){a._properties[b]=c,U(a)}function C(c,d){if(!window.CustomElements||window.CustomElements.useNative)D(c,d);else{var e,f=!1;c.parentNode&&c.parentNode.parentNode&&(e=c.parentNode.parentNode),e&&b(e).hasClass("layout-element-content")&&(f=!0),f?D(c,d):a.defer(function(){D(c,d)})}}function D(b,c){void 0!==c&&(""===c&&(c=null),null===c||void 0===c||a.isDate(c)||(c=f.toDate(c,void 0,c)),c=K(b,c),b._properties.value=c,b._properties.oldValue=c,b.control&&b.control.setValue(b.value))}function E(a,b,c,d){null===a.value&&null===d||L(a,a.value,d)}function F(a){M(a)}function G(a){N(a)}function H(a,b,c){var d=a._properties.value;if(c){var e;if(c=c.trim(),/AM|PM/.test(c.substr(c.length-2))&&(c=c.split(/AM|PM/)[0]),e=new Date(c.trim()),
!isNaN(e.getTime()))return void(a.value.getTime()!==e.getTime()&&(a.value=e,a.control.markValid=!0,P(a,d,a.value)))}a._properties.value=null,R(a,d)}function I(a){J(a)}function J(a){a.dispatchEvent(new CustomEvent("clear",{detail:{oldValue:null,newValue:null}}))}function K(a,b){if(b)return a.pickTime?!a.useSeconds&&b.setSeconds&&b.setSeconds(0,0):b.setHours(0,0,0,0),b}function L(a,b,c){T(b,c)&&(a._properties.value=c)}function M(a){T(a._properties.oldValue,a._properties.value)&&(P(a,a._properties.oldValue,a._properties.value),a._properties.oldValue=a._properties.value)}function N(a){O(a)&&T(a._properties.oldValue,a._properties.value)&&(Q(a,a._properties.oldValue,a._properties.value),a._properties.oldValue=a._properties.value)}function O(a){return a.getAttribute("update-on-close")}function P(a,b,c){a.dispatchEvent(new CustomEvent("change",{detail:{oldValue:b,newValue:c}}))}function Q(a,b,c){a.dispatchEvent(new CustomEvent("updateValueOnClose",{detail:{oldValue:b,newValue:c}}))}
function R(a,b){a.dispatchEvent(new CustomEvent("invalid",{detail:{oldValue:b,newValue:null}}))}function S(a){return Math.floor(a/1e3)}function T(a,b){return!a||(!b||S(a.valueOf())!==S(b.valueOf()))}function U(a){a.control&&(a.control.initialize({pickDate:a.pickDate,pickTime:a.pickTime,useMinutes:a.useMinutes,useSeconds:a.useSeconds,minuteStep:a.minuteStep,format:a.format,disabled:a.disabled,required:a.required,defaultDate:a.value,useCurrent:a.useCurrent}),a.disabled?a.control.disable():a.control.enable())}function V(a,b){e.error(a.stack),b.errorNotificationHandler.addError({errorMessage:a.message,errorDetail:a.stack})}return document.registerElement("mi-date-time",{prototype:h}),h});
define('query/execution/query-prompt-view-model',['require','lodash','jquery','knockout','application/application-events','application/application-context','system/knockout/knockout-manager','spa/ko/knockout-view-model','system/error/error-message','system/globalization/translator','../services/query-service','../services/dto/parameter-container-dto','../adapters/parameter-design-adapter','../adapters/parameter-value-adapter','text!./views/query-prompt.html','assets/services/asset-context-dto','system/lang/converter','moment','system/lang/object','ui/elements/select/view-model','ui/elements/multi-value/view-model','ui/elements/asset-context/view-model','ui/elements/date-time/bootstrap-datetimepicker','ui/elements/date-time/element'],function(require){"use strict";var a=require("lodash"),b=require("jquery"),c=require("knockout"),d=require("application/application-events"),e=require("application/application-context"),f=require("system/knockout/knockout-manager"),g=require("spa/ko/knockout-view-model"),h=require("system/error/error-message"),i=require("system/globalization/translator"),j=require("../services/query-service"),k=require("../services/dto/parameter-container-dto"),l=require("../adapters/parameter-design-adapter"),m=require("../adapters/parameter-value-adapter"),n=require("text!./views/query-prompt.html"),o=require("assets/services/asset-context-dto"),p=require("system/lang/converter"),q=require("moment");require("system/lang/object"),require("ui/elements/select/view-model"),require("ui/elements/multi-value/view-model"),require("ui/elements/asset-context/view-model"),require("ui/elements/date-time/bootstrap-datetimepicker"),require("ui/elements/date-time/element");function r(a,b){s.call(this,n),
this.kom=a,this.applicationEvents=b,this.translator=Object.resolve(i),this.queryService=Object.resolve(j),this.queryContainer=null,this.hasParamDependency=null,this.prompts=null,this.isLoading=!0,this.assetFinder=null,this.format=e.user.formats.dateTime,this.dateFormat=e.user.formats.shortDate}var s=Object.inherit(g,r);r.dependsOn=[f,d],r.prototype.open=function a(b){},r.prototype.load=function a(c){var d=new b.Deferred,e;return this.queryContainer=c.queryContainer,e=this.queryContainer.parmContainer,this.hasParamDependency=this.kom.observable(e.hasDependencies),this.prompts=this.kom.observableArray(t(this,e.parmDesigns)),d.promise()},r.prototype.activate=function a(){},r.prototype.attach=function a(b){s.prototype.attach.call(this,b),this.region=b,this.isLoading=!1},r.prototype.detach=function a(b){s.prototype.detach.call(this,b)},r.prototype.deactivate=function a(b){this.kom.disposeSubscriptions(),this.kom.disposeComputeds()},r.prototype.unload=function a(){
this.kom.disposeObservables()},r.prototype.validatePrompt=function a(b){return!b.value()||(b.isMultiValue?!b.options||!b.options.length||b.values().length>0:"Numeric"!==b.paramDesign.dataType()||b.isAssetHierarchy?"Date"!==b.paramDesign.dataType()||(G(this,b.value())?(this.clearPromptValidationMessage(b),!0):(b.validationMessage(this.translate("QUERY_INVALID_DATE")),!1)):F(this,b.value().replace(",",""))?(this.clearPromptValidationMessage(b),!0):(b.validationMessage(this.translate("QUERY_INVALID_NUMBER")),!1))},r.prototype.validate=function a(){var b=0;for(b=0;b<this.prompts().length;b++){var c=this.prompts()[b];if(!this.validatePrompt(c))return!1}return!0},r.prototype.clearPromptValidationMessage=function a(b){b.validationMessage(null)},r.prototype.getParameterValues=function b(){var c;return c=a.map(this.prompts(),H.bind(null,this)),new k({hasDependencies:this.hasParamDependency(),parmDesigns:l.toDTOArray(c)})},r.prototype.multiSelectValueChanged=function a(){
this.hasParamDependency()&&D(this,null)},r.prototype.translate=function(a){return this.translator.translate(a)};function t(b,c){var d,e;return d=l.toModelObjectArray(c),b.kom.disposeSubscriptions(),e=a.map(d,u.bind(null,b))}function u(b,c,d){var e,f=a.map(c.list(),B.bind(null,b,c)),g=f;return f&&f.length>0||(f=c.parameterValues(),g=m.toDTOArray(c.parameterValues())),"Boolean"===c.dataType()&&(f=[{displayValue:"All",value:"A"},{displayValue:"True",value:"Y"},{displayValue:"False",value:"N"}],g=f),e={caption:c.localizedCaption()||c.caption()||c.id()||b.translate("QUERY_EXEC_PROMPT_ENTER_VAL"),options:f,cboOptions:g||[],values:b.kom.observableArray(w(b,c,f)),value:b.kom.observable(v(b,c,f)),isExclusive:c.isExclusive()||"Boolean"===c.dataType(),isMultiValue:c.isMultiValue(),paramDesign:c,isAssetHierarchy:c.isAssetHierarchy(),child:c.child(),parent:c.parent(),valueTemplate:A(c),all:c.all(),current:c.current(),validationMessage:b.kom.observable(),isGis:c.isGis(),isHidden:c.isHidden(),
format:c.format(),alias:c.alias(),distance:c.distance(),entyKey:c.entyKey(),justTheDate:c.justTheDate()},b.hasParamDependency()&&(e.isExclusive||e.options.length||e.value.extend({rateLimit:{timeout:1200,method:"notifyWhenChangesStop"}}),e.isMultiValue||d+1<b.queryContainer.parmContainer.parmDesigns.length&&b.kom.subscribe(e.value,D.bind(null,b,d))),e}function v(b,d,f){var g,h=d.parameterPrompts();if(h&&h.length)return z(b,d,h[0]);if(null!==d.defaultValue()){if("Date"===d.dataType()){var i=a.find(b.queryContainer.parmContainer.parmDesigns,function(a,b){return a.caption===d.caption()});if(i&&i.parmValues.length)return C(b,d,d.defaultValue())}return z(b,d,d.defaultValue())}return f&&f.length?z(b,d,c.unwrap(f[0].value)):d.isAssetHierarchy()?(g=e.assetcontext||new o,g.entityKey&&"0"!==g.entityKey&&0!==g.entityKey||(g.entityKey="-1"),g):"Date"===d.dataType()?new Date:void 0}function w(a,b,c){var d=0,e=b.parameterPrompts(),f;if(b.isMultiValue()){if(e&&e.length){
for(d=0;d<e.length;d++)if(f=e[d],c&&c.length&&!x(c,f))return b.parameterPrompts.removeAll(),b.parameterPrompts();return b.parameterPrompts()}return b.defaultValues()}}function x(b,c){return a.find(b,y.bind(null,c))}function y(a,b){return c.utils.unwrapObservable(b.value)===a}function z(a,b,c){return"Date"===b.dataType()?p.toDate(c,"yyyy-MM-ddTHH:mm:ss.fff"):c}function A(a){switch(a.dataType()){case"Date":return a.justTheDate()?"prompt-date-template":"prompt-datetime-template";case"Numeric":return"prompt-number-template";default:return"prompt-text-template"}}function B(a,b,c){return{value:z(a,b,c),displayValue:C(a,b,c)}}function C(a,b,c){var d,e=c;return"Date"===b.dataType()&&(d=z(a,b,c),e=p.toDateString(d,a.format)),e}function D(b,c){var d=b.queryContainer,e;b.isLoading||(e=a.map(b.prompts(),H.bind(null,b)),d.parmContainer.parmDesigns=l.toDTOArray(e),b.queryService.compileContainerParameters(d).done(E.bind(null,b,c)).fail(J.bind(null,b)))}function E(a,b,c){var d,e;a.isLoading=!0,
e=t(a,c.parmContainer.parmDesigns),null!==b&&(d=e[b],!d.value()||d.isExclusive||x(d.cboOptions,d.value())||d.cboOptions.push({displayValue:d.value(),value:d.value()})),a.prompts(e),a.isLoading=!1}function F(a,c){return!!b.isNumeric(c)}function G(a,b){return q(p.toDate(b,a.format,b)).isValid()}function H(a,b){var c;return b.isMultiValue?b.options&&b.options.length?b.paramDesign.parameterPrompts(b.values()):b.paramDesign.parameterPrompts(I(b.value())):b.value()instanceof o?(b.paramDesign.parameterPrompts([b.value().entityKey]),b.paramDesign.assetHierarchyCaption=b.value().description):b.value()instanceof Date?b.paramDesign.parameterPrompts([p.toDateString(b.value(),"yyyy-MM-ddTHH:mm:ss.fff")]):"Date"===b.paramDesign.dataType()&&b.value()?(c=p.toDate(b.value(),"yyyy-MM-ddTHH:mm:ss.fff",b.value()),b.paramDesign.parameterPrompts([p.toDateString(c,"yyyy-MM-ddTHH:mm:ss.fff")])):b.value()?b.paramDesign.parameterPrompts([b.value().toString()]):b.paramDesign.parameterPrompts([null]),
b.paramDesign}function I(a){var b;if(!a)return[];b=a.split(",");for(var c=0;c<b.length;c++)b[c].trim();return b}function J(a,b){var c=2,d=h.fromHttpResponse(c,b);a.applicationEvents.errorOccured.raise(a,d)}return r});

define('text!query/execution/views/query-prompt-dialog.html',[],function () { return '<div class="query-prompt-dialog block-group">\r\n    <div class="query-prompt-container">\r\n        &nbsp;\r\n    </div>\r\n    <div class="controls">\r\n        <button type="button"\r\n                class="btn  btn-text  btn-secondary"\r\n                data-bind="click: cancel,\r\n                           text: translate(\'CANCEL\')"></button>\r\n        <button type="button"\r\n                class="btn btn-text"\r\n                data-bind="click: done,\r\n                           enable: isDoneButtonEnabled,\r\n                           text: translate(\'DONE\').capitalize()"></button>        \r\n    </div>\r\n</div>';});

define('query/execution/query-prompt-dialog',['require','jquery','spa/ko/knockout-view-model','application/application-events','system/error/error-message','system/knockout/knockout-manager','spa/region','system/ui/dialog-view-model','./query-prompt-view-model','system/globalization/translator','text!./views/query-prompt-dialog.html','system/lang/string','system/lang/object'],function(require){"use strict";var a=require("jquery"),b=require("spa/ko/knockout-view-model"),c=require("application/application-events"),d=require("system/error/error-message"),e=require("system/knockout/knockout-manager"),f=require("spa/region"),g=require("system/ui/dialog-view-model"),h=require("./query-prompt-view-model"),i=require("system/globalization/translator"),j=require("text!./views/query-prompt-dialog.html");require("system/lang/string"),require("system/lang/object");function k(a,b,c,d){l.call(this,j),this.kom=a,this.applicationEvents=b,this.queryPromptRegion=c,this.queryPromptViewModel=d,this.translator=Object.resolve(i),this.dialog=null,this.dfd=null,this.isDoneButtonEnabled=null,this.queryContainer=null}var l=Object.inherit(b,k);k.dependsOn=[e,c,f,h],k.prototype.show=function b(c){var d={height:"70%",width:"30%"};return c=c||{},c.title=c.title||this.translate("QUERY_EXEC_PROMPT_DLG_TITLE"),this.queryContainer=c.queryContainer,this.dialog=new g(this,c.title,d),
this.dialog.show(),this.dfd=a.Deferred(),this.dfd.promise()},k.prototype.close=function a(){this.dialog=null},k.prototype.open=function a(){},k.prototype.load=function b(c){var d=new a.Deferred;return c=c||{},c.queryContainer=this.queryContainer,this.queryPromptViewModel.load(c),d.promise()},k.prototype.activate=function a(){this.queryPromptViewModel.activate(),this.isDoneButtonEnabled=this.kom.computed(m.bind(null,this))},k.prototype.attach=function a(b){l.prototype.attach.call(this,b),this.region=b,this.queryPromptRegion.setElement(this.region.$element.find("div.query-prompt-container")),this.queryPromptViewModel.attach(this.queryPromptRegion)},k.prototype.detach=function a(b){this.queryPromptViewModel.detach(this.queryPromptRegion),this.queryPromptRegion.clear(),l.prototype.detach.call(this,b)},k.prototype.canUnload=function a(){return this.queryPromptViewModel.canUnload()},k.prototype.deactivate=function a(){this.queryPromptViewModel.deactivate(this.queryPromptRegion),
this.kom.disposeSubscriptions(),this.kom.disposeComputeds()},k.prototype.unload=function a(){this.queryPromptViewModel.unload(),this.kom.disposeObservables()},k.prototype.translate=function(a){return this.translator.translate(a)},k.prototype.done=function a(){var b;this.queryPromptViewModel.validate()&&(b=this.queryPromptViewModel.getParameterValues(),this.dfd.resolve(b),this.dialog.closeDialog())},k.prototype.cancel=function a(){this.dfd.reject(),this.dialog.closeDialog()};function m(a){return a.queryPromptViewModel.validate()}function n(a,b){b&&a.dfd.resolve(b),a.dialog.closeDialog()}function o(a,b){var c=2,e=d.fromHttpResponse(c,b);a.applicationEvents.errorOccured.raise(a,e)}return k});
define('system/lang/unique-id',['require','uuid'],function(require){"use strict";var a=require("uuid");function b(){return a.v1()}function c(){return a.v4()}return{createV1:b,createV4:c}});
define('query/model/column-model',['require','knockout'],function(require){"use strict";var a=require("knockout");function b(b){b=b||{},this.id=a.observable(b.id),this.caption=a.observable(b.caption),this.defaultCaption=a.observable(b.defaultCaption),this.dataType=a.observable(b.dataType),this.isInactive=a.observable(b.isInactive),this.captionDisplay=a.computed(c.bind(null,this)),this.idUndecorated=a.computed(d.bind(null,this))}function c(a){var b=a.caption();if(b)return 0===b.indexOf("[")?b.substring(1,b.length-1):b}function d(a){var b=a.id();if(b)return 0===b.indexOf("[")?b.substring(1,b.length-1):b}return b});
define('query/adapters/column-adapter',['require','../services/dto/column-dto','../model/column-model'],function(require){"use strict";var a=require("../services/dto/column-dto"),b=require("../model/column-model");function c(){}return c.toModelObject=function a(c){return new b(c)},c.toModelObjectArray=function a(b){var c=0,d=[];if(b&&b.length){for(c=0;c!==b.length;c++)d.push(this.toModelObject(b[c]));return d}},c.toDTO=function c(d){var e=new a;return d=d||new b,e.id=d.id(),e.caption=d.caption(),e.defaultCaption=d.defaultCaption(),e.dataType=d.dataType(),e.isInactive=d.isInactive(),e},c.toDTOArray=function a(b){var c=0,d=[];if(b&&b.length){for(c=0;c!==b.length;c++)d.push(this.toDTO(b[c]));return d}},c});
define('query/model/table-design-model',['require','knockout','../adapters/column-adapter'],function(require){"use strict";var a=require("knockout"),b=require("../adapters/column-adapter");function c(c){var h=[];c=c||{},c.showAllFields||c.showAllFields===!1||(c.showAllFields=!0),c.showDataFields||c.showDataFields===!1||(c.showDataFields=!1),c.showInactiveFields||c.showInactiveFields===!1||(c.showInactiveFields=!1),c.showSystemFields||c.showSystemFields===!1||(c.showSystemFields=!1),this.alias=a.observable(c.alias),this.caption=a.observable(c.caption),this.defaultCaption=a.observable(c.defaultCaption),this.datasheetId=a.observable(c.datasheetId),this.id=a.observable(c.id),this.key=a.observable(c.key),this.layoutX=a.observable(c.layoutX),this.layoutY=a.observable(c.layoutY),this.name=a.observable(c.name),h=b.toModelObjectArray(c.queryColumns),this.queryColumns=a.observableArray(h&&h.length?h:[]),this.showAllFields=a.observable(c.showAllFields),this.showDataFields=a.observable(c.showDataFields),this.showInactiveFields=a.observable(c.showInactiveFields),
this.showSystemFields=a.observable(c.showSystemFields),this.storedQueryPath=a.observable(c.storedQueryPath),this.tableType=a.observable(c.tableType),this.captionDisplay=a.computed(d.bind(null,this)),this.idUndecorated=a.computed(e.bind(null,this)),this.aliasDisplay=a.computed({read:f.bind(null,this),write:g.bind(null,this)})}function d(a){var b=a.caption();if(b)return 0===b.indexOf("[")||0===b.indexOf("{")?b.substring(1,b.length-1):b}function e(a){var b=a.id();if(b)return 0===b.indexOf("[")||0===b.indexOf("{")?b.substring(1,b.length-1):b}function f(a){return a.alias()||a.captionDisplay()}function g(a,b){b=b.replace(/ /g,"_").replace(/\(/g,"").replace(/\)/g,"").replace(/-/g,"_"),a.alias(b)}return c});
define('query/adapters/table-design-adapter',['require','../services/dto/table-design-dto','../model/table-design-model','./column-adapter'],function(require){"use strict";var a=require("../services/dto/table-design-dto"),b=require("../model/table-design-model"),c=require("./column-adapter");function d(){}return d.toModelObject=function a(c){return new b(c)},d.toModelObjectArray=function a(b){var c=0,d=[];if(b&&b.length){for(c=0;c!==b.length;c++)d.push(this.toModelObject(b[c]));return d}},d.toDTO=function d(e){var f=new a;return e=e||new b,f.alias=e.alias()||null,f.caption=e.caption()||null,f.defaultCaption=e.defaultCaption()||null,f.datasheetId=e.datasheetId(),f.id=e.id(),f.key=e.key(),f.layoutX=e.layoutX(),f.layoutY=e.layoutY(),f.name=e.name(),f.queryColumns=c.toDTOArray(e.queryColumns()),f.showAllFields=e.showAllFields(),f.showDataFields=e.showDataFields(),f.showInactiveFields=e.showInactiveFields(),f.showSystemFields=e.showSystemFields(),f.storedQueryPath=e.storedQueryPath(),f.tableType=e.tableType(),f},d.toDTOArray=function a(b){var c=0,d=[];if(b&&b.length){for(c=0;c!==b.length;c++)d.push(this.toDTO(b[c]))
;return d}},d});
define('query/services/dto/expression-dto',['require','system/lang/converter'],function(require){"use strict";var a=require("system/lang/converter");function b(b){b=b||{},this.conditionOperator=a.toString(b.conditionOperator),this.operator=a.toString(b.operator),this.value=b.dateValue?a.toDate(b.dateValue):a.toString(b.value),this.dateValue=a.toDate(b.dateValue)}return b.fromDataCollection=function a(c){if(c){var d,e=[];for(d=0;d<c.length;d++)e[e.length]=new b(c[d]);return e}},b});

define('text!query/expression-simple-operators.json',[],function () { return '{\r\n    "Character": [\r\n        { "text": "EXPR_SIMPLE_OPERATOR_EQUALS", "value": "Equal", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_NOT_EQUALS", "value": "NotEqual", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_CONTAINS", "value": "Contains", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_NOT_CONTAINS", "value": "DoesNotContain", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_STARTS_WITH", "value": "StartsWith", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_ENDS_WITH", "value": "EndsWith", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_IS_NULL", "value": "IsNull", "valueNeeded": false },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_IS_NOT_NULL", "value": "IsNotNull", "valueNeeded": false }\r\n    ],\r\n\r\n    "Character-dh": [\r\n        { "text": "EXPR_SIMPLE_OPERATOR_EQUALS", "value": "Equal", "valueNeeded": true }\r\n    ],\r\n\r\n    "Numeric": [\r\n        { "text": "EXPR_SIMPLE_OPERATOR_EQUALS", "value": "Equal", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_IS_ATMOST", "value": "EqualOrLessThan", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_IS_ATLEAST", "value": "EqualOrGreaterThan", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_NOT_EQUALS", "value": "NotEqual", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_IS_LESS_THAN", "value": "LessThan", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_IS_GREATER_THAN", "value": "GreaterThan", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_IS_NULL", "value": "IsNull", "valueNeeded": false },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_IS_NOT_NULL", "value": "IsNotNull", "valueNeeded": false }\r\n    ],\r\n\r\n    "Numeric-dh": [\r\n        { "text": "EXPR_SIMPLE_OPERATOR_EQUALS", "value": "Equal", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_IS_ATMOST", "value": "EqualOrLessThan", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_IS_ATLEAST", "value": "EqualOrGreaterThan", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_IS_LESS_THAN", "value": "LessThan", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_IS_GREATER_THAN", "value": "GreaterThan", "valueNeeded": true }\r\n    ],\r\n\r\n    "Date": [\r\n        { "text": "EXPR_SIMPLE_OPERATOR_ON", "value": "DayOf", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_IS_AT", "value": "Equal", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_IS_AT_OR_BEFORE", "value": "EqualOrLessThan", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_IS_AT_OR_AFTER", "value": "EqualOrGreaterThan", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_IS_NOT_AT", "value": "NotEqual", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_BEFORE", "value": "LessThan", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_AFTER", "value": "GreaterThan", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_IS_NULL", "value": "IsNull", "valueNeeded": false },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_IS_NOT_NULL", "value": "IsNotNull", "valueNeeded": false }\r\n    ],\r\n\r\n    "Date-dh": [\r\n        { "text": "EXPR_SIMPLE_OPERATOR_IS_AT", "value": "Equal", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_IS_AT_OR_BEFORE", "value": "EqualOrLessThan", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_IS_AT_OR_AFTER", "value": "EqualOrGreaterThan", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_BEFORE", "value": "LessThan", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_AFTER", "value": "GreaterThan", "valueNeeded": true }\r\n    ],\r\n\r\n    "Boolean": [\r\n        { "text": "EXPR_SIMPLE_OPERATOR_IS_TRUE", "value": "True", "valueNeeded": false },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_IS_FALSE", "value": "False", "valueNeeded": false },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_IS_NULL", "value": "IsNull", "valueNeeded": false },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_IS_NOT_NULL", "value": "IsNotNull", "valueNeeded": false }\r\n    ],\r\n\r\n    "Boolean-dh": [\r\n        { "text": "EXPR_SIMPLE_OPERATOR_IS_TRUE", "value": "True", "valueNeeded": false },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_IS_FALSE", "value": "False", "valueNeeded": false }\r\n    ],\r\n\r\n    "Text": [\r\n        { "text": "EXPR_SIMPLE_OPERATOR_EQUALS", "value": "Equal", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_NOT_EQUALS", "value": "NotEqual", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_CONTAINS", "value": "Contains", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_NOT_CONTAINS", "value": "DoesNotContain", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_STARTS_WITH", "value": "StartsWith", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_ENDS_WITH", "value": "EndsWith", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_IS_NULL", "value": "IsNull", "valueNeeded": false },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_IS_NOT_NULL", "value": "IsNotNull", "valueNeeded": false }\r\n    ],\r\n\r\n    "Text-dh": [\r\n        { "text": "EXPR_SIMPLE_OPERATOR_EQUALS", "value": "Equal", "valueNeeded": true }\r\n    ],\r\n\r\n    "Unknown": [\r\n        { "text": "EXPR_SIMPLE_OPERATOR_EQUALS", "value": "Equal", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_NOT_EQUALS", "value": "NotEqual", "valueNeeded": true },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_IS_NULL", "value": "IsNull", "valueNeeded": false },\r\n        { "text": "EXPR_SIMPLE_OPERATOR_IS_NOT_NULL", "value": "IsNotNull", "valueNeeded": false }\r\n    ],\r\n\r\n    "Unknown-dh": [\r\n        { "text": "EXPR_SIMPLE_OPERATOR_EQUALS", "value": "Equal", "valueNeeded": true }\r\n    ]\r\n}\r\n';});

define('query/model/expression-simple-operator-model',['require','system/globalization/translator'],function(require){"use strict";var a=require("system/globalization/translator");function b(b){b=b||{};var c=Object.resolve(a);this.text=c.translate(b.text),this.value=b.value,this.valueNeeded=b.valueNeeded!==!1,this.dataType=b.dataType}return b});
define('query/model/expression-simple-operator-list',['require','ramda','text!../expression-simple-operators.json','./expression-simple-operator-model'],function(require){"use strict";var a=require("ramda"),b=require("text!../expression-simple-operators.json"),c=require("./expression-simple-operator-model");function d(a){a&&a.length?this.items=a.map(e):this.items=[]}function e(a){return new c(a)}d.loadOperatorsForDataType=function a(c){return c=c||"Unknown",f(c,JSON.parse(b)[c])};function f(b,c){var e=g(b);return new d(a.map(e,c))}var g=a.curry(function a(b,c){return c.dataType=b,c});return d});
define('query/adapters/expression-simple-operator-adapter',['require','ramda','../model/expression-simple-operator-list'],function(require){"use strict";var a=require("ramda"),b=require("../model/expression-simple-operator-list");function c(){}var d=a.propEq("value");return c.toModelObject=function c(e,f){var g=b.loadOperatorsForDataType(f);return a.find(d(e),g.items)},c.toModelObjectArray=function a(b,d){return b.map(function(a,b){return c.toModelObject(a,b)})},c});
define('query/model/expression-model',['require','knockout','../adapters/expression-simple-operator-adapter','system/lang/converter'],function(require){"use strict";var a=require("knockout"),b=require("../adapters/expression-simple-operator-adapter"),c=require("system/lang/converter");function d(b,d){b=b||{},this.conditionOperator=a.observable(b.conditionOperator),this.value=a.observable(b.value),this.dataType=a.observable(d),"Date"===d&&this.value(c.toDate(b.dateValue)),this.operator=a.observable(e(b,d)),this.valueNeeded=a.computed(f.bind(null,this)),this.operator.subscribe(g.bind(null,this)),this.template=a.computed(h.bind(null,this))}function e(a,c){return a.operator?b.toModelObject(a.operator,c):null}function f(a){return!a.operator()||a.operator().valueNeeded}function g(a,b){a.valueNeeded()?"Date"!==b.dataType||a.value()||a.value(new Date):a.value(null)}function h(a){switch(a.dataType()){case"Date":return a.operator()&&"DayOf"===a.operator().value?"exp-bld-simple-date-template":"exp-bld-simple-datetime-template";case"Boolean":return"exp-bld-simple-boolean-template";default:
return"exp-bld-simple-text-template"}}return d.prototype.toString=function a(){return this.operator()?(this.conditionOperator()?this.conditionOperator()+" ":"")+this.operator().value+(this.value()?" '"+this.value()+"'":""):""},d});
define('query/adapters/expression-adapter',['require','../services/dto/expression-dto','../model/expression-model','system/lang/converter'],function(require){"use strict";var a=require("../services/dto/expression-dto"),b=require("../model/expression-model"),c=require("system/lang/converter");function d(){}return d.toModelObject=function a(c,d){return new b(c,d)},d.toModelObjectArray=function a(b,c){var e=0,f=[];if(b&&b.length){for(e=0;e!==b.length;e++)f.push(d.toModelObject(b[e],c));return f}},d.toDTO=function b(d){var e=new a;return d=d||{},e.conditionOperator=d.conditionOperator()||"",e.operator=d.operator()?d.operator().value||"":"",e.value=d.value(),d.value()&&d.value()instanceof Date&&(e.dateValue=c.toDateString(d.value(),"yyyy-MM-ddTHH:mm:ss.fff")),e},d.toDTOArray=function a(b){var c=0,e=[];if(b&&b.length){for(c=0;c!==b.length;c++)e.push(d.toDTO(b[c]));return e}},d});
define('query/model/query-criteria-model',['require','knockout','../adapters/expression-adapter'],function(require){"use strict";var a=require("knockout"),b=require("../adapters/expression-adapter");function c(c,d){c=c||{},this.expressions=a.observableArray(b.toModelObjectArray(c.expressions,d))}return c.prototype.toString=function a(){var b=0,c="",d="";for(b=0;b<this.expressions().length;b++)d=this.expressions()[b].toString(),c+=d.length>0?d+" ":"";return c},c});
define('query/adapters/query-criteria-adapter',['require','../services/dto/query-criteria-dto','../model/query-criteria-model','./expression-adapter'],function(require){"use strict";var a=require("../services/dto/query-criteria-dto"),b=require("../model/query-criteria-model"),c=require("./expression-adapter");function d(){}return d.toModelObject=function a(c,d){return c?new b(c,d):null},d.toModelObjectArray=function a(b,c){var e=0,f=[];if(!b||!b.length)return f;for(e=0;e!==b.length;e++)f.push(d.toModelObject(b[e],c));return f},d.toDTO=function b(d){if(!d)return null;var e=new a;return d=d||{},e.expressions=c.toDTOArray(d.expressions()),e},d.toDTOArray=function a(b){var c=0,d=[];if(!b||!b.length)return d;for(c=0;c!==b.length;c++)d.push(this.toDTO(b[c]));return d},d});
define('query/model/column-design-model',['require','knockout','../adapters/column-adapter','../adapters/query-criteria-adapter'],function(require){"use strict";var a=require("knockout"),b=require("../adapters/column-adapter"),c=require("../adapters/query-criteria-adapter");function d(d){d=d||{},this.alias=a.observable(d.alias),this.caption=a.observable(d.caption),this.defaultCaption=a.observable(d.defaultCaption),this.criterias=a.observableArray(d.criterias),this.crosstab=a.observable(d.crosstab),this.dataType=a.observable(d.dataType),this.display=a.observable(d.display),this.expressionText=a.observable(d.expressionText),this.hyperlink=a.observable(d.hyperlink),this.id=a.observable(d.id),this.include=a.observable(d.include),this.key=a.observable(d.key),this.layoutWidth=a.observable(d.layoutWidth),this.resultFilterExpression=a.observable(d.resultFilterExpression),this.sortIndex=a.observable(d.sortIndex),this.sortOrder=a.observable(d.sortOrder),this.tableDesignKey=a.observable(d.tableDesignKey),this.total=a.observable(d.total),this.appendTo=a.observable(b.toModelObject(d.appendTo)),
this.updateTo=a.observable(d.updateTo),this.simpleCriteria=a.observableArray([]),this.simpleCriteria(c.toModelObjectArray(d.simpleCriteria,this.dataType())),this.captionDisplay=a.computed(e.bind(null,this)),this.idUndecorated=a.computed(f.bind(null,this)),this.isSelected=a.observable(!1),this.include.subscribe(g.bind(null,this)),this.display.subscribe(h.bind(null,this)),this.expressionText.subscribe(i.bind(null,this))}function e(a){var b=a.caption();if(b)return 0===b.indexOf("[")?b.substring(1,b.length-1):b}function f(a){var b=a.id();if(b)return 0===b.indexOf("[")?b.substring(1,b.length-1):b}function g(a){a&&a.include&&null!==a.include()&&void 0!==a.include()&&(a.include()||a.display(!1))}function h(a){a&&a.display&&null!==a.display()&&void 0!==a.display()&&a.display()&&a.include(!0)}function i(a){a&&a.expressionText&&a.expressionText()&&a.tableDesignKey("")}return d});
define('query/adapters/column-design-adapter',['require','../services/dto/column-design-dto','../model/column-design-model','../adapters/column-adapter','./query-criteria-adapter'],function(require){"use strict";var a=require("../services/dto/column-design-dto"),b=require("../model/column-design-model"),c=require("../adapters/column-adapter"),d=require("./query-criteria-adapter");function e(){}return e.toModelObject=function a(c){return new b(c)},e.toModelObjectArray=function a(b){var c=0,d=[];if(!b||!b.length)return d;for(c=0;c!==b.length;c++)d.push(this.toModelObject(b[c]));return d},e.toDTO=function b(e){var f=new a;return e=e||{},f.alias=e.alias()||null,f.caption=e.caption()||null,f.defaultCaption=e.defaultCaption()||null,f.criterias=e.criterias(),f.crosstab=e.crosstab(),f.dataType=e.dataType(),f.display=e.display(),f.expressionText=e.expressionText(),f.hyperlink=e.hyperlink(),f.id=e.id()||null,f.include=e.include(),f.key=e.key(),f.layoutWidth=e.layoutWidth(),f.resultFilterExpression=e.resultFilterExpression(),f.sortIndex=e.sortIndex(),f.sortOrder=e.sortOrder(),f.tableDesignKey=e.tableDesignKey(),f.total=e.total(),f.appendTo=c.toDTO(e.appendTo()),
f.updateTo=e.updateTo(),f.simpleCriteria=d.toDTOArray(e.simpleCriteria()),f},e.toDTOArray=function a(b){var c=0,d=[];if(b&&b.length){for(c=0;c!==b.length;c++)d.push(this.toDTO(b[c]));return d}},e});
define('query/model/operand-model',['require','knockout'],function(require){"use strict";var a=require("knockout");function b(b){b=b||{},this.tableDesignKey=a.observable(b.tableDesignKey),this.columnId=a.observable(b.columnId),this.charOperand=a.observable(b.charOperand)}return b});
define('query/adapters/operand-adapter',['require','../services/dto/operand-dto','../model/operand-model'],function(require){"use strict";var a=require("../services/dto/operand-dto"),b=require("../model/operand-model");function c(){}return c.toModelObject=function a(c){return new b(c)},c.toModelObjectArray=function a(b){var c=0,d=[];if(b&&b.length){for(c=0;c!==b.length;c++)d.push(this.toModelObject(b[c]));return d}},c.toDTO=function b(c){var d=new a;return c=c||{},d.tableDesignKey=c.tableDesignKey(),d.columnId=c.columnId(),d.charOperand=c.charOperand(),d},c.toDTOArray=function a(b){var c=0,d=[];if(b&&b.length){for(c=0;c!==b.length;c++)d.push(this.toDTO(b[c]));return d}},c});
define('query/model/condition-model',['require','knockout','../adapters/operand-adapter'],function(require){"use strict";var a=require("knockout"),b=require("../adapters/operand-adapter");function c(c){c=c||{},this.leftOperand=a.observable(b.toModelObject(c.leftOperand)),this.operator=a.observable(c.operator),this.rightOperand=a.observable(b.toModelObject(c.rightOperand)),this.nextOperator=a.observable(c.nextOperator)}return c});
define('query/adapters/condition-adapter',['require','../services/dto/condition-dto','../model/condition-model','../adapters/operand-adapter'],function(require){"use strict";var a=require("../services/dto/condition-dto"),b=require("../model/condition-model"),c=require("../adapters/operand-adapter");function d(){}return d.toModelObject=function a(c){return new b(c)},d.toModelObjectArray=function a(b){var c=0,d=[];if(b&&b.length){for(c=0;c!==b.length;c++)d.push(this.toModelObject(b[c]));return d}},d.toDTO=function b(d){var e=new a;return d=d||{},e.leftOperand=c.toDTO(d.leftOperand()),e.operator=d.operator(),e.rightOperand=c.toDTO(d.rightOperand()),e.nextOperator=d.nextOperator(),e},d.toDTOArray=function a(b){var c=0,d=[];if(b&&b.length){for(c=0;c!==b.length;c++)d.push(this.toDTO(b[c]));return d}},d});
define('query/model/join-design-model',['require','knockout','system/globalization/translator','../adapters/condition-adapter'],function(require){"use strict";var a=require("knockout"),b=require("system/globalization/translator"),c=require("../adapters/condition-adapter");function d(d){d=d||{},this.translator=Object.resolve(b),this.conditions=a.observableArray(c.toModelObjectArray(d.conditions)),this.isMiJoin=a.observable(d.isMiJoin),this.joinSucc=a.observable(d.joinSucc),this.joinType=a.observable(d.joinType),this.key=a.observable(d.key),this.leftDesignKey=a.observable(d.leftDesignKey),this.relDesignKey=a.observable(d.relDesignKey),this.rightDesignKey=a.observable(d.rightDesignKey),this.joinDesignKey=a.observable(d.joinDesignKey),this.jointLinkIds=[],this.leftDesignName=a.observable(this.leftDesignKey()),this.rightDesignName=a.observable(this.rightDesignKey()),this.relDesignName=a.observable(this.relDesignKey()),this.predDesignKey=a.computed(e.bind(null,this)),this.succDesignKey=a.computed(f.bind(null,this)),this.predDesignName=a.computed(g.bind(null,this)),
this.succDesignName=a.computed(h.bind(null,this)),this.innerDescription=a.computed(k.bind(null,this)),this.leftDescription=a.computed(l.bind(null,this)),this.rightDescription=a.computed(m.bind(null,this)),this.predColumnId=a.computed(i.bind(null,this)),this.succColumnId=a.computed(j.bind(null,this))}function e(a){return a.joinSucc()?a.leftDesignKey():a.rightDesignKey()}function f(a){return a.joinSucc()?a.rightDesignKey():a.leftDesignKey()}function g(a){return a.joinSucc()?a.leftDesignName():a.rightDesignName()}function h(a){return a.joinSucc()?a.rightDesignName():a.leftDesignName()}function i(a){if(a.conditions&&a.conditions()[0]&&a.conditions()[0].leftOperand&&a.conditions()[0].leftOperand()&&a.conditions()[0].leftOperand().columnId)return a.joinSucc()?a.conditions()[0].leftOperand().columnId():a.conditions()[0].rightOperand().columnId()}function j(a){
if(a.conditions&&a.conditions()[0]&&a.conditions()[0].rightOperand&&a.conditions()[0].rightOperand()&&a.conditions()[0].rightOperand().columnId)return a.joinSucc()?a.conditions()[0].rightOperand().columnId():a.conditions()[0].leftOperand().columnId()}function k(a){return a.isMiJoin()?n(a,"QUERY_EDITOR_INNER_MI_JOIN_DESC_PREFIX")+" '"+a.relDesignName()+"'":n(a,"QUERY_EDITOR_INNER_JOIN_DESC")}function l(a){return a.isMiJoin()?n(a,"QUERY_EDITOR_JOIN_INC_PRED_DESC_PREFIX")+" '"+a.leftDesignName()+"' "+n(a,"QUERY_EDITOR_JOIN_INC_SUCC_DESC_PREFIX")+" '"+a.rightDesignName()+"' "+n(a,"QUERY_EDITOR_JOIN_INC_MI_REL_DESC_PREFIX")+" '"+a.relDesignName()+"'":n(a,"QUERY_EDITOR_JOIN_INC_PRED_DESC_PREFIX")+" '"+a.leftDesignName()+"' "+n(a,"QUERY_EDITOR_JOIN_INC_SUCC_DESC_PREFIX")+" '"+a.rightDesignName()+"' "+n(a,"QUERY_EDITOR_JOIN_INC_REL_DESC")}function m(a){
return a.isMiJoin()?n(a,"QUERY_EDITOR_JOIN_INC_PRED_DESC_PREFIX")+" '"+a.rightDesignName()+"' "+n(a,"QUERY_EDITOR_JOIN_INC_SUCC_DESC_PREFIX")+" '"+a.leftDesignName()+"' "+n(a,"QUERY_EDITOR_JOIN_INC_MI_REL_DESC_PREFIX")+" '"+a.relDesignName()+"'":n(a,"QUERY_EDITOR_JOIN_INC_PRED_DESC_PREFIX")+" '"+a.rightDesignName()+"' "+n(a,"QUERY_EDITOR_JOIN_INC_SUCC_DESC_PREFIX")+" '"+a.leftDesignName()+"' "+n(a,"QUERY_EDITOR_JOIN_INC_REL_DESC")}function n(a,b){return a.translator.translate(b)}return d});
define('query/adapters/join-design-adapter',['require','../services/dto/join-design-dto','../model/join-design-model','../adapters/condition-adapter'],function(require){"use strict";var a=require("../services/dto/join-design-dto"),b=require("../model/join-design-model"),c=require("../adapters/condition-adapter");function d(){}return d.toModelObject=function a(c){return new b(c)},d.toModelObjectArray=function a(b){var c=0,d=[];if(b&&b.length){for(c=0;c!==b.length;c++)d.push(this.toModelObject(b[c]));return d}},d.toDTO=function b(d){var e=new a;return d=d||{},e.conditions=c.toDTOArray(d.conditions()),e.isMiJoin=d.isMiJoin(),e.joinSucc=d.joinSucc(),e.joinType=d.joinType(),e.key=d.key(),e.leftDesignKey=d.leftDesignKey(),e.relDesignKey=d.relDesignKey(),e.rightDesignKey=d.rightDesignKey(),e.joinDesignKey=d.joinDesignKey(),e},d.toDTOArray=function a(b){var c=0,d=[];if(b&&b.length){for(c=0;c!==b.length;c++)d.push(this.toDTO(b[c]));return d}},d});
define('query/model/parameter-container-model',['require','knockout','../adapters/parameter-design-adapter'],function(require){"use strict";var a=require("knockout"),b=require("../adapters/parameter-design-adapter");function c(c){c=c||{},this.hasDependencies=a.observable(c.hasDependencies),this.parameterDesigns=a.observableArray(b.toModelObjectArray(c.parmDesigns))}return c});
define('query/adapters/parameter-container-adapter',['require','../services/dto/parameter-container-dto','../model/parameter-container-model','../adapters/parameter-design-adapter'],function(require){"use strict";var a=require("../services/dto/parameter-container-dto"),b=require("../model/parameter-container-model"),c=require("../adapters/parameter-design-adapter");function d(){}return d.toModelObject=function a(c){return new b(c)},d.toModelObjectArray=function a(b){var c=0,d=[];if(b&&b.length){for(c=0;c!==b.length;c++)d.push(this.toModelObject(b[c]));return d}},d.toDTO=function b(d){var e;return d?(e=new a,e.hasDependencies=d.hasDependencies(),e.parmDesigns=c.toDTOArray(d.parameterDesigns()),e):null},d.toDTOArray=function a(b){var c=0,d=[];if(b&&b.length){for(c=0;c!==b.length;c++)d.push(this.toDTO(b[c]));return d}},d});
define('query/model/query-container-model',['require','lodash','knockout','system/lang/unique-id','../adapters/table-design-adapter','../adapters/column-design-adapter','catalog/services/catalog-constants','../adapters/join-design-adapter','../adapters/parameter-container-adapter','system/lang/object'],function(require){"use strict";var a=require("lodash"),b=require("knockout"),c=require("system/lang/unique-id"),d=require("../adapters/table-design-adapter"),e=require("../adapters/column-design-adapter"),f=require("catalog/services/catalog-constants"),g=require("../adapters/join-design-adapter"),h=require("../adapters/parameter-container-adapter");require("system/lang/object"),b.extenders.numeric=function(a,c){var d=b.computed({read:a,write:function(b){var d=a(),e=Math.pow(10,c),f=isNaN(b)?0:parseFloat(+b),g=Math.round(f*e)/e;g!==d?a(g):b!==d&&a.notifySubscribers(g)}}).extend({notify:"always"});return d(a()),d};function i(a){a=a||{},this.catalogConstants=Object.resolve(f),a.tableDesigns=j(a.tableDesigns,a.joinDesigns),this.columnDesigns=b.observableArray(e.toModelObjectArray(a.columnDesigns)),this.isCaseInsensitive=b.observable(a.isCaseInsensitive),this.isChanged=b.observable(a.isChanged),this.isDeleteForce=b.observable(a.isDeleteForce),
this.isDistinct=b.observable(a.isDistinct),this.isFormatted=b.observable(a.isFormatted),this.isTop=b.observable(a.isTop),this.isUomVisible=b.observable(a.isUomVisible),this.joinDesigns=b.observableArray(g.toModelObjectArray(a.joinDesigns)),this.pageSize=b.observable(a.pageSize),this.parameterContainer=b.observable(h.toModelObject(a.parmContainer)),this.queryText=b.observable(a.queryText),this.queryType=b.observable(a.queryType),this.showTotals=b.observable(a.showTotals),this.sqlChanged=b.observable(a.sqlChanged),this.designChanged=b.observable(a.designChanged),this.startPage=b.observable(a.startPage),this.catalogPath=b.observable(a.catalogPath),this.tableDesigns=b.observableArray(d.toModelObjectArray(a.tableDesigns)),this.topRows=b.observable(a.topRows).extend({numeric:0}),this.uniqueId=b.observable(a.uniqueId||c.createV1()),this.asyncQueryRowLimit=b.observable(a.asyncQueryRowLimit),this.appendSource=b.observable(d.toModelObject(a.appendSource)),
this.predecessorSource=b.observable(d.toModelObject(a.predecessorSource)),this.successorSource=b.observable(d.toModelObject(a.successorSource)),this.designStatus=b.observable(a.designStatus),this.loadStatus=b.observable(a.loadStatus),this.queryTypeInt=b.computed(l.bind(null,this)),this.isDesignable=b.computed(m.bind(null,this)),this.maxCriteria=b.computed(k.bind(null,this)),this.tableDesigns.subscribe(n.bind(null,this),null,"arrayChange"),this.columnDesigns.subscribe(t.bind(null,this),null,"arrayChange"),this.joinDesigns.subscribe(w.bind(null,this),null,"arrayChange"),this.showTotals.subscribe(y.bind(null,this)),this.showTotals.subscribe(x.bind(null,this)),this.isDistinct.subscribe(x.bind(null,this)),this.appendSource.subscribe(z.bind(null,this)),A(this)}function j(b,c){var d=0,e,f,g=[],h=[],i=[];if(b){if(!c||!c.length)return b;for(d=0;d<c.length;d++)e=c[d],g.push(e.leftDesignKey),e.isMiJoin&&g.push(e.relDesignKey),g.push(e.rightDesignKey)
;for(d=0;d<g.length;d++)f=a.find(b,C.bind(null,g[d])),h.push(f);return a.union(h,b)}}function k(a){var b=0,c=0,d=0;for(b=0;b!==a.columnDesigns().length;b++)(c=a.columnDesigns()[b].criterias().length)>d&&(d=c);return d}function l(a){switch(a.queryType()){case"Select":return a.catalogConstants.QUERY_TYPE_SELECT;case"Update":return a.catalogConstants.QUERY_TYPE_UPDATE;case"Delete":return a.catalogConstants.QUERY_TYPE_DELETE;case"Append":return a.catalogConstants.QUERY_TYPE_APPEND;case"Transform":return a.catalogConstants.QUERY_TYPE_TRANSFORM;case"Crosstab":return a.catalogConstants.QUERY_TYPE_TRANSFORM;case"Datahub":return a.catalogConstants.QUERY_TYPE_AGGREGATE;default:return a.catalogConstants.QUERY_TYPE_NONE}}function m(a){var b=a.designStatus();return!!(!b||"Loaded"===b)}function n(b,c){var d=a.filter(c,o.bind(null,b)),e=a.filter(c,p.bind(null,b)),f=0,g=[],h,i=q(b.tableDesigns()),j=!1;for(f=0;f<e.length;f++)h=e[f].value,(!h.key()||parseInt(h.key(),10)<=0)&&(h.key(i),i++),
g=a.filter(b.tableDesigns(),r.bind(null,b,h.aliasDisplay())),g.length>1&&h.aliasDisplay(h.captionDisplay()+" "+g.length),"Datahub"===h.tableType()&&(j=!0);for(j?b.queryType("Datahub"):"Datahub"===b.queryType()&&b.queryType("Select"),f=0;f<d.length;f++)b.columnDesigns.remove(s.bind(null,b,d[f].value.key()))}function o(a,b){return"deleted"===b.status}function p(a,b){return"added"===b.status}function q(a){var b=0,c=0,d=0;for(b=0;b<a.length;b++)d=parseInt(a[b].key(),10),c=c<d?d:c;return(c+1).toString()}function r(a,b,c){return b===c.captionDisplay()}function s(a,b,c){return!!c.tableDesignKey()&&c.tableDesignKey().toString()===b.toString()}function t(b,c){var d=a.filter(c,p.bind(null,b)),e,f=0,g=q(b.columnDesigns());for(f=0;f<d.length;f++)e=d[f].value,u(b,e),(!e.key()||parseInt(e.key(),10)<=0)&&(e.key(g),g++),e.sortOrder()&&""!==e.sortOrder()||e.sortOrder("None"),e.sortIndex()&&""!==e.sortIndex()||e.sortIndex("0")}function u(b,c){if(!c.alias())return void c.alias("")
;if(!(a.filter(b.columnDesigns(),function(a){return a.alias()||a.alias(""),a.alias().toLowerCase()===c.alias().toLowerCase()}).length<=1)){var d=0,e;for(e=v(b,c,d);e;)d++,e=v(b,c,d);c.alias(c.alias()+d.toString())}}function v(b,c,d){return a.find(b.columnDesigns(),function(a){return a.alias().toLowerCase()===c.alias().toLowerCase()+d.toString()})}function w(b,c){var d=a.filter(c,p.bind(null,b)),e,f=0,g=q(b.joinDesigns());for(f=0;f<d.length;f++)e=d[f].value,parseInt(e.key(),10)<=0&&(e.key(g),g++),B(b,e,b.tableDesigns()),e.leftDesignName(),e.relDesignName(),e.rightDesignName()}function x(a){a&&a.showTotals&&a.isDistinct&&(a.showTotals()||a.isDistinct())&&a.isFormatted(!1)}function y(a,b){var c=0,d;for(c=0;c<a.columnDesigns().length;c++)d=a.columnDesigns()[c],b?d.total(d.include()?"GroupBy":"Where"):d.total("")}function z(a){var b=0,c;for(b=0;b<a.columnDesigns().length;b++)c=a.columnDesigns()[b],c.appendTo(null)}function A(a){var b=0,c
;for(b=0;b<a.joinDesigns().length;b++)c=a.joinDesigns()[b],B(a,c)}function B(c,d){var e=c.tableDesigns();d.leftDesignName(b.unwrap(a.find(e,C.bind(null,d.leftDesignKey())).caption)),d.rightDesignName(b.unwrap(a.find(e,C.bind(null,d.rightDesignKey())).caption)),d.isMiJoin()&&d.relDesignName(b.unwrap(a.find(e,C.bind(null,d.relDesignKey())).caption))}function C(a,c){return b.unwrap(c.key).toString()===a.toString()}return i});
define('query/adapters/query-container-adapter',['require','../services/dto/query-container-dto','../model/query-container-model','./table-design-adapter','./column-design-adapter','./join-design-adapter','./parameter-container-adapter'],function(require){"use strict";var a=require("../services/dto/query-container-dto"),b=require("../model/query-container-model"),c=require("./table-design-adapter"),d=require("./column-design-adapter"),e=require("./join-design-adapter"),f=require("./parameter-container-adapter");function g(){}return g.toModelObject=function a(c){return new b(c)},g.toDTO=function b(g){var h=new a;return g=g||{},h.columnDesigns=d.toDTOArray(g.columnDesigns()),h.isCaseInsensitive=g.isCaseInsensitive(),h.isChanged=g.isChanged(),h.isDeleteForce=g.isDeleteForce(),h.isDistinct=g.isDistinct(),h.isFormatted=g.isFormatted(),h.isTop=g.isTop(),h.isUomVisible=g.isUomVisible(),h.joinDesigns=e.toDTOArray(g.joinDesigns()),h.pageSize=g.pageSize(),h.parmContainer=f.toDTO(g.parameterContainer()),h.queryText=g.queryText(),h.queryType=g.queryType(),h.showTotals=g.showTotals(),h.sqlChanged=g.sqlChanged(),h.designChanged=g.designChanged(),h.startPage=g.startPage(),h.catalogPath=g.catalogPath(),
h.tableDesigns=c.toDTOArray(g.tableDesigns()),h.topRows=g.topRows(),h.uniqueId=g.uniqueId(),h.asyncQueryRowLimit=g.asyncQueryRowLimit(),h.appendSource=c.toDTO(g.appendSource()),h.predecessorSource=c.toDTO(g.predecessorSource()),h.successorSource=c.toDTO(g.successorSource()),h.designStatus=g.designStatus(),h.loadStatus=g.loadStatus(),h},g.cloneDTO=function(b){var c=JSON.stringify(b);return new a(JSON.parse(c))},g});
define('query/model/query-state-model',['require','knockout','../adapters/query-container-adapter'],function(require){"use strict";var a=require("knockout"),b=require("../adapters/query-container-adapter");function c(c){c=c||{},this.version=c.version||2,this.queryContainer=a.observable(b.toModelObject(c.queryContainer)),this.selectedTableDesign=a.observable(),this.selectedJoinDesign=a.observable()}return c});
define('query/adapters/query-state-adapter',['require','../services/dto/query-state-dto','../model/query-state-model','./query-container-adapter'],function(require){"use strict";var a=require("../services/dto/query-state-dto"),b=require("../model/query-state-model"),c=require("./query-container-adapter");function d(){}return d.toModelObject=function a(c){if(c&&c.version)return new b(c)},d.toModelObjectArray=function a(b){var c=0,d=[];if(b&&b.length){for(c=0;c!==b.length;c++)d.push(this.toModelObject(b[c]));return d}},d.toDTO=function b(d){var e=new a;return d=d||{},e.version=d.version,e.queryContainer=c.toDTO(d.queryContainer()),e},d.toDTOArray=function a(b){var c=0,d=[];if(b&&b.length){for(c=0;c!==b.length;c++)d.push(this.toDTO(b[c]));return d}},d});
define('query/execution/query-execution-engine',['require','jquery','ramda','application/application-events','system/error/error-message','system/globalization/translator','../services/query-service','catalog/services/catalog-service','catalog/services/dto/catalog-item-dto','catalog/services/catalog-constants','../services/dto/query-state-dto','../services/dto/query-container-dto','./query-prompt-dialog','../adapters/query-state-adapter','../adapters/query-result-adapter'],function(require){"use strict";var a=require("jquery"),b=require("ramda"),c=require("application/application-events"),d=require("system/error/error-message"),e=require("system/globalization/translator"),f=require("../services/query-service"),g=require("catalog/services/catalog-service"),h=require("catalog/services/dto/catalog-item-dto"),i=require("catalog/services/catalog-constants"),j=require("../services/dto/query-state-dto"),k=require("../services/dto/query-container-dto"),l=require("./query-prompt-dialog"),m=require("../adapters/query-state-adapter"),n=require("../adapters/query-result-adapter");function o(a){this._appEvents=Object.resolve(c),this._translator=Object.resolve(e),this._catConstants=Object.resolve(i),this._promptDialog=Object.resolve(l),this.queryService=Object.resolve(f),this.catalogService=Object.resolve(g),this.executionMode=null,this._dfd=null,a&&(p(this,a),this._opt=a)}o.prototype.execute=function b(c){var d,e=c||{};switch(this._dfd=a.Deferred(),
this.executionMode){case"SqlStatement":d=e.evalOnly?y.bind(null,this,e,this._opt.sqlStatement):s.bind(null,this,e,this._opt.sqlStatement);break;case"CatalogItemKey":d=e.evalOnly?M.bind(null,this,e,this._opt.catalogItemKey):G.bind(null,this,e,this._opt.catalogItemKey);break;case"CatalogItem":d=e.evalOnly?D.bind(null,this,e,this._opt.catalogItem):A.bind(null,this,e,this._opt.catalogItem);break;case"QueryContainer":d=e.evalOnly?R.bind(null,this,e,this._opt.queryContainer):O.bind(null,this,e,this._opt.queryContainer);break;default:throw this._translator.translate("QUERY_EXEC_UNKNOWN_MODE")}return d(),this._dfd.promise()},o.prototype.prompt=function b(c){var d;switch(this._dfd=a.Deferred(),c=c||{},this.executionMode){case"SqlStatement":d=t.bind(null,this,c,this._opt.sqlStatement);break;case"CatalogItemKey":d=H.bind(null,this,c,this._opt.catalogItemKey);break;case"CatalogItem":d=B.bind(null,this,c,this._opt.catalogItem);break;case"QueryContainer":
d=P.bind(null,this,c,this._opt.queryContainer);break;default:throw this._translator.translate("QUERY_EXEC_UNKNOWN_MODE")}return d(),this._dfd.promise()},o.prototype.compile=function b(c){var d;switch(this._dfd=a.Deferred(),this.executionMode){case"SqlStatement":d=u.bind(null,this,{},this._opt.sqlStatement);break;case"CatalogItemKey":d=I.bind(null,this,{},this._opt.catalogItemKey);break;case"CatalogItem":d=C.bind(null,this,{},this._opt.catalogItem);break;case"QueryContainer":d=Q.bind(null,this,{},this._opt.queryContainer);break;default:throw this._translator.translate("QUERY_EXEC_UNKNOWN_MODE")}return d(),this._dfd.promise()};function p(a,b){return b.catalogItemKey?void(a.executionMode="CatalogItemKey"):b.catalogItem?(q(a,b.catalogItem),void(a.executionMode="CatalogItem")):b.queryContainer?(r(a,b.queryContainer),void(a.executionMode="QueryContainer")):b.sqlStatement?void(a.executionMode="SqlStatement"):void 0}function q(a,b){
if(!(b instanceof h))throw a._translator.translate("QUERY_EXEC_INVALID_CAT_ITEM");if(b.itemType!==a._catConstants.ITEM_TYPE_QUERY)throw a._translator.translate("QUERY_EXEC_INVALID_CAT_ITEM");if(!b.query)throw a._translator.translate("QUERY_EXEC_INVALID_CAT_ITEM");if(!b.query.source)throw a._translator.translate("QUERY_EXEC_INVALID_CAT_ITEM")}function r(a,b){if(!(b instanceof k))throw a._translator.translate("QUERY_EXEC_INVALID_QUERY_CONT")}function s(a,b,c){a.queryService.compileString(c).done(v.bind(null,a,b)).fail(ea.bind(null,a))}function t(a,b,c){a.queryService.compileString(c).done(w.bind(null,a,b)).fail(ea.bind(null,a))}function u(a,b,c){a.queryService.compileString(c).done(x.bind(null,a,b)).fail(ea.bind(null,a))}function v(a,b,c){O(a,b,c)}function w(a,b,c){P(a,b,c)}function x(a,b,c){a._dfd.resolve(c)}function y(a,b,c){a.queryService.compileString(c).done(z.bind(null,a,b)).fail(ea.bind(null,a))}function z(a,b,c){R(a,b,c)}function A(a,b,c){var d=c.query.layout,e=new j(d)
;d&&d.queryContainer?O(a,b,e.queryContainer):s(a,b,c.query.source)}function B(a,b,c){var d=c.query.layout,e=new j(d);d&&d.queryContainer?P(a,b,e.queryContainer):t(a,b,c.query.source)}function C(a,b,c){var d=c.query.layout,e=new j(d);d&&d.queryContainer?Q(a,b,e.queryContainer):u(a,b,c.query.source)}function D(a,b,c){var d=c.query.layout,e=new j(d);d&&d.queryContainer?R(a,b,e.queryContainer):y(a,b,c.query.source)}function E(a,b,c){s(a,b,"(! '"+c+"')")}function F(a,b,c){y(a,b,"(! '"+c+"')")}function G(a,b,c){a.catalogService.getCatalogItem(c).done(J.bind(null,a,b)).fail(ea.bind(null,a))}function H(a,b,c){a.catalogService.getCatalogItem(c).done(K.bind(null,a,b)).fail(ea.bind(null,a))}function I(a,b,c){a.catalogService.getCatalogItem(c).done(L.bind(null,a,b)).fail(ea.bind(null,a))}function J(a,b,c){A(a,b,c)}function K(a,b,c){B(a,b,c)}function L(a,b,c){C(a,b,c)}function M(a,b,c){a.catalogService.getCatalogItem(c).done(N.bind(null,a,b)).fail(ea.bind(null,a))}function N(a,b,c){D(a,b,c)}
function O(a,b,c){b.suppressPrompts?Y(a,b,c):S(a,b,c).done(W.bind(null,a,b,c)).fail(a._dfd.reject)}function P(a,b,c){b.parameters&&c.parmContainer&&c.parmContainer.copyPromptValues(b.parameters),S(a,b,c).done(X.bind(null,a,b,c)).fail(a._dfd.reject)}function Q(a,b,c){a._dfd.resolve(c)}function R(a,b,c){b.suppressPrompts?$(a,b,c):S(a,b,c).done(Z.bind(null,a,b,c)).fail(a._dfd.reject)}function S(b,c,d){var e=a.Deferred();return T(d)?b.queryService.compileContainerParameters(d).then(V.bind(null,b),ea.bind(null,b)):(e.resolve(d.parmContainer),e.promise())}function T(a){var c,d,e;return c=a.parmContainer,d=c?c.parmDesigns:null,(e=d?b.filter(U,d):null)&&e.length>0}function U(a){return!a.isHidden}function V(a,b){return a._promptDialog.show({queryContainer:b})}function W(a,b,c,d){c.parmContainer=d,Y(a,b,c)}function X(a,b,c,d){c.parmContainer=d,a._dfd.resolve(c)}function Y(a,b,c){b&&(c.pageSize=b.pageSize||c.pageSize,c.startPage=b.startPage||c.startPage,
c.parmContainer=b.parameters||c.parmContainer,b.queryContainer&&(c.columnDesigns=b.queryContainer.columnDesigns||c.columnDesigns)),"Select"===c.queryType||"Crosstab"===c.queryType?b.sync?a.queryService.executeQueryContainerSync(c).done(ca.bind(null,a,c)).fail(ea.bind(null,a)):a.queryService.executeQueryContainer(c).done(ba.bind(null,a,c)).fail(ea.bind(null,a)):a.queryService.evaluateQueryContainer(c).done(aa.bind(null,a,b,c)).fail(ea.bind(null,a))}function Z(a,b,c,d){c.parmContainer=d,$(a,b,c)}function $(a,b,c){b&&(c.parmContainer=b.parameters||c.parmContainer),a.queryService.evaluateQueryContainer(c).done(_.bind(null,a,c)).fail(ea.bind(null,a))}function _(a,b,c){a._dfd.resolve({queryContainer:b,rowCount:c})}function aa(a,b,c,d){b.sync?a.queryService.executeQueryContainerSync(c).done(da.bind(null,a,c,d)).fail(ea.bind(null,a)):a.queryService.executeQueryContainer(c).done(da.bind(null,a,c,d)).fail(ea.bind(null,a))}function ba(a,b,c){a._dfd.resolve({queryContainer:b,rowset:c})}
function ca(a,b,c){a._dfd.resolve({queryContainer:b,result:n.toModel(c)})}function da(a,b,c){a._dfd.resolve({queryContainer:b,rowCount:c})}function ea(a,b){var c=2,e=d.fromHttpResponse(c,b);a._appEvents.errorOccured.raise(a,e),a._dfd.reject()}return o});
define('system/lang/time-zone',['require','moment-timezone','system/lang/private'],function(require){"use strict";var a=require("moment-timezone"),b=require("system/lang/private"),c="Invalid time zone identifier",d="Expected a date to be passed";function e(a){f(a),b(this).timeZoneId=a}function f(b){if(!a.tz.zone(b))throw c}var g=e.prototype;g.getTimeZoneId=function(){return b(this).timeZoneId},g.applyUtcOffset=function(c){var d,e,f;return j(c),d=b(this).timeZoneId,e=h(c),f=-a.tz.zone(d).offset(e),i(f,c)};function h(a){return Date.UTC(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),a.getMinutes(),a.getSeconds(),a.getMilliseconds())}function i(a,b){var c=new Date(b.valueOf());return c.setMinutes(b.getMinutes()+a),c}g.removeUtcOffset=function(c){var d,e,f;return j(c),d=b(this).timeZoneId,e=h(c),f=a.tz.zone(d).parse(e),i(f,c)};function j(a){if(!(a instanceof Date))throw d}return e});
define('system/lang/time-zone-factory',['require','system/lang/time-zone','bluebird'],function(require){"use strict";var a=require("system/lang/time-zone"),b=require("bluebird");function c(a){return b.resolve().then(d.bind(null,a)).catch(function(a){throw a})}function d(b){return new a(b)}return{fromIanaTimeZoneId:c,fromIanaTimeZoneIdSync:d}});
define('ui/elements/date-time/timezone-handler',['require','system/lang/time-zone-factory','application/application-context','bluebird'],function(require){"use strict";var a=require("system/lang/time-zone-factory"),b=require("application/application-context"),c=require("bluebird");function d(){this.timezone=null}d.singleton=!0;var e=d.prototype;e.getTimezone=function(){var d=this,e;return d.timezone?c.resolve(f(d,d.timezone)).catch(h):(e=a.fromIanaTimeZoneId(b.user.ianaTimezoneId),c.resolve(e).catch(h).then(f.bind(null,d)).catch(h))},e.getUserTzDate=function(d){var e=this,i;return e.timezone?c.resolve(g(e,d)).catch(h):(i=a.fromIanaTimeZoneId(b.user.ianaTimezoneId),c.resolve(i).catch(h).then(f.bind(null,e)).then(g.bind(null,e,d)).catch(h))};function f(a,b){return a.timezone=b,b}function g(a,b){return a.timezone.applyUtcOffset(b)}function h(a){throw a}return d});
define('application/export-service',['require','lodash','jquery','system/http/ajax-client','application/application-context','system/lang/object'],function(require){"use strict";var a=require("lodash"),b=require("jquery"),c="api/core/uiexport",d=require("system/http/ajax-client"),e=require("application/application-context");require("system/lang/object");function f(){var a=this;a.ajaxClient=Object.resolve(d),a.baseURL=a.ajaxClient.url(c),a.sessionID=e.session.id}return f.prototype.exportPage=function c(d,e,f){var g=this;e=e?e:"pdf",f+="."+e;var h=b("#shell-screen > .content-wrapper > .content"),i=b(h).width();b(h).width("1200px"),b(document).trigger("resize"),a.delay(function(){var a=b(h)[0].outerHTML;b(h).width(i),b(document).trigger("resize"),g.exportCall(a,d,e,f)},100)},f.prototype.exportCall=function d(e,f,g,h){var i=b("link"),j={htmlString:e,cssLinks:a.map(i,function(a){return a.outerHTML}),hiddenHtmlSelector:["button"],avoidPageBreaks:[".avoid-page-break"],addPageBreakBefore:[".add-page-break-before"],addPageBreakAfter:[".add-page-break-after"],orientation:"landscape"}
;j.orientation=f.orientation?f.orientation:j.orientation,j.htmlString=f.htmlString?f.htmlString:j.htmlString,f.cssLinks&&b.each(f.cssLinks,function(a,b){j.cssLinks.push(b)}),f.hiddenHtmlSelector&&b.each(f.hiddenHtmlSelector,function(a,b){j.hiddenHtmlSelector.push(b)}),f.avoidPageBreaks&&b.each(f.avoidPageBreaks,function(a,b){j.avoidPageBreaks.push(b)}),f.addPageBreakBefore&&b.each(f.addPageBreakBefore,function(a,b){j.addPageBreakBefore.push(b)}),f.addPageBreakAfter&&b.each(f.addPageBreakAfter,function(a,b){j.addPageBreakAfter.push(b)});var k=b('<form method="POST" action="'+c+'">');b.each(j,function(a,b){var c=document.createElement("input");c.setAttribute("name",a),c.setAttribute("value",b),k.append(c)});var l=document.createElement("input");l.setAttribute("name","type"),l.setAttribute("value",g),k.append(l);var m=document.createElement("input");m.setAttribute("name","fileName"),m.setAttribute("value",h),k.append(m),b("body").append(k),k.submit()},f});
define('ui/elements/resultgrid/config/default-config',['require','lodash','jquery'],function(require){"use strict";var a=require("lodash"),b=require("jquery");function c(a){return{allowColumnReordering:a.allowColumnReordering(),allowColumnResizing:a.allowColumnResizing(),columnAutoWidth:a.columnAutoWidth(),selection:{mode:a.selectionMode(),selectAllMode:"page"},scrolling:{mode:a.scrollType()},sorting:d(a),loadPanel:f(a),noDataText:a.noDataCaptioin,editing:e(a),wordWrapEnabled:a.wordWrapEnabled(),onContextMenuPreparing:function(a){"header"===a.target&&(a.items=[])}}}function d(a){return{mode:a.sortingMode(),ascendingText:a.translator.translate("RG_SORT_ASCENDING_CAPTION"),descendingText:a.translator.translate("RG_SORT_DESCENDING_CAPTION"),clearText:a.translator.translate("RG_CLEAR_SORTING_CAPTION")}}function e(a){return{mode:a.editMode(),allowUpdating:a.allowRowEditing(),allowAdding:a.allowRowAdding(),allowDeleting:a.allowRowDeleting(),texts:{addRow:a.translator.translate("RG_ADD_ROW_HELP_TEXT"),
cancelAllChanges:a.translator.translate("RG_CANCEL_CHANGES_HELP_TEXT"),deleteRow:a.translator.translate("RG_DELETE"),saveAllChanges:a.translator.translate("RG_SAVE_CHANGES_HELP_TEXT"),undeleteRow:a.translator.translate("RG_UNDELETE")}}}function f(a){return{enabled:a.loaderPanelEnabled(),showPane:!1,text:""}}return c});
define('system/text/clean-href',[],function(){"use strict";var a=/^([^:]+):|^#|^(.\/)|^(..\/)|^!/gm,b=/^(%20|\s)*(data|javascript)/im,c=/[^\x20-\x7E]/gim;return function(d){var e,f,g,h;if(d){if(e=d.replace(c,""),!(f=e.match(a)))return"";if(g=f[0],h=b.test(g))return"";d=e}return d}});
define('ui/elements/resultgrid/helpers/utils',['require','lodash','jquery','xss','system/text/clean-href','system/lang/converter','system/text/parser','system/text/formatter','application/application-context','system/ui/message-box','query/services/dto/query-container-dto','query/execution/query-execution-engine'],function(require){"use strict";var a=require("lodash"),b=require("jquery"),c=require("xss"),d=require("system/text/clean-href"),e=require("system/lang/converter"),f=require("system/text/parser"),g=require("system/text/formatter"),h=Object.resolve(g),i=require("application/application-context"),j=require("system/ui/message-box"),k=require("query/services/dto/query-container-dto"),l=require("query/execution/query-execution-engine");function m(){}m.prototype.handleRowPrepared=function a(b,c,d){"data"===c.rowType&&Object.tryMethod(b,"rowPreparedCallback",c,c)},m.prototype.handleCellTemplateForActionColumn=function a(c,d,e){try{var f=b(e.value),g=f.data()||{};f=n(f),g.hyperlinkText=f.text(),g.hyperlinkUrl=f.attr("href"),f.addClass("dx-link").on("click",function(a){a.preventDefault()}).on("dxclick",function(){Object.tryMethod(c,"cellHyperlinkCallback",g)}).appendTo(d)}catch(a){throw c.translator.translate("RG_INVALID_HYPERLINK_FORMAT_MSG")}};function n(a){return a.text(c(a.text())),
a.attr("href",d(a.attr("href"))),a}m.prototype.handleCustomCellTemplate=function a(b,c,d){Object.tryMethod(b,"cellTemplateCallback",c,d)},m.prototype.handleHeaderCellTemplate=function a(b,c,d){Object.tryMethod(b,"headerCellTemplateCallback",c,d)},m.prototype.formatNumberValue=function a(b){var c=b.value;if(!c||isNaN(parseInt(c)))return 0===c?c.toString():c;var d=c.toString().split(".")[1],f=d?d.length:0;return h.format(e.toFloat(c),"n"+f)},m.prototype.formatDateValue=function a(b){var c=i.user.formats.shortDate;return h.format(b,c)},m.prototype.configurePrint=function a(c,d){c.showPrint()?b(c.element).find(".rg-print").show():b(c.element).find(".rg-print").hide(),0===d?b(c.element).find(".rg-print").attr("disabled",!0):b(c.element).find(".rg-print").removeAttr("disabled")};function o(a){for(var b=[],c=a.aggregateQueryParams.parmDesigns.length,d=0;d<c;d++)b.push(a.aggregateQueryParams.parmDesigns[d].id)
;for(var e=a.queryParams.parmDesigns.length,f=0;f<e;f++)if(b.indexOf(a.queryParams.parmDesigns[f].id)>-1)for(var g=0;g<c;g++)a.aggregateQueryParams.parmDesigns[g].id===a.queryParams.parmDesigns[f].id&&(a.aggregateQueryParams.parmDesigns[g]=a.queryParams.parmDesigns[f]);else a.aggregateQueryParams.parmDesigns.push(a.queryParams.parmDesigns[f])}m.prototype.getMenuPaging=function a(c,d){var e={};c.aggregateQueryParams?(c.queryParams&&o(c),e.parameters=c.aggregateQueryParams,e.suppressPrompts=!0):c.queryParams&&(e.parameters=c.queryParams,e.suppressPrompts=!0),c.suppressPrompts(!0),e.suppressPrompts=!0,e.evalOnly=!0,c.cachedQueryContainer?(p(c,c._queryTotalCount),b(c.element).find(".rg-pager").show(),c.getTotalCount=!1,c._queryTotalCount=0):"static"===c.data()&&"standard"===c.scrollType()?(p(c,d||c._totalCount()),b(c.element).find(".rg-pager").show(),c.getTotalCount=!1):c.loadJSONData&&(p(c,d),c.showPaging?b(c.element).find(".rg-pager").show():b(c.element).find(".rg-pager").hide(),
c.getTotalCount=!1)};function p(a,b){var c="",d=[];if(0!==b){for(var e=b/a.pageSize(),f=0;f<e;f++)c=f*a.pageSize()+1+" - "+(f+1)*a.pageSize(),d.push({displayName:c,val:f});var g=d[d.length-1],h=g.displayName;h=h.substr(0,h.indexOf("-")+2),g.displayName=h+b,a.selectedValue(""),a.listObjects(d),a.customTotalCount(b)}else a.selectedValue(""),a.listObjects([{displayName:"0",val:0}]),a.customTotalCount(0)}m.prototype.changePage=function a(b,c){if(!b.getTotalCount){var d=b.selectedValue();b.pageNumber=d,b.gridInstance.pageIndex(b.pageNumber)}};function q(a,c){a._totalCount()<a.pageSize()?(b(a.element).find(".pageControls .firstPage").attr("disabled","disabled"),b(a.element).find(".pageControls .prevPage").attr("disabled","disabled"),b(a.element).find(".pageControls .nextPage").attr("disabled","disabled"),b(a.element).find(".pageControls .lastPage").attr("disabled","disabled")):(b(a.element).find(".pageControls .firstPage").removeAttr("disabled"),
b(a.element).find(".pageControls .prevPage").removeAttr("disabled"),b(a.element).find(".pageControls .nextPage").removeAttr("disabled"),b(a.element).find(".pageControls .lastPage").removeAttr("disabled")),a.gridInstance.pageIndex()?a.gridInstance.pageIndex()===Math.floor(a._totalCount()/a.pageSize())&&(b(a.element).find(".pageControls .nextPage").attr("disabled","disabled"),b(a.element).find(".pageControls .lastPage").attr("disabled","disabled")):(b(a.element).find(".pageControls .firstPage").attr("disabled","disabled"),b(a.element).find(".pageControls .prevPage").attr("disabled","disabled")),"standard"!==a.scrollType()||a._totalCount()<a.pageSize()?b(a.element).find(".pageControls ").hide():b(a.element).find(".pageControls ").show()}function r(a,b){if(!a.gridInstance)return void console.error("grid instance not available");switch(b){case"first":a.gridInstance.pageIndex(0);break;case"prev":a.gridInstance.pageIndex(a.gridInstance.pageIndex()-1);break;case"next":
a.gridInstance.pageIndex(a.gridInstance.pageIndex()+1);break;case"last":a.gridInstance.pageIndex(Math.ceil(a._totalCount()/a.pageSize()))}}function s(a,b){j.showOk("Error in executing Query","Error")}function t(a){if(b(a.element).find(".dx-datagrid-pager.dx-pager").length){var c=b(a.element).find(".gridContainer").height()-b(a.element).find(".dx-datagrid-headers").height();b(a.element).find(".dx-datagrid-rowsview").height(c)}}return m});
define('ui/elements/resultgrid/helpers/json-helper',['require','lodash','jquery','./utils','system/lang/converter','system/text/parser','system/text/formatter'],function(require){"use strict";var a=require("lodash"),b=require("jquery"),c=require("./utils"),d=require("system/lang/converter"),e=require("system/text/parser"),f=require("system/text/formatter"),g=Object.resolve(f);function h(){}var i=Object.inherit(c,h);h.prototype.preSelectRows=function a(c,d){try{var e=b(c.element).find(".gridContainer").dxDataGrid("instance");e&&e.selectRows(d)}catch(a){}},h.prototype.handleCellPrepared=function a(b,c){"data"===c.rowType&&Object.tryMethod(b,"cellPreparedCallback",c.cellElement,c)},h.prototype.handleInitNewRow=function a(b,c,d){Object.tryMethod(b,"onInitNewRowCallback",c,d)},h.prototype.handleContentReadyActionForJSON=function c(d){var e=b(d.element).find(".gridContainer").dxDataGrid("instance");b(d.element).find(".rg-controls").show(),b(d.element).find(".rg-header").show();var f=e.totalCount()>0?e.totalCount():0,g=b(".dx-datagrid-filter-row .dx-editor-cell").index(b(".dx-editor-cell.dx-focused"));d.filterElIndex=g!==-1?g:d.filterElIndex,
a.delay(function(){b(b(".dx-datagrid-filter-row .dx-editor-cell")[d.filterElIndex]).find("input").focus()},100),d.gridInstance=e,Object.tryMethod(d,"gridLoadedCallback",e),d.customTotalCount()!==f&&(d.getTotalCount=!0),"standard"===d.scrollType()?d.getTotalCount&&this.getMenuPaging(d,f):b(d.element).find(".dxDataGridTotalCount").show().text(d._totalCount()+" "+d.translator.translate("RG_TOTAL_COUNT_MESSAGE")),b(d.element).find(".dx-datagrid-pager.dx-pager").hide(),d.showGridBorder&&b(d.element).find("#gridContainer").addClass("grid-border"),this.configurePrint(d,f)},h.prototype.handleSelectionChangedForJSON=function c(d,e){var f;"single"===d.selectionMode()?(f=e.selectedRowsData[0],Object.tryMethod(d,"callback",f)):(f=a.map(e.selectedRowsData,function(a){return a.FEdefine&&a.FEdefine===!0&&a._notReplaceable===!0?b.extend(!0,a,{illegal:!0}):a}),Object.tryMethod(d,"multiSelectCallback",f))},h.prototype.handleSelectionChangeForJsonWithoutColumns=function b(c,d){var e
;"single"===c.selectionMode()?(e=d.selectedRowsData[0],Object.tryMethod(c,"callback",e)):(e=a.map(d.selectedRowsData,function(a){if(!a.FEdefine||a.FEdefine!==!0)return a}),Object.tryMethod(c,"multiSelectCallback",e))},h.prototype.handleEditorPreparedForJson=function b(c,d){var f=this;if("filterRow"===d.parentType&&"number"===d.dataType)d.editorElement.empty().dxTextBox({value:f.formatNumberValue(d),valueChangeEvent:"keyup",onValueChanged:a.debounce(function(a){var b=a.value?e.parseFloat(a.value):a.value;d.setValue(b),j(f,d,b)},500)});else if("dataRow"===d.parentType&&"number"===d.dataType)var g=d.editorElement.dxTextBox({value:f.formatNumberValue(d),onValueChanged:function(a){d.setValue(e.parseFloat(a.value))}})};function j(a,b,c){var d=b.editorElement.dxTextBox("instance"),e=d.element().find("input"),f=a.formatNumberValue({value:c});e.val(f)}h.prototype.handleEditingStart=function a(b,c){Object.tryMethod(b,"onEditingStart",c)},h.prototype.getColumnsFromData=function c(e,f){
for(var g=[],h=0;h<f.columns.length;h++){var i=a.extend({},f.columns[h])||{};if(i.dataField=f.columns[h].dataField||f.columns[h].id,void 0!==f.columns[h].alias&&""!==f.columns[h].alias?i.caption=f.columns[h].alias:i.caption||(i.caption=f.columns[h].id),void 0!==f.columns[h].isActionColumn&&"true"===f.columns[h].isActionColumn){i.cellTemplate=this.handleCellTemplateForActionColumn.bind(null,e);var j=k(i.dataField,f.data);i.calculateSortValue=j,i.calculateFilterExpression=l.bind(null,j)}else void 0!==f.columns[h].hasCellTemplate&&"true"===f.columns[h].hasCellTemplate&&(i.cellTemplate=this.handleCustomCellTemplate.bind(null,e));void 0!==f.columns[h].hasHeaderCellTemplate&&"true"===f.columns[h].hasHeaderCellTemplate&&(i.headerCellTemplate=this.handleHeaderCellTemplate.bind(null,e)),void 0!==f.columns[h].dataType&&(i.dataType=f.columns[h].dataType,"number"===i.dataType&&(i.customizeText=this.formatNumberValue)),i.encodeHtml=!0,
void 0!==f.columns[h].encodeHtml&&(i.encodeHtml=d.toBoolean(f.columns[h].encodeHtml,!0)),m(f.columns[h],i,"precision"),m(f.columns[h],i,"format"),m(f.columns[h],i,"cssClass"),m(f.columns[h],i,"alignment"),m(f.columns[h],i,"width"),m(f.columns[h],i,"allowFiltering",d.toBoolean(f.columns[h].allowFiltering,"true")),m(f.columns[h],i,"allowEditing",d.toBoolean(f.columns[h].allowEditing,"true")),m(f.columns[h],i,"fixed",d.toBoolean(f.columns[h].fixed,"true")),m(f.columns[h],i,"visible",d.toBoolean(f.columns[h].visible,!0)),void 0!==f.columns[h].lookup&&f[f.columns[h].lookup.dataSource]&&(i.lookup=b.extend({},f.columns[h].lookup),i.lookup.dataSource=f[f.columns[h].lookup.dataSource]),g.push(i)}return g};function k(a,c){for(var d=a+"_linkText",e=0;e<c.length;e++)c[e][d]=b(c[e][a]).text();return d}function l(a,b,c){return[a,c||"=",b]}function m(a,b,c,d){void 0!==a[c]&&(b[c]=4===arguments.length?d:a[c])}return h});
define('ui/elements/resultgrid/config/json-config',['require','lodash','jquery','./default-config','../helpers/json-helper'],function(require){"use strict";var a=require("lodash"),b=require("jquery"),c=require("./default-config"),d=Object.resolve(require("../helpers/json-helper"));function e(a,e,g){var h={dataSource:e.data,columns:g,pager:{visible:!1},onCellPrepared:d.handleCellPrepared.bind(null,a),onInitNewRow:d.handleInitNewRow.bind(null,a),onRowPrepared:d.handleRowPrepared.bind(null,a),onContentReady:d.handleContentReadyActionForJSON.bind(d,a),onSelectionChanged:g?d.handleSelectionChangedForJSON.bind(null,a):d.handleSelectionChangeForJsonWithoutColumns.bind(null,a),onEditorPrepared:d.handleEditorPreparedForJson.bind(d,a),onEditingStart:d.handleEditingStart.bind(null,a)};return"standard"===a.scrollType()&&(h.paging=f(a)),e.config&&b.extend(h,e.config),b.extend(h,c(a)),h}function f(a){return{enabled:!0,pageSize:a.pageSize()}}return e});
define('ui/elements/resultgrid/helpers/static-helper',['require','lodash','jquery','./utils','system/lang/converter','system/text/parser','system/text/formatter'],function(require){"use strict";var a=require("lodash"),b=require("jquery"),c=require("./utils"),d=require("system/lang/converter"),e=require("system/text/parser"),f=require("system/text/formatter"),g=Object.resolve(f);function h(a){}var i=Object.inherit(c,h);h.prototype.handleStaticDataLoad=function a(c,d,e){var f=b.Deferred(),g;g=b(".dx-datagrid-filter-row .dx-editor-cell").index(b(".dx-editor-cell.dx-focused")),c.filterElIndex=g!==-1?g:c.filterElIndex,f.done(j.bind(null,c,d,e)),Object.tryMethod(c,"onPageChangeCB",f,d)};function j(a,c,d,e){a.rawQueryData=e,a.currentFilter!==c.filter&&(a.currentFilter=c.filter,a.getTotalCount=!0,a._totalCount(e.totalCount),b(a.element).find(".dxDataGridTotalCount").html(e.totalCount+" "+a.translator.translate("RG_TOTAL_COUNT_MESSAGE"))),d.resolve(e.data,{totalCount:e.totalCount}),b(b(".dx-datagrid-filter-row .dx-editor-cell")[a.filterElIndex]).find("input").focus()}h.prototype.handleGetTotalRecordsCount=function a(c,d){var e=b.Deferred()
;return Object.tryMethod(c,"totalCountCallback",e),e.done(function(a){c._totalCount(a)}),e.promise()},h.prototype.getStaticColumns=function a(b,c){for(var e=b.rawQueryData,f,g,h=0;h<c.length;h++)f=e.columns[h],g=c[h],g.dataField=f.id,void 0!==f.alias&&""!==f.alias?g.caption=f.alias:g.caption=f.id,void 0!==f.isActionColumn&&"true"===f.isActionColumn?g.cellTemplate=this.handleCellTemplateForActionColumn.bind(null,b):void 0!==f.hasCellTemplate&&"true"===f.hasCellTemplate&&(g.cellTemplate=this.handleCustomCellTemplate.bind(null,b)),void 0!==f.hasHeaderCellTemplate&&"true"===f.hasHeaderCellTemplate&&(g.headerCellTemplate=this.handleHeaderCellTemplate.bind(null,b)),g.encodeHtml=!0,void 0!==f.encodeHtml&&(g.encodeHtml=d.toBoolean(f.encodeHtml,!0)),k(f,g,"dataType"),"number"===g.dataType&&(g.customizeText=this.formatNumberValue),k(f,g,"format"),k(f,g,"precision"),k(f,g,"cssClass"),k(f,g,"alignment"),k(f,g,"width"),k(f,g,"allowFiltering",d.toBoolean(f.allowFiltering,"true")),
k(f,g,"visible",!("false"===f.visible||f.visible===!1)),k(f,g,"allowEditing",d.toBoolean(f.allowEditing,"true")),void 0!==f.lookup&&e[f.lookup.dataSource]&&(g.lookup=f.lookup,g.lookup.dataSource=e[f.lookup.dataSource]);return c};function k(a,b,c,d){void 0!==a[c]&&(b[c]=4===arguments.length?d:a[c])}return h});
define('ui/elements/resultgrid/adapters/dtos/column-info-dto',['require','lodash','jquery','knockout','system/lang/converter','system/text/parser','system/text/formatter'],function(require){"use strict";var a=require("lodash"),b=require("jquery"),c=require("knockout"),d=require("system/lang/converter"),e=require("system/text/parser"),f=require("system/text/formatter"),g=Object.resolve(f),h={"System.DateTime":"date","System.Double":"number","System.Boolean":"boolean"};function i(a,b){this.dataField=j(a),this.visible=a.getIsDisplayed(),b||(this.dataType=k(a)),this.hyperlinkFormat=a.getHyperlinkFormat(),this.displayUomCaption=a.getDisplayUomCaption(),this.format=a.getFormat(),this.id=a.getFieldId(),this.fieldId=a.getFieldId(),this.alias=a.getAlias(),this.typename=a.getTypeName(),this.columnDesignKey=a.getColumnDesignKey(),this.hasCellTemplate=!1,this.encodeHtml=!0,this.visible=!0,this.fixed=!1,this.width=null}function j(a){var b=a.getAlias()||a.getFieldId();return isNaN(b)||(b+="_"),b=b.replace(/\./g,"__")}function k(a){var b;return b=h[a.getTypeName()],"Boolean"===a.getFieldDataType()&&(b="boolean"),b}return i});
define('ui/elements/resultgrid/adapters/query-data-adapter',['require','lodash','jquery','knockout','system/text/clean-href','system/lang/converter','system/text/parser','system/text/formatter','application/application-context','./dtos/column-info-dto'],function(require){"use strict";var a=require("lodash"),b=require("jquery"),c=require("knockout"),d=require("system/text/clean-href"),e=require("system/lang/converter"),f=require("system/text/parser"),g=require("system/text/formatter"),h=Object.resolve(g),i=require("application/application-context"),j=require("./dtos/column-info-dto");function k(a){}var l=k.prototype;l.getColumnInfos=function(b,c){return a.map(b,function a(b){return new j(b,c)})},l.getRows=function b(c,d,e){return a.map(d,function a(b){for(var d={},f=b.getCells(),g=0;g<e.length;g++)d[e[g].dataField]=m(c,f,f[g],e[g]),f[g].getBackColor()&&(d[e[g].dataField+"_backColor"]=f[g].getBackColor());return d})};function m(a,b,c,d){var f=t(c),g=a.cachedQueryContainer.isFormatted;return d.hyperlinkFormat&&(f="date"===d.dataType?q(c.getDbValue(),d.format):f,f=r(f,c)),"date"===d.dataType&&""!==f&&(g?(a.formColumnArr.push(d.dataField),f=q(c.getDbValue(),d.format)):v(f)||(f=c.getDbValue())),
"boolean"===d.dataType?f=e.toBoolean(f.toString().toLowerCase(),"true"):"number"!==d.dataType||d.hyperlinkFormat||g?f&&"string"==typeof f&&(f=u(f)):f=n(c),f}function n(a){var b=o(a.getValue(),a.getDbValue()),c=a.getDbValue();return c&&b&&b.toString()===c.toString()?parseFloat(b):f.parseFloat(b)}function o(a,b){return p(b)&&!p(a)?b:a}function p(a){return null!==a&&void 0!==a&&""!==a}function q(a,b){if(a){var c=b?h.getFormatByCode(b):i.user.formats.dateTime;return h.format(a,c)}return a}function r(a,b){return s(b.getHyperlinkRoute(),a)}function s(a,c){var e="";return a?(e=b("<a/>").attr("href",d(a)).text(c),b("<div/>").append(e).html()):e}function t(a){return void 0!==a.getValue()&&""!==a.getValue()?a.getValue():void 0!==a.getDbValue()&&null!==a.getDbValue()?a.getDbValue():""}function u(a){return a.replace(/<([a-z]+)([^>]*[^\/])?>(?![\s\S]*<\/\1)/gi,function(a){return b("<div/>").text(a).html()})}function v(a){return a.toString().indexOf("<a")!==-1}function w(a,b){
return a.split("/").map(function(a){if(a.startsWith("{")){var c=a.substr(1,a.length-2);return b[c].getDbValue()}return a}).join("/")}return k});
define('ui/elements/resultgrid/helpers/query-helper',['require','lodash','jquery','ramda','bluebird','./static-helper','system/lang/converter','system/text/parser','system/text/formatter','application/application-context','query/services/dto/query-container-dto','query/services/dto/parameter-container-dto','query/execution/query-execution-engine','../adapters/query-data-adapter'],function(require){"use strict";var a=require("lodash"),b=require("jquery"),c=require("ramda"),d=require("bluebird"),e=require("./static-helper"),f=require("system/lang/converter"),g=require("system/text/parser"),h=require("system/text/formatter"),i=Object.resolve(h),j=require("application/application-context"),k=require("query/services/dto/query-container-dto"),l=require("query/services/dto/parameter-container-dto"),m=require("query/execution/query-execution-engine"),n=require("../adapters/query-data-adapter"),o={"System.DateTime":"date","System.Double":"number","System.Boolean":"boolean"};function p(){this.queryDataAdapter=Object.resolve(n)}var q=Object.inherit(e,p);p.prototype.handleDatasource=function a(b){var c=this;return{load:r.bind(null,b,c),totalCount:s.bind(null,b),paginate:!0,pageSize:b.pageSize()}};function r(a,c,d){var e=new b.Deferred,f=d.filter?d.filter.join(","):"",g=d.sort?JSON.stringify(d.sort):"",h=d.skip,i=d.take,j,k={filter:f,sort:g,
skip:a.gridInstance?a.gridInstance.pageIndex()*a.pageSize():0,take:a.pageSize(),searchFilter:d.filter},l=!(d.hasOwnProperty("filter")&&void 0===d.filter);return null===a.data()||void 0===a.data()?e.resolve([]):"static"===a.data()?(k.skip=h,k.take=i,c.handleStaticDataLoad(a,k,e)):(a.gridInstance&&a.gridInstance.clearSelection(),a.currentFilter!==k.filter?(a.currentFilter=k.filter,j=b(".dx-datagrid-filter-row .dx-editor-cell").index(b(".dx-editor-cell.dx-focused")),a.filterElIndex=j!==-1?j:a.filterElIndex,x(a,k,l).done(t.bind(null,a,c,k,e,!0)).fail(u.bind(null,a,c,e))):x(a,k,l).done(t.bind(null,a,c,k,e,!1))),e.promise()}function s(a,c){var d=b.Deferred(),e={};return"static"===a.data()&&a.totalCountCallback?Object.tryMethod(a,"totalCountCallback",d,e):d.resolve(),d.promise()}function t(a,b,c,d,e,f){var g;a.rawQueryData=f.result,g=v(a,b,f),a.queryDataColumns=g.columns,Object.tryMethod(a,"queryExecutedCB",f,c),d.resolve(g.dataRows),e&&w(a.filterElIndex)}function u(a,b,c){
var d=v(a,b,a.rawQueryData);c.resolve(d.dataRows),w(a.filterElIndex)}function v(a,b,c){var d=c.result,e=d.getRows(),f=d.getColumns(),g=b.queryDataAdapter.getColumnInfos(f,c.queryContainer.isFormatted);return{dataRows:b.queryDataAdapter.getRows(a,e,g),columns:g}}function w(a){b(b(".dx-datagrid-filter-row .dx-editor-cell")[a]).find("input").focus()}function x(a,c,d){var e=b.Deferred();if("function"!=typeof a.data||null!==a.data()&&void 0!==a.data()){var f={};if(a.aggregateQueryParams?(a.queryParams&&ha(a),f.parameters=a.aggregateQueryParams,f.suppressPrompts=!0):a.queryParams?(f.parameters=a.queryParams,f.suppressPrompts=!0):f.suppressPrompts=a.suppressPrompts(),f.suppressPrompts||b(".dialog-wrapper").find("mi-resultgrid").length||b(".dx-overlay-wrapper").addClass("suppressSpinner"),f.evalOnly=!1,f.pageSize=a.pageSize(),f.startPage=0!==a.pageNumber?a.pageNumber:"0",a.cachedQueryContainer)return f.queryContainer=new k(b.parseJSON(JSON.stringify(a.cachedQueryContainer))),
d?(c.sort&&(f.queryContainer=B(a,f.queryContainer,c.sort)),void 0!==a.prevFilter&&a.prevFilter!==c.filter&&(f.startPage="0",a.pageNumber=0,a.getTotalCount=!0),""!==c.filter&&void 0===a.prevFilter&&(a.getTotalCount=!0),a.prevFilter=c.filter,C(a,f.queryContainer,c.filter,c.searchFilter).done(function(b){f.queryContainer=b,y(a,f,e)})):y(a,f,e),e;if("catalogItemPath"===a.queryExecutionMode())a.catalogService.getCatalogItemKey(a.data()).done(function b(c){f.catalogItemKey=c,y(a,f,e)});else{switch(a.queryExecutionMode()){case"catalogItemKey":f.catalogItemKey=a.data();break;case"queryContainer":f.queryContainer=a.queryContainerObject,f.suppressPrompts=a.suppressPrompts();break;case"sqlStatement":f.sqlStatement=a.data();break;case"catalogItem":f.catalogItem=a.data()}y(a,f,e)}return e}}function y(a,b,c){a.queyExecutionEngine=new m(b),b.sync=!0,a.queyExecutionEngine.execute(b).done(z.bind(null,a,c)).fail(A)}function z(a,b,c){a.cachedQueryContainer=c.queryContainer,
a._totalCount(c.result.getRows().length),a._queryTotalCount=c.result.getRowCount(),c.result.getRows().splice(a.pageSize(),a.pageSize()),b.resolve(c)}function A(){b(".dx-loadindicator").hide()}function B(a,b,c){for(var d=JSON.parse(c),e=b,f=0;f<e.columnDesigns.length;f++)e.columnDesigns[f].resultSortOrder="None",e.columnDesigns[f].resultSortIndex=0;for(var g=0;g<d.length;g++)for(var h=0;e.columnDesigns&&h<e.columnDesigns.length;h++){var i=e.columnDesigns[h].alias||P(e.columnDesigns[h].id);if(d[g].selector===i){e.columnDesigns[h].resultSortOrder=d[g].desc?"Descending":"Ascending",e.columnDesigns[h].resultSortIndex=g+1;break}}return e}function C(a,c,e,f){var g=b.Deferred(),h,i,j,k,l,m,n;if("None"!==a.uomConversionSetId)if(f&&"string"==typeof f[0])j=0,m=(f.columnIndex+1).toString(),n=[f[2].toString()],l=a.queryService.convertSimpleCriteriaText.bind(a.queryService,c,!1,m,j,n),
d.resolve().then(l).then(E(a,c,e,f,h,g));else if(f&&f.length>0)for(h=0;h<f.length;h++)"object"==typeof(i=f[h])&&(j=h,m=(i.columnIndex+1).toString(),n=[i[2].toString()],l=a.queryService.convertSimpleCriteriaText.bind(a.queryService,c,!1,m,j,n),d.resolve().then(l).then(E(a,c,e,f,h,g)));else D(a,c,e,f,g);else D(a,c,e,f,g);return g}function D(a,b,c,d,e){var f=c.split(",and,"),g=b,h,i,j=d?d.join(","):"",k=!1,l=!1,m,n;j.indexOf(",or,")>-1&&(k=!0),(j.indexOf(",and,")>-1||""!==j&&j.indexOf(",or,")===-1)&&(l=!0),k&&l?(m=d[0].join(",").split(",and,"),n=d[2].join(",").split(",or,")):!l&&k?(m=[""],n=d.join(",").split(",or,")):!k&&l&&(n=[""],m=d.join(",").split(",and,")),J(a,g,f);var o="";if(l)for(var p=0;""!==m[0]&&p<m.length;p++)i=0,h={selector:m[p].split(",")[i],query:L(m[p])},h.selector&&(o!==h.selector&&M(a,g,h.selector,F.bind(a,a,g,h)),o=h.selector);if(k)for(var q=0;""!==n[0]&&q<n.length;q++)i=0,h={selector:n[q].split(",")[i],query:L(n[q])},
h.selector&&(o!==h.selector&&M(a,g,h.selector,G.bind(a,a,g,h)),o=h.selector);return e.resolve(g)}var E=c.curry(function a(b,c,d,e,f,g,h){return e&&"string"==typeof e[0]?e[2]=h[0]:e[f][2]=h[0],D(b,c,d,e,g)});function F(a,b,c,d){c.query&&(b.columnDesigns[d].resultFilterExpression=I(a,b.columnDesigns[d],c))}function G(a,b,c,d,e){c.query&&(b.columnDesigns[d].simpleCriteria=H(a,b.columnDesigns[d],c,d))}function H(a,b,c,d){for(var e=[],f=0;f<d;f++)e.push(null);var g=[{conditionOperator:"",dateValue:null,operator:"Contains",value:c.query}];return e.push({expressions:g}),e}function I(a,b,c){var d="",e="LAST_UPDT_DT"===b.id||"CRT_DT"===b.id,f=N(a,b),g=a.cachedQueryContainer.isFormatted;if("date"===f&&!g||e){var h=new Date(c.query),j=new Date(h);j.setHours(0,0,0,0);var k=new Date(h);k.setHours(23,59,59,999)
;var l=a.timezone.removeUtcOffset(j),m=a.timezone.removeUtcOffset(k),n=i.format(l,"yyyy-MM-dd HH:mm:ss"),o=i.format(m,"yyyy-MM-dd HH:mm:ss"),p="(>=(# :dt :utc '"+n+"')",q="<=(# :dt :utc '"+o+"'))";d=p+" And "+q,a.filtersArr.push(p),a.filtersArr.push(q)}else"boolean"===f?(d="true"===c.query?"'Y'":"false"===c.query?"'N'":"",a.filtersArr.push(d)):(d="(Like '%"+c.query+"%')",a.filtersArr.push(d));return d}function J(a,b,c){M(a,b,null,null,K.bind(a,a,b)),a.filtersArr=[]}function K(a,b,c){b.columnDesigns[c].resultFilterExpression=""}function L(a){var b="",c=a.split(",");if(c.length>2&&"contains"===c[1]){var d=a.indexOf(","),e=a.indexOf(",",d+1);b=a.substring(e+1).trim()}else b=void 0===c[2]?c[2]:c[2].trim();return b}function M(a,b,c,d,e){if(!b.columnDesigns)return!1;for(var f=0;f<b.columnDesigns.length;f++){if(d){c===(b.columnDesigns[f].alias||P(b.columnDesigns[f].id))&&d&&d.call(a,f)}e&&e.call(a,f)}}function N(b,c){var d=a.find(b.queryDataColumns,function(a){
return a.columnDesignKey.toString()===c.key.toString()});return d&&d.dataType?d.dataType:c.dataType.toLowerCase()}function O(a){return a.substring(1,a.length-1)}function P(a){return a&&a.indexOf("[")>-1?O(a):a}function Q(a){return a.toString().indexOf("<a")!==-1}function R(a){return a?a.substring(0,a.length):""}p.prototype.customizeColumns=function b(c,d){if("static"===c.data())return this.getStaticColumns(c,d);var e=this,f=c.rawQueryData,g=f.getRows(),h=f.getColumns(),i,k,l,m,n,o,p,q,r,s=c.cachedQueryContainer,t=j.user.formats.shortDate;c.uomConversionSetId=j.user.uomConversionSetId;var u=a.filter(d,function(a){return!a.dataField.match("_backColor")});a.map(a.filter(d,function(a){return a.dataField.match("_backColor")}),function(a){return a.visible=!1,a});for(var v=0;v<u.length;v++)i=h[v],k=u[v],i.setFieldId(P(i.getFieldId())),k.dataField=i.getAlias()||i.getFieldId(),k.caption=X(i),k.visible=i.getIsDisplayed(),k.trueText=c.translator.translate("TRUE"),
k.falseText=c.translator.translate("FALSE"),k.filterRow={showAllText:c.translator.translate("RG_ALL")},k.encodeHtml=!0,l=V(this,c,v),l||(k.encodeHtml=l),m=aa(i.getTypeName(),s.isFormatted),m&&(k.dataType=m),o=ba(this,k.dataType),o&&(k.format={formatter:o}),"number"===k.dataType?k.customizeText=T.bind(null,this,c,s,i):"number"===na(i)?k.customizeText=U.bind(c,s.isUomVisible,i.getDisplayUomCaption()):"date"===k.dataType&&(k.customizeText=S.bind(null,i.getFormat())),n=W(this,c,v),n&&(k.cellTemplate=n),_(s,k),p=Y(this,c,v),p||(k.visible=p),q=Z(this,c,v),q&&(k.fixed=q),(r=$(this,c,v))&&(k.width=r)};function S(a,b){if(b.value){var c=a?i.getFormatByCode(a):j.user.formats.dateTime;return i.format(b.value,c)}return b.value}function T(a,b,c,d,e){var f=a.formatNumberValue(e);return f=U(c.isUomVisible,d.getDisplayUomCaption(),{value:f})}function U(a,b,c){var d=c.value;return a&&b&&d&&(d+="("+b+")"),d}function V(a,b,c){
return b.queryDataColumns[c].encodeHtml&&"true"===b.queryDataColumns[c].encodeHtml.toString()}function W(a,b,c){var d;return b.queryDataColumns[c].hasCellTemplate&&"true"===b.queryDataColumns[c].hasCellTemplate.toString()&&(d=a.handleCustomCellTemplate.bind(null,b)),d}function X(a){var b="";return b=void 0!==a.getLocalizedAlias()&&""!==a.getLocalizedAlias()?a.getLocalizedAlias():void 0!==a.getAlias()&&""!==a.getAlias()&&a.getAlias()!==a.getFieldId()?a.getAlias():void 0!==a.getCaption()&&""!==a.getCaption()&&a.getCaption()!==a.getFieldId()?a.getCaption():a.getFieldId()}function Y(a,b,c){return b.queryDataColumns[c].visible}function Z(a,b,c){return b.queryDataColumns[c].fixed}function $(a,b,c){return b.queryDataColumns[c].width}function _(a,b){if(null!==a.columnDesigns&&void 0!==a.columnDesigns)for(var c=0;c<a.columnDesigns.length;c++){var d=a.columnDesigns[c],e=d.alias||P(d.id),f=d.defaultCaption&&P(d.caption)!==P(d.defaultCaption)&&b.caption===P(d.caption)
;(b.caption===e||f||b.dataField===e)&&(d.defaultCaption&&P(d.caption)===P(d.defaultCaption)&&(b.caption=b.caption||da(d,e)),b.dataType=d.hyperlink?"string":b.dataType),b=ca(d,b)}return b}function aa(a,b){var c;switch(a){case"System.DateTime":b||(c="date");break;case"System.Boolean":c="boolean";break;case"System.Double":b||(c="number")}return c}function ba(a,b){var c;return"date"===b&&(c=a.formatDateValue),c}function ca(a,b){var c=a.expressionText,d=c&&c.match(/^'.*'$/);return"Unknown"===a.dataType&&d&&(b.allowSorting=!1,b.cssClass="disable-cursor"),b}function da(a,b){return""===a.alias&&a.caption&&(a.caption=P(a.caption),b=a.caption),b}p.prototype.handleCellPreparedForQueryResult=function c(d,e,f){if("data"===f.rowType){var g=f,h=f.cellElement,i=g.value,j=i,k=a.find(d.queryDataColumns,function(a){var b=g.column;return void 0!==b&&void 0!==b.dataField&&(b.dataField=b.dataField.replace(/\./g,"__")),a.dataField===b.dataField});if(!k||!k.hasCellTemplate){
i&&"boolean"!=typeof i&&Q(i)&&g.column.encodeHtml&&k&&k.hyperlinkFormat&&(j=j.replace(/(<a [^>]+>)([^<]+)(<\/a>)/,function(){var a=arguments[2],b="number"===k.dataType?e.formatNumberValue({value:arguments[2]}):a;return arguments[1]+b+arguments[3]}),h.empty().append(j));var l=f.data[f.column.dataField+"_backColor"];l&&b(h).css("background-color",l);var m=b(h).find("a");m.length&&ea(i)&&d._openHyperLinkInNewTab!==!1&&m.attr("target","tab")}}};function ea(a){return/<[a-z\][\s\S]*>/i.test(a)}p.prototype.handleContentReadyAction=function a(c){var d=b(c.element).find(".gridContainer").dxDataGrid("instance");b(c.element).find(".rg-controls").show(),b(c.element).find(".rg-header").show();var e=d.totalCount()>0?d.totalCount():0;if(fa(c,d),c.gridInstance=d,Object.tryMethod(c,"gridLoadedCallback",d),
"standard"===c.scrollType()?c.getTotalCount&&this.getMenuPaging(c):"standard"!==c.scrollType()||"static"!==c.data()||c.currentFilter||b(c.element).find(".dxDataGridTotalCount").html(e+" "+c.translator.translate("RG_TOTAL_COUNT_MESSAGE")),b(c.element).find(".dx-datagrid-pager.dx-pager").hide(),b(c.element).find(".dx-datagrid-pager.dx-pager").append(b(c.element).find(".dxDataGridTotalCount")),c.showGridBorder){b(c.element).find("#gridContainer").addClass("grid-border");var f=b(c.element).find("#gridContainer").height();b(c.element).find(".grid-border").height(f)}this.configurePrint(c,e)};function fa(a,c){var d=a.showPaging?"calc(100% - 46px)":"calc(100% - 25px)",e=b(a.element).find(".gridContainer");c.totalCount()<=a.pageSize()&&e.css({height:d}),a.isFirstLoad&&(a.isFirstLoad=!1,c.totalCount()<=1&&(b(a.element).find(".rg-filter").attr("disabled",!0),c.option({sorting:{mode:"none"}})))}p.prototype.handleSelectionChanged=function a(b,c){var d
;"single"===b.selectionMode()?(d=c.selectedRowsData[0],Object.tryMethod(b,"callback",d)):(d=c.selectedRowsData,Object.tryMethod(b,"multiSelectCallback",d))},p.prototype.handleEditorPreparedForQuery=function b(c){var d=this;if("filterRow"===c.parentType&&"number"===c.dataType)c.editorElement.empty().dxTextBox({value:d.formatNumberValue(c),valueChangeEvent:"keyup",onValueChanged:a.debounce(function(a){var b=a.value?g.parseFloat(a.value):a.value;c.setValue(b),ga(d,c,b)},500)});else if("dataRow"===c.parentType&&"number"===c.dataType)var e=c.editorElement.dxNumberBox({value:d.formatNumberValue(c),onValueChanged:function(a){c.setValue(g.parseFloat(a.value))}})};function ga(a,b,c){var d=b.editorElement.dxTextBox("instance"),e=d.element().find("input"),f=a.formatNumberValue({value:c});e.val(f)}p.prototype.pageFilterHandler=function a(c,d){if(d&&d.parmDesigns&&d.parmDesigns.length&&(c.aggregateQueryParams=new l(b.parseJSON(JSON.stringify(d))),c.queryParams&&c.queryParams.parmDesigns)){
for(var e=0;e<c.queryParams.parmDesigns.length;e++)for(var f=0;f<d.parmDesigns.length;f++)if(c.queryParams.parmDesigns[e].id===d.parmDesigns[f].id){c.queryParams.parmDesigns.splice(e);break}for(var g=0;g<c.queryParams.parmDesigns.length;g++)c.aggregateQueryParams.parmDesigns.push(c.queryParams.parmDesigns[g])}c.data()&&c.refresh(c.data())};function ha(a){for(var b=[],c=a.aggregateQueryParams.parmDesigns.length,d=0;d<c;d++)b.push(a.aggregateQueryParams.parmDesigns[d].id);for(var e=a.queryParams.parmDesigns.length,f=0;f<e;f++)if(b.indexOf(a.queryParams.parmDesigns[f].id)>-1)for(var g=0;g<c;g++)a.aggregateQueryParams.parmDesigns[g].id===a.queryParams.parmDesigns[f].id&&(a.aggregateQueryParams.parmDesigns[g]=a.queryParams.parmDesigns[f]);else a.aggregateQueryParams.parmDesigns.push(a.queryParams.parmDesigns[f])}function ia(b,c,d){for(var e=a.map(b,d),f=b.length,g=c.length,h=0;h<g;h++)if(e.indexOf(c[h][d]>-1))for(var i=0;i<f;i++)b[i][d]===c[h][d]&&(b[i]=c[h]);else b.push(c[h]);return c}
function ja(a,c){if(a.length&&c){var d=c.split(" And "),e=d[d.length-1].toString().trim();return b.inArray(e,a)!==-1?ka(e)?la(c,2).trim():c.substring(0,c.lastIndexOf(" And ")).trim():c}return c}function ka(a){var b=a.replace("(>=(# :dt :utc ","").replace(" 00:00:00","").replace(/\)/g,"").replace(" 23:59:59","").replace("<=(# :dt :utc ","").replace(/'/g,"");return"Invalid Date"!==new Date(b).toString()}function la(a,b){for(var c=a,d=0;d<b;d++)c=c.substring(0,c.lastIndexOf(a));return c}function ma(a,b,c){for(var d=0;d<b.rows.length;d++)for(var e=0;e<c.length;e++)b.rows[d].displayInfos&&b.rows[d].displayInfos[e]&&b.rows[d].displayInfos[e].backColor&&(a.queryHasBackgroundColor(!0),c[e].cssClass=b.rows[d].displayInfos[e].backColor),b.rows[d].displayInfos&&b.rows[d].displayInfos[e]&&b.rows[d].displayInfos[e].format&&(c[e].format={formatter:a.formatDateValue.bind(null,b.rows[d].displayInfos[e].format)})}function na(a){return"Boolean"===a.getFieldDataType()?"boolean":o[a.getTypeName()]}
return p});
define('ui/elements/resultgrid/config/query-config',['require','lodash','jquery','./default-config','../helpers/query-helper'],function(require){"use strict";var a=require("lodash"),b=require("jquery"),c=require("./default-config"),d=Object.resolve(require("../helpers/query-helper"));function e(a){var e={dataSource:d.handleDatasource(a),customizeColumns:d.customizeColumns.bind(d,a),paging:f(a),onCellPrepared:d.handleCellPreparedForQueryResult.bind(null,a,d),onContentReady:d.handleContentReadyAction.bind(d,a),onSelectionChanged:d.handleSelectionChanged.bind(null,a),onRowPrepared:d.handleRowPrepared.bind(null,a),onEditorPrepared:d.handleEditorPreparedForQuery.bind(d),remoteOperations:{paging:!0,sorting:!0,filtering:!0},pager:{visible:!1}};return b.extend(e,c(a)),e}function f(a){return{enabled:!0,pageSize:a.pageSize()}}return e});
define('ui/elements/resultgrid/config/attr-config',['require','lodash','jquery','knockout','system/lang/converter','system/text/parser','system/text/formatter'],function(require){"use strict";var a=require("lodash"),b=require("jquery"),c=require("knockout"),d=require("system/lang/converter"),e=require("system/text/parser"),f=require("system/text/formatter"),g=Object.resolve(f);function h(a){this.vm=a,a.data=c.observable(),a.allowColumnResizing=c.observable(!0),a.allowColumnReordering=c.observable(!0),a.hasColumnChooser=c.observable(!0),a.selectionMode=c.observable("multiple"),a.showRowFilter=c.observable(!1),a.hideEditControls=c.observable(!1),a.showGroupingPanel=c.observable(!0),a.allowRowEditing=c.observable(!1),a.allowRowAdding=c.observable(!1),a.allowRowDeleting=c.observable(!1),a.editMode=c.observable("batch"),a.sortingMode=c.observable("single"),a.pageSize=c.observable(100),a.scrollType=c.observable("standard"),a.queryExecutionMode=c.observable("sqlStatement"),a.suppressPrompts=c.observable(!1),a.columnAutoWidth=c.observable(!0),a.wordWrapEnabled=c.observable(!1),a.showFooter=!0,a.showPaging=!0,a.showPrint=c.observable(!1),
a.loaderPanelEnabled=c.observable(!0)}function i(b,c,e,f){var g=b.getAttribute(c),h;a.isNull(g)||(h=f?d.toBoolean(g,"true"):g,a.isFunction(e)?e(h):e=h)}return h.prototype.addAttributes=function a(b){i(b,"data",b.data),i(b,"allowcolumnresizing",b.allowColumnResizing,!0),i(b,"allowcolumnreordering",b.allowColumnReordering,!0),i(b,"hascolumnchooser",b.hasColumnChooser,!0),i(b,"selectionmode",b.selectionMode),i(b,"showrowfilter",b.showRowFilter,!0),i(b,"hideeditcontrols",b.hideEditControls,!0),i(b,"showgroupingpanel",b.showGroupingPanel,!0),i(b,"allowrowediting",b.allowRowEditing,!0),i(b,"allowrowadding",b.allowRowAdding,!0),i(b,"allowrowdeleting",b.allowRowDeleting,!0),i(b,"editmode",b.editMode),i(b,"sortingmode",b.sortingMode),i(b,"pagesize",b.pageSize),i(b,"scrolltype",b.scrollType),i(b,"queryexecutionmode",b.queryExecutionMode),i(b,"suppressprompts",b.suppressPrompts,!0),i(b,"columnautowidth",b.columnAutoWidth,!0),i(b,"wordwrapenabled",b.wordWrapEnabled,!0),
i(b,"showfooter",b.showFooter,!0),i(b,"showpaging",b.showPaging,!0),i(b,"showprint",b.showPrint,!0),i(b,"loaderpanelenabled",b.loaderPanelEnabled,!0)},h.prototype.handleAttributeChange=function a(b,c,e){var f=this.vm;switch(b){case"data":f.data(e),f._refreshList(f);break;case"allowcolumnresizing":f.allowColumnResizing(d.toBoolean(e,"true"));break;case"allowcolumnreordering":f.allowColumnReordering(d.toBoolean(e,"true"));break;case"hascolumnchooser":f.hasColumnChooser(d.toBoolean(e,"true"));break;case"selectionmode":f.selectionMode(e);break;case"showgroupingpanel":f.showGroupingPanel(d.toBoolean(e,"true"));break;case"allowrowediting":f.allowRowEditing(d.toBoolean(e,"true"));break;case"allowrowadding":f.allowRowAdding(d.toBoolean(e,"true"));break;case"allowrowdeleting":f.allowRowDeleting(d.toBoolean(e,"true"));break;case"editmode":f.editMode(d.toString(e));break;case"sortingmode":f.sortingMode(e);break;case"showrowfilter":f.showRowFilter(d.toBoolean(e,"true"));break
;case"hideeditcontrols":f.hideEditControls(d.toBoolean(e,"true"));break;case"pagesize":f.pageSize(d.toInteger(e,"true"));break;case"scrolltype":f.scrollType(e);break;case"queryexecutionmode":f.queryExecutionMode(e);break;case"suppressprompts":f.suppressPrompts(d.toBoolean(e,"true"));break;case"columnautowidth":f.columnAutoWidth(d.toBoolean(e,"true"));break;case"wordwrapenabled":f.wordWrapEnabled(d.toBoolean(e,"true"));break;case"showfooter":f.showFooter=d.toBoolean(e,"true");break;case"showpaging":f.showpaging=d.toBoolean(e,"true");break;case"showprint":f.showPrint(d.toBoolean(e,"true"));break;case"loaderpanelenabled":f.loaderPanelEnabled(d.toBoolean(e,"true"))}},h});
define('ui/elements/resultgrid/config/prop-config',['require','lodash','jquery','system/lang/converter','system/text/parser','system/text/formatter'],function(require){"use strict";var a=require("lodash"),b=require("jquery"),c=require("system/lang/converter"),d=require("system/text/parser"),e=require("system/text/formatter"),f=Object.resolve(e);function g(){}function h(a){return a._loadConfigurableButtons}function i(a,b){a._loadConfigurableButtons=b,a.toolbarHelper.renderToolbars(a)}function j(a){return a._loadJSONData}function k(a,b){a._loadJSONData=b,a.reload()}function l(a){return a._showGridBorder}function m(a,b){a._showGridBorder=b}return g.prototype.addProperties=function a(b){b._loadJSONData=null,Element.defineProperty(b,"loadJSONData",{get:j.bind(null,b),set:k.bind(null,b)}),b._queryParams=null,Element.defineProperty(b,"queryParams",{get:function(){return b._queryParams}.bind(b),set:function(a){b._queryParams=a}.bind(b)}),b._aggregateQueryParams=null,Element.defineProperty(b,"aggregateQueryParams",{get:function(){return b._aggregateQueryParams}.bind(b),set:function(a){b._aggregateQueryParams=a}.bind(b)}),
b._queryContainerObject=null,Element.defineProperty(b,"queryContainerObject",{get:function(){return b._queryContainerObject}.bind(b),set:function(a){b._queryContainerObject=a}.bind(b)}),Element.defineProperty(b.element,"onRowSelectCB",{get:function(){return b.callback}.bind(b),set:function(a){b.callback=a}.bind(b)}),Element.defineProperty(b.element,"onPageChangeCB",{get:function(){return b.pageChangeCallback}.bind(b),set:function(a){b.pageChangeCallback=a}.bind(b)}),Element.defineProperty(b.element,"onRowMultiSelectCB",{get:function(){return b.multiSelectCallback}.bind(b),set:function(a){b.multiSelectCallback=a}.bind(b)}),Element.defineProperty(b.element,"onCellHyperlinkClickCB",{get:function(){return b.cellHyperlinkCallback}.bind(b),set:function(a){b.cellHyperlinkCallback=a}.bind(b)}),Element.defineProperty(b.element,"onRowPreparedCB",{get:function(){return b.rowPreparedCallback}.bind(b),set:function(a){b.rowPreparedCallback=a}.bind(b)}),
Element.defineProperty(b.element,"cellTemplateCB",{get:function(){return b.celltTemplateCallback}.bind(b),set:function(a){b.cellTemplateCallback=a}.bind(b)}),Element.defineProperty(b.element,"cellPreparedCB",{get:function(){return b.cellPreparedCallback}.bind(b),set:function(a){b.cellPreparedCallback=a}.bind(b)}),Element.defineProperty(b.element,"onInitNewRowCB",{get:function(){return b.onInitNewRowCallback}.bind(b),set:function(a){b.onInitNewRowCallback=a}.bind(b)}),Element.defineProperty(b.element,"headerCellTemplateCB",{get:function(){return b.headerCellTemplateCallback}.bind(b),set:function(a){b.headerCellTemplateCallback=a}.bind(b)}),Element.defineProperty(b.element,"gridLoadedCB",{get:function(){return b.gridLoadedCallback}.bind(b),set:function(a){b.gridLoadedCallback=a}.bind(b)}),Element.defineProperty(b.element,"totalCountCB",{get:function(){return b.totalCountCallback}.bind(b),set:function(a){b.totalCountCallback=a}.bind(b)}),
Element.defineProperty(b.element,"queryExecutedCB",{get:function(){return b.queryExecutedCallback}.bind(b),set:function(a){b.queryExecutedCallback=a}.bind(b)}),Element.defineProperty(b.element,"totalCount",{get:function(){return b._totalCount()}.bind(b),set:function(a){b._totalCount(a)}.bind(b)}),b._loadConfigurableButtons=null,Element.defineProperty(b,"loadConfigurableButtons",{get:h.bind(null,b),set:i.bind(null,b)}),b._toolbarItemClickCallback=null,Element.defineProperty(b,"toolbarItemClickCallback",{get:function(a){return a._toolbarItemClickCallback}.bind(null,b),set:function(a,b){a._toolbarItemClickCallback=b}.bind(null,b)}),b._openHyperLinkInNewTab=!0,Element.defineProperty(b,"openHyperLinkInNewTab",{get:function(){return b._openHyperLinkInNewTab}.bind(b),set:function(a){b._openHyperLinkInNewTab=a}.bind(b)}),b._showGridBorder=!1,Element.defineProperty(b,"showGridBorder",{get:l.bind(null,b),set:m.bind(null,b)})},g});
define('ui/elements/resultgrid/helpers/print-helper',['require','lodash','jquery'],function(require){"use strict";var a=require("lodash"),b=require("jquery");function c(){}c.prototype.createCutomTable=function a(c){var e=c.vm,f="",g="",h="",i="",j="",k="",l=b(e).find(".dx-datagrid-text-content"),m=l.length;l.each(function(a){a!==m-1&&(h+="<th class='rg-print-header' style='"+b(this).closest("td").attr("style")+"'>"+b(this).text()+"</th>")}),f="<thead>"+h+"</thead>",b(e).find(".dx-datagrid-table").find(".dx-data-row").each(function(){j="",b(this).find(" > td:not(.dx-command-select)").each(function(){k=0===b(this).find("a").length?b(this).html():b(this).text(),j+="<td class='rg-print-col' style='"+b(this).attr("style")+"'>"+k+"</td>"}),i+="<tr>"+j+"</tr>"}),g="<tbody>"+i+"</tbody>",d(e,"<div class='rg-print-container'><table class='rg-print-table'>"+f+g+"</table>")};function d(c,d){var e=a.map(b("head > link"),function(a){return a.outerHTML}),f={htmlString:d,cssLinks:e};c.exportService.exportPage(f,"pdf","GridData")}function e(a){
var b=window.open("","","width=400,height=400"),c=b.document;c.open(),c.write(a+'<link type="text/css" rel="Stylesheet" href="styles/default.css" />'),c.close()}return c});
define('ui/elements/resultgrid/helpers/toolbar-helper',['require','lodash','jquery','./utils','system/lang/converter','system/text/parser','system/text/formatter','./print-helper','ui/elements/more-options/more-options'],function(require){"use strict";var a=require("lodash"),b=require("jquery"),c=require("./utils"),d=require("system/lang/converter"),e=require("system/text/parser"),f=require("system/text/formatter"),g=Object.resolve(f),h=Object.resolve(require("./print-helper"));require("ui/elements/more-options/more-options");function i(){this.rightToolbar=null,this.leftToolbar=null,this.vm=null,this.buttons=[]}var j=Object.inherit(c,i);i.prototype.init=function a(b,c){this.vm=b;var d,e,f;f=document.createElement("div"),d=document.createElement("mi-tool-bar"),d.className="rg-left-tool-bar pull-left",f.appendChild(d),e=document.createElement("mi-tool-bar"),e.className="rg-right-tool-bar pull-right",d.insertBefore(k(this,"showFilter",b.translator.translate("RG_SEARCH_CAPTION"),"icon-search","rg-filter"),d.firstChild),d.appendChild(n(this,b.translator.translate("PRINT"))),f.appendChild(e),c.insertBefore(f,c.firstChild),this.leftToolbar=d,this.rightToolbar=e,this.attachEventHandlers(),this.hide()},
i.prototype.handleVisibility=function a(){var c=this.vm;if(!c)return!1;c.showRowFilter()?this.show():2===b(this.leftToolbar).find("button").length&&b(this.leftToolbar).hide()},i.prototype.hide=function a(){b(this.leftToolbar).hide(),b(this.rightToolbar).hide()},i.prototype.show=function a(){b(this.leftToolbar).show(),b(this.rightToolbar).show()},i.prototype.attachEventHandlers=function a(){this.leftToolbar.addEventListener("click",this),this.rightToolbar.addEventListener("click",this)},i.prototype.handleEvent=function a(b){var c=this.vm,d;"click"===b.type&&("BUTTON"!==b.target.nodeName||b.target.disabled?"I"!==b.target.nodeName||"BUTTON"!==b.target.parentNode.nodeName||b.target.parentNode.disabled||(d=b.target.parentNode.getAttribute("data-action"),Object.tryMethod(c,"toolbarItemClickCallback",d,b)):(d=b.target.getAttribute("data-action"),Object.tryMethod(c,"toolbarItemClickCallback",d,b)))},i.prototype.disableButton=function a(b,c,d){var e,f=b.buttons
;if(f)for(e=0;e<f.length;e++)q(f[e],c)&&(f[e].disabled=d)},i.prototype.setNoAccess=function a(b,c,d){var e,f=b.buttons;if(f)for(e=0;e<f.length;e++)q(f[e],c)&&(f[e].tagName&&"mi-more-options-noko"===f[e].tagName.toLowerCase()?f[e].setAttribute("noaccess",d):d?f[e].className+=" no-access":f[e].className=f[e].className.replace(/ no-access/g,""))},i.prototype.showButton=function a(b,c,d){var e,f=b.buttons,g;if(f)for(e=0;e<f.length;e++)r(f[e])&&!q(f[e],c)?(g=s(f[e].items,c),t(g,d)):q(f[e],c)&&u(f[e],d)},i.prototype.renderToolbars=function a(b){var c,d,e,f;if(c=b.querySelector(".rg-left-tool-bar"),d=b.querySelector(".rg-right-tool-bar"),b._loadConfigurableButtons&&c&&d){for(e=0;e<b._loadConfigurableButtons().length;e++)f=b._loadConfigurableButtons()[e],
"left"===f.align?"more-options"===f.type?f.iconClass?c.insertBefore(m(this,"icon",f.iconClass,f),c.firstChild):c.insertBefore(m(this,"text",f.text,f),c.firstChild):f.text?c.insertBefore(l(this,f.action,f.title,f.text,f.btnClass),c.firstChild):c.insertBefore(k(this,f.action,f.title,f.iconClass,f.btnClass),c.firstChild):"right"===f.align&&("more-options"===f.type?f.iconClass?d.insertBefore(m(this,"icon",f.iconClass,f),d.firstChild):d.insertBefore(m(this,"text",f.text,f),d.firstChild):f.text?d.insertBefore(l(this,f.action,f.title,f.text,f.btnClass),d.firstChild):d.insertBefore(k(this,f.action,f.title,f.iconClass,f.btnClass),d.firstChild));this.show()}};function k(a,b,c,d,e){var f=document.createElement("button"),g="",h=document.createElement("i");return h.className=d,e&&(g=e),f.className="btn btn-icon "+g,f.title=c,f.setAttribute("data-action",b),f.appendChild(h),a.buttons||(a.buttons=[]),a.buttons.push(f),f}function l(a,b,c,d,e){var f=document.createElement("button"),g=""
;return f.innerHTML=d,e&&(g=e),f.className="btn btn-text "+g,f.title=c||d,f.setAttribute("data-action",b),a.buttons||(a.buttons=[]),a.buttons.push(f),f}function m(a,c,d,e){var f=document.createElement("mi-more-options-noko"),g="";return"icon"===c?f.setAttribute("icon",d):f.setAttribute("text",d),e.btnClass&&(g=e.btnClass),e.height&&b(f).prop("height",e.height),b(f).attr("class",g),window.CustomElements&&!window.CustomElements.useNative&&window.CustomElements.upgrade(f),f.items=e.options,f.loader=o.bind(null,f,e.options),f.moreoptionsCB(p.bind(null,a.vm)),a.buttons||(a.buttons=[]),a.buttons.push(f),f}function n(a,b){var c=document.createElement("button"),d=document.createElement("i");return d.className="icon-printer",c.className="btn btn-icon rg-print",c.title=b,c.style.display="none",c.onclick=function(){h.createCutomTable(a)},c.appendChild(d),a.buttons||(a.buttons=[]),a.buttons.push(c),c}function o(a,c){var d,e=[],f,g=b.Deferred(),h;for(d=0;d<c.length;d++)f={type:"text",
text:c[d].text,icon:c[d].iconClass,action:c[d].action,btnClass:c[d].btnClass},c[d].disabled&&(f.disabled="function"==typeof c[d].disabled?c[d].disabled():c[d].disabled),c[d].noaccess&&(f.noaccess="function"==typeof c[d].noaccess?c[d].noaccess():c[d].noaccess),(h=s(a.items,f.btnClass))&&h.show!==!1&&e.push(f);return g.resolve(e),g.promise()}function p(a,b){Object.tryMethod(a,"toolbarItemClickCallback",b.action)}function q(a,b){return a.className.split(" ").indexOf(b)>=0}function r(a){return!(!a||!a.tagName||"mi-more-options-noko"!==a.tagName.toLowerCase())}function s(a,b){var c;for(c=0;c<a.length;c++)if(a[c].btnClass===b)return a[c]}function t(a,b){a&&(a.show=b)}function u(a,b){a.style.display=b?"inline-block":"none"}return i});
define('ui/elements/resultgrid/resultgrid-view-model',['require','lodash','jquery','jquery','text!./resultgrid-template.html','knockout','application/application-events','system/ui/message-box','./resultgrid-service','ui/elements/page-filter/page-filter-connection','query/services/dto/query-container-dto','query/services/dto/parameter-container-dto','catalog/services/catalog-service','query/services/query-service','query/execution/query-execution-engine','system/lang/converter','system/text/parser','system/text/formatter','../date-time/timezone-handler','system/globalization/translator','application/application-context','application/export-service','./config/json-config','./config/query-config','./config/attr-config','./config/prop-config','./helpers/json-helper','./helpers/query-helper','./helpers/toolbar-helper','ui/elements/checkbox/checkbox-view-model','ui/elements/tool-bar/view-model'],function(require){"use strict"
;var a=require("lodash"),b=require("jquery"),c=require("jquery"),d=require("text!./resultgrid-template.html"),e=require("knockout"),f=require("application/application-events"),g=require("system/ui/message-box"),h=require("./resultgrid-service"),i=require("ui/elements/page-filter/page-filter-connection"),j=require("query/services/dto/query-container-dto"),k=require("query/services/dto/parameter-container-dto"),l=require("catalog/services/catalog-service"),m=require("query/services/query-service"),n=require("query/execution/query-execution-engine"),o=require("system/lang/converter"),p=require("system/text/parser"),q=require("system/text/formatter"),r=Object.resolve(q),s=require("../date-time/timezone-handler"),t=require("system/globalization/translator"),u=require("application/application-context"),v=require("application/export-service"),w=require("./config/json-config"),x=require("./config/query-config"),y=require("./config/attr-config"),z=require("./config/prop-config"),A=Object.resolve(require("./helpers/json-helper")),B=Object.resolve(require("./helpers/query-helper")),C=require("./helpers/toolbar-helper")
;require("ui/elements/checkbox/checkbox-view-model"),require("ui/elements/tool-bar/view-model");var D=Object.create(HTMLElement.prototype);D.createdCallback=function(){this.element=this,this.translator=Object.resolve(t),this.service=Object.resolve(h),this.catalogService=Object.resolve(l),this.queryService=Object.resolve(m),this.queryContainerDTO=Object.resolve(j),this.pageFilterConnection=Object.resolve(i),this.fields=e.observableArray(),this.cachedQueryContainer=null,this.attrConfig=Object.resolve(y,this),this.propConfig=Object.resolve(z,this),this.toolbarHelper=Object.resolve(C),this.exportService=Object.resolve(v),E(this);var a=this;a.filtersArr=[],a.filterElIndex=null,a.queryContainer=null,a.columnsSpecified=!1,a.totalCountDfd=new b.Deferred,a._totalCount=e.observable(0),a._totalCount.subscribe(function(b){a.totalCountDfd.resolve(b)}),a._queryTotalCount=0,a.currentFilter="",a.queryHasBackgroundColor=e.observable(!1),a.noDataCaptioin=a.translator.translate("RG_NO_DATA_CAPTION"),
a.attrConfig.addAttributes(this),a.propConfig.addProperties(this),a.getTotalCount=!0,a.customTotalCount=e.observable(),a.pageNumber=0,a.listObjects=e.observableArray([{displayName:"0",val:0}]),a.optionsValue="val",a.selectedValue=e.observable(0),a.formColumnArr=[],a.tzHandler=Object.resolve(s),a.timezone=null,a.tzHandler.getTimezone().done(function(b){a.timezone=b}),this.loadJSONData&&this.reload(),a.isFirstLoad=!0,this.appEvents=Object.resolve(f)},D.attachedCallback=function(){var a;this.element.innerHTML=d,this.pageFilterConnection.open(B.pageFilterHandler.bind(null,this),this.element),e.applyBindings(this,b(this.element).find("mi-select")[0]),e.applyBindings(this,b(this.element).find(".totalCount")[0]),a=this.querySelector(".rg-header"),this.toolbarHelper.init(this,a),this.appEvents&&this.appEvents.layoutChanged&&this.appEvents.layoutChanged.add(this.repaint,this)},D.detachedCallback=function(){this.pageFilterConnection.close(),this.cachedQueryContainer=null,
this.appEvents&&this.appEvents.layoutChanged&&this.appEvents.layoutChanged.remove(this.repaint,this)},D.attributeChangedCallback=function(a,b,c){return this.attrConfig&&this.attrConfig.handleAttributeChange(a,b,c)};function E(a){a.disableButton=a.toolbarHelper.disableButton.bind(null,a.toolbarHelper),a.setNoAccess=a.toolbarHelper.setNoAccess.bind(null,a.toolbarHelper),a.showButton=a.toolbarHelper.showButton.bind(null,a.toolbarHelper)}function F(a,b){H.bind(null,a)()}D._refreshList=F,D.refresh=function(a){this.data(a),F(this)},D.reload=function(){b(this.element).find(".rg-filter").data("isFilterEnabled",!1),"static"===this.data()&&this.gridInstance?this.refresh("static"):this.load().done()},D.repaint=function(){var a=this;try{b(a.element).find(".gridContainer").dxDataGrid("instance").repaint()}catch(a){}},D.load=function(){this.getTotalCount=!0;var a;return this.loadJSONData&&"function"==typeof this.loadJSONData?(a=this.loadJSONData(),a.done(G.bind(null,this)),
a.promise()):this.loadJSONData&&"object"==typeof this.loadJSONData?(G(this,this.loadJSONData),b.Deferred().done().promise()):b.Deferred().done().promise()},D.toggleLoaderPanel=function a(c){var d=this;if(d&&!d.element)return!1;try{var e=b(d.element).find(".gridContainer").dxDataGrid("instance"),f=null;return f=void 0!==c?!!c:!e.option("loadPanel.enabled"),e.option("loadPanel.enabled",f)}catch(a){return console.error(a),!1}};function G(a,b){void 0===b.columns||0===b.columns.length?J(a,b):I(a,b)}function H(a,b){if(null!==a.fields()&&a.data()){a.cachedQueryContainer=null,a.getTotalCount=!0;K(a,x(a))}}function I(a,b){var c=A.getColumnsFromData(a,b);a._totalCount(b.data?b.data.length:0),K(a,w(a,b,c),b,"json")}function J(a,b){a._totalCount(b.data?b.data.length:0),K(a,w(a,b),b,"json")}function K(b,c,d,e){require(["devExWebJS"],function f(){S(b);var g,h=M(b,g);b.hideEditControls()&&h.addClass("hide-edit-controls"),e?(O(b,h,c,g),
"json"===e&&void 0!==d.selectedRows&&a.defer(A.preSelectRows.bind(null,b,d.selectedRows))):"static"===b.data()?B.handleGetTotalRecordsCount(b).done(function a(){O(b,h,c,g),L(b)}):O(b,h,c),R(b,h)})}function L(a){b(a.element).find(".dxDataGridTotalCount").html(a._totalCount()+" "+a.translator.translate("RG_TOTAL_COUNT_MESSAGE"))}function M(a,c){var d="calc(100% - 46px)";return"infinite"===a.scrollType()&&(d=a.showFooter?"calc(100% - 25px)":"100%"),b('<div id="gridContainer" class="gridContainer" style=""></div>').css({display:"block",height:d,width:"100%"})}function N(a,b,c){a._totalCount()<a.pageSize()&&b.css({height:c})}function O(a,b,c,d){P(a,b).dxDataGrid(c),Q(),d&&N(a,b,d)}function P(a,c){return b(a.element).find(".gridContainer").remove().end().find(".rg-header").after(c).end().find(".gridContainer")}function Q(){b(".dx-loadpanel-indicator.dx-loadindicator.dx-widget").html('<div class="load-spinner"><span class="loading-med loading-active center-block"></span></div>')}
function R(a,c){a.showFooter||b(c).parent().find(".rg-footer").addClass("hide-rg-footer")}function S(a){b(a.element).find(".rg-filter").data("isFilterEnabled",!1),T(a),a.toolbarHelper.handleVisibility(),"infinite"===a.scrollType()?b(a.element).find(".dxDataGridTotalCount").show():"standard"===a.scrollType()&&(b(a.element).find("mi-select").show(),b(a.element).find(".totalCount").show()),a.selectedValue.subscribe(a.toolbarHelper.changePage.bind(null,a))}function T(a){b(a.element).find(".rg-filter").off().hide(),a.showRowFilter()&&b(a.element).find(".rg-filter").show().on("click",U.bind(null,a))}function U(a,c){var d=b(a.element).find(".rg-filter").data("isFilterEnabled");b(a.element).find(".rg-filter").data("isFilterEnabled",!d),b(a.element).find(".gridContainer").dxDataGrid({filterRow:{visible:!d,showOperationChooser:!1}})}return document.registerElement("mi-resultgrid",{prototype:D}),D});
define('licensing/licensing-view-model',['require','lodash','jquery','knockout','spa/ko/knockout-view-model','application/application-events','application/application-context','text!./views/licensing.html','system/error/error-message','system/globalization/translator','licensing/services/licensing-service','licensing/licensing-dialog-view-model','dcm/utility/utility','ui/elements/breadcrumb/view-model','ui/elements/header/header-view-model','ui/elements/resultgrid/resultgrid-view-model'],function(require){"use strict";var a=require("lodash"),b=require("jquery"),c=require("knockout"),d=require("spa/ko/knockout-view-model"),e=require("application/application-events"),f=require("application/application-context"),g=require("text!./views/licensing.html"),h=require("system/error/error-message"),i=require("system/globalization/translator"),j=require("licensing/services/licensing-service"),k=require("licensing/licensing-dialog-view-model"),l=require("dcm/utility/utility"),m="meridium-session";require("ui/elements/breadcrumb/view-model"),require("ui/elements/header/header-view-model"),require("ui/elements/resultgrid/resultgrid-view-model");function n(a,b,d,e){var f=this;o.call(this,g),f.applicationEvents=b,f.titleChanged=b.titleChanged,f.utility=Object.resolve(l),f.translator=a,f.licensingService=d,f.licensingDialog=e,f.licensesArray=c.observableArray()}n.dependsOn=[i,e,j,k];var o=Object.inherit(d,n);n.prototype.activate=function a(){
f.help.helpContext="../Subsystems/Operations/Content/ActivateLicenses.htm"},n.prototype.attach=function a(b){var c=this;c.utility.userHasAccess(f.user,"activatelicense")?(o.prototype.attach.call(this,b),this.region=b,this.activateBreadcrumb(),this.getLicenses()):c.applicationEvents.navigate.raise("access-denied")},n.prototype.open=function a(){this.titleChanged.raise(this.translate("ACTIVATE_LICENSES"),this)},n.prototype.translate=function a(b){return this.translator.translate(b)},n.prototype.activateBreadcrumb=function a(){this.region&&(this.breadcrumb=this.region.$element.find("#licensing-breadcrumb")[0],Element.upgrade(this.breadcrumb),this.breadcrumb.loader=this.loader.bind(this),this.breadcrumb.selectedCallback=this.selectedCallback.bind(this))},n.prototype.loader=function a(){var c=b.Deferred(),d=this;return this.breadcrumbData=[{text:d.translate("OPERATIONS_MANAGER"),value:"1"}],c.resolve(this.breadcrumbData),c.promise()},n.prototype.selectedCallback=function a(b){
var c=b.value,d,e;for(d=0;d<this.breadcrumb.items.length;d++)if(this.breadcrumb.items[d].value===c){e=d+1;break}this.breadcrumbData.splice(e,this.breadcrumbData.length-e),this.breadcrumb.items=this.breadcrumbData,"1"===b.value&&this.applicationEvents.navigate.raise("#admin-menu/operations-manager")},n.prototype.generateTable=function a(){this.region&&(this.resultGrid=this.region.$element.find("mi-resultgrid")[0],Element.upgrade(this.resultGrid),this.resultGrid&&(this.resultGrid.loadJSONData=this.loadLicenses.bind(this)))},n.prototype.loadLicenses=function a(){var c=b.Deferred(),d={};return d.columns=[{id:"name",alias:this.translator.translate("LICENSES")},{id:"moduleStatus",alias:this.translator.translate("STATUS")}],d.data=this.licensesArray(),c.resolve(d),c.promise()},n.prototype.getLicenses=function b(){var c=this;c.licensingService.getLicenses().done(function(b){var d=a.sortBy(b,"name");c.licensesArray(d),c.generateTable()}).fail(function(a){p(c,a)})},
n.prototype.triggerLicenseDialog=function a(){var b=this;return b.licensingDialog.show(b.translator.translate("LICENSES_ACTIVATION")).done(function(){b.getLicenses()})};function p(a,b){var c=2,d=b.statusText,e=new h(c,d);a.applicationEvents.errorOccured.raise(a,e)}return n});
define('security/view-models/expired-license-checker',["require","exports","system/ui/message-box","system/globalization/translator","security/view-models/application-reset","system/lang/ioc","bluebird","licensing/licensing-view-model","security/services/security-service"],function(require,exports,a,b,c,d,e){"use strict";var f=require("licensing/licensing-view-model"),g=require("security/services/security-service"),h=function(){function a(){}return a.prototype.checkForExpiredLicense=function(a,b){return a&&a.isLicenseExpired?(j(),i(),e.reject("Login cancelled - Product license is expired.")):e.resolve(b)},a}();function i(){(new c).deleteSession()}function j(){a.showOk(n("LICENSE_EXPIRED_APPLY_LICENSE"),n("LICENSE_EXPIRED")).done(k)}function k(){var b=d.resolve(f),c=n("LOGIN");b.triggerLicenseDialog().done(function(){a.showOk(n("LICENSE_SUCCESS"),c).done(l)}).fail(function(){a.showOk(n("LICENSE_FAILURE"),c).done(m)})}function l(){a.showOk(n("LICENSE_SUCCESS"),n("LOGIN")).done(m)}function m(){d.resolve(g).logout().always(function(){
(new c).reset()})}function n(a){return d.resolve(b).translate(a)}return h});
define('application/window-event-handler',['require','exports','module','system/diagnostics/log-manager','./application-events','system/error/error-message'],function(require,exports,module){"use strict";var a=require("system/diagnostics/log-manager"),b=a.getLogger(module.id),c=require("./application-events"),d=require("system/error/error-message"),e="UH-1";function f(){this.appEvents=Object.resolve(c)}f.singleton=!0,f.prototype.load=function(){window.addEventListener("unload",this),window.addEventListener("click",this),window.addEventListener("resize",this),g(this)},f.prototype.unload=function(){window.removeEventListener("unload",this),window.removeEventListener("click",this),window.removeEventListener("resize",this)},f.prototype.handleEvent=function(a){"unload"===a.type?h(this):"click"===a.type?i(this):"resize"===a.type&&j(this)};function g(a,b,c,d){window.onerror=function(b,c){return k(a,"UH-1",b,c),void 0!==window.MSApp}}function h(a){a.appEvents.windowUnloaded.raise(a)}function i(a){a.appEvents.windowClicked.raise(a)}function j(a){a.appEvents.windowResized.raise(a)}function k(c,e,f,g){var h;h=g?new d(e,f,g):new d(e,f),
c.appEvents.errorUnhandled.raise(c,h),a.pushContext("error_unhandled"),b.error("Unhandled Error:",h),a.popContext()}return f});

define('text!system/error-accumulator/views/error-accumulator-view.html',[],function () { return '<i class="icon-close-popup error-accumulator-container-close-mark" data-bind="click:closePopup"></i>\r\n<div class="error-accumulator-container" data-bind="foreach:errorArray">\r\n    <div class="collipsable-error-container">\r\n        <div class="collipsable-error-title" data-bind="click:$root.toggleTitleClick.bind(this,$root)">\r\n            <i data-bind="css:{\'icon-right-arrow\':!expand(),\'icon-arrow\':expand()}"></i>\r\n            <span data-bind="text:($index()+1)"></span>. \r\n            <span data-bind="text:errorMessage"></span>\r\n        </div>\r\n        <div class="collipsable-error-desc" data-bind="html:errorDetail,visible:expand()"></div>\r\n    </div>\r\n    <hr />\r\n</div>';});

define('system/error-accumulator/error-accumulator-view-model',['require','knockout','spa/ko/knockout-view-model','system/ui/dialog-view-model','text!./views/error-accumulator-view.html','system/globalization/translator'],function(require){"use strict";var a=require("knockout"),b=require("spa/ko/knockout-view-model"),c=require("system/ui/dialog-view-model"),d=require("text!./views/error-accumulator-view.html"),e=require("system/globalization/translator");function f(){g.call(this,d),this.translator=Object.resolve(e),this.errorArray=a.observableArray()}var g=Object.inherit(b,f);return f.prototype.registerError=function a(b){this.addError(b),this.updateView()},f.prototype.addError=function b(c){c.expand=a.observable(!1),this.errorArray.unshift(c)},f.prototype.toggleTitleClick=function a(b,c,d){c.expand(!c.expand())},f.prototype.closePopup=function a(){this.dialog&&(this.dialog.closeDialog(),this.dialog=null),this.errorArray([])},f.prototype.updateView=function a(){this.dialog||(this.dialog=new c(this,this.translator.translate("ERRORS")),this.dialog.show())},f});
define('application/application-error-handler',['require','./application-events','logging/error-notification-handler','system/error-accumulator/error-accumulator-view-model'],function(require){"use strict";var a=require("./application-events"),b=require("logging/error-notification-handler"),c=require("system/error-accumulator/error-accumulator-view-model");function d(){this.appEvents=Object.resolve(a),this.errorNotificationHandler=Object.resolve(b),this.errorAccumulator=Object.resolve(c)}d.singleton=!0,d.prototype.load=function(){this.appEvents.errorOccured.add(e.bind(null,this),this),this.appEvents.errorUnhandled.add(e.bind(null,this),this),this.appEvents.sessionExpired.add(f.bind(null,this),this)},d.prototype.unload=function(){this.appEvents.errorOccured.remove(this),this.appEvents.errorUnhandled.remove(this),this.appEvents.sessionExpired.remove(this)};function e(a,b,c){var d={errorCode:c.code,errorMessage:c.message,errorDetail:c.detail};a.errorNotificationHandler.addError(d),a.errorAccumulator.registerError(d)}function f(a){a.errorAccumulator&&a.errorAccumulator.closePopup()}return d});
define('security/model/login-manager',['require','exports','module','application/application-context','security/model/saved-session','system/http/ajax-client','system/diagnostics/log-manager','security/services/security-service','application/window-event-handler','application/application-error-handler','system/globalization/translator','application/application-events','system/ui/message-box','lodash','bluebird'],function(require,exports,module){"use strict";var a=require("application/application-context"),b=require("security/model/saved-session"),c=require("system/http/ajax-client"),d=require("system/diagnostics/log-manager"),e=d.getLogger(module.id),f=require("security/services/security-service"),g=require("application/window-event-handler"),h=require("application/application-error-handler"),i=require("system/globalization/translator"),j=require("application/application-events"),k=require("system/ui/message-box"),l=require("lodash"),m=require("bluebird");function n(){this.securityService=Object.resolve(f),this.windowEventHandler=Object.resolve(g),this.applicationErrorHandler=Object.resolve(h)}n.prototype.overrideApiServer=function(a,b){return b&&(a.apiServer=b),a},n.prototype.setContextSession=function(b){a.session=b,a.sessionStatus.isActive=!0,Object.resolve(j).sessionChanged.raise(this,a.sessionStatus)},n.prototype.saveSession=function(a){b.saveSession(a)},
n.prototype.registerAjaxClientWithSession=function(a){c.setServer(a.apiServer),c.addHeader("MeridiumToken",a.id)},n.prototype.setLocalStorageUserDataSourceApiServer=function(a,c){b.saveUserId(a.userId),b.saveDatasource(a.datasourceId),c&&b.saveApiServer(c)},n.prototype.getUser=function(){return m.resolve(this.securityService.getSessionUser())},n.prototype.getSites=function(a){return m.resolve(a.securityService.getSites())},n.prototype.onFailedUserLoad=function(){o(),b.deleteSession(),p(),q()};function o(){var a=JSON.parse(b.getSession());e.info("Logged out session",a)}function p(){c.clearHeaders()}function q(){l.delay(r,0)}function r(){window.location.reload()}n.prototype.setContextUser=function(b){return a.user=b,b},n.prototype.registerAjaxClientWithUser=function(){var b=a.session,d=a.user;c.addHeader("MeridiumToken",b.id+";"+d.timezoneId)},n.prototype.onFailedSitesLoad=function(a){if(a&&!a.isLicenseExpired()){
var b=Object.resolve(i),c=b.translate("INTERNAL_ERROR_FAILED_TO_LOAD_SITES"),d=b.translate("FAILED_TO_LOAD_SITES");k.showOk(c,d)}return m.resolve()},n.prototype.setSitesCount=function(b){return a.dbSiteCount=b.length,b.length},n.prototype.saveUserCulture=function(a){b.saveUserCulture(a)},n.prototype.login=function(a,b,c){return m.resolve(this.securityService.login(a,b,c))},n.prototype.hostedEnvironment=function(){return m.resolve(this.securityService.getHostingEnv())},n.prototype.checkIfPasswordHasToChange=function(a){var b=Object.resolve(i),c=b.translate("PASSWORD_HAS_TO_CHANGE"),d=b.translate("NEW_PASSWORD_IS_REQUIRED");return a.mustChangePassword===!0?(k.showOk(c,d).done(s.bind(null,this)),m.reject()):m.resolve(a)};function s(a){a.windowEventHandler.unload(),a.applicationErrorHandler.unload(),window.location.reload()}return n});
define('security/model/base-login-strategy',['require','exports','module','lodash','bluebird','mi-assert','system/diagnostics/log-manager','application/application-context','security/services/security-service','system/globalization/resource-service','system/text/formatter','system/globalization/translator','system/lang/event','system/ui/message-box','system/hardware/device','system/globalization/culture-list','security/offline-login/context/offline-login-context','ui/elements/date-time/date-time-control','security/view-models/expired-license-checker','security/model/login-manager'],function(require,exports,module){"use strict";var a=require("lodash"),b=require("bluebird"),c=require("mi-assert"),d=require("system/diagnostics/log-manager"),e=d.getLogger(module.id),f=require("application/application-context"),g=require("security/services/security-service"),h=require("system/globalization/resource-service"),i=require("system/text/formatter"),j=require("system/globalization/translator"),k=require("system/lang/event"),l=require("system/ui/message-box"),m=require("system/hardware/device"),n=require("system/globalization/culture-list"),o=require("security/offline-login/context/offline-login-context"),p=require("ui/elements/date-time/date-time-control"),q=require("security/view-models/expired-license-checker"),r=require("security/model/login-manager");function s(a){Object.abstractClass(this,s),c.ok(a,"vm"),c.isDeferred(a.loginDeferred,"vm.loginDeferred"),this.vm=a,this.loginDeferred=a.loginDeferred,this.securityService=Object.resolve(g),
this.resourceService=Object.resolve(h),this.formatter=Object.resolve(i),this.translator=Object.resolve(j),this.meridiumResourceLoaded=Object.resolve(k),this.loginManager=Object.resolve(r)}s.prototype.start=function(){Object.abstractMethod("start")},s.prototype.showPrompt=function(){return!1},s.prototype.login=function(){},s.prototype.dispose=function(){this.meridiumResourceLoaded.remove(),this.meridiumResourceLoaded=null,this.translator=null,this.formatter=null,this.resourceService=null,this.securityService=null},s.prototype.onMeridiumResourceLoaded=function(){this.meridiumResourceLoaded.raise(this,{})},s.prototype.newSession=function(a){this.initSession(a),e.info("Logged in, new session:",a)},s.prototype.initSession=function(a){var b=t(this);a=this.loginManager.overrideApiServer(a,b),this.loginManager.setContextSession(a),this.loginManager.saveSession(a),this.loginManager.registerAjaxClientWithSession(a),this.loginManager.setLocalStorageUserDataSourceApiServer(a,b)};function t(a){
return a.vm.apiServer()}s.prototype.setAjaxClientServerFromVm=function(){this.vm.setAjaxClientServerFromVm()},s.prototype.loadUser=function(a){this.loginManager.saveUserCulture(a);var b=new q,c=this.loginManager.getUser().catch(this.loginManager.onFailedUserLoad).then(b.checkForExpiredLicense.bind(null,a)).then(this.loginManager.setContextUser).then(this.loginManager.registerAjaxClientWithUser).then(v.bind(null,this))
;c&&c.then(this.loginManager.getSites.bind(null,this)).catch(this.loginManager.onFailedSitesLoad.bind(null,a)).then(this.loginManager.setSitesCount).then(A.bind(null,this),A.bind(null,this)).then(F).then(z.bind(null,this),z.bind(null,this)).catch(C).then(B.bind(null,this)).then(D.bind(null,this),D.bind(null,this)).catch(G).then(E).then(H.bind(null,this),H.bind(null,this)).then(I).then(J.bind(null,this,a)).catch(O).then(this.setTranslatorLocale.bind(this)).then(this.onMeridiumResourceLoaded.bind(this)).then(L.bind(null,this,a)).then(u.bind(null,this,a)).catch(P.bind(null,this)).finally(this.vm.hideBusy.bind(this.vm))};function u(a,b){void 0!==window.nav&&void 0!==window.nav.preferences&&void 0!==window.nav.preferences.SystemOfMeasure&&a.loginManager.getUser().done(function(b){b.uomConversionSetId!==window.nav.preferences.SystemOfMeasure&&(b.uomConversionSetId=window.nav.preferences.SystemOfMeasure,a.securityService.putUser(b).done(function(){}).fail(function(){}))}).fail(function(){})}
function v(a){if(y())return x();w(a)}function w(a){l.showOk(a.translator.translate("LOGIN_NO_LOCAL_STORAGE_MESSAGE"),a.translator.translate("LOGIN_FAILED"))}function x(){return b.resolve(d.initialize())}function y(){try{localStorage.setItem("__test","data")}catch(a){if(/QUOTA_?EXCEEDED/i.test(a.name))return!1}return!0}function z(a){var c=f.user,d=c.cultureId;return b.resolve(a.resourceService.getGlobalizeResource(new n(d)))}function A(a){return b.resolve(a.securityService.getHostingEnv())}function B(a,b){a.formatter.setCulture(b)}function C(a){e.error("Failed to load globalize.js resource file:",a)}function D(a){var c=f.user,d=new n(c.cultureId);return b.resolve(a.resourceService.getDateTimeResource(d))}function E(a){p.setCulture(a)}function F(a){f.hostingEnvironment=a}function G(a){e.error("Failed to load date time picker resource file:",a)}function H(a){return b.resolve(a.securityService.getLicensedModules())}function I(a){f.licensedModules=a}function J(a,c){
return b.resolve(a.getMeridiumResource(c.licensedCultureId))}s.prototype.getMeridiumResource=function(a){var b=new n(a);return this.resourceService.getMeridiumResource(b)},s.prototype.setTranslatorLocale=function(a){this.translator.setLocale(a),K(a)};function K(a){(new m).isMobileApp()&&(o.locale=a)}function L(a,b){return f.user.mustChangePassword?M(a):N(a,b),null}function M(a){a.vm.switchToChangePasswordForm()}function N(a,b){a.loginDeferred.resolve(b)}function O(a){e.error("Error loading locale:",a)}function P(a){return a.loginDeferred.resolve(),b.reject()}s.prototype.notifySessionNotFound=function(a){Q(this,a,this.translator.translate("LOGIN_FAILED")),R(this,a),T()};function Q(a,b,c){b.responseText?l.showOk(b.responseText,c):l.showOk(a.translator.translate("SERVER_NOT_FOUND"),c)}function R(a,b){var c=S(a);d.pushContext("logSessionNotFound"),e.warn("Failed login:",c,b),d.popContext()}function S(a){return{datasource:a.vm.datasource()?a.vm.datasource().id:"",username:a.vm.userId()}}
function T(){f.session=null,f.user=null}s.prototype.changePassword=function(a,b){return 0===a.length?ba(this):a!==b?ca(this):void U(this,a)};function U(a,b){a.vm.showBusy(),a.loginManager.getUser().then(V.bind(null,a,b)).catch(a.vm.hideBusy.bind(a.vm)).catch($.bind(null,a))}function V(a,b,c){c=W(c,b),c.unhashedPassword=a.vm.password(),Z(a,c).done(P.bind(null,a)).fail($.bind(null,a)).always(a.vm.hideBusy.bind(a.vm))}function W(a,b){return a=X(a),a.newPassword=b,a.mustChangePassword=!1,a}function X(b){return a.forEach(b,Y),b}function Y(b,c,d){a.isArray(b)&&(d[c]=null)}function Z(a,b){return a.securityService.changePassword(b)}function $(a,b){_(a,b),aa(a,b)}function _(a,b){Q(a,b,a.translator.translate("CHANGE_PASSWORD_FAILED"))}function aa(a,b){var c=S(a);d.pushContext("logChangePasswordFailed"),e.error("Change password failed:",c,b),d.popContext()}function ba(a){l.showOk(a.translator.translate("NEW_PASSWORD_IS_REQUIRED"),a.translator.translate("CHANGE_PASSWORD"))}function ca(a){
l.showOk(a.translator.translate("PASSWORDS_DONT_MATCH"),a.translator.translate("CHANGE_PASSWORD"))}return s});
define('security/model/saved-session-login-strategy',['require','exports','module','mi-assert','system/diagnostics/log-manager','./i-login-strategy','./base-login-strategy','./saved-session'],function(require,exports,module){"use strict";var a=require("mi-assert"),b=require("system/diagnostics/log-manager"),c=b.getLogger(module.id),d=require("./i-login-strategy"),e=require("./base-login-strategy"),f=require("./saved-session");function g(b){h.call(this,b),a.implementsInterface(this,d,module.id)}var h=Object.inherit(e,g);g.prototype.start=function(){var a=f.getSession(),b=i(a);c.info("Reusing existing session",b),this.initSession(b),this.loadUser(b)};function i(b){return a.stringNotEmpty(b,"sessionData"),JSON.parse(b)}return g});
define('security/model/sso-logout-strategy',['require','exports','module','mi-assert','./i-login-strategy','./base-login-strategy'],function(require,exports,module){"use strict";var a=require("mi-assert"),b=require("./i-login-strategy"),c=require("./base-login-strategy");function d(c){e.call(this,c),a.implementsInterface(this,b,module.id)}var e=Object.inherit(c,d);return d.prototype.showPrompt=function(){return!1},d.prototype.start=function(){window.location.href="sso-logout.html"},d});
define('security/model/sso-login-strategy',['require','exports','module','mi-assert','./i-login-strategy','./base-login-strategy'],function(require,exports,module){"use strict";var a=require("mi-assert"),b=require("./i-login-strategy"),c=require("./base-login-strategy");function d(c){e.call(this,c),a.implementsInterface(this,b,module.id)}var e=Object.inherit(c,d);d.prototype.showPrompt=function(){return!1},d.prototype.start=function(){var a=f();g(),h(this,a).done(this.setAjaxClientServerFromVm.bind(this)).done(i.bind(null,this)).done(this.newSession.bind(this)).done(this.loadUser.bind(this)).fail(this.notifySessionNotFound.bind(this))};function f(){return window.name}function g(){window.name=""}function h(a,b){return a.securityService.getSession(b)}function i(a,b){b.apiServer=a.vm.apiServer()}return d});
define('security/model/predix-login-strategy',['require','exports','module','mi-assert','system/diagnostics/log-manager','./i-login-strategy','application/application-context','./base-login-strategy','system/ui/message-box','system/globalization/culture-list','./saved-session'],function(require,exports,module){"use strict";var a=require("mi-assert"),b=require("system/diagnostics/log-manager"),c=b.getLogger(module.id),d=require("./i-login-strategy"),e=require("application/application-context"),f=require("./base-login-strategy"),g=require("system/ui/message-box"),h=require("system/globalization/culture-list"),i=require("./saved-session");function j(b){k.call(this,b),a.implementsInterface(this,d,module.id)}var k=Object.inherit(f,j);j.prototype.start=function(){var a=s(),b=i.getUserCulture();t(),u(this,a).done(this.setAjaxClientServerFromVm.bind(this)).done(v.bind(null,this)).done(q.bind(null,this,b)).done(r.bind(null,this)).done(this.onMeridiumResourceLoaded.bind(this)).done(this.initSession.bind(this)).done(this.loadUser.bind(this)).fail(this.notifySessionNotFound.bind(this))},j.prototype.notifySessionNotFound=function(a){l(this,a,this.translator.translate("LOGIN_FAILED")),n(this,a),p()};function l(a,b,c){
var d=b.responseText?b.responseText:a.translator.translate("SERVER_NOT_FOUND");g.showOk(d,c).done(m)}function m(){e.isAppHub?window.location="/logout":window.location=window.location.href.split("#")[0]}function n(a,d){var e=o(a);b.pushContext("logSessionNotFound"),c.warn("Failed login:",e,d),b.popContext()}function o(a){return{datasource:a.vm.datasource()?a.vm.datasource().id:"",username:a.vm.userId()}}function p(){e.session=null,e.user=null}function q(a,b){var c=new h(b);return a.resourceService.getMeridiumResource(c)}function r(a,b){a.translator.setLocale(b)}function s(){return window.MeridiumSessionID}function t(){window.MeridiumSessionID=""}function u(a,b){return a.securityService.getSession(b)}function v(a,b){b.apiServer=a.vm.apiServer()}return j});
define('security/offline-login/api/storage/offline-login-cache',['require','jquery','localforage','application/application-context','ramda'],function(require){"use strict";var a=require("jquery"),b=require("localforage"),c=require("application/application-context"),d=require("ramda"),e="login";function f(){}f.prototype.setCache=function(){return b.getItem(e).then(i)},f.prototype.getCache=function(){return b.getItem(e)};function g(){var a=d.clone(c.session);h()&&(a.id="00000000-0000-0000-0000-000000000000");var b={},e={users:{},licensedModules:c.licensedModules,lockoutTimeout:a.lockoutTimeout,lockoutAttempts:a.lockoutAttempts},f={user:c.user,session:a,lastUpdated:Date.now(),lockoutAttempts:a.lockoutAttempts,lockedOutUntil:null},g={};return e.users[c.user.id]=f,g[a.datasourceId.toUpperCase()]=e,b[a.apiServer.toUpperCase()]={users:g},b}function h(){return!!window.PredixSDK}function i(a){return b.setItem(e,j(a))}function j(a){return k(g(),a)}function k(b,c){return a.extend(!0,{},c,b)}return f});
define('security/offline-login/api/storage/offline-datasources',['require','lodash','localforage','bluebird','application/application-context'],function(require){"use strict";var a=require("lodash"),b=require("localforage"),c=require("bluebird"),d=require("application/application-context"),e="login";function f(){}f.prototype.setOfflineDatasources=function(a){return b.getItem(e).then(j.bind(null,a))},f.prototype.getDatasources=function(a){return b.getItem(e).then(g.bind(null,a))};function g(b,c){if(c&&c[b])return a.values(c[b].users)}f.prototype.getLicensedModules=function(a,c){return b.getItem(e).then(h.bind(null,a,c))};function h(a,b,c){return c[a].users[b].licensedModules}function i(a){for(var b=[],c=0;c<a.length;c++)b.push(a[c].id.toUpperCase());return b}function j(a,c){if(a){for(var f=d.session.apiServer.toUpperCase(),g=i(a),h=0;h<g.length;h++)c[f].users[g[h]]?c[f].users[g[h]].datasourceInfo=a[h]:c[f].users[g[h]]={datasourceInfo:a[h]};return b.setItem(e,c)}}f.prototype.getLockoutTimeout=function(a,c){return b.getItem(e).then(k.bind(null,a,c))};function k(a,b,d){return d?d[a].users[b].lockoutTimeout:c.reject()}
return f});
define('security/offline-login/api/storage/offline-users',['require','localforage','bluebird'],function(require){"use strict";var a=require("localforage"),b=require("bluebird"),c="login";function d(){}d.prototype.getUsersByDatasource=function(b,d){return a.getItem(c).then(e.bind(null,b,d))};function e(a,b,c){return c[a].users[b].users}d.prototype.getUser=function(b,d,e){return a.getItem(c).then(f.bind(null,b,d,e))};function f(a,b,c,d){return d[a].users[b].users[c]}d.prototype.decrementAttemptsLeft=function(b,d,e){return a.getItem(c).then(g.bind(null,b,d,e))};function g(d,e,f,g){return g?(g[d].users[e].users[f].lockoutAttempts--,a.setItem(c,g)):b.reject()}d.prototype.getUserLockoutDate=function(b,d,e){return a.getItem(c).then(h.bind(null,b,d,e))};function h(a,c,d,e){return e?e[a].users[c].users[d].lockedOutUntil:b.reject()}d.prototype.setUserLockoutDate=function(b,d,e,f){return a.getItem(c).then(i.bind(this,b,d,e,f))};function i(d,e,f,g,h){return h?(h[e].users[f].users[g].lockedOutUntil=d,a.setItem(c,h)):b.reject()}d.prototype.resetUserAttempts=function(b,d,e){
return a.getItem(c).then(j.bind(null,b,d,e))};function j(d,e,f,g){return g?(g[d].users[e].users[f].lockoutAttempts=g[d].users[e].lockoutAttempts,a.setItem(c,g)):b.reject()}d.prototype.getUserAttemptsLeft=function(b,d,e){return a.getItem(c).then(k.bind(null,b,d,e))};function k(a,c,d,e){return e?e[a].users[c].users[d].lockoutAttempts:b.reject()}return d});
define('security/offline-login/api/storage/offline-login-config',['require','localforage'],function(require){"use strict";var a=require("localforage"),b="meridium-offline";function c(){}c.prototype.setupOfflineStorageTables=function(){d()};function d(){var c={name:b};a.config(c)}return c});
define('security/offline-login/security/password-encryption',['require','sjcl'],function(require){"use strict";var a=require("sjcl");function b(){}b.prototype.getEncryptedPassword=function(a,b){return c(b+c(a))};function c(b){return a.codec.hex.fromBits(a.hash.sha256.hash(b))}return b});
define('security/offline-login/api/storage/offline-credentials',['require','localforage','bluebird','security/offline-login/security/password-encryption'],function(require){"use strict";var a=require("localforage"),b=require("bluebird"),c=require("security/offline-login/security/password-encryption"),d="login";function e(){}e.prototype.setPassword=function(e,g,h,i){var j=new c,k=j.getEncryptedPassword(h,i);return i?a.getItem(d).then(f.bind(null,e,g,h,k)):b.resolve()};function f(b,c,e,f,g){if(g)return g[b].users[c].users[e].password=f,a.setItem(d,g)}e.prototype.getPassword=function(b,c,e){return a.getItem(d).then(g.bind(null,b,c,e))};function g(a,c,d,e){return e&&e[a].users[c].users[d]?e[a].users[c].users[d].password:b.reject()}return e});
define('security/offline-login/api/storage/offline-user-expiration',['require','localforage'],function(require){"use strict";var a=require("localforage"),b="login",c=2592e6;function d(){this.cache=null,this.cacheObjectKeys=null,this.currentApiServer=null,this.currentDatasource=null,this.currentDatasourceUserKey=null}d.prototype.deleteExpiredUsers=function(a){return a.then(e.bind(null,this))};function e(a,b){a.cache=b,a.cacheObjectKeys=Object.keys(a.cache);for(var c=0;c<a.cacheObjectKeys.length;c++)a.currentApiServer=a.cache[a.cacheObjectKeys[c]],a.currentDatasource=a.currentApiServer.users,f(a);return k(a)}function f(a){for(var b=0;b<Object.keys(a.currentDatasource).length;b++){a.currentDatasourceUserKey=Object.keys(a.currentDatasource)[b];a.currentDatasource[a.currentDatasourceUserKey].users&&g(a)}}function g(a){for(var b=Object.keys(a.currentDatasource[a.currentDatasourceUserKey].users),c=a.currentDatasource[a.currentDatasourceUserKey].users,d=0;d<b.length;d++){var e=Object.keys(a.currentApiServer.users[a.currentDatasourceUserKey].users)[d];c&&h(a,e)}}function h(a,b){
var c=a.currentApiServer.users[a.currentDatasourceUserKey].users[b],d;c&&(d=a.currentApiServer.users[a.currentDatasourceUserKey].users[b].lastUpdated,i(a,d,b))}function i(a,b,c){b<l()&&j(a,c)}function j(a,b){a.currentApiServer.users[a.currentDatasourceUserKey].users[b]=null}function k(c){return a.setItem(b,c.cache)}function l(){return(new Date).getTime()-c}return d});
define('security/offline-login/api/storage/offline-globalization',['require','localforage','application/application-context','bluebird'],function(require){"use strict";var a=require("localforage"),b=require("application/application-context"),c=require("bluebird"),d="login";function e(){}e.prototype.setOfflineTranslations=function(b){return a.getItem(d).then(h.bind(null,b))},e.prototype.getOfflineTranslations=function(b,c,e){return a.getItem(d).then(f.bind(null,b,c,e))};function f(a,b,c,d){var e=g(d[a].users[b],c);return d[a].users[b].translations[e]}function g(a,b){return a.users[b].session.licensedCultureId}function h(e,f){if(f){var g=b.session.apiServer.toUpperCase(),h=b.session.datasourceId.toUpperCase(),i=b.session.licensedCultureId;return f[g].users[h].translations||(f[g].users[h].translations={}),f[g].users[h].translations[i]=e,a.setItem(d,f)}return c.resolve()}return e});
define('security/offline-login/api/offline-login-api',['require','security/offline-login/api/storage/offline-login-cache','security/offline-login/api/storage/offline-datasources','security/offline-login/api/storage/offline-users','security/offline-login/api/storage/offline-login-config','security/offline-login/api/storage/offline-credentials','security/offline-login/api/storage/offline-user-expiration','security/offline-login/api/storage/offline-globalization'],function(require){"use strict";var a=require("security/offline-login/api/storage/offline-login-cache"),b=require("security/offline-login/api/storage/offline-datasources"),c=require("security/offline-login/api/storage/offline-users"),d=require("security/offline-login/api/storage/offline-login-config"),e=require("security/offline-login/api/storage/offline-credentials"),f=require("security/offline-login/api/storage/offline-user-expiration"),g=require("security/offline-login/api/storage/offline-globalization");function h(){}return h.prototype.setOfflineLoginConfig=function(){(new d).setupOfflineStorageTables()},h.prototype.setOfflineCache=function(){return(new a).setCache()},h.prototype.setPassword=function(a,b,c,d){return(new e).setPassword(a.toUpperCase(),b.toUpperCase(),c,d)},h.prototype.getPassword=function(a,b,c){return(new e).getPassword(a.toUpperCase(),b.toUpperCase(),c)},h.prototype.setOfflineTranslations=function(a){return(new g).setOfflineTranslations(a)},
h.prototype.setOfflineDatasources=function(a){return(new b).setOfflineDatasources(a)},h.prototype.getTranslations=function(a,b,c){return(new g).getOfflineTranslations(a.toUpperCase(),b.toUpperCase(),c)},h.prototype.getDatasources=function(a){return(new b).getDatasources(a.toUpperCase())},h.prototype.getUsersByDatasource=function(a,b){return(new c).getUsersByDatasource(a.toUpperCase(),b.toUpperCase())},h.prototype.getUser=function(a,b,d){return(new c).getUser(a.toUpperCase(),b.toUpperCase(),d)},h.prototype.getLicensedModules=function(a,c){return(new b).getLicensedModules(a.toUpperCase(),c.toUpperCase())},h.prototype.deleteExpiredUsers=function(){var b=new f,c=new a;return b.deleteExpiredUsers(c.getCache())},h.prototype.getAttemptsLeft=function(a,b,d){return(new c).getUserAttemptsLeft(a.toUpperCase(),b.toUpperCase(),d)},h.prototype.decrementAttemptsLeft=function(a,b,d){return(new c).decrementAttemptsLeft(a.toUpperCase(),b.toUpperCase(),d)},h.prototype.resetUserAttempts=function(a,b,d){
return(new c).resetUserAttempts(a.toUpperCase(),b.toUpperCase(),d)},h.prototype.getUserLockoutDate=function(a,b,d){return(new c).getUserLockoutDate(a.toUpperCase(),b.toUpperCase(),d)},h.prototype.setUserLockoutDate=function(a,b,d,e){return(new c).setUserLockoutDate(a,b.toUpperCase(),d.toUpperCase(),e)},h.prototype.getLockoutTimeout=function(a,c){return(new b).getLockoutTimeout(a.toUpperCase(),c.toUpperCase())},h});
define('security/offline-login/security/loaders/offline-session-loader',['require','system/http/ajax-client','security/model/saved-session','security/model/login-manager','application/application-context'],function(require){"use strict";var a=require("system/http/ajax-client"),b=require("security/model/saved-session"),c=require("security/model/login-manager"),d=require("application/application-context");function e(){}return e.prototype.loadSession=function(a){var b=Object.resolve(c);b.setContextSession(a),b.saveSession(a),b.registerAjaxClientWithSession(a),b.setLocalStorageUserDataSourceApiServer(a)},e});
define('security/offline-login/security/loaders/offline-user-loader',['require','system/http/ajax-client','security/offline-login/api/offline-login-api','system/collections/key-id-list','system/text/formatter','system/diagnostics/log-manager','system/ui/message-box','ui/elements/date-time/date-time-control','system/lang/event','system/globalization/translator','security/model/login-manager','application/application-context','bluebird'],function(require){"use strict";var a=require("system/http/ajax-client"),b=require("security/offline-login/api/offline-login-api"),c=require("system/collections/key-id-list"),d=require("system/text/formatter"),e=require("system/diagnostics/log-manager"),f=require("system/ui/message-box"),g=require("ui/elements/date-time/date-time-control"),h=require("system/lang/event"),i=require("system/globalization/translator"),j=require("security/model/login-manager"),k=require("application/application-context"),l=require("bluebird");function m(){this.meridiumResourceLoaded=Object.resolve(h)}m.prototype.loadUser=function(a,b,c){var d=Object.resolve(j);d.setContextUser(a.user),d.registerAjaxClientWithUser(),v(this);var e=[n(this,b,c,a),o(b,c)];return l.all(e)};function n(a,b,c,d){var e=d.session.licensedCultureId,f=d.user.id;return q(e),u(e),r(a,b,c,f)}function o(a,c){return(new b).getLicensedModules(a,c).then(p)}function p(a){k.licensedModules=new c(a.items)}function q(a){
Object.resolve(d).setCulture(a)}function r(a,c,d,e){return(new b).getTranslations(c,d,e).then(s.bind(null,a))}function s(a,b){Object.resolve(i).setLocale(b),t(a)}function t(a){a.meridiumResourceLoaded.raise(a,{})}function u(a){g.setCulture(a)}function v(a){x()?e.initialize():w(a)}function w(a){f.showOk(a.translator.translate("LOGIN_NO_LOCAL_STORAGE_MESSAGE"),a.translator.translate("LOGIN_FAILED"))}function x(){try{localStorage.setItem("__test","data")}catch(a){if(/QUOTA_?EXCEEDED/i.test(a.name))return!1}return!0}return m});
define('security/model/predix-mobile-login-strategy',['require','exports','module','mi-assert','./i-login-strategy','./base-login-strategy','./predix-login-strategy','bluebird','security/offline-login/api/offline-login-api','security/offline-login/security/loaders/offline-session-loader','security/offline-login/security/loaders/offline-user-loader','ramda','system/http/predix-mobile-ajax-client','application/application-context','application/application-events','localforage','security/view-models/application-reset'],function(require,exports,module){"use strict";var a=require("mi-assert"),b=require("./i-login-strategy"),c=require("./base-login-strategy"),d=require("./predix-login-strategy"),e=require("bluebird"),f=require("security/offline-login/api/offline-login-api"),g=require("security/offline-login/security/loaders/offline-session-loader"),h=require("security/offline-login/security/loaders/offline-user-loader"),i=require("ramda"),j=require("system/http/predix-mobile-ajax-client"),k=require("application/application-context"),l=require("application/application-events"),m=require("localforage"),n=require("security/view-models/application-reset");function o(c,d){p.call(this,c),a.implementsInterface(this,b,module.id),c.preLoginViewModel&&(this.unifiedHostURL=c.preLoginViewModel.serverUrl,this.tenantAlias=c.preLoginViewModel.tenantAlias),this.predixLoginStrategy=d,this.appEvents=Object.resolve(l)}var p=Object.inherit(c,o);o.prototype.start=function(){
var a=new PredixSDK.AuthenticationConfiguration(PredixSDK.AuthenticationModes.TMS),b=this.unifiedHostURL()||"",c=this.tenantAlias()||"";a.setHostURL(i.trim(b)),a.setTenantAlias(i.trim(c));var d=new PredixSDK.AuthenticationManager;q(d,a).then(u.bind(null,d)).then(v).then(w.bind(null,this)).then(x.bind(null,this)).then(r).then(s.bind(null,this.vm)).then(H).then(t.bind(null,this.vm)).catch(M).then(y).then(z.bind(null,this)).catch(E.bind(null,this))};function q(a,b){return new e(function(c,d){a.initialize(b,c,d)})}function r(){return new e(function(a,b){PredixSDK.getSetting("hosturl",a,b)})}function s(a,b){a.apiServer(b),a.setAjaxClientServerFromVm()}function t(a,b){j.addAjaxOption("tenant",b)}function u(a){return new e(function(b,c){a.authenticate(b,c)})}function v(a){console.log("success: "+a),PredixSDK.user.hasStoredOfflineCredential(L)}function w(a){m.setItem("serverUrl",a.unifiedHostURL())}function x(a){m.setItem("tenantAlias",a.tenantAlias())}function y(){return new e(function(a,b){
PredixSDK.queryConnectivity(a,b)})}function z(a,b){if(C(b))return void B(a);D(b)&&(A(a),e.all([r(),G(),H()]).then(F.bind(null,a)))}function A(a){k.connectionStatus.connected=!1,k.connectionStatus.lastStatusChange=new Date,a.appEvents.connectionChanged.raise(a,k.connectionStatus)}function B(a){a.predixLoginStrategy.start.call(a.predixLoginStrategy)}function C(a){return i.contains("Online",a)}function D(a){return i.contains("OfflineAuthenticated",a)}function E(a){e.all([r(),G(),H()]).then(F.bind(null,a))}function F(a,b){var c=b[0],d=b[1],e=b[2];(new f).getUser(c,e,d).then(I.bind(null,a,c,e))}function G(){return new e(function(a,b){PredixSDK.user.username(a,b)})}function H(){return new e(function(a,b){PredixSDK.getSetting("tmstenantid",a,b)})}function I(a,b,c,d){J(d.session),K(a,b,c,d)}function J(a){(new g).loadSession(a)}function K(a,b,c,d){(new h).loadUser(d,b,c).then(a.vm.loginDeferred.resolve(d.session))}function L(a){console.log("isUserSetup: "+a),
a||PredixSDK.showPageInSeparateWebView("app%2Fpredix-mobile%2Fofflinesetup.html","Offline Setup")}function M(a){console.log("authentication failed with message: "+a),N()&&O()}function N(){return i.contains("Canceled")}function O(){(new n).reset()}return o});
define('security/services/datasource-dto',['system/lang/converter'],function(){"use strict";var a=require("system/lang/converter");function b(b){b=b||{},this.alias=a.toString(b.alias),this.assetServiceURL=a.toString(b.assetServiceURL),this.basicAuthKey=a.toNullableString(b.basicAuthKey),this.databaseName=a.toString(b.databaseName),this.databaseType=a.toString(b.databaseType),this.description=a.toString(b.description),this.hostName=a.toString(b.hostName,"*"),this.id=a.toString(b.id),this.isDefault=a.toBoolean(b.isDefault),this.isOffline=a.toBoolean(b.isOffline),this.oraclehost=a.toString(b.oracleHost),this.oracleport=a.toString(b.oraclePort),this.oracleservice=a.toString(b.oracleService),this.password=a.toString(b.password),this.preloadcache=a.toBoolean(b.preLoadCache),this.serverName=a.toString(b.serverName),this.stuffServiceURL=a.toString(b.stuffServiceURL),this.timeSeriesURL=a.toNullableString(b.timeSeriesURL),this.alertServiceURL=a.toNullableString(b.alertServiceURL),this.templateServiceURL=a.toNullableString(b.templateServiceURL),
this.uaaServiceURL=a.toString(b.uaaServiceURL),this.userId=a.toString(b.userId),this.displayName=this.description||this.id,this.shortDisplayName=this.displayName.length>25?this.displayName.substring(0,35)+"...":this.displayName}return b.fromDataCollection=function a(c){var d,e=[];for(d=0;d<c.length;d++)e[e.length]=new b(c[d]);return e},b});
define('security/services/host-dto',[],function(){"use strict";function a(a){a=a||{},this.id=a.id||"",this.name=a.name,this.idpUrl=a.idpUrl||"",this.ssoAuthEnabled=a.ssoAuthEnabled||!1}return a.fromDataCollection=function b(c){var d,e=[];for(d=0;d<c.length;d++)e[e.length]=new a(c[d]);return e},a});
define('security/services/datasource-service',['require','jquery','system/http/ajax-client','./datasource-dto','./host-dto'],function(require){"use strict";var a=require("jquery"),b=require("system/http/ajax-client"),c=require("./datasource-dto"),d=require("./host-dto"),e="api/core/hostname",f="api/core/hostname/filtered",g="api/core/datasource",h="api/core/datasourceFullFiltered",i="api/core/datasourceFiltered";function j(a){this.ajaxClient=a}return j.dependsOn=[b],j.prototype.getFilteredDatasources=function(b){var d=b.toLowerCase().replace("https://","").replace("http://",""),e=void 0===b?"?host=*":"?host="+d,f=a.Deferred(),g=i+e;return this.ajaxClient.get(g).done(function(a){f.resolve(c.fromDataCollection(a))}).fail(function(a){f.reject(a)}),f.promise()},j.prototype.getFullFilteredDatasources=function(b){var d=void 0===b?"?host=*":"?host="+b,e=a.Deferred(),f=h+d;return this.ajaxClient.get(f).done(function(a){e.resolve(c.fromDataCollection(a))}).fail(function(a){e.reject(a)}),e.promise()},j.prototype.getDatasources=function(b){var d=void 0===b?"":"?loadFactor=1",e=a.Deferred(),f=g+d
;return this.ajaxClient.get(f).done(function(a){e.resolve(c.fromDataCollection(a))}).fail(function(a){e.reject(a)}),e.promise()},j.prototype.getHosts=function(b){var c=a.Deferred(),f=e;return this.ajaxClient.get(f).done(function(a){c.resolve(d.fromDataCollection(a))}).fail(function(a){c.reject(a)}),c.promise()},j.prototype.getFilteredHost=function(b){var c="?host="+b,e=a.Deferred(),g=f+c;return this.ajaxClient.get(g).done(function(a){e.resolve(d.fromDataCollection(a))}).fail(function(a){e.reject(a)}),e.promise()},j.prototype.getHost=function(b){var c="?id="+b,f=a.Deferred(),g=e+c;return this.ajaxClient.get(g).done(function(a){f.resolve(new d(a))}).fail(function(a){f.reject(a)}),f.promise()},j.prototype.putHost=function(b){var c=a.Deferred();return this.ajaxClient.put(e,b).done(function(a){c.resolve(a)}).fail(function(a){c.reject(a)}),c.promise()},j.prototype.deleteHost=function(b){var c=a.Deferred();return this.ajaxClient.delete(e+"?id="+b).done(function(a){c.resolve(a)
}).fail(function(a){c.reject(a)}),c.promise()},j.prototype.testDatasource=function(b){var c=a.Deferred();return this.ajaxClient.post(g+"/test",b).done(function(a){c.resolve(a)}).fail(function(a){c.reject(a)}),c.promise()},j.prototype.postDatasource=function(b){var c=a.Deferred();return this.ajaxClient.post(g,b).done(function(a){c.resolve(a)}).fail(function(a){c.reject(a)}),c.promise()},j.prototype.postAndTestDatasource=function(b){var c=a.Deferred();return this.ajaxClient.post(g+"/createandtest",b).done(function(a){c.resolve(a)}).fail(function(a){c.reject(a)}),c.promise()},j.prototype.putDatasource=function(b){var c=a.Deferred();return this.ajaxClient.put(g,b).done(function(a){c.resolve(a)}).fail(function(a){c.reject(a)}),c.promise()},j.prototype.deleteDatasource=function(b){var c=a.Deferred();return this.ajaxClient.delete(g+"?id="+b.id).done(function(a){c.resolve(a)}).fail(function(a){c.reject(a)}),c.promise()},j});
define('security/offline-login/security/offline-security',['require','security/offline-login/api/offline-login-api','security/offline-login/security/password-encryption','system/ui/message-box','security/offline-login/security/loaders/offline-session-loader','security/offline-login/security/loaders/offline-user-loader','security/offline-login/context/offline-login-context','system/lang/private'],function(require){"use strict";var a=require("security/offline-login/api/offline-login-api"),b=require("security/offline-login/security/password-encryption"),c=require("system/ui/message-box"),d=require("security/offline-login/security/loaders/offline-session-loader"),e=require("security/offline-login/security/loaders/offline-user-loader"),f=require("security/offline-login/context/offline-login-context"),g=require("system/lang/private");function h(a,b,c,d,e){g(this).apiServer=a,g(this).datasource=b,g(this).userId=c,g(this).password=d,g(this).loginDeferredObject=e}h.prototype.login=function(){var b=new a
;b.getAttemptsLeft(g(this).apiServer,g(this).datasource,g(this).userId).then(i.bind(null,this)).then(b.getUserLockoutDate.bind(null,g(this).apiServer,g(this).datasource,g(this).userId)).then(j.bind(null,this)).then(b.getLockoutTimeout.bind(null,g(this).apiServer,g(this).datasource,g(this).userId)).then(k.bind(null,this)).then(b.deleteExpiredUsers()).then(b.getPassword.bind(null,g(this).apiServer,g(this).datasource,g(this).userId)).then(l.bind(null,this)).catch(r)};function i(a,b){g(a).attemptsLeft=b}function j(a,b){g(a).lockedOutUntil=b}function k(a,b){g(a).lockoutTimeout=b}function l(c,d){var e=new b,f=e.getEncryptedPassword(g(c).userId,g(c).password);if(m(c))return void o();if(d===f){var h=new a;h.setUserLockoutDate(null,g(c).apiServer,g(c).datasource,g(c).userId).then(h.resetUserAttempts.bind(null,g(c).apiServer,g(c).datasource,g(c).userId)).then(p.bind(null,c))}else r()}function m(b){if(null!==g(b).lockedOutUntil&&void 0!==g(b).lockedOutUntil){
if(g(b).lockedOutUntil>Date.now())return!0;var c=new a;return c.setUserLockoutDate(null,g(b).apiServer,g(b).datasource,g(b).userId).then(c.resetUserAttempts.bind(null,g(b).apiServer,g(b).datasource,g(b).userId)),!1}return g(b).attemptsLeft<0&&(n(b),!0)}function n(b){var c=new Date,d=new Date(c.getTime()+60*g(b).lockoutTimeout*1e3);(new a).setUserLockoutDate(d,g(b).apiServer,g(b).datasource,g(b).userId)}function o(){c.showOk("User account is locked due to exceeding password attempt limit","User locked out")}function p(b){var c=new a;q(g(b).password),c.getUser(g(b).apiServer,g(b).datasource,g(b).userId).then(s.bind(null,b)).then(g(b).loginDeferredObject.resolve())}function q(a){f.user.password=a}function r(a){c.showOk("Credentials cannot be authenticated because the Datasource ID, User ID, or Password are invalid. You must login while online at least once to enable offline login functionality","Offline Login Failed")}function s(a,b){t(b.session),u(a,b)}function t(a){
(new d).loadSession(a)}function u(a,b){(new e).loadUser(b,g(a).apiServer,g(a).datasource)}return h});
define('security/model/prompt-login-strategy',['require','exports','module','mi-assert','system/diagnostics/log-manager','./i-login-strategy','./base-login-strategy','./saved-session','system/ui/message-box','security/services/datasource-service','security/offline-login/security/offline-security','security/offline-login/context/offline-login-context','security/offline-login/api/offline-login-api','system/hardware/device','system/globalization/culture-list'],function(require,exports,module){"use strict";var a=require("mi-assert"),b=require("system/diagnostics/log-manager"),c=b.getLogger(module.id),d=require("./i-login-strategy"),e=require("./base-login-strategy"),f=require("./saved-session"),g=require("system/ui/message-box"),h=require("security/services/datasource-service"),i=require("security/offline-login/security/offline-security"),j=require("security/offline-login/context/offline-login-context"),k=require("security/offline-login/api/offline-login-api"),l=require("system/hardware/device"),m=require("system/globalization/culture-list");function n(b){o.call(this,b),this.datasourceService=Object.resolve(h),a.implementsInterface(this,d,module.id)}var o=Object.inherit(e,n);n.prototype.showPrompt=function(){return!0},n.prototype.start=function(){var a=f.getUserCulture();this.vm.initUserId(),this.vm.initApiServer(),
this.vm.apiServer()&&p(this,a).done(q.bind(null,this)).done(this.onMeridiumResourceLoaded.bind(this)).done(this.setAjaxClientServerFromVm.bind(this)).done(s.bind(null,this)).fail(r)};function p(a,b){var c=new m(b);return a.resourceService.getMeridiumResource(c)}function q(a,b){a.translator.setLocale(b)}function r(a){c.error("Error loading locale:",a)}function s(a){a.datasourceService.getFilteredDatasources(a.vm.apiServer()).done(t.bind(null,a)).fail(u.bind(null,a))}function t(a,b){a.vm.datasources(b);var c,d=f.getDatasource();if(d)for(c=0;c<b.length;c++)if(b[c].id===d){a.vm.datasource(b[c]);break}a.vm.areDatasourcesLoaded(!0)}function u(a,b){(new l).isMobileApp()?v(a,b):x(b)}function v(a,b){(new k).getDatasources(a.vm.apiServer()).then(w.bind(null,b)).catch(x.bind(null,b))}function w(a,b){a||x(b)}function x(a){b.pushContext("getDatasources_fail"),g.showOk("Unable to retrieve datasources","Error"),c.error("Error loading datasources",a),b.popContext()}n.prototype.login=function(a,b,c,d){
y(this,d,a,b,c)};function y(a,b,c,d,e){a.vm.showBusy(),a.securityService.login(c,d,e).done(z.bind(null,e)).done(a.newSession.bind(a)).done(a.loadUser.bind(a)).fail(a.vm.hideBusy.bind(a.vm)).fail(a.notifySessionNotFound.bind(a))}function z(a){(new l).isMobileApp()&&(j.user.password=a)}n.prototype.loginOffline=function(a,b,c,d){(new l).isMobileApp()&&(new k).decrementAttemptsLeft(d,a,b).then(A.bind(null,this,d,a,b,c))};function A(a,b,c,d,e,f){new i(b,c,d,e,a.loginDeferred).login()}return n.prototype.ssoLoginDone=function(a){this.vm.showBusy();try{this.newSession(a),this.loadUser(a)}catch(a){console.error(a),this.notifySessionNotFound(),this.vm.hideBusy()}},n});
define('security/model/login-strategy-factory',['require','exports','module','mi-assert','system/diagnostics/log-manager','./i-login-strategy','application/application-context','./saved-session-login-strategy','./sso-logout-strategy','./sso-login-strategy','./predix-login-strategy','./predix-mobile-login-strategy','./prompt-login-strategy'],function(require,exports,module){"use strict";var a=require("mi-assert"),b=require("system/diagnostics/log-manager"),c=b.getLogger(module.id),d=require("./i-login-strategy"),e=require("application/application-context"),f=require("./saved-session-login-strategy"),g=require("./sso-logout-strategy"),h=require("./sso-login-strategy"),i=require("./predix-login-strategy"),j=require("./predix-mobile-login-strategy"),k=require("./prompt-login-strategy"),l="meridium-session";function m(){}m.singleton=!0,m.prototype.createStrategy=function(b){var c,e;return n()?(c=Object.resolve(i,b),new j(b,c)):(o()?c=Object.resolve(f,b):window.MeridiumSessionID?c=Object.resolve(i,b):q()?"change"===window.name?c=Object.resolve(k,b):(c=Object.resolve(h,b),e=s("meridium_extraURL"),history.replaceState("{}","","/Meridium/"+e)):"true"===s("ge_show_sso_logout")?(r("ge_show_sso_logout","",-1),c=Object.resolve(g,b)):c=Object.resolve(k,b),a.implementsInterface(c,d),c)};function n(){return!!window.PredixSDK}
function o(){return!!p()}function p(){try{return sessionStorage.getItem(l)}catch(a){return c.error("Failed to get sessionStorage - error:",a),!1}}function q(){return!!window.name}function r(a,b,c){var d;if(c){var e=new Date;e.setTime(e.getTime()+24*c*60*60*1e3),d="; expires="+e.toGMTString()}else d="";document.cookie=encodeURIComponent(a)+"="+encodeURIComponent(b)+d+"; path=/"}function s(a){for(var b=encodeURIComponent(a)+"=",c=document.cookie.split(";"),d=0;d<c.length;d++){for(var e=c[d];" "===e.charAt(0);)e=e.substring(1,e.length);if(0===e.indexOf(b))return decodeURIComponent(e.substring(b.length,e.length))}return null}return m});

define('text!security/views/create-datasource-dialog.html',[],function () { return '<div class="create-datasource block-group">\r\n    <section class="entry-form-column block">\r\n        <div class="form-group">\r\n            <label class="control-label"\r\n                   data-bind="text: translate(\'SEC_DATASOURCE_ID\')">\r\n            </label>\r\n            <input class="form-control text-box" data-bind="textInput: datasource().id,attr:{\'readOnly\': (isNew()==true? false :true)}" type="text" />\r\n        </div>\r\n        <div class="form-group">\r\n            <label class="control-label"\r\n                   data-bind="text: translate(\'SEC_DATASOURCE_DESCRIPTION\')">\r\n            </label>\r\n            <input class="form-control text-box" data-bind="textInput: datasource().description" type="text" />\r\n        </div>\r\n        <div class="form-group">\r\n            <label class="control-label"\r\n                   data-bind="text: translate(\'SEC_DATASOURCE_HOST\')">\r\n            </label>\r\n            <input class="form-control text-box" data-bind="textInput: datasource().hostName" type="text" />\r\n        </div>\r\n        <div class="form-group">\r\n            <label class="control-label"\r\n                   data-bind="text: translate(\'SEC_DATASOURCE_DB_TYPE\')">\r\n            </label>\r\n            <select class="form-control select" data-bind="textInput: datasource().databaseType, event: { change: selectedType } ">\r\n                <option value="0">Oracle</option>\r\n                <option value="1">SQL Server</option>\r\n            </select>\r\n        </div>\r\n        <div class="form-group">\r\n            <label class="control-label"\r\n                   data-bind="text: translate(\'SEC_DATASOURCE_DB_USER_NAME\')">\r\n            </label>\r\n            <input class="form-control text-box" data-bind="textInput: datasource().userId" type="text" />\r\n        </div>\r\n        <div class="form-group">\r\n            <label class="control-label"\r\n                   data-bind="text: translate(\'PASSWORD\')">\r\n            </label>\r\n            <input class="form-control text-box" data-bind="textInput: datasource().password" type="password" />\r\n        </div>\r\n        <div class="checkbox">\r\n            <label class="control-label">\r\n                <input data-bind="checked: datasource().preloadcache" type="checkbox" />\r\n                <span data-bind="text: translate(\'SEC_DATASOURCE_DB_PRELOAD_CACHE\')" />\r\n            </label>\r\n        </div>\r\n    </section>\r\n    <section class="entry-form-column block">\r\n        <div class="form-group">\r\n            <label class="control-label"\r\n                   data-bind="text: translate(\'SEC_DATASOURCE_DB_SERVER\')">\r\n            </label>\r\n            <input class="form-control text-box" data-bind="textInput: datasource().serverName, attr:{\'readOnly\': isOracle}" type="text" />\r\n        </div>\r\n        <div class="form-group">\r\n            <label class="control-label"\r\n                   data-bind="text: translate(\'SEC_DATASOURCE_DB_NAME\')">\r\n            </label>\r\n            <input class="form-control text-box" data-bind="textInput: datasource().databaseName, attr:{\'readOnly\': !isSqlServer()}" type="text" />\r\n        </div>\r\n        <div class="form-group">\r\n            <label class="control-label"\r\n                   data-bind="text: translate(\'SEC_DATASOURCE_DB_ALIAS\')">\r\n            </label>\r\n            <input class="form-control text-box" data-bind="textInput: datasource().alias, attr:{\'readOnly\': !isOracle()}" type="text" />\r\n        </div>\r\n        <div class="form-group">\r\n            <label class="control-label"\r\n                   data-bind="text: translate(\'SEC_DATASOURCE_ORACLE_HOST\')">\r\n            </label>\r\n            <input class="form-control text-box" data-bind="textInput: datasource().oraclehost, attr:{\'readOnly\': !isOracle()}" type="text" />\r\n        </div>\r\n        <div class="form-group">\r\n            <label class="control-label"\r\n                   data-bind="text: translate(\'SEC_DATASOURCE_ORACLE_PORT\')">\r\n            </label>\r\n            <input class="form-control text-box" data-bind="textInput: datasource().oracleport, attr:{\'readOnly\': !isOracle()}" type="text" />\r\n        </div>\r\n        <div class="form-group">\r\n            <label class="control-label"\r\n                   data-bind="text: translate(\'SEC_DATASOURCE_ORACLE_SERVICE\')">\r\n            </label>\r\n            <input class="form-control text-box" data-bind="textInput: datasource().oracleservice, attr:{\'readOnly\': !isOracle()}" type="text" />\r\n        </div>\r\n    </section>\r\n</div>\r\n<div class="create-datasource-dialog-controls pull-right">\r\n    <button type="button" class="btn btn-primary" data-bind="click: saveItem, text: translate(\'SAVE\')" />\r\n    <button type="button" class="btn btn-default" data-bind="click: cancel, text: translate(\'CANCEL\')" />\r\n</div>\r\n';});

define('security/view-models/create-datasource-dialog',['require','jquery','spa/ko/knockout-view-model','security/services/datasource-service','system/knockout/knockout-manager','system/globalization/translator','security/services/datasource-dto','system/error/error-message','application/application-events','system/ui/dialog-view-model','text!../views/create-datasource-dialog.html'],function(require){"use strict";var a=require("jquery"),b=require("spa/ko/knockout-view-model"),c=require("security/services/datasource-service"),d=require("system/knockout/knockout-manager"),e=require("system/globalization/translator"),f=require("security/services/datasource-dto"),g=require("system/error/error-message"),h=require("application/application-events"),i=require("system/ui/dialog-view-model"),j=require("text!../views/create-datasource-dialog.html");function k(a,b,c){l.call(this,j),this.kom=a,this.translator=Object.resolve(e),this.datasourceService=b,this.applicationEvents=c,this.dialog=null,this.datasource=null,this.isOracle=null,this.isSqlServer=null,this.isNew=null}var l=Object.inherit(b,k);k.dependsOn=[d,c,h],k.prototype.load=function b(){var c=new a.Deferred;return this.datasource=this.kom.observable(),this.isOracle=this.kom.observable(!0),this.isSqlServer=this.kom.observable(!1),this.isNew=this.kom.observable(!0),this.datasource(new f),c.promise()},
k.prototype.activate=function a(){},k.prototype.deactivate=function a(){this.kom.disposeSubscriptions(),this.kom.disposeComputeds()},k.prototype.unload=function a(){this.kom.disposeObservables()},k.prototype.show=function b(){var c={height:"80%",width:"80%"};return this.dfd=a.Deferred(),this.dialog=new i(this,this.translate("CREATE_DATASOURCE_DLG_TITLE"),c),this.dialog.show(),this.dfd.promise()},k.prototype.close=function a(){this.dialog=null},k.prototype.saveItem=function a(){var b=this,c=this.dfd;return b.datasource().id=b.datasource().id.trim(),b.datasource().description=b.datasource().description.trim(),b.datasource().hostName=b.datasource().hostName.trim(),b.datasource().userId=b.datasource().userId.trim(),b.datasource().serverName=b.datasource().serverName.trim(),b.datasource().databaseName=b.datasource().databaseName.trim(),b.datasource().alias=b.datasource().alias.trim(),b.datasource().oraclehost=b.datasource().oraclehost.trim(),
b.datasource().oracleport=b.datasource().oracleport.trim(),b.datasource().oracleservice=b.datasource().oracleservice.trim(),b.isNew()&&(""===b.datasource().hostName&&(b.datasource().hostName="*"),b.datasourceService.postAndTestDatasource(b.datasource()).done(m.bind(null,b,c)).fail(n.bind(null,b))),c.promise()},k.prototype.selectedType=function(a){var b=this.datasource().databaseType;void 0!==b&&(this.isOracle("0"===b),this.isSqlServer("1"===b))},k.prototype.cancel=function a(){this.dialog.closeDialog()},k.prototype.translate=function(a){return this.translator.translate(a)};function m(a){a.isNew(!1),a.dfd.resolve(),a.dialog.closeDialog()}function n(a,b){var c=2,d=g.fromHttpResponse(c,b);a.applicationEvents.errorOccured.raise(a,d)}return k});
define('security/offline-login/security/connection-checker',['require','jquery'],function(require){"use strict";var a=require("jquery"),b="http://",c="https://",d="/meridium/index.html";function e(){}e.prototype.checkConnection=function(e){var h=b,i,j;return e&&f(e)&&(h=c,e=g(e)),i=h+e+d,j={url:i},a.ajax(j)};function f(a){return a.toLowerCase().indexOf(c)>-1}function g(a){return a?a.toLowerCase().replace(c,"").replace(b,""):a}return e});
define('ui/screen-size',["require","exports","system/lang/ioc","system/hardware/device","mi-assert"],function(require,exports,a,b){"use strict";var c=require("mi-assert"),d=1,e=767,f=1e3,g=1920,h=function(){function c(){this.device=a.resolve(b)}return c.prototype.isTooSmallForAllPages=function(){return i(this)<e},c.prototype.isTooSmallForSomePages=function(){return l(this)?n(this):o(this)},c.prototype.toString=function(){return"ScreenSize "+JSON.stringify({pixelRatio:m(this),deviceInnerWidth:j(this)})},c}();function i(a){return k(a).innerWidth()}function j(a){return k(a).deviceInnerWidth()}function k(a){return p(a),a.device}function l(a){return m(a)<=d}function m(a){return k(a).pixelRatio()}function n(a){return i(a)<f}function o(a){return j(a)<g}function p(a){c.instanceOf(a,h,"self"),c.instanceOf(a.device,b,"self.device")}return h});
define('system/ui/busy-indicator',['require','scopedQuerySelector'],function(require){"use strict";require("scopedQuerySelector");function a(a){this.container=null,this.loaderClassName=a||null,this.displayCache=null,this.positionCache=null}a.prototype.attachTo=function(a){a&&(this.displayCache=a.style.overflow,this.positionCache=a.style.position,b(this,a))},a.prototype.detach=function(){this.container=null,this.loaderClassName=null,this.displayCache=null,this.positionCache=null},a.prototype.show=function(){var a,b;if(this.container)for(this.container.style.overflow="hidden",this.container.style.position=this.positionCache?this.positionCache:"relative",a=this.container.querySelectorAll(":scope > .busy-indicator-wrap"),b=0;b<a.length;b++)a[b].style.display="block"},a.prototype.hide=function(){var a,b;if(this.container)for(this.displayCache?this.container.style.overflow=this.displayCache:this.container.style.overflow="",this.positionCache?this.container.style.position=this.positionCache:this.container.style.position="",
a=this.container.querySelectorAll(":scope > .busy-indicator-wrap"),b=0;b<a.length;b++)a[b].style.display="none"};function b(a,b){if(a.container=b,!a.container.querySelector(":scope > .busy-indicator-wrap")){var c=document.createElement("div"),d=document.createElement("div"),e=document.createElement("div"),f=a.container.getBoundingClientRect();c.classList.add("busy-indicator-wrap"),c.style.display="none",d.classList.add("busy-indicator"),a.loaderClassName?e.classList.add(a.loaderClassName):a.container.offsetWidth<640?e.classList.add("loading-small"):a.container.offsetWidth<1024&&a.container.offsetWidth>641?e.classList.add("loading-med"):a.container.offsetWidth<1440&&a.container.offsetWidth>1025?e.classList.add("loading-large"):a.container.offsetWidth>1441?e.classList.add("loading-extra-large"):e.classList.add("loading-med"),c.appendChild(d),d.appendChild(e),a.container.appendChild(c),c.style.top=a.container.clientTop+"px",c.style.left=a.container.clientLeft+"px"}}return a});

define('text!security/views/pre-login.html',[],function () { return '<div class="login-form">\n    <form >\n        <div class="form-group">\n            <input id="serverUrl" class="placeHolder"  type="text" data-bind = "value: $root.serverUrl" placeholder="Server">\n        </div>\n        <div class="form-group">\n            <input id="tenantAlias" class="placeHolder"  type="text"  data-bind = "value: $root.tenantAlias" placeholder="Tenant">\n        </div>\n    </form>\n</div>\n';});

define('security/view-models/pre-login-view-model',['require','jquery','jquery','spa/ko/knockout-view-model','application/application-context','system/knockout/knockout-manager','system/globalization/translator','application/application-events','text!../views/pre-login.html','knockout','localforage'],function(require){"use strict";var a=require("jquery"),b=require("jquery"),c=require("spa/ko/knockout-view-model"),d=require("application/application-context"),e=require("system/knockout/knockout-manager"),f=require("system/globalization/translator"),g=require("application/application-events"),h=require("text!../views/pre-login.html"),i=require("knockout"),j=require("localforage");function k(a,b){l.call(this,h),this.kom=a,this.region=null,this.translator=Object.resolve(f),this.serverUrl=this.kom.observable(""),this.tenantAlias=this.kom.observable(""),m(this.serverUrl,"serverUrl"),m(this.tenantAlias,"tenantAlias")}var l=Object.inherit(c,k);k.dependsOn=[e,g];function m(a,b){j.getItem(b).then(n.bind(null,a))}function n(a,b){a(b)}return k});

define('text!security/views/login.html',[],function () { return '<div id="login-screen" class="block-group" data-bind="visible: showLogon">\r\n    <section class="login-wrapper">\r\n\r\n        <div class="login-text">\r\n            <span data-bind="text: loginCaption"></span>\r\n        </div>\r\n\r\n        <div class="login-opacity-background">\r\n            <div class="login-form">\r\n                <div class="welcome-text-container">\r\n                    <div class="login-logo"></div>\r\n                    <span class="apm-text block">Asset Performance<br />Management</span>\r\n                </div>\r\n                <form data-bind="visible: showLogonForm">\r\n                    <div class="form-group">\r\n                        <input id="userid" type="text" class="form-control" tabindex="1"\r\n                               data-bind="value: userId, valueUpdate: \'keyup\', attr: { placeholder: userNameCaption }, disable: busy">\r\n                    </div>\r\n                    <div class="form-group">\r\n                        <input id="password" type="password" class="form-control" tabindex="2"\r\n                               data-bind="value: password, attr: { placeholder: passwordCaption }, disable: busy">\r\n                    </div>\r\n                    <div class="login-error" id="login-error"></div>\r\n                    <div class="advanced-options">\r\n                        <div class="form-group">\r\n                            <!-- ko if: allowServerInput-->\r\n                            <input id="appserver" type="text" class="form-control" tabindex="3"\r\n                                   data-bind="value: apiServer, attr: { placeholder: \'Server\' }, disable: busy">\r\n                            <!-- /ko -->\r\n                        </div>\r\n                        <div class="datasource-container block-group">\r\n                            <div class="form-group block"\r\n                                 data-bind="css: { \'enable-add\': canAddDatasource }">\r\n                                <!-- ko if: areDatasourcesLoaded-->\r\n                                <select tabindex="3" class="form-control"\r\n                                        data-bind="options: datasources, value: datasource, optionsText: \'shortDisplayName\', disable: busy"></select>\r\n                                <!-- /ko -->\r\n                                <!-- ko ifnot: areDatasourcesLoaded-->\r\n                                <div class="form-control noDatasource"></div>\r\n                                <!-- /ko -->\r\n                            </div>\r\n                            <!-- ko if: canAddDatasource -->\r\n                            <div class="form-group add-button block">\r\n                                <button type="button"\r\n                                        class="btn btn-default"\r\n                                        data-bind="click: addDatasource,\r\n                                           text: addDatasourceCaption">\r\n                                </button>\r\n                            </div>\r\n                            <!-- /ko -->\r\n                        </div>\r\n                    </div>\r\n                    <div class="form-group login-footer">\r\n                        <!-- ko if: areDatasourcesLoaded-->\r\n                        <button type="submit" class="btn btn-primary" data-bind="click: login,\r\n                                                                             enable: showLoginInput,\r\n                                                                             css:{ disabled: !areDatasourcesLoaded() }">\r\n                            <span data-bind="text: signinCaption"></span>\r\n                            <div class="loading-med" data-bind="visible: busy"></div>\r\n                        </button>\r\n                        <!-- /ko -->\r\n                        <!-- ko ifnot: areDatasourcesLoaded-->\r\n                        <div class="btn btn-primary disabled" data-bind="text: signinCaption"></div>\r\n                        <!-- /ko -->\r\n                    </div>\r\n                    <!-- ko if: allowServerInput && areDatasourcesLoaded() && ssoIdpUrl() -->\r\n                    <div class="form-group sso-anchor-tag">\r\n                        <a data-bind="click: ssoLogin, disable: busy">\r\n                            <span data-bind="text: ssoSigninCaption"></span>\r\n                        </a>\r\n                    </div>\r\n                    <!-- /ko -->\r\n                </form>\r\n                <form class="change-password-form" data-bind="visible: showChangePasswordForm">\r\n                    <h1 data-bind="text: changePasswordHeader"></h1>\r\n                    <div class="form-group">\r\n                        <input type="password" class="form-control new-password" tabindex="1"\r\n                               data-bind="value: newPassword, attr: { placeholder: newPasswordCaption }">\r\n                    </div>\r\n                    <div class="form-group">\r\n                        <input type="password" class="form-control retype-password" tabindex="1"\r\n                               data-bind="value: retypeNewPassword, attr: { placeholder: retypeNewPasswordCaption }">\r\n                    </div>\r\n                    <div class="form-group login-footer">\r\n                        <button type="submit" class="btn btn-primary"\r\n                                data-bind="click: changePassword, disable: busy">\r\n                            <span data-bind="text: changePasswordCaption"></span>\r\n                            <div class="loading-med" data-bind="visible: busy"></div>\r\n                        </button>\r\n                    </div>\r\n                </form>\r\n\r\n            </div>\r\n\r\n        </div>\r\n\r\n        <div class="trademark">\r\n            <div class="version-left">\r\n                <span data-bind="text: versionCaption"></span>\r\n                <span data-bind="text: versionNum"></span>\r\n            </div>\r\n            <div class="copyright-right">\r\n                <a href="http://www.ge.com/terms" target="_blank">Terms</a> |\r\n                <a href="http://www.ge.com/privacy" target="_blank">Privacy</a> |\r\n                <span data-bind="text: \'Copyright &copy \' + year + \' General Electric Company. All rights reserved.\'"></span>\r\n            </div>\r\n        </div>\r\n\r\n    </section>\r\n</div>\r\n';});

define('security/view-models/login-view-model',['require','exports','module','lodash','jquery','knockout','spa/ko/knockout-view-model','system/knockout/knockout-manager','../model/login-strategy-factory','security/services/datasource-service','security/services/security-service','security/offline-login/api/offline-login-api','system/http/ajax-client','application/application-context','application/application-events','system/globalization/translator','../model/saved-session','system/diagnostics/log-manager','./create-datasource-dialog','security/offline-login/context/offline-login-context','security/offline-login/security/connection-checker','system/ui/message-box','system/hardware/device','ui/screen-size','security/view-models/application-reset','system/ui/busy-indicator','security/view-models/pre-login-view-model','system/ui/dialog-box','text!../views/login.html','system/http/predix-mobile-ajax-client','bluebird','security/services/session-dto'],function(require,exports,module){"use strict"
;var a=require("lodash"),b=require("jquery"),c=require("knockout"),d=require("spa/ko/knockout-view-model"),e=require("system/knockout/knockout-manager"),f=require("../model/login-strategy-factory"),g=require("security/services/datasource-service"),h=require("security/services/security-service"),i=require("security/offline-login/api/offline-login-api"),j=require("system/http/ajax-client"),k=require("application/application-context"),l=require("application/application-events"),m=require("system/globalization/translator"),n=require("../model/saved-session"),o=require("system/diagnostics/log-manager"),p=require("./create-datasource-dialog"),q=require("security/offline-login/context/offline-login-context"),r=require("security/offline-login/security/connection-checker"),s=require("system/ui/message-box"),t=require("system/hardware/device"),u=require("ui/screen-size"),v=require("security/view-models/application-reset"),w=o.getLogger(module.id),x=require("system/ui/busy-indicator"),y=require("security/view-models/pre-login-view-model"),z=require("system/ui/dialog-box"),A=require("text!../views/login.html"),B=require("system/http/predix-mobile-ajax-client"),C=require("bluebird"),D=require("security/services/session-dto"),E=800,F="logout",G=5e3,H="meridium_datasource"
;function I(){J.call(this,A),this.kom=Object.resolve(e),this.loginStrategyFactory=Object.resolve(f),this.loginStrategy=null,this.createDatasourceDialog=Object.resolve(p),this.datasourceService=Object.resolve(g),this.securityService=Object.resolve(h),this.translator=Object.resolve(m),this.device=Object.resolve(t),this.screenSize=Object.resolve(u),this.busyIndicator=new x("loading-med"),this.loginDeferred=null,this.showLogon=this.kom.observable(!0),this.showLogonForm=this.kom.observable(!0),this.showChangePasswordForm=this.kom.observable(!1),this.userId=this.kom.observable(""),this.password=this.kom.observable(""),this.apiServer=this.kom.observable(this.device.isMobileApp()?"":location.host),this.datasources=this.kom.observableArray(),this.datasource=this.kom.observable(),this.areDatasourcesLoaded=this.kom.observable(!1),this.busy=this.kom.observable(!1),this.newPassword=this.kom.observable(""),this.retypeNewPassword=this.kom.observable(""),
this.userNameCaption=this.kom.observable("Username"),this.passwordCaption=this.kom.observable("Password"),this.apiServerCaption=this.kom.observable("API Server"),this.datasourceCaption=this.kom.observable("Datasource"),this.addDatasourceCaption=this.kom.observable("Add Datasource"),this.loginCaption=this.kom.observable("Log-In"),this.signinCaption=this.kom.observable("Sign-in"),this.ssoSigninCaption=this.kom.observable("Sign in with SSO"),this.changePasswordHeader=this.kom.observable("Password Change Required"),this.newPasswordCaption=this.kom.observable("New Password"),this.retypeNewPasswordCaption=this.kom.observable("Re-Type Password"),this.changePasswordCaption=this.kom.observable("Change Password"),this.allowServerInput=""===this.apiServer()||window.MSApp,this.canAddDatasource=this.kom.computed(L.bind(null,this)),this.browserUnsupportedCaption=this.kom.observable(""),this.versionNum=window.appInfo.version,this.versionCaption=this.kom.observable("Version "),this.detached=!1,
this.year=(new Date).getFullYear().toString(),this.preLoginViewModel=Object.resolve(y),this.ssoIdpUrl=this.kom.observable(""),this.showLoginInput=this.kom.computed(K.bind(null,this)),this.ajaxClient=Object.resolve(j)}var J=Object.inherit(d,I);function K(a){return!!a.userId()}function L(a){return"localhost"===a.apiServer()&&a.areDatasourcesLoaded()&&a.datasources&&a.datasources()&&!a.datasources().length}I.prototype.activate=function a(b){try{return M(this,b)}catch(a){console.error(a.stack)}};function M(a,c){return N(a,"This Operating System is not Supported","This Browser is Not Supported"),a.loginDeferred=new b.Deferred,O(c)?P(a):X(a),a.loginDeferred.promise()}function N(a,b,c){a.device.isMobileApp()?a.browserUnsupportedCaption(b):a.browserUnsupportedCaption(c)}function O(a){return a&&a===F}function P(a){a.logout(),a.loginDeferred.resolve()}I.prototype.forceLogout=function(){b(window).off("beforeunload"),V(this)},I.prototype.logout=function(){var a=T();if(la()){
Q(new PredixSDK.AuthenticationManager).then(W)}else U(a)?a.done(V.bind(null,this)):V(this)};function Q(a){return new C(function(b,c){a.logout(b,c)})}function R(a,b,c){var d;if(c){var e=new Date;e.setTime(e.getTime()+24*c*60*60*1e3),d="; expires="+e.toGMTString()}else d="";document.cookie=encodeURIComponent(a)+"="+encodeURIComponent(b)+d+"; path=/"}function S(a){for(var b=encodeURIComponent(a)+"=",c=document.cookie.split(";"),d=0;d<c.length;d++){for(var e=c[d];" "===e.charAt(0);)e=e.substring(1,e.length);if(0===e.indexOf(b))return decodeURIComponent(e.substring(b.length,e.length))}return null}function T(){var a=Object.resolve(l),b={promise:null};return"true"===S("ge_is_SSO")&&(R("ge_is_SSO","",-1),R("ge_show_sso_logout","true",1)),a.signout.raise(b),b.promise}function U(a){return!!a}function V(a){a.securityService.logout().always(W.bind(null))}function W(){(new v).reset()}function X(a){Y(window),a.loginStrategy=a.loginStrategyFactory.createStrategy(a),
a.showLogon(a.loginStrategy.showPrompt()),a.loginStrategy.meridiumResourceLoaded.add(_,a,a),la()?Z(a):a.loginStrategy.start()}function Y(a){if(a.MSApp)try{navigator.splashscreen.hide()}catch(a){}}function Z(a){var b={buttons:[{name:"Next",value:"Next",cssClass:"btn-pre-login"}],height:"250px",width:"300px",closeOnReject:!0};new z(a.preLoginViewModel,"Welcome to APM Mobile",b).show().done($.bind(null,a))}function $(a,b,c){"Next"===c&&a.loginStrategy.start()}function _(a){a.userNameCaption(a.translator.translate("USER_NAME_CAPTION")),a.passwordCaption(a.translator.translate("PASSWORD_CAPTION")),a.apiServerCaption(a.translator.translate("API_SERVER_CAPTION")),a.datasourceCaption(a.translator.translate("DATASOURCE_CAPTION")),a.loginCaption(a.translator.translate("LOG_IN")),a.signinCaption(a.translator.translate("SIGN_IN")),a.ssoSigninCaption(a.translator.translate("SSO_SIGN_IN")),a.addDatasourceCaption(a.translator.translate("ADD_DATASOURCE")),
a.changePasswordHeader(a.translator.translate("CHANGE_PASSWORD_HEADER")),a.newPasswordCaption(a.translator.translate("NEW_PASSWORD")),a.retypeNewPasswordCaption(a.translator.translate("RETYPE_CONFIRM_PASSWORD")),a.changePasswordCaption(a.translator.translate("CHANGE_PASSWORD")),N(a,a.translator.translate("OS_NOT_SUPPORTED"),a.translator.translate("BROWSER_NOT_SUPPORTED")),a.versionCaption(a.translator.translate("CURRENT_VERSION"))}I.prototype.initUserId=function(){this.userId(n.getUserId())},I.prototype.initApiServer=function(){this.allowServerInput&&(aa(this),this.apiServer(n.getApiServer()))};function aa(a){a.kom.subscribe(a.apiServer,ba.bind(null,a))}function ba(a,b){var c=new t;a.detached||(c.isMobileApp()?(ca(a,fa.bind(null,a,b),ja.bind(null,a,b)),k.connectionStatus.connectionCheckerInterval=setInterval(ga.bind(null,a,b),G)):fa(a,b))}function ca(a,b,c){(new r).checkConnection(a.apiServer()).done(b).fail(c)}function da(a){var b=[];if(!a)return ta("No offline datasources"),b
;for(var c=0;c<a.length;c++)b.push(a[c].datasourceInfo);return b}function ea(a,b){a.ssoIdpUrl(""),b&&b.ssoAuthEnabled&&(a.ssoIdpUrl(b.idpUrl),a.ssoIdpUrl()&&(a.userId(""),a.password("")))}function fa(a,b){var c=n.getUserCulture();k.connectionStatus.connected=!0,a.datasources.removeAll(),a.apiServer(b),a.setAjaxClientServerFromVm(),a.loginStrategy.getMeridiumResource(c).done(a.loginStrategy.setTranslatorLocale.bind(a.loginStrategy)).done(_.bind(null,a)).always(ma.bind(null,a)).fail(oa),j.server()&&a.datasourceService.getHost(j.server()).always(ea.bind(null,a))}function ga(a,b){ca(a,ha.bind(null,a,b),ia.bind(null,a,b))}function ha(a,b){a.detached||k.connectionStatus.connected||fa(a,b)}function ia(a,b){k.connectionStatus.connected&&ja(a,b)}function ja(a,b){if(b){var c=new i;k.connectionStatus.connected=!1,c.getDatasources(b).then(ka.bind(null,a,b))}}function ka(a,b,c){pa(a,[]),a.datasources(da(c)),ra(a,c),sa(a)}I.prototype.setAjaxClientServerFromVm=function(){
la()?B.setServer(this.apiServer()):j.setServer(this.apiServer())};function la(){return!!window.PredixSDK}function ma(a){a.apiServer()?a.datasourceService.getFilteredDatasources(a.apiServer()).done(na).done(pa.bind(null,a)).done(qa.bind(null,a)).done(sa.bind(null,a)).fail(ta):(pa(a,[]),sa(a))}function na(a){(new t).isMobileApp()&&(q.datasources=a)}function oa(a){o.pushContext("logGetMeridiumResourceFailed"),w.error("Error loading locale:",a),o.popContext()}function pa(a,b){a.datasources(b)}function qa(a,b){var c,d,e=n.getDatasource();if(e&&b)for(c=0;c<b.length;c++)if(d=b[c],d.id===e){a.datasource(d);break}}function ra(a,b){var c,d,e=n.getDatasource();if(e&&b)for(c=0;c<b.length;c++)if(d=b[c],d.datasourceInfo.id===e){a.datasource(d.datasourceInfo);break}}function sa(a){a.areDatasourcesLoaded(!0)}function ta(a){o.pushContext("getFilteredDatasources"),s.showOk("Unable to retrieve datasources","Error"),w.error("Error loading datasources",a),o.popContext()}I.prototype.attach=function a(b){
try{ua(this,b)}catch(a){console.error(a)}};function ua(a,c){J.prototype.attach.call(a,c),a.screenSize.isTooSmallForAllPages()?screen.lockOrientation&&screen.lockOrientation("portrait"):screen.lockOrientation&&screen.lockOrientation("landscape");var d=document.querySelector(".noDatasource");d&&(a.busyIndicator.attachTo(d),a.busyIndicator.show()),k.isSupportedBrowser||b("#login-screen").prepend('<div class="browser-not-supported">'+a.browserUnsupportedCaption()+"</div>"),va(a,c)}function va(a,b){a.device.isChromeOnAndroid()&&window.innerHeight<E&&wa(b)}function wa(a){var b=a.element.querySelector("#login-screen");b&&(a.element.style.overflowY="auto",b.style.height=b.offsetHeight+"px")}I.prototype.login=function a(){xa(this,!1)},I.prototype.ssoLogin=function a(){xa(this,!0)};function xa(a,b){var c=new t,d=new r;c.isMobileApp()?d.checkConnection(a.apiServer()).done(Da.bind(null,a,b)).fail(Ea.bind(null,a)):Da(a,b)}function ya(a,b){b?a.device.isMobileApp()?za(a,b):(R(H,a.datasource().id,10),
S(H),window.location=b):s.showOk(a.translator.translate("SSO_INVALID_URL"),"Error")}function za(a,b){var c="location=yes,EnableViewPortScale=yes",d=a.ajaxClient.url("sso.html")+"?ds="+a.datasource().id+"&url="+b,e=cordova.InAppBrowser.open(d,"_blank",c);e.addEventListener("loadstop",Ba.bind(null,a,e)),e.addEventListener("loaderror",console.error.bind(null))}function Aa(a,b){a.device.isIOS()?window.wkWebView?window.wkWebView.syncCookie(a.ajaxClient.url("api/core/security/session"),"GET",function(b){b?a.loginStrategy.ssoLoginDone(new D(b,j.server())):Ca("No response from plugin")},Ca.bind(null)):s.showOk(a.translator.translate("SSO_NOT_SUPPORTED"),"Error"):a.securityService.getSession().done(a.loginStrategy.ssoLoginDone.bind(a.loginStrategy)).fail(Ca.bind(null)),b.close()}function Ba(a,b,c){try{if(c.url.indexOf("/sso-auth.html?session=")!==-1)Aa(a,b);else if(c.url.endsWith("/sso-no-auth.html"))b.close(),Ca();else{
var d='document.cookie = encodeURIComponent("'+H+'") + "=;expires=Thu, 01 Jan 1970 00:00:01 GMT;path=/;";',e='document.cookie = encodeURIComponent("'+H+'") + "=" + encodeURIComponent("'+a.datasource().id+'")+"; path=/;";',f=d+e;b.executeScript({code:f})}}catch(a){s.showOk(a)}}function Ca(a){o.pushContext("ssoMobileLogin"),s.showOk("Unable to SSO login","Error"),w.error("Error SSO login",a),o.popContext()}function Da(a,b){b?a.ssoIdpUrl()?a.datasource()&&a.datasource().id?a.securityService.ssologin(a.ssoIdpUrl(),a.datasource().id).done(ya.bind(null,a)).fail(Ca.bind(null)):s.showOk(a.translator.translate("DATASOURCE_REQUIRED"),"Error"):s.showOk(a.translator.translate("SSO_NOT_SUPPORTED")+" "+a.apiServer(),"Error"):a.loginStrategy.login(a.datasource().id,a.userId(),a.password(),a.apiServer())}function Ea(a){
a.datasource()?a.loginStrategy.loginOffline(a.datasource().id,a.userId(),a.password(),a.apiServer()):s.showOk("No offline datasources found.  You must login while online at least once in order to enable offline login","Error")}I.prototype.showBusy=function(){this.busy(!0)},I.prototype.addDatasource=function a(){this.createDatasourceDialog.show().done(Fa.bind(null,this))};function Fa(a){a.areDatasourcesLoaded(!1),ma(a)}I.prototype.detach=function(a){try{Ga(this,a)}catch(a){console.error(a)}finally{"undefined"!=typeof cordova&&delete window.open,"undefined"!=typeof cordova&&"undefined"!=typeof MSApp&&(cordova.InAppBrowser.open=function(a){Windows.System.Launcher.launchUriAsync(new Windows.Foundation.Uri(a))})}};function Ga(a,b){J.prototype.detach.call(a,b),a.busyIndicator.detach(),a.detached=!0}I.prototype.unload=function a(){try{Ha(this)}catch(a){console.error(a)}};function Ha(a){a.kom.dispose(),a.kom=null,a.datasourceService=null,a.securityService=null,a.translator=null,
a.loginDeferred=null,a.createDatasourceDialog=null}return I.prototype.switchToChangePasswordForm=function(){this.showLogon(!0),this.showLogonForm(!1),this.showChangePasswordForm(!0)},I.prototype.changePassword=function(){this.loginStrategy.changePassword(this.newPassword(),this.retypeNewPassword())},I.prototype.hideBusy=function(){this.busy(!1)},I});
define('shell/views/hyperlink-utility-view',["require","exports","react"],function(require,exports,a){"use strict";var b=a.DOM,c=b.div,d=b.label,e=b.input;function f(a){return c({className:"hyperlink-utility-popup"},c({className:"form"},c({className:"form-group"}),d({className:"control-label"},a.vm.translator.translate("HYPERLINK_UTIL_HASH")),e({className:"form-control",type:"text",value:a.vm.hashUrl,readOnly:!0}),c({className:"form-group"}),d({className:"control-label"},a.vm.translator.translate("HYPERLINK_UTIL_FULL")),e({className:"form-control",type:"text",value:a.vm.fullUrl,readOnly:!0})))}exports.HyperlinkUtilityView=f});
define('shell/hyperlink-utility-view-model',["require","exports","jquery","system/lang/ioc","system/globalization/translator","application/application-context","react-dom","system/http/ajax-client","shell/views/hyperlink-utility-view","system/ui/dialog-box"],function(require,exports,a,b,c,d,e,f,g){"use strict";var h=require("system/ui/dialog-box");return function(){function i(){this.translator=b.resolve(c),this.hashUrl=null,this.fullUrl=null,this.isSSO=!1}return i.prototype.execute=function(b){var c=new h(this,this.translator.translate("HYPERLINK_UTIL_TITLE"),this.getDialogOptions());this.setUrls();var d=a.Deferred();return c.show(),d.resolve(),d},i.prototype.setUrls=function(){this.isSSO=this.isSSOEnabled(),this.hashUrl="#"+d.navigation.activeRoute,this.fullUrl=this.formatFullUrl()},i.prototype.isSSOEnabled=function(){var a=!1;if(""!==document.cookie){document.cookie.split(";").forEach(function(b){if(b=b.trim(),b.startsWith("ge_is_SSO=")){var c=b.split("="),d=c[1];a="true"===d}})}return a},
i.prototype.formatFullUrl=function(){var a=b.resolve(f);return f.isMultiTenant()?window.location.href.split("#")[0]+"#"+d.navigation.activeRoute:d.hasPredixSDKInstalled()?a.baseUrl()+this.hashUrl:this.isSSO?a.baseUrl()+"meridium/sso-index.html"+this.hashUrl:a.baseUrl()+"meridium/"+this.hashUrl},i.prototype.attach=function(a){var b={vm:this};e.render(g.HyperlinkUtilityView(b),a.element)},i.prototype.getDialogOptions=function(){return{buttons:[{name:this.translator.translate("CLOSE"),value:"cancel",cssClass:"btn-default"}],closeOnReject:!0}},i}()});
define('shell/leftnav-view-model',["require","exports","lodash","system/lang/ioc","spa/react/react-view-model","./models/folder","./utils/target-path","application/application-events","system/globalization/translator","./views/leftnav","./builders/leftnav-builder","application/application-context","./security/left-nav-security","./nav-config/nav-config-loader","./builders/leftnav-utilities","text!./views/leftnav.html","security/view-models/login-view-model","system/ui/dialog-box","./hyperlink-utility-view-model"],function(require,exports,a,b,c,d,e,f,g,h,i,j,k,l,m){"use strict";var n=require("security/view-models/login-view-model"),o=window,p=function(c){__extends(f,c);function f(a){var d=c.call(this,h.LeftNavView)||this;return d.applicationEvents=a,d.translator=b.resolve(g),d.dialogScreen=null,d.security=b.resolve(k),d.region=null,d.aMenuIsVisible=!1,d.windowNavApps=j.isAppHub?o.nav.main.items:null,d.folders=null,d.bindMethods(["translate","noAccess"]),d.updateViewAfter(["signOut","toggleMenu"]),d}
return f.prototype.handleFullMenu=function(a){this.isHomeView(a)},f.prototype.attach=function(a){c.prototype.attach.call(this,a),this.region=a,document.addEventListener("click",this.closeAllMenus.bind(null,this))},f.prototype.detach=function(a){c.prototype.detach.call(this,a),this.applicationEvents.windowClicked.remove(this)},f.prototype.translate=function(a){return this.translator.translate(a)},f.prototype.signOut=function(){b.resolve(n).logout(!0)},f.prototype.navigateTo=function(a){this.applicationEvents.navigate.raise(a,{tab:!0})},f.prototype.noAccess=function(a){return this.security.noAccess(a)},f.prototype.closeAllMenus=function(a,b){if(a.region&&a.region.element&&!a.isLeftNavClicked(b)&&a.aMenuIsVisible){var c=a.region.element,d=c.querySelectorAll(".apps-list"),e=c.querySelectorAll(".app-folder");a.hideAllMenus(a,d),a.unselectAllFolderButtons(a,e),a.aMenuIsVisible=!1,a.updateView()}},f.prototype.hideAllMenus=function(b,c){c&&a.values(c).forEach(function(a){return b.hideMenu(a)})
},f.prototype.unselectAllFolderButtons=function(b,c){c&&a.values(c).forEach(function(a){return b.hideSelected(a)})},f.prototype.isLeftNavClicked=function(b){var c=e.getTargetPath(b),d=!1;return c.forEach(function(b){if(b.classList){a.values(b.classList).indexOf("app-folder")>-1&&(d=!0)}}),d},f.prototype.getFolders=function(){if(j.isAppHub&&this.folders&&a.isEqual(this.windowNavApps,o.nav.main.items))return this.folders;this.tryLoadNavConfigDemo();var c=j.isAppHub?o.nav.main.items:this.security.applySecurity(j.apps),d=o.nav?o.nav.contextPath:"",e=new i(c||[],b.resolve(g),d);return this.folders=this.setFolders(e),this.addToggleHandlers(this.folders),this.addSignoutFolder(this.folders),this.cacheWindowNavInMemory(),this.folders||[]},f.prototype.tryLoadNavConfigDemo=function(){if(o.nav&&o.nav.preferences){var a=sessionStorage.getItem("navigationProfile");a&&(o.nav.preferences.NavigationProfile=a)}},f.prototype.setFolders=function(a){
return o.nav&&o.nav.preferences&&o.nav.preferences.NavigationProfile?this.buildCustomNavigation(a):a.build()},f.prototype.buildCustomNavigation=function(a){return this.folders=l.loadNavConfig(o.nav.preferences.NavigationProfile),this.folders?(this.folders.forEach(m.setUpperEdges),this.folders):a.build()},f.prototype.cacheWindowNavInMemory=function(){if(j.isAppHub){var a=JSON.stringify(o.nav.main.items);this.windowNavApps=JSON.parse(a)}},f.prototype.addSignoutFolder=function(a){var b=new d.Folder("signout",this.translator.translate("SIGN_OUT"),"icon-signout","signout",a.length+1);b.setClickHandler(this.signOut),a.push(b)},f.prototype.addToggleHandlers=function(a){var b=this;a.forEach(function(a){return a.setClickHandler(b.toggleMenu)})},f.prototype.toggleMenu=function(a){if(this.region&&this.region.element){var b=this.region.element,c=b.querySelector(".apps-list-"+a.getFormattedId()),d=b.querySelector(".left-nav-"+a.getFormattedId());this.toggle(b,c,d)}},
f.prototype.toggle=function(a,b,c){b&&b.classList&&(b.classList.contains("show")?(this.hideMenu(b),this.hideSelected(c)):(this.showMenu(b),this.showSelected(c)),this.hideOtherMenus(a,b,c))},f.prototype.hideOtherMenus=function(a,b,c){var d=a.querySelectorAll(".apps-list"),e=a.querySelectorAll(".app-folder");d&&(this.hideOtherMenu(d,b),this.unselectOtherFolderButton(e,c))},f.prototype.hideOtherMenu=function(b,c){var d=this;a.values(b).forEach(function(a){a!==c&&d.hideMenu(a)})},f.prototype.unselectOtherFolderButton=function(b,c){var d=this;a.values(b).forEach(function(a){a!==c&&d.hideSelected(a)})},f.prototype.showSelected=function(a){a&&a.classList&&(a.classList.add("selected"),a.classList.remove("unselected"))},f.prototype.hideSelected=function(a){a&&a.classList&&(a.classList.add("unselected"),a.classList.remove("selected"))},f.prototype.showMenu=function(a){a&&a.classList&&(a.classList.remove("hidden"),a.classList.add("show"),this.aMenuIsVisible=!0)},f.prototype.hideMenu=function(a){
a&&a.classList&&(a.classList.remove("show"),a.classList.add("hidden"))},f}(c);return p=__decorate([b.singleton,b.dependsOn(f)],p)});
define('shell/action-route-controller',["require","exports"],function(require,exports){"use strict";return function(){function a(a,b){this.router=a,this.router.routerConfig=b}return a.prototype.open=function(a){this.addIsActionRouteProperty(),this.router.activate();for(var b=0;b<a.actionRoutes.length;b++)this.router.resolve(a.actionRoutes[b],a.query)},a.prototype.addIsActionRouteProperty=function(){for(var a=0;a<this.router.routerConfig.length;a++)this.router.routerConfig[a].isActionRoute=!0},a}()});
define('shell/navigation-settings',["require","exports","ramda"],function(require,exports,a){"use strict";return function(){function b(){}return b.getSettings=function(b){var c={tab:!1,background:!1,replace:!1,navigate:!0};return c=a.merge(c,b)},b}()});
define('shell/hash-manager',["require","exports","shell/navigation-settings"],function(require,exports,a){"use strict";return function(){function b(a,b){this.urlManager=a,this.options=b}return b.prototype.handleHash=function(b,c,d,e){a.getSettings(e).replace?this.urlManager.replaceHash(b,c,this.getQueryString(d),e):this.urlManager.setHash(b,c,this.getQueryString(d),e)},b.prototype.getQueryString=function(a){var b;return b=this.parseUrl(a)&&this.parseUrl(a).length>0?this.parseUrl(a)[1]:""},b.prototype.parseUrl=function(a){return a.split("?")},b}()});
define('shell/models/tab-storage',["require","exports","system/data/object-storage-factory"],function(require,exports,a){"use strict";function b(b){return a.addNamespace("tab-"+b.valueOf(),a.newSessionStorage())}exports.newTabStorage=b;function c(){return a.addNamespace("tab-bar",a.newSessionStorage())}exports.newTabBarStorage=c});
define('shell/models/tab-id',["require","exports"],function(require,exports){"use strict";var a=function(){function a(a){this.id=a}return a.of=function(b){return new a(b)},a.prototype.valueOf=function(){return this.id},a}();exports.TabId=a});
define('shell/route-overflow/context-updater',["require","exports","application/application-context"],function(require,exports,a){"use strict";return function(){function b(a,b){this.tabs=a,this.activeTabIndex=b}return b.prototype.update=function(){var b=this;this.resetTabContext(),this.tabs.forEach(function(c,d){a.navigation.tabsInfo.push({tabIndex:d,route:c.getHref(),title:c.getFullTitle(),icon:c.getIconImage(),isDirty:c.isDirty(),isActiveTab:d===b.activeTabIndex})})},b.prototype.resetTabContext=function(){a.navigation.tabsInfo=null,a.navigation.tabsInfo=[]},b}()});
define('spa/i-router',['require','exports','module','system/lang/interface'],function(require,exports,module){"use strict";return new(require("system/lang/interface"))(module.id,["activate","resolve","deactivate"],["routerConfig","matchedRoute"])});
define('spa/action-routes/action-route-close',['require','exports','module','jquery','system/globalization/translator'],function(require,exports,module){"use strict";var a=require("jquery"),b=require("system/globalization/translator");function c(a){this.busyIndicator=a,this.closeButton=null,this.translator=Object.resolve(b),this.boundClickHandler=f.bind(null,this)}c.prototype.handleBusyIndicatorClose=function(){setTimeout(d.bind(null,this),1e4)};function d(b){if(g()&&0===a("button.action-route-indicator-close").length){e(b.translator.translate("CLOSE_LOADING_INDICATOR")),b.closeButton=document.querySelector("button.action-route-indicator-close"),b.closeButton.addEventListener("click",b.boundClickHandler)}}function e(b){a("#shell").prepend('<button class="btn action-route-indicator-close">'+b+"</button>")}function f(b){b.busyIndicator.hide(),b.closeButton.removeEventListener("click",b.boundClickHandler),a(b.closeButton).remove()}function g(){return"block"===document.querySelector("#shell").querySelector(".busy-indicator-wrap").style.display}return c});
define('spa/action-routes/action-route-url-remover',['require','exports','module'],function(require,exports,module){"use strict";function a(){}a.remove=function(a,d){var f=d.arguments.url,g=c(a,f);g=e(g,d),b(g)};function b(a){window.location.href=window.location.href.replace(a,"")}function c(a,b){var c=";act=",e;return b?(e=c+a+b,e=d(e)):e=c+a,e}function d(a){return a.replace("*","")}function e(a,b){var c=b.arguments.named;for(var d in c)a.indexOf(d)>-1&&(a=a.replace("@"+d,c[d]));return a}return a});
define('spa/action-routes/action-route-opener',['require','exports','module','jquery','spa/action-routes/action-route-close','system/ui/busy-indicator','spa/action-routes/action-route-url-remover','application/application-events'],function(require,exports,module){"use strict";var a=require("jquery"),b=require("spa/action-routes/action-route-close"),c=require("system/ui/busy-indicator"),d=require("spa/action-routes/action-route-url-remover"),e=require("application/application-events");function f(){}f.prototype.open=function(a,b){g(a,b)};function g(a,e){var f=new c("loading-extra-large"),g=new b(f),i=e.arguments.positional,k=e.arguments.named,l={};l.query=i,l.routeArgs=k,l.routeInfo=e,f.attachTo(document.querySelector("#shell")),f.show(),g.handleBusyIndicatorClose(),e.screen.execute(l).done(h.bind(null,f)).fail(j.bind(null,f)),d.remove(a.config.url,e)}function h(a,b){b&&b.route&&i(b.route),a.hide()}function i(a){var b=Object.resolve(e),c={tab:!0};b.navigate.raise(a,c)}function j(a){a.hide()}return f});
define('spa/route-parser',['require','exports','module','jquery','system/lang/event','system/diagnostics/log-manager','system/lang/url-codec'],function(require,exports,module){"use strict";var a=require("jquery"),b=require("system/lang/event"),c=require("system/diagnostics/log-manager"),d=c.getLogger(module.id),e=require("system/lang/url-codec"),f=/\*|@\w*/g,g=/^$/,h=/@\w+/g,i=/@/g,j=/\/\*/g,k=/^\/|\/$/g,l="([^/]*)",m="?(.*)",n="/?(.*)";function o(){this.routes=[],this.routeMatched=new b,this.badRoute=new b}o.prototype.dispatch=function(a,b){d.isTraceEnabled()&&d.trace("dispatch url ",a);var c=a.split("?"),e=this.match(c[0]);if(void 0===e)return d.warn("unmatched url ",a),void this.badRoute.raise({url:a});var f=this.parse(a,e,b);this.routeMatched.raise({module:e.module,arguments:f,config:p(e)})};function p(b){var c=a.extend({},b);return c.matches&&delete c.matches,c.regExp&&delete c.regExp,c}o.prototype.load=function(a){this.routes=a,d.isTraceEnabled()&&d.trace("configure Routes"),this.routes.forEach(o.configureRoute)},o.configureRoute=function(a){var b,c,e=f;if(a.matches=[],""===(a.url||""))return a.regExp=g,a
;for(b="^"+a.url.replace(h,l).replace(i,m).replace(j,n)+"$",a.regExp=new RegExp(b,"i"),d.isTraceEnabled()&&d.trace("url: ",a.url," regex: ",b),c=e.exec(a.url);null!==c;)a.matches.push(c[0]),c=e.exec(a.url);return a},o.prototype.match=function(a){a=a.replace(k,"");for(var b=0;b<this.routes.length;b++)if(this.routes[b].regExp.lastIndex=0,this.routes[b].regExp.test(a))return d.isTraceEnabled()&&d.trace("route match ",a," matched ",this.routes[b]),this.routes[b]},o.prototype.parse=function(a,b,c){var e={named:null,positional:[],url:"",icon:""},f=a.split("?"),g,h;if(a=f[0],c=q(c,f),d.isTraceEnabled()&&d.trace("parse values"),a=a.replace(k,""),b.regExp.lastIndex=0,null!==(g=b.regExp.exec(a)))for(h=1;h<g.length;h++)s(e,g[h],b.matches[h-1]);return c&&e.positional.push(c),e.icon=b.icon,d.isTraceEnabled()&&d.trace("parsed values: ",e),e};function q(a,b){return a||(a=r(b)),a}function r(a){var b=a.length>0?a[1]:null,c=b?e.decode(b):null;return c&&a.length>0&&(c.__isQueryString__=!0),c}
function s(a,b,c){if(d.isTraceEnabled()&&d.trace(b,c),void 0!==c&&void 0!==b){if("*"===c)return void(a.url=b);if("@"===c){var e=b.split("/");return""===e[e.length-1]&&e.pop(),void Array.prototype.push.apply(a.positional,e)}null===a.named&&(a.named={}),a.named[c.substring(1)]=b}}return o});
define('spa/router',['require','jquery','mi-assert','./i-router','system/lang/event','spa/action-routes/action-route-opener','spa/route-parser'],function(require){"use strict";var a=require("jquery"),b=require("mi-assert"),c=require("./i-router"),d=require("system/lang/event"),e=require("spa/action-routes/action-route-opener"),f=require("spa/route-parser"),g="status-pages/url-not-supported/url-not-supported-view-model";function h(a){this.routerConfig=a||{},this.routeParser=new f,this.matchedRoute=new d,this.loadModuleDeferred=null,this.matchedRouteQueue=[],b.implementsInterface(this,c)}h.prototype.activate=function(){this.routeParser.load(this.routerConfig),this.routeParser.routeMatched.add(this.routeMatchedHandler,this),this.routeParser.badRoute.add(this.badRouteHandler,this)},h.prototype.resolve=function(a,b){b?this.routeParser.dispatch(a,b):this.routeParser.dispatch(a)},h.prototype.deactivate=function(){this.routeParser.routeMatched.remove(),this.routeParser.badRoute.remove()},h.prototype.routeMatchedHandler=function(a){i(this,a),k(this)};function i(a,b){a.matchedRouteQueue[a.matchedRouteQueue.length]=b}function j(a){
var b;return a.matchedRouteQueue.length>0&&(b=a.matchedRouteQueue[a.matchedRouteQueue.length-1]),a.matchedRouteQueue=[],b}function k(a){var b;a.loadModuleDeferred||(b=j(a))&&a.loadModule(b.module).done(a.raiseMatchedRoute.bind(a,b))}h.prototype.raiseMatchedRoute=function(a,module){var b={};if(b.arguments=a.arguments,b.screen=this.createScreenInstance(a,module),b.conn=this.createConnectionInstance(a,module),this.matchedRoute.raise(b),this.loadModuleDeferred=null,a.config&&a.config.isActionRoute){(new e).open(a,b)}k(this)},h.prototype.createScreenInstance=function(a,module){return a&&a.config&&a.config.member&&(module=module[a.config.member]),Object.resolve(module)},h.prototype.createConnectionInstance=function(a,module){return a&&a.config&&a.config.member&&(module=module[a.config.member]),Object.resolve(module)},h.prototype.badRouteHandler=function(){this.routeMatchedHandler(l())};function l(){return{arguments:{named:null,positional:[],url:"",icon:""},module:g}}
h.prototype.loadModule=function(module){return this.loadModuleDeferred=a.Deferred(),require([module],m.bind(null,this),n.bind(null,this)),this.loadModuleDeferred.promise()};function m(a,module){a.loadModuleDeferred.resolve(module)}function n(a,b){console.error(b),require([g],m.bind(null,a))}return h});

define('text!config/router-config.json',[],function () { return '[\r\n  {\r\n    "url": "teams/@key",\r\n    "module": "platform/teams/team-shell-view-model",\r\n    "icon": "tab-icon-resources",\r\n    "allow-small-screen": true\r\n  },\r\n  {\r\n    "url": "",\r\n    "module": "default-screen",\r\n    "allow-small-screen": true,\r\n    "available-offline": true,\r\n    "allow-tiny-screen": true,\r\n    "available-on-mobile": true\r\n  },\r\n  {\r\n    "url": "log",\r\n    "module": "system/diagnostics/log-view-model",\r\n    "icon": "tab-icon-error",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "security/*",\r\n    "module": "security/view-models/security-shell-view-model"\r\n  },\r\n  {\r\n    "url": "health/indicator/*",\r\n    "module": "health/screens/health-indicator-router-screen",\r\n    "icon": "tab-icon-health",\r\n    "allow-small-screen": true\r\n  },\r\n  {\r\n    "url": "health/overview",\r\n    "module": "health/screens/health-overview-screen",\r\n    "icon": "tab-icon-health",\r\n    "allow-small-screen": true\r\n  },\r\n  {\r\n    "url": "health/admin/*",\r\n    "module": "health/screens/health-admin-screen",\r\n    "icon": "tab-icon-health",\r\n    "allow-small-screen": true\r\n  },\r\n  {\r\n    "url": "nav",\r\n    "module": "shell/nav-config/configurable-navigation",\r\n    "icon": "tab-icon-default",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "health/*",\r\n    "module": "health/screens/health-summary-router-screen",\r\n    "icon": "tab-icon-health",\r\n    "allow-small-screen": true\r\n  },\r\n  {\r\n    "url": "rbi-admin-preferences/*",\r\n    "module": "mechanical-integrity/mi-admin-preferences/rbi-admin-preferences-shell-view-model",\r\n    "icon": "tab-icon-rbi"\r\n  },\r\n  {\r\n    "url": "rbi/*",\r\n    "module": "mechanical-integrity/rbi/ui/rbi-shell-view-model",\r\n    "icon": "tab-icon-rbi",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "im-admin-preferences/*",\r\n    "module": "mechanical-integrity/mi-admin-preferences/im-admin-preferences-shell-view-model",\r\n    "icon": "tab-icon-im"\r\n  },\r\n  {\r\n    "url": "tm-admin-preferences/*",\r\n    "module": "mechanical-integrity/mi-admin-preferences/tm-admin-preferences-shell-view-model",\r\n    "icon": "tab-icon-tm"\r\n  },\r\n  {\r\n    "url": "tm/*",\r\n    "module": "mechanical-integrity/tm/tm-shell-view-model",\r\n    "icon": "tab-icon-tm",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "im/*",\r\n    "module": "mechanical-integrity/im/ui/im-shell-view-model",\r\n    "icon": "tab-icon-im",\r\n    "allow-small-screen": true,\r\n    "available-offline": true,\r\n    "allow-tiny-screen": true,\r\n    "available-on-mobile": true\r\n  },\r\n  {\r\n    "url": "dataloggers/*",\r\n    "module": "mechanical-integrity/tm-dataloggers/tm-datalogger-shell-view-model"\r\n  },\r\n  {\r\n    "url": "dataset/overview/*",\r\n    "module": "dataset/ui/dataset-history-view-model",\r\n    "icon": "tab-icon-dataset",\r\n    "allow-small-screen": true\r\n  },\r\n  {\r\n    "url": "dataset/@key",\r\n    "module": "dataset/ui/dataset-history-view-model",\r\n    "icon": "tab-icon-dataset"\r\n  },\r\n  {\r\n    "url": "dataset/new/@datasetType",\r\n    "module": "dataset/ui/dataset-view-model",\r\n    "icon": "tab-icon-dataset"\r\n  },\r\n  {\r\n    "url": "dataset",\r\n    "module": "dataset/dataset-route",\r\n    "icon": "tab-icon-dataset"\r\n  },\r\n  {\r\n    "url": "datasheet/*",\r\n    "module": "platform/datasheets/layout/ui/datasheet-view-model"\r\n  },\r\n  {\r\n    "url": "asset-safety/hazards/*",\r\n    "module": "assetsafety/hazardsanalysis/hazards-analysis",\r\n    "icon": "tab-icon-hazards",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "asset-safety/sis/*",\r\n    "module": "assetsafety/sismanagement/sis-management",\r\n    "icon": "tab-icon-sism",\r\n    "allow-small-screen": true,\r\n    "available-offline": true,\r\n    "allow-tiny-screen": true,\r\n    "available-on-mobile": true\r\n  },\r\n  {\r\n    "url": "asset-safety/lopa/*",\r\n    "module": "assetsafety/lopa/lopa",\r\n    "icon": "tab-icon-lopa-module",\r\n    "allow-small-screen": true,\r\n    "available-offline": true,\r\n    "allow-tiny-screen": true\r\n  },\r\n  {\r\n    "url": "asset-safety/moc/*",\r\n    "module": "assetsafety/moc/moc",\r\n    "icon": "tab-icon-moc-module",\r\n    "allow-small-screen": true,\r\n    "available-offline": true,\r\n    "allow-tiny-screen": true\r\n  },\r\n  {\r\n    "url": "asset-safety/calibration/*",\r\n    "module": "assetsafety/calibration/calibration",\r\n    "icon": "tab-icon-calibration",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "policy/overview",\r\n    "module": "policies/classic/screens/classic-policy-overview-screen",\r\n    "icon": "tab-icon-policy",\r\n    "allow-small-screen": true\r\n  },\r\n  {\r\n    "url": "policy/admin",\r\n    "module": "policies/admin/screens/admin-screen",\r\n    "icon": "tab-icon-policy",\r\n    "allow-small-screen": true\r\n  },\r\n  {\r\n    "url": "policy/admin/exec-history",\r\n    "module": "policies/admin/screens/admin-screen",\r\n    "icon": "tab-icon-policy",\r\n    "allow-small-screen": true\r\n  },\r\n  {\r\n    "url": "policy/*",\r\n    "module": "policies/classic/screens/classic-policies-screen",\r\n    "icon": "tab-icon-policy"\r\n  },\r\n  {\r\n    "url": "family-policy/*",\r\n    "module": "policies/family/screens/family-policies-screen",\r\n    "icon": "tab-icon-policy"\r\n  },\r\n  {\r\n    "url": "connections/*",\r\n    "module": "connections/screens/connections-router-screen",\r\n    "icon": "tab-icon-security-manager"\r\n  },\r\n  {\r\n    "url": "failure-elimination/rca/dashboard/@assetkey",\r\n    "module": "failure-elimination/rca/ui/fe-dashboard-view-model",\r\n    "icon": "tab-icon-rca",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "failure-elimination/rca/@analysisKey/timelinefs",\r\n    "module": "failure-elimination/rca/ui/event-timeline-view-model",\r\n    "icon": "tab-icon-rca"\r\n  },\r\n  {\r\n    "url": "failure-elimination/rca/shell/@analysisKey/*",\r\n    "module": "failure-elimination/rca/ui/fe-shell-view-model",\r\n    "icon": "tab-icon-rca"\r\n  },\r\n  {\r\n    "url": "failure-elimination/rca/admin",\r\n    "module": "failure-elimination/rca/ui/rca-admin-view-model",\r\n    "icon": "tab-icon-rca",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "strategy",\r\n    "module": "strategy/asm/screens/strategy-overview-screen",\r\n    "icon": "tab-icon-asm",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "strategy/overview",\r\n    "module": "strategy/asm/screens/strategy-overview-screen",\r\n    "icon": "tab-icon-asm",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "strategy/asm",\r\n    "module": "strategy/asm/screens/strategy-overview-screen",\r\n    "icon": "tab-icon-asm",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "asi/import/results/@jobKey",\r\n    "module": "strategy/asm/import-results-view-model",\r\n    "icon": "tab-icon-asi",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "strategy/asm/@type/analysis/@key/*",\r\n    "module": "failure-elimination/reliability/system-reliability/system-shell-view-model",\r\n    "icon": "tab-icon-asm"\r\n  },\r\n  {\r\n    "url": "strategy/asi",\r\n    "module": "strategy/asi/screens/asi-overview-screen",\r\n    "icon": "tab-icon-asi",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "asi",\r\n    "module": "strategy/asi/screens/asi-overview-screen",\r\n    "icon": "tab-icon-asi",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "asi/overview",\r\n    "module": "strategy/asi/screens/asi-overview-screen",\r\n    "icon": "tab-icon-asi",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "asi/package/@key/*",\r\n    "module": "strategy/asi/screens/asi-package-shell-screen",\r\n    "icon": "tab-icon-asi",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "strategy/asi/admin/*",\r\n    "module": "strategy/asi/admin/asi-admin-shell",\r\n    "icon": "tab-icon-asi"\r\n  },\r\n  {\r\n    "url": "strategy/admin/*",\r\n    "module": "strategy/asm/screens/admin-screen",\r\n    "icon": "tab-icon-asm"\r\n  },\r\n  {\r\n    "url": "strategy/asi/package/@key/*",\r\n    "module": "strategy/asi/screens/asi-package-shell-screen",\r\n    "icon": "tab-icon-asi",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "strategy/asm/system/@key/*",\r\n    "module": "strategy/asm/screens/system-screen",\r\n    "icon": "tab-icon-asm",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "strategy/asm/unit/@key/*",\r\n    "module": "strategy/asm/screens/unit-screen",\r\n    "icon": "tab-icon-asm",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "strategy/asm/strategy/new/@assetKey",\r\n    "module": "strategy/asm/screens/strategy-screen",\r\n    "icon": "tab-icon-asm",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "strategy/asm/strategy/@key/*",\r\n    "module": "strategy/asm/screens/strategy-screen",\r\n    "icon": "tab-icon-asm",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "strategy/asm/template/@key/*",\r\n    "module": "strategy/asm/screens/template-screen",\r\n    "icon": "tab-icon-asm",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "strategy/rcmfmea/*",\r\n    "module": "strategy/rcm/screens/rcmfmea-shell-screen",\r\n    "icon": "tab-icon-rcm",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "rcm",\r\n    "module": "strategy/rcm/screens/rcm-overview-screen",\r\n    "icon": "tab-icon-rcm",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "rcm/overview",\r\n    "module": "strategy/rcm/screens/rcm-overview-screen",\r\n    "icon": "tab-icon-rcm",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "fmea",\r\n    "module": "strategy/rcm/screens/fmea-overview-screen",\r\n    "icon": "tab-icon-fmea",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "fmea/overview",\r\n    "module": "strategy/rcm/screens/fmea-overview-screen",\r\n    "icon": "tab-icon-fmea",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "strategy/rcm",\r\n    "module": "strategy/rcm/screens/rcm-overview-screen",\r\n    "icon": "tab-icon-rcm",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "strategy/rcm/*",\r\n    "module": "strategy/rcm/rcm-shell-screen",\r\n    "icon": "tab-icon-rcm",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "strategy/fmea",\r\n    "module": "strategy/rcm/screens/fmea-overview-screen",\r\n    "icon": "tab-icon-fmea",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "strategy/fmea/*",\r\n    "module": "strategy/rcm/fmea-shell-screen",\r\n    "icon": "tab-icon-fmea",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "external/*",\r\n    "module": "platform/external-module/external-module"\r\n  },\r\n  {\r\n    "url": "assets/*",\r\n    "module": "assets/assets-shell-view-model",\r\n    "icon": "tab-icon-asi",\r\n    "allow-small-screen": true,\r\n    "available-on-mobile": true\r\n  },\r\n  {\r\n    "url": "home",\r\n    "module": "home/home-view-model",\r\n    "icon": "tab-icon-dashboard",\r\n    "allow-small-screen": true,\r\n    "available-offline": true,\r\n    "available-on-mobile": true\r\n  },\r\n  {\r\n    "url": "dcm/family-management",\r\n    "module": "dcm/family-management-view-model"\r\n  },\r\n  {\r\n    "url": "dcm/manage-translations",\r\n    "module": "dcm/manage-translations-view-model"\r\n  },\r\n  {\r\n    "url": "dcm/system-codes-tables/*",\r\n    "module": "dcm/system-codes-and-tables-view-model"\r\n  },\r\n  {\r\n    "url": "dcm/units-of-measure",\r\n    "module": "dcm/units-of-measure-view-model"\r\n  },\r\n  {\r\n    "url": "dcm/units-of-measure/conversion/*",\r\n    "module": "dcm/uom-conversion-view-model"\r\n  },\r\n  {\r\n    "url": "dcm/units-of-measure/set-content/*",\r\n    "module": "dcm/uom-set-content-view-model"\r\n  },\r\n  {\r\n    "url": "dcm/content-validation",\r\n    "module": "dcm/content-validation-view-model",\r\n    "icon": "icon-content-validation"\r\n  },\r\n  {\r\n    "url": "licensing",\r\n    "module": "licensing/licensing-view-model"\r\n  },\r\n  {\r\n    "url": "monitoring",\r\n    "module": "security/view-models/monitoring-view-model"\r\n  },\r\n  {\r\n    "url": "query-timeout",\r\n    "module": "query-timeout/query-timeout-view-model"\r\n  },\r\n  {\r\n    "url": "ssrs",\r\n    "module": "ssrs/ssrs-view-model",\r\n    "icon": "tab-icon-report"\r\n  },\r\n  {\r\n    "url": "ssrs/config",\r\n    "module": "ssrs/ssrs-config-view-model",\r\n    "icon": "tab-icon-report"\r\n  },\r\n  {\r\n    "url": "ssrs/viewer/@catalogItemPathOrKey/@",\r\n    "module": "ssrs/report-viewer-view-model",\r\n    "icon": "tab-icon-report"\r\n  },\r\n  {\r\n    "url": "ssrs/viewer",\r\n    "module": "ssrs/ssrs-view-model",\r\n    "icon": "tab-icon-report",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "record-manager/*",\r\n    "module": "record-manager-v2/record-manager",\r\n    "icon": "tab-icon-record-manager",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "catalog-item/@",\r\n    "module": "catalog/catalog-item-route",\r\n    "icon": "tab-icon-catalog",\r\n    "allow-small-screen": true\r\n  },\r\n  {\r\n    "url": "catalog/*",\r\n    "module": "catalog/catalog-view-model",\r\n    "icon": "tab-icon-catalog",\r\n    "allow-small-screen": true\r\n  },\r\n  {\r\n    "url": "hello-world",\r\n    "module": "hello-world/ui/hello-world-view-model"\r\n  },\r\n  {\r\n    "url": "connect-data-import",\r\n    "module": "connect/connect-data-import-view-model",\r\n    "icon": "tab-icon-data-loaders"\r\n  },\r\n  {\r\n    "url": "connect-eam-jobs",\r\n    "module": "connect/connect-eam-jobs-view-model",\r\n    "icon": "tab-icon-data-loaders"\r\n  },\r\n  {\r\n    "url": "extractions/*",\r\n    "module": "extractors/extractions/screens/extractions-router-screen",\r\n    "icon": "tab-icon-security-manager"\r\n  },\r\n  {\r\n    "url": "ams-connection-config/*",\r\n    "module": "connections/viewmodels/amsconnection-properties-view-model",\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "dsb/@entitykey",\r\n    "module": "datasheet-builder/datasheet-builder-shell",\r\n    "icon": "tab-icon-default"\r\n  },\r\n  {\r\n    "url": "dsb/@entitykey/@familykey",\r\n    "module": "datasheet-builder/datasheet-builder-shell",\r\n    "icon": "tab-icon-default"\r\n  },\r\n  {\r\n    "url": "ge/*",\r\n    "module": "ge/screens/ge-router-screen",\r\n    "icon": "tab-icon-ge"\r\n  },\r\n  {\r\n    "url": "ams/overview",\r\n    "module": "ams/screens/ams-overview-screen",\r\n    "icon": "tab-icon-ams"\r\n  },\r\n  {\r\n    "url": "metrics/register-cube/*",\r\n    "module": "metrics/manage-cubes-view-model",\r\n    "icon": "tab-icon-mas"\r\n  },\r\n  {\r\n    "url": "metrics/metric-view/@metricViewKeyOrPath/@uniqNames",\r\n    "module": "metrics/metric-viewer-view-model",\r\n    "icon": "tab-icon-graph"\r\n  },\r\n  {\r\n    "url": "metrics/metric-view/@metricViewKeyOrPath",\r\n    "module": "metrics/metric-viewer-view-model",\r\n    "icon": "tab-icon-graph"\r\n  },\r\n  {\r\n    "url": "metricview/@metricViewKeyOrPath/@uniqNames",\r\n    "module": "metrics/metric-viewer-view-model",\r\n    "icon": "tab-icon-graph"\r\n  },\r\n  {\r\n    "url": "metricview/@metricViewKeyOrPath",\r\n    "module": "metrics/metric-viewer-view-model",\r\n    "icon": "tab-icon-graph"\r\n  },\r\n  {\r\n    "url": "metrics/metric-view-designer/@metricViewKeyOrPath",\r\n    "module": "metrics/metric-view-designer-view-model",\r\n    "icon": "tab-icon-mas"\r\n  },\r\n  {\r\n    "url": "metrics/home/*",\r\n    "module": "metrics/metrics-home-view-model",\r\n    "icon": "tab-icon-mas",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "metrics/backup/*",\r\n    "module": "metrics/home-view-model",\r\n    "icon": "tab-icon-mas"\r\n  },\r\n  {\r\n    "url": "metrics/kpi-designer/@kpiKey",\r\n    "module": "metrics/kpi-designer-view-model",\r\n    "icon": "tab-icon-mas"\r\n  },\r\n  {\r\n    "url": "metrics/kpi-viewer/@kpiKey",\r\n    "module": "metrics/kpi-viewer-view-model",\r\n    "icon": "tab-icon-mas"\r\n  },\r\n  {\r\n    "url": "metrics/scorecard-designer/@scorecardKey",\r\n    "module": "metrics/scorecard-designer-view-model",\r\n    "icon": "tab-icon-mas"\r\n  },\r\n  {\r\n    "url": "metrics/scorecard-tile-view/@scorecardKey",\r\n    "module": "metrics/scorecard-tile-view-model",\r\n    "icon": "tab-icon-mas"\r\n  },\r\n  {\r\n    "url": "panel",\r\n    "module": "ui/elements/panel/sample/panel-sample"\r\n  },\r\n  {\r\n    "url": "column",\r\n    "module": "ui/elements/column/sample/column-sample"\r\n  },\r\n  {\r\n    "url": "popover",\r\n    "module": "system/ui/sample/popover-sample"\r\n  },\r\n  {\r\n    "url": "import-export",\r\n    "module": "dcm/import-export-view-model"\r\n  },\r\n  {\r\n    "url": "export-import/*",\r\n    "module": "dcm/import-export-view-model"\r\n  },\r\n  {\r\n    "url": "rounds/mlgt-management/*",\r\n    "module": "rounds/designer/screens/mlgt-management",\r\n    "icon": "tab-icon-route-designer",\r\n    "allow-small-screen": true\r\n  },\r\n  {\r\n    "url": "rounds/update-existing-mls/@templatekey",\r\n    "module": "rounds/designer/screens/update-existing-mls",\r\n    "icon": "tab-icon-route-designer",\r\n    "allow-small-screen": true\r\n  },\r\n  {\r\n    "url": "rounds/route-management/*",\r\n    "module": "rounds/designer/screens/route-management",\r\n    "icon": "tab-icon-route-designer",\r\n    "allow-small-screen": true\r\n  },\r\n  {\r\n    "url": "rounds/dashboard/user",\r\n    "module": "rounds/data-collection/screens/rounds-user-overview",\r\n    "icon": "tab-icon-rounds",\r\n    "allow-small-screen": true,\r\n    "available-offline": true,\r\n    "allow-tiny-screen": true,\r\n    "available-on-mobile": true\r\n  },\r\n  {\r\n    "url": "rounds-inspection/@",\r\n    "module": "rounds/data-collection/screens/inspection-view",\r\n    "icon": "tab-icon-rounds",\r\n    "allow-small-screen": true,\r\n    "available-offline": true,\r\n    "allow-tiny-screen": true,\r\n    "available-on-mobile": true\r\n  },\r\n  {\r\n    "url": "rounds/dashboard/admin",\r\n    "module": "rounds/designer/screens/rounds-designer-overview",\r\n    "icon": "tab-icon-route-designer",\r\n    "allow-small-screen": true\r\n  },\r\n  {\r\n    "url": "rounds/admin/*",\r\n    "module": "rounds/rounds-admin/screens/rounds-admin-router-screen",\r\n    "icon": "tab-icon-rounds",\r\n    "allow-small-screen": true\r\n  },\r\n  {\r\n    "url": "query",\r\n    "module": "query/query-view-model",\r\n    "icon": "tab-icon-query",\r\n    "allow-small-screen": true\r\n  },\r\n  {\r\n    "url": "query/*",\r\n    "module": "query/query-editor-view-model",\r\n    "icon": "tab-icon-query"\r\n  },\r\n  {\r\n    "url": "qdetail/@key",\r\n    "module": "query/query-screen",\r\n    "icon": "tab-icon-query",\r\n    "allow-small-screen": true\r\n  },\r\n  {\r\n    "url": "dashboard",\r\n    "module": "dashboard/view-models/start-page-view-model",\r\n    "icon": "tab-icon-dashboard",\r\n    "allow-small-screen": true\r\n  },\r\n  {\r\n    "url": "dashboard/@",\r\n    "module": "dashboard/view-models/dashboard-view-model",\r\n    "icon": "tab-icon-dashboard",\r\n    "allow-small-screen": true\r\n  },\r\n  {\r\n    "url": "operations-manager/*",\r\n    "module": "operations-manager/shell-view-model"\r\n  },\r\n  {\r\n    "url": "connections/ssrs-config",\r\n    "module": "ssrs/ssrs-config-view-model"\r\n  },\r\n  {\r\n    "url": "report-config",\r\n    "module": "ssrs/report-config-view-model"\r\n  },\r\n  {\r\n    "url": "refdoc-server-config",\r\n    "module": "ref-doc-server/rds-config-view-model"\r\n  },\r\n  {\r\n    "url": "failure-elimination/pla/dashboard/@assetKey",\r\n    "module": "failure-elimination/pla/ui/pla-dashboard-view-model",\r\n    "icon": "tab-icon-pla",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "pla/admin/*",\r\n    "module": "failure-elimination/pla/ui/pla-admin-view-model",\r\n    "icon": "tab-icon-pla",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "calibration/admin/*",\r\n    "module": "assetsafety/calibration/admin/view-models/admin-view-model",\r\n    "icon": "tab-icon-calibration",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "failure-elimination/pla/prodloss/@lossKey",\r\n    "module": "failure-elimination/pla/ui/productionloss-view-model",\r\n    "icon": "tab-icon-pla",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "failure-elimination/pla/@plankey/*",\r\n    "module": "failure-elimination/pla/ui/pla-shell-view-model",\r\n    "icon": "tab-icon-pla"\r\n  },\r\n  {\r\n    "url": "aca/overview/*",\r\n    "module": "aca/screens/overview-screen",\r\n    "icon": "tab-icon-aca",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "aca/analysis/@analysiskey/*",\r\n    "module": "aca/screens/analysis-shell-screen",\r\n    "icon": "tab-icon-aca"\r\n  },\r\n  {\r\n    "url": "aca",\r\n    "module": "aca/screens/overview-screen",\r\n    "icon": "tab-icon-aca",\r\n    "allow-small-screen": true\r\n  },\r\n  {\r\n    "url": "aca/@analysisKey/*",\r\n    "module": "aca/screens/analysis-shell-screen",\r\n    "icon": "tab-icon-aca",\r\n    "allow-small-screen": true\r\n  },\r\n  {\r\n    "url": "graph",\r\n    "module": "chart/chart-start-page-view-model",\r\n    "icon": "tab-icon-graph",\r\n    "allow-small-screen": true\r\n  },\r\n  {\r\n    "url": "graph/@key/@querykey",\r\n    "module": "chart/chart-builder-view-model",\r\n    "icon": "tab-icon-graph",\r\n    "allow-small-screen": true\r\n  },\r\n  {\r\n    "url": "graph/@key",\r\n    "module": "chart/chart-builder-view-model",\r\n    "icon": "tab-icon-graph",\r\n    "allow-small-screen": true\r\n  },\r\n  {\r\n    "url": "graph-preview/@key",\r\n    "module": "chart/chart-preview-view-model",\r\n    "icon": "tab-icon-graph",\r\n    "allow-small-screen": true\r\n  },\r\n  {\r\n    "url": "admin-menu/*",\r\n    "module": "admin-menu/view-models/admin-menu-view-model",\r\n    "allow-small-screen": true\r\n  },\r\n  {\r\n    "url": "scheduling/dashboard",\r\n    "module": "scheduling/scheduling-dashboard-view-model",\r\n    "icon": "tab-icon-scheduling"\r\n  },\r\n  {\r\n    "url": "scheduling/downloads",\r\n    "module": "scheduling/job-downloads-view-model",\r\n    "icon": "tab-icon-report"\r\n  },\r\n  {\r\n    "url": "failure-elimination/ra/admin",\r\n    "module": "failure-elimination/reliability/admin/ui/reliability-admin-view-model",\r\n    "icon": "tab-icon-ra"\r\n  },\r\n  {\r\n    "url": "reliability/dashboard/@assetKey",\r\n    "module": "failure-elimination/reliability/common/ui/reliability-dashboard-view-model",\r\n    "icon": "tab-icon-ra",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "reliability/spares/@key/*",\r\n    "module": "failure-elimination/reliability/spares/ui/spares-analysis-shell-view-model",\r\n    "icon": "tab-icon-ra"\r\n  },\r\n  {\r\n    "url": "reliability/probability/@key/*",\r\n    "module": "failure-elimination/reliability/probability/ui/probability-shell-view-model",\r\n    "icon": "tab-icon-ra"\r\n  },\r\n  {\r\n    "url": "reliability/production/@key/*",\r\n    "module": "failure-elimination/reliability/production/ui/production-analysis-shell-view-model",\r\n    "icon": "tab-icon-ra"\r\n  },\r\n  {\r\n    "url": "reliability/distribution/@key/*",\r\n    "module": "failure-elimination/reliability/distribution/distribution-shell-view-model",\r\n    "icon": "tab-icon-ra"\r\n  },\r\n  {\r\n    "url": "reliability/growth/@key/*",\r\n    "module": "failure-elimination/reliability/growth/ui/growth-shell-view-model",\r\n    "icon": "tab-icon-ra"\r\n  },\r\n  {\r\n    "url": "reliability/growthCompare/@keyString",\r\n    "module": "failure-elimination/reliability/growth/ui/growth-compare-view-model",\r\n    "icon": "tab-icon-ra"\r\n  },\r\n  {\r\n    "url": "reliability/automation/@key/*",\r\n    "module": "failure-elimination/reliability/automation/automation-shell-view-model",\r\n    "icon": "tab-icon-ra"\r\n  },\r\n  {\r\n    "url": "reliability/system/@key/*",\r\n    "module": "failure-elimination/reliability/system-reliability/system-shell-view-model",\r\n    "icon": "tab-icon-ra"\r\n  },\r\n  {\r\n    "url": "reliability/distributionCompare/@keyString",\r\n    "module": "failure-elimination/reliability/distribution/distribution-compare-view-model",\r\n    "icon": "tab-icon-ra"\r\n  },\r\n  {\r\n    "url": "reliability/productionAnalysisCompare/@keyString",\r\n    "module": "failure-elimination/reliability/production/ui/production-analysis-compare-view-model",\r\n    "icon": "tab-icon-ra"\r\n  },\r\n  {\r\n    "url": "rscript",\r\n    "module": "rscript/screens/rscript-catalog-screen",\r\n    "icon": "tab-icon-rscript",\r\n    "allow-small-screen": true\r\n  },\r\n  {\r\n    "url": "rscript/@key",\r\n    "module": "rscript/screens/rscript-editor-screen",\r\n    "icon": "tab-icon-rscript"\r\n  },\r\n  {\r\n    "url": "reliability/probabilityCompare/@keyString",\r\n    "module": "failure-elimination/reliability/probability/ui/probability-compare-view-model",\r\n    "icon": "tab-icon-ra"\r\n  },\r\n  {\r\n    "url": "logging/*",\r\n    "module": "logging/logger-viewmodel"\r\n  },\r\n  {\r\n    "url": "errorlog/*",\r\n    "module": "logging/logger-viewmodel"\r\n  },\r\n  {\r\n    "url": "undercon",\r\n    "module": "status-pages/under-construction/under-construction-view-model",\r\n    "icon": "tab-icon-under-construction",\r\n    "allow-small-screen": true,\r\n    "available-offline": true,\r\n    "allow-tiny-screen": true\r\n  },\r\n  {\r\n    "url": "risk-matrix",\r\n    "module": "risk-matrix/risk-matrix-admin-view-model",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "risk-matrix/preview",\r\n    "module": "risk-matrix/risk-matrix-preview",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "risk-matrix/definition/*",\r\n    "module": "risk-matrix/risk-matrix-shell-view-model",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "security/manager/emailsettings",\r\n    "module": "security/view-models/email-settings-view-model"\r\n  },\r\n  {\r\n    "url": "ssologin",\r\n    "module": "security/view-models/sso-login-view-model"\r\n  },\r\n  {\r\n    "url": "urlnotsupported",\r\n    "module": "status-pages/url-not-supported/url-not-supported-view-model",\r\n    "icon": "tab-icon-url-not-supported",\r\n    "allow-small-screen": true,\r\n    "available-offline": true,\r\n    "allow-tiny-screen": true\r\n  },\r\n  {\r\n    "url": "not-available",\r\n    "module": "status-pages/not-available-offline/feature-not-available-view-model",\r\n    "icon": "tab-icon-not-available-offline",\r\n    "allow-small-screen": true,\r\n    "available-offline": true,\r\n    "allow-tiny-screen": true\r\n  },\r\n  {\r\n    "url": "macros/macrorunner",\r\n    "module": "macros/view-models/macro-runner-view-model"\r\n  },\r\n  {\r\n    "url": "access-denied",\r\n    "module": "status-pages/access-denied/access-denied-view-model",\r\n    "icon": "tab-icon-access-denied",\r\n    "allow-small-screen": true,\r\n    "available-offline": true,\r\n    "allow-tiny-screen": true\r\n  },\r\n  {\r\n    "url": "invalid-screen-size",\r\n    "module": "status-pages/invalid-screen-size/invalid-screen-size-view-model",\r\n    "icon": "tab-icon-invalid-screen-size",\r\n    "allow-small-screen": true,\r\n    "available-offline": true,\r\n    "allow-tiny-screen": true\r\n  },\r\n  {\r\n    "url": "empty-page",\r\n    "module": "status-pages/empty-page/empty-page-view-model",\r\n    "allow-small-screen": true,\r\n    "available-offline": true,\r\n    "allow-tiny-screen": true\r\n  },\r\n  {\r\n    "url": "systems-and-tags/*",\r\n    "module": "systems-and-tags/screens/systags-router-screen",\r\n    "icon": "tab-icon-ge"\r\n  },\r\n  {\r\n    "url": "bdf-screen/*",\r\n    "module": "platform/datasheets/bdf-screen",\r\n    "icon": "tab-icon-view-bulkdata",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "form-builder/@familykey",\r\n    "module": "offline-forms/designer/offline-form-designer",\r\n    "icon": "tab-icon-view-bulkdata",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "form-builder/@familykey/@formKey",\r\n    "module": "offline-forms/designer/offline-form-designer",\r\n    "icon": "tab-icon-view-bulkdata",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "gaa/admin/*",\r\n    "module": "failure-elimination/gaa/ui/gaa-admin-shell-view-model",\r\n    "icon": "tab-icon-gaa-module",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "gaa-wind/admin/*",\r\n    "module": "gaa-wind/ui/gaa-wind-admin-shell-view-model",\r\n    "icon": "tab-icon-gaa-wind-module",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "mas/canvas",\r\n    "module": "mas/canvas/view-models/main-view-model"\r\n  },\r\n  {\r\n    "url": "lcc/dashboard/@assetKey",\r\n    "module": "failure-elimination/lcc/ui/lcc-dashboard-view-model",\r\n    "icon": "tab-icon-lcc-module",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "lcc/@analysisKey/*",\r\n    "module": "failure-elimination/lcc/ui/lcc-shell-view-model",\r\n    "icon": "tab-icon-lcc-module",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "elog/dashboard/0/*",\r\n    "module": "elog/ui/ElogDashboardViewModel",\r\n    "icon": "tab-icon-elog-module",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "elog/dashboard/shift-summary/@shiftKey/*",\r\n    "module": "elog/ui/ElogShiftSummaryViewModel",\r\n    "icon": "tab-icon-elog-module",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "elog/logentry/@logentrykey/*",\r\n    "module": "elog/ui/elog-entry-shell-view-model",\r\n    "icon": "tab-icon-elog-module",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "elog/newlogentry/@logkey",\r\n    "module": "elog/ui/GenerationEventLogEntryViewModel",\r\n    "icon": "tab-icon-elog-module",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "elog/admin/*",\r\n    "module": "elog/ui/ElogAdminViewModel",\r\n    "icon": "tab-icon-elog-module",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "offline-forms",\r\n    "module": "offline-forms/viewer/offline-form-viewer",\r\n    "icon": "tab-icon-view-bulkdata",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "content-management",\r\n    "module": "content-management/ui/home/home-view-model"\r\n  },\r\n  {\r\n    "url": "content-management/projects/@projectKey",\r\n    "module": "content-management/ui/shell/project-shell-view-model"\r\n  },\r\n  {\r\n    "url": "content-management/projects/@projectKey/changesets/@changesetKey",\r\n    "module": "content-management/ui/shell/project-shell-view-model"\r\n  },\r\n  {\r\n    "url": "content-management/admin",\r\n    "module": "content-management/ui/admin/admin-view-model"\r\n  },\r\n  {\r\n    "url": "gaa/dashboard/@key",\r\n    "module": "failure-elimination/gaa/ui/gaa-dashboard-view-model",\r\n    "icon": "tab-icon-gaa-module",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "gaa-wind/dashboard/@key",\r\n    "module": "gaa-wind/ui/gaa-wind-dashboard-view-model",\r\n    "icon": "tab-icon-gaa-wind-module",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "gaa-wind/editEvents",\r\n    "module": "gaa-wind/ui/gaa-wind-edit-events-view-model",\r\n    "icon": "tab-icon-gaa-wind-module",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "gaa-wind/*",\r\n    "module": "gaa-wind/ui/gaa-wind-main-shell-view-model",\r\n    "icon": "tab-icon-gaa-wind-module",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "gaa/*",\r\n    "module": "failure-elimination/gaa/ui/gaa-main-shell-view-model",\r\n    "icon": "tab-icon-gaa-module",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "gis-config",\r\n    "module": "gis/configuration/view-models/gis-configuration-view-model",\r\n    "icon": "tab-icon-gm",\r\n    "allow-small-screen": true\r\n  },\r\n  {\r\n    "url": "maps",\r\n    "module": "gis/ui/start-page/map-start-page-view-model",\r\n    "icon": "tab-icon-gis",\r\n    "allow-small-screen": true\r\n  },\r\n  {\r\n    "url": "map/@",\r\n    "module": "gis/ui/map/map-screen",\r\n    "icon": "tab-icon-gis",\r\n    "allow-small-screen": true\r\n  },\r\n  {\r\n    "url": "cognitive/*",\r\n    "module": "cognitive/shell-view-model",\r\n    "icon": "tab-icon-cognitive-analytics"\r\n  },\r\n  {\r\n    "url": "script",\r\n    "module": "script/screen/catalog-screen",\r\n    "icon": "tab-icon-scripts"\r\n  },\r\n  {\r\n    "url": "script/@key/@",\r\n    "module": "script/screen/edit-screen",\r\n    "icon": "tab-icon-scripts"\r\n  },\r\n  {\r\n    "url": "iframe",\r\n    "module": "iframe/iframe-view-model",\r\n    "icon": "tab-icon-dashboard",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "recommendation-management",\r\n    "module": "strategy/action-management/screens/action-management-screen",\r\n    "icon": "tab-icon-recommendation-manager",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "action-management/*",\r\n    "module": "strategy/action-management/screens/action-management-screen",\r\n    "icon": "tab-icon-recommendation-manager",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "apmmonitoring/config",\r\n    "module": "apmsm/ui/configuration/config-view-model"\r\n  },\r\n  {\r\n    "url": "apmmonitoring/config/agents/@id",\r\n    "module": "apmsm/ui/configuration/config-view-model"\r\n  },\r\n  {\r\n    "url": "apmmonitoring",\r\n    "module": "apmsm/ui/dashboards/et-overview-view-model",\r\n    "icon": "tab-icon-asm",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "apmmonitoring/MoreDetails",\r\n    "module": "apmsm/ui/dashboards/et-more-details.view-model",\r\n    "icon": "tab-icon-asm",\r\n    "allow-small-screen": true\r\n  },\r\n  {\r\n    "url": "performancedatasheet/@unitkey/@performanceSummaryKey/@reportingmonth/@reportingyear/@configurationkey",\r\n    "module": "failure-elimination/gaa/ui/performance-datasheet-summary-view-model",\r\n    "icon": "tab-icon-gaa-module"\r\n  },\r\n  {\r\n    "url": "bulkevent/@mode",\r\n    "module": "failure-elimination/gaa/ui/bulk-primary-event-view-model",\r\n    "icon": "tab-icon-gaa-module",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "advsearch",\r\n    "module": "advanced-search/ui/home/advsearch-landing-view-model",\r\n    "icon": "tab-icon-adv-search",\r\n    "allow-small-screen": true\r\n  },\r\n  {\r\n    "url": "advsearch/@key",\r\n    "module": "advanced-search/ui/editor/editor-view-model",\r\n    "icon": "tab-icon-adv-search",\r\n    "allow-small-screen": true\r\n  },\r\n  {\r\n    "url": "event/@logKey/@type",\r\n    "module": "failure-elimination/gaa/ui/create-primary-event-view-model",\r\n    "icon": "tab-icon-gaa-module",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "calendar-expanded-view",\r\n    "module": "ui/react/calendar/calendar-expanded-view-model",\r\n    "icon": "tab-icon-calendar"\r\n  },\r\n  {\r\n    "url": "app-hub/*",\r\n    "module": "app-hub/app-hub-view-model",\r\n    "allow-small-screen": true\r\n  },\r\n  {\r\n    "url": "url/*",\r\n    "module": "app-hub/url-view-model",\r\n    "allow-small-screen": true\r\n  },\r\n  {\r\n    "url": "calendar-expanded-view/db/@dbKey/@widgetId",\r\n    "module": "ui/react/calendar/calendar-expanded-view-model",\r\n    "icon": "tab-icon-calendar"\r\n  },\r\n  {\r\n    "url": "monitoring/admin/perf-mon",\r\n    "module": "monitoring/admin/perf-mon-view-model"\r\n  },\r\n  {\r\n    "url": "eventhistory/@primaryEventKey",\r\n    "module": "failure-elimination/gaa/ui/primary-event-history-view-model",\r\n    "icon": "tab-icon-gaa-module",\r\n    "allow-small-screen": true,\r\n    "available-offline": true\r\n  },\r\n  {\r\n    "url": "eventimport",\r\n    "module": "gaa-wind/ui/gaa-wind-event-import-view-model",\r\n    "icon": "tab-icon-gaa-wind-module",\r\n    "allow-small-screen": true\r\n  },\r\n  {\r\n    "url": "subgrouphistory/@subGroupKey",\r\n    "module": "gaa-wind/ui/gaa-wind-subgroup-history-view-model",\r\n    "icon": "tab-icon-gaa-wind-module",\r\n    "allow-small-screen": true\r\n  },\r\n  {\r\n    "url": "windperformance/@subGroupkey/@performancekey/@reportingmonth/@reportingyear/@configurationkey",\r\n    "module": "gaa-wind/ui/gaa-wind-performance-datasheet-view-model",\r\n    "icon": "tab-icon-gaa-wind-module",\r\n    "allow-small-screen": true\r\n  },\r\n  {\r\n    "url": "cm/*",\r\n    "module": "mechanical-integrity/im/ui/compliance/cm-shell-view-model",\r\n    "icon": "tab-icon-compliance",\r\n    "allow-small-screen": true,\r\n    "available-offline": false,\r\n    "allow-tiny-screen": false\r\n  }\r\n]\r\n';});


define('text!config/tab-icons.json',[],function () { return '{\r\n  "tab-icon-default": "default-icon",\r\n  "tab-icon-error": "sprite-ic ic-t-err",\r\n  "tab-icon-health": "ic-p-ahm",\r\n  "tab-icon-ge": "icon-ge-analytics",\r\n  "tab-icon-ams": "icon-ams-analytics",\r\n  "tab-icon-rbi": "sprite-ic ic-r-rbi",\r\n  "tab-icon-tm": "sprite-ic ic-s-tm",\r\n  "tab-icon-im": "sprite-ic ic-s-im",\r\n  "tab-icon-im-field-data-collection": "icon-inspection-field-data-collection",\r\n  "tab-icon-compliance":  "icon-compliance",\r\n  "tab-icon-dataset": "sprite-ic ic-t-dat",\r\n  "tab-icon-policy": "icon-policy-new",\r\n  "tab-icon-sism": "sprite-ic ic-r-sism",\r\n  "tab-icon-calibration": "sprite-ic ic-s-cm",\r\n  "tab-icon-rca": "sprite-ic ic-p-rca",\r\n  "tab-icon-aso": "sprite-ic ic-s-aso",\r\n  "tab-icon-asi": "sprite-ic ic-s-asi",\r\n  "tab-icon-asm": "sprite-ic ic-s-asm",\r\n  "tab-icon-fmea": "sprite-ic ic-r-rca",\r\n  "tab-icon-rcm": "sprite-ic ic-r-rcm",\r\n  "tab-icon-report": "sprite-ic ic-t-rep",\r\n  "tab-icon-catalog": "sprite-ic ic-t-cat",\r\n  "tab-icon-mas": "sprite-ic ic-p-mas",\r\n  "tab-icon-rounds": "icon-rounds-new",\r\n  "tab-icon-route-designer": "icon-route-designer-new",\r\n  "tab-icon-query": "sprite-ic ic-t-que",\r\n  "tab-icon-dashboard": "icon-general-dashboards",\r\n  "tab-icon-pla": "sprite-ic ic-p-pla",\r\n  "tab-icon-aca": "sprite-ic ic-r-aca",\r\n  "tab-icon-graph": "sprite-ic ic-t-gra",\r\n  "tab-icon-security-manager": "sprite-ic ic-a-sm",\r\n  "tab-icon-operations-manager": "sprite-ic ic-a-om",\r\n  "tab-icon-data-config": "sprite-ic ic-a-cm",\r\n  "tab-icon-application-settings": "sprite-ic ic-a-smfc",\r\n  "tab-icon-ra": "sprite-ic ic-p-ra",\r\n  "tab-icon-hazards": "sprite-ic ic-r-ha",\r\n  "tab-icon-record-manager": "icon-record-manager",\r\n  "tab-icon-recommendation-manager": "icon-recommendation-manager",\r\n  "tab-icon-scheduling": "icon-calendar",\r\n  "tab-icon-url-not-supported": "icon-url-not-supported",\r\n  "tab-icon-not-available-offline": "icon-not-available-offline",\r\n  "tab-icon-access-denied": "icon-access-denied",\r\n  "tab-icon-invalid-screen-size": "icon-invalid-screen-size",\r\n  "tab-icon-under-construction": "icon-under-construction",\r\n  "tab-icon-rscript": "icon-r-node",\r\n  "tab-icon-view-bulkdata": "icon-record-manager",\r\n  "tab-icon-data-loaders": "icon-data-loaders",\r\n  "tab-icon-cognitive-analytics": "icon-cognitive-analytics",\r\n  "tab-icon-scripts": "icon-scripts",\r\n  "tab-icon-data-hub": "icon-data-hub",\r\n  "tab-icon-gis": "icon-map-module",\r\n  "tab-icon-gaa-module": "icon-gaa-module",\r\n  "tab-icon-gaa-wind-module": "icon-gaa-wind",\r\n  "tab-icon-lcc-module": "icon-lcc",\r\n  "tab-icon-lopa-module": "icon-lopa",\r\n  "tab-icon-calendar":  "icon-full-calendar",\r\n  "tab-icon-adv-search": "icon-advanced-search",\r\n  "tab-icon-proof-test": "icon-proof-test",\r\n  "tab-icon-safety-lifecycle-management": "icon-safety-lifecycle-management",\r\n  "tab-icon-elog-module": "icon-elog",\r\n  "tab-icon-moc-module": "icon-moc",\r\n  "tab-icon-alert-small": "icon-alert-small",\r\n  "tab-icon-predix-default": "sprite-ic ic-s-asm",\r\n  "tab-icon-predix-alert-template": "icon-predix-alert-template",\r\n  "tab-icon-alerts-templates": "icon-alerts-templates",\r\n  "tab-icon-predix-analysis": "icon-predix-analysis",\r\n  "tab-icon-predix-assets": "icon-predix-assets",\r\n  "tab-icon-predix-analytics": "icon-predix-analytics",\r\n  "tab-icon-predix-cases": "icon-predix-cases",\r\n  "tab-icon-predix-case-template": "icon-predix-case-template",\r\n  "tab-icon-predix-analytics-orchestration": "icon-predix-analytics-orchestration",\r\n  "tab-icon-predix-dashboards": "icon-predix-dashboards",\r\n  "tab-icon-predix-admin": "icon-predix-admin",\r\n  "tab-icon-predix-user-preferences": "icon-predix-user-preferences",\r\n  "tab-icon-predix-user-profile-icon": "icon-predix-user-profile-icon",\r\n  "tab-icon-resources": "icon-resources"\r\n}\r\n';});

define('shell/tab-view-model',["require","exports","ramda","spa/conductor","system/globalization/translator","system/lang/ioc","./models/tab-storage","spa/router","text!config/router-config.json","text!config/tab-icons.json","system/text/formatter"],function(require,exports,a,b,c,d,e){"use strict";var f=require("system/text/formatter"),g=require("spa/router"),h=require("text!config/router-config.json"),i=require("text!config/tab-icons.json"),j=JSON.parse(h),k=JSON.parse(i),l=a.eqProps("screen"),m=a.compose(a.not,l),n=7,o="tab-icon-default",p=function(){function b(b,e,f,g){this.delay=a.curry(function(a,b){setTimeout(a.bind(null,b),20)}),this.openBackground=a.curry(function a(b,c){c.setRouteInfo(c,b),c.conductor&&c.conductor.openScreen(c.getScreen(),c.getRouteInfo(c).arguments)}),this.openForeground=a.curry(function a(b,c){var d,e;e={isClosing:!1,checkForReuse:c.checkForReuse(c)},c.setRouteInfo(c,b),d=c.getContentRegion(c),c.conductor&&c.conductor.changeScreen(c.getScreen(),d,c.getRouteInfo(c).arguments,e),
m(c.getRouteInfo(c),d)&&c.setScreen(c,d.screen)}),this.__private__={background:!1,contentRegion:null,title:"",fullTitle:"",href:"",icon:"",routeInfo:null,id:g},this.router=b,this.conductor=e,this.formatter=f,this.translator=d.resolve(c),this.router.routerConfig=j,this.iconMap=k}return b.prototype.open=function(a,b,c,d){this.setContentRegion(this,a),this.setIsBackground(this,c===!0),this.router.matchedRoute.add(this.route,this,this),this.router.activate(),this.resolveRouter(this,b,d),this.setHref(b),this.translator&&this.setFullTitle(this.translator.translate("NEW_TAB"))},b.prototype.getIsBackground=function(a){return a.__private__.background},b.prototype.setIsBackground=function(a,b){a.__private__.background=b},b.prototype.getHref=function(){return this.__private__.href},b.prototype.setHref=function(a){this.__private__.href=a},b.prototype.getTitle=function(){return this.__private__.title},b.prototype.getFullTitle=function(){return this.__private__.fullTitle},
b.prototype.setTitle=function(a,b){a.__private__.title=b},b.prototype.setFullTitle=function(a){this.__private__.fullTitle=a,this.setTitle(this,this.abbreviateTitle(this,a))},b.prototype.abbreviateTitle=function(a,b){return a.formatter.abbreviate(b,n)},b.prototype.route=function(b,c){c.arguments&&(void 0!==c.arguments.icon&&b.setIcon(c.arguments.icon),a.cond([[b.getIsBackground,b.delay(b.openBackground(c))],[a.T,b.delay(b.openForeground(c))]])(b))},b.prototype.checkForReuse=function(a){return l(a.getRouteInfo(a),a.getContentRegion(a))},b.prototype.getRouteInfo=function(b){return a.defaultTo({},b.__private__.routeInfo)},b.prototype.setRouteInfo=function(a,b){a.__private__.routeInfo=b},b.prototype.getContentRegion=function(a){return a.__private__.contentRegion},b.prototype.setContentRegion=function(a,b){a.__private__.contentRegion=b},b.prototype.update=function(a,b,c){if(this.setIsBackground(this,!b),this.needToResolveRoute(this,a,b,c))return this.setHref(a),
void this.resolveRouter(this,a,c);b&&this.route(this,this.getRouteInfo(this))},b.prototype.needToResolveRoute=function(b,c,d,e){return!b.isUrlSame(c)||(!!a.isNil(b.getRouteInfo(b))||!(!d||!e))},b.prototype.isUrlSame=function(a){return this.getHref()===a},b.prototype.resolveRouter=function(a,b,c){a.router.resolve(b,c)},b.prototype.setIcon=function(a){this.__private__.icon=a},b.prototype.getIcon=function(){return this.__private__.icon},b.prototype.getIconImage=function(){return this.isFontAwesomeIcon(this)?this.getIcon()+" font-awesome-icon-style":this.iconMap?this.iconMap[a.defaultTo(o,this.getIcon())]:a.defaultTo(o,this.getIcon())},b.prototype.isFontAwesomeIcon=function(a){return 0===a.getIcon().lastIndexOf("fa",0)},b.prototype.close=function(){this.conductor&&(l(this.getContentRegion(this),this.getRouteInfo(this))?this.conductor.clearScreen(this.getContentRegion(this)):this.getRouteInfo(this)&&(this.conductor.unloadScreen(this.getScreen()),
this.conductor.closeScreen(this.getScreen()))),this.router.matchedRoute.remove(),this.router.deactivate(),this.router=null,this.conductor=null,this.setRouteInfo(this,null),this.translator=null,this.iconMap=null,this.setContentRegion(this,null)},b.prototype.canUnload=function(a){this.hasCanUnload(this)?this.callCanUnload(this,a):a()},b.prototype.hasCanUnload=function(a){return a.getScreen()&&a.getScreen().canUnload},b.prototype.callCanUnload=function(a,b){var c;c=a.getScreen().canUnload(),c instanceof Object&&c.done?c.done(b):c===!0&&b()},b.prototype.isDirty=function(){var b=Object,c=a;return c.cond([[c.isNil,c.F],[c.T,c.compose(c.not,c.not,c.flip(b.tryMethod)("isDirty"))]])(this.getScreen())},b.prototype.getScreen=function(){return a.prop("screen",a.defaultTo({},this.getRouteInfo(this)))},b.prototype.setScreen=function(a,b){a.getRouteInfo(a).screen=b},b.prototype.getStorage=function(){return e.newTabStorage(this.getId())},b.prototype.getId=function(){return this.__private__.id},b}()
;return p=__decorate([d.dependsOn(g,b,f)],p)});
define('spa/url-manager',['require','ramda','bluebird','system/lang/event','system/lang/functional'],function(require){"use strict";var a=require("ramda"),b=require("bluebird"),c=require("system/lang/event"),d=require("system/lang/functional"),e="hashchange",f=/^#/;function g(a,b){this.eventSource=a,this.location=this.eventSource.location,this.strategy=b,this.routesChanged=new c,this.routeInfo=null}g.prototype.activate=function(){h(this),this.handleEvent()};function h(a){a.eventSource.addEventListener(e,a)}g.prototype.handleEvent=function(a){var b=this.parse(this.location.hash.replace(f,""));if(this.strategy.removeQueryString&&b.query)return this.overrideHash(b.routes,b.active).then(i.bind(null,this,b));i(this,b)},g.prototype.parse=function(a){return this.strategy.parse(a)};function i(a,b){a.routeInfo=b,a.onRoutesChanged()}g.prototype.overrideHash=function(a,c,e){var f=this;return new b(function(b){j(f),f.location.replace(f.strategy.getHash(a,c,e)),d.defer(k.bind(null,f,b))})};function j(a){a.eventSource.removeEventListener(e,a)}function k(a,b){h(a),b()}
g.prototype.onRoutesChanged=function(a){a=a||this.routeInfo,this.routesChanged.raise(a)},g.prototype.setHash=function(a,b,c,d){b=l(a,d,b),this.location.hash=this.strategy.getHash(a,b,c,d)},g.prototype.replaceHash=function(a,b,c,d){b=l(a,d,b);var e=this.strategy.getHash(a,b,c,d);this.location.replace(e)};function l(a,b,c){var d=a[a.length-1],e=a.indexOf(d),f=a.lastIndexOf(d),g=e!==f;return b&&b.reuseTab&&g&&(a.pop(),c=a.indexOf(d)),c}return g.prototype.refresh=function(){var b=a.clone(this.routeInfo);b.routes[b.active]="empty-page",this.onRoutesChanged(b),this.onRoutesChanged()},g});
define('shell/tab-bar-view-model',["require","exports","ramda","jquery","application/application-events","./models/tab-storage","spa/region","ui/screen-size","./models/tab-id","shell/route-overflow/context-updater","system/lang/ioc","./tab-view-model","mithril","spa/url-manager","security/view-models/login-view-model","system/lang/unique-id"],function(require,exports,a,b,c,d,e,f,g,h,i,j){"use strict";var k=require("mithril"),l=require("spa/url-manager"),m=require("security/view-models/login-view-model"),n=require("system/lang/unique-id"),o="section.content",p="tab-ids",q=a,r=function(){function c(b,c){this.updateTab=a.curry(function a(b,c,d,e){var f=b.isActiveTab(e);e.update(d,f,f?c:void 0)}),this.createTab=a.curry(function a(b,c,d){var e=i.resolve(j,b.provideTabId(b)),f=b.getTabs(b).length!==b.getActiveTabIndex();e.open(b.getContentRegion(b),d,f,f?void 0:c),b.getTabs(b).push(e),f||b._title(e.getTitle())}),this.__private__={tabs:[],activeTabIndex:0,lastActiveVariableTab:2,isOverflowTabVisible:!1,
contentRegion:new e(null),nextTabId:null,storage:d.newTabBarStorage(),initialized:!1},this.appEvents=b,this.urlManager=c,this.screenSize=i.resolve(f)}return c.prototype.getTabs=function(a){return a.__private__.tabs},c.prototype.setTabs=function(a,b){a.__private__.tabs=b},c.prototype.getHomeTab=function(){return this.getTabs(this)[0]},c.prototype.getAssetHierarchyTab=function(){return this.getTabs(this)[1]},c.prototype.clearTabs=function(){this.__private__.tabs=[]},c.prototype.getActiveTabIndex=function(){return this.__private__.activeTabIndex},c.prototype.getActiveTab=function(){return this.getTabs(this)[this.getActiveTabIndex()]},c.prototype.isHomeScreenActive=function(){var a=this.getActiveTab();return!a||(this.isSmallScreen()?"rounds/dashboard/user"===a.getHref():this.isActiveTab(this.getHomeTab()))},c.prototype.setActiveTabIndex=function(a){this.__private__.activeTabIndex=a,a>1&&this.setLastActiveVariableTab(this,a-2)},c.prototype.getLastActiveVariableTab=function(){
return this.__private__.lastActiveVariableTab},c.prototype.setLastActiveVariableTab=function(a,b){a.__private__.lastActiveVariableTab=b},c.prototype.isActiveTabHrefSame=function(a){return this.getActiveTab().isUrlSame(a)},c.prototype.isActiveTab=function(b){return a.equals(this.getActiveTab(),b)},c.prototype.attach=function(){this.initNextTabId(this),this.initContentRegion(this),this.appEvents.titleChanged.add(this.changeTitle,this,this),this.appEvents.iconChanged.add(this.changeIcon,this,this),this.appEvents.bulkClose.add(this.bulkClose,this,this),window.addEventListener("click",q.partial(this.closeOverflowTabs,[this])),this.appEvents.windowResized.add(this.detectTabOverflow,this,this)},c.prototype.initContentRegion=function(a){a.__private__.contentRegion.setElement(b(o))},c.prototype.getContentRegion=function(a){return a.__private__.contentRegion},c.prototype.initNextTabId=function(a){a.setNextTabId(a,g.TabId.of(n.createV4()))},c.prototype.setNextTabId=function(a,b){
a.__private__.nextTabId=b},c.prototype.changeTitle=function(b,c,d){var e;e=b.findScreenTab(b,d),a.not(a.isNil(e))&&(e.setFullTitle(c),k.redraw()),e===b.getActiveTab()&&b._title(c),b.updateApplicationContext()},c.prototype.findScreenTab=function(a,b){var c=q.compose(q.equals(b),q.invoker(0,"getScreen"));return q.find(c,a.getTabs(a))},c.prototype._title=function(a){document.title=a},c.prototype.changeIcon=function(b,c,d){var e;e=b.findScreenTab(b,d),a.isNil(e)||(e.setIcon(c),k.redraw()),b.updateApplicationContext()},c.prototype.canUnloadActiveTab=function(a){this.getActiveTab().canUnload(a)},c.prototype.toggleOverflowTabs=function(){this.setOverflowTabVisible(this,!this.getOverflowTabVisible())},c.prototype.getOverflowTabVisible=function(){return this.__private__.isOverflowTabVisible},c.prototype.setOverflowTabVisible=function(a,b){a.__private__.isOverflowTabVisible=b},c.prototype.closeOverflowTabs=function(a,b){a.targetIsInOverflow(b.target)||(a.setOverflowTabVisible(a,!1),k.redraw())},
c.prototype.targetIsInOverflow=function(a){var b=document.querySelector("a.tabs-overflow-icon"),c=document.querySelector("div.top-nav-main-tabs-overflow");return b&&b.contains(a)||c&&c.contains(a)},c.prototype.detectTabOverflow=function(a){a.setOverflowTabVisible(a,!1),k.redraw()},c.prototype.handleClickEvent=function(a,b){this.middleClickOrCloseIcon(b)?(b.stopPropagation(),this.checkCloseTab(this,a)):this.isMenuIcon(b)?this.appEvents.smallDeviceOptionsMenuClicked.raise():this.makeActive(a,b),b.preventDefault()},c.prototype.middleClickOrCloseIcon=function(a){return 2===a.which||!("I"!==a.target.nodeName||!a.target.classList.contains("ds-cross")&&!a.target.classList.contains("tab-back"))},c.prototype.isMenuIcon=function(a){return!("I"!==a.target.nodeName||!a.target.classList.contains("icon-mobile-menu"))},c.prototype.bulkClose=function(a,b,c){var d=[];a.__private__.tabs.forEach(a.checkForRouteClose.bind(null,b,d)),d.forEach(a.checkCloseTab.bind(null,a)),a.openRequestedRoute(a,c)},
c.prototype.openRequestedRoute=function(a,b){a.__private__.tabs.length<10&&a.appEvents.navigate.raise(b,{tab:!0})},c.prototype.checkForRouteClose=function(a,b,c,d){a.forEach(function(a){a.tabIndex===d&&a.route===c.getHref()&&b.push(c)})},c.prototype.checkCloseTab=function(b,c){c.canUnload(a.partial(b.closeTab,[b,c]))},c.prototype.closeTab=function(a,b){var c,d=a.getTabs(a).indexOf(b);b.close(),a.getTabs(a).splice(d,1),c=a.getHrefs(),a.getActiveTabIndex()>=d&&a.setActiveTabIndex(a.getActiveTabIndex()-1),a.urlManager.setHash(c,a.getActiveTabIndex())},c.prototype.makeActive=function(a,b){var c=this.getTabs(this).indexOf(a);c>-1&&(this.setOverflowTabVisible(this,!1),this.urlManager.setHash(this.getHrefs(),c)),b.preventDefault()},c.prototype.hasDirtyTab=function(){return q.any(q.invoker(0,"isDirty"),this.getTabs(this))},c.prototype.updateTabs=function(b,c){a.zipWith(this.updateTab(this,c),b,this.getTabs(this)),a.forEach(this.createTab(this,c),a.slice(this.getTabs(this).length,1/0,b)),
this.closeExtraTabs(this,b.length),this._title(this.getActiveTab().getTitle()),k.redraw(),this.__private__.initialized=!0,this.saveTabIds(this),this.updateApplicationContext()},c.prototype.updateApplicationContext=function(){new h(this.getTabs(this),this.getActiveTabIndex()).update()},c.prototype.saveTabIds=function(a){a.setStorageItem(a,p,a.getTabIds(a))},c.prototype.getTabIds=function(a){return a.getTabs(a).map(function(a){return a.getId().valueOf()})},c.prototype.provideTabId=function(a){return!a.isInitialized(a)&&a.hasSavedId(a)?a.dequeueSavedId(a):a.useNextTabId(a)},c.prototype.isInitialized=function(a){return a.__private__.initialized},c.prototype.hasSavedId=function(a){var b=a.getSavedIds(a);return b&&b.length},c.prototype.getSavedIds=function(a){return a.getStorageItem(a,p)},c.prototype.dequeueSavedId=function(a){var b=a.getSavedIds(a),c=b.shift();return a.setStorageItem(a,p,b),c},c.prototype.useNextTabId=function(a){var b=a.getNextTabId(a)
;return a.setNextTabId(a,g.TabId.of(n.createV4())),b},c.prototype.getNextTabId=function(a){return a.__private__.nextTabId},c.prototype.closeExtraTabs=function(a,b){var c=q.slice(b,1/0,a.getTabs(a));q.forEach(q.invoker(0,"close"),c),a.setTabs(a,q.take(b,a.getTabs(a)))},c.prototype.getHrefs=function(){return q.map(q.invoker(0,"getHref"),this.getTabs(this))},c.prototype.updateHrefs=function(b){a.zipWith(this.setHref,b,this.getTabs(this))},c.prototype.setHref=function(a,b){b.setHref(a)},c.prototype.containerWidth=function(){var b=document.querySelector("div.top-nav-main-tabs-group");return a.isNil(b)?0:b?b.getBoundingClientRect().width:0},c.prototype.getVariableTabs=function(){return this.getTabs(this).slice(2)},c.prototype.getVariableTabsLength=function(){return this.getVariableTabs().length},c.prototype.signOut=function(){i.resolve(m).logout(!0)},c.prototype.isSmallScreen=function(){return this.screenSize.isTooSmallForAllPages()},c.prototype.getActiveTabStorage=function(){
return this.getActiveTab().getStorage()},c.prototype.getNextTabStorage=function(){return d.newTabStorage(this.getNextTabId(this))},c.prototype.setStorageItem=function(a,b,c){a.getStorage(a).setItem(b,c)},c.prototype.getStorage=function(a){return a.__private__.storage},c.prototype.getStorageItem=function(a,b){return a.getStorage(a).getItem(b)},c}();return r=__decorate([i.singleton,i.dependsOn(c,l)],r)});
define('shell/views/tab-bar-view',["require","exports","system/globalization/translator","system/lang/object","ramda","mithril"],function(require,exports,a,b,c){"use strict";var d=require("mithril"),e=179,f=27,g=c,h=b.resolve(a);function i(a){return d("div.route-tab",[j(a),k(a)])}function j(a){return d("div.top-nav-left-icons-one",[d("i.fa fa-bars fa-2x top-left-nav-icon-group top-nav-meridium-logo",{id:"show-leftnav"}),d("span.apm-title","Meridium APM Mobile"),d("p.pull-right.log-off-btn.mi-xs-show-block",{onclick:a.signOut},[d("i.icon-signout.ic-nav"),d("span.text-style",h.translate("Log off"))])])}function k(a){return d("div.middle-content",[l(a),m(a),n(a)])}function l(a){var b=a.getHomeTab();return c.isNil(b)?"":d("div.top-nav-left-icons second-top-icon",{title:h.translate("HOME_DASHBOARD"),onclick:a.makeActive.bind(a,b),class:a.isActiveTab(b)?"active":""},[d("a.top-left-nav-icon-group test",d("i.icon-dashboard icon-dashboard-style"))])}function m(a){var b=a.getAssetHierarchyTab()
;return c.isNil(b)?"":d("div.top-nav-left-icons third-top-icon",{title:h.translate("ASSET_HIERARCHY"),onclick:a.makeActive.bind(a,b),class:a.isActiveTab(b)?"active":""},[d("a.top-left-nav-icon-group test",d("i.ds ds-assethierachy icon-dashboard-style"))])}function n(a){var b=R(a),c=U(a,b);return d("div.top-nav-main-tabs-group",[p(a,g.slice(b,c,a.getVariableTabs())),o(a),s(a)])}function o(a){return d("div.tab-overflow-div",[r(a),V(a)])}function p(a,b){return d("ul.list-inline",{style:"margin: 0"},c.map(q(a),b))}var q=c.curry(function a(b,c){return d("li.test-border short-border",{class:b.isActiveTab(c)?"active":"",onclick:b.handleClickEvent.bind(b,c),title:c.getFullTitle()},[d("a",{href:"#"+c.getHref()},[d("i.dummy-icon",{class:c.getIconImage()}),d("span",c.getTitle())]),d("i.tab-close ds ds-cross")])});function r(a){return F(a)?d("a.tabs-overflow-icon",{onclick:a.toggleOverflowTabs.bind(a)},[d("i.icon-arrow-down")]):""}function s(a){var b=a.getActiveTab()
;return c.isNil(b)?"":d("div.test-border short-border header-tab",{title:b.getFullTitle()},[t(a,b),d("div.mobile-header",[a.isSmallScreen()?d("i.icon-meridium-mobile.icon-apm-title"):d("i.dummy-icon",{class:b.getIconImage()}),d("div.tab-title",b.getFullTitle())])])}function t(a,b){return a.isSmallScreen()&&!a.isHomeScreenActive()?d("i.icon-back-arrow.pull-left.tab-back",{onclick:a.handleClickEvent.bind(a,b)}):d("i.icon-mobile-menu.pull-left",{onclick:a.handleClickEvent.bind(a,b)})}var u=c.lift(c.gt),v=c.lift(c.lt),w=c.lift(c.lte),x=c.lift(c.subtract),y=g.invoker(0,"getVariableTabsLength"),z=g.invoker(0,"getLastActiveVariableTab"),A=c.compose(c.multiply(e),y),B=g.invoker(0,"containerWidth"),C=w(A,B),D=g.cond([[C,y],[c.T,c.compose(Math.floor,g.divide(g.__,e),g.subtract(g.__,f),B)]]),E=w(y,D),F=u(y,D),G=c.compose(Math.floor,g.divide(g.__,2),D),H=c.compose(c.dec,y),I=x(y,D),J=x(z,G),K=c.lift(c.equals)(z,H),L=v(z,D),M=u(z,G),N=c.both(M,L);function O(a){return J(a)+D(a)-J(a)-D(a)+1}
var P=c.compose(c.add(2),x(z,D)),Q=c.always(0),R=c.cond([[E,Q],[N,O],[L,Q],[K,I],[c.T,P]]),S=c.curry(function a(b,c){return b+D(c)>y(c)}),T=c.curry(function(a,b){return a+D(b)});function U(a,b){return c.cond([[E,y],[S(b),y],[c.T,T(b)]])(a)}function V(a){return F(a)&&a.getOverflowTabVisible()?d("div.top-nav-main-tabs-overflow",[d("div",{style:"display: inline-block"},p(a,a.getVariableTabs()))]):""}return i});

define('text!config/action-routes-config.json',[],function () { return '[\r\n    { "url": "foo", "module":  "sandbox/action-routes/test-action-route" },\r\n    { "url": "bar", "module":  "system/ui/dialog-action-route" },\r\n    { "url": "baz", "module":  "sandbox/action-routes/test-loading-route" },\r\n    { "url": "actionsubroutetest/*", "module":  "sandbox/action-routes/action-subroute-screen-example" },\r\n    { "url": "catalogitem", "module":  "spa/action-routes/routes/catalog-path/catalog-path-action-route"},\r\n    { "url": "datasheet-dialog/@entitykey", "module":  "spa/action-routes/routes/datasheet-dialog/datasheet-dialog-action-route"},\r\n    { "url": "customer/*", "module":  "customer/config/customer-action-subroute-screen"},\r\n    { "url": "webmacros/macrorunner", "module": "spa/action-routes/routes/macro/macro-action-route" },\r\n    { "url": "popupiframe", "module":  "spa/action-routes/routes/iframe/iframe-action-route"},\r\n    { "url": "apmmonitoring/config/agents/@id", "module":  "apmsm/ui/configuration/agentconfig-action-route"},\r\n    {\r\n      "url": "apmmonitoring/config/tasks/@id",\r\n      "module": "apmsm/ui/configuration/taskconfig-action-route"\r\n    },\r\n    {\r\n      "url": "apmmonitoring/config/alerts/@id",\r\n      "module": "apmsm/ui/configuration/alertconfig-action-route"\r\n    }, \r\n    {\r\n        "url": "shell/hyperlink",\r\n        "module": "shell/hyperlink-utility-view-model"\r\n    }\r\n]';});

define('system/ui/unsaved-changes-message-box',['require','jquery','system/ui/message-box','system/globalization/translator'],function(require){"use strict";var a=require("jquery"),b=require("system/ui/message-box"),c=Object.resolve(require("system/globalization/translator"));function d(){}return d.show=function d(){var e=a.Deferred(),f=c.translate("UNSAVED_CHANGES_MESSAGE")+" "+c.translate("UNSAVED_CHANGES_PROMPT"),g=c.translate("UNSAVED_CHANGES_TITLE");return b.showOkCancel(f,g).done(function(a){0===a?e.resolve():e.reject()}),e.promise()},d});
define('shell/navigation-view-model',["require","exports","jquery","ramda","system/globalization/translator","./leftnav-view-model","application/application-events","application/application-context","shell/action-route-controller","system/http/ajax-client","shell/hash-manager","shell/navigation-settings","system/lang/ioc","system/lang/url-codec","ui/screen-size","./tab-bar-view-model","./views/tab-bar-view","mithril","jquery-deparam","text!config/action-routes-config.json","system/ui/unsaved-changes-message-box","spa/url-manager","spa/router"],function(require,exports,a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){"use strict";var p=require("spa/url-manager"),q=require("spa/router"),r=require("mithril"),s=require("text!config/action-routes-config.json"),t=require("system/ui/unsaved-changes-message-box"),u=function(){function c(a,b,c,d,e){this.urlManager=a,this.appEvents=b,this.translator=c,this.__private__={doNavigation:!0,tabBarVM:d,leftNavVM:e,screenSize:k.resolve(m)}}return c.prototype.attach=function(a){
this.getVm(this).attach(),r.mount(a.element,{controller:b.partial(this.getVm,[this]),view:o}),this.urlManager.routesChanged.add(this.locationChanged,this,this),this.urlManager.activate(),this.appEvents.navigate.add(this.appEventNavigate,this,this),this.appEvents.signout.add(this.signout,this,this)},c.prototype.getVm=function(a){return a.__private__.tabBarVM},c.prototype.locationChanged=function(a,b){a.checkForActionRoutes(b),a.getVm(a).setActiveTabIndex(b.active),a.shouldCheckForDefaultTabs(a,b)&&a.checkForDefaultTabs(a,b)},c.prototype.checkForActionRoutes=function(a){if(a.actionRoutes){var b=new q;new g(b,JSON.parse(s)).open(a)}},c.prototype.checkForDefaultTabs=function(a,b){a.getDoNavigation(a)?(a.resetApplicationHelpContext(),a.getVm(a).updateTabs(b.routes,b.query)):(a.setDoNavigation(a,!0),a.getVm(a).updateHrefs(b.routes))},c.prototype.getScreenSize=function(a){return a.__private__.screenSize},c.prototype.getDoNavigation=function(a){return a.__private__.doNavigation},
c.prototype.setDoNavigation=function(a,b){a.__private__.doNavigation=b},c.prototype.shouldCheckForDefaultTabs=function(a,b){var c,d;return a.isScreenTooSmallForAllPages(a)?(1===b.routes.length&&""===b.routes[0]&&(b={routes:["rounds/dashboard/user"]},a.replaceHash(a,b,b.routes[0],"")),!0):1===b.routes.length?(c=b.routes[0],b.query=b.query||{},delete b.query.__isQueryString__,d=l.encode(b.query),b={routes:["home","assets/hierarchy"]},""!==c&&(b.routes[2]=c),a.replaceHash(a,b,c,d),!1):(b.routes[0]=f.homeRoute,!0)},c.prototype.isScreenTooSmallForAllPages=function(a){return a.getScreenSize(a).isTooSmallForAllPages()},c.prototype.replaceHash=function(a,b,c,d){a.isLastRouteEmptyInApphub(b)&&(c=""),b=a.removeEmptyRouteInApphub(b),a.urlManager.replaceHash(b.routes,""===c?0:2,d)},c.prototype.removeEmptyRouteInApphub=function(a){return this.isLastRouteEmptyInApphub(a)&&a.routes.pop(),a},c.prototype.isLastRouteEmptyInApphub=function(a){return!!h.isMultiTenant()&&"/"===a.routes[2]},
c.prototype.resetApplicationHelpContext=function(){f.help.helpContext=""},c.prototype.appEventNavigate=function(a,b,c){a.getVm(a).updateApplicationContext(),a.shouldOpenInExistingTab(c)?a.openInExistingTab(a,b,c):a.openInNewTab(a,b,c)},c.prototype.shouldOpenInExistingTab=function(a){var b=a&&a.isActionRoute,c=a&&a.tab;return!b&&!c},c.prototype.openInExistingTab=function(a,c,d){a.getVm(a).canUnloadActiveTab(b.partial(a.navigate,[a,c,d]))},c.prototype.openInNewTab=function(a,b,c){c&&c.isActionRoute?a.openActionRoute(a,b):a.navigate(a,b,c)},c.prototype.navigate=function(a,b,c){var d=a.getActiveTab(a,c),e=a.getUrls(a,b,c),f=new i(a.urlManager,c);return a.setDoNavigation(a,j.getSettings(c).navigate),f.handleHash(e,d,b,c),!1},c.prototype.getActiveTab=function(a,b){return j.getSettings(b).background?a.getVm(a).getActiveTabIndex():a.getTabIndex(a,b)},c.prototype.getTabIndex=function(a,b){var c=a.getVm(a).getActiveTabIndex();return j.getSettings(b).tab&&(c=a.getVm(a).getHrefs().length),c},
c.prototype.getUrls=function(a,b,c){var d=b.split("?"),e=a.getVm(a).getHrefs(),f=a.getTabIndex(a,c);return b=c?a.parseGlobalQueryString(b,d,c):d.length>0?d[0]:b,b=b.replace(/^#/,""),e[f]=b,e},c.prototype.parseGlobalQueryString=function(a,b,c){return c.persistQueryString||(a=b.length>0?b[0]:a),a},c.prototype.signout=function(b,c){b.getVm(b).hasDirtyTab()&&(c.promise=a.Deferred(),t.show().fail(c.promise.reject.bind(c.promise)).done(b.signOutDirty.bind(null,b,c.promise)))},c.prototype.signOutDirty=function(a,b){a.getVm(a).clearTabs(),b.resolve()},c.prototype.openTab=function(a,b){if(this.getVm(this).updateApplicationContext(),a)this.openActionRoute(this,b);else{var c=void 0,d=void 0,e=b.split("?"),f=e.length>0?e[1]:"";b=e.length>0?e[0]:b,c=this.getVm(this).getHrefs(),c[c.length]=b.replace(/^#/,""),d=c.length-1,this.urlManager.setHash(c,d,f)}},c.prototype.changeTab=function(a,c){if(this.getVm(this).updateApplicationContext(),a)this.openActionRoute(this,c);else{
if(this.getVm(this).isActiveTabHrefSame(c))return;this.getVm(this).canUnloadActiveTab(b.partial(this.navigate,[this,c]))}},c.prototype.openActionRoute=function(a,b){var c={query:null,actionRoutes:new Array},d=new q,e=new g(d,JSON.parse(s));c.query=a.parseQueryString(b),b=b.split("?")[0],c.actionRoutes=[],c.actionRoutes.push(b),e.open(c)},c.prototype.parseQueryString=function(a){var b=a.split("?"),c=b.length>0?b[1]:null;return c?l.decode(c):null},c.prototype.WindowBeforeUnload=function(){return this.getVm(this).hasDirtyTab()?this.translator.translate("UNSAVED_CHANGES_MESSAGE"):void 0},c}();return u=__decorate([k.dependsOn(p,e,c,n,d),k.singleton],u)});
define('shell/services/shell-service',["require","exports","jquery","system/http/ajax-client","system/lang/ioc"],function(require,exports,a,b,c){"use strict";var d="api/core/userpref/",e=function(){function b(a){this.ajaxClient=a}return b.prototype.setPreference=function(b){var c=a.Deferred(),e=d+"set";return this.ajaxClient.post(e,b).done(this.resolve.bind(null,c)).fail(c.reject.bind(c)),c.promise()},b.prototype.getPreference=function(b,c){var e=a.Deferred(),f=d+"get/"+b+"/8?name="+c;return this.ajaxClient.get(f,{}).done(this.resolve.bind(null,e)).fail(e.reject.bind(e)),e.promise()},b.prototype.resolve=function(a,b){a.resolve(b)},b}();return e=__decorate([c.dependsOn(b)],e)});
define('help/url-formatters/base-url-formatter',["require","exports","../../system/lang/ioc","system/http/ajax-client"],function(require,exports,a,b){"use strict";var c=function(){function c(c){this.ajaxClient=a.resolve(b),this.culture=c}return c.prototype.formatContextForRedirect=function(a){var b=a;return b=this.removeRelativePathing(b),b=this.removeQueryString(b)},c.prototype.removeRelativePathing=function(a){return a.split("../").pop()||a},c.prototype.removeQueryString=function(a){return a.indexOf("%3F")!==-1?a.substring(0,a.indexOf("%3F")):a},c}();exports.BaseUrlFormatter=c});
define('help/url-formatters/on-prem-formatter',["require","exports","./base-url-formatter"],function(require,exports,a){"use strict";var b="default.html",c="search.html?searchQuery=",d=function(a){__extends(d,a);function d(b){return a.call(this,b)||this}return d.prototype.format=function(a,b){return a&&b?this.buildSearchUrl(b):b?this.buildContextUrl(b):this.buildDefaultUrl()},d.prototype.buildDefaultUrl=function(){return this.getUrlPrefix()+b},d.prototype.buildSearchUrl=function(a){return this.getUrlPrefix()+c+a},d.prototype.buildContextUrl=function(a){return this.getUrlPrefix()+this.formatContextForRedirect(a)},d.prototype.getUrlPrefix=function(){return this.ajaxClient.baseUrl()+"meridium/Help/"+this.culture+"/"},d}(a.BaseUrlFormatter);exports.OnPremFormatter=d});
define('help/url-formatters/unified-formatter',["require","exports"],function(require,exports){"use strict";var a="https://apps-docs.predix.io/en-US/apm",b="https://apps-docs.predix.io/search?terms=",c=function(){function c(){}return c.prototype.format=function(a,b){return a&&b?this.buildSearchUrl(b):b?this.buildContextUrl():this.buildDefaultUrl()},c.prototype.buildDefaultUrl=function(){return a},c.prototype.buildSearchUrl=function(a){return b+a},c.prototype.buildContextUrl=function(){return a},c}();exports.UnifiedFormatter=c});
define('help/url-formatters/unified-mobile-formatter',["require","exports","./base-url-formatter"],function(require,exports,a){"use strict";var b="https://apps-docs.predix.io/en-US/apm",c="https://apps-docs.predix.io/search?terms=",d=function(a){__extends(d,a);function d(b){return a.call(this,b)||this}return d.prototype.format=function(a,b){return a&&b?this.buildSearchUrl(b):b?this.buildContextUrl(b):this.buildDefaultUrl()},d.prototype.buildDefaultUrl=function(){return b},d.prototype.buildSearchUrl=function(a){return c+a},d.prototype.buildContextUrl=function(a){return this.getUrlPrefix()+this.formatContextForRedirect(a)},d.prototype.getUrlPrefix=function(){return this.ajaxClient.baseUrl()+"Help/"+this.culture+"/"},d}(a.BaseUrlFormatter);exports.UnifiedMobileFormatter=d});
define('help/url-formatters/factory/url-formatter-factory',["require","exports","application/application-context","../on-prem-formatter","../unified-formatter","../unified-mobile-formatter"],function(require,exports,a,b,c,d){"use strict";function e(b){return a.isAppHub?g():a.hasPredixSDKInstalled()?h(b):f(b)}exports.createUrlFormatter=e;function f(a){return new b.OnPremFormatter(a)}function g(){return new c.UnifiedFormatter}function h(a){return new d.UnifiedMobileFormatter(a)}});
define('help/services/help-service',['require','jquery','system/http/ajax-request'],function a(require){"use strict";var b=require("jquery"),c=require("system/http/ajax-request"),d="api/core/help";function e(){}e.prototype.checkCultureFolder=function a(e){var g=b.Deferred();return c.get(d+"/CheckCultureFolder?path="+e).send(g).done(f.bind(null,this,g)),g.promise()};function f(a,b,c){b.resolve(c)}return e});
define('help/view-models/help-opener',["require","exports","../../system/lang/ioc","application/application-context","../url-formatters/factory/url-formatter-factory","help/services/help-service","logging/error-notification-handler","system/hardware/device"],function(require,exports,a,b,c){"use strict";var d=require("help/services/help-service"),e=require("logging/error-notification-handler"),f=require("system/hardware/device");return function(){function g(b){this.helpService=b||a.resolve(d),this.errorNotificationHandler=a.resolve(e),this.urlFormatter=c.createUrlFormatter(this.getCulture())}return g.prototype.open=function(a){this.openHelp(!1,a)},g.prototype.search=function(a){this.openHelp(!0,a)},g.prototype.openHelp=function(a,b){"Default"!==this.getCulture()&&this.platformOffersCultureSpecificHelp()?this.tryOpenCultureSpecificHelp(a,b):this.openEnglishHelp(a,b)},g.prototype.tryOpenCultureSpecificHelp=function(a,b){var c=this.getUrl(this,a,b)
;this.helpService.checkCultureFolder(c).done(this.checkCultureFolderDone.bind(null,this,a,b))},g.prototype.checkCultureFolderDone=function(a,b,d,e){"NOTFOUND"===e&&(a.urlFormatter=c.createUrlFormatter("Default"));var f=a.getUrl(a,b,d);a.openPlatformSpecificHelp(f)},g.prototype.openEnglishHelp=function(a,b){var c=this.getUrl(this,a,b);this.openPlatformSpecificHelp(c)},g.prototype.getUrl=function(a,c,d){return c?a.urlFormatter.format(c,d||""):a.urlFormatter.format(c,d||b.help.helpContext||"")},g.prototype.platformOffersCultureSpecificHelp=function(){return 0===b.hostingEnvironment||b.hasPredixSDKInstalled()},g.prototype.getCulture=function(){var a=b.session.licensedCultureId;return a&&"en"!==a||(a="Default"),a},g.prototype.openPlatformSpecificHelp=function(a){var b=new f,c=window;b.isMobileApp()?c.openInExternalBrowser(a):window.open(a)},g}()});

define('text!shell/views/application-menu.html',[],function () { return '<div class="top-nav-right-icons">\r\n    <span class="right-top-icon-zero"\r\n          data-bind="click: openLogin, clickBubble: false, visible: isLoginVisible">\r\n        <a class="login-icon" data-bind="attr: {title: translator.translate(\'LOGIN\')}">\r\n            <i class="icon-user-nav"></i>\r\n        </a>\r\n    </span>\r\n    <span class="right-top-icon-zero"\r\n          data-bind="click: toggleAddRecord, clickBubble: false, css: {active: isAddRecordVisible }">\r\n        <a class="add-record-icon" data-bind="css: { selected: isAddRecordVisible }, attr: {title: translator.translate(\'CREATE_NEW_RECORD\')}">\r\n            <i class="icon-add-record"></i>\r\n        </a>\r\n    </span>\r\n    <span class="right-top-icon-two"\r\n          data-bind="click: toggleSearch, clickBubble: false, css: { active: isSearchVisible }">\r\n        <a class="search-icon" data-bind="css: { selected: isSearchVisible }, attr: {title: translator.translate(\'SEARCH_TOOLTIP\')}">\r\n            <i class="icon-global-search"></i>\r\n        </a>\r\n    </span>\r\n    <span class="right-top-icon-three" data-bind="click: openHelp, clickBubble: false">\r\n        <a data-bind="attr: {title: translator.translate(\'APPLICATION_HELP\')}">\r\n            <i class="icon-help"></i>\r\n        </a>\r\n    </span>\r\n    <span class="right-top-icon-four"\r\n          data-bind="click: toggleThemeSettings, clickBubble: false, css: { active: isThemeSettingsVisible }">\r\n        <a class="search-icon" data-bind="css: { selected: isSearchVisible }, attr: {title: translator.translate(\'THEME_SWITCH_TOOLTIP\')}">\r\n            <i class="icon-settings"></i>\r\n        </a>\r\n    </span>\r\n</div>\r\n\r\n<div class="search-overlay" data-bind="visible:isSearchVisible"></div>\r\n<div class="add-record-overlay" data-bind="visible:isAddRecordVisible"></div>\r\n<div class="themeSettings-overlay" data-bind="visible:isThemeSettingsVisible, css:{\'themeSettings-overlay-mobile\':IsDeviceMobile }">\r\n    <section class="themeSettings-block">\r\n        <div class="layout-switch">\r\n            <div class="block checkbox-placeholder">\r\n                <mi-checkbox data-bind="miCheckboxProperty: {\r\n                                     text: translator.translate(\'COMPACT_VIEW_LABEL\'),\r\n                                     checked: IsCompactView},\r\n                                     event:{change: $root.IsCompactViewChecked} ">\r\n                </mi-checkbox>\r\n            </div>\r\n            <!-- ko if: IsDeviceMobile -->\r\n            <div class="block checkbox-placeholder">\r\n                <mi-checkbox data-bind="miCheckboxProperty: {\r\n                                    text: translator.translate(\'DISABLE_NETWORK\'),\r\n                                    checked: IsDisableNetwork,\r\n                                    disable: !IsDeviceMobile},\r\n                                    event:{change: $root.IsDisableNetworkChecked} ">\r\n                </mi-checkbox>\r\n            </div>\r\n            <!-- /ko -->\r\n            <button class="btn btn-text" data-bind="click: $root.clearOfflinePin.bind($root), text: translator.translate(\'CLEAR_OFFLINE_PIN\'), visible:hasPredixSDKInstalled"></button>\r\n        </div>\r\n    </section>\r\n\r\n</div>';});

define('search/ui-utils',['require','system/globalization/translator','ui/elements/checkbox/view-model','ui/elements/radio/view-model'],function(require){"use strict";var a=require("system/globalization/translator");require("ui/elements/checkbox/view-model"),require("ui/elements/radio/view-model");function b(){}function c(a,b,c){a[a.length]={value:b,description:c}}return b.loadSelect=function(a,b,d,e,f){var g,h=[];for(a.implementation.optionsText("description"),a.implementation.optionsValue("value"),""!==d&&a.implementation.optionsCaption(d),f.length>1&&c(h,"",b),g=0;g<f.length;g++)c(h,f[g].key,f[g].caption);a.implementation.options(h),e&&(a.implementation.value(e),""===a.implementation.value()&&a.implementation.value(h[0].value))},b.relatedEntities=function(a){var b,c,d;for(d=document.createElement("span"),d.className="relationship-links",b=0;b<a.relatedEntities.length;b++)c=document.createElement("a"),c.setAttribute("href",a.relatedEntities[b].url),c.appendChild(document.createTextNode(a.relatedEntities[b].title)),d.appendChild(c);return d},b.associatedActions=function(a){var b,c,d
;for(d=document.createElement("div"),d.className="associated-actions",b=0;b<a.searchActions.length;b++)c=document.createElement("a"),c.setAttribute("href",a.searchActions[b].url),c.appendChild(document.createTextNode(a.searchActions[b].title)),c.className="btn btn-default",c.target="tab",d.appendChild(c);return d},b.familyElement=function(a){var b=document.createElement("span");return b.classList.add("list-group-item-text"),b.appendChild(document.createTextNode(a.familyCaption||a.catalogPath||a.className)),b},b.setRecordCount=function(b,c){var d,e=Object.resolve(a),f,g;d=(c.paging.page-1)*c.paging.per_page,d+=c.data.length,b&&(Element.clearDom(b),g=e.translate("OF"),g.length>5&&(g="/"),f=d.toString()+" "+g+" "+c.paging.total.toString(),b.appendChild(document.createTextNode(f)))},b.appendRelatedEntities=function(a,c,d,e){var f=e.data,g,h,i,j,k,l,m=a.querySelector("ul"),n;for(b.setRecordCount(a.querySelector(".search-message span.record-count"),e),g=0;g<f.length;g++)n=f[g],
h=document.createElement("li"),h.classList.add("list-group-item"),h.mi_data=n,k=document.createElement("div"),h.appendChild(k),"none"!==c&&(k.className="block-group",k.appendChild(b.selector("multiselect"===c))),l=document.createElement("div"),l.className="results",k.appendChild(l),i=document.createElement("h4"),i.classList.add("list-group-item-heading"),l.appendChild(i),d?(j=document.createElement("a"),j.href=n.action,j.target="tab"):j=document.createElement("span"),j.appendChild(document.createTextNode(n.description)),i.appendChild(j),l.appendChild(b.familyElement(n)),d&&n.searchActions&&l.appendChild(b.associatedActions(n)),m.appendChild(h)},b.selector=function(a,b,c){var d=document.createElement("div"),e;return d.className="selector block",a?e=document.createElement("mi-checkbox-noko"):(e=document.createElement("mi-radio-noko"),e.name="global-search-finder-radio"),b&&(e.value=b),c&&(e.familykey=c),d.appendChild(e),d},b.getValueFromMiSelect=function(a){var b
;return a&&a.implementation&&a.implementation.value?(b=a.implementation.value(),b&&b instanceof Array?b[0]:b):""},b});
define('search/models/family',[],function(){"use strict";function a(a,b){this.caption=a,this.key=b}return a});
define('search/adapters/family-adapter',['require','search/models/family'],function(require){"use strict";var a=require("search/models/family");function b(){}return b.fromDTO=function(b){return new a(b.caption,b.key)},b.fromDTOArray=function(a){var c,d=[];for(c=0;c<a.length;c++)d[d.length]=b.fromDTO(a[c]);return d.sort(function(a,b){return a.caption.localeCompare(b.caption)}),d},b});
define('search/services/search-service',['require','jquery','system/http/ajax-client','search/adapters/family-adapter'],function(require){"use strict";var a=require("jquery"),b=require("system/http/ajax-client"),c=require("search/adapters/family-adapter"),d="api/search",e="api/core/appconfig";function f(a){this.ajaxClient=a,this.activeSearch=null}f.dependsOn=[b],f.prototype.search=function(a,b,c,d,e,f,h,j,k,l,m,n){return j&&j.length>0||k&&k.length>0||l&&l.length>0||m&&m.length>0?i(this,a,b,c,d,e,f,h,j,k,l,m,n):g(this,a,b,c,d,e,f,h,n)};function g(b,c,d,e,f,g,i,j,l){var m=a.Deferred(),n=h(c,d,e,f,g,i,j,l);return b.activeSearch=b.ajaxClient.get(n).done(k.bind(null,b,m)).fail(m.reject.bind(m)),m.promise()}function h(a,b,c,e,f,g,h,i){var j=d+"?term="+encodeURIComponent(a)+"&page="+b+"&pageSize="+c,k;if(e&&e.length>0)for(k=0;k<e.length;k++)j+="&families="+e[k];if(f&&f.length>0)for(k=0;k<f.length;k++)j+="&relationships="+f[k];return g===!1&&(j+="&hasRelationship=false"),h===!0&&(j+="&exactFamilyMatch=true"),i===!0&&(j+="&autoWildcard=true"),j}function i(b,c,d,e,f,g,i,j,l,m,n,o,p){
var q=a.Deferred(),r=h(c,d,e,f,g,i,j,p),s={EntityKeys:l,SiteKeys:m,ExcludeSucc:n,ExcludePred:o};return b.activeSearch=b.ajaxClient.post(r,s).done(k.bind(null,b,q)).fail(q.reject.bind(q)),q.promise()}f.prototype.cancelSearch=function(){this.activeSearch&&this.activeSearch.abort()},f.prototype.families=function(){var b=a.Deferred(),c=d+"/families";return this.ajaxClient.get(c).done(j.bind(null,b)).fail(b.reject.bind(b)),b.promise()},f.prototype.relatedEntities=function(a,b,c){var e=d+"/related/"+a+"/"+b.toString()+"/"+c.toString();return this.ajaxClient.get(e).promise()},f.prototype.relationships=function(a){return this.ajaxClient.get(d+"/relationships/"+a.toString())},f.prototype.build=function(){return this.ajaxClient.post(d+"/build")},f.prototype.status=function(){return this.ajaxClient.get(d+"/status")},f.prototype.getSearchSettings=function(){return this.ajaxClient.get(e+"/10")},f.prototype.searchSettings=function(a){return this.ajaxClient.put(e+"/10",a)},
f.prototype.schedule=function(a){return this.ajaxClient.post(d+"/schedule",a)},f.prototype.getSchedule=function(){return this.ajaxClient.get(d+"/schedule")};function j(a,b){a.resolve(c.fromDTOArray(b))}function k(a,b,c){b.resolve(c),a.activeSearch=null}return f});
define('search/related-entity-view-model',['require','search/services/search-service','application/application-events','system/error/error-message','search/ui-utils'],function(require){"use strict";var a=require("search/services/search-service"),b=require("application/application-events"),c=require("system/error/error-message"),d=require("search/ui-utils"),e=.75;function f(c){this.service=Object.resolve(a),this.applicationEvents=Object.resolve(b),this.page=1,this.pageSize=25,this.paused=!1,this.settings={url:c.url,selector:c.selector||"none",makeLink:c.makeLink},this.region=null}f.prototype.load=function(a){var b=document.createElement("div"),c=document.createElement("ul");this.region=document.createElement("div"),this.region.classList.add("global-search-inline-related-entities"),a.insertAdjacentElement("afterend",this.region),this.region.innerHTML='<section class="search-message"><span></span></section>',b.className="global-search-results",this.region.appendChild(b),c.className="list-group",b.appendChild(c),this.region.querySelector(".global-search-results").addEventListener("scroll",this),this.paused=!0,
this.service.relatedEntities(this.settings.url,this.page,this.pageSize).done(h.bind(null,this)).fail(i.bind(null,this))},f.prototype.handleEvent=function(a){g(this,a)},f.prototype.show=function(){this.region.classList.add("active")},f.prototype.hide=function(){this.region.classList.remove("active")},f.prototype.toggle=function(){this.region.classList.toggle("active")},f.prototype.visible=function(){return this.region.classList.contains("active")};function g(a,b){var c=b.target,d=c.offsetHeight+c.scrollTop,f=d/c.scrollHeight;!a.paused&&f>=e&&(a.page++,a.paused=!0,a.service.relatedEntities(a.settings.url,a.page,a.pageSize).done(h.bind(null,a)).fail(i.bind(null,a)))}function h(a,b){d.appendRelatedEntities(a.region,a.settings.selector,a.settings.makeLink,b),b.data.length===a.pageSize&&(a.paused=!1)}function i(a,b){var d=c.fromHttpResponse(1,b);a.applicationEvents.errorOccured.raise(a,d)}return f});
define('search/related-entity-container-view-model',['require','search/services/search-service','application/application-events'],function(require){"use strict";var a=require("search/services/search-service"),b=require("application/application-events");function c(){this.service=Object.resolve(a),this.applicationEvents=Object.resolve(b),this.entries=null,this.family=null,this.productName=null,this.region=null,this.currentItem=null}return c.prototype.loadEntries=function(a,b,c){this.entries=a,this.family=b.innerHTML.toString(),this.currentItem=c},c.prototype.load=function(a){var b,c;this.region=document.createElement("div"),this.region.classList.add("global-search-related-entities-container"),c=document.createElement("h2"),this.region.appendChild(c),b=document.createElement("a"),b.appendChild(document.createTextNode(this.currentItem.description)),b.href=this.currentItem.action,b.target="tab",c.appendChild(b),this.region.appendChild(this.entries),this.region.family=this.family,a.insertAdjacentElement("afterend",this.region)},c.prototype.show=function(){this.region.classList.add("active"),
this.region.querySelector(".relationship-links").classList.add("active")},c.prototype.hide=function(){this.region.classList.remove("active"),this.region.querySelector(".relationship-links").classList.remove("active")},c.prototype.toggle=function(){this.region.classList.toggle("active"),this.region.querySelector(".relationship-links").classList.toggle("active")},c.prototype.visible=function(){return this.region.classList.contains("active")},c});
define('search/search-view-model',['require','jquery','search/services/search-service','application/application-events','system/error/error-message','ramda'],function(require){"use strict";var a=require("jquery"),b=require("search/services/search-service"),c=require("application/application-events"),d=require("system/error/error-message"),e=require("ramda"),f=.75;function g(){this.service=Object.resolve(b),this.applicationEvents=Object.resolve(c),this.page=1,this.pageSize=25,this.paused=!1,this.families=null,this.term="",this.familyFilter=null,this.relationshipFilter=null,this.hasRelationship=!0,this.exactFamilyMatch=!1,this.entityKeys=null,this.siteKeys=null,this.excludeSucc=null,this.excludePred=null,this.autoWildcard=!1}g.prototype.loadFamilies=function(){var a=this.service.families();return a.done(l.bind(null,this)),a.promise()},g.prototype.loadRelationships=function(a){return this.service.relationships(a).promise()};var h=e.when(e.or(e.equals("0"),e.equals(0)),e.always(null));g.prototype.newSearch=function(a,b,c,d,f,g,j,k){return this.page=0,this.term=a,this.familyFilter=b,this.relationshipFilter=c,this.entityKeys=d,
f&&(this.siteKeys=e.uniq(e.map(h,f))),this.excludeSucc=g,this.excludePred=j,this.autoWildcard=k,i(this)},g.prototype.listScrolled=function(a){var b=a.target,c=b.offsetHeight+b.scrollTop,d=c/b.scrollHeight;if(!this.paused&&d>=f)return i(this)},g.prototype.cancelSearch=function(){this.service.cancelSearch()};function i(b){var c=a.Deferred();if(b.term||b.familyFilter)return b.paused=!0,b.page++,b.service.search(b.term,b.page,b.pageSize,b.familyFilter,b.relationshipFilter,b.hasRelationship,b.exactFamilyMatch,b.entityKeys,b.siteKeys,b.excludeSucc,b.excludePred,b.autoWildcard).done(k.bind(null,b,c)).fail(j.bind(null,b)),c.promise()}function j(a,b){if("abort"!==b.statusText){var c=d.fromHttpResponse(1,b);a.applicationEvents.errorOccured.raise(a,c)}}function k(a,b,c){b.resolve(c),c.data.length===a.pageSize&&(a.paused=!1)}function l(a,b){a.families=b}return g});

define('text!search/views/search.html',[],function () { return '<section class="global-search">\r\n        <div class="input-group">\r\n            <input type="text" class="form-control search-input" data-bind="attr:{placeholder: translator.translate(\'SEARCH\')}"/>\r\n            <div class="btn-group search-options" dropdown data-bind="click: searchOptionsClicked">\r\n                <button type="button"\r\n                        class="btn search-options-current-selection"\r\n                        data-bind="attr:{title:translator.translate(selectedSearchIconTranslationKey())}">\r\n                    <i data-bind="css: selectedSearchIcon()"></i>\r\n                </button>\r\n                <button type="button" class="btn dropdown-toggle" dropdown-toggle><span class="caret"></span></button>\r\n                <ul class="dropdown-menu search-options-list"\r\n                    role="menu"\r\n                    data-bind="foreach: iconlist, style: { display: searchOptionOpened() ? \'block\' : \'none\' }">\r\n                    <li>\r\n                        <button class="btn" data-bind="attr:{title: $root.translator.translate($data.translationKey)}">\r\n                            <i data-bind="css: $data.iconclass"></i>\r\n                            <span data-bind="text: $root.translator.translate($data.captionKey)"></span>\r\n                        </button>\r\n                    </li>\r\n                </ul>\r\n            </div>\r\n        </div>\r\n        <div class="input-group" data-bind="visible:isFilterVisible">\r\n          <mi-select class="form-control family-select"\r\n                     name="families">\r\n            </mi-select>\r\n          <mi-select class="form-control rel-select"\r\n                     name="relationships">\r\n            </mi-select>\r\n          <button class="btn" data-bind="attr:{title: translator.translate(\'SEARCH_RESET\')}">\r\n              <i class="icon-refresh"></i>\r\n          </button>\r\n        </div>\r\n    <section class="search-message no-border block-group" data-bind="visible: isVisible">\r\n        <span></span>\r\n        <section class="block bulk-form-block block-group" data-bind="visible: enableBulkFormViewOption">\r\n            <button class="btn btn-icon block bulk-view" data-bind="click: toggleBulkFormView">\r\n                <i class="icon-view-bulkdata"></i>\r\n            </button>\r\n            <span class="block"\r\n                  data-bind="attr: {\r\n                        title: translator.translate(\'SEARCH_VIEW_IN_BULK\')\r\n                    },\r\n                    text: translator.translate(\'SEARCH_VIEW_IN_BULK\')">\r\n            </span>\r\n        </section>\r\n        <div class="block record-count-block">\r\n            <span class="record-count"></span>\r\n        </div>\r\n    </section>\r\n    <section class="breadcrumbs" data-bind="visible: isBreadCrumbVisible()">\r\n        <i class="icon-back-arrow"></i> <mi-breadcrumb delimiter="/"></mi-breadcrumb>\r\n    </section>\r\n    <section class="global-search-results" data-bind="visible: isVisible, css: { filtered: isFilterVisible }">\r\n        <ul class="list-group">\r\n        </ul>\r\n    </section>\r\n\r\n    <section class="search-overlay-bottom block-group">\r\n        <section class="search-help-link block">\r\n            <a data-bind="\r\n                text: translator.translate(\'SEARCH_NEED_HELP\'),\r\n                attr: {\r\n                    title: translator.translate(\'SEARCH_NEED_HELP\')\r\n                },\r\n                click: openHelp" target="_tab">Need Help?</a>\r\n        </section>\r\n        <section class="bulk-view-buttons block block-group">\r\n            <div data-bind="visible: enableBulkFormViewOption() && isCheckboxVisible()">\r\n                <button class="btn btn-text openBtn block"\r\n                        data-bind="attr: {\r\n                            title: translator.translate(\'SEARCH_OPEN_BULK\')\r\n                        }, text: translator.translate(\'SEARCH_OPEN_BULK\'),\r\n                        click: openButtonClicked,\r\n                        disable: isOpenButtonDisabled"\r\n                        target="tab">\r\n                </button>\r\n                <button class="btn btn-text cancelBtn block"\r\n                        data-bind="attr: {\r\n                            title: translator.translate(\'SEARCH_CANCEL_SELECTION\')\r\n                        },\r\n                        text: translator.translate(\'SEARCH_CANCEL_SELECTION\'),\r\n                        click: cancelButtonClicked,\r\n                        disable: isCancelButtonDisabled">\r\n                </button>\r\n            </div>\r\n        </section>\r\n    </section>\r\n\r\n\r\n</section>\r\n';});

define('search/models/search-user-pref-dto',['require','system/lang/converter','jquery'],function(require){"use strict";var a=require("system/lang/converter"),b=require("jquery");function c(c){c=c||{},this.key=a.toString(c.key),this.userKey=a.toString(c.userKey),this.prefType=a.toInteger(c.prefType),this.name=a.toString(c.name),b.isEmptyObject(c)?this.value="":this.value=JSON.parse(c.value)}return c});
define('search/services/search-userpreference-service',['require','system/http/ajax-client','search/models/search-user-pref-dto','jquery'],function(require){"use strict";var a=require("system/http/ajax-client"),b=require("search/models/search-user-pref-dto"),c=require("jquery"),d="api/core/userpref/",e=10;function f(){this.ajaxClient=Object.resolve(a)}f.prototype.setPreference=function a(b){var e=c.Deferred(),f=d+"set";return this.ajaxClient.post(f,b).done(e.resolve.bind(e)).fail(e.reject.bind(e)),e.promise()},f.prototype.getPreference=function a(b,f){var h=c.Deferred(),i=d+"get/"+b+"/"+e+"?name="+f;return this.ajaxClient.get(i,{}).done(g.bind(null,h)).fail(h.reject.bind(h)),h.promise()};function g(a,c){var d=new b(c);a.resolve(d)}return f});
define('search/search-screen',['require','lodash','jquery','spa/ko/knockout-view-model','system/knockout/knockout-manager','application/application-events','system/globalization/translator','search/ui-utils','search/related-entity-view-model','search/related-entity-container-view-model','search/search-view-model','help/view-models/help-opener','text!./views/search.html','ramda','search/services/search-userpreference-service','application/application-context','search/models/search-user-pref-dto','ui/elements/breadcrumb/view-model','ui/elements/select/view-model'],function(require){"use strict";var a=require("lodash"),b=require("jquery"),c=require("spa/ko/knockout-view-model"),d=require("system/knockout/knockout-manager"),e=require("application/application-events"),f=require("system/globalization/translator"),g=require("search/ui-utils"),h=require("search/related-entity-view-model"),i=require("search/related-entity-container-view-model"),j=require("search/search-view-model"),k=require("help/view-models/help-opener"),l=require("text!./views/search.html"),m=require("ramda"),n=require("search/services/search-userpreference-service"),o=require("application/application-context"),p=require("search/models/search-user-pref-dto"),q=10,r=[{iconclass:"icon-global-search",translationKey:"SEARCH",captionKey:"SEARCH"},{iconclass:"icon-collection-filter",translationKey:"FILTERED_SEARCH",captionKey:"FILTER"}];require("ui/elements/breadcrumb/view-model"),require("ui/elements/select/view-model");function s(a,b){t.call(this,l),this.translator=a,
this.titleChanged=b.titleChanged,this.element=null,this.searchViewModel=new j,this.items=null,this.total=0,this.kom=Object.resolve(d),this.isFilterVisible=null,this.isVisible=null,this.breadcrumb=null,this.breadcrumbData=[{text:"Search",value:"1"}],this.enableBulkFormViewOption=null,this.navigate=b.navigate,this.isCheckboxVisible=null,this.isOpenButtonDisabled=null,this.isCancelButtonDisabled=null,this.selectedSearchIcon=null,this.selectedSearchIconTranslationKey=null,this.iconlist=null,this.searchOptionOpened=null,this.closeSearchOptionsHandler=null,this.resetSearch=null,this.applicationContext=o,this.searchUserPreferenceService=Object.resolve(n),this.updatedListOfPref=[],this.listOfSearchPref=null,this.region=null}var t=Object.inherit(c,s);s.dependsOn=[f,e],s.prototype.load=function(){this.isFilterVisible=this.kom.observable(!1),this.isVisible=this.kom.observable(!0),this.enableBulkFormViewOption=this.kom.observable(!1),this.isCheckboxVisible=this.kom.observable(!1),
this.isOpenButtonDisabled=this.kom.observable(!0),this.isCancelButtonDisabled=this.kom.observable(!0),this.selectedSearchIcon=this.kom.observable("icon-global-search"),this.selectedSearchIconTranslationKey=this.kom.computed(H.bind(null,this,r)),this.iconlist=this.kom.observableArray(r.slice(1)),this.searchOptionOpened=this.kom.observable(!1),this.closeSearchOptionsHandler=K.bind(null,this),this.resetSearch=J.bind(null,this,"icon-global-search")},s.prototype.open=function(){this.titleChanged.raise(this.translator.translate("SEARCH"),this)},s.prototype.attach=function(a){var c,d;a.attach(b(l)),t.prototype.attach.call(this,a),d=b("mi-select"),Element.upgrade(d),this.region=a,this.element=a.element,this.element.querySelector("input").value=this.searchViewModel.term,this.element.querySelector("input").addEventListener("keypress",this),this.element.addEventListener("click",this),this.element.querySelector(".global-search-results").addEventListener("scroll",this),
this.element.querySelector(".global-search-results").addEventListener("click",this),this.breadcrumb=this.element.querySelector("mi-breadcrumb"),Element.upgrade(this.breadcrumb),this.breadcrumb.items=this.breadcrumbData,this.breadcrumb.selectedCallback=this.breadcrumbSelectedCallback.bind(null,this),c=this.element.querySelector('mi-select[name="families"]'),this.searchViewModel.loadFamilies().done(Z.bind(null,this)),d.on("valueChange",this.handleEvent.bind(this)),c=this.element.querySelector('mi-select[name="families"]'),this.element.querySelector('mi-select[name="relationships"]').implementation.disabled(!0),this.items&&this.items.length>0&&R(this,{data:this.items,paging:{page:1,per_page:this.searchViewModel.pageSize,total:this.total}})},s.prototype.detach=function(a){var c,d;for(this.element.querySelector("input").removeEventListener("keypress",this),this.element.removeEventListener("click",this),this.element.querySelector(".global-search-results").removeEventListener("scroll",this),
this.element.querySelector(".global-search-results").removeEventListener("click",this),c=this.element.querySelectorAll(".global-search-results:not(.inline) > ul > li"),this.items=[],d=0;d<c.length;d++)this.items[this.items.length]=c[d].mi_data;b("mi-select").off(),t.prototype.detach.call(this,a),a.clear()},s.prototype.unload=function(){this.kom.dispose()};function u(b,c){v(b,c),w(c.target)&&y(c.target)||x(c.target)&&z(c.target)?(L(b),b.resetSearch()):"I"===c.target.nodeName&&c.target.classList.contains("icon-back-arrow")?M(b):"A"===c.target.tagName&&c.target.parentElement.classList.contains("relationship-links")?(c.preventDefault(),c.cancelBubble=!0,W(b,c)):"A"===c.target.tagName&&c.target.classList.contains("related-container")?(c.preventDefault(),c.cancelBubble=!0,V(b,c)):"INPUT"===c.target.nodeName&&"checkbox"===c.target.type&&a.defer(T.bind(null,b))}function v(a,c){
if("LI"===c.target.tagName&&b(c.target.parentElement.parentElement).hasClass("searched-list-history")?(a.region.$element.find(".form-control").first().val(c.target.innerHTML),a.region.$element.find(".searched-list-history").remove()):"SECTION"===c.target.tagName?a.region.$element.find(".searched-list-history").remove():"INPUT"===c.target.tagName&&""===c.target.value&&(0===a.region.$element.find(".searched-list-history").length?ca(a).done(_.bind(null,a)):a.region.$element.find(".searched-list-history").remove()),"Enter"===c.key||"I"===c.target.tagName||"BUTTON"===c.target.tagName&&!c.target.classList.contains("dropdown-toggle")){var d="";"I"===c.target.tagName?d=c.target.parentElement.parentElement.parentElement.children[0].value:"Enter"===c.key?d=c.target.value:"BUTTON"===c.target.tagName&&(d=c.target.parentElement.parentElement.children[0].value),aa(a,d)&&""!==d&&ba(a)}}function w(a){return"I"===a.nodeName}function x(a){return"BUTTON"===a.nodeName}function y(a){
return a.classList.contains("icon-refresh")}function z(a){return 1===a.querySelectorAll(".icon-refresh").length}s.prototype.handleEvent=function(a){var b;if("click"===a.type)u(this,a);else if("valueChange"===a.type)"MI-SELECT"===a.target.tagName&&"families"===a.target.getAttribute("name")&&Y(this,a.target),P(this);else if("scroll"===a.type)(b=this.searchViewModel.listScrolled(a))&&b.done(R.bind(null,this));else if("keypress"===a.type){this.region.$element.find(".searched-list-history").remove();var c=a.which||a.keyCode;13===c&&(v(this,a),"MI-SELECT"===a.target.tagName&&"families"===a.target.getAttribute("name")&&Y(this,a.target),B(this))}},s.prototype.toggleFilter=function(){this.isFilterVisible(!this.isFilterVisible()),O(this)},s.prototype.isBreadCrumbVisible=function(){return!this.isVisible()},s.prototype.breadcrumbSelectedCallback=function(a,b){N(a,Number(b.value))},s.prototype.openHelp=function(){(new k).search(this.element.querySelector("input").value)},
s.prototype.toggleBulkFormView=function(){var a=this,c;c=b(a.element).find(".global-search-results"),a.isCheckboxVisible(!a.isCheckboxVisible()),S(a,c.find("div.selector"))},s.prototype.openButtonClicked=function(a){var c=this,d=[],e,f,g,h=b(c.element).find(".global-search-results mi-checkbox-noko");for(e=0;e<h.length;e++)h[e].checked&&(d.push(h[e].value),g=h[e].familykey);f={keys:d},b(".search-overlay").trigger("mouseleave"),c.navigate.raise("bdf-screen?keys="+d+"&familykey="+g,{tab:!0})},s.prototype.cancelButtonClicked=function(){var a,c=this,d=b(c.element).find(".global-search-results mi-checkbox-noko");for(a=0;a<d.length;a++)d[a].checked&&(d[a].checked=!1);c.isCancelButtonDisabled(!0),c.isOpenButtonDisabled(!0)},s.prototype.searchOptionsClicked=function(a,b){
var c=b.target.classList.contains("caret"),d="BUTTON"===b.target.nodeName&&!m.isNil(b.target.querySelector(".caret")),e=a.element.querySelector(".dropdown-menu.search-options-list").contains(b.target),f=a.element.querySelector(".btn.search-options-current-selection"),g=f.contains(b.target),h="I"===b.target.nodeName,i=1===b.target.querySelectorAll("i").length,j="";c||d?A(a):g?B(a):e&&(h||i)&&(b.stopPropagation(),a.searchOptionOpened(!1),j=I(b.target),C(a,j))};function A(a){a.searchOptionOpened(!a.searchOptionOpened()),a.searchOptionOpened()?window.addEventListener("click",a.closeSearchOptionsHandler):window.removeEventListener("click",a.closeSearchOptionsHandler)}function B(a){P(a)}function C(a,b){D(a,b),E(a),J(a,b),a.enableBulkFormViewOption(!1),F(a,b),G(a)}function D(a,b){"icon-collection-filter"!==b&&"icon-collection-filter"!==a.selectedSearchIcon()||a.toggleFilter()}function E(a){"icon-collection-filter"===a.selectedSearchIcon()&&L(a)}function F(a,b){
Q(a,a.translator.translate("INVALID_SEARCH"))}function G(a){a.element.querySelector(".input-group > input.form-control.search-input").focus()}function H(a,b){var c=a.selectedSearchIcon();return m.find(m.propEq("iconclass",c))(b).translationKey}function I(a){return"I"===a.nodeName?a.className:a.querySelector("i").className}function J(a,b){a.selectedSearchIcon(b);var c=r.slice(),d=m.findIndex(m.propEq("iconclass",b))(c);c.splice(d,1),a.iconlist(c)}function K(a,b){a.element.querySelector(".btn-group.search-options").contains(b.target)||(a.searchOptionOpened(!1),window.removeEventListener("click",a.closeSearchOptionsHandler))}function L(a){var b=a.element.querySelector(".global-search-results .list-group"),c=a.element.querySelector('mi-select[name="relationships"]'),d=a.element.querySelector('mi-select[name="families"]');a.isFilterVisible(!1),b.innerHTML="",a.element.querySelector("input").value="",d.implementation.value(""),c.implementation.value(""),c.implementation.disabled(!0),P(a),
a.enableBulkFormViewOption(!1),a.isCheckboxVisible(!1),a.isOpenButtonDisabled(!0),a.isCancelButtonDisabled(!0)}function M(a){N(a,a.breadcrumb.items.length)}function N(a,b){var c;1===b?O(a):2===b&&(c=a.element.querySelector(".global-search-related-entities-container .relationship-links"),X(a,c,"show"),a.breadcrumbData.splice(1,a.breadcrumbData.length)),a.breadcrumb.items=a.breadcrumbData}function O(a){var b;a.element&&(b=a.element.querySelector(".global-search-related-entities-container"),b&&b.parentNode.removeChild(b),a.breadcrumbData.splice(1,a.breadcrumbData.length),a.breadcrumb.items=a.breadcrumbData,a.isVisible(!0),a.element.querySelector(".search-message").style.display="block")}function P(a){var b=a.element.querySelector(".global-search-results .list-group"),c=a.element.querySelector("input"),d,e,f,h,i;a.isOpenButtonDisabled(!0),a.isCancelButtonDisabled(!0),a.searchViewModel.cancelSearch(),Q(a,""),b.scrollTop=0,b.innerHTML="",a.isVisible()===!1&&O(a),
e=g.getValueFromMiSelect(a.element.querySelector('mi-select[name="families"]')),e&&(f=[],f[0]=e),h=g.getValueFromMiSelect(a.element.querySelector('mi-select[name="relationships"]')),h&&(i=[],i[0]=h,e||(i="")),d=a.searchViewModel.newSearch(c.value,f,i,null,null,[],[]),d?d.done(R.bind(null,a)):(a.enableBulkFormViewOption(!1),Q(a,a.translator.translate("INVALID_SEARCH")))}function Q(a,b){var c=a.element.querySelector(".search-message span");a.element.querySelector(".search-message span.record-count").innerHTML="",c.innerHTML=b,c.parentNode.style.display="block",c.parentElement.classList.contains("no-border")&&c.parentElement.classList.remove("no-border")}function R(a,c){var d,e,f,h,j,k,l,m,n,o,p;if(1===a.searchViewModel.page&&0===c.data.length)return Q(a,a.translator.translate("NO_RESULTS")),void a.enableBulkFormViewOption(!1);for(a.total=c.paging.total,g.setRecordCount(a.element.querySelector(".search-message span.record-count"),c),
h=a.element.querySelector(".global-search-results .list-group"),f=0;f<c.data.length;f++)m=c.data[f],d=document.createElement("li"),d.classList.add("list-group-item"),d.mi_data=m,k=document.createElement("div"),d.appendChild(k),k.className="block-group",k.appendChild(g.selector(!0,m.key,m.familyKey)),p=b(k).find("div.selector"),S(a,p),l=document.createElement("div"),l.className="result block",k.appendChild(l),e=document.createElement("h4"),e.classList.add("list-group-item-heading"),l.appendChild(e),j=document.createElement("a"),j.appendChild(document.createTextNode(m.description)),j.href=m.action,j.target="tab",e.appendChild(j),l.appendChild(g.familyElement(m)),m.relatedEntities&&(o=g.relatedEntities(m),j=document.createElement("a"),j.href="#",j.appendChild(document.createTextNode(a.translator.translate("RELATED")+" - "+o.childNodes.length)),j.className="related-container",n=new i,n.loadEntries(o,g.familyElement(m),m),j.viewModel=n,l.appendChild(j)),
m.searchActions&&l.appendChild(g.associatedActions(m)),h.appendChild(d);a.enableBulkFormViewOption(!0)}function S(a,b){a.isCheckboxVisible()?b.css("display","block"):b.css("display","none"),b.css("width","10%")}function T(a){U(a)}function U(a){var c=b(a.element).find(".global-search-results mi-checkbox-noko"),d,e=[],f;for(d=0;d<c.length;d++)if(c[d].checked?(f=c[d],e.push(f)):f=null,e.length>1&&f&&e[0].familykey!==f.familykey)return void a.isOpenButtonDisabled(!0);if(0===e.length)return a.isOpenButtonDisabled(!0),void a.isCancelButtonDisabled(!0);a.isOpenButtonDisabled(!1),a.isCancelButtonDisabled(!1)}function V(a,b){var c=$(b.target);b.target.viewModel.load(c[4]),a.isVisible(!1),a.isFilterVisible(!1),b.target.viewModel.visible()?b.target.viewModel.hide():b.target.viewModel.show()}function W(a,b){var c,d;b.target.viewModel=null,c=new h({url:b.target.getAttribute("href"),makeLink:!0}),d=b.target.parentElement,c.load(d),c.show(),b.target.viewModel=c,X(a,d)}function X(a,b,c){var d
;"show"===c?(d=a.element.querySelector(".global-search-related-entities-container .global-search-inline-related-entities"),d.parentNode.removeChild(d),b.classList.add("active"),b.parentElement.querySelector("h2").style.display="block"):(b.classList.remove("active"),b.parentElement.querySelector("h2").style.display="none",a.breadcrumbData.push({text:b.parentElement.family,value:"2"}),a.breadcrumb.items=a.breadcrumbData)}function Y(a,b){var c=a.element.querySelector('mi-select[name="relationships"]'),d,e;if(c.implementation.options([]),!(d=g.getValueFromMiSelect(b)))return void c.implementation.disabled(!0);c.implementation.disabled(!1),a.searchViewModel.loadRelationships(d).done(g.loadSelect.bind(null,c,a.translator.translate("SEARCH_All_FAMILIES"),a.translator.translate("SEARCH_LINKED_TO"),e)),P(a)}function Z(a){var b=a.searchViewModel.families,c=a.element.querySelector('mi-select[name="families"]')
;g.loadSelect(c,a.translator.translate("SEARCH_All_FAMILIES"),a.translator.translate("SEARCH_LOOK_IN"),[],b)}function $(a){for(var b=[],c=a.parentNode;null!==c;){var d=c;b.push(d),c=d.parentNode}return b}function _(a,c){if(0!==c.value.length){a.listOfSearchPref=c.value[0];for(var d=document.createElement("div"),e=document.createElement("ul"),f=0;f<a.listOfSearchPref.length;f++){var g=document.createElement("li");g.appendChild(document.createTextNode(a.listOfSearchPref[a.listOfSearchPref.length-(f+1)].value)),e.appendChild(g)}d.appendChild(e),b(d).addClass("searched-list-history"),a.region.$element.find(".global-search").append(d)}}function aa(a,b){if(""!==b){var c={};if(c.value=b,null!==a.listOfSearchPref){for(var d=0;d<a.listOfSearchPref.length;d++)if(a.listOfSearchPref[d].value===b)return!1;return a.listOfSearchPref.length>=10&&a.listOfSearchPref.splice(0,a.listOfSearchPref.length-9),a.listOfSearchPref.push(c),a.updatedListOfPref=[],a.updatedListOfPref.push(a.listOfSearchPref),!0}
var e=[c];return a.updatedListOfPref.push(e),!0}}function ba(a){var b=new p;b.userKey=a.applicationContext.user.key,b.prefType=q,b.name="SearchUserPreference",b.value=JSON.stringify(a.updatedListOfPref),a.searchUserPreferenceService.setPreference(b)}function ca(a){return a.searchUserPreferenceService.getPreference(a.applicationContext.user.key,"SearchUserPreference")}return s});
define('record-manager-v2/model/family',[],function(){"use strict";function a(a,b,c,d){this.caption=a,this.key=b,this.useUrlRedirection=c,this.status=d}return a});
define('record-manager-v2/adapters/family-adapter',['require','record-manager-v2/model/family'],function(require){"use strict";var a=require("record-manager-v2/model/family");function b(){}return b.fromDTO=function(b){return new a(b.caption,b.key,b.useUrlRedirection,b.status)},b.fromDTOArray=function(a){var c,d=[];for(c=0;c<a.length;c++)d[d.length]=b.fromDTO(a[c]);return d.sort(function(a,b){return a.caption.localeCompare(b.caption)}),d},b});
define('record-manager-v2/services/search-service',['require','jquery','system/http/ajax-client','record-manager-v2/adapters/family-adapter','security/services/user-dto'],function(require){"use strict";var a=require("jquery"),b=require("system/http/ajax-client"),c=require("record-manager-v2/adapters/family-adapter"),d="api/core/metadata",e="api/core/security",f=require("security/services/user-dto");function g(a){this.ajaxClient=a}g.dependsOn=[b],g.prototype.getUserFull=function(){var b=a.Deferred();return this.ajaxClient.get(e+"/sessionuser",{}).done(function(a){b.resolve(new f(a))}).fail(function(a){b.reject(a)}),b.promise()},g.prototype.families=function(){var b=a.Deferred(),c=d+"/entityfamilies";return this.ajaxClient.get(c).done(h.bind(null,b)).fail(b.reject.bind(b)),b.promise()};function h(a,b){a.resolve(c.fromDTOArray(b))}return g});
define('record-manager-v2/add-record-view-model',['require','jquery','record-manager-v2/services/search-service','application/application-events','system/error/error-message'],function(require){"use strict";var a=require("jquery"),b=require("record-manager-v2/services/search-service"),c=require("application/application-events"),d=require("system/error/error-message"),e=.75;function f(){this.service=Object.resolve(b),this.applicationEvents=Object.resolve(c),this.families=null,this.user=null}f.prototype.loadFamilies=function(){var b=this.service.families(),c=a.Deferred();return b.done(g.bind(null,this,c)),c.promise()},f.prototype.loadUserDetails=function(){var b=this.service.getUserFull(),c=a.Deferred();return b.done(h.bind(null,this,c)),c.promise()};function g(a,b,c){var d=[],e;for(e=0;e<c.length;e++)c[e].useUrlRedirection===!1&&1===c[e].status&&d.push(c[e]);a.families=d,b.resolve()}function h(a,b,c){a.user=c,b.resolve()}return f});

define('text!record-manager-v2/views/add-record-view.html',[],function () { return '<section class="global-search">\r\n    <div class="input-group">\r\n        <input type="text" class="form-control" data-bind="value: filterFamiliesTerm, valueUpdate: \'afterkeydown\'" />\r\n        <span class="input-group-addon">\r\n            <i class="icon-search"></i>\r\n        </span>\r\n    </div>\r\n    <section class="global-search-results-add-rm">\r\n        <ul class="list-group" data-bind="foreach: displayedFamilyListForSearch">\r\n            <li class="list-group-item">\r\n                <div>\r\n                    <div class="result">\r\n                        <h3 class="list-group-item-heading">\r\n                            <a class="new-record-link" data-bind="text: caption"></a>\r\n                        </h3>\r\n                    </div>\r\n                </div>\r\n            </li>\r\n        </ul>\r\n    </section>\r\n</section>\r\n\r\n';});

define('record-manager-v2/add-record-screen',['require','jquery','knockout','spa/ko/knockout-view-model','application/application-events','system/globalization/translator','record-manager-v2/services/search-service','record-manager-v2/add-record-view-model','text!record-manager-v2/views/add-record-view.html'],function(require){"use strict";var a=require("jquery"),b=require("knockout"),c=require("spa/ko/knockout-view-model"),d=require("application/application-events"),e=require("system/globalization/translator"),f=require("record-manager-v2/services/search-service"),g=require("record-manager-v2/add-record-view-model"),h=require("text!record-manager-v2/views/add-record-view.html");function i(a,b){j.call(this,h),this.translator=a,this.titleChanged=b.titleChanged,this.element=null,this.addRecordViewModel=new g,this.filterFamiliesTerm=null,this.familiesList=null,this.filteredFamiliesList=null,this.filteredFamiliesForUsers=null,this.appEvents=b,this.userPrivilegesFamilies=null}var j=Object.inherit(c,i);i.dependsOn=[e,d],i.prototype.load=function(a){var c=this;c.filterFamiliesTerm=b.observable(),c.familiesList=b.observableArray([]),c.userPrivilegesFamilies=b.observableArray([]),c.filteredFamiliesForUsers=b.computed(n.bind(null,c)),c.filteredFamiliesList=b.computed(m.bind(null,c)),
c.pageLimit=b.observable(9),c.displayedFamilyList=b.observableArray([]),c.displayedFamilyListForSearch=b.computed(l.bind(null,c))},i.prototype.open=function(){this.titleChanged.raise(this.translator.translate("SEARCH"),this)},i.prototype.attach=function(c){c.attach(a(h)),j.prototype.attach.call(this,c),this.element=c.element,this.element.querySelector(".global-search-results-add-rm").addEventListener("scroll",this);var d=this;d.addRecordViewModel.loadUserDetails().done(function(){d.userPrivilegesFamilies(d.addRecordViewModel.user)}),d.addRecordViewModel.loadFamilies().done(k.bind(null,this)),a(".list-group").on("click",".new-record-link",function(){var a=b.contextFor(this),c="#record-manager/0/"+a.$data.key;d.appEvents.navigate.raise(c,{tab:!0})})};function k(a){try{a.familiesList(a.addRecordViewModel.families),a.displayedFamilyList(a.filteredFamiliesList().slice(0,a.pageLimit())),a.filterFamiliesTerm()&&a.displayedFamilyList(a.filteredFamiliesList())}catch(a){}}
i.prototype.handleEvent=function(b){var c=this,d,e=a(".global-search-results-add-rm"),f=e.height(),g=e[0].scrollHeight,h=e.scrollTop();if("scroll"===b.type&&h>=g-f&&(d=c.filteredFamiliesList().length,c.pageLimit()!==d)){c.pageLimit()+10>d?c.pageLimit(c.pageLimit()+d%10):c.pageLimit(c.pageLimit()+10);try{c.displayedFamilyList(c.filteredFamiliesList().slice(0,c.pageLimit()))}catch(a){}}},i.prototype.detach=function(a){this.element.querySelector(".global-search-results-add-rm").removeEventListener("scroll",this),this.familiesList=null,this.filteredFamiliesList=null,this.filteredFamiliesForUsers=null,j.prototype.detach.call(this,a),a.clear()};function l(a){return a.filterFamiliesTerm()||(a.displayedFamilyListForSearch=a.displayedFamilyList),a.filterFamiliesTerm()?b.utils.arrayFilter(a.filteredFamiliesForUsers(),function(b){return void 0!==b.caption&&void 0!==a.filterFamiliesTerm()&&(b.caption.toLowerCase().indexOf(a.filterFamiliesTerm().toLowerCase())>=0||void 0)}):a.displayedFamilyList()}
function m(a){return a.filteredFamiliesForUsers()}function n(a){var c,d;if(a.tempFamilies=b.observableArray([]),a.familiesList()&&a.userPrivilegesFamilies().privileges){if(a.userPrivilegesFamilies().isSuperUser===!0)return a.familiesList();for(c=0;c<a.familiesList().length;c++)for(d=0;d<a.userPrivilegesFamilies().privileges.length;d++)o(a,c,d);return a.tempFamilies()}}function o(a,b,c){a.familiesList()[b].key===a.userPrivilegesFamilies().privileges[c].familyKey&&a.userPrivilegesFamilies().privileges[c].ins===!0&&a.tempFamilies.push(a.familiesList()[b])}return i});

define('text!shell/views/login-view.html',[],function () { return '<div class="dialog-message-box">\r\n    <div class="message-text-container">\r\n        <i class="message-icon" data-bind="css:icon"></i>\r\n        <div class="main-message">\r\n            <input type=password data-bind="value: password" />\r\n        </div>\r\n    </div>\r\n    <section class="button-align message-box-button-container" data-bind="foreach: buttons">\r\n        <div class="btn btn-primary two-buttons" data-bind="text: name,\r\n            click: $parent.buttonClicked.bind($parent, $index())"></div>\r\n    </section>\r\n</div>\r\n';});

define('shell/login-view-model',["require","exports","jquery","spa/knockout/knockout-view-model","system/knockout/knockout-manager","system/globalization/translator","system/ui/dialog-view-model","system/lang/ioc","text!./views/login-view.html"],function(require,exports,a,b,c,d,e,f){"use strict";var g=require("text!./views/login-view.html");return function(b){__extends(h,b);function h(){var a=b.call(this,g)||this;return a.kom=new c,a.buttons=[{name:a.translate("OK")},{name:a.translate("CANCEL")}],a.title=a.translate("ENTER_YOUR_PASSWORD"),a.icon="icon-node-warning",a.password=a.kom.observable(""),a.dfd=null,a.dialog=null,a.translator=f.resolve(d),a.$element=null,a}return h.prototype.show=function(){if(this.dialog&&this.dialog.$wrapper){this.dialog=new e(this,this.title),this.dfd=a.Deferred(),this.dialog.show();var b=this.dialog;this.$element=b.find(".dialog-message-box"),this.setMessageBoxStyle()}return this.dfd},h.prototype.buttonClicked=function(a){this.dialog&&this.dfd&&(this.dialog.closeDialog(),
this.dfd.resolve(a))},h.prototype.setMessageBoxStyle=function(){if(this.$element&&this.dialog){var a=this.$element.parents(".dialog-content");a.addClass("message-box-content"),a.siblings(".title").addClass("message-box-title"),this.dialog.centerDialog()}},h.prototype.translate=function(a){return f.resolve(d).translate(a)},h}(b)});

define('text!strategy/recommendations/views/recommendation-control.html',[],function () { return '<mi-slidepanelright sliderenable="false">\r\n    <div class="recommendation-placeholder"></div>\r\n</mi-slidepanelright>';});

define('strategy/recommendations/recommendation-events',['require','system/lang/event'],function(require){"use strict";var a=require("system/lang/event");function b(){this.recSizeChangedEvent=new a,this.copiedSelectedRecEvent=new a,this.recDataSheetSavedEvent=new a,this.recommendationCreated=new a,this.recommendationCountEvent=new a,this.minChanged=new a,this.copyRecEvent=new a,this.defaultRecDatasheetEvent=new a,this.resetDatasheetEvent=new a,this.setDatasheetViewEvent=new a,this.recommendationDatasheetEvent=new a,this.recommendationSummaryLoadEvent=new a,this.loadRecommendationListEvent=new a,this.deleteRecommendationLoadActionList=new a,this.detailsLoadRecommendationList=new a,this.recMinimizeEvent=new a,this.recCountUpdateEvent=new a,this.recConsolidateEvent=new a,this.cachedValuesEvent=new a,this.cachedClearList=new a,this.consolidateActionEvent=new a,this.supersededActionDone=new a,this.supersededLoadingEvent=new a,this.supersededHideLoadingEvent=new a,this.closeSupersedeDialogBox=new a,this.raInserted=new a,this.reloadRiskAssessment=new a,
this.filterSelectedEvent=new a,this.panelFullWidth=new a,this.panelHalfWidth=new a,this.recStateChangedEvent=new a}return b.singleton=!0,b.factory=function(){return new b},b});

define('text!strategy/recommendations/shell/views/recommendation-shell.html',[],function () { return '<div class="block-group recommendation-shell-maximized nav-list-group">\r\n    <div class="block strategy-recommendation-details"></div>\r\n</div>';});


define('text!strategy/recommendations/details/views/recommendation-details.html',[],function () { return '\r\n<div class="block strategy-recommendation-shell-nav">\r\n        <div class="block-group">\r\n            <div class="block recommendation-label">\r\n                <mi-header>\r\n                    <mi-icon icon="icon-header-back-arrow as-btn-toggle-dataSheet"></mi-icon>\r\n                    <mi-title data-bind="attr:{title: observables.headerName}"></mi-title>\r\n                </mi-header>\r\n            </div>\r\n            <div class="block toggle-datasheet">\r\n            </div>\r\n        </div>\r\n    <div class="block-group headerAlign" data-bind="visible: observables.effectNameVisible">\r\n        <div class="block effect-name">\r\n            <span data-bind="text: translator.translate(\'EFFECT_CAPTION\')"></span> <span data-bind="text:observables.effectName"></span>\r\n        </div>\r\n    </div>\r\n</div>\r\n<div class="block strategy-recommendation-datasheet-tabs">\r\n        <mi-tab-group tabs="3">\r\n           <mi-tab data-bind="attr: { text: translator.translate(\'REC_IDENT_TAB\'), selected: true }, click: loadIdentification" selected="true"></mi-tab>\r\n            <mi-tab data-bind="attr: { text: translator.translate(\'REC_MITIGATED_TAB\')}, click: loadMitigatedRisk, visible: observables.showMitigatedTab() "></mi-tab>\r\n            <mi-tab data-bind="attr: { text: translator.translate(\'RECOMMENDATION_LINKED\') }, click: loadLinkedRecommendations, visible: !observables.isTemplate()"></mi-tab>\r\n       </mi-tab-group>\r\n        <div class="recommendation-summary-detail-header block" data-bind="visible: observables.recommendationIconsContainer">\r\n            <div class="block-group alignIcon">\r\n                <div class="block">\r\n                    <mi-tool-bar>\r\n                        <button class="btn btn-icon" data-bind="css: observables.hasCopyAccess(), attr: {title: translator.translate(\'COPY\')},visible:observables.showCopyAction, click:copyRecommendation">\r\n                            <i class="icon-copy"></i>\r\n                        </button>\r\n                        <button class="btn btn-icon" data-bind=" css:{\'no-access\': !observables.canSaveTemplate()} , click: saveRecommendationAsTemplate, attr:{title:translator.translate(\'SAVE_AS_TEMPLATE\')}">\r\n                            <i class="icon-save-policy-model-as"></i>\r\n                        </button>\r\n                        <button class="btn btn-icon" data-bind="css: observables.hasDeleteAccess(), click: deleteRecommendation, attr:{title:translator.translate(\'DELETE\')}">\r\n                            <i class="icon-delete-selected"></i>\r\n                        </button>\r\n                    </mi-tool-bar>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    <div class="strategy-recommendation-datasheet align-datasheet " align="left" style="overflow: auto !important;"></div>\r\n</div>\r\n\r\n\r\n';});


define('text!platform/datasheets/layout/ui/layout-element-template-map.json',[],function () { return '{\r\n\t"RootLayoutGroup" : "layout-root-template",\r\n\t"LayoutGroup" : "layout-group-template",\r\n\t"TabbedGroup" : "layout-tabbed-group-template",\r\n\t"LayoutControlItem" : "layout-control-template",\r\n\t"SimpleLabelItem" : "layout-label-template",\r\n\t"SplitterItem" : "layout-empty-space-template",\r\n\t"SimpleSeparator" : "layout-empty-space-template",\r\n\t"EmptySpaceItem" : "layout-empty-space-template",\r\n\t"RowSpanContainer" : "layout-element-template",\r\n\t"TableLayoutContainer" : "layout-table-template",\r\n\t"TableColumn" : "layout-table-column-template",\r\n\t"TableRow" : "layout-table-row-template",\r\n\t"TableCell" : "layout-control-template"\r\n}';});


define('text!system/error-handler/views/error-handler-view.html',[],function () { return '<div class="error-handler">\r\n\t<ul>\r\n\t\t<li>\r\n\t\t    <i class="icon-less-than previous"></i>\r\n\t\t</li>\r\n\t\t<li>\r\n\t    \t<span><span class="current-error-text">Error</span> <span class="current-error-number"></span> <span class="of-text">of</span> <span class="total-errors"></span></span>\r\n\t\t</li>\r\n\t\t<li>\r\n\t    \t<i class="icon-greater-than next"></i>\r\n\t\t</li>\r\n\t\t<li>\r\n\t    \t<span class="current-error"></span>\r\n\t\t</li>\r\n\t\t<li>\r\n\t    \t<span class="current-error-view-details link-txt">View Details</span> \r\n\t\t</li>\r\n\t\t<li>\r\n\t\t    <span class="vert-line"></span>\r\n\t\t</li>\r\n\t\t<li>\r\n\t    \t<span class="go-to-source-link link-txt">Go to source</span>\r\n\t\t</li>\r\n\t</ul>\r\n</div>';});

define('system/error-handler/error-handler',['require','lodash','jquery','text!./views/error-handler-view.html','system/ui/message-box','system/lang/event','system/globalization/translator'],function(require){"use strict";var a=require("lodash"),b=require("jquery"),c=require("text!./views/error-handler-view.html"),d=require("system/ui/message-box"),e=require("system/lang/event"),f=require("system/globalization/translator");function g(a,b){this.errorHandlerClosedEvent=new e,this.errorHandlerShowEvent=new e,this.translator=Object.resolve(f),this.init(a,b)}function h(a){a.currentErrorNumber=a.currentErrorNumber-1,a.updateView()}function i(a){a.currentErrorNumber=a.currentErrorNumber+1,a.updateView()}function j(a){d.showOk(a.errorArray[a.currentErrorNumber].longDesc,a.errorArray[a.currentErrorNumber].title,"fa fa-warning fa-2x")}function k(a){a.errorArray[a.currentErrorNumber].sourceCallBack()}return g.prototype.init=function a(d,e){d||(d=b("section.content-wrapper > section.content > div.region")),this.errorArray=e?e:[],this.currentErrorNumber=0,d.children("div.error-handler").remove(),0===d.children("div.error-handler").eq(0).length&&(d.prepend(c),
this.errorContainer=d.children("div.error-handler"),this.errorContainer.find("span.current-error-view-details").text(this.translate("VIEW_DETAILS")),this.errorContainer.find("span.go-to-source-link").text(this.translate("GO_TO_SOURCE")),this.errorContainer.find("span.current-error-text").text(this.translate("NOTIFICATION")),this.errorContainer.find("span.of-text").text(this.translate("OF")),this.errorContainer.find("i.previous").on("click",h.bind(null,this)),this.errorContainer.find("i.next").on("click",i.bind(null,this)),this.errorContainer.find("span.current-error-view-details").on("click",j.bind(null,this)),this.errorContainer.find("span.go-to-source-link").on("click",k.bind(null,this)),this.updateView())},g.prototype.showErrorHandler=function a(){this.errorContainer.show(),this.errorContainer.siblings().height("calc(100% - "+this.errorContainer.outerHeight()+"px)"),this.errorHandlerShowEvent.raise(this.errorContainer.outerHeight())},g.prototype.hideErrorHandler=function a(){
this.errorContainer.hide(),this.errorContainer.siblings().height("100%"),this.errorHandlerClosedEvent.raise(this.errorContainer.outerHeight())},g.prototype.addError=function a(b){this.errorArray.push(b),this.updateView()},g.prototype.removeError=function a(b){var c="object"==typeof b?this.errorArray.indexOf(b):b;this.errorArray.splice(c,1),this.errorArray.length===this.currentErrorNumber&&this.errorArray.length>0&&(this.currentErrorNumber=this.errorArray.length-1),this.updateView()},g.prototype.updateView=function b(c,d){var e;if(!(this.errorArray.length>0))return this.hideErrorHandler(),"No error to show";e=this.errorArray[this.currentErrorNumber]||null,this.showErrorHandler(),0===this.currentErrorNumber?this.errorContainer.find("i.previous").css("visibility","hidden"):this.errorContainer.find("i.previous").css("visibility","visible"),
this.currentErrorNumber===this.errorArray.length-1?this.errorContainer.find("i.next").css("visibility","hidden"):this.errorContainer.find("i.next").css("visibility","visible"),this.errorContainer.removeClass("error warning info").addClass(e.severity),this.errorContainer.find("span.current-error").text(e.title),this.errorContainer.find("span.current-error-number").text(this.currentErrorNumber+1),this.errorContainer.find("span.total-errors").text(this.errorArray.length),this.errorContainer.find(".current-error-view-details").css("display",e.longDesc?"inline":"none"),this.errorContainer.find(".go-to-source-link").css("display",a.isFunction(e.sourceCallBack)?"inline":"none"),this.handleDivider()},g.prototype.getTotalErrors=function b(c){return c?a.filter(this.errorArray,function(a){return a.severity===c}).length:this.errorArray.length},g.prototype.handleDivider=function a(b){
this.errorContainer.find(".current-error-view-details").is(":hidden")||this.errorContainer.find(".go-to-source-link").is(":hidden")?this.errorContainer.find("span.vert-line").hide():this.errorContainer.find("span.vert-line").show()},g.prototype.translate=function a(b){return this.translator.translate(b)},g});
define('system/knockout/knockout-helpers',['require','ramda','jquery','system/lang/object','knockout','xss','system/globalization/translator','system/error-handler/error-handler','system/text/parser','system/lang/functional','system/text/formatter','jquery-ui'],function(require){"use strict";var a=require("ramda"),b=require("jquery");require("system/lang/object");var c=require("knockout"),d=require("xss"),e=Object.resolve(require("system/globalization/translator")),f=require("system/error-handler/error-handler"),g=require("system/text/parser"),h=require("system/lang/functional"),i=require("system/text/formatter");require("jquery-ui");function j(a,d){c.bindingHandlers[a]={init:function(e,f,g,h){var i=new d(e,f,g,h);return b(e).data(a+"-binding",i),c.utils.domNodeDisposal.addDisposeCallback(e,function(){var c=b(e).data(a+"-binding");c.dispose&&c.dispose(e),b(e).removeData(a+"-binding")}),i.init&&i.init(e,f,g,h),c.applyBindingsToDescendants(i,e),{controlsDescendantBindings:!0}},update:function(c,d,e,f){var g=b(c).data(a+"-binding");g.update&&g.update(c,d,e,f)}}}c.appendTemplateScript=function(a,c){var d=b.Deferred();return document.getElementById(a)?d.resolve():b.ajax({url:c,dataType:"html"}).done(function(c){
var e=b("<script>").attr("id",a).attr("type","text/html").html(c);b("body").append(e),d.resolve()}),d.promise()},c.bindingHandlers.jqIconButton={init:function(a,d){var e=d(),f=c.unwrap(e.icon),g=c.unwrap(e.text),h=Object.defaultValue(c.unwrap(e.enabled),!0);f&&b(a).html('<i class="'+f+'"></i>')},update:function(a,d){var e=d(),f=c.unwrap(e.enabled),g=f?1:.5;b(a).find("i").css("opacity",g)}},c.bindingHandlers.toolTip={init:function(a,c){b(a).tooltip({content:c(),html:!0})},update:function(a,c){b(a).tooltip({content:c(),html:!0,tooltipClass:"datasheet-tooltip"})}},c.bindingHandlers.jqButton={init:function(a,d){var e=d(),f=c.unwrap(e.label),g=Object.defaultValue(c.unwrap(e.enabled),!0),h=c.unwrap(e.title);b(a).attr("title",h).button({disabled:!g}),e.label&&b(a).button("option","label",f)},update:function(a,d){var e=d(),f=c.unwrap(e.label),g=c.unwrap(e.enabled),h=c.unwrap(e.title);b(a).attr("title",h).button("option","disabled",g===!1),e.label&&b(a).button("option","label",f),
e.primaryIcon&&e.secondaryIcon?b(a).button("option","icons",{primary:e.primaryIcon,secondary:e.secondaryIcon}):e.primaryIcon&&b(a).button("option","icons",{primary:e.primaryIcon})}},c.bindingHandlers.localText={init:function(a,d){var f=c.utils.unwrapObservable(d());b(a).text(e.translate(f))},update:function(a,d){var f=c.utils.unwrapObservable(d());b(a).text(e.translate(f))}},c.bindingHandlers.localTitle={init:function(a,b){var d=c.utils.unwrapObservable(b());a.title=e.translate(d)},update:function(a,b){var d=c.utils.unwrapObservable(b());a.title=e.translate(d)}},c.bindingHandlers.xssHtml={update:function(a,e){var f=c.unwrap(e());b(a).html(d(f))}},c.bindingHandlers.required={init:function(a,d){c.unwrap(d())?b(a).attr("required","required"):b(a).removeAttr("required")},update:function(a,d){c.unwrap(d())?b(a).attr("required","required"):b(a).removeAttr("required")}},c.bindingHandlers.slide={init:function(a,d){var e=d(),f=c.unwrap(e.visible),g=c.unwrap(e.duration||"fast")
;f?b(a).slideDown(g):b(a).hide()},update:function(a,d){var e=d(),f=c.unwrap(e.visible),g=c.unwrap(e.duration||"fast");f?b(a).slideDown(g):b(a).slideUp(g)}},c.bindingHandlers.fade={init:function(a,d){var e=d(),f=c.unwrap(e.visible),g=c.unwrap(e.duration||"fast");f?b(a).fadeIn(g):b(a).hide()},update:function(a,d){var e=d(),f=c.unwrap(e.visible),g=c.unwrap(e.duration||"fast");f?b(a).fadeIn(g):b(a).fadeOut(g)}},c.utils.setOptionNodeSelectionState=function(a,b){navigator.userAgent.indexOf("MSIE 6")>=0?a.setAttribute("selected",b):a.selected=b},c.bindingHandlers.groupedOptions=function(){function a(a,f,g){var h,i,j;b(a);var k=[];for(h=0;h<a.childNodes.length;h++){var l=a.childNodes[h];if("OPTGROUP"===l.tagName){if(void 0!==l.childNodes)for(var m=0;m<l.childNodes.length;m++){var n=l.childNodes[m];n.tagName&&"OPTION"===n.tagName&&n.selected&&k.push(c.selectExtensions.readValue(n))}}else l.tagName&&"OPTION"===l.tagName&&l.selected&&k.push(c.selectExtensions.readValue(l))}
var o=a.scrollTop,p=c.utils.unwrapObservable(f());if(a.innerHTML="",p){var q=g();"number"!=typeof p.length&&(p=[p]),q.optionsCaption&&(j=document.createElement("OPTION"),j.innerHTML=q.optionsCaption,c.selectExtensions.writeValue(j,void 0),a.appendChild(j));var r=[],s=q.optionsGroup;for(h=0,i=p.length;h<i;h++){var t="";"function"==typeof s?t=s(p[h]):"string"==typeof s&&(t=c.utils.unwrapObservable(p[h][s])),t=t||"",void 0===r[t]&&(r[t]=[]),r[t].push(p[h])}for(var u in r)if(r.hasOwnProperty(u)){var v=null;for(""!==u&&(v=document.createElement("OPTGROUP"),v.label=u,a.appendChild(v)),h=0,i=r[u].length;h<i;h++){var w=r[u],x="string"==typeof q.optionsValue?w[h][q.optionsValue]:w[h],y=x;j=document.createElement("OPTION");var z=q.optionsText;"function"==typeof z?y=z(w[h]):"string"==typeof z&&(y=w[h][z]),x=c.utils.unwrapObservable(x),y=c.utils.unwrapObservable(y),c.selectExtensions.writeValue(j,x),j.innerHTML=y.toString(),null!==v?v.appendChild(j):a.appendChild(j)}}d(a,k),e(a,o)}}function b(a){
if("SELECT"!==a.tagName)throw new Error("groupedOptions binding applies only to SELECT elements")}function d(a,b){var d,e,f=a.getElementsByTagName("OPTION"),g=0;for(d=0,e=f.length;d<e;d++)c.utils.arrayIndexOf(b,c.selectExtensions.readValue(f[d]))>=0&&(c.utils.setOptionNodeSelectionState(f[d],!0),g++)}function e(a,b){b&&(a.scrollTop=b)}return{update:a}}(),c.extenders.validate=function(a,d){var g,h,i,j,k,l,m,n;b.isFunction(d)?g=d:(g=d.validationCallback,h=d.errorLevel,i=d.title,j=d.message,k=d.gotoCallback,l=d.controlSelector,m=d.errorHandler||Object.resolve(f),n=d.useValidationBar!==!0&&d.useValidationBar!==!1||d.useValidationBar),a.invalid=c.computed(function(){return a(),!g(a())}),a.validationError=void 0;function o(){n===!0&&(a.invalid()?a.validationError||(a.validationError={title:c.unwrap(i||e.translate("VALIDATION_ERROR")),longDesc:c.unwrap(j||void 0),severity:c.unwrap(h||"error"),sourceCallBack:k},
m.addError(a.validationError)):a.validationError&&(m.removeError(a.validationError),a.validationError=void 0))}return a.validationSubscription=a.invalid.subscribe(o),o(),a.dispose=function(){a.validationSubscription.dispose(),a.invalid.dispose(),n&&a.validationError&&(m.removeError(a.validationError),a.validationError=void 0)},a},c.extenders.preventChange=function(a,b){return c.computed({read:a,write:function(c){var d=a(),e=b.call(this,d,c);e!==!0&&e!==!1&&void 0!==e&&e.done?e.done(function(){a(c)}):e===!0&&a(c)}})},c.extenders.trackLastValue=function(a,b){var d=c.observable(b),e=c.computed({read:a,write:function(b){d(a()),a(b)}});return e.lastValue=d,e(a()),e},c.extenders.forceNumeric=function(a){var b=c.pureComputed({read:a,write:function(b){var c=a(),d,e;d=null===b||""===b||isNaN(b)?null:parseFloat(b),e=d,e!==c?a(e):b!==c&&a.notifySubscribers(e)}}).extend({notify:"always"});return b(a()),b},c.observableArray.fn.trackHasOneItem=function(){return this.hasOneItem=c.observable(),
this.subscribe(function(a){this.hasOneItem(!(!a||1!==a.length))},this),this.valueHasMutated(),this},c.observableArray.fn.trackHasItems=function(){return this.hasItems=c.observable(),this.subscribe(function(a){this.hasItems(!(!a||!a.length))},this),this.valueHasMutated(),this};var k=-1;function l(a,b){var d=this;k++,d.namespace=".combo-box-"+k,d.accessor=b(),d.optionsText=s(d.accessor.optionsText,null),d.value=s(d.accessor.value()),d.inputValue=c.observable(p(d,d.accessor.value())),d.options=s(d.accessor.options,[]),d.multiselect=!1,d.selectedOptions=s(d.accessor.selectedOptions,d.multiselect?[]:[d.value]),d.allowUnmatched=!1,d.allowNull=s(d.accessor.allowNull,!1),d.separator=s(d.accessor.separator,", "),d.allowUnmatched&&(d.multiselect=!1),d.maxOptions=s(d.accessor.maxOptions,"-1"),d.isListOpen=!1,d.updatingValueBinding=!1}l.prototype.init=function(a,d,e,f){var g=this;m(g,a,e,f),n(g,a),o(g),c.isObservable(g.accessor.value)&&(g.valueSubscription=g.accessor.value.subscribe(function(){
if(g.updatingValueBinding)return void(g.updatingValueBinding=!1);g.refresh()})),c.isObservable(g.accessor.options)&&(g.optionsSubscription=g.accessor.options.subscribe(function(){g.options=g.accessor.options()})),b(window).on("click"+g.namespace,a,r.bind(null,g))},l.prototype.dispose=function(a){var c=this;c.disableSubscription&&c.disableSubscription.dispose(),c.valueSubscription&&c.valueSubscription.dispose(),c.optionsSubscription&&c.optionsSubscription.dispose(),b(window).off(c.namespace),b(a).off(),b(a).empty(),b(a).parents(".mi-ui-scroll-y").off(c.namespace),b("body").off(c.namespace)},l.prototype.close=function(){var a=this;a.input.autocomplete("close"),a.isListOpen=!1},l.prototype.refresh=function(){var a=this;a.select(s(a.accessor.value()))},l.prototype.select=function(b){var c=this;c.value=b,c.selectedOptions.length>0&&!a.contains(c.Value,c.selectedOptions)&&c.selectedOptions.pop(),c.selectedOptions.push(c.value),c.inputValue(p(c,c.value))},l.prototype.buttonOnClick=function(){
var a=this;a.input.focus(),a.isListOpen?a.isListOpen=!1:(a.input.autocomplete("search",""),event.stopImmediatePropagation())};function m(a,d,e){d=b(d),a.inputAttrs={},e().attr&&e().attr.input&&(a.inputAttrs=e().attr.input),d.empty(),d.addClass("mi-ui-combo-box"),a.input=b('<input class="form-control" style="border-width:0px;height:20px" data-bind="value: inputValue, valueUpdate: \'input\', disable: accessor.disable, attr: inputAttrs" style="width: 100%">').appendTo(d);var f=b('<i class="input-group-addon icon-arrow" style="padding:0 10px 0 0" data-bind="click: buttonOnClick" tabindex="-1"/>').appendTo(d).button({disabled:s(a.accessor.disable)});f.removeClass("ui-widget ui-state-default ui-corner-all ui-button-disabled ui-state-disabled ui-button-text-only"),c.isObservable(a.accessor.disable)&&(a.disableSubscription=a.accessor.disable.subscribe(function(){f.button("option","disabled",a.accessor.disable())})),a.input.on("keydown",function(c){
c.keyCode===b.ui.keyCode.ESCAPE&&h.defer(function(){a.refresh(),a.isListOpen=!1})}),d.parents(".mi-ui-scroll-y").on("scroll"+a.namespace,a.close.bind(a)),b("body").on("scroll"+a.namespace,a.close.bind(a))}function n(c){function d(a,d){var e=!a.term,f=new RegExp(b.ui.autocomplete.escapeRegex(a.term),"i"),g=[];b.each(c.options,function(d,h){var i=p(c,h);if((e||f.test(i))&&(g.push({label:i.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+b.ui.autocomplete.escapeRegex(a.term)+")(?![^<>]*>)(?![^&;]+;)","gi"),"<strong>$1</strong>"),value:i,option:h}),c.maxOptions!==-1&&g.length>=c.maxOptions))return!1}),d(g)}function e(a,d){a.keyCode!==b.ui.keyCode.TAB&&(c.isListOpen=!1,c.select(d.item.option),q(c))}function f(a,d){if(!d.item){var e=new RegExp("^"+b.ui.autocomplete.escapeRegex(c.inputValue())+"$","i"),f=!1;b.each(c.options,function(a,b){var d=p(c,b);if(e.test(d))return c.select(b),c.inputValue(d),f=!0,!1}),f||(c.allowUnmatched?c.select(c.inputValue()):c.select(c.value)),q(c)}}function g(){
c.isListOpen=!0}function h(){c.multiselect&&q(c)}function i(a,c){var d=b("<li>").appendTo(a).data("item.autocomplete",c);return j(d,c),d}function j(d,e){var f=b("<a>").appendTo(d).html(e.label).mouseover(e,k).mouseout(e,l);a.contains(e.option,c.selectedOptions)&&f.addClass("ui-state-highlight")}function k(d){a.contains(d.data.option,c.selectedOptions)&&b(d.currentTarget).removeClass("ui-state-highlight")}function l(d){a.contains(d.data.option,c.selectedOptions)&&b(d.currentTarget).addClass("ui-state-highlight")}c.input.autocomplete({appendTo:b("body"),delay:0,minLength:0,autoFocus:c.accessor.autoFocus,position:{my:"left top",at:"left bottom",collision:"flip"},source:d,select:e,change:f,open:g,close:h}),c.input.data("autocomplete").menu.element.addClass("mi-ui-combo-box"),c.input.data("autocomplete")._renderItem=i}function o(a){var b=null!==a.value,c=0===a.selectedOptions.length,d=a.options.length>0;!b&&c&&d&&!a.allowNull?(a.select(a.options[0]),q(a)):b&&a.select(a.value)}
function p(c,d){function e(a){return b.map(a,function(a){return p(c,a)}).join(c.separator)}function f(b){return b?c.allowUnmatched&&!a.contains(b,c.options)?b:c.optionsText?s(b[c.optionsText],"").toString():b.toString():""}return b.isArray(d)?e(d):f(d)}function q(a){c.isObservable(a.accessor.value)&&(a.updatingValueBinding=!0,a.accessor.value(a.value)),c.isObservable(a.accessor.selectedOptions)&&a.accessor.selectedOptions(a.selectedOptions)}function r(a,c){var d=c.data;b.contains(d,c.srcElement)||a.close()}function s(a,c){return(b.isFunction(a)?a():a)||c}j("combo-box",l),c.bindingHandlers.sort={init:function(a,c){var d=!1;a.style.cursor="pointer",a.onclick=function(){var a=c(),e=a.prop,f=a.arr;d?(b(this).parent().find(".icon-up-arrow, .icon-arrow").remove(),b(this).append('<div class="icon-arrow" style="float: right;"></div>')):(b(this).parent().find(".icon-up-arrow, .icon-arrow").remove(),b(this).append('<div class="icon-up-arrow" style="float: right;"></div>')),d=!d,
f.sort(function(a,b){var c=a,f=b;d||(c=b,f=a);var g=e.split(".");for(var h in g)if(g.hasOwnProperty(h)){var i=g[h],j=i.indexOf("()");j>0?(i=i.substring(0,j),c=c[i](),f=f[i]()):(c=c[i],f=f[i])}return c===f?0:c<f?-1:1})}}},c.bindingHandlers.datetime={init:function(a,d){a=b(a);var e=d(),f=c.unwrap(Object.defaultValue(e.ampm,!1)),g=c.unwrap(Object.defaultValue(e.format,"hh:mm:ss")),h=c.unwrap(Object.defaultValue(e.showHour,!0)),i=c.unwrap(Object.defaultValue(e.showMinute,!0)),j=c.unwrap(Object.defaultValue(e.showSecond,!0)),k=c.unwrap(Object.defaultValue(e.showMillisec,!1)),l=c.unwrap(Object.defaultValue(e.stepHour,.25)),m=c.unwrap(Object.defaultValue(e.stepMinute,.25)),n=c.unwrap(Object.defaultValue(e.stepSecond,.25)),o=c.unwrap(Object.defaultValue(e.stepMillisec,.5)),p={ampm:f,timeFormat:g,showHour:h,showMinute:i,showSecond:j,showMillisec:k,stepHour:l,stepMinute:m,stepSecond:n,stepMillisec:o};a.datetimepicker(p)}};function t(a,d,e){
var f=d(),g=c.utils.unwrapObservable(f),h=e(),j=c.utils.unwrapObservable(h.dataType),k,l=h.exponentMin||null,m=h.exponentMax||null,n=b(a),o=n.is(":focus"),p=Object.resolve(i),q;switch(j){case"integer":case"I":k=h.integerFormat,o&&h.integerFormatEdit&&(k=h.integerFormatEdit);break;case"decimal":case"N":k=h.decimalFormat,o&&h.decimalFormatEdit&&(k=h.decimalFormatEdit);break;case"dateTime":case"D":k=h.dateTimeFormat,o&&h.dateTimeFormatEdit&&(k=h.dateTimeFormatEdit);break;case"currency":case"C":k=h.currencyFormat,o&&h.currencyFormatEdit&&(k=h.currencyFormatEdit);break;default:k=h.integerFormat||h.decimalFormat||h.dateTimeFormat||h.currencyFormat}k=u(k,l,m,x(g)),q=p.format(x(g),k),n.val(q),n.text(q)}function u(a,b,c,d){return null===b||null===c?a:(v(a)&&w(b,c,d)&&(a=a.replace("e","")),a)}function v(a){return a=a||"",a.indexOf("e")>-1}function w(a,b,c){var d=Math.abs(c);return a=x(Math.abs(a)||0),b=x(Math.abs(b)||0),0===c||a<d&&d<b}function x(a){return isNaN(a)||""===a?a:parseFloat(a)}
c.bindingHandlers.formattedValue={init:function(a,d,e){if(c.isObservable(d())){var f=e(),h=f.valueUpdate||"change",i=b(a);i.on(h,function(){var a=d(),b=c.utils.unwrapObservable(f.dataType),e=i.val();if(b||(f.integerFormat?b="integer":f.decimalFormat?b="decimal":f.dateTimeFormat?b="dateTime":f.currencyFormat&&(b="currency")),""!==e)switch(b){case"integer":case"I":var h=g.parseInt(e);isNaN(h)||(e=h);break;case"decimal":case"N":case"currency":case"C":var j=g.parseFloat(e);isNaN(j)||(e=j);break;case"dateTime":case"D":e=g.parseDate(e)}a(e)}),c.utils.domNodeDisposal.addDisposeCallback(i,function(){b(i).off()}),i.focusin(function(){c.bindingHandlers.formattedValue.updateFormat(a,d,e)}),i.focusout(function(){c.bindingHandlers.formattedValue.updateFormat(a,d,e)})}},update:function(a,d,e){var f=e(),g="INPUT"===a.nodeName,h=Object.defaultValue(f.formatOnce,g),i=b(a);h&&i.val()||c.bindingHandlers.formattedValue.updateFormat(a,d,e)},updateFormat:t}});
define('platform/datasheets/layout/ui/layout-element-view-model',['require','jquery','knockout','text!./layout-element-template-map.json','system/globalization/translator','system/knockout/knockout-helpers','ui/elements/checkbox/checkbox-view-model'],function(require){"use strict";var a=require("jquery"),b=require("knockout"),c=require("text!./layout-element-template-map.json"),d=require("system/globalization/translator");require("system/knockout/knockout-helpers"),require("ui/elements/checkbox/checkbox-view-model");function e(i,j){var k=JSON.parse(c),l,m=this;i=i||{},this.clientGuid=h(),this.translator=Object.resolve(d),this.controlName=i.controlName,this.name=i.name,this.parentName=i.parentName,this.type=i.type,this.visible=i.visible,this.caption=i.caption,this.captionVisible=i.captionVisible,this.captionPosition=i.captionPosition,this.row=i.location().row(),this.isHidden=b.observable(!1),l=a.map(i.children(),function(a){return new e(a,m)}),this.children=b.observableArray(l),this.size=i.size,this.location=i.location,this.captionSize=i.captionSize,this.mappedRows=b.computed(g.bind(null,this)),this.viewTemplate=b.observable(k[this.type()]||"layout-element-template"),this.controlTemplate=b.observable(),
this.fieldValue=b.observable(),this.isDatasheetReadOnly=b.observable(!0),this.elementCss=b.observable("form-control"),this.fontColorCss=b.observable("ds-enabled-fontColor"),this.headerCss=b.observable("ds-group-header-enabled"),this.parentElement=j,this.isParentControlVisible=b.computed(f.bind(null,this))}e.prototype.translate=function a(b){return this.translator.translate(b)},e.prototype.getChildViewTemplate=function a(b){return b.viewTemplate()},e.prototype.autoGrow=function a(b,c){c.currentTarget.scrollHeight>100?(c.currentTarget.style.overflow="auto",c.currentTarget.style.height="100px"):(c.currentTarget.style.height="45px",c.currentTarget.style.overflow="hidden",c.currentTarget.style.height=c.currentTarget.scrollHeight+"px")};function f(a){return null===a.isHidden()||!a.parentElement||!a.parentElement.children||2!==a.parentElement.children().length||(a.parentElement.isHidden(a.isHidden()),!1)}function g(a){
for(var b=a.children(),c={},d=0;d<b.length;d++)c[b[d].row]?c[b[d].row].push(b[d]):c[b[d].row]=[b[d]];return c}function h(){return i()+i()+"-"+i()+"-"+i()+"-"+i()+"-"+i()+i()+i()}function i(){for(var a="",b="abcdefghijklmnopqrstuvwxyz",c=0;c<4;c++)a+=b.charAt(Math.floor(Math.random()*b.length));return a}return e});
define('platform/datasheets/layout/services/dto/layout-size-dto',['require','system/lang/converter'],function(require){"use strict";var a=require("system/lang/converter");function b(b){b=b||{},this.height=a.toInteger(b.height),this.width=a.toInteger(b.width),this.percentageHeight=a.toInteger(b.percentageHeight),this.width=a.toInteger(b.percentageWidth)}return b});
define('platform/datasheets/layout/services/dto/layout-location-dto',['require','system/lang/converter'],function(require){"use strict";var a=require("system/lang/converter");function b(b){b=b||{},this.row=a.toInteger(b.row),this.column=a.toInteger(b.column),this.rowSpan=a.toInteger(b.rowSpan),this.columnSpan=a.toFloat(b.columnSpan),this.x=a.toInteger(b.x),this.y=a.toInteger(b.y)}return b});
define('platform/datasheets/layout/services/dto/layout-element-dto',['require','jquery','system/lang/converter','./layout-size-dto','./layout-location-dto'],function(require){"use strict";var a=require("jquery"),b=require("system/lang/converter"),c=require("./layout-size-dto"),d=require("./layout-location-dto");function e(f){f=f||{},this.controlName=b.toString(f.controlName),this.name=b.toString(f.name),this.parentName=b.toString(f.parentName),this.type=b.toString(f.type),this.visible=b.toBoolean(f.visible),this.caption=b.toString(f.caption),this.defaultCaption=b.toString(f.defaultCaption),this.captionVisible=b.toBoolean(f.captionVisible),this.captionPosition=b.toString(f.captionPosition);var g=a.map(b.toObject(f.children,[]),function(a){return new e(b.toObject(a,{}))});this.children=b.toObject(g,[]),this.size=new c(b.toObject(f.size,{})),this.location=new d(b.toObject(f.location,{})),this.captionSize=new c(b.toObject(f.captionSize,{}))}return e});
define('platform/datasheets/layout/services/dto/datasheet-layout-dto',['require','jquery','system/lang/converter','./layout-element-dto'],function(require){"use strict";var a=require("jquery"),b=require("system/lang/converter"),c=require("./layout-element-dto");function d(d){d=d||{};var e=a.map(b.toObject(d.elements,[]),function(a){return new c(b.toObject(a,{}))});this.elements=e,this.datasheetId=b.toString(d.datasheetId),this.datasheetKey=b.toInteger(d.datasheetKey)}return d});
define('platform/datasheets/layout/services/dto/datasheet-dto',['require','system/lang/converter','./datasheet-layout-dto'],function(require){"use strict";var a=require("system/lang/converter"),b=require("./datasheet-layout-dto");function c(c){c=c||{},this.key=a.toString(c.key),this.id=a.toString(c.id),this.caption=a.toString(c.caption),this.defaultCaption=a.toString(c.defaultCaption),this.description=a.toString(c.description),this.familyKey=a.toString(c.familyKey),this.familyType=a.toString(c.familyType),this.familyID=a.toString(c.familyID),this.isCustomForm=a.toBoolean(c.isCustomForm),this.isMasterDetail=a.toBoolean(c.isMasterDetail),this.lastViewed=a.toBoolean(c.lastViewed),this.customFormParameters=a.toObject(c.customFormParameters),this.isDefault=a.toBoolean(c.isDefault),this.sections=a.toObject(c.sections,[]),this.updateUser=a.toString(c.updateUser),this.updateDate=a.toDate(c.updateDate),this.isHidden=a.toBoolean(c.isHidden),this.layout=new b(a.toObject(c.layout,{}))}return c});
define('platform/datasheets/layout/services/dto/bulk-datasheet-dto',['require','system/lang/converter'],function(require){"use strict";var a=require("system/lang/converter");function b(b){b=b||{},this.key=a.toString(b.key),this.id=a.toString(b.id),this.caption=a.toString(b.caption),this.defaultCaption=a.toString(b.defaultCaption),this.description=a.toString(b.description),this.familyKey=a.toString(b.familyKey),this.familyType=a.toString(b.familyType),this.isCustomForm=a.toBoolean(b.isCustomForm),this.isDefault=a.toBoolean(b.isDefault),this.updateUser=a.toString(b.updateUser),this.updateDate=a.toDate(b.updateDate),this.columns=b.columns}return b});
define('platform/datasheets/layout/services/dto/datasheet-field-info-dto',['require','system/lang/converter'],function(require){"use strict";var a=require("system/lang/converter");function b(b){b=b||{},this.fieldKey=a.toString(b.fieldKey),this.fieldId=a.toString(b.fieldID),this.inputType=a.toString(b.inputType),this.maxLength=a.toInteger(b.maxLength),this.isActive=a.toBoolean(b.isActive)}return b});
define('platform/datasheets/layout/services/datasheet-service',['require','jquery','lodash','system/lang/object','system/http/ajax-client','./dto/datasheet-dto','./dto/bulk-datasheet-dto','./dto/datasheet-field-info-dto'],function(require){"use strict";var a=require("jquery"),b=require("lodash");require("system/lang/object");var c=require("system/http/ajax-client"),d=require("./dto/datasheet-dto"),e=require("./dto/bulk-datasheet-dto"),f=require("./dto/datasheet-field-info-dto"),g="api/core/datasheet/",h="api/core/metadata/",i="api/internal/aca",j="api/core/uom";function k(a){this.ajaxClient=a,this.isForDCM=!1}k.dependsOn=[c],k.prototype.setupForDCM=function(){this.isForDCM=!0},k.prototype.getAllDatasheets=function b(){var c=g,e=a.Deferred();return this.ajaxClient.get(c).done(function(b){var c=a.map(b,function(a){return new d(a)});e.resolve(c)}).fail(function(){e.reject()}),e.promise()},k.prototype.getDatasheets=function b(e){var f=g+"family/"+e,h=a.Deferred(),i;return i=this.ajaxClient.get(f).done(function(b){var c=a.map(b,function(a){return new d(a)});h.resolve(c)}).fail(function(a){h.reject(a.statusText,a)}),c.promise(h,i)},k.prototype.getDatasheet=function b(e,f){var h=g+e,i=a.Deferred(),j
;return void 0!==f&&(h=h+"/"+f),j=this.ajaxClient.get(h,{}).done(function(a){i.resolve(new d(a))}).fail(function(a){i.reject(a.statusText,a)}),c.promise(i,j)},k.prototype.getBulkDatasheet=function b(c,d){var f=g+"bulk/"+c,h=a.Deferred();return void 0!==d&&(f=f+"/"+d),this.ajaxClient.get(f,{}).done(function(a){h.resolve(new e(a))}).fail(function(){h.reject()}),h.promise()},k.prototype.getFieldInfo=function d(e){var f=g+"fieldsInputInfo/"+e,h=a.Deferred(),i;return this.isForDCM&&(f+="?isFromDCM=true"),i=this.ajaxClient.get(f,{}).done(function a(c){var d=b.map(c,l);h.resolve(d)}).fail(function a(b){h.reject(b.statusText,b)}),c.promise(h,i)};function l(a){return new f(a)}return k.prototype.newDatasheet=function b(c){var d=g+"new",e=a.Deferred();return this.ajaxClient.post(d,c).done(function(a){e.resolve(a)}).fail(function(){e.reject()}),e.promise()},k.prototype.deleteDatasheet=function b(c){var d=g+c,e=a.Deferred();return this.ajaxClient.delete(d,{}).done(function(a){e.resolve(a)
}).fail(function(){e.reject()}),e.promise()},k.prototype.updateDatasheet=function b(c){var d=g+"update",e=a.Deferred();return this.ajaxClient.post(d,c).done(function(a){e.resolve(a)}).fail(function(){e.reject()}),e.promise()},k.prototype.updateLayout=function b(c){var d=g+"layout",e=a.Deferred();return this.ajaxClient.post(d,c).done(function(a){e.resolve(a)}).fail(function(){e.reject()}),e.promise()},k.prototype.getEntityFamilyById=function b(c){var d=this,e=h+"entityfamily?id="+c,f=a.Deferred();return d.isForDCM&&(e+="&isFromDCM=true"),this.ajaxClient.get(e).done(function(a){f.resolve(a)}).fail(function(){f.reject()}),f.promise()},k.prototype.pushCritIndToCMMS=function b(c){var d=a.Deferred();return this.ajaxClient.put(i+"/sap/"+c).done(function(a){d.resolve(a)}).fail(d.reject.bind(d)),d.promise()},k.prototype.getBDFLayoutPreferences=function b(c,d){var e=a.Deferred(),f=g+"pref/"+c+"/"+d;return this.ajaxClient.get(f).done(function(a){e.resolve(a)}).fail(e.reject.bind(e)),e.promise()},
k.prototype.updateBDFLayoutPreferences=function b(c,d,e){var f=a.Deferred(),h=g+"pref/"+c+"/"+d;return this.ajaxClient.post(h,e).done(function(a){f.resolve(a)}).fail(f.reject.bind(f)),f.promise()},k.prototype.getUomCoversion=function b(c){var d=a.Deferred(),e=j+"/conversion/"+c;return this.ajaxClient.get(e).done(function(a){d.resolve(a)}).fail(d.reject.bind(d)),d.promise()},k.prototype.getUomCoversionByKey=function b(c,d){var e=a.Deferred(),f=j+"/conversion/fromkey/"+c+"/tokey/"+d;return this.ajaxClient.get(f).done(function(a){e.resolve(a)}).fail(e.reject.bind(e)),e.promise()},k.prototype.getUoms=function b(c){var d=a.Deferred(),e=j+"/keys/"+c;return this.ajaxClient.get(e).done(function(a){d.resolve(a)}).fail(d.reject.bind(d)),d.promise()},k});

define('text!platform/datasheets/layout/ui/views/templates/datasheet-text-editor.html',[],function () { return '<div class="panel-content text-editor" >\r\n    <textarea class="form-control" data-bind="value: val, attr: { readonly: disabled, placeholder: $root.translate(\'DS_TEXT_EDITOR_TITLE\'), autofocus: !$root.isIOS && !disabled}"></textarea>\r\n</div>\r\n<div class="panel-footer" >\r\n    <button class="btn btn-primary save-btn" data-bind="click:saveTexteditorValue, text: $root.translate(\'DONE\'), disable: ctx.fieldValue().disabled() || ctx.fieldValue().clientDisabled() || readonly"></button>\r\n    <!--<button class="btn btn-primary" data-bind="click:closeTexteditorDialog, text: $root.translate(\'DS_CANCEL\')"></button>-->\r\n</div>';});

define('platform/datasheets/layout/ui/datasheet-text-editor',['require','lodash','jquery','knockout','spa/ko/knockout-view-model','system/lang/event','text!./views/templates/datasheet-text-editor.html','system/globalization/translator','system/hardware/device'],function(require){"use strict";var a=require("lodash"),b=require("jquery"),c=require("knockout"),d=require("spa/ko/knockout-view-model"),e=require("system/lang/event"),f=require("text!./views/templates/datasheet-text-editor.html"),g=require("system/globalization/translator"),h=require("system/hardware/device");function i(a,b,d,i){this.contentEl=f,j.call(this,this.contentEl),this.val=c.observable(a),this.ctx=b,this.oldVal=c.observable(a),this.region=null,this.onSave=new e,this.onClose=new e,this.action=new e,this.translator=Object.resolve(g),this.disabled=c.observable(d),this.readonly=c.observable(i),this.device=Object.resolve(h),this.isIOS=this.device.isIOS()}var j=Object.inherit(d,i);i.prototype.attach=function a(c){j.prototype.attach.call(this,c),this.region=c,b(document).trigger("click"),this.isIOS||!this.disabled||this.disabled()||this.region.$element.find("textarea").focus()},i.prototype.detach=function a(b){k(this)},i.prototype.translate=function a(b){
return this.translator.translate(b)},i.prototype.saveTexteditorValue=function a(){this.action.raise(),this.ctx&&this.ctx.fieldValue&&this.ctx.fieldValue().value(this.val()),this.onSave.raise(),k(this)};function k(b){a.delay(function(a){a.ctx&&a.ctx.fieldValue&&a.ctx.fieldValue().isSelected&&a.readonly&&!a.readonly()&&a.ctx.fieldValue().isSelected(!0)}.bind(null,b),100)}return i.prototype.closeTexteditorDialog=function a(){this.ctx&&this.ctx.fieldValue&&this.ctx.fieldValue().value(this.oldVal()),this.action.raise(),this.onClose.raise()},i});
define('platform/datasheets/layout/ui/helpers/ui-helper',['require','jquery','lodash','knockout','system/ui/message-box','application/application-context'],function(require){"use strict";var a=require("jquery"),b=require("lodash"),c=require("knockout"),d=require("system/ui/message-box"),e=require("application/application-context"),f="0",g="MI Reference Document";function h(){}h.prototype.handleNavAppearance=function b(c,d){a(".more-options-outer-container").remove(),c&&c.region&&c.region.$element&&(c.datasheetNavWidth(c.region.$element.find(".datasheet-layout-container .datasheet-nav").width()),c.region.$element.find(".datasheet-layout-container .datasheet-nav").removeClass("small-nav"),c.region.$element.find(".datasheet-layout-container .datasheet-nav").removeClass("too-small-nav"),c.region.$element.find(".master-detail-datasheet-layout-container .datasheet-nav").removeClass("small-nav"),c.region.$element.find(".master-detail-datasheet-layout-container .datasheet-nav").removeClass("too-small-nav"),
c.datasheetNavWidth()&&c.datasheetNavWidth()<768&&(c.datasheetNavWidth()<500&&c.showStateManagement()?(c.region.$element.find(".datasheet-layout-container .datasheet-nav").addClass("too-small-nav"),c.region.$element.find(".master-detail-datasheet-layout-container .datasheet-nav").addClass("too-small-nav")):(c.region.$element.find(".datasheet-layout-container .datasheet-nav").addClass("small-nav"),c.region.$element.find(".master-detail-datasheet-layout-container .datasheet-nav").addClass("small-nav"))))},h.prototype.handleStickyHeader=function b(c,d,e){var f=c.uiHelper.handleHeaderHeight(c,d);if(e[0]&&e[0].scrollTop>50){var g=a(e[0]).parents("mi-recommendation")&&!!a(e[0]).parents("mi-recommendation").length,h=e&&e[0]&&e[0].className.indexOf("dialog-content")>-1;!f.hasClass("sticky-ds-nav")&&f[0]&&(f[0].classList.add("sticky-ds-nav"),h?f.css({top:e[0].offsetTop+107}):f.css({top:g?e[0].offsetTop+51:e[0].offsetTop}))}else f[0]&&f[0].classList.remove("sticky-ds-nav")},
h.prototype.handleHeaderHeight=function b(c,d){var e,f;return c&&d&&d.$element&&(".master-datasheet-container"===d.$element.selector?(f=a(".master-detail-datasheet-layout-container > .datasheet-nav"),e=a(".master-detail-datasheet-layout-container > .datasheet-nav > .datasheet-toolbar"),f.height(e.height()),e.width(f.width()-7)):(f=d.$element.find(".datasheet-nav"),e=d.$element.find(".datasheet-toolbar"),a(".master-detail-datasheet-layout-container .master-datasheet-container .datasheet-nav ").is(":empty")||f.height(e.height()),e.width(f.width()-7))),e},h.prototype.setOverlay=function a(b){var c=0,d=!1;b.region.$element.find(".datasheet-layout-container").find(".datasheet-nav").is(":visible")&&(c+=b.region.$element.find(".datasheet-nav").height()+40,d=!0),b.region.$element.find(".datasheet-layout-container").find(".nav-tabs").is(":visible")&&(c+=b.region.$element.find(".datasheet-layout-container").find(".nav-tabs").height()),d&&(c-=20),
b.region.$element.find(".datasheet-layout-container").find("h1").is(":visible")&&(c+=b.region.$element.find(".datasheet-layout-container").find("h1").height()+25),b.overlayTop(c+"px");var e="calc(100% - "+c+"px) ";b.overlayHeight(e)},h.prototype.attachTabClickHandlers=function a(b){if(b.region){var c=b.region.$element.find('[data-toggle="tab"], [data-toggle="pill"]');b.kom.subscribe(b.isDatasheetRendered,i.bind(null,b,c)),c.each(j.bind(null,b))}};function i(b,d,e){if(!e)return void(b.tabs&&(b.tabContainer.append(b.alternativeTabsContainer.children()),b.tabContainer.next().remove()));b.calculateTabWidth(),b.calculateContainerWidth(),b.tabWidth()>b.containerWidth()&&(k(b,d),d.each(function(d,e){if(b.tabs.push(a(e).parent()),b.tabWidths.push(a(e).parent().width()+40),void 0!==c.contextFor(a(e).parent().get(0))){var f=c.contextFor(a(e).parent().get(0)).$data;b.tabVms.push(f),b.tabsMoreOptions.push({type:"text",text:f.caption(),icon:"",vm:f,index:d})}
b.alternativeTabsContainer.append(a(e).parent().data("index",d).attr("data-index",d))}),b.tabsMoreOptions.length>=1&&(b.tabsMoreOptions[0].icon="icon-tick"),l(b))}function j(b,c,d){a(d).on("click",function(c){c&&(c.preventDefault(),c.stopPropagation()),a(this).parent("li").siblings("li").removeClass("active").end().addClass("active");var d=a(this).data("target");return b.region.$element.find(".tab-pane").removeClass("active").end().find(d).addClass("active"),b.tabSwitched.raise(),!1})}function k(b,d){b.tabs=[],b.tabWidths=[],b.tabVms=[],b.tabsMoreOptions=[],b.alternativeTabsContainer=a("<div/>"),b.tabContainer=a(d[0]).closest("ul"),b.tabContainer.length>0&&(void 0!==c.contextFor(b.tabContainer.get(0))&&(b.tabContainerContext=c.contextFor(b.tabContainer.get(0)).$data),b.tabContainer.css({display:"inline-block","vertical-align":"middle"}))}function l(a){var b=a.alternativeTabsContainer.find("li"),c=a.region.$element.width(),d=0;b.each(function(b,e){d=m(a,c,d,3,b,e)}),n(a,a.tabContainer)}
function m(b,c,d,e,f,g,h){return h&&h.index,d+=b.tabWidths[f],d+50>c?(e=f,d-=b.tabWidths[f]):a(b.tabContainer).append(g),d}function n(b,c){var d=a("<div/>").attr("data-bind","halt-bindings").css("display","inline-block"),e=a("<mi-more-options-noko/>").attr("data-bind","property: {icon: 'icon-options'}");window.CustomElements&&!window.CustomElements.useNative&&window.CustomElements.upgrade(e.get(0)),b.moreOptions=e.get(0),b.moreOptions.loader=b.setTabsOptions.bind(b),d.append(e),b.moreOptions.moreoptionsCB(o.bind(null,b)),c.after(d)}h.prototype.setTabsOptions=function a(b,c){return c.resolve(b.tabsMoreOptions),c};function o(b,c){var d=0,e=b.region.$element.width(),f=3;b.tabContainer.children().appendTo(a(b.alternativeTabsContainer)),d+=b.tabWidths[c.index];for(var g=0;g<b.moreOptions.options.length;g++)b.moreOptions.options[g].icon="";b.moreOptions.options[c.index].icon="icon-tick",a(b.tabs).each(function(a,g){d=p(b,e,d,f,a,g,c)}),f<c.index&&a(b.tabContainer).append(b.tabs[c.index]),
a(b.tabs[c.index]).find("a").trigger("click")}function p(b,c,d,e,f,g,h){return f!==h.index&&(d+=b.tabWidths[f]),d+50>c?(e=f,d-=b.tabWidths[f]):a(b.tabContainer).append(g),d}h.prototype.calculateTabWidth=function b(c){if(c&&c.region&&c.region.$element){var d=c.region.$element.find(".nav-tabs").children(),e,f=0;for(e=0;e<d.length;e++)f+=a(d[e]).width();c.tabWidth(f)}},h.prototype.calculateContainerWidth=function a(b){b&&b.region&&b.region.$element&&(b.containerWidth(b.region.$element.find(".datasheet-layout-container").width()-100),b.datasheetNavWidth(b.region.$element.find(".datasheet-layout-container .datasheet-nav").width()))},h.prototype.addMoreOptionsForIcons=function a(b,c,d){"form"===d&&b.hideMoreOptionsForIcons&&!b.hideMoreOptionsForIcons()?q(b,c,d):"bulk"===d&&q(b,c,d)};function q(b,c,d){if(b&&b.region&&b.region.$element){var e=b.region.$element.find(c),f=a("<mi-more-options-noko/>").attr("data-bind",'property: {icon: "icon-options"}')
;f.attr("class","datasheet-icons-more-options"),window.CustomElements&&!window.CustomElements.useNative&&window.CustomElements.upgrade(f.get(0)),b.iconsMoreOptions=f.get(0),b.iconsMoreOptions.loader=b.setIconOptions.bind(b),e.append(b.iconsMoreOptions),b.iconsMoreOptions.moreoptionsCB(t.bind(null,b,d))}}h.prototype.setIconOptions=function b(c,d){var e=a.Deferred();return"form"===d?r(c):"bulk"===d&&s(c),e.resolve(c.iconOptions),e};function r(a){var b=[],c=e.user.isSuperUser,d=!a.siteKey()||a.siteKey()&&a.siteKey().toString()===f,h=a.currentDatasheet().familyID()===g;b.push({type:"text",text:a.translate("PRINT"),icon:"icon-printer"}),a.isRootRecordAvailable()&&a.datasheetNavWidth()<768&&b.push({type:"text",text:a.translate("RM_MAKE_ROOT_RECORD_TOOLTIP"),icon:"icon-open-in-new-window"}),a.isDefaultHelpTextAvailable()&&b.push({type:"text",text:a.helpButtonText(),icon:"icon-questionmark"}),b.push({type:"text",text:a.translate("DS_ADD"),icon:"icon-plus",noaccess:!a.isNewAvailable()}),
a.isUnlinkRecordAvailable()&&b.push({type:"text",text:a.translate("RM_UNLINK_RECORD"),icon:"icon-unlink",noaccess:!a.isUnlinkRecordEnabled()}),b.push({type:"text",text:a.translate("DS_DELETE"),icon:"icon-bin",noaccess:!a.isDeleteAvailable()||h&&d&&!c}),a.isReferencesAvailable()&&a.isRefDocEnabled()&&b.push({type:"text",text:a.refDocCount()+" "+a.translate("DS_REF_DOCS"),icon:"icon-doc"}),a.isHistoryAvailable()&&a.isHistoryEnabled()&&b.push({type:"text",text:a.translate("DS_HISTORY"),icon:"icon-history",disabled:!a.isHistoryEnabled()}),a.isCopyAvailable()&&(b.push({type:"text",text:a.translate("DS_COPY"),icon:"icon-copy",noaccess:!a.isPasteEnabled()}),b.push({type:"text",text:a.translate("DS_PASTE"),icon:"icon-paste",noaccess:!a.isPasteEnabled(),disabled:a.canPaste()})),a.iconOptions=b}function s(a){var c=[],d=e.user.isSuperUser,g=!(!a.selectedRows().length||!b.find(a.selectedRows(),function(a){return!a.siteKey()||a.siteKey()&&a.siteKey().toString()===f})),h=a.isRefDocFamily()
;a.isMasterDatasheet()&&c.push({type:"text",text:a.translate("DS_UNLINK"),icon:"icon-unlink",noaccess:!a.isUnlinkAvailable(),disabled:a.hasSelection()}),a.isHistoryAvailable()&&c.push({type:"text",text:a.translate("DS_HISTORY"),icon:"icon-history",disabled:!a.isSingleEntitySelected()||a.isHistoryDisabled()}),c.push({type:"text",text:a.translate("DS_DELETE"),icon:"icon-bin",noaccess:!a.isDeleteAvailable()||h&&g&&!d,disabled:a.hasSelection()}),a.isRefDocAvailable()&&!a.isRefDocDisabled()&&c.push({type:"text",text:a.translate("DS_REF_DOCS"),icon:"icon-doc",disabled:!a.isSingleEntitySelected()||a.isRefDocDisabled()}),a.isCopyAvailable()&&(c.push({type:"text",text:a.translate("DS_COPY"),icon:"icon-copy",noaccess:!a.isPasteEnabled()&&a.isSingleEntitySelected(),disabled:!a.isSingleEntitySelected()}),c.push({type:"text",text:a.translate("DS_PASTE"),icon:"icon-paste",noaccess:!a.isPasteEnabled(),disabled:!a.canPaste()})),a.showColumnChooser()&&c.push({type:"text",
text:a.translate("DATASHEET_REORDER"),icon:"icon-paste"}),a.isFrozenColumn&&!a.isFrozenColumn()?c.push({type:"text",text:a.translate("DATASHEET_FREEZE_COLUMN"),icon:"icon-copy",disabled:!a.focusedColumn||a.frozenColsKeys&&a.frozenColsKeys().length>=4}):a.isFrozenColumn&&a.isFrozenColumn()&&c.push({type:"text",text:a.translate("DATASHEET_UNFREEZE_COLUMN"),icon:"icon-copy",disabled:!a.focusedColumn}),a.isFrozenRow()?c.push({type:"text",text:a.translate("DATASHEET_UNFREEZE_ROW"),icon:"icon-copy",disabled:!a.isSingleEntitySelected()}):c.push({type:"text",text:a.translate("DATASHEET_FREEZE_ROW"),icon:"icon-copy",disabled:!a.isSingleEntitySelected()||a.frozenRows().length>=5}),a.iconOptions=c}function t(a,b,c){c.noaccess||"form"!==b?c.noaccess||"bulk"!==b||(c.text===a.translate("DS_UNLINK")&&a.unlinkRelatedEntities(),
u(a,c)):(c.text===a.helpButtonText()?a.toggleHelpText():c.text===a.translate("DS_STATE_TRANSITION")?a.showStateTransition():c.text===a.translate("DS_STATE_ASSIGNMENT")?a.showStateAssignment():c.text===a.translate("DS_ADD")?a.newDatasheet():c.text===a.translate("RM_UNLINK_RECORD")&&a.unlinkRecord(),u(a,c))}function u(a,b){
b.text===a.translate("DS_DELETE")?a.deleteDatasheet():b.text&&b.text.indexOf(a.translate("DS_REF_DOCS"))>=0?a.showRefDocs():b.text===a.translate("DS_HISTORY")?a.showHistory():b.text===a.translate("DS_COPY")?a.copyDatasheet():b.text===a.translate("DS_PASTE")?a.pasteDatasheet():b.text===a.translate("DATASHEET_REORDER")?a.openColumnChooser():b.text===a.translate("DATASHEET_FREEZE_COLUMN")?a.freezeColumn():b.text===a.translate("DATASHEET_UNFREEZE_COLUMN")?a.unfreezeColumn():b.text===a.translate("DATASHEET_FREEZE_ROW")?a.freezeRow():b.text===a.translate("DATASHEET_UNFREEZE_ROW")?a.unfreezeRow():b.text===a.translate("RM_MAKE_ROOT_RECORD_TOOLTIP")?a.makeRootRecord():b.text===a.translate("PRINT")?a.print():b.text===a.translate("DS_SAVE_TOOLTIP")?a.saveDatasheet():b.text===a.translate("DS_DOWNLOAD_REF_DOC")&&a.downloadRefdoc()}h.prototype.attachTemplates=function b(c,d,e){var f=a("body"),g=a("body #datasheet-templates"),h,i;g.length?(h=a(g).find("#layout-templates"),v(f,d,h),
i=a(g).find("#field-templates"),w(f,e,i)):(a(f).append("<div id='datasheet-templates'></div>"),h=a(g).find("#layout-templates"),v(f,d,h),i=a(g).find("#field-templates"),w(f,e,i))};function v(b,c,d){d.length||(d=a(b).find("#datasheet-templates").append("<div id='layout-templates'></div>"),a(d).find("#layout-templates").append(c))}function w(b,c,d){d.length||(d=a(b).find("#datasheet-templates").append("<div id='field-templates'></div>"),a(d).find("#field-templates").append(c))}function x(b,c,d){d.length||(d=a(b).find("#datasheet-templates").append("<div id='bulk-field-templates'></div>"),a(d).find("#bulk-field-templates").append(c))}function y(b,c,d){d.length||(d=a(b).find("#datasheet-templates").append("<div id='aggregate-field-templates'></div>"),a(d).find("#aggregate-field-templates").append(c))}h.prototype.attachTemplatesForBulk=function a(b,c){z(b,c,"bulk")},h.prototype.attachTemplatesForAggregate=function a(b,c){z(b,c,"aggregate")};function z(b,c,d){
var e=a("body"),f,g=a("body #datasheet-templates");g.length||a(e).append("<div id='datasheet-templates'></div>"),"aggregate"===d?(f=a(g).find("#aggregate-field-templates"),y(e,c,f)):(f=a(g).find("#bulk-field-templates"),x(e,c,f))}h.prototype.lockEntityUpdateHelper=function a(b,c){var d=b.translator.translate("DS_ENTITY_UPDATE_WARNING_CAPTION"),e=c?b.translator.translate("DS_BULK_ENTITY_UPDATE_WARNING_MSG"):b.translator.translate("DS_ENTITY_UPDATE_WARNING_MSG"),f=b.translator.translate("OK");b.messagebox&&B(b.messagebox),b.messagebox=A(e,d,f),b.messagebox.showMessage()},h.prototype.unsupportedTextFound=function a(b){var c=b.translator.translate("DS_INVALID_INPUT"),d=b.translator.translate("DS_UNSUPOORTED_TEXT_FOUND"),e=b.translator.translate("OK");b.messagebox&&B(b.messagebox),b.messagebox=A(d,c,e),b.messagebox.showMessage()};function A(a,b,c){var e=null,f=null;return f=[{name:c}],e=new d(a,b,f)}function B(a){null!==a&&a.dialog.dialogShellRegion.activeContainer&&(a.dialog.closeDialog(),
a=null)}return h.prototype.isAllDatasheetsHidden=function a(c){return b.every(c,function(a){return a.isHidden===!0||a.isMasterDetail===!0})},h});
define('platform/datasheets/layout/model/field-value-model',['require','lodash','jquery','xss','knockout','../ui/datasheet-text-editor','spa/region','system/ui/dialog-view-model','application/application-context','system/lang/event','system/text/formatter','system/text/parser','system/lang/converter','moment','system/globalization/translator','../ui/helpers/ui-helper','system/text/clean-href','system/knockout/knockout-helpers'],function(require){"use strict";var a=require("lodash"),b=require("jquery"),c=require("xss"),d=require("knockout"),e=require("../ui/datasheet-text-editor"),f=require("spa/region"),g=require("system/ui/dialog-view-model"),h=require("application/application-context"),i=require("system/lang/event"),j=require("system/text/formatter"),k=require("system/text/parser"),l=require("system/lang/converter"),m=require("moment"),n=Object.resolve(j),o=require("system/globalization/translator"),p=require("../ui/helpers/ui-helper"),q=require("system/text/clean-href");require("system/knockout/knockout-helpers");function r(b,c,e,f,g,j,k){var l=this;if(g=g||{},g.required=g.required||!1,g.disabled=g.disabled||!1,g.picklist=g.picklist||void 0,g.isHtmlField=g.isHtmlField||!1,g.unitOfMeasure=g.unitOfMeasure||{},g.unitOfMeasureKey=g.unitOfMeasureKey||{},g.backColor=g.backColor||{},g.jsModuleName=g.jsModuleName||null,g.jsModuleParams=g.jsModuleParams||null,g.jsModuleUseApply=g.jsModuleUseApply||!1,
g.popJSModuleOnFocus=g.popJSModuleOnFocus||null,g.addParseValueParam=g.addParseValueParam||!1,g.dependentFields=g.dependentFields||[],g.values=void 0!==typeof g.values?"object"==typeof g.values?g.values:[g.values]:[],this.inputType=d.observable("Textbox"),this.translator=Object.resolve(o),this.key=d.observable(b),this.id=d.observable(c),this.entityKey=d.observable(k),this.oldValue=null,this.value=d.observable(e),this.computedBoolVal=null,v(this),this.displayValue=d.observable(f),this.uom=d.observable(g.unitOfMeasure),this.uomKey=d.observable(g.unitOfMeasureKey),this.disValue=d.computed(F.bind(null,l)),this.caption=g.caption,this.defaultCaption=g.defaultCaption,this.clientid=d.observable(j),this.isSelected=d.observable(!1),this.changedFromView=d.observable(!0),this.isDirty=d.observable(!1),this.required=d.observable(g.required),this.disabled=d.observable(g.disabled),this.isHtmlField=d.observable(g.isHtmlField),this.maxNumberOfValues=d.observable(g.maxNumberOfValues),
this.dbLength=g.dbLength,this.oldValues=d.observable(),this._values=d.observableArray(a.compact(g.values)),this.values=d.observableArray(a.compact(g.values)),void 0!==g.picklist){this.picklist=d.observableArray(l.createPickList.bind(this)(g.picklist)),this.isPicklistRestricted=d.observable(g.isPicklistRestricted);var m=a.find(g.picklist,s);this.picklistValue=d.observable(m?m.value:""),this.picklistValueSubscription=this.picklistValue.subscribe(M.bind(null,l)),this.picklistSubscription=this.picklist.subscribe(H.bind(null,l))}this.browsevalue=d.observable(),this.browsevalueSubscription=this.browsevalue.subscribe(x.bind(null,this)),this.format=g.format,this.behaviors=g.behaviors,this.isMaskedField=!1,O(this),this.dateFormat=d.observable(),this.format?this.dateFormat(z(this.format)):h.user&&h.user.formats&&h.user.formats.dateTime&&this.dateFormat(h.user.formats.dateTime),this.dateValue=d.observable(),this.isDateControl=d.observable(!1),this.dateSubscription=null,
this.helpText=""===g.helpText?this.translate("DS_NO_HELP_TEXT"):d.observable(g.helpText),this.backColor=d.observable(g.backColor),null!==g.jsModuleName?this.jsModuleName=d.observable(g.jsModuleName):this.jsModuleName=d.observable(),null!==g.jsModuleParams?this.jsModuleParams=d.observable(g.jsModuleParams):this.jsModuleParams=d.observable(),this.jsModuleUseApply=g.jsModuleUseApply,null!==g.popJSModuleOnFocus?this.popJSModuleOnFocus=d.observable(g.popJSModuleOnFocus):this.popJSModuleOnFocus=d.observable(),this.addParseValueParam=g.addParseValueParam,this.jsModuleValue=d.computed(u(this)),this.dependentFields=d.observableArray(g.dependentFields),this.clientDisabled=d.observable(!1),this.successMessage=d.observable(),this.errorMessage=d.observable(),this.validationMessage=d.observable(),this.isValid=d.computed(E.bind(null,this)),this.valueChanged=new i,this.valueBeforeChangedSubscription=this.value.subscribe(N.bind(null,l),null,"beforeChange"),
this.maxNumberOfValues()<=1?this.valueChangedSubscription=this.value.subscribe(K.bind(null,l)):this.valuesChangedSubscription=this.values.subscribe(I.bind(null,l)),this.placeHolder=d.computed(t.bind(null,l)),g.hidden=g.hidden||!1,this.hidden=d.observable(g.hidden),this.layoutElement=null}function s(a){return a.isSelected===!0}function t(a){return"NumericTextBox"===a.inputType()||"UOMTextbox"===a.inputType()?a.translate("DS_NUMERIC_INPUT"):a.translate("DS_TEXT_INPUT")}function u(a){return{read:function b(){var c=a.value();return c&&c.toString().indexOf("&parseValue=true")>-1?c.toString().substring(0,c.toString().indexOf("&parseValue=true")):c},write:function b(c){c&&c.toString().indexOf("&parseValue=true")===-1&&a.addParseValueParam?a.value(c+"&parseValue=true"):a.value(c)},owner:a}}r.prototype.translate=function a(b){return this.translator.translate(b)},r.prototype.isCleanHref=function a(c){var d=c?c:this.displayValue(),e;try{e=b(d)}catch(a){return!0}return""!==q(e.attr("href"))}
;function v(a){var b=!1;"string"==typeof a.value()&&("true"!==a.value().toLowerCase()&&"false"!==a.value().toLowerCase()||(b=!0)),"boolean"==typeof a.value()&&(b=!0),b&&(a.computedBoolVal=d.computed(w(a)))}function w(a){return{read:function(){return l.toBoolean(a.value(),"True")},write:function(b){a.value(b)}}}function x(a,b){var c="";if(""!==b){var d=b.split("\\");c=d[d.length-1]}a.value(c)}r.prototype.handleDate=function b(){var c=this,d=l.toDate(this.value());a.defer(y.bind(null,c,d))},r.prototype.handleDateFormat=function a(b){b!==this.format&&(this.format=b,this.format?this.dateFormat(z(this.format)):h.user&&h.user.formats&&h.user.formats.dateTime&&this.dateFormat(h.user.formats.dateTime))};function y(a,b){a.isDateControl(!0),a.dateValue(b),a.dateSubscription&&a.dateSubscription.dispose(),a.dateSubscription=a.dateValue.subscribe(B.bind(null,a))}r.prototype.convertDate=function a(b){var c=this;return this.value()?n.format(new Date(this.value()),this.dateFormat()):this.value()}
;function z(a){return n.getFormatByCode(a)}function A(a,b,c){return c.replace(new RegExp(a,"g"),b)}function B(a,b){var c=n.format(b,C(a));""===a.value()&&null===c||"0NaN-NaN-NaN"===c||(null===c&&(c=""),a.value(c))}function C(a){return"yyyy-MM-ddTHH:mm:ss.fff"}r.prototype.showTextEditor=function a(b){var c=new e(this.fieldValue().value(),this,this.fieldValue().disabled()||this.fieldValue().clientDisabled(),b),d=new f,h,i={},j;return i.closeIcon=!0,i.height="75%",i.width="75%",j=this.caption?this.caption().replace(/:([^:]*)$/,"$1").trim():this.columnCaption,""===j&&(j=this.fieldValue().translate("DS_TEXT_EDITOR_TITLE")),c.attach(d),h=new g(c,j,i),h.show(),c.action.add(D.bind(null,h)),c};function D(a){a.closeDialog()}r.prototype.dispose=function a(){this.valueChanged.remove(),this.valueBeforeChangedSubscription&&this.valueBeforeChangedSubscription.dispose(),this.valuesChangedSubscription&&this.valuesChangedSubscription.dispose(),this.isValid&&this.isValid.dispose()},
r.prototype.deallocateMem=function a(){this.translator=null,this.oldValue=null,this.computedBoolVal&&(this.computedBoolVal.dispose(),this.computedBoolVal=null),this.caption=null,this.defaultCaption=null,this.dbLength=null,this.format=null,this.behaviors=null,this.isMaskedField=null,this.helpText=null,this.valueChanged.remove(),this.valueChanged=null,this.key=null,this.id=null,this.entityKey=null,this.value=null,this.displayValue=null,this.uom=null,this.uomKey=null,this.disValue&&(this.disValue.dispose(),this.disValue=null),this.clientid=null,this.isSelected=null,this.changedFromView=null,this.isDirty=null,this.required=null,this.disabled=null,this.maxNumberOfValues=null,this.oldValues=null,this._values=null,this.values=null,this.picklist&&(this.picklist=null,this.isPicklistRestricted=null,this.picklistValue=null),this.browsevalue=null,this.dateFormat=null,this.dateValue=null,this.isDateControl=null,this.dateSubscription=null,this.backColor=null,this.jsModuleName=null,
this.jsModuleParams=null,this.popJSModuleOnFocus=null,this.dependentFields=null,this.clientDisabled=null,this.successMessage=null,this.errorMessage=null,this.validationMessage=null,this.isValid&&(this.isValid.dispose(),this.isValid=null),this.placeHolder&&(this.placeHolder.dispose(),this.placeHolder=null),this.valueBeforeChangedSubscription&&(this.valueBeforeChangedSubscription.dispose(),this.valueBeforeChangedSubscription=null),this.valuesChangedSubscription&&(this.valuesChangedSubscription.dispose(),this.valuesChangedSubscription=null),this.valueChangedSubscription&&(this.valueChangedSubscription.dispose(),this.valueChangedSubscription=null),this.hidden=null,this.layoutElement=null,this.picklistValueSubscription&&(this.picklistValueSubscription.dispose(),this.picklistValueSubscription=null),this.picklistSubscription&&(this.picklistSubscription.dispose(),this.picklistSubscription=null),this.jsModuleValue&&(this.jsModuleValue.dispose(),this.jsModuleValue=null),
this.browsevalueSubscription&&(this.browsevalueSubscription.dispose(),this.browsevalueSubscription=null),this.inputType=null,this.addParseValueParam=null};function E(a){var b=!0;return a.errorMessage()?(b=!1,a.validationMessage(a.errorMessage()),b):a.required()?""===a.value().toString()||void 0===a.value()?(b=!1,a.validationMessage(a.translate("DS_VALIDATION_MESSAGE")),b):b:(b=!0,a.validationMessage(""),b)}r.prototype.createPickList=function b(c){var d=[],e=!1,f=!1,g,h=this;if(void 0!==c){for(g=0;g<c.length;g++)if(c[g].isSelected===!0){e=!0;break}if(!e){var i=a.compact(h.values());e=parseInt(h.maxNumberOfValues())>1&&i.length}if(!h.required()&&h.maxNumberOfValues()<2){for(var j=0;j<c.length;j++)if(""===c[j].value.toString().trim()){f=!0;break}f&&0!==c.length||d.push({value:"",displayValue:""})}else!e&&h.required()&&d.push({value:"",displayValue:"",isSelected:!0});for(g=0;g<c.length;g++)d.push(c[g]);return d}},r.prototype.innerText=function c(){var d,e,f,g,h,i,j=null,k,l,m,n,o
;k=l=m=o="";try{d=JSON.parse(this.displayValue())}catch(a){d=null}if(d&&a.isArray(d)&&0!==d.length)return d[0].description;if(e=this.displayValue().split("href"),e[1]&&!(e[1].indexOf("http")>0||e[1].indexOf("www.")>0)){for(m=m.concat("href"),j=e[1].split(/>/),o=j[1],n=b(this.displayValue())[0].attributes,i=0;i<n.length;i++)if("href"!==n[i].nodeName&&!n[i].nodeName.match(/>|&|\\/)){j=j[0].split(n[i].nodeName),j[0]=j[0].trim();break}if(/\'|\"/.test(j[0])&&(j[0]=j[0].replace(/\'|\"/g,"")),f=j[0].split("?"),g=f[0].split("/"),g.length>1)for(i=1;i<g.length;i++)g[i]="/"+encodeURIComponent(g[i]);for(i=0;i<g.length;i++)m=m.concat(g[i]);if(f[1]){for(h=f[1].split(/=|&/),i=1;i<h.length;i+=2)h[i]="="+encodeURIComponent(h[i])+"&";for(i=0;i<h.length;i++)l=l.concat(h[i]);"&"===l.charAt(l.length-1)&&(l=l.substring(0,l.length-1))}for(""!==l&&""!==m&&(m=m.concat("?")),k="<a "+m+l,i=0;i<n.length;i++)"href"===n[i].nodeName||n[i].nodeName.match(/>|&|\\/)||(k=k+" "+n[i].nodeName+"="+n[i].nodeValue)
;k=k+">"+o+">",k=k.replace(/%23/g,"#"),k&&this.displayValue(k)}try{return b(this.displayValue()).text()}catch(a){return this.displayValue()}};function F(b){var c=b.displayValue();if(!c||"NumericTextBox"!==b.inputType()&&"UOMTextbox"!==b.inputType()||G(b)){if(/<a href=(|'|")#datasheet-dialog.*<\/a>/.test(c)){var d=location.hash.split(";")[parseInt(location.hash.split(";")[0].replace("#",""))+1].split("=")[1];c=c.replace(/href=#datasheet-dialog\//g,"href=#"+d+"?datasheet-dialog=")}}else if(c.toString().indexOf("E")===-1){var e=k.parseFloat(c);!isNaN(e)&&isFinite(e)&&a.isNumber(parseFloat(e))&&(c=n.format(e,"m"))}return void 0===b.uom().length||""===b.displayValue().trim()?c:c+" ("+b.uom()+")"}function G(b){return a.find(b.behaviors,function(a){return"Format"===a.behaviorType})}function H(b,c){var d,e;e=a.find(c,function(a){return a.isSelected===!0}),d=e?e.value:"",b.picklistValue(d)}function I(b,c){if(b.changedFromView()){if(b.isDirty(!0),
parseInt(b.maxNumberOfValues())>1&&(c=a.compact(c)),a.isEqual(c,[].concat(b.oldValues())))return;b.oldValues([].concat(c)),""!==b.errorMessage()&&void 0!==b.errorMessage()&&""===c||b.valueChanged.raise(b.key(),c,b.oldValue||null,b.clientid(),b.dependentFields(),"values")}else E.bind(null,b),b.isDirty()&&b.isDirty(!1);b.changedFromView(!0)}function J(a,b){return b&&b.toString()&&b.toString().indexOf("href")>0&&!a.isCleanHref(b.toString())}function K(a,b){if(a.changedFromView()){if(b=c(b),b=b?b.replace(/&lt;/g,"<").replace(/&gt;/g,">"):b,L(a)&&b&&b.toString().trim().toLowerCase().indexOf("<script")>-1||J(a,b)){var d=Object.resolve(p);return a.changedFromView(!1),a.value(a.oldValue),void d.unsupportedTextFound(a)}b&&b.toString().indexOf("&parseValue=true")>-1?a.displayValue(b.toString().substring(0,b.toString().indexOf("&parseValue=true"))):a.displayValue(b),a.isDirty(!0),
""!==a.errorMessage()&&void 0!==a.errorMessage()&&""===b||a.valueChanged.raise(a.key(),b,a.oldValue||null,a.clientid(),a.dependentFields())}else a.dateValue(b),E.bind(null,a),a.isDirty()&&a.isDirty(!1);a.changedFromView(!0)}function L(a){return"MaskedTextBox"===a.inputType()||"NumericTextBox"===a.inputType()||"Date"===a.inputType()||"Textbox"===a.inputType()||"TextArea"===a.inputType()||"UOMTextbox"===a.inputType()}function M(a,b){a.value(b)}function N(a,b){a.oldValue=b}function O(b){a.find(b.behaviors,P)&&(b.isMaskedField=!0)}function P(a){return a&&"Masked"===a.behaviorType}return r});
define('platform/datasheets/layout/model/entity-model',['require','knockout','system/lang/event','system/knockout/knockout-helpers'],function(require){"use strict";var a=require("knockout"),b=require("system/lang/event");require("system/knockout/knockout-helpers");function c(c,f,g,h){var i=0;for(c=c||[],i=0;i!==c.length;i++)c[i].valueChanged.add(d.bind(null,this),this);this.key=f,this.clientid=g,this.fieldValues=a.observableArray(c),this.isAuditable=h,this.fieldValuesSubscription=this.fieldValues.subscribe(e.bind(null,this),null,"arrayChange"),this.fieldValueChanged=new b}c.prototype.dispose=function a(){var b=0;for(b=0;b!==this.fieldValues().length;b++)this.fieldValues()[b].dispose();this.fieldValues.removeAll(),this.fieldValuesSubscription.dispose()},c.prototype.deallocateMem=function a(){var b;for(b=0;b<this.fieldValues().length;b++)this.fieldValues()[b].valueChanged.remove(this),this.fieldValues()[b].dispose(),this.fieldValues()[b].deallocateMem(),this.fieldValues()[b]=null;this.fieldValuesSubscription.dispose(),this.fieldValuesSubscription=null,this.fieldValues.removeAll(),this.fieldValues=null,
this.key=null,this.clientid=null,this.isAuditable=null,this.fieldValueChanged=null};function d(a,b,c,d,e,f,g){a.fieldValueChanged.raise(a.key,b,c,d,a.clientid,f,g)}function e(a,b){var c=0,e=[],f=[];for(c=0;c!==b.length;c++)"added"===b[c].status?e.push(b[c].value):"deleted"===b[c].status&&f.push(b[c].value);for(c=0;c!==e.length;c++)e[c].valueChanged.add(d.bind(null,a));for(c=0;c!==f.length;c++)f[c].valueChanged.remove(d.bind(null,a))}return c});
define('platform/datasheets/layout/model/datasheet-clipboard-model',['require','knockout','system/lang/event'],function(require){"use strict";var a=require("knockout"),b=require("system/lang/event");function c(){this.isEmpty=a.observable(!0),this.onChange=new b,this.clipboardKey="DSClipboard",null!==this.getData()&&this.isEmpty(!1)}c.prototype.setData=function(a,b){var c=new d(a,b);return c.fieldValues=c.fieldValues.filter(function(a){return"MIRD_DOC_PATH_CHR"!==a.id}),window.sessionStorage.setItem(this.clipboardKey,JSON.stringify(c)),this.isEmpty(!1),this.onChange.raise(),c},c.prototype.getData=function(){return JSON.parse(window.sessionStorage.getItem(this.clipboardKey))};function d(a,b){var c=0;for(this.familykey=a,this.fieldValues=[],c;c<b.length;c++){var d=b[c];d.disabled()||this.fieldValues.push(new e(d))}}function e(a){return this.id=a.id(),this.key=a.key(),this.value=a.value(),this.values=a.values(),this.displayValue=a.displayValue(),this.required=a.required(),this.hidden=a.hidden(),this.backColor=a.backColor(),void 0!==a.picklist&&(this.picklist=a.picklist()),
this.errorMessage=a.errorMessage(),this}return new c});
define('platform/datasheets/layout/model/layout-size-model',['require','knockout','system/knockout/knockout-helpers'],function(require){"use strict";var a=require("knockout");require("system/knockout/knockout-helpers");function b(b){b=b||{},this.height=a.observable(b.height),this.width=a.observable(b.width),this.percentageHeight=a.observable(b.percentageHeight),this.width=a.observable(b.percentageWidth)}return b});
define('platform/datasheets/layout/model/layout-location-model',['require','knockout','system/knockout/knockout-helpers'],function(require){"use strict";var a=require("knockout");require("system/knockout/knockout-helpers");function b(b){b=b||{},this.row=a.observable(b.row),this.column=a.observable(b.column),this.rowSpan=a.observable(b.rowSpan),this.columnSpan=a.observable(b.columnSpan),this.x=a.observable(b.x),this.y=a.observable(b.y)}return b});
define('platform/datasheets/layout/model/layout-element-model',['require','jquery','knockout','./layout-size-model','./layout-location-model','system/knockout/knockout-helpers'],function(require){"use strict";var a=require("jquery"),b=require("knockout"),c=require("./layout-size-model"),d=require("./layout-location-model");require("system/knockout/knockout-helpers");function e(f){var g;f=f||{},this.controlName=b.observable(f.controlName),this.name=b.observable(f.name),this.parentName=b.observable(f.parentName),this.type=b.observable(f.type),this.visible=b.observable(f.visible),this.caption=b.observable(f.caption||f.defaultCaption),this.defaultCaption=b.observable(f.defaultCaption),this.captionVisible=b.observable(f.captionVisible),this.captionPosition=b.observable(f.captionPosition),this.children=b.observableArray(),f.children&&f.children.length>0&&(g=a.map(f.children,function(a){return new e(a)}),this.children(g)),this.size=b.observable(new c(f.size)),this.location=b.observable(new d(f.location)),this.captionSize=b.observable(new c(f.captionSize))}return e});
define('platform/datasheets/layout/model/datasheet-layout-model',['require','jquery','knockout','./layout-element-model','system/knockout/knockout-helpers'],function(require){"use strict";var a=require("jquery"),b=require("knockout"),c=require("./layout-element-model");require("system/knockout/knockout-helpers");function d(d){var e;d=d||{},d.elements=d.elements||[],e=a.map(d.elements,function(a){return new c(a)}),this.elements=b.observableArray(e)}return d});
define('platform/datasheets/layout/model/datasheet-model',['require','jquery','knockout','./datasheet-layout-model','system/globalization/translator','system/knockout/knockout-helpers'],function(require){"use strict";var a=require("jquery"),b=require("knockout"),c=require("./datasheet-layout-model"),d=require("system/globalization/translator");require("system/knockout/knockout-helpers");function e(e){e=e||{},this.key=b.observable(e.key),this.id=b.observable(e.id),this.caption=b.observable(e.caption),this.defaultCaption=b.observable(e.defaultCaption),this.description=b.observable(e.description),this.familyKey=b.observable(e.familyKey),this.familyType=b.observable(e.familyType),this.familyID=b.observable(e.familyID),this.isCustomForm=b.observable(e.isCustomForm),this.isMasterDetail=b.observable(e.isMasterDetail),this.isDefault=b.observable(e.isDefault),this.lastViewed=b.observable(e.lastViewed),this.sections=b.observable(e.sections),this.updateUser=b.observable(e.updateUser),this.updateDate=b.observable(e.updateDate),this.translator=Object.resolve(d),this.title=b.observable(this.translator.translate("DS_DATASHEET_TITLE")),b.bindingHandlers.warningMsg={
init:function(b,c){a(b).tooltip({content:c(),html:!0})},update:function(b,c){a(b).tooltip({content:c(),html:!0,tooltipClass:"warning-messsage-popup"})}},e.layout?this.layout=new c(e.layout):e.columns&&(this.columns=e.columns)}return e});
define('platform/datasheets/layout/adapters/datasheet-adapter',['require','../services/dto/datasheet-dto','../model/datasheet-model'],function(require){"use strict";var a=require("../services/dto/datasheet-dto"),b=require("../model/datasheet-model");function c(){}return c.toModelObject=function a(c){return new b(c)},c.toDTO=function b(c){var d=new a;return d.key=c.key(),d.id=c.id(),d.caption=c.caption(),d.defaultCaption=c.defaultCaption(),d.description=c.description(),d.familyKey=c.familyKey(),d.familyType=c.familyType(),d.familyID=c.familyID(),d.isCustomForm=c.isCustomForm(),d.isDefault=c.isDefault(),d.sections=c.sections(),d.updateUser=c.updateUser(),d.updateDate=c.updateDate(),d.title=c.title(),d},c});
define('platform/datasheets/layout/model/datasheet-field-info-model',[],function(){"use strict";function a(a){a=a||{},this.fieldKey=a.fieldKey,this.fieldId=a.fieldId,this.inputType=a.inputType,this.maxLength=a.maxLength,this.isActive=a.isActive}return a});
define('platform/datasheets/layout/adapters/datasheet-field-info-adapter',['require','../services/dto/datasheet-field-info-dto','../model/datasheet-field-info-model'],function(require){"use strict";var a=require("../services/dto/datasheet-field-info-dto"),b=require("../model/datasheet-field-info-model");function c(){}return c.toModelObject=function a(c){return new b(c)},c.toDTO=function b(c){var d=new a;return d.fieldKey=c.fieldKey,d.inputType=c.inputType,d.maxLength=c.maxLength,d.isActive=c.isActive,d},c});

define('text!platform/datasheets/error-dialog/ui/views/error-dialog.html',[],function () { return '<div style="height:400px;">\r\n  \r\n        <div>\r\n            <h4 data-bind="text: $root.translate(\'DS_ERROR_WHILE_SAVING_RECORDS_MESSAGE\')"></h4>\r\n        </div>\r\n\r\n        <div class="table-responsive" style="font-size:12px; max-height:400px;height:calc(100% - 100px); overflow:auto;">\r\n\r\n            <table class="table table-bordered">\r\n                <thead>\r\n                    <tr>\r\n                        <th data-bind="text: $root.translate(\'DS_ID\')"></th>\r\n                        <th data-bind="text: $root.translate(\'DS_ERROR\')"></th>\r\n                    </tr>\r\n                </thead>\r\n                <tbody data-bind="foreach:errors">\r\n                    <tr>\r\n                        <td data-bind="text:$data.id"></td>\r\n                        <td data-bind="text:$data.errorMessage"></td>\r\n                    </tr>\r\n                </tbody>\r\n            </table>\r\n        </div>\r\n\r\n   \r\n    <div style="height:50px;padding:5px;">\r\n        <button type="button" class="btn btn-primary pull-right" data-bind="click:closeError, text: $root.translate(\'DS_CLOSE\')"></button> \r\n    </div>\r\n    \r\n</div>';});

define('platform/datasheets/error-dialog/ui/error-dialog-view-model',['require','knockout','spa/ko/knockout-view-model','text!./views/error-dialog.html','system/lang/event','system/globalization/translator'],function(require){"use strict";var a=require("knockout"),b=require("spa/ko/knockout-view-model"),c=require("text!./views/error-dialog.html"),d=require("system/lang/event"),e=require("system/globalization/translator");function f(b){g.call(this,c),this.errors=a.observableArray(),this.closeDialog=new d,this.translator=Object.resolve(e),this.populateErrors(b)}var g=Object.inherit(b,f);return f.prototype.populateErrors=function a(b){var c=0,d=this;for(c=0;c<b.length;c++)d.errors.push({id:b[c].id,errorMessage:b[c].errorMessage})},f.prototype.attach=function a(b){g.prototype.attach.call(this,b),this.region=b},f.prototype.detach=function a(b){g.prototype.attach.call(this,b)},f.prototype.closeError=function a(){this.closeDialog.raise()},f.prototype.translate=function a(b){return this.translator.translate(b)},f});
define('platform/datasheets/layout/ui/utils',['require','jquery','system/error/error-message','platform/datasheets/error-dialog/ui/error-dialog-view-model','system/ui/dialog-view-model'],function(require){"use strict";var a=require("jquery"),b=require("system/error/error-message"),c=require("platform/datasheets/error-dialog/ui/error-dialog-view-model"),d=require("system/ui/dialog-view-model");function e(){}e.prototype.setErrorAndReturnErrorFlag=function a(b,c,d){var e=!1,f=!1;return"form"===b?this.setErrorAndReturnErrorFlagForForm(b,c):"bulk"===b?this.setErrorAndReturnErrorFlagForBulk(b,c,d):"mdf"===b?(e=this.setErrorAndReturnErrorFlagForForm(b,c),f=this.setErrorAndReturnErrorFlagForBulk(b,c,d),e||f):void 0},e.prototype.setErrorAndReturnErrorFlagForForm=function a(b,c){for(var d=!1,e,f,g,h=c.entity.fields,m=0;m<h.length;m++)h.models[m].attributes.isRequired===!0&&(""===h.models[m].attributes.value&&(g=h.models[m].attributes.id,f=i(c,h,m,!1),c.appEvents.errorOccured.raise(null,f),e=j(c,g),e&&k(c,e),d=!0),""!==h.models[m].attributes.errorMessage&&(d=!0)),"Date"===h.models[m].attributes.dataType&&""!==h.models[m].attributes.errorMessage&&(f=i(c,h,m,!0),
c.appEvents.errorOccured.raise(null,f),d=!0);return d&&"mdf"===b&&l("master",c),d},e.prototype.setErrorAndReturnErrorFlagForBulk=function a(b,c,d){var e,h,i,j,k=!1,m=[];for(h=0;d&&h<d.length;h++)for(e=d[h].fields,i=0;i<e.length;i++)e.models[i].attributes.isRequired===!0&&(""===e.models[i].attributes.value&&(g(c,m,d[h].id,e.models[i].attributes.caption,!1),k=!0),""!==e.models[i].attributes.errorMessage&&(g(c,m,d[h].id,e.models[i].attributes.caption,!1),k=!0)),"Date"===e.models[i].attributes.dataType&&e.models[i].attributes.errorMessage===c.translator.translate("FORMAT_IS_NOT_VALID")&&(g(c,m,d[h].id,e.models[i].attributes.caption,!0),k=!0);return k&&(f(c,m),"mdf"===b&&l("detail",c)),k},e.prototype.clearAllErrorNotifications=function a(b){b.containerEl&&b.containerEl.find("i.icon-riskmatrix-exclamation").remove()};function f(a,b){var e,f;e=new c(b),f=new d(e,a.translator.translate("DS_ERROR_REPORT")),e.closeDialog.add(h.bind(null,f)),f.show()}function g(a,b,c,d,e){e?b.push({id:c,
errorMessage:d+" "+a.translator.translate("FORMAT_IS_NOT_VALID")}):b.push({id:c,errorMessage:d+" "+a.translator.translate("DS_REQ")})}function h(a){a.closeDialog()}function i(a,c,d,e){var f=2,g,h,i;return e?(g=c.models[d].attributes.caption+" "+a.translator.translate("FORMAT_IS_NOT_VALID"),h=c.models[d].attributes.caption+" "+a.translator.translate("FORMAT_IS_NOT_VALID"),i=new b(f,g,h)):(g=c.models[d].attributes.caption+" "+a.translator.translate("DS_REQ"),h=c.models[d].attributes.caption+" "+a.translator.translate("DS_REQ"),i=new b(f,g,h)),i}function j(a,b){if(a.containerEl.find("div[data-controlname='"+b+"']").closest("div.tab-pane").length>0){return"."+a.containerEl.find("div[data-controlname='"+b+"']").closest("div.tab-pane").attr("class").split(" ")[0]}}function k(a,b){m(a,b)||a.containerEl.find("a[data-target='"+b+"']").append('<i class="icon-riskmatrix-exclamation"></i>'),a.containerEl.find(".icon-riskmatrix-exclamation").css("color","red")}function l(a,b){
var c=b.containerEl.find('mi-tab[value="'+a+'"]');c.find(".icon-riskmatrix-exclamation").length||(c.find('td[class="tdtxtcenter"]').append('<span><i class="icon-riskmatrix-exclamation"></i></span>'),c.find(".icon-riskmatrix-exclamation").css({color:"red","vertical-align":"sub"}))}function m(b,c){var d=!1,e=b.containerEl.find("a[data-target='"+c+"']");return a(e).find("i").length>0&&(d=!0),d}return e});
define('ui/elements/ref-doc/services/service',['require','jquery','system/lang/object','system/http/ajax-client'],function(require){"use strict";var a=require("jquery");require("system/lang/object");var b=require("system/http/ajax-client"),c="api/common/referencedocuments/",d="api/core/metadata/",e="api/core/entity/";function f(a){this.ajaxClient=a}f.dependsOn=[b],f.prototype.getRefDocs=function(b){var c=a.Deferred(),d=e+"refdoc/"+b;return this.ajaxClient.get(d,{}).done(function(a){c.resolve(a)}).fail(function(a){c.reject(a.statusText)}),c.promise()},f.prototype.getSiteKey=function(b){var c=a.Deferred(),d=e+"sitekey/"+b;return this.ajaxClient.get(d,{}).done(function(a){c.resolve(a)}).fail(function(a){c.reject(a.statusText)}),c.promise()},f.prototype.unlinkRefDoc=function(b,d){var e=a.Deferred(),f=c+"refdocunlink/"+b+"/"+d;return this.ajaxClient.delete(f,{}).done(function(a){e.resolve(a)}).fail(function(a){e.reject(a.statusText)}),e.promise()},f.prototype.delteRefDoc=function(b){var d=a.Deferred(),e=c+"delete/"+b;return this.ajaxClient.delete(e,{}).done(function(a){d.resolve(a)
}).fail(function(a){d.reject(a.statusText)}),d.promise()},f.prototype.addRefDoc=function(b,c){var d=a.Deferred(),f=e+"refdocinsertnlink/"+b,g={refDoc:c},h=c;return h.entityModified=null,h.entitySaved=null,h.entityDeleted=null,h.entityIdChanged=null,h.entityChangedEvent=null,this.ajaxClient.post(f,h).done(function(a){d.resolve(a)}).fail(function(a){d.reject(a.statusText)}),d.promise()},f.prototype.linkRefDocEnntity=function(b,c){var d=a.Deferred(),f=e+"refdoclink/"+b+"/"+c;return this.ajaxClient.post(f).done(function(a){d.resolve(a)}).fail(function(a){d.reject(a.statusText)}),d.promise()},f.prototype.openRefDoc=function(b,d){var e=a.Deferred(),f=c+"refdocopen/"+b;return this.ajaxClient.getBinary(f).done(g.bind(null,d)).fail(i.bind(null,e)),e.promise()},f.prototype.getAllRefDocByRelatedEntyKey=function(b){var d=a.Deferred(),e=c+b;return this.ajaxClient.get(e,{}).done(m.bind(null,d)).fail(i.bind(null,d)),d.promise()};function g(a,b){
if(navigator.msSaveBlob)navigator.msSaveOrOpenBlob(b,a.documentPath);else if("undefined"!=typeof cordova){var c=h(a.documentPath);cordova.writeBinaryToLocalFile(b,c,cordova.openLocalFile.bind(null,c))}else{var d=window.URL.createObjectURL(b);window.open(d)}}function h(a){var b=a.split("\\");return b[b.length-1]}function i(a,b){console.log(b),a.reject(b)}function j(a,b){var c="data:"+b+";base64,"+escape(a);return window.open(c,"_blank"),!0}f.prototype.getRefDocType=function(b){var d=a.Deferred(),e=c+"refdoctype/"+b;return this.ajaxClient.get(e,{}).done(function(a){d.resolve(a)}).fail(function(a){d.reject(a.statusText)}),d.promise()},f.prototype.saveRefDoc=function(b,c){var d=a.Deferred(),f=e,g=c;return g.entityModified=null,g.entitySaved=null,g.entityDeleted=null,g.entityIdChanged=null,g.entityChangedEvent=null,this.ajaxClient.put(f,g).done(function(a){d.resolve(a)}).fail(function(a){d.reject(a.statusText)}),d.promise()},f.prototype.uploadRefDoc=function(b,d){
var e=a.Deferred(),f=JSON.parse(sessionStorage.getItem("meridium-session")).id,g=c+"refdocupload/"+d,h,i;return b.append("sessionid",f),i=this.ajaxClient.baseUrl()+c+"refdocupload/"+d,h={data:b,cache:!1,contentType:!1,processData:!1},this.ajaxClient.post(i,"",h).done(function(a){e.resolve(a)}).fail(function(a,b,c){e.reject(b)}),e.promise()},f.prototype.getBaseUrl=function(){return this.ajaxClient.baseUrl()},f.prototype.refDocServerCredentialsExist=function(){var b=a.Deferred();return this.ajaxClient.get("api/refdoc-server/config").done(k.bind(null,b)).fail(l.bind(null,b)),b.promise()},f.prototype.getRefDocSize=function b(d){var e=a.Deferred();return this.ajaxClient.get(c+"refdocsize/"+d).done(function(a){e.resolve(a)}).fail(function(){e.reject()}),e.promise()};function k(a,b){var c=!1;""!==b.userName&&""!==b.userPassword&&(c=!0),a.resolve(c)}function l(a,b){a.reject(b)}function m(a,b){var c=0,d=0,e=[],f=[];for(c=0;c<b.columns.length;c++){var g={}
;"-1"===b.columns[c].famliyMappingIndex.toString()?g.id=b.columns[c].uniqueId:(b.columns[c].id.indexOf("[")>-1&&(b.columns[c].id=b.columns[c].id.replace(/[\[\]']+/g,"")),g.id=b.columns[c].id),void 0!==b.columns[c].alias&&""!==b.columns[c].alias?g.alias=b.columns[c].alias:g.alias=b.columns[c].id,g.visible=b.columns[c].isVisible,"MI_SITE_KEY"!==g.id&&"ENTY_KEY"!==g.id&&"MI_REF_DOCUMENTS_STORE_DOCUM_L"!==g.id&&"MIRD_DOC_PATH_CHR"!==g.id&&"MI_REF_DOCUMENTS_DOCUM_EXTEN_C"!==g.id||(g.visible=!1),"CTIT_ID"===g.id&&(g.hasCellTemplate="true");var h=b.columns[c].typeName;"System.Int64"===h||"System.Double"===h?g.dataType="number":"System.DateTime"===h&&(g.dataType="date"),e.push(g)}for(c=0;c<b.rowColumns.length;c++){var i={};for(d=0;d<e.length;d++)i[e[d].id]=null===b.rowColumns[c].values[d]?"":b.rowColumns[c].values[d];f.push(i)}a.resolve({columns:e,data:f})}return f});

define('text!system/error/views/error-detail-view.html',[],function () { return '<div class="error-detail-wrapper">\r\n    <div class="block-group">\r\n        <div class="error-code error-header error-header-code block" data-bind="text: translate(\'ERROR_CODE\')"></div>\r\n    </div>\r\n\r\n    <div class="block-group">\r\n        <div data-bind="text:code" class="error-code block"></div>\r\n    </div>\r\n\r\n    <div class="block-group error-message-group">\r\n        <div class="error-message error-header error-header-message block" data-bind="text: translate(\'MESSAGE\')"></div>\r\n        <div data-bind="html:message" class="error-message block"></div>\r\n    </div>\r\n\r\n    <!-- ko if: detail -->\r\n    <div class="block-group error-message-detail">\r\n        <div class="error-url error-header error-header-url block" data-bind="text: translate(\'DETAILS\')"></div>\r\n        <pre data-bind="html:detail" class="error-url error-body-url block"></pre>\r\n    </div>\r\n    <!-- /ko -->\r\n\r\n    <section class="button-align">\r\n        <div class="btn btn-primary error-dialog-close" data-bind="text: translate(\'OK\')"></div>\r\n    </section>\r\n</div>';});

define('system/error/error-detail-view-model',['require','text!./views/error-detail-view.html','system/globalization/translator','spa/ko/knockout-view-model'],function(require){"use strict";var a=require("text!./views/error-detail-view.html"),b=require("system/globalization/translator"),c=require("spa/ko/knockout-view-model");function d(c){e.call(this,a),this.errorMessage=c,this.translator=Object.resolve(b)}var e=Object.inherit(c,d);d.prototype.attach=function a(b){this.code=this.errorMessage.code,this.message=this.errorMessage.message;try{this.detail=f(g(this.errorMessage.detail))||null}catch(a){this.detail=this.errorMessage.detail||null}e.prototype.attach.call(this,b)},d.prototype.detach=function a(b){e.prototype.detach.call(this,b)},d.prototype.translate=function(a){return this.translator.translate(a)};function f(a){return JSON.stringify(JSON.parse(a),null,"\t")}function g(a){return a.split("<").join("&lt;").split("<").join("&gt;").split("\\r\\n").join("<br/>").split("\\n").join("<br/>")}return d});
define('logging/feedback-component/feedback-component',['require','jquery','toastr','system/error/error-detail-view-model','system/error/error-message','system/globalization/translator','system/ui/dialog-view-model'],function(require){"use strict";var a=require("jquery"),b=require("toastr"),c=require("system/error/error-detail-view-model"),d=require("system/error/error-message"),e=require("system/globalization/translator"),f=require("system/ui/dialog-view-model");function g(a){b.options={positionClass:"toast-top-center",timeOut:"10000",hideDuration:"1000",closeButton:!0}}g.prototype.info=function a(c,d){k(),b.info(c,d)},g.prototype.warning=function a(c,d){k(),b.warning(c,d)},g.prototype.success=function a(c,d){k(),b.success(c,d)},g.prototype.error=function a(d,e){var g=new c(d),h=j("ERROR")+" - "+d.code,k=new f(g,h,{height:"90%"});b.options.onclick=function(){k.show(),i(k)},b.options.onHidden=l,b.error(d.message,e)},g.prototype.errorMessageFromResponse=function(a){var b=new d(0,h(a.responseText));g.prototype.error(b)},g.prototype.errorMessageFromResponseWithDetails=function(a,b){var c=new d(0,h(b.responseText),a);g.prototype.error(c)},g.prototype.errorDetailsFromResponse=function(a,b){
var c=new d(0,a,h(b.responseText));g.prototype.error(c)},g.prototype.clear=function a(){b.clear()};function h(a){return'"'===a[0]&&'"'===a[a.length-1]&&(a=a.substring(1,a.length-1)),a}function i(b){a(".error-dialog-close").click(function(){b.closeDialog()})}function j(a){return Object.resolve(e).translate(a)}function k(){b.options.onclick=null}function l(){k(),b.options.onHidden=null}return g});
define('ui/elements/ref-doc/view-models/downloaders/base-downloader',["require","exports","system/diagnostics/log-manager","system/lang/ioc","system/globalization/translator","logging/feedback-component/feedback-component"],function(require,exports,a,b,c){"use strict";var d=require("logging/feedback-component/feedback-component"),e=function(){function e(a){this.indicator=a}return e.prototype.tryShowIndicator=function(){this.indicator&&this.indicator.show()},e.prototype.tryHideIndicator=function(){this.indicator&&this.indicator.hide()},e.prototype.showFailureToast=function(){var a=b.resolve(c);new d({closeButton:!0,timeOut:"200",hideDuration:"200"}).error({code:"0",message:a.translate("REFDOCS_FAILED_TO_OPEN_DOCUMENT")}),this.logError(new Error("failed to get ref doc type"))},e.prototype.logError=function(b){a.getLogger("app/ui/ref-doc/view-models/downloaders/base-downloader.ts").error(b.stack)},e}();exports.BaseDownloader=e});
define('ui/elements/ref-doc/view-models/downloaders/parsers/session-parser',["require","exports"],function(require,exports){"use strict";function a(){var a=sessionStorage.getItem("meridium-session"),b;return a&&(b=JSON.parse(a)),b}exports.getSession=a});
define('ui/elements/ref-doc/view-models/downloaders/builders/form-builder',["require","exports","system/http/ajax-client","system/lang/ioc","ui/elements/ref-doc/view-models/downloaders/parsers/session-parser"],function(require,exports,a,b,c){"use strict";var d=function(){function d(){}return d.prototype.getFormElement=function(d){var e=b.resolve(a),f="api/common/referencedocuments/refdocdownload/"+d,g=c.getSession().id,h=e.url(f);return $('<form action="'+h+'" method="post" enctype="application/x-www-form-urlencoded" target="_blank">'+this.getInputElement(g)+"</form>")},d.prototype.getInputElement=function(a){return'<input type="hidden" name="data" value="'+encodeURIComponent(JSON.stringify({sessionid:a}))+'"/>'},d}();exports.FormBuilder=d});
define('ui/elements/ref-doc/view-models/downloaders/desktop-downloader',["require","exports","ui/elements/ref-doc/view-models/downloaders/base-downloader","ui/elements/ref-doc/view-models/downloaders/builders/form-builder","ui/elements/ref-doc/view-models/downloaders/parsers/session-parser"],function(require,exports,a,b,c){"use strict";var d=function(a){__extends(d,a);function d(){return a.call(this)||this}return d.prototype.download=function(a){c.getSession()?this.downloadDesktop(a):this.logError(new Error("No session present.  Failed to download reference document."))},d.prototype.downloadDesktop=function(a){(new b.FormBuilder).getFormElement(a).appendTo("body").submit().remove()},d}(a.BaseDownloader);exports.DesktopDownloader=d});
define('ui/elements/ref-doc/view-models/downloaders/mobile-downloader',["require","exports","system/lang/ioc","ui/elements/ref-doc/view-models/downloaders/base-downloader","ui/elements/ref-doc/services/service"],function(require,exports,a,b){"use strict";var c=require("ui/elements/ref-doc/services/service"),d=function(b){__extends(d,b);function d(d){var e=b.call(this,d)||this;return e.refDocService=a.resolve(c),e}return d.prototype.download=function(a){var b=this;this.tryShowIndicator(),this.refDocService.getRefDocType(a).done(function(c){"URL"===c.type?b.openNetworkDocumentInBrowser(c):b.openDocumentOnDevice(a,c)}).fail(this.showFailureToast)},d.prototype.openNetworkDocumentInBrowser=function(a){window.cordova.InAppBrowser.open(a.documentPath,"_blank"),this.tryHideIndicator()},d.prototype.openDocumentOnDevice=function(a,b){this.refDocService.openRefDoc(a,b).fail(this.showFailureToast),this.tryHideIndicator()},d}(b.BaseDownloader);exports.MobileDownloader=d});
define('ui/elements/ref-doc/view-models/downloaders/factory/platform-downloader-factory',["require","exports","ui/elements/ref-doc/view-models/downloaders/desktop-downloader","ui/elements/ref-doc/view-models/downloaders/mobile-downloader"],function(require,exports,a,b){"use strict";function c(a,b){return a.isMobileApp()?e(b):d()}exports.createPlatformDownloader=c;function d(){return new a.DesktopDownloader}function e(a){return new b.MobileDownloader(a)}});
define('ui/elements/ref-doc/view-models/downloaders/downloader',["require","exports","system/hardware/device","system/lang/ioc","ui/elements/ref-doc/view-models/downloaders/factory/platform-downloader-factory"],function(require,exports,a,b,c){"use strict";return function(){function d(a){this.indicator=a}return d.prototype.download=function(d,e){var f=b.resolve(a),g=c.createPlatformDownloader(f,this.indicator);this.tryStopPropagation(e),g.download(d)},d.prototype.tryStopPropagation=function(a){a&&a.stopPropagation()},d}()});
define('platform/datasheets/layout/ui/helpers/ref-doc-helper',['require','exports','module','jquery','ui/elements/ref-doc/services/service','system/globalization/translator','ui/elements/ref-doc/view-models/downloaders/downloader'],function(require,exports,module){"use strict";var a=require("jquery"),b=require("ui/elements/ref-doc/services/service"),c=require("system/globalization/translator"),d=require("ui/elements/ref-doc/view-models/downloaders/downloader");function e(){this.refDocService=Object.resolve(b),this.translator=Object.resolve(c)}e.prototype.showRefDocs=function a(b,c){b.datasheetReference.raise(),b.isDatasheetRendered(!1),b.isRefDocRendered(!0),b.isMasterDatasheet()&&f(b),c?(b.region.$element.find(".ref-doc-container").append(c),b.refdocEl=c):(b.region.$element.find(".ref-doc-container").append('<mi-ref-doc showicon="true" entitykey="'+b.entykey()+'"></mi-ref-doc>'),b.refdocEl=b.region.$element.find("mi-ref-doc")[0]),Element.upgrade(b.refdocEl),b.refdocEl.refDocCB(b.hideRefDocs.bind(b,b.isDatasheetReadOnly())),b.isDatasheetReadOnly(!1),b.refDocsRendered.raise(b.refdocEl)};function f(b){var c=b.region.$element.parents(".master-detail-datasheet-layout-container")
;a(c).find("> .datasheet-nav").toggle(),a(c).find("> .mdf-tab-header").toggle()}return e.prototype.hideRefDocs=function a(b,c,d){b.isMasterDatasheet()&&f(b),b.region.$element.find(".ref-doc-container").empty(),b.refDocCount(d),b.isDatasheetRendered(!0),b.addMoreOptionsForIcons(),b.isRefDocRendered(!1),b.isDatasheetReadOnly(c),b.refDocsHidden.raise()},e.prototype.downloadRefDoc=function a(b,c,e){(new d).download(c,e)},e});
define('ui/elements/ref-doc/models/refdoc-path-dto',['require','system/lang/converter'],function(require){"use strict";var a=require("system/lang/converter");function b(b){b=b||{},this.isStored=a.toBoolean(b.isStored),this.isUrl=a.toBoolean(b.isUrl),this.isUnc=a.toBoolean(b.isUnc),this.path=a.toString(b.path),this.formData=a.toObject(b.formData,null)}return b});
define('ui/elements/ref-doc/models/refdoc-path-model',['require','knockout','system/lang/object'],function(require){"use strict";var a=require("knockout");require("system/lang/object");function b(b){var c=this;b=b||{},c.isStored=a.observable(b.isStored),c.isUrl=a.observable(b.isUrl),c.isUnc=a.observable(b.isUnc),c.path=a.observable(b.path),c.formData=b.formData}return b});
define('ui/elements/ref-doc/models/refdoc-path-adapter',['require','./refdoc-path-dto','./refdoc-path-model'],function(require){"use strict";var a=require("./refdoc-path-dto"),b=require("./refdoc-path-model");function c(){}return c.toModel=function a(c){return new b(c)},c.toDTO=function b(c){var d=new a;return c=c||{},d.isStored=c.isStored(),d.isUrl=c.isUrl(),d.isUnc=c.isUnc(),d.path=c.path(),d.formData=c.formData,d},c});
define('platform/datasheets/layout/ui/helpers/js-module-helper',['require','jquery','lodash','ui/elements/ref-doc/models/refdoc-path-adapter','system/ui/busy-indicator'],function(require){"use strict";var a=require("jquery"),b=require("lodash"),c=require("ui/elements/ref-doc/models/refdoc-path-adapter"),d=require("system/ui/busy-indicator");function e(){}e.prototype.showJSModule=function a(b,c){f(b,c)};function f(a,b){require([b.jsModuleName],function(c){var d;if("form"===b.type)d=new c,b.jsModuleUseApply?d.show.apply(d,b.jsModuleParams).done(g.bind(null,a,b)):d.show(b.jsModuleParams,a.entityReference,a.siteKey()).done(g.bind(null,a,b));else if("bulk"===b.type)d=new c,d.show(b.jsModuleParams).done(function(c){h(a,b,c),a.focusCell(b.data,a.rows(),b.cellIndex,b.rowIndex)}).fail(function(){a.focusCell(b.data,a.rows(),b.cellIndex,b.rowIndex)});else if("aggregate"===b.type){for(var e=null,f=0;f<a.entities().length;f++)for(var j=0;j<a.entities()[f].length;j++)if(a.entities()[f][j].clientid===b.clientID){e=a.entities()[f];break}d=new c(e),d.show(b.jsModuleParams).done(function(c){i(a,b,c),a.moveToNextModuleCell(b.data,a.rows(),b.cellIndex,b.rowIndex)
}).fail(function(c){c===!1&&a.moveToNextModuleCell(b.data,a.rows(),b.cellIndex,b.rowIndex)})}})}e.prototype.callOnFocus=function a(b,c,d){var e;"form"===c.type?(e=c.popJSModuleOnFocus)&&this.showJSModule(b,c):"bulk"!==c.type&&"aggregate"!==c.type||(e=d.popJSModuleOnFocus(),c={key:d.key(),jsModuleName:d.jsModuleName(),jsModuleParams:d.jsModuleParams(),entityKey:d.entityKey(),clientID:d.clientid(),type:c.type,cellIndex:c.cellIndex,rowIndex:c.rowIndex,fieldKey:c.fieldKey},e?this.showJSModule(b,c):b.focusCell(c.data,b.rows(),c.cellIndex,c.rowIndex))};function g(a,b,d){k(a);var e=0,f=[],g=null;for(a.currentEntity()&&(f=a.currentEntity().fieldValues()),e=0;e!==f.length;e++)if(f[e].key()===b.key){g=f[e];break}j(g,d),a.isReferenceDocument?a.refDocPathModel=c.toModel(d):d.isTeamModel&&(delete d.isTeamModel,a.teamModel=d)}function h(a,d,e){var f=0,g,h,i=[],k=null;for(a.entities()&&(g=b.find(a.entities(),function(a){return void 0===d.clientID?a.key===d.entityKey:a.clientid===d.clientID}),
i=g.fieldValues()),f=0;f!==i.length;f++)if(i[f].key().toString()===d.fieldKey||i[f].key()===d.fieldKey){k=i[f];break}j(k,e),a.entities()&&(h=b.find(a.rows(),function(a){return void 0===d.clientID?a.entitykey()===d.entityKey:a.clientid()===d.clientID}),h.refDocPathModel(c.toModel(e)))}function i(a,b,c){var d=0,e,f=[],g=null;if(a.entities()){for(var h=0;h<a.entities().length;h++)for(var i=0;i<a.entities()[h].length;i++){if("0"===a.entities()[h][i].key.toString()&&"0"===b.entityKey.toString()&&a.entities()[h][i].clientid.toString()===b.clientID.toString()){e=a.entities()[h][i];break}if("0"!==b.entityKey.toString()&&a.entities()[h][i].key.toString()===b.entityKey.toString()){e=a.entities()[h][i];break}}f=e.fieldValues()}for(d=0;d!==f.length;d++)if(f[d].key().toString()===b.fieldKey||f[d].key()===b.fieldKey){g=f[d];break}j(g,c)}function j(a,b){if(a){var c=JSON.stringify(b);b&&(c+="&parseValue=true"),a.value(c)}}function k(b){var c=!1
;a(".jsmodule-busy-indicator").find(".busy-indicator-wrap").remove();var e=Object.resolve(d);e.attachTo(b.region.element),e.show(),a(b.region.element).find(".loading-large").addClass("position-update"),a(b.region.element).find(".busy-indicator-wrap").addClass("jsmodule-busy-indicator"),b.fieldValueChanged.add(function(){c=!0}),b.entityReference.entityModified.add(function(){c&&(e.hide(),b.region&&a(b.region.element).find(".busy-indicator-wrap").remove(),c=!1)})}return e});

define('text!platform/datasheets/layout/ui/views/print-dialog-view.html',[],function () { return '<div class="datasheet-print-dialog-container">    \r\n        <div>            \r\n            <mi-radio data-bind="miRadioProperty: {checked: $root.selectedRadioButton, name: \'datasheet-print-dialog-radio1\', text: $root.translate(\'DS_DATASHEET_PRINT\'), value: 1}"></mi-radio>   \r\n        </div>\r\n        \r\n        <div>        \r\n            <mi-radio data-bind="miRadioProperty: {checked: $root.selectedRadioButton, name: \'datasheet-print-dialog-radio2\', text: $root.translate(\'DS_REPORT_PRINT\'), value: 2}"></mi-radio>\r\n        </div>\r\n\r\n        <div>\r\n            <mi-select data-bind="miproperty: {options: $root.options, optionsText: \'reportId\', value: $root.selectedOption, editable: false, disabled: $root.options().length === 0}"></mi-select>\r\n        </div>\r\n    <br/>\r\n    <div class="pull-right">\r\n        <button data-bind="click: $root.okButtonClicked, enable: $root.selectedRadioButton() === 1 || ($root.selectedRadioButton() === 2 && $root.selectedOption() && $root.selectedOption().reportId), text: $root.translate(\'DS_OK\')" class="btn btn-text"></button>\r\n        <button data-bind="click: $root.cancelButtonClicked, text: $root.translate(\'DS_CANCEL\')" class="btn btn-text"></button>\r\n    </div>\r\n</div>';});


define('text!ui/elements/radio/radio-template.html',[],function () { return '<script id="mi-radio-tmpl" type="text/html">\r\n    <div class="radio-container" tabindex="0">\r\n        <input type="radio" data-bind="checked: $root.checked,disable: $root.disable,value:$root.value, attr:{id:$data.id , name:$root.name, required:$root.required} " />\r\n        <label data-bind="attr:{for:$data.id}"></label>\r\n        <span class="radio-text" data-bind="text: $root.text, click: $data.textClick"></span>\r\n    </div>\r\n</script>';});

define('ui/elements/radio/radio-view-model',['require','lodash','jquery','text!./radio-template.html','knockout'],function(require){"use strict";var a=require("lodash"),b=require("jquery"),c=require("text!./radio-template.html"),d=require("knockout");d.bindingHandlers.miRadioProperty={createNodes:function(a,b){document.getElementById("mi-radio-tmpl")||document.body.insertAdjacentHTML("beforeend",c),d.applyBindingsToNode(a,{template:{name:"mi-radio-tmpl"}},b)},init:function(a,c){var e=c();return e.id=d.bindingHandlers.miRadioProperty.getGuid(),e.textClick=function a(c,d){if(b(d.target).parent().find('input[type="radio"]').prop("disabled"))return!1;b(d.target).parent().find("input").prop("checked",!0),b(d.target).parent().find("input").trigger("change"),"function"==typeof this.checked&&this.checked(this.value)},d.bindingHandlers.miRadioProperty.createNodes(a,e),{controlsDescendantBindings:!0}},getGuid:function a(){return this.s4()+this.s4()+"-"+this.s4()+"-"+this.s4()+"-"+this.s4()+"-"+this.s4()+this.s4()+this.s4()},s4:function a(){
for(var b="",c="abcdefghijklmnopqrstuvwxyz",d=0;d<4;d++)b+=c.charAt(Math.floor(Math.random()*c.length));return b},update:function(c,e){var f;a.each(e(),function(a,e){f=d.unwrap(a),"disable"===e?b(c).find('input[type="radio"]').prop("disabled",f):"text"===e&&b(c).find(".radio-text").html(f)})}};var e=Object.create(HTMLElement.prototype);document.registerElement("mi-radio",{prototype:e})});
define('platform/datasheets/layout/ui/print-dialog-view-model',['require','text!platform/datasheets/layout/ui/views/print-dialog-view.html','spa/ko/knockout-view-model','system/globalization/translator','system/lang/event','knockout','ui/elements/radio/radio-view-model','ui/elements/select/view-model'],function(require){"use strict";var a=require("text!platform/datasheets/layout/ui/views/print-dialog-view.html"),b=require("spa/ko/knockout-view-model"),c=require("system/globalization/translator"),d=require("system/lang/event"),e=require("knockout");require("ui/elements/radio/radio-view-model"),require("ui/elements/select/view-model");function f(){g.call(this,a),this.translator=Object.resolve(c),this.printOptionSelected=new d,this.printCancelled=new d,this.selectedRadioButton=e.observable(""),this.options=e.observableArray([]),this.selectedOption=e.observable("")}var g=Object.inherit(b,f);f.prototype.translate=function a(b){return this.translator.translate(b)},f.prototype.setReportOptions=function a(b){b&&(h(this,b),this.options(b))},f.prototype.okButtonClicked=function a(){this.printOptionSelected.raise(this.selectedRadioButton(),this.selectedOption())},f.prototype.cancelButtonClicked=function a(){this.printCancelled.raise()};function h(a,b){var c,d=!1
;for(c=0;c<b.length;c++)"true"===b[c].isDefaultReport.toString()&&(a.selectedOption(b[c]),d=!0);d||a.selectedOption({reportId:"",reportPath:""})}return f});
define('platform/datasheets/layout/ui/helpers/print-helper',['require','lodash','jquery','jquery','platform/datasheets/layout/ui/print-dialog-view-model','system/ui/dialog-view-model','system/globalization/translator','application/application-events'],function(require){"use strict";var a=require("lodash"),b=require("jquery"),c=require("jquery"),d=require("platform/datasheets/layout/ui/print-dialog-view-model"),e=require("system/ui/dialog-view-model"),f=require("system/globalization/translator"),g=require("application/application-events");function h(){this.translator=Object.resolve(f),this.appEvents=Object.resolve(g)}h.prototype.print=function a(b,c,f){if(f&&0===f.length)j(b,c);else{var g=Object.resolve(d);g.setReportOptions(f);var h=new e(g,this.translator.translate("DS_SELECT_REPORT"),{height:300,width:400});h.show(),g.printOptionSelected.add(i.bind(null,this,b,c,h)),g.printCancelled.add(l.bind(null,h))}};function i(a,b,c,d,e,f){1===e?j(b,c):2===e&&f&&f.reportPath&&k(a,f.reportPath,b.currentEntyKey()),l(d)}function j(a,b){"form"===b?m(a,"Datasheet"):"bulk"===b?n(a,"Bulk Datasheet"):"mdf"===b&&o(a,"Datasheet")}function k(a,b,c){a.appEvents.navigate.raise("ssrs/viewer/"+b+"/P0="+c,{tab:!0})}function l(a){a.closeDialog()}
function m(a,b){var c=[],d;c=p(a,c),d=q(a,c),C(a,d,b)}function n(a,b){var c={},d;c=p(a,c),d=s(a,c),C(a,d,b)}function o(a,b){var c,d={};d=p(a,d),c=t(a,d),C(a,c,b)}function p(a,c){return a.region.$element.find("input.form-control, input[type=text], input.mi-selected-value-text").each(function(){b(this).attr("value",b(this).val()),b(this).css("background-color",b(this).css("backgroundColor")+"! important")}),a.region.$element.find("mi-select").each(function(a,c,d){var e=D(),f=b(d).find("input.mi-selected-value-text");b(d).attr("data-guid",e),a[e]={className:e,value:b(f).val(),backgroundColor:b(f).css("background-color")}}.bind(null,c)),a.region.$element.find("textarea.form-control").each(function(){b(this).html(b(this).val()),b(this).css("background-color",b(this).css("backgroundColor")+"! important")}),a.region.$element.find("select").each(function(a,c,d){var e=D(),f=b(d);b(f).attr("id",e),a[e]={className:e,value:b(f).find("option:selected").text(),
backgroundColor:b(f).css("background-color")}}.bind(null,c)),b(a.region.$element.find("mi-checkbox input:checkbox:checked")).each(function(){b(this).attr("checked",!0),b(this).css("background-color",b(this).css("backgroundColor")+"! important")}),c}function q(a,d){var e=c.extend(!0,[],a.region.$element),f=b.parseHTML("<div style='margin:20px'>"+e.html()+"<div>");b(f).find("div.datasheet-nav > div.datasheet-toolbar > div.datasheet-btn-group").remove();var g=b(f).find("div.datasheet-tab-container");return b(f).find("div.tab-content > .tab-pane").prepend(function(a,b){return g.find("ul.nav-tabs > li").removeClass("active"),g.find("ul.nav-tabs > li:nth-child("+(a+1)+")").addClass("active"),"<hr>"+g.html()}),b(f).find("div.datasheet-tab-container").remove(),b(f).find("div.tab-content > .tab-pane").show(),b(f).find("mi-select").each(function(a,c,d){var e=b(d).attr("data-guid");a[e]&&(b(d).find("input.mi-selected-value-text").attr("value",a[e].value),
b(d).find("input.mi-selected-value-text").css("background-color",a[e].backgroundColor))}.bind(null,d)),r(f),f}function r(a){b(a).find(".datasheet-btn-group.site-filter-component").each(function(){var a="";a="readonly"===b(this).find("mi-site-selector").attr("readonly")?b(this).find("mi-site-selector .site-selector-root div.readonly output")[0].innerText:b(this).find("mi-site-selector .site-selector-root div.dropdown output")[0].innerText,
b(this).find("mi-site-selector .site-selector-root div.dropdown button").replaceWith("<i class='icon-location' style='margin: 1px 0px 0px -12px; font-size: 24px;color: #3e87e8;padding-top: 3px;width: 20px;float:left;'></i><label style='font-family: open_sanssemibold, Helvetica Neue, Helvetica, Arial, sans-serif;font-size: 10px;font-weight: normal;margin-top: 1px;display: inline-block;margin-left: 12px;'>Site:</label><br/><output style='display: block;padding-top: 7px;font-size: 13px;line-height: 1.667;color: #232323;margin: -10px 0 0 20px;'>"+a+"</output>")})}function s(c,d){var e=b(c.region.$element).html(),f=b.parseHTML("<div style='margin:20px'>"+e+"<div>");b(f).find(".bulk-datasheet-header-container").css("padding","10px"),b(f).find(".table-responsive").remove();var g="<div style='padding:10px;'>",h=b("div.table-responsive > table.table > thead > tr > th"),i=c.region.$element.find("div.freezed-cols-container > table.table > thead > tr > th"),j=[],k=[],l="---"
;return c.region.$element.find("div.table-responsive > table.table > tbody > tr").each(function(a,c){j[a]=b(this).find("td")}),c.region.$element.find("div.freezed-cols-container > table.table > tbody > tr").each(function(a,c){k[a]=b(this).find("td")}),g=B(i,k,l,g),a.each(h,function(b,c){if(c>=0&&"status-col"!==b.className&&"row-selector"!==b.className){var d=0===c?"border-left: 1px solid #e6e6e6;":"";g=z(g,b,c,d),a.each(j,function(a,e){a.length>=0&&"status-col"!==b.className&&"row-selector"!==b.className&&(g=A(g,l,a,e,c,d))}),g+="</div>"}}),g+="</div>",b(f).find(".bulk-datasheet-header-container").after(g),b(f).find("mi-select").each(function(a,c,d,e){var f=b(e).attr("data-guid");c[f]&&(b(e).find("input.mi-selected-value-text").attr("value",c[f].value),b(e).find("input.mi-selected-value-text").css("background-color",c[f].backgroundColor))}.bind(null,c,d)),b(f).find("select").each(function(a,c){var e=b(c).attr("id");if(d[e]){var f=b("<option>"+d[e].value+"</option>");b(c).html(f),
b(c).css("background-color",d[e].backgroundColor)}}),b(f).find(".freezed-cols-container.pull-left").remove(),x(f),v(f),w(f,"bluk"),f}function t(a,c){var d=b(a.region.$element).html(),e=b.parseHTML("<div class='master-datasheet-print-container' style='margin:20px'>"+d+"<div>");b(e).find("div.datasheet-nav > div.datasheet-toolbar > div.datasheet-btn-group").remove();var f=b(e).find("div.datasheet-tab-container");return b(e).find("div.tab-content > .tab-pane").prepend(function(a,b){return f.find("ul.nav-tabs > li").removeClass("active"),f.find("ul.nav-tabs > li:nth-child("+(a+1)+")").addClass("active"),"<hr>"+f.html()}),b(e).find("div.datasheet-tab-container").remove(),b(e).find("div.tab-content > .tab-pane").show(),e=y(e),b(e).find(".master-datasheet-tab-content .master-tab-pane, .master-datasheet-tab-content .detail-tab-pane").show(),b(e).find(".form-control, input").prop("disabled",!1),b(b(e).find("div.table-responsive")[0]).html(a.getBulkHtmlForPrinting(a)),u(e),
b(e).find("mi-select").each(function(a,c,d){var e=b(d).attr("data-guid");a[e]&&(b(d).find("input.mi-selected-value-text").attr("value",a[e].value),b(d).find("input.mi-selected-value-text").css("background-color",a[e].backgroundColor))}.bind(null,c)),r(e),b(e).find("div.freezed-cols-container").remove(),e}function u(a){for(var c=1;c<b(a).find("div.table-responsive").length;c++)b(b(a).find("div.table-responsive")[c]).remove();b(a).find(".bulk-datasheet-table-body").remove(),b(a).find(".bulk-float-table-scrollbar").remove(),b(a).find(".bulk-datasheet-disabled-overlay").remove(),b(a).find("textarea").each(function(){var a=b(this).next();b(a).hasClass("textareaIcon")&&b(a).remove()}),v(a),w(a,"mdf")}function v(a){b(a).find(".form-group.has-error").each(function(){var a=b(this).find(".icon-node-warning");b(a).hasClass("icon-node-warning")&&b(a).css({bottom:"28px",position:"relative",right:"5px","z-index":"11",float:"right"})})}function w(a,c){
b(a).find(".form-group .bulk-uom-button").each(function(){b(this).css({bottom:"mdf"===c?"-8px":"0",position:"relative"})})}function x(a){b(a).find(".icon-calendar").remove()}function y(a){return b(a).find(".mdf-tab-header").hide(),b(a).find(".master-tab-pane .master-tab-header").show(),b(a).find(".detail-tab-pane .detail-tab-header").show(),b(a).find(".master-tab-header li a").css("color","#555555 "),b(a).find(".master-tab-header li.active a").css("color","#007aff").css("border"," 2px solid #ddd"),b(a).find(".master-tab-header").css("padding","20px 0 20px 0"),b(a).find(".detail-tab-header li a").css("color","#555555 "),b(a).find(".detail-tab-header li.active a").css("color","#007aff").css("border"," 2px solid #ddd"),b(a).find(".detail-tab-header").css("padding","20px 0 20px 0"),a}function z(a,c,d,e){
return a+="<div style='display:inline-block;vertical-align:top;margin-top:20px;border-top:1px solid #444;'><div style='padding:5px;background-color:#f8f8f8;border: 0;"+e+"border-bottom: 1px solid #e6e6e6;border-right: 1px solid #e6e6e6;'>"+b(c).text()+"</div>"}function A(a,c,d,e,f,g){return c=b(d[f]).find(".site-filter-component").length>0?b(d[f]).find("mi-site-selector .site-selector-root output")[0].innerText:b(d[f]).find(".hyperlinkEllipsis").length>0?b(d[f]).find(".hyperlinkEllipsis").html():b(d[f]).find(".form-control").length>0&&!b(d[f]).find("input:password")?b(d[f]).find(".form-control").val():b(d[f]).find("mi-checkbox").length>0?b(d[f]).find("mi-checkbox").html():b(d[f]).html(),a+="<div style='padding:5px;height:75px;background-color:#fff;border: 0;"+g+"border-bottom: 1px solid #e6e6e6;border-right: 1px solid #e6e6e6 !important;'>"+c+"</div>"}function B(c,d,e,f){return a.each(c,function(c,g){if(g>=2&&(b(c).hasClass("freezed-column")||b(c).hasClass("site-selector-caption"))){
var h=2===g?"border-left: 1px solid #e6e6e6;":"";f=z(f,c,g,h),a.each(d,function(a,b){a.length>=2&&"status-col"!==c.className&&"row-selector"!==c.className&&(f=A(f,e,a,b,g,h))}),f+="</div>"}}),f}function C(c,d,e){var f=a.map(b("link"),function(a){return a.outerHTML}),g={htmlString:b(d).get(0).outerHTML,cssLinks:f};c.exportService.exportPage(g,"pdf",e)}function D(){return E()+E()+"-"+E()+"-"+E()+"-"+E()+"-"+E()+E()+E()}function E(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return h});
define('platform/datasheets/layout/ui/helpers/record-manager-helper',['require','system/lang/event'],function(require){"use strict";var a=require("system/lang/event");function b(){var b=this;b.makeRootRecordEvent=new a,b.unlinkRecordEvent=new a}return b.prototype.deallocateMem=function a(){this.makeRootRecordEvent.remove(),this.unlinkRecordEvent.remove()},b.prototype.makeRootRecord=function a(){this.makeRootRecordEvent.raise()},b.prototype.unlinkRecord=function a(){this.unlinkRecordEvent.raise()},b});

define('text!platform/datasheets/layout/ui/views/datasheet.html',[],function () { return '\r\n<div class="datasheet-layout-container">\r\n    <div>\r\n        <h2 data-bind="text: title,visible:title"></h2>\r\n\r\n        <div data-bind="if: isDatasheetRendered() && !isMasterDatasheet()" class="datasheet-nav">\r\n            <div class="datasheet-toolbar">\r\n                <div class="datasheet-selector-container block b8">\r\n                    <div class="datasheet-selector-label-container block" data-bind="visible: showDatasheetSelection">\r\n                        <div class="datasheet-lbl1"><span data-bind="text: $root.translate(\'DS_DATASHEET_ID_LABEL\')"></span>:</div>\r\n                    </div>\r\n                    <div class="datasheet-selector-select-container block" data-bind="visible: showDatasheetSelection">\r\n                        <mi-select class="datasheet-selector" data-bind="miproperty:{\r\n                            value: currentDatasheetKey,\r\n\r\n                            optionsValue:\'key\',\r\n                            optionsText:\'caption\', options: datasheetKeys}" />\r\n                    </div>\r\n                </div>\r\n                <div class="datasheet-controls-container block b4 pull-right">\r\n                    <div class="datasheet-btn-group form-ds-iconbar" data-bind="visible: !showEditButton()">\r\n                        <!-- ko if: $root.datasheetNavWidth() > 768 -->\r\n                            <button class="btn btn-icon" data-bind="visible: isRootRecordAvailable() && this.innerWidth > 1068 , click: makeRootRecord, attr: {title: $root.translate(\'RM_MAKE_ROOT_RECORD_TOOLTIP\')}"><i class="icon-open-in-new-window"></i></button>\r\n                        <!-- /ko -->                        \r\n                        <mi-associated-pages-btn familykey entitykey disabled data-bind="attr: { familykey: assocFamilykey(), entitykey: currentEntyKey(), disabled: assocDisabled() } " hideifnorecords="true"></mi-associated-pages-btn>\r\n                        <button class="btn btn-icon" data-bind="visible: isDatasheetRendered() && isSaveAvailable(), click: saveDatasheet, disable: isReadOnly, attr: {title: translate(\'DS_SAVE_TOOLTIP\')}"><i class="icon-save"></i></button>                        \r\n                    </div>\r\n                    <div class="datasheet-btn-group" data-bind="visible: showEditButton()">\r\n                        <!-- ko if: canEdit() && !isMasterDatasheet() -->\r\n                        <button class="btn btn-icon" data-bind="click : toggleEdit, attr: {title: translate(\'DS_EDIT_TOOLTIP\')}"><i class="icon-edit"></i></button>\r\n                        <!-- /ko -->\r\n                    </div>\r\n                    <!-- ko if: $root.datasheetNavWidth() > 768 -->                                      \r\n                    <!--<div class="datasheet-btn-group print-btn-group">\r\n                        <button class="btn btn-icon" data-bind="click : print, attr: {title: translate(\'PRINT\'), visible: $root.datasheetNavWidth() > 1068}"><i class="icon-printer"></i></button>\r\n                    </div>-->\r\n                    <!-- /ko -->\r\n\r\n                    <!-- ko if: isDatasheetRendered()  && !isMasterDatasheet() && isSiteFiltered()-->\r\n                    <div class="datasheet-btn-group site-filter-component">\r\n                        <mi-site-selector data-bind="value: siteKey,attr: { readonly: isSelectedSiteViewOnly },event:{\'change\': handleSiteChange}, visible: showSiteSelector"></mi-site-selector>\r\n                    </div>\r\n                    <!-- /ko -->\r\n                    <!-- ko if: isDatasheetRendered() && showStateManagement() -->\r\n                    <div class="datasheet-btn-group state-transition-component">\r\n                        <mi-state-transition hidereservedops data-bind="attr: { entitykey: currentEntyKey, disable: isStateTransitionDisabled },\r\n                                    event: {\r\n                                        beforeStateChanged: onBeforeStateChanged,\r\n                                        stateChanged: onAfterStateChanged\r\n                                    }"></mi-state-transition>\r\n                    </div>\r\n                    <!-- /ko -->\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        <div class="layout-elements-group block-group columns-10" data-bind="visible: isDatasheetRendered() && !isReadOnly(), foreach: layoutElements, css: {\'datasheet-readonly-container\': isDatasheetReadOnly}">\r\n            <div class="layout-element block"\r\n                 data-bind="visible: visible,\r\n                template: { name: viewTemplate },\r\n                css: {\r\n                    \'span-1\': location().columnSpan() == 1,\r\n                    \'span-2\': location().columnSpan() == 2,\r\n                    \'span-2-5\': location().columnSpan() == 2.5,\r\n                    \'span-3\': location().columnSpan() == 3,\r\n                    \'span-4\': location().columnSpan() == 4,\r\n                    \'span-5\': location().columnSpan() == 5,\r\n                    \'span-6\': location().columnSpan() == 6,\r\n                    \'span-7\': location().columnSpan() == 7,\r\n                    \'span-7-5\': location().columnSpan() == 7.5,\r\n                    \'span-8\': location().columnSpan() == 8,\r\n                    \'span-9\': location().columnSpan() == 9,\r\n                    \'span-10\': location().columnSpan() == 10\r\n                }">\r\n            </div>\r\n        </div>\r\n\r\n    </div>\r\n\r\n    <!--<div class="datasheet-disabled-overlay" data-bind="visible: isDatasheetReadOnly, style: { top: overlayTop, height: overlayHeight}"></div>-->\r\n\r\n    <div class="refdoc" data-bind="visible: isRefDocRendered">\r\n\r\n        <div class="ref-doc-container"></div>\r\n    </div>\r\n</div>';});


define('text!platform/datasheets/layout/ui/field-control-template-map.json',[],function () { return '{\r\n  "Textbox": "field-text-template",\r\n  "NumericTextBox": "field-text-template",\r\n  "Date": "field-date-template",\r\n  "ComboBox": "field-combo-box-template",\r\n  "MultiText": "field-multi-text-template",\r\n  "TextArea": "field-text-area-template",\r\n  "CheckBox": "field-check-box-template",\r\n  "Radio": "field-radio-template",\r\n  "Hyperlink": "field-hyperlink-template",\r\n  "Browse": "field-browse-template",\r\n  "Empty": "field-empty-template",\r\n  "Character": "field-text-template",\r\n  "Numeric": "field-text-template",\r\n  "Text": "field-text-area-template",\r\n  "Boolean": "field-check-box-template",\r\n  "Select": "field-select-template",\r\n  "MultiValue": "field-multivalue-template",\r\n  "DateAlt": "field-date-alt-template",\r\n  "MaskedTextBox": "field-masked-template",\r\n  "UOMTextbox": "field-uom-template",\r\n  "JSModule": "field-jsmodule-template"\r\n}';});


define('text!platform/datasheets/layout/ui/views/templates/layout-control-template.html',[],function () { return '<script type="text/html" id="layout-control-template">\r\n\r\n    <div class="layout-control block-group columns-10">\r\n        <div class="layout-element-caption block"\r\n             data-bind="text: caption,\r\n                    visible: captionVisible,\r\n                    attr:{\'data-visible\': captionVisible },\r\n                    popover: {\r\n                        title: $root.translate(\'DS_LAYOUT_ELEMENT_DETAILS\'),\r\n                        content: ko.toJSON($data),\r\n                        placement: \'bottom\'\r\n                    }"></div>\r\n\r\n        <!-- ko if: controlTemplate -->\r\n        <div class="layout-element-content block"\r\n             data-bind="visible: visible, attr:{\'data-controlName\':controlName},\r\n                        template: controlTemplate">\r\n        </div>\r\n        <!-- /ko -->\r\n\r\n    </div>\r\n\r\n</script>';});


define('text!platform/datasheets/layout/ui/views/templates/layout-element-template.html',[],function () { return '<script type="text/html" id="layout-element-template">\r\n\r\n    <div class="ds-group-header-enabled block"\r\n         data-bind="text: caption,\r\n                    visible: captionVisible,\r\n                    popover: {\r\n                        title: $root.translate(\'DS_LAYOUT_ELEMENT_DETAILS\'),\r\n                        content: ko.toJSON($data),\r\n                        placement: \'bottom\'\r\n                    }"></div>\r\n\r\n    <!-- ko if: controlTemplate -->\r\n    <div class="layout-element-content block"\r\n         data-bind="visible: controlName() && visible(),\r\n                    template: controlTemplate">\r\n    </div>\r\n    <!-- /ko -->\r\n\r\n    <div class="layout-element-children block-group columns-10" data-bind="foreach: Object.keys($data.mappedRows())">\r\n        <div class="contentFlow" data-bind="foreach : $parent.mappedRows()[$data]">\r\n            <div class="layout-element block"\r\n                 data-bind="visible: visible,\r\n                        template: { name: viewTemplate },\r\n                        attr:{class:viewTemplate()==\'layout-empty-space-template\'?\'layout-element block span-empty\':\'layout-element block\'},\r\n                        css:{\'span-1\': location().columnSpan() == 1,\r\n                            \'span-2\': location().columnSpan() == 2,\r\n                            \'span-2-5\': location().columnSpan() == 2.5,\r\n                            \'span-3\': location().columnSpan() == 3,\r\n                            \'span-4\': location().columnSpan() == 4,\r\n                            \'span-5\': location().columnSpan() == 5,\r\n                            \'span-6\': location().columnSpan() == 6,\r\n                            \'span-7\': location().columnSpan() == 7,\r\n                            \'span-7-5\': location().columnSpan() == 7.5,\r\n                            \'span-8\': location().columnSpan() == 8,\r\n                            \'span-9\': location().columnSpan() == 9,\r\n                            \'span-10\': location().columnSpan() == 10,\r\n                            \'span-0\':location().columnSpan() == 0,\r\n                            \'hide-field\': isHidden }">\r\n\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n</script>';});


define('text!platform/datasheets/layout/ui/views/templates/layout-empty-space-template.html',[],function () { return '<script type="text/html" id="layout-empty-space-template">\r\n    <div class="layout-empty-space" data-bind="style:{\'background-color\':(controlName() == \'0\' ? \'#eee\' : \'transparent\'),\'min-height\':\'35px\'}">\r\n        &nbsp;&nbsp;\r\n    </div>\r\n</script>';});


define('text!platform/datasheets/layout/ui/views/templates/layout-group-template.html',[],function () { return '<script type="text/html" id="layout-group-template">\r\n\r\n    <div class="layout-group">\r\n\r\n        <div class="block ds-group-header-enabled"\r\n             data-bind="text: caption,\r\n                    visible: captionVisible,\r\n                     attr:{class:headerCss},\r\n                    popover: {\r\n                        title: $root.translate(\'DS_LAYOUT_ELEMENT_DETAILS\'),\r\n                        content: ko.toJSON($data),\r\n                        placement: \'bottom\'\r\n                    }"></div>\r\n\r\n        <div class="layout-element-children block-group columns-10" data-bind="foreach: Object.keys($data.mappedRows())">\r\n            <div class="contentFlow" data-bind="foreach : $parent.mappedRows()[$data]">\r\n                <div class="layout-element block"\r\n                     data-bind="visible: visible,\r\n                            template: { name: viewTemplate },\r\n                            attr:{class:viewTemplate()==\'layout-empty-space-template\'?\'layout-element block span-empty\':\'layout-element block\'},\r\n                             css:{\'span-1\': location().columnSpan() == 1,\r\n                            \'span-2\': location().columnSpan() == 2,\r\n                            \'span-2-5\': location().columnSpan() == 2.5,\r\n                            \'span-3\': location().columnSpan() == 3,\r\n                            \'span-4\': location().columnSpan() == 4,\r\n                            \'span-5\': location().columnSpan() == 5,\r\n                            \'span-6\': location().columnSpan() == 6,\r\n                            \'span-7\': location().columnSpan() == 7,\r\n                            \'span-7-5\': location().columnSpan() == 7.5,\r\n                            \'span-8\': location().columnSpan() == 8,\r\n                            \'span-9\': location().columnSpan() == 9,\r\n                            \'span-10\': location().columnSpan() == 10,\r\n                            \'span-0\':location().columnSpan() == 0,\r\n                            \'hide-field\': isHidden }"></div>\r\n            </div>\r\n        </div>\r\n\r\n    </div>\r\n\r\n</script>';});


define('text!platform/datasheets/layout/ui/views/templates/layout-label-template.html',[],function () { return '<script type="text/html" id="layout-label-template">\r\n\r\n    <div class="layout-element-caption layout-label block"\r\n         data-bind="text: caption,\r\n                    visible: captionVisible,css:fontColorCss,\r\n                    popover: {\r\n                        title: $root.translate(\'DS_LAYOUT_ELEMENT_DETAILS\'),\r\n                        content: ko.toJSON($data),\r\n                        placement: \'bottom\' }"></div>\r\n\r\n</script>';});


define('text!platform/datasheets/layout/ui/views/templates/layout-root-template.html',[],function () { return '<script type="text/html" id="layout-root-template">\r\n\r\n    <div id="root" class="layout-element-children block-group columns-10" data-bind="foreach: Object.keys($data.mappedRows())">\r\n        <div class="contentFlow" data-bind="foreach : $parent.mappedRows()[$data]">\r\n            <div class="layout-element block"\r\n                 data-bind="visible: visible,\r\n                        template: { name: viewTemplate },\r\n                        attr:{class:viewTemplate()==\'layout-empty-space-template\'?\'layout-element block span-empty\':\'layout-element block\'},\r\n                         css:{\'span-1\': location().columnSpan() == 1,\r\n                            \'span-2\': location().columnSpan() == 2,\r\n                            \'span-2-5\': location().columnSpan() == 2.5,\r\n                            \'span-3\': location().columnSpan() == 3,\r\n                            \'span-4\': location().columnSpan() == 4,\r\n                            \'span-5\': location().columnSpan() == 5,\r\n                            \'span-6\': location().columnSpan() == 6,\r\n                            \'span-7\': location().columnSpan() == 7,\r\n                            \'span-7-5\': location().columnSpan() == 7.5,\r\n                            \'span-8\': location().columnSpan() == 8,\r\n                            \'span-9\': location().columnSpan() == 9,\r\n                            \'span-10\': location().columnSpan() == 10,\r\n                            \'span-0\':location().columnSpan() == 0,\r\n                            \'hide-field\': isHidden}"></div>\r\n        </div>\r\n    </div>\r\n\r\n</script>';});


define('text!platform/datasheets/layout/ui/views/templates/layout-tabbed-group-template.html',[],function () { return '<script type="text/html" id="layout-tabbed-group-template">\r\n\r\n    <div class="layout-tabbed-group">\r\n        <div class="datasheet-tab-container" data-bind="">\r\n            <ul class="nav nav-tabs" data-bind="foreach: children">\r\n                <li data-bind="css :{ active : $index()==0 }">\r\n                    <a data-bind="text: caption,\r\n                          attr: { \'data-target\': \'.\' + clientGuid }" data-toggle="tab" />\r\n                </li>\r\n            </ul>\r\n        </div>\r\n        <div class="tab-content" data-bind="foreach: children">\r\n\r\n            <div class="tab-pane layout-element-children block-group columns-10"\r\n                 data-bind="attr: {class : clientGuid + \' tab-pane layout-element-children block-group columns-10\'},\r\n                        foreach :Object.keys($data.mappedRows()),\r\n                        css :{ active: $index()==0 }">\r\n                <div class="contentFlow" data-bind="foreach : $parent.mappedRows()[$data]">\r\n\r\n                    <div class="layout-element block"\r\n                         data-bind="visible: visible,\r\n                                template: { name: viewTemplate },\r\n                                attr:{class:viewTemplate()==\'layout-empty-space-template\'?\'layout-element block span-empty\':\'layout-element block\'},\r\n                                 css:{\'span-1\': location().columnSpan() == 1,\r\n                                    \'span-2\': location().columnSpan() == 2,\r\n                                    \'span-2-5\': location().columnSpan() == 2.5,\r\n                                    \'span-3\': location().columnSpan() == 3,\r\n                                    \'span-4\': location().columnSpan() == 4,\r\n                                    \'span-5\': location().columnSpan() == 5,\r\n                                    \'span-6\': location().columnSpan() == 6,\r\n                                    \'span-7\': location().columnSpan() == 7,\r\n                                    \'span-7-5\': location().columnSpan() == 7.5,\r\n                                    \'span-8\': location().columnSpan() == 8,\r\n                                    \'span-9\': location().columnSpan() == 9,\r\n                                    \'span-10\': location().columnSpan() == 10,\r\n                                    \'span-0\':location().columnSpan() == 0,\r\n                                    \'hide-field\': isHidden }"></div>\r\n                </div>\r\n            </div>\r\n\r\n        </div>\r\n    </div>\r\n\r\n</script>';});


define('text!platform/datasheets/layout/ui/views/templates/layout-table-column-template.html',[],function () { return '<script type="text/html" id="layout-table-column-template">\r\n    <div class="layout-element-caption block"\r\n         data-bind="attr: {title: caption}, text: caption, \r\n                    css:\'col-\'+ ko.utils.arrayFilter($parent.children(), function(child) { return (child.type() === \'TableColumn\'); }).length"></div>\r\n</script>';});


define('text!platform/datasheets/layout/ui/views/templates/layout-table-row-template.html',[],function () { return '<script type="text/html" id="layout-table-row-template">\r\n    <div class="block-group datasheet-form-control" data-bind="foreach: children, css: {\'hide-field\': isHidden}">\r\n        <div>\r\n            <div class="layout-element block"\r\n                 data-bind="visible: visible, \r\n                                 css: {\'col-1\' : $parent.children().length == 1,\r\n                                       \'col-2\' : $parent.children().length == 2,\r\n                                       \'col-3\' : $parent.children().length == 3,\r\n                                       \'col-4\' : $parent.children().length == 4,\r\n                                       \'col-5\' : $parent.children().length == 5,\r\n                                       \'col-6\' : $parent.children().length == 6,\r\n                                       \'col-7\' : $parent.children().length == 7,\r\n                                       \'col-8\' : $parent.children().length == 8,\r\n                                       \'col-9\' : $parent.children().length == 9,\r\n                                       \'col-10\' : $parent.children().length == 10,\r\n                                       \'hide-field\': isHidden}, \r\n                                template: { name: viewTemplate }"></div>\r\n        </div>\r\n    </div>\r\n</script>';});


define('text!platform/datasheets/layout/ui/views/templates/layout-table-template.html',[],function () { return '<script type="text/html" id="layout-table-template">\r\n\r\n    <div class="layout-table">\r\n        <div>\r\n            <div>\r\n                <div class="block-group" data-bind="template: {\r\n                                   name: getChildViewTemplate,\r\n                                   foreach: ko.utils.arrayFilter(children(), function(child) { return (child.type() === \'TableColumn\'); }) }"></div>\r\n            </div>\r\n            <div data-bind="template: {\r\n                                    name: getChildViewTemplate,\r\n                                    foreach: ko.utils.arrayFilter(children(), function(child) { return (child.type() === \'TableRow\'); }) }"></div>\r\n        </div>\r\n    </div>\r\n</script>   ';});


define('text!platform/datasheets/layout/ui/views/templates/field-check-box-template.html',[],function () { return '<script type="text/html" id="field-check-box-template">\r\n    <div class="checkbox" data-bind="visible: fieldValue,\r\n                    css: { \'has-error\': fieldValue() && !fieldValue().isValid() }">\r\n        <mi-checkbox data-bind="miCheckboxProperty:{ checked: fieldValue().computedBoolVal, disable: fieldValue().disabled() || fieldValue().clientDisabled()}"> </mi-checkbox>\r\n        \r\n\r\n        <!-- ko ifnot:$root.isBulkDatasheet() -->\r\n            <span class="help-block text-danger"\r\n                  data-bind="visible: !fieldValue().isValid(), text:fieldValue().validationMessage" ></span>\r\n            <!--ko if: fieldValue().successMessage() -->\r\n            <span class="text-warning"\r\n                  data-bind="visible: fieldValue().isValid(),\r\n                                html: fieldValue().successMessage()">\r\n            </span>\r\n            <!-- /ko -->\r\n        <!-- /ko -->\r\n        <!-- ko if:$root.isBulkDatasheet -->\r\n            <i class="bulk-datasheet-error-indicator icon-node-warning" title=""\r\n               data-bind="visible: !fieldValue().isValid() ,\r\n                    click: fieldValue().showErrorMessage,\r\n                    toolTip: fieldValue().validationMessage()"></i>\r\n            <!--ko if: fieldValue().successMessage() -->\r\n            <i class="bulk-datasheet-warning-indicator icon-node-warning" title=""\r\n               data-bind="visible: fieldValue().isValid(),\r\n                    warningMsg: fieldValue().successMessage()"></i>\r\n            <!-- /ko -->\r\n        <!-- /ko -->\r\n        <!--<span class="help-block text-danger"\r\n              data-bind="visible: !fieldValue().isValid(),\r\n                             text: fieldValue().validationMessage,\r\n                             title: fieldValue().validationMessage ">,\r\n        </span>-->\r\n        <!--ko if: !$root.isBulkDatasheet() -->\r\n        <span class="help-text"\r\n              data-bind="visible: $root.helpTextModeOn() && fieldValue().isValid(), text: fieldValue().helpText">\r\n        </span>\r\n        <!-- /ko -->\r\n    </div>\r\n</script>\r\n ';});


define('text!platform/datasheets/layout/ui/views/templates/field-combo-box-template.html',[],function () { return '<script type="text/html" id="field-combo-box-template">\r\n\r\n    <div class="form-group-mi-select" data-bind="visble: fieldValue,\r\n        css: { \'has-error\': fieldValue() && !fieldValue().isValid() }">\r\n\r\n        <!-- ko if:(fieldValue().maxNumberOfValues() > 1) -->\r\n        <mi-select data-bind="miproperty:{\r\n                                   selectedOptions: fieldValue()._values,\r\n                                   options: fieldValue().picklist,\r\n                                   optionsValue:\'value\',\r\n                                   optionsText: \'displayValue\',\r\n                                   disabled: fieldValue().disabled() || fieldValue().clientDisabled(),\r\n                                    multiple: fieldValue().maxNumberOfValues() > 1\r\n                           },event:{selected:function(self, ev, values){\r\n                                fieldValue().values(values);\r\n                            }},\r\n                                   style: {\'backgroundColor\': fieldValue().backColor}"></mi-select>\r\n\r\n        <!-- /ko -->\r\n        <!-- ko ifnot:(fieldValue().maxNumberOfValues() > 1) -->\r\n        <mi-select data-bind="miproperty:{\r\n                                           value: fieldValue().picklistValue,\r\n                                           options: fieldValue().picklist,\r\n                                           optionsValue:\'value\',\r\n                                           optionsText: \'displayValue\',\r\n                                           disabled: fieldValue().disabled() || fieldValue().clientDisabled(),\r\n                                            multiple: fieldValue().maxNumberOfValues() > 1\r\n                                   },\r\n                                           style: {\'backgroundColor\': fieldValue().backColor}"></mi-select>\r\n        <!-- /ko -->\r\n        <!--ko if: !$root.isBulkDatasheet() -->\r\n        <span class="help-block text-danger"\r\n              data-bind="visible: !fieldValue().isValid(),\r\n                         text: fieldValue().validationMessage">\r\n        </span>\r\n        <span class="text-warning"\r\n              data-bind="visible: fieldValue().isValid(),\r\n                            html: fieldValue().successMessage()">\r\n        </span>\r\n        <span class="help-text"\r\n              data-bind="visible: $root.helpTextModeOn() && fieldValue().isValid, text: fieldValue().helpText">\r\n        </span>\r\n        <!-- /ko -->\r\n        <!--ko if: $root.isBulkDatasheet() -->\r\n        <i class="bulk-datasheet-error-indicator icon-node-warning" title=""\r\n           data-bind="visible: !fieldValue().isValid() ,\r\n                click: fieldValue().showErrorMessage,\r\n                toolTip: fieldValue().validationMessage()"></i>\r\n        <!--ko if: fieldValue().successMessage() -->\r\n        <i class="bulk-datasheet-warning-indicator icon-node-warning" title=""\r\n           data-bind="visible: fieldValue().isValid(),\r\n                warningMsg: fieldValue().successMessage()"></i>\r\n        <!-- /ko -->\r\n        <!-- /ko -->\r\n    </div>\r\n\r\n</script>';});


define('text!platform/datasheets/layout/ui/views/templates/field-date-template.html',[],function () { return '<script type="text/html" id="field-date-template">\r\n\r\n    <div class="form-group"\r\n         data-bind="visble: fieldValue,\r\n                    css: { \'has-error\': fieldValue() && !fieldValue().isValid() }">\r\n\r\n\r\n        <mi-date-time data-bind=" hasFocus: fieldValue().isSelected,\r\n                      attr:{\r\n                        format:fieldValue().dateFormat,\r\n                        \'pick-time\': \'true\',\r\n                        \'use-seconds\': true,\r\n                        disabled: fieldValue().disabled() || fieldValue().clientDisabled()\r\n                      },\r\n                      value:fieldValue().dateValue,\r\n                      style: {\'backgroundColor\': fieldValue().backColor},\r\n                      event: {invalid: $root.setErrorMessageForDate.bind($root, fieldValue()),\r\n                      clear:$root.clearErrorMessageForDate.bind($root,fieldValue())}"\r\n                      ></mi-date-time>\r\n\r\n        <!--ko if: !$root.isBulkDatasheet() -->\r\n        <span class="help-block text-danger"\r\n              data-bind="visible: !fieldValue().isValid(),\r\n                         html: fieldValue().validationMessage">\r\n        </span>\r\n        <span class="text-warning"\r\n              data-bind="visible: fieldValue().isValid(),\r\n                            html: fieldValue().successMessage()">\r\n        </span>\r\n        <span class="help-text"\r\n              data-bind="visible: $root.helpTextModeOn() && fieldValue().isValid(), text: fieldValue().helpText">\r\n        </span>\r\n        <!-- /ko -->\r\n        <!--ko if: $root.isBulkDatasheet() -->\r\n        <i class="bulk-datasheet-error-indicator icon-node-warning" title=""\r\n           data-bind="visible: !fieldValue().isValid() ,\r\n                click: fieldValue().showErrorMessage,\r\n                toolTip: fieldValue().validationMessage()"></i>\r\n        <!--ko if: fieldValue().successMessage() -->\r\n        <i class="bulk-datasheet-warning-indicator icon-node-warning" title=""\r\n           data-bind="visible: fieldValue().isValid(),\r\n                warningMsg: fieldValue().successMessage()"></i>\r\n        <!-- /ko -->\r\n\r\n        <!-- /ko -->\r\n    </div>\r\n\r\n</script>';});


define('text!platform/datasheets/layout/ui/views/templates/field-date-alt-template.html',[],function () { return '\r\n<script type="text/html" id="field-date-alt-template">\r\n\r\n    <div class="form-group"\r\n         data-bind="visible: fieldValue,\r\n                    css: { \'has-error\': fieldValue() && !fieldValue().isValid() },\r\n    ">\r\n      \r\n      \r\n\r\n        <input type="text"\r\n               class="form-control"\r\n               placeholder="---"\r\n               data-bind="event:{focus:$root.renderDateControl.bind($root,$root)},value:fieldValue().convertDate(),\r\n                                disable: fieldValue().disabled() || fieldValue().clientDisabled(),\r\n                                style: {\'backgroundColor\': fieldValue().backColor},\r\n                                flash: fieldValue().shouldFlash()" />\r\n\r\n\r\n        <button type="button"\r\n                data-bind=" event:{focus:$root.renderDateControl.bind($root,$root)},disable: fieldValue().disabled() || fieldValue().clientDisabled()"\r\n                class="btn btn-icon custom-form-button custom-icon-field-button" style="z-index:0;right:0;margin-top:-38px;">\r\n            <i class="icon-calendar"></i>\r\n        </button>\r\n\r\n        <i class="bulk-datasheet-error-indicator icon-node-warning" title=""\r\n           data-bind="visible: !fieldValue().isValid() ,\r\n                click: fieldValue().showErrorMessage,\r\n                toolTip: fieldValue().validationMessage()"></i>\r\n\r\n\r\n     \r\n    </div>\r\n\r\n</script>';});


define('text!platform/datasheets/layout/ui/views/templates/field-radio-template.html',[],function () { return '<script type="text/html" id="field-radio-template">\r\n\r\n    <div class="checkbox" data-bind="visible: fieldValue">\r\n        <label>\r\n            <input type="checkbox"\r\n                   data-bind="checked: fieldValue().value,\r\n                              disable: fieldValue().disabled() || fieldValue().clientDisabled()" />\r\n            <!--ko if: !$root.isBulkDatasheet() -->\r\n             <span class="help-text"\r\n                  data-bind="visible: $root.helpTextModeOn() && fieldValue().isValid(), text: fieldValue().helpText">\r\n            </span>\r\n            <!-- /ko -->\r\n        </label>\r\n    </div>\r\n\r\n</script>';});


define('text!platform/datasheets/layout/ui/views/templates/field-text-area-template.html',[],function () { return '<script type="text/html" id="field-text-area-template">\r\n                        \r\n    <div class="form-group"\r\n         data-bind="visible: fieldValue,\r\n                    css: { \'has-error\': fieldValue() && !fieldValue().isValid() }">\r\n        <!--ko if: !$root.isBulkDatasheet() -->\r\n        <textarea class="form-control" rows="2"\r\n                  data-bind="value: fieldValue().isSelected() ? fieldValue().value : fieldValue().disValue,\r\n                            event: { keyup: autoGrow},\r\n                             hasFocus: fieldValue().isSelected,\r\n                             disable: fieldValue().disabled,\r\n                             style: {\'backgroundColor\': fieldValue().backColor},\r\n                            event: {keypress: $root.bindKeypress() ? $root.onControlTouched.bind($root, fieldValue()) : null},\r\n                            attr:{class:elementCss, placeholder: $root.translate(\'DS_TEXT_AREA\'), readonly: fieldValue().clientDisabled}" />\r\n        <button class="btn btn-icon textareaIcon" tabindex="-1" data-bind="event: {click: function showTextEditor(data){ $root.showTextEditor(data, $index);}}">\r\n            <i class="icon-expand-text-area" \r\n               ></i>\r\n        </button>\r\n        <span class="help-block text-danger"\r\n              data-bind="visible: !fieldValue().isValid(),\r\n                         html: fieldValue().validationMessage">\r\n        </span>\r\n        <span class="text-warning"\r\n              data-bind="visible: fieldValue().isValid(),\r\n                            html: fieldValue().successMessage()">\r\n        </span>\r\n        <span class="help-text"\r\n              data-bind="visible: $root.helpTextModeOn() && fieldValue().isValid(), text: fieldValue().helpText">\r\n        </span>\r\n        <!--/ko-->\r\n\r\n        <!--ko if: $root.isBulkDatasheet() -->\r\n        <textarea class="form-control"\r\n                  placeholder="---"\r\n                  data-bind="text: fieldValue().displayValue,\r\n                            value: fieldValue().isSelected() ? fieldValue().value : fieldValue().displayValue,\r\n                            hasFocus: fieldValue().isSelected,\r\n                            disable: fieldValue().disabled,\r\n                            style: {\'backgroundColor\': fieldValue().backColor}, attr: {readonly: fieldValue().clientDisabled}" />\r\n        <button class="btn btn-icon textareaIcon" tabindex="-1"  data-bind="event: {click: function showTextEditor(data){ $root.showTextEditor(data, $index, $parentContext.$index);}}">\r\n            <i class="icon-expand-text-area"></i>\r\n        </button>\r\n        <i class="bulk-datasheet-error-indicator icon-node-warning" title=""\r\n           data-bind="visible: !fieldValue().isValid() ,\r\n                click: fieldValue().showErrorMessage,\r\n                toolTip: fieldValue().validationMessage()"></i>\r\n        <!--ko if: fieldValue().successMessage() -->\r\n        <i class="bulk-datasheet-warning-indicator icon-node-warning" title=""\r\n           data-bind="visible: fieldValue().isValid(),\r\n                warningMsg: fieldValue().successMessage()"></i>\r\n        <!-- /ko -->\r\n        <!--/ko-->\r\n\r\n\r\n    </div>\r\n\r\n</script>';});


define('text!platform/datasheets/layout/ui/views/templates/field-hyperlink-template.html',[],function () { return '<script type="text/html" id="field-hyperlink-template">\r\n\r\n    <div class="form-group"\r\n         data-bind="visble: fieldValue,\r\n                    css: { \'has-error\': fieldValue() && !fieldValue().isValid() }">\r\n        <!--<div class="form-control hyperlinkEllipsis" data-bind="html: fieldValue().displayValue,attr:{title:fieldValue().innerText()}"></div>-->\r\n                                     \r\n        <!--ko if: !$root.isBulkDatasheet() -->\r\n        <!--ko if: fieldValue().jsModuleName() && fieldValue().jsModuleName().length -->\r\n        <!--ko if: (/<a href=.*<\\/a>/.test(fieldValue().displayValue())) -->\r\n        <div class="form-control" data-bind="html:fieldValue().isSelected() ? fieldValue().value : fieldValue().disValue,disable: fieldValue().disabled() || fieldValue().clientDisabled(),\r\n                                        style: {\'backgroundColor\': fieldValue().backColor},\r\n                                        attr:{class:elementCss() + \' hyperlinkEllipsis\'},\r\n                event:{focus: function bulk_datasheet_view_model_callOnFocus(data){  $root.callOnFocus(fieldValue().key(), fieldValue().entityKey(), fieldValue().clientid(), fieldValue().jsModuleName(), fieldValue().jsModuleParams(), fieldValue().popJSModuleOnFocus()); }}"></div>\r\n        <button type="button"\r\n                placeholder="..."\r\n                data-bind="click: function datasheet_view_model_showJSModule(data){$root.showJSModule(fieldValue().key(), fieldValue().jsModuleName(), fieldValue().jsModuleParams(), $data, $index, $parentContext.$index, fieldValue().jsModuleUseApply);}"\r\n                class="btn btn-icon custom-form-button custom-icon-field-button custom-hyperlink-js-module-button">\r\n            <i class="icon-more"></i>\r\n        </button>\r\n        <!-- /ko -->\r\n        <!--ko ifnot: (/<a href=.*<\\/a>/.test(fieldValue().displayValue())) -->\r\n        <input type="text"\r\n               placeholder="..."\r\n               class="form-control custom-form-text"\r\n               data-bind="hasFocus: fieldValue().isSelected,\r\n                                      value: fieldValue().isSelected() ? fieldValue().jsModuleValue : fieldValue().disValue,\r\n                                        disable: fieldValue().disabled,\r\n                                        style: {\'backgroundColor\': fieldValue().backColor},\r\n                                        attr:{class:elementCss, readonly:fieldValue().clientDisabled},\r\n                event:{focus: function bulk_datasheet_view_model_callOnFocus(data){  $root.callOnFocus(fieldValue().key(), fieldValue().entityKey(), fieldValue().clientid(), fieldValue().jsModuleName(), fieldValue().jsModuleParams(), fieldValue().popJSModuleOnFocus()); }}\r\n                ">\r\n        <button type="button"\r\n                placeholder="..."\r\n                data-bind="click: function datasheet_view_model_showJSModule(data){$root.showJSModule(fieldValue().key(), fieldValue().jsModuleName(), fieldValue().jsModuleParams(), $data, $index, $parentContext.$index, fieldValue().jsModuleUseApply);}"\r\n                class="btn btn-icon custom-form-button custom-icon-field-button">\r\n            <i class="icon-more"></i>\r\n        </button>\r\n        <!-- /ko -->\r\n        <!-- /ko -->\r\n        <!--ko ifnot: fieldValue().jsModuleName() && fieldValue().jsModuleName().length -->\r\n        <div class="form-control hyperlinkEllipsis" data-bind="html: fieldValue().displayValue,attr:{title:fieldValue().innerText()}"></div>\r\n        <!--/ko-->\r\n       \r\n        <span class="help-block text-danger"\r\n              data-bind="visible: !fieldValue().isValid(),\r\n                                     html: fieldValue().validationMessage">\r\n        </span>\r\n        <!--ko if: fieldValue().successMessage() -->\r\n        <span class="text-warning"\r\n              data-bind="visible: fieldValue().isValid(),\r\n                            html: fieldValue().successMessage()">\r\n        </span>\r\n        <!-- /ko -->\r\n\r\n        <span class="help-text"\r\n              data-bind="visible: $root.helpTextModeOn() && fieldValue().isValid(), text: fieldValue().helpText">\r\n        </span>\r\n        <!-- /ko -->\r\n\r\n        <!--ko if: $root.isBulkDatasheet()-->\r\n        <div class="form-control hyperlinkEllipsis" data-bind="html: fieldValue().displayValue,attr:{title:fieldValue().innerText()}"></div>-->\r\n        <!--ko if: fieldValue().jsModuleName() && fieldValue().jsModuleName().length -->\r\n        <input type="button"\r\n               class="btn btn-icon custom-bulk-ds-button"\r\n               placeholder="..."\r\n               data-bind="value: \'...\',\r\n                            click: function bulk_datasheet_view_model_showJSModule(data){ $root.showJSModule(fieldValue().key(), fieldValue().entityKey(), fieldValue().clientid(), fieldValue().jsModuleName(), fieldValue().jsModuleParams(), $data, $index, $parentContext.$index);}">\r\n        <!-- /ko -->\r\n            <i class="bulk-datasheet-error-indicator icon-node-warning" title=""\r\n               data-bind="visible: !fieldValue().isValid() ,\r\n                    click: fieldValue().showErrorMessage,\r\n                    toolTip: fieldValue().validationMessage()"></i>\r\n            <!--ko if: fieldValue().successMessage() -->\r\n            <i class="bulk-datasheet-warning-indicator icon-node-warning" title=""\r\n               data-bind="visible: fieldValue().isValid(),\r\n                    warningMsg: fieldValue().successMessage()"></i>\r\n            <!-- /ko -->\r\n        <!-- /ko -->\r\n\r\n    </div>\r\n\r\n</script> ';});


define('text!platform/datasheets/layout/ui/views/templates/field-text-template.html',[],function () { return '<script type="text/html" id="field-text-template">\r\n\r\n    <div class="form-group"\r\n         data-bind="visible: fieldValue,\r\n                    css: { \'has-error\': fieldValue() && !fieldValue().isValid() }">\r\n        <!--ko if: !$root.isBulkDatasheet() -->\r\n        <!--ko if: fieldValue() && !fieldValue().jsModuleName()-->\r\n        <input type="text"\r\n               data-bind="hasFocus: fieldValue().isSelected,\r\n                              value: fieldValue().isSelected() ? fieldValue().value : fieldValue().disValue,\r\n                                disable: fieldValue().disabled, \r\n                                event: {keypress: $root.bindKeypress() ? $root.onControlTouched.bind($root, fieldValue()) : null},\r\n                                style: {\'backgroundColor\': fieldValue().backColor},\r\n                                attr:{class:elementCss, placeholder: fieldValue().placeHolder, maxLength: fieldValue().dbLength, readonly:fieldValue().clientDisabled}" class="form-control">\r\n\r\n        <span class="help-block text-danger"\r\n              data-bind="visible: !fieldValue().isValid(),\r\n                            html: fieldValue().validationMessage">\r\n        </span>\r\n        <span class="text-warning"\r\n              data-bind="visible: fieldValue().isValid(),\r\n                            html: fieldValue().successMessage()">\r\n        </span>\r\n        <span class="help-text"\r\n              data-bind="visible: $root.helpTextModeOn() && fieldValue().isValid(), text: fieldValue().helpText">\r\n        </span>\r\n        <!-- /ko -->\r\n        <!--ko if: fieldValue().jsModuleName() && fieldValue().jsModuleName().length -->\r\n        <!--ko if: (/<a href=.*<\\/a>/.test(fieldValue().displayValue())) -->\r\n        <div class="form-control" data-bind="html:fieldValue().isSelected() ? fieldValue().value : fieldValue().disValue,disable: fieldValue().disabled() || fieldValue().clientDisabled(),\r\n                                        style: {\'backgroundColor\': fieldValue().backColor},\r\n                                        attr:{class:elementCss() + \' hyperlinkEllipsis\'},\r\n                event:{focus: function bulk_datasheet_view_model_callOnFocus(data){  $root.callOnFocus(fieldValue().key(), fieldValue().entityKey(), fieldValue().clientid(), fieldValue().jsModuleName(), fieldValue().jsModuleParams(), fieldValue().popJSModuleOnFocus()); }}"></div>\r\n        <button type="button"\r\n                placeholder="..."\r\n                data-bind="click: function datasheet_view_model_showJSModule(data){$root.showJSModule(fieldValue().key(), fieldValue().jsModuleName(), fieldValue().jsModuleParams(), $data, $index, $parentContext.$index, fieldValue().jsModuleUseApply);}"\r\n                class="btn btn-icon custom-form-button custom-icon-field-button custom-hyperlink-js-module-button">\r\n            <i class="icon-more"></i>\r\n        </button>\r\n        <!-- /ko -->\r\n        <!--ko ifnot: (/<a href=.*<\\/a>/.test(fieldValue().displayValue())) -->\r\n        <input type="text"\r\n               placeholder="..."\r\n               class="form-control custom-form-text"\r\n               data-bind="hasFocus: fieldValue().isSelected,\r\n                                      value: fieldValue().isSelected() ? fieldValue().jsModuleValue : fieldValue().disValue,\r\n                                        disable: fieldValue().disabled,\r\n                                        style: {\'backgroundColor\': fieldValue().backColor},\r\n                                        attr:{class:elementCss, readonly:fieldValue().clientDisabled},\r\n                event:{focus: function bulk_datasheet_view_model_callOnFocus(data){  $root.callOnFocus(fieldValue().key(), fieldValue().entityKey(), fieldValue().clientid(), fieldValue().jsModuleName(), fieldValue().jsModuleParams(), fieldValue().popJSModuleOnFocus()); }}\r\n                ">\r\n        <button type="button"\r\n                placeholder="..."\r\n                data-bind="click: function datasheet_view_model_showJSModule(data){$root.showJSModule(fieldValue().key(), fieldValue().jsModuleName(), fieldValue().jsModuleParams(), $data, $index, $parentContext.$index, fieldValue().jsModuleUseApply);}"\r\n                class="btn btn-icon custom-form-button custom-icon-field-button">\r\n            <i class="icon-more"></i>\r\n        </button>\r\n        <!-- /ko -->\r\n\r\n        <span class="help-block text-danger"\r\n              data-bind="visible: !fieldValue().isValid(),\r\n                                     html: fieldValue().validationMessage">\r\n        </span>\r\n        <span class="text-warning"\r\n              data-bind="visible: fieldValue().isValid(),\r\n                            html: fieldValue().successMessage()">\r\n        </span>\r\n        <!-- /ko -->\r\n        <!-- /ko -->\r\n        <!--ko if: $root.isBulkDatasheet() -->\r\n        <!--ko if: !fieldValue().jsModuleName() -->\r\n        <input type="text"\r\n               class="form-control"\r\n               placeholder="---"\r\n               data-bind="hasFocus: fieldValue().isSelected,\r\n                              value: fieldValue().isSelected() ? fieldValue().value : fieldValue().disValue,\r\n                                disable: fieldValue().disabled,\r\n                                style: {\'backgroundColor\': fieldValue().backColor},\r\n                                flash: fieldValue().shouldFlash(), attr: { title: fieldValue().disValue, maxLength: fieldValue().dbLength , readonly:fieldValue().clientDisabled}" />\r\n        <!-- /ko -->\r\n        <!--ko if: fieldValue().jsModuleName() && fieldValue().jsModuleName().length -->\r\n        <input type="text"\r\n               style="margin-right: 26px;"\r\n               class="form-control custom-form-text"\r\n               placeholder="..."\r\n               data-bind="hasFocus: fieldValue().isSelected,\r\n                                  value: fieldValue().isSelected() ? fieldValue().jsModuleValue : fieldValue().disValue,\r\n                                    disable: fieldValue().disabled() || fieldValue().clientDisabled(),\r\n                                    style: {\'backgroundColor\': fieldValue().backColor},\r\n                                    flash: fieldValue().shouldFlash(),\r\n    event: {focus: function bulk_datasheet_view_model_showJSModule(data){ $root.callOnFocus(fieldValue(), $data, $index, $parentContext.$index);}}\r\n                                    ">\r\n        <input type="button"\r\n               class="btn btn-icon custom-bulk-ds-button"\r\n               placeholder="..."\r\n               data-bind="value: \'...\',\r\n                            click: function bulk_datasheet_view_model_showJSModule(data){ $root.showJSModule(fieldValue().key(), fieldValue().entityKey(), fieldValue().clientid(), fieldValue().jsModuleName(), fieldValue().jsModuleParams(), $data, $index, $parentContext.$index, fieldValue().jsModuleUseApply);}">\r\n        <!-- /ko -->\r\n\r\n\r\n        <i class="bulk-datasheet-error-indicator icon-node-warning" title=""\r\n           data-bind="visible: !fieldValue().isValid() ,\r\n                click: fieldValue().showErrorMessage,\r\n                toolTip: fieldValue().validationMessage()"></i>\r\n        <!--ko if: fieldValue().successMessage() -->\r\n        <i class="bulk-datasheet-warning-indicator icon-node-warning" title=""\r\n            data-bind="visible: fieldValue().isValid(),\r\n                warningMsg: fieldValue().successMessage()"></i>\r\n        <!-- /ko -->\r\n        <!-- /ko -->\r\n    </div>\r\n\r\n</script>';});


define('text!platform/datasheets/layout/ui/views/templates/field-select-template.html',[],function () { return '<script type="text/html" id="field-select-template">\r\n\r\n    <div class="form-group-select">\r\n        <select class="form-control" data-bind="value: fieldValue().picklistValue,\r\n                                           options: fieldValue().picklist,\r\n                                           optionsValue:\'value\',\r\n                                           optionsText: \'displayValue\',\r\n                                           disable: fieldValue().disabled() || fieldValue().clientDisabled(),\r\n                                           visible:fieldValue(),\r\n                                           style: {\'backgroundColor\': fieldValue().backColor}"></select>\r\n        <!--ko if: $root.isBulkDatasheet() -->\r\n            <i class="bulk-datasheet-error-indicator icon-node-warning" title=""\r\n               data-bind="visible: !fieldValue().isValid() ,\r\n                    click: fieldValue().showErrorMessage,\r\n                    toolTip: fieldValue().validationMessage()"></i>\r\n            <!--ko if: fieldValue().successMessage() -->\r\n            <i class="bulk-datasheet-warning-indicator icon-node-warning" title=""\r\n               data-bind="visible: fieldValue().isValid(),\r\n                    warningMsg: fieldValue().successMessage()"></i>\r\n            <!-- /ko -->\r\n        <!-- /ko -->\r\n    </div>\r\n</script>';});


define('text!platform/datasheets/layout/ui/views/templates/field-multivalue-template.html',[],function () { return '<script type="text/html" id="field-multivalue-template">\r\n\r\n    <div data-bind="visble: fieldValue,\r\n        css: { \'has-error\': fieldValue() && !fieldValue().isValid() }">\r\n\r\n\r\n\r\n        <!-- ko if:(fieldValue().maxNumberOfValues() > 1) -->\r\n\r\n        <mi-multi-value data-bind="miproperty:{\r\n                                        selectedOptions: fieldValue().values,\r\n                                       options: fieldValue().picklist,\r\n                                       optionsValue: \'value\',\r\n                                       optionsText:  \'displayValue\',\r\n                                       disabled: fieldValue().disabled() || fieldValue().clientDisabled(),\r\n                                       multiple: fieldValue().maxNumberOfValues() > 1\r\n                                       },\r\n                                       style: {\'backgroundColor\': fieldValue().backColor}"></mi-multi-value>\r\n\r\n        <!-- /ko -->\r\n        <!-- ko ifnot:(fieldValue().maxNumberOfValues() > 1) -->\r\n\r\n        <mi-multi-value data-bind="miproperty:{\r\n                                       value: fieldValue().picklistValue,\r\n                                       options: fieldValue().picklist,\r\n                                       optionsValue: \'value\',\r\n                                       optionsText:  \'displayValue\',\r\n                                       disabled: fieldValue().disabled() || fieldValue().clientDisabled(),\r\n                                       multiple: fieldValue().maxNumberOfValues() > 1\r\n                                       },\r\n                                       style: {\'backgroundColor\': fieldValue().backColor}"></mi-multi-value>\r\n\r\n        <!-- /ko -->\r\n        \r\n        <!--ko if: !$root.isBulkDatasheet() -->\r\n        <span class="help-block text-danger"\r\n              data-bind="visible: !fieldValue().isValid(),\r\n                         text: fieldValue().validationMessage">\r\n        </span>\r\n        <!--ko if: fieldValue().successMessage() -->\r\n        <span class="text-warning"\r\n              data-bind="visible: fieldValue().isValid(),\r\n                            html: fieldValue().successMessage()">\r\n        </span>\r\n        <!-- /ko -->\r\n        <span class="help-text"\r\n              data-bind="visible: $root.helpTextModeOn() && fieldValue().isValid, text: fieldValue().helpText">\r\n        </span>\r\n        <!-- /ko -->\r\n        <!--ko if: $root.isBulkDatasheet() -->\r\n        <i class="bulk-datasheet-error-indicator icon-node-warning" title=""\r\n           data-bind="visible: !fieldValue().isValid() ,\r\n                click: fieldValue().showErrorMessage,\r\n                toolTip: fieldValue().validationMessage()"></i>\r\n        <!--ko if: fieldValue().successMessage() -->\r\n        <i class="bulk-datasheet-warning-indicator icon-node-warning" title=""\r\n           data-bind="visible: fieldValue().isValid(),\r\n                    warningMsg: fieldValue().successMessage()"></i>\r\n        <!-- /ko -->\r\n        <!-- /ko -->\r\n    </div>\r\n\r\n</script>';});


define('text!platform/datasheets/layout/ui/views/templates/field-empty-template.html',[],function () { return '<script type="text/html" id="field-empty-template">\r\n\r\n    <div class="form-group disabled" data-bind="style:{\'background-color\':\'#eee\',\'min-height\':\'25px\'}">\r\n\r\n    </div>\r\n\r\n</script>';});


define('text!platform/datasheets/layout/ui/views/templates/field-browse-template.html',[],function () { return '<script type="text/html" id="field-browse-template"> \r\n    <div data-bind="visble: fieldValue">\r\n        <form enctype="multipart/form-data" class="refdoc-form" method="post">\r\n            <div class="block-group">\r\n                <input class="block form-control" name="file" type="text" data-bind="value: fieldValue().value" style="width: 90%;">\r\n\r\n                <label for="file-browse" class="btn btn-primary" style="padding: 4px 12px;">...</label>\r\n                <input id="file-browse" class="block browse-control" readonly name="file" type="file" data-bind="value: fieldValue().browsevalue" style="display: none;">\r\n\r\n            </div>\r\n        </form>\r\n    </div>\r\n</script>\r\n';});


define('text!platform/datasheets/layout/ui/views/templates/field-multi-text-template.html',[],function () { return '<script type="text/html" id="field-multi-text-template">\r\n\r\n    <div data-bind="visble: fieldValue,\r\n        css: { \'has-error\': fieldValue() && !fieldValue().isValid() }">\r\n\r\n        <mi-text-ext data-bind="miproperty:{\r\n                           value: fieldValue().value,\r\n                           options: fieldValue().values,\r\n                           disable: fieldValue().disabled() || fieldValue().clientDisabled(),\r\n                           },\r\n                           style: {\'backgroundColor\': fieldValue().backColor}"></mi-text-ext>\r\n\r\n\r\n        <!--ko if: !$root.isBulkDatasheet() -->\r\n        <span class="help-block text-danger"\r\n              data-bind="visible: !fieldValue().isValid(),\r\n                         html: fieldValue().validationMessage">\r\n        </span>\r\n        <span class="text-warning"\r\n              data-bind="visible: fieldValue().isValid(),\r\n                            html: fieldValue().successMessage()">\r\n        </span>\r\n        <!-- /ko -->\r\n        <!--ko if: $root.isBulkDatasheet() -->\r\n            <i class="bulk-datasheet-error-indicator icon-node-warning" title=""\r\n               data-bind="visible: !fieldValue().isValid() ,\r\n                    click: fieldValue().showErrorMessage,\r\n                    toolTip: fieldValue().validationMessage()"></i>\r\n            <!--ko if: fieldValue().successMessage() -->\r\n            <i class="bulk-datasheet-warning-indicator icon-node-warning" title=""\r\n               data-bind="visible: fieldValue().isValid(),\r\n                    warningMsg: fieldValue().successMessage()"></i>\r\n            <!-- /ko -->\r\n\r\n        <!-- /ko -->\r\n    </div>\r\n\r\n</script>';});


define('text!platform/datasheets/layout/ui/views/templates/field-masked-template.html',[],function () { return '<script type="text/html" id="field-masked-template">\r\n    <div class="form-group" data-bind="visible: fieldValue,\r\n                                       css: { \'has-error\': fieldValue() && !fieldValue().isValid() }">\r\n               \r\n        <!--ko if: !$root.isBulkDatasheet() -->\r\n        <input type="password" data-bind="hasFocus: fieldValue().isSelected,\r\n                                          value: fieldValue().isSelected() ? fieldValue().value : fieldValue().disValue,\r\n                                          style: {\'backgroundColor\': fieldValue().backColor},\r\n                                          attr:{class: elementCss, placeholder: $root.translate(\'DS_MASKED_INPUT\'),\r\n                                                maxLength: fieldValue().dbLength}" class="form-control" />\r\n        <span class="help-block text-danger"\r\n              data-bind="visible: !fieldValue().isValid(),\r\n                            html: fieldValue().validationMessage">\r\n        </span>\r\n        <!--ko if: fieldValue().successMessage() -->\r\n        <span class="text-warning"\r\n              data-bind="visible: fieldValue().isValid(),\r\n                            html: fieldValue().successMessage()">\r\n        </span>\r\n        <!-- /ko -->\r\n        <span class="help-text"\r\n              data-bind="visible: $root.helpTextModeOn() && fieldValue().isValid(), text: fieldValue().helpText">\r\n        </span>\r\n        <!-- /ko -->\r\n\r\n        <!--ko if: $root.isBulkDatasheet() -->\r\n        <input type="password" data-bind="hasFocus: fieldValue().isSelected,\r\n                                          value: fieldValue().isSelected() ? fieldValue().value : fieldValue().disValue,\r\n                                          style: {\'backgroundColor\': fieldValue().backColor},\r\n                                          attr:{maxLength: fieldValue().dbLength}" class="form-control" placeholder="---" />\r\n        <i class="bulk-datasheet-error-indicator icon-node-warning" title=""\r\n           data-bind="visible: !fieldValue().isValid() ,\r\n                click: fieldValue().showErrorMessage,\r\n                toolTip: fieldValue().validationMessage()"></i>\r\n        <!--ko if: fieldValue().successMessage() -->\r\n        <i class="bulk-datasheet-warning-indicator icon-node-warning" title=""\r\n           data-bind="visible: fieldValue().isValid(),\r\n                warningMsg: fieldValue().successMessage()"></i>\r\n        <!-- /ko -->\r\n        <!-- /ko -->\r\n    </div>\r\n</script>';});


define('text!platform/datasheets/layout/ui/views/templates/field-uom-template.html',[],function () { return '<script type="text/html" id="field-uom-template">\r\n\r\n    <div class="form-group"\r\n         data-bind="visible: fieldValue,\r\n                    css: { \'has-error\': fieldValue() && !fieldValue().isValid() }">\r\n        <!--ko if: !$root.isBulkDatasheet() -->\r\n        <!--ko if: fieldValue()-->\r\n        <input type="text"\r\n               data-bind="hasFocus: fieldValue().isSelected,\r\n                              value: fieldValue().isSelected() ? fieldValue().value : fieldValue().disValue,\r\n                                disable: fieldValue().disabled,\r\n                                event: {keypress: $root.bindKeypress() ? $root.onControlTouched.bind($root, fieldValue()) : null},\r\n                                style: {\'backgroundColor\': fieldValue().backColor},\r\n                                attr:{class:elementCss, placeholder: fieldValue().placeHolder, maxLength: fieldValue().dbLength,\r\n                                readonly:fieldValue().clientDisabled}" class="form-control" />\r\n\r\n        <button type="button"\r\n                placeholder="..."\r\n                data-bind="click: $root.showUOMConversionTool.bind(null, $root),\r\n                 disable: !fieldValue().value() || fieldValue().disabled"\r\n                class="btn btn-icon custom-form-button custom-icon-field-button">\r\n            <i class="icon-uom"></i>\r\n        </button>\r\n\r\n        <span class="help-block text-danger"\r\n              data-bind="visible: !fieldValue().isValid(),\r\n                            html: fieldValue().validationMessage">\r\n        </span>\r\n        <span class="text-warning"\r\n              data-bind="visible: fieldValue().isValid(),\r\n                            html: fieldValue().successMessage()">\r\n        </span>\r\n        <span class="help-text"\r\n              data-bind="visible: $root.helpTextModeOn() && fieldValue().isValid(), text: fieldValue().helpText">\r\n        </span>\r\n        <!-- /ko -->\r\n        <!-- /ko -->\r\n\r\n        <!--ko if: $root.isBulkDatasheet() -->\r\n        <input type="text"\r\n               class="form-control"\r\n               placeholder="---"\r\n               data-bind="hasFocus: fieldValue().isSelected,\r\n                              value: fieldValue().isSelected() ? fieldValue().value : fieldValue().disValue,\r\n                                disable: fieldValue().disabled,\r\n                                style: {\'backgroundColor\': fieldValue().backColor},\r\n                                flash: fieldValue().shouldFlash(), attr: { maxLength: fieldValue().dbLength , readonly:fieldValue().clientDisabled}" />\r\n        <button type="button"\r\n                placeholder="..."\r\n                data-bind="click: $root.showUOMConversionTool.bind(null, $root),\r\n                 disable: !fieldValue().value() || fieldValue().disabled"\r\n                class="btn btn-icon custom-form-button custom-icon-field-button bulk-uom-button">\r\n            <i class="icon-uom"></i>\r\n        </button>\r\n        <i class="bulk-datasheet-error-indicator icon-node-warning" title=""\r\n           data-bind="visible: !fieldValue().isValid() ,\r\n                click: fieldValue().showErrorMessage,\r\n                toolTip: fieldValue().validationMessage()"></i>\r\n        <!--ko if: fieldValue().successMessage() -->\r\n        <i class="bulk-datasheet-warning-indicator icon-node-warning" title=""\r\n           data-bind="visible: fieldValue().isValid(),\r\n                warningMsg: fieldValue().successMessage()"></i>\r\n        <!-- /ko -->\r\n        <!-- /ko -->\r\n    </div>\r\n\r\n</script>';});

define('platform/metadata/models/unit-of-measure',['require'],function(require){"use strict";function a(a){this.caption=a.caption,this.category=a.category,this.description=a.description,this.id=a.id,this.key=a.key}return a});
define('platform/metadata/models/field-metadata',['require','platform/metadata/models/unit-of-measure'],function(require){"use strict";var a=require("platform/metadata/models/unit-of-measure");function b(a){a=a||{},this.caption=a.caption,this.defaultCaption=a.description,this.description=a.description,this.helpText=a.helpText,this.id=a.id,this.isActive=a.isActive,this.isBaselineField=a.isBaselineField,this.isCalculated=a.isCalculated,this.isCaptionField=a.isCaptionField,this.isHtmlField=a.isHtmlField,this.isIdField=a.isIdField,this.isRuleLock=a.isRuleLock,this.isSearchable=a.isSearchable,this.isStateManagementField=a.isStateManagementField,this.isSystemfield=a.isSystemfield,this.isUtcField=a.isUtcField,this.keepHistory=a.keepHistory,this.key=a.key,this.length=a.length,this.maxNumberOfValues=a.maxNumberOfValues,this.overridesParentAttributes=a.overridesParentAttributes,this.physicalAttributesKey=a.physicalAttributesKey,this.physicalColumnName=a.physicalColumnName,this.sequenceNumber=a.sequenceNumber,this.spreadToAllChildren=a.spreadToAllChildren,
this.unitOfMeasureKey=a.unitOfMeasureKey,this.validationText=a.validationText,this.dataType=a.dataType,this.stateFieldType=a.stateFieldType,this.baseFamilyKey=a.baseFamilyKey,this.familyKey=a.familyKey,this.parentFieldKey=a.parentFieldKey,this.customizationFieldKey=a.customizationFieldKey,this.behaviors=a.behaviors}return b});
define('platform/metadata/models/family-metadata',['require','lodash','system/text/parser','platform/metadata/models/field-metadata'],function(require){"use strict";var a=require("lodash"),b=require("system/text/parser"),c=require("platform/metadata/models/field-metadata"),d=1,e=2,f=4,g=8;function h(h){h=h||{},this.caption=h.caption,this.databaseTableName=h.databaseTableName,this.databaseViewName=h.databaseViewName,this.defaultCaption=h.defaultCaption,this.description=h.description,this.id=h.id,this.isBaselineFamily=h.isBaselineFamily,this.isRuleLock=h.isRuleLock,this.key=h.key,this.updateDate=b.parseDate(h.updateDate),this.updateUser=h.updateUser,this.status=h.status,this.securityPrivileges=h.securityPrivileges,this.fields=a.map(h.fields,function(a){return new c(a)}),this.predecessors=h.predecessors,this.successors=h.successors,this.relationships=h.relationships,this.canDelete=(this.securityPrivileges&g)===g,this.canInsert=(this.securityPrivileges&d)===d,this.canUpdate=(this.securityPrivileges&f)===f,this.canView=(this.securityPrivileges&e)===e}return h});
define('platform/metadata/services/metadata',['require','lodash','jquery','system/lang/object','system/http/ajax-client','platform/metadata/models/family-metadata'],function(require){"use strict";var a=require("lodash"),b=require("jquery");require("system/lang/object");var c=require("system/http/ajax-client"),d="api/core/metadata",e=require("platform/metadata/models/family-metadata");function f(a){this.ajaxClient=a}return f.dependsOn=[c],f.prototype.getEntityFamilies=function(){var c=b.Deferred();return this.ajaxClient.get(d+"/entityfamilies").done(function(b){c.resolve(a.map(b,function(a){return new e(a)}))}).fail(function(a){c.reject(a)}),c.promise()},f.prototype.getEntityFamilyByKey=function(a){var c=b.Deferred();return this.ajaxClient.get(d+"/entityfamily/"+a).done(function(a){c.resolve(new e(a))}).fail(function(a){c.reject(a)}),c.promise()},f.prototype.getEntityFamilyByid=function(a){var c=b.Deferred();return this.ajaxClient.get(d+"/entityfamily?id="+a).done(function(a){c.resolve(new e(a))}).fail(function(a){c.reject(a)}),c.promise()},f.prototype.getRelationshipFamilies=function(){var c=b.Deferred()
;return this.ajaxClient.get(d+"/relationshipfamilies").done(function(b){c.resolve(a.map(b,function(a){return new e(a)}))}).fail(function(a){c.reject(a)}),c.promise()},f.prototype.getRelationshipFamilyByKey=function(a){var c=b.Deferred();return this.ajaxClient.get(d+"/relationshipfamily/"+a).done(function(a){c.resolve(a?new e(a):null)}).fail(function(a){c.reject(a)}),c.promise()},f.prototype.getRelationshipFamilyById=function(a){var c=b.Deferred();return this.ajaxClient.get(d+"/relationshipfamily?id="+a).done(function(a){c.resolve(a?new e(a):null)}).fail(function(a){c.reject(a)}),c.promise()},f.prototype.getEntityFields=function(a,c){return b.Deferred().resolve("").promise()},f.prototype.retrieveFamilyReports=function a(c){var e=b.Deferred();return this.ajaxClient.get(d+"/entityfamily/"+c+"/familyreports").done(function(a){e.resolve(a)}).fail(function(a){e.reject([])}),e.promise()},f.singleton=!0,Object.resolve(f)});

define('text!platform/datasheets/layout/ui/views/uom-conversion-view.html',[],function () { return '<div class="uom-conversion-container">\r\n    <div class="uomView">\r\n        <div style="text-align: center;">\r\n            <span data-bind="text: errorMsg, visible: errorMsg" class="text-danger"></span>\r\n        </div>\r\n        <div class="row">\r\n            <div class="left-column">\r\n                <span data-bind="text:translator.translate(\'ORGINAL_VAL\')"></span>\r\n                <input type="text" class="field-text form-control"\r\n                        data-bind="value: originalUOMValue" readonly="readonly" />\r\n            </div>\r\n            <div class="right-column">\r\n                <mi-checkbox data-bind="miCheckboxProperty:{\r\n                             checked:replaceNewValue,\r\n                             disable:!valueUpdated(),\r\n                             text:translator.translate(\'REPLACE_EXT_VAL\')\r\n                           }">\r\n                </mi-checkbox>\r\n            </div>\r\n        </div>\r\n        <div class="row">\r\n            <div class="left-column">\r\n                <span data-bind="text:translator.translate(\'CONVERTED_VAL\')"></span>\r\n                <input type="text" class="field-text form-control" data-bind="value: convertedValue" \r\n                       id="convertedValue" />\r\n            </div>\r\n            <div class="right-column">\r\n                <mi-select data-bind="miproperty:{\r\n                                   options: uomlist,\r\n                                   optionsText: \'caption\',\r\n                                   optionsValue: \'key\',\r\n                                   value: selectedUom\r\n                               }, event:{\r\n                                    valueChange: covertToNewUOM\r\n                           }">\r\n                </mi-select>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div class="controls">\r\n        <button type="button" class="btn btn-text" data-bind="click: cancel.bind($root),\r\n                text:translator.translate(\'CANCEL\')"></button>\r\n        <button type="button" class="btn btn-text" data-bind="click: setValueToDataSheet.bind($root),\r\n                text:translator.translate(\'DONE\'), disable: !allowReplace() || !replaceNewValue()"></button>\r\n    </div>\r\n</div>';});

define('platform/datasheets/layout/model/uom-conversion-model',['require','jquery','lodash','knockout','spa/ko/knockout-view-model','system/ui/dialog-view-model','text!../../layout/ui/views/uom-conversion-view.html','system/globalization/translator','../services/datasheet-service','system/text/parser','ui/elements/select/view-model','ui/elements/checkbox/checkbox-view-model'],function(require){"use strict";var a=require("jquery"),b=require("lodash"),c=require("knockout"),d=require("spa/ko/knockout-view-model"),e=require("system/ui/dialog-view-model"),f=require("text!../../layout/ui/views/uom-conversion-view.html"),g=require("system/globalization/translator"),h=require("../services/datasheet-service"),i=require("system/text/parser");require("ui/elements/select/view-model"),require("ui/elements/checkbox/checkbox-view-model");function j(a,b){var d=this;k.call(this,f),d.translator=a,d.dialog=null,d.service=b,d.uomConversionSet=[],d.uomlist=c.observableArray(),d.selectedUom=c.observable(),d.replaceNewValue=c.observable(!1),d.valueUpdated=c.observable(!1),d.allowReplace=c.observable(!1),d.originalUOMValue=c.observable(),d.convertedValue=c.observable(),d.errorMsg=c.observable(),d.uomKey=null,d.uomDesc=null,d.originalValue=null}j.dependsOn=[g,h];var k=Object.inherit(d,j);j.prototype.attach=function a(b){var c=this;k.prototype.attach.call(this,b),c.region=b,
n(c)},j.prototype.show=function a(b){var c=this;c.loadData(b).done(function(){c.dialog=new e(c,c.translator.translate("UOM_CONVERTER_TOOL"),{width:"35%",closeIcon:!0}),c.dialog.show()})},j.prototype.loadData=function b(c){var d=this,e=a.Deferred();return d.uomKey=c.fieldValue().uomKey(),m(d,c),d.service.getUomCoversion(d.uomKey).then(l.bind(null,d,e)).done(function(a){d.uomlist(a),e.resolve(a)}),e.promise()},j.prototype.cancel=function a(){this.dialog.closeDialog()},j.prototype.covertToNewUOM=function a(c,d,e){if(e===c.uomKey)c.convertedValue(c.originalValue);else{var f=b.find(c.uomConversionSet,{toUomKey:e}),g=p(c.convertedValue(),f);c.convertedValue(g)}},j.prototype.setValueToDataSheet=function a(){var b=this;b.layoutViewModel.fieldValue().value(b.originalValue.toString()),b.dialog.closeDialog()};function l(a,b,c){for(var d=[a.uomKey],e=0;e<c.length;e++)d.push(c[e].toUomKey);return a.uomConversionSet=c,a.service.getUoms(d)}function m(a,b){a.uomDesc=b.fieldValue().uom(),
a.originalValue=b.fieldValue().value(),a.originalUOMValue(a.originalValue+" ("+a.uomDesc+")"),a.convertedValue(b.fieldValue().value()),a.selectedUom(a.uomKey),a.layoutViewModel=b}function n(b){a(b.region.$element).find("#convertedValue").on("change",o.bind(null,b))}function o(b,c){var d=c.target.value;if(q(b,d))return void a(c.target).addClass("has-error");var e=b.selectedUom();b.uomKey!==e?b.service.getUomCoversionByKey(e,b.uomKey).done(function(a){var c=p(d,a);b.originalValue=c,b.originalUOMValue(b.originalValue+" ("+b.uomDesc+")")}):(b.originalValue=d,b.originalUOMValue(b.originalValue+" ("+b.uomDesc+")")),b.valueUpdated(!0),b.replaceNewValue(!0)}function p(a,b){return(i.parseFloat(a)+b.base)*(b.numerator/b.denominator)+b.offset}function q(b,c){return!c||(i.parseFloat(c)?(b.allowReplace(!0),b.errorMsg(""),void a(b.region.$element).find("#convertedValue").removeClass("has-error")):(b.errorMsg(b.translator.translate("QUERY_INVALID_NUMBER")),b.allowReplace(!1),!0))}return j});
define('platform/entity/services/dto/entity-field-dto',['require','jquery','system/lang/converter'],function(require){"use strict";var a=require("jquery"),b=require("system/lang/converter");function c(c){var e=this;if(c=c||{},e.key=b.toString(c.key),e.id=b.toString(c.id),e.caption=b.toString(c.caption),e.defaultCaption=b.toString(c.defaultCaption),e.changing=b.toBoolean(c.changing),e.dataType=b.toString(c.dataType),e.errorMessage=b.toString(c.errorMessage),e.isActive=b.toBoolean(c.isActive),e.dbLength=b.toString(c.dbLength),e.dbValue=b.toString(c.dbValue),e.dependentFields=b.toObject(c.dependentFields,[]),e.displayValue=b.toString(c.displayValue),e.defaultValue="Boolean"===e.dataType?b.toBoolean(b.toString(c.defaultValue).toLowerCase(),"true"):b.toString(c.defaultValue),e.fieldHistoryKeys=b.toObject(c.fieldHistoryKeys,[]),e.isDisabled=b.toBoolean(c.isDisabled),e.isRequired=b.toBoolean(c.isRequired),e.isHidden=b.toBoolean(c.isHidden),e.isHtmlField=b.toBoolean(c.isHtmlField),e.format=b.toString(c.format),e.maxNumberOfValues=b.toString(c.maxNumberOfValues),
e.originalValue=b.toString(c.originalValue),void 0!==c.pickList&&(e.pickList=b.toObject(c.pickList,void 0),e.isPicklistRestricted=b.toBoolean(c.isPicklistRestricted)),e.previousValues=b.toObject(c.previousValues,void 0),e.previousValue=b.toString(c.previousValue),e.unitOfMeasure=b.toString(c.unitOfMeasure),e.unitOfMeasureKey=b.toString(c.unitOfMeasureKey),e.backColor=b.toString(c.backColor),e.jsModuleName="",e.jsModuleParams="",e.popJSModuleOnFocus="",e.addParseValueParam="",void 0!==c.jsModule&&""!==c.jsModule)e.jsModuleName=a.parseJSON(c.jsModule).jsmodule,e.jsModuleParams=a.parseJSON(c.jsModule).params,e.jsModuleUseApply=a.parseJSON(c.jsModule).useApply,e.popJSModuleOnFocus=b.toBoolean(a.parseJSON(c.jsModule).popJSModuleOnFocus,"true"),e.addParseValueParam=b.toBoolean(a.parseJSON(c.jsModule).addParseValueParam,"true");else if(c.jsModuleName){var f={};f.jsmodule=c.jsModuleName,f.params=c.jsModuleParams,f.popJSModuleOnFocus=c.popJSModuleOnFocus,
f.addParseValueParam=c.addParseValueParam,e.jsModule=JSON.stringify(f)}e.value="Boolean"===e.dataType?b.toBoolean(b.toString(c.value).toLowerCase(),"true"):b.toString(c.value),e.values="Boolean"===e.dataType?[b.toBoolean(b.toString(c.values).toLowerCase(),"true")]:d(b.toObject(c.values)),e.error=b.toString(c.error),e.helpText=b.toString(c.helpText),e.successMessage=b.toString(c.successMessage)}function d(a){for(var b=[],c=0;a&&c<a.length;c++)null!==a[c]&&b.push(a[c]);return b}return c.fromDataCollection=function a(b){var d,e=[];if(b.length>0&&void 0!==b[0])for(d=0;d<b.length;d++)e.push(new c(b[d]));else for(d=0;d<b.length;d++)e.push(new c(b.models[d]));return e},c});
define('platform/entity/services/dto/rel-entity-dto',['require','system/lang/converter'],function(require){"use strict";var a=require("system/lang/converter");function b(b){var c=this;b=b||{},c.familyKey=a.toString(b.familyKey),c.parentKey=a.toString(b.parentKey),c.relationshipFamilyKey=a.toString(b.relationshipFamilyKey),c.isSucc=a.toBoolean(b.isSucc)}return b});
define('platform/entity/services/dto/entity-dto',['require','./entity-field-dto','./rel-entity-dto','system/lang/converter'],function(require){"use strict";var a=require("./entity-field-dto"),b=require("./rel-entity-dto"),c=require("system/lang/converter");function d(d){var e=this;d=d||{},e.caption=c.toString(d.caption),e.defaultCaption=c.toString(d.defaultCaption),e.contentGuid=c.toString(d.contentGuid),e.errorMessage=c.toString(d.errorMessage),e.familyID=c.toString(d.familyID),e.familyCaption=c.toString(d.familyCaption),e.familyKey=c.toInteger(d.familyKey),e.fields=void 0===d.fields?[]:a.fromDataCollection(d.fields),e.id=c.toString(d.id),e.isEditable=c.toBoolean(d.isEditable),e.isNew=c.toBoolean(d.isNew),e.key=c.toInteger(d.key),e.updateDate=c.toDate(d.updateDate),e.updateUser=c.toInteger(d.updateUser),e.isHistoryEnabled=c.toBoolean(d.isHistoryEnabled),e.isSiteFiltered=c.toBoolean(d.isSiteFiltered),e.siteKey=c.toString(d.siteKey),e.showStateManagement=c.toBoolean(d.showStateManagement),e.isStateManagementActive=c.toBoolean(d.isStateManagementActive),
e.useUrlRedirection=c.toBoolean(d.useUrlRedirection),e.redirectionUrl=c.toString(d.redirectionUrl),e.activeState=c.toString(d.activeState),e.isDirty=c.toBoolean(d.isDirty),e.isAuditable=c.toBoolean(d.isAuditable),e.createdDate=c.toDate(d.createdDate),e.createdBy=c.toInteger(d.createdBy),e.lockSeqNbr=c.toInteger(d.lockSeqNbr),void 0!==d.relEnty&&(e.relEnty=new b(d.relEnty))}return d.fromDataCollection=function a(b){if(void 0!==b){var c,e=[];for(c=0;c<b.length;c++)e[e.length]=new d(b[c]);return e}},d});
define('platform/entity/services/dto/field-history-dto',['require','system/lang/converter'],function(require){"use strict";var a=require("system/lang/converter");function b(b){var c=this;b=b||{},c.fieldCaption=a.toString(b.fieldCaption),c.formattedNewValue=a.toString(b.formattedNewValue),c.formattedOldValue=a.toString(b.formattedOldValue),c.newValue=a.toString(b.newValue),c.oldValue=a.toString(b.oldValue),c.updateUser=a.toString(b.updateUser),c.updateDate=a.toString(b.updateDate)}return b.fromDataCollection=function a(c){var d,e=[];for(d=0;d<c.length;d++)e[e.length]=new b(c[d]);return e},b});
define('platform/entity/services/entity-service',['require','jquery','system/lang/object','./dto/entity-dto','./dto/field-history-dto','system/http/ajax-client'],function(require){"use strict";var a=require("jquery");require("system/lang/object");var b="api/core/entity/",c="api/core/relationship/",d="api/core/metadata/entityfamily/",e=require("./dto/entity-dto"),f=require("./dto/field-history-dto"),g=require("system/http/ajax-client");function h(a){this.ajaxClient=a,this.isForDCM=!1}h.dependsOn=[g],h.prototype.setupForDCM=function(){this.isForDCM=!0},h.prototype.newEntity=function(c){var d=b+"new/"+c,f=a.Deferred();return this.ajaxClient.get(d,{}).done(function(a){f.resolve(new e(a))}).fail(function(a){f.reject(a)}),f.promise()},h.prototype.getEntity=function(c){var d=b+c,f=a.Deferred();return this.ajaxClient.get(d,{}).done(function(a){f.resolve(new e(a))}).fail(function(a){f.reject(a.statusText,a)}),f.promise()},h.prototype.getSiteKey=function(c){var d=b+"sitekey/"+c,e=a.Deferred();return this.ajaxClient.get(d,{}).done(function(a){e.resolve(a)}).fail(function(a){e.reject(a.statusText,a)}),e.promise()},
h.prototype.getEntities=function(c){var d=b+"getBulkEntities?",f=a.Deferred(),g=0,h=[];for(g=0;g<c.length;g++)d=d+"key="+c[g],g!==c.length-1&&(d+="&");return this.ajaxClient.get(d).done(function(a){for(var b=0;b<a.length;b++)h.push(new e(a[b]));f.resolve(h),f.resolve(a)}).fail(function(a){f.reject(a.statusText,a)}),f.promise()},h.prototype.getEntityByFamilyKey=function(b){var c=this,f=d+b;c.isForDCM&&(f+="?isFromDCM=true");var g=a.Deferred();return this.ajaxClient.get(f,{}).done(function(a){g.resolve(new e(a))}).fail(function(a){g.reject(a.statusText,a)}),g.promise()},h.prototype.getAggregateEntities=function(c){var d=b+"aggregate/query",f=a.Deferred(),g=0,h=[];return this.ajaxClient.post(d,JSON.stringify(c)).done(function(a){for(var b=0;b<a.length;b++){for(var c=[],d=0;d<a[b].length;d++)c.push(new e(a[b][d]));h.push(c)}f.resolve(h)}).fail(function(){f.reject()}),f.promise()},h.prototype.getAggregateEntitiesForCompositeObj=function(c){var d=b+"aggregate/object",f=a.Deferred(),g=0,h=[]
;return this.ajaxClient.post(d,JSON.stringify(c)).done(function(a){if(a){for(var b=0;b<a.length;b++){for(var c=[],d=0;d<a[b].length;d++)c.push(new e(a[b][d]));h.push(c)}f.resolve(h)}}).fail(function(){f.reject()}),f.promise()},h.prototype.saveEntity=function(c){var d=b,f=a.Deferred();return this.ajaxClient.post(d,c).done(function(a){f.resolve(new e(a))}).fail(function(a){f.reject(a)}),f.promise()},h.prototype.saveEntities=function(c){var d=b+"Save",f=a.Deferred();return this.ajaxClient.post(d,c).done(function(a){for(var b=[],c=0;c<a.length;c++)b.push(new e(a[c]));f.resolve(b)}).fail(function(a){f.reject(a)}),f.promise()},h.prototype.saveAndLinkEntities=function(c,d,f){var g=b+"MDF/"+d+"/"+f,h=a.Deferred();return this.ajaxClient.post(g,c).done(function(a){for(var b=[],c=0;c<a.length;c++)b.push(new e(a[c]));h.resolve(b)}).fail(function(){h.reject()}),h.promise()},h.prototype.updateEntity=function(c){var d=b,f=a.Deferred();return this.ajaxClient.put(d,c).done(function(a){
f.resolve(new e(a))}).fail(function(a){f.reject(a)}),f.promise()},h.prototype.deleteEntity=function(c){var d=b+c.key,e=a.Deferred();return this.ajaxClient.delete(d,{}).done(function(a){null!==a&&""!==a&&""!==a.errorMessage?e.reject(a.errorMessage):e.resolve({status:"deleted"})}).fail(function(a){e.reject(a)}),e.promise()},h.prototype.deleteEntities=function(c){var d=b+"deleteEntities?",e=a.Deferred(),f=0;for(f=0;f<c.length;f++)d=d+"key="+c[f],f!==c.length-1&&(d+="&");return this.ajaxClient.delete(d,{}).done(function(a){e.resolve(a)}).fail(function(a){e.reject(a)}),e.promise()},h.prototype.deleteRelationships=function(b,d,e){var f=c+b+"/"+d+"?",g=a.Deferred(),h=0;for(h=0;h<e.length;h++)f=f+"succEntityKey="+e[h],h!==e.length-1&&(f+="&");return this.ajaxClient.delete(f,{}).done(function(a){g.resolve(a)}).fail(function(a){g.reject(a)}),g.promise()},h.prototype.updateFields=function(c){var d=b+"updatefields",f=a.Deferred();return this.ajaxClient.put(d,c).done(function(a){f.resolve(new e(a))
}).fail(function(a){f.reject(a)}),f.promise()},h.prototype.copyEntity=function(c){var d=b+"copy/"+c.key,f=a.Deferred();return this.ajaxClient.get(d,{}).done(function(a){f.resolve(new e(a))}).fail(function(){f.reject()}),f.promise()},h.prototype.getHistory=function(c){var d=b+"history/"+c.key,e=a.Deferred();return this.ajaxClient.get(d,{}).done(function(a){e.resolve(f.fromDataCollection(a))}).fail(function(){e.reject()}),e.promise()},h.prototype.getReferences=function(c){var d=b+"refdoc/"+c.key,e=a.Deferred();return this.ajaxClient.get(d,{}).done(function(a){e.resolve(a)}).fail(function(){e.reject()}),e.promise()},h.prototype.canRefDoc=function(c){var d=b+"canrefdoc/"+c,e=a.Deferred(),f;return f=this.ajaxClient.get(d).done(function(a){e.resolve(a)}).fail(function(a){e.reject(a.statusText,a)}),g.promise(e,f)},h.prototype.getRefDocCount=function(c){var d=b+"refdoccount/"+c,e=a.Deferred(),f;return f=this.ajaxClient.get(d).done(function(a){e.resolve(a)}).fail(function(a){
e.reject(a.statusText,a)}),g.promise(e,f)},h.prototype.getRelatedEntities=function(c,d,e){var f=b+"MDF/"+c+"/"+d+"/"+e,g=a.Deferred();return this.ajaxClient.get(f,{}).done(function(a){g.resolve(a)}).fail(function(){g.reject()}),g.promise()},h.prototype.getRelatedEntityKeys=function(c,d,e){var f=b+"MDFKeys/"+c+"/"+d+"/"+e,g=a.Deferred();return this.ajaxClient.get(f,{}).done(function(a){g.resolve(a)}).fail(function(){g.reject()}),g.promise()},h.prototype.refDocServerCredentialsExist=function b(){var c=a.Deferred();return this.ajaxClient.get("api/refdoc-server/config").done(i.bind(null,c)).fail(j.bind(null,c)),c.promise()},h.prototype.getBulkEntitiesByQuery=function(c){var d=b+"bulk/query",f=a.Deferred(),g=0,h=[];return this.ajaxClient.post(d,JSON.stringify(c)).done(function(a){for(var b=[],c=0;c<a.length;c++)b.push(new e(a[c]));f.resolve(b)}).fail(function(){f.reject()}),f.promise()};function i(a,b){var c=!1;""!==b.userName&&""!==b.userPassword&&(c=!0),a.resolve(c)}function j(a,b){
a.reject(b)}return h});
define('platform/entity/model/entity-field-model',['require','lodash','backbone'],function(require){"use strict";var a=require("lodash"),b=require("backbone"),c;return c=b.Model.extend({initialize:function(){this.on("change:value",function(b,c){b.set("previousValue",b.previous("value"),{silent:!0}),b.set("changing",!0,{silent:!0});var d=b.get("pickList");if(void 0!==d&&d.length>0){var e=a.find(d,function(a){return a.isSelected===!0});e&&(e.isSelected=!1);var f=a.find(d,function(a){return a.value===c});f&&(f.isSelected=!0)}}).on("change:values",function(a,b){a.get("errorMessage")||a.set("previousValues",a.previous("values")?a.previous("values"):a.get("previousValues"),{silent:!0}),a.set("changing",!0,{silent:!0})})}})});
define('platform/entity/model/entity-field-collection',['require','backbone','./entity-field-model'],function(require){"use strict";var a=require("backbone"),b=require("./entity-field-model"),c;return c=a.Collection.extend({model:b})});
define('platform/entity/entity',['require','lodash','jquery','./model/entity-field-collection','./services/entity-service','./services/dto/entity-dto','./services/dto/entity-field-dto','system/lang/event','system/http/ajax-client','system/globalization/translator'],function(require){"use strict";var a=require("lodash"),b=require("jquery"),c=require("./model/entity-field-collection"),d=require("./services/entity-service"),e=require("./services/dto/entity-dto"),f=require("./services/dto/entity-field-dto"),g=require("system/lang/event"),h=require("system/http/ajax-client"),i=require("system/globalization/translator");function j(a){var e=this,f,j;j=Object.resolve(h),e._service=new d(j),b.extend(e,a),f=new c(e.fields),f.on("change",this._fieldChanged,e),e.entitySaved=new g,e.entityModified=new g,e.conflictedEvent=new g,e.fields=f,e.entityDeleted=new g,e.updateReqCount=0,e.isEntityDirty=!1,e.saveQueue=0,e.translator=Object.resolve(i),e.saveDfd=null,e.entityChangedEvent=new g,e.entityIdChanged=new g,e.updatedFromModule=null}return j.prototype.save=function a(c,d,e){var f=this,g;return g=e?e:b.Deferred(),0===f.updateReqCount&&0===f.saveQueue?(f.saveQueue++,0!==f.key?f._service.updateEntity(f._convertToServiceDTO()).done(function(a){f.saveQueue--,
f.isEntityDirty=!1,f._updateSelf(a),f.entitySaved&&f.entitySaved.raise(a,c,d),g.resolve(f)}).fail(function(a){f.saveQueue--,g.reject(a)}):f._service.saveEntity(f._convertToServiceDTO()).done(function(a){f.saveQueue--,f.isEntityDirty=!1,f._updateSelf(a),f.entitySaved&&f.entitySaved.raise(a,c,d),g.resolve(f)}).fail(function(a){f.saveQueue--,g.reject(a)})):(f.saveDfd=g,f.saveQueue++),g},j.prototype.translate=function a(b){return this.translator.translate(b)},j.prototype.delete=function(a){var c=b.Deferred(),d=this;if(0!==d.updateReqCount)throw d.translate("DS_CANNOT_DELETE_ENTITY_EXCEPTION");return 0!==d.key&&d._service.deleteEntity(a._convertToServiceDTO()).done(function(b){d.entityDeleted&&d.entityDeleted.raise(a),c.resolve(b)}).fail(function(a){c.reject(a)}),c},j.prototype.getHistory=function a(){var c=this,d=b.Deferred();return c._service.getHistory(c._convertToServiceDTO()).done(function(a){d.resolve(a)}),d},j.prototype.getReferences=function a(){var c=this,d=b.Deferred()
;return c._service.getReferences(c._convertToServiceDTO()).done(function(a){d.resolve(a)}),d},j.prototype.updateFieldsExternal=function b(c){var d=this;c.familyKey===d.familyKey&&a.each(data.fields,function(a){var b=d.fields.find(function(b){return b.id===a.id});b.set("value",a.value,{silent:!0}),d.entityModified&&d.entityModified.raise(d,b.toJSON(),d.id)})},j.prototype._convertToServiceDTO=function a(){var b=this,c,d;return c=f.fromDataCollection(b.fields.toJSON()),d=new e(b),d.fields=c,d.siteKey||delete d.siteKey,d},j.prototype._updateSelf=function b(c){var d=this;for(var e in c)"fields"!==e&&void 0!==d[e]&&(d[e]=c[e]);c.fields&&c.fields.length>0&&d.fields.each(function(b){var d=a.find(c.fields,function(a){return a.id===b.get("id")});d&&b.set(d,{silent:!0})})},j.prototype._fieldChanged=function b(){var c=this;c.updateReqCount++,c.isEntityDirty=!0,c._service.updateFields(c._convertToServiceDTO()).done(function(b){c.id!==b.id&&(c.id=b.id,c.entityIdChanged&&c.entityIdChanged.raise(c)),
c.isDirty=b.isDirty,c.updateReqCount--,a.each(b.fields,function(a){if(a.changing){var d=c.fields.find(function(b){return b.id===a.id});a.changing=!1,d.get("changing")&&c.conflictedEvent.raise(d),a.isDirty=!1,d.set(a,{silent:!0}),c.entityModified?c.entityModified.raise(c,d.toJSON(),b.id,!1,c._convertToServiceDTO().lockSeqNbr,b):c.entityChangedEvent&&c.entityChangedEvent.raise(c,d.toJSON(),b.id)}}),c.saveQueue>0&&(c.saveQueue=0,c.save(null,null,c.saveDfd))}).fail(function(){c.updateReqCount--,c.saveQueue>0&&(c.saveQueue=0,c.save())})},j.prototype.updateField=function b(c,d,e,f){var g=this,h=a.find(g.fields.models,function(a){return a.get("id").toString()===c.toString()});if(window.field=h,void 0===h)throw c+" "+g.translate("DS_NOT_VALID_ID_EXCEPTION");if(void 0===h.get(d))throw d+" "+g.translate("DS_NOT_VALID_FIELD_EXCEPTION");h.set(d,e),g.entityModified&&g.entityModified.raise(g,h.toJSON(),!1,!0,null,null,f)},j.prototype.checkIfDirty=function a(){return this.isEntityDirty},
j.prototype.checkIfEntityDirty=function c(){var d=b.Deferred(),e=this;return a.delay(function(){e.updateReqCount>0?d.reject():e.isDirty&&!e.updatedFromModule?d.reject():d.resolve()},100),d},j});
define('platform/entity/entity-factory',['require','lodash','jquery','./services/entity-service','./services/dto/entity-dto','./services/dto/entity-field-dto','system/lang/event','./entity','system/http/ajax-client','system/globalization/translator'],function(require){"use strict";var a=require("lodash"),b=require("jquery"),c=require("./services/entity-service"),d=require("./services/dto/entity-dto"),e=require("./services/dto/entity-field-dto"),f=require("system/lang/event"),g=require("./entity"),h="entity-clipboard",i=require("system/http/ajax-client"),j=require("system/globalization/translator");function k(){var a=this;a.ajaxClient=Object.resolve(i),a.service=new c(a.ajaxClient),a.createdEvent=new f,a.copiedEvent=new f,a.pastedEvent=new f,a.bulkDeleteEvent=new f,a.bulkUnlinkEvent=new f,a.updateEntitiesEvent=new f,a.translator=Object.resolve(j)}k.prototype.new=function a(c){var d=b.Deferred(),e=l(c),f=this;return"key"===e?f.service.newEntity(c).done(function(a){d.resolve(new g(a))}).fail(function(a){d.reject(a)}):d.resolve(c),d.promise()},k.prototype.getEntityByFamilyKey=function a(c){var d=b.Deferred();return this.service.getEntityByFamilyKey(c).done(function(a){d.resolve(new g(a))}).fail(function(a){d.reject(a)}),
d.promise()},k.prototype.translate=function a(b){return this.translator.translate(b)},k.prototype.get=function a(c){var d=b.Deferred(),e=l(c),f=this;return"key"===e?f.service.getEntity(c).done(function(a){d.resolve(new g(a))}).fail(function(a,b){d.reject(a,b)}):"keys"===e?f.service.getEntities(c).done(function(a){var b,c=[];for(b=0;b<a.length;b++)c.push(new g(a[b]));d.resolve(c)}).fail(function(a,b){d.reject(b,a)}):"objects"===e?f.createNewEntitiesFromJSON(c).done(function(a){d.resolve(a)}).fail(function(a){d.reject(a)}):f.createNewEntityFromJSON(c).done(function(a){d.resolve(a)}),d},k.prototype.getSiteKey=function a(c){var d=b.Deferred();return this.service.getSiteKey(c).done(function(a){d.resolve(a)}).fail(function(a,b){d.reject(a,b)}),d},k.prototype.getAggregatedEntities=function a(c){var d=b.Deferred();return this.service.getAggregateEntities(c).done(function(a){var b,c=[];for(b=0;b<a.length;b++){for(var e=[],f=0;f<a[b].length;f++)e.push(new g(a[b][f]));c.push(e)}d.resolve(c)
}).fail(function(a){d.reject(a)}),d},k.prototype.getAggregateEntitiesForCompositeObj=function a(c){var d=b.Deferred();return this.service.getAggregateEntitiesForCompositeObj(c).done(function(a){var b,c=[];for(b=0;b<a.length;b++){for(var e=[],f=0;f<a[b].length;f++)e.push(new g(a[b][f]));c.push(e)}d.resolve(c)}).fail(function(a){d.reject(a)}),d},k.prototype.createNewEntityFromJSON=function a(c){var e=b.Deferred();return e.resolve(new g(new d(c))),e.promise()},k.prototype.createNewEntitiesFromJSON=function a(c){var e=b.Deferred(),f,h=[];for(f=0;f<c.length;f++)h.push(new g(new d(c[f])));return e.resolve(h),e.promise()},k.prototype.save=function a(c,d,e){var f=this,g=l(c),h=b.Deferred();if("objects"===g){var i=f._convertToServiceDTOs(c);f.service.saveEntities(i,d).done(function(a){for(var b=0;b<c.length;b++)c[b]._updateSelf(a[b]),""===c[b].errorMessage&&(c[b].clientid=void 0);h.resolve(c)}).fail(function(a){h.reject(a)})}else"bulk"===g?c.length>0?c.save(d,e).done(function(a){h.resolve(a)
}).fail(function(a){h.reject(a)}):h.reject():c.save(d,e).done(function(a){h.resolve(a)}).fail(function(a){h.reject(a)});return h},k.prototype.saveAndLinkEntities=function a(c,d,e){var f=this,g=b.Deferred(),h;return h=f._convertToServiceDTOs(c),f.service.saveAndLinkEntities(h,d,e).done(function(a){for(var b=0;b<c.length;b++)c[b]._updateSelf(a[b]),""===c[b].errorMessage&&(c[b].clientid=void 0);g.resolve(c)}).fail(function(a){g.reject(a)}),g},k.prototype._convertToServiceDTOs=function a(b){for(var c=[],f=0;f<b.length;f++){var g=e.fromDataCollection(b[f].fields.toJSON()),h=new d(b[f]);h.fields=g,c.push(h)}return c},k.prototype.copyFrom=function a(c){var d=this,e=b.Deferred();return d.service.copyEntity(c._convertToServiceDTO()).done(function(a){window.sessionStorage.setItem(h,JSON.stringify(a)),e.resolve({status:"copied"})}),e},k.prototype.canPaste=function a(b){var c=!1,d;return d=window.sessionStorage.getItem(h)?JSON.parse(window.sessionStorage.getItem(h)):null,
d&&d.familyKey&&d.familyKey===b&&(c=!0),c},k.prototype.pasteTo=function a(b){var c=this,d;if(!(d=window.sessionStorage.getItem(h)?JSON.parse(window.sessionStorage.getItem(h)):null)||!c.canPaste(b.familyKey))throw c.translate("DS_UNABLE_TO_PASTE_EXCEPTION");b.updateFieldsExternal(d)},k.prototype.delete=function a(c){var d=this,e=b.Deferred(),f;return f=l(c),"keys"===f?d.service.deleteEntities(c).done(function(a){d.bulkDeleteEvent.raise(c,a),e.resolve(a)}).fail(function(a){e.reject(a)}):c.delete(c).done(function(a){e.resolve(a)}).fail(function(a){e.reject(a)}),e},k.prototype.deleteRelationships=function a(c,d,e){var f=this,g=b.Deferred(),h,i=!1;return f.service.deleteRelationships(c,d,e).done(function(a){for(var b=0;b<a.length;b++)if(""!==a[b].errorMessage){i=!0,h=a[b].errorMessage;break}i||f.bulkUnlinkEvent.raise(e,a),g.resolve(a)}).fail(function(a){g.reject(a)}),g},k.prototype.updateEntitySite=function a(b){b.isDirty=!0,b._fieldChanged()},k.prototype.updateFieldValue=function b(c,d,e){
var f=!1,g=a.find(c.fields.models,function(a){return a.get("key").toString()===d.toString()});g.set("value",e);var h=g.toJSON();c.entityModified&&c.entityModified.raise(c,h,!1,!0,null,null,f)},k.prototype.updateFieldByKey=function b(c,d,e,f){var g=a.find(c.fields.models,function(a){return a.get("key").toString()===d.toString()});g.trigger("change:"+f,g),g.set(f,e,{silent:!0}),g.trigger("change"),c.entityModified&&c.entityModified.raise(c,g.toJSON())},k.prototype.updateField=function a(b,c,d,e){return b.updateField(c,d,e)},k.prototype.saveBulkEntities=function a(b){this.updateEntitiesEvent.raise(b)},k.prototype.checkIfDirty=function a(b){return!!b&&b.checkIfDirty()},k.prototype.checkIfEntityDirty=function a(c){var d=b.Deferred(),e;return c?(e=c.checkIfEntityDirty(),e.done(function(){d.resolve()}),e.fail(function(){d.reject()})):d.resolve(),d},k.prototype.checkIfEntitiesDirty=function a(c){var d,e=b.Deferred(),f=[],g
;if(c)for(d=0;d<c.length;d++)f.push(c[d].checkIfEntityDirty());else e.resolve();return g=b.when.apply(this,f),g.done(function(){e.resolve()}),g.fail(function(){e.reject()}),e},k.prototype.checkIfCompositeEntitiesDirty=function a(c){var d,e,f=b.Deferred(),g=[],h;if(c)for(d=0;d<c.length;d++)for(e=0;e<c[d].length;e++)g.push(c[d][e].checkIfEntityDirty());else f.resolve();return h=b.when.apply(this,g),h.done(function(){f.resolve()}),h.fail(function(){f.reject()}),f},k.prototype.checkIfEntityNew=function a(b){return 0===b.key},k.prototype.getRelatedEntities=function a(c,d,e){var f=b.Deferred();return this.service.getRelatedEntityKeys(c,d,e).done(function(a){var b,c=[];for(b=0;b<a.length;b++)c.push(a[b]);f.resolve(c)}).fail(function(a){f.reject(a)}),f.promise()},k.prototype.uploadRefDoc=function(a,b){var c=JSON.parse(window.sessionStorage.getItem("meridium-session")).id;a.append("sessionid",c);var d={cache:!1,data:a,contentType:!1,processData:!1}
;return this.ajaxClient.post("api/common/referencedocuments/refdocupload/"+b,"",d)},k.prototype.canRefDoc=function(a,c){var d=this,e=b.Deferred(),f;return 0!==c&&"0"!==c||e.reject(),f=d.service.canRefDoc(a).done(function(a){e.resolve(a)}).fail(function(a){e.reject(a)}),e.request={abort:f.request.abort},e},k.prototype.getRefDocCount=function(a){var c=this,d=b.Deferred(),e;return 0!==a&&"0"!==a||d.reject(),e=c.service.getRefDocCount(a).done(function(a){d.resolve(a)}).fail(function(a){d.reject(a)}),d.request={abort:e.request.abort},d},k.prototype.setEntityClean=function a(b){b&&(b.isDirty=!1)};function l(a){if("string"==typeof a||a instanceof String||"number"==typeof a||a instanceof Number)return"key";if(b.isArray(a)){for(var c=0;c<a.length;c++)return"key"===l(a[c])?"keys":"objects";return"bulk"}return"object"}return k.prototype.hasRefDocServerCredentials=function(){var a=this,c=b.Deferred();return a.service.refDocServerCredentialsExist().done(function(a){c.resolve(a)}).fail(function(a){
c.reject(a)}),c},k.prototype.getBulkEntitiesByQuery=function a(c){var d=b.Deferred();return this.service.getBulkEntitiesByQuery(c).done(function(a){var b,c=[];for(b=0;b<a.length;b++)c.push(new g(a[b]));d.resolve(c)}).fail(function(a){d.reject(a)}),d},k.prototype.setupForDCM=function(){this.service.setupForDCM()},k});
define('platform/datasheets/layout/ui/bootstrap-tabs',[],function(){"use strict";var a=function(a){this.element=$(a)};a.prototype.show=function(){var a=this.element,b=a.closest("ul:not(.dropdown-menu)"),c=a.data("target");if(c||(c=a.attr("href"),c=c&&c.replace(/.*(?=#[^\s]*$)/,"")),!a.parent("li").hasClass("active")){var d=b.find(".active:last a")[0],e=$.Event("show.bs.tab",{relatedTarget:d});if(a.trigger(e),!e.isDefaultPrevented()){var f=$(c);this.activate(a.parent("li"),b),this.activate(f,f.parent(),function(){a.trigger({type:"shown.bs.tab",relatedTarget:d})})}}},a.prototype.activate=function(a,b,c){var d=b.find("> .active"),e=c&&$.support.transition&&d.hasClass("fade");function f(){d.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"),a.addClass("active"),e?(a[0].offsetWidth,a.addClass("in")):a.removeClass("fade"),a.parent(".dropdown-menu")&&a.closest("li.dropdown").addClass("active"),c&&c()}e?d.one($.support.transition.end,f).emulateTransitionEnd(150):f(),d.removeClass("in")};var b=$.fn.tab
;return $.fn.tab=function(b){return this.each(function(){var c=$(this),d=c.data("bs.tab");d||c.data("bs.tab",d=new a(this)),"string"==typeof b&&d[b]()})},$.fn.tab.Constructor=a,$.fn.tab.noConflict=function(){return $.fn.tab=b,this},a});

define('text!ui/elements/text-ext/template.html',[],function () { return '<div class="mi-multi-value-container" data-bind="visible:visible,css:{\'disabled\':disabled,\'open\':isOpen,\'required\': (options() && !options().length) && required}">\r\n    <div data-bind="click:toggleOptions,css:{\'active\':isOpen},clickBubble: false" class="mi-multi-value-selector">\r\n        <!--<input type="text" class="mi-multi-value-selected-value-text pull-left" data-bind="value:value" />-->\r\n        <span class="mi-multi-value-selected-value-text pull-left" data-bind="text:selectedValueText"></span>\r\n        <i class="icon-arrow pull-right" ></i>\r\n    </div>\r\n\r\n    <div data-bind="visible:isOpen()" class="mi-multi-value-options-container hide">\r\n\r\n        <!-- ko ifnot:(optionsCaption() === null) -->\r\n        <p class="mi-multi-value-option" data-bind="text:optionsCaption()"></p>\r\n        <!-- /ko -->\r\n        <!-- ko foreach:options -->\r\n        <p class="mi-multi-value-option" data-bind="text:$parent.getOptionText($data)"></p>\r\n        <!-- /ko -->\r\n    </div>\r\n\r\n</div>';});


define('text!ui/elements/text-ext/options-template.html',[],function () { return '<div data-bind="visible:isOpen()" class="mi-text-ext-options-container">\r\n    <p class="mi-multi-value-option" data-bind="clickBubble: false, click:function(data,event){event.preventDefault();}">\r\n        <input type="text" data-bind="attr:{ placeholder: $root.translator.translate(\'MULTI_VALUE_ADD_OPTION_PLACEHOLDER\') }, value:addValue,event:{\'keyup\':addValueUpdate}" />\r\n    </p>\r\n\r\n    <!-- ko ifnot:(optionsCaption() === null) -->\r\n    <p class="mi-multi-value-option" data-bind="text:optionsCaption()"></p>\r\n    <!-- /ko -->\r\n    <!-- ko foreach:options -->\r\n    <p class="mi-multi-value-option">\r\n        <span data-bind="text:$parent.getOptionText($data)"></span>\r\n        <span class="ds ds-cross pull-right" data-bind="click:function(data,event){$parent.removeOption(data,event);}"></span> \r\n\r\n    </p>\r\n    <!-- /ko -->\r\n\r\n  \r\n\r\n</div>\r\n';});

define('ui/elements/text-ext/view-model',['require','lodash','jquery','text!./template.html','text!./options-template.html','knockout','spa/region','../select/element','system/globalization/translator','system/hardware/device'],function(require){"use strict";var a=require("lodash"),b=require("jquery"),c=require("text!./template.html"),d=require("text!./options-template.html"),e=require("knockout"),f=require("spa/region"),g=require("../select/element"),h=require("system/globalization/translator"),i=Object.resolve(require("system/hardware/device"));function j(){m.call(this,c,!1,!0);var a=this;this.translator=Object.resolve(h),this.options=e.observableArray([]),this.value=e.observable(),this.optionsCaption=e.observable(),this.optionsText=e.observable(),this.optionsValue=e.observable(),this.max=e.observable(),this.required=e.observable(),this.disabled=e.observable(),this.visible=e.observable(),this.isOpen=e.observable(!1),this.selectedItem=e.observable(),this.addValue=e.observable(),this.optionsRegion=new f,b(document).bind("click",k.bind(null,a)),this.isClicked=!1,this.isMobile=i.isMobile(),this.addValueUpdate=l,this.addValue.subscribe(a.addOption,this)}function k(a){
a.isClicked?a.isClicked=!1:a.isOpen()&&(b(".text-ext-outer-container").remove(),a.isOpen(!1))}function l(a,b){13!==b.keyCode&&9!==b.keyCode||(b.target.blur(),b.target.focus())}var m=Object.inherit(g.ViewModel,j);j.prototype.afterAttached=function(){},j.prototype.afterCreated=function(){},j.prototype.beforeCreated=function(){var c=this;this.bindAttribute("optionsText",null),this.bindAttribute("optionsValue",null),this.bindAttribute("optionsCaption",null),this.bindAttribute("options",[],null,!0),this.bindAttribute("value",null),this.bindAttribute("max",null),this.bindAttribute("disabled",!1),this.bindAttribute("required",!1),this.bindAttribute("visible",!0),this.resizeProxy=b.proxy(a.debounce(this.resize,100),this),this.scrollProxy=b.proxy(this.resize,this),this.selectedValueText=e.computed(o.bind(null,this)),b(this.element).on("properties.options:changed",function(a,b){}.bind(this)),b(this.element).on("properties.value:changed",s.bind(null,this)),
b(this.element).on("properties.size:changed",function(a,b){}.bind(this)),b(this.element).on("properties.selectedOptions:changed",t.bind(null,this))},j.prototype.removeOption=function(a,c){var d=this;c.stopPropagation(),d.options.remove(a),b(d.element).trigger("properties.options:changed",[d.options()]),d.value(d.options().join(", "))},j.prototype.addOption=function(a){var c=this,d=a,e=!1;if(a){"object"==typeof c.options()[0]&&null!==c.options()[0]&&(d={},d[c.optionsText()]=a,d[c.optionsValue()]=a),window.txt=c;for(var f=c.options(),g=0;g<f.length;g++)if(null===f[g]){c.options()[g]=d,e=!0;break}e?c.value(c.options().join(", ")):(c.options.push(d),b(c.element).trigger("properties.options:changed",[c.options()])),c.addValue("")}},j.prototype.toggleOptions=function(a,c){var d=this;if(c.stopPropagation(),d.disabled())return!1;d.isClicked=!0,b(document).trigger("click"),d.isOpen()||(v(d),b(window).on("resize",this.resizeProxy),b(d.element).parents().on("scroll",this.scrollProxy),
d.isOpen(!0))};function n(a){e.cleanNode(a.optionsRegion.activeContainer),b(".text-ext-outer-container").remove(),b(window).off("resize",a.resizeProxy),b(a.element).parents().off("scroll",a.scrollProxy)}function o(a){var b=a.options(),c="";if(b){for(var d=0;b&&d<b.length;d++){c+=(c?", ":"")+a.getOptionText(b[d])}return c}}j.prototype.getValue=function(a){var b=a;return"function"==typeof a&&(b=a()),b},j.prototype.getReturnValue=function(a,b){return"function"==typeof a?a.call(b,b):b?b[a]:b},j.prototype.getOptionText=function(a){var b=this;return b.optionsText()?b.getValue(b.getReturnValue(b.optionsText(),a)):a},j.prototype.getOptionValue=function(a){var b=this;return b.optionsValue()?b.getValue(b.getReturnValue(b.optionsValue(),a)):a},j.prototype.resize=function(){this.isMobile||(this.isOpen(!1),n(this))};function p(a,b){for(var c=0;b&&c<b.length;c++)null!==b[c]&&a.options.push(b[c])}function q(a){}function r(a){}function s(a,b,c){}function t(a,b,c){}function u(a){this.option=a,
this.isSelected=e.observable(!1)}function v(a){var c,f,g,h=30,i,j,k,l;c=document.createElement("div"),a.optionsContainerDiv=c,b(c).addClass("text-ext-outer-container"),document.body.appendChild(c),a.optionsRegion.setElement(c),a.optionsRegion.attach(d),e.applyBindings(a,a.optionsRegion.activeContainer),f=b(a.container).find(".mi-multi-value-selector").offset(),g=b(a.container).find(".mi-multi-value-selector").width(),a.topOffset=f.top,a.leftOffset=f.left,b(c).css({position:"absolute",top:a.topOffset+40,left:a.leftOffset,"min-width":g,"z-index":1e5}),setTimeout(function(){i=b(c).width(),j=b(c).height(),f.top+j>=b(window).height()?(k=f.top-j-20,f.left+g-i<80?(l=f.left,b(c).find(".mi-text-ext-options-container").addClass("top-left")):(l=f.left-Math.abs(g-i),b(c).find(".mi-text-ext-options-container").addClass("top-right"))):(k=a.topOffset+h+10,f.left+g-i<80?(l=f.left,b(c).find(".mi-text-ext-options-container").addClass("bottom-left")):(l=f.left-Math.abs(g-i),
b(c).find(".mi-text-ext-options-container").addClass("bottom-right"))),b(c).css({left:l,top:k})},1)}return g.register("mi-text-ext",j),j});
define('ui/elements/site-selector/i-site-selector-element',['require','exports','module','system/lang/interface'],function(require,exports,module){"use strict";return new(require("system/lang/interface"))(module.id,["createdCallback","attachedCallback","detachedCallback","attributeChangedCallback","removeChild"])});
define('ui/elements/site-selector/models/site-user',['require','lodash','ramda','application/application-context','mi-assert','system/globalization/translator'],function(require){"use strict";var a=require("lodash"),b=require("ramda"),c=require("application/application-context"),d=require("mi-assert"),e=require("system/globalization/translator");function f(){var a=Object.resolve(e);this.NullSite={siteKey:null,siteName:a.translate("ALL_SITES")},this.__private__={user:c.user,session:c.session,dbSitesCount:c.dbSiteCount}}f.hasGlobalAccess=function a(){return!0},f.prototype.getSites=function a(){var b=g(this);return d.isArray(b,"sites"),b},f.prototype.getDBSiteCount=function a(){return o(this)},f.prototype.hasMultipleSites=function(){return!!h(this).sites&&1!==h(this).sites.length};function g(a){var b=i(a).userSites;return b=b||[],b=b.slice(),d.isArray(b,"sites"),d.assert(b!==h(a).sites,"sites is a copy of user sites"),b}function h(a){q(a);var b=a.__private__.user;return r(a,b),b}function i(a){return q(a),a.__private__.session}f.prototype.getDefaultSite=function a(){var b,c=j(this);return b=c?k(this,c):n(this),s(b),b};function j(a){
var b=h(a).defaultSiteKey||null;return d.isNotUndefined(b,"defaultSiteKey"),b}function k(b,c){var d;return l(b)?(d=a.find(b.getSites(),m.bind(null,c)),d=d||n(b)):d=b.NullSite,s(d),d}function l(a){return a.getSites().length>0}function m(a,b){return b.siteKey===a}function n(a){var c;return c=l(a)?b.find(p,a.getSites())||a.NullSite:a.NullSite,s(c),c}function o(a){return a.__private__.dbSitesCount}var p=b.complement(b.prop("viewOnly"));function q(a){d.enabled&&(d.instanceOf(a,f,"this"),d.isNotUndefined(a.__private__,"this.__private__"),d.isNotUndefined(a.__private__.user,"this.__private__.user"))}function r(a,b){b=b||h(a),d.enabled&&d.assert(b===c.user,"expected user to be same as ApplicationContext.user")}function s(a){d.enabled&&(d.ok(a,"site"),null!==a.siteKey&&d.isString(a.siteKey,"site.siteKey"),d.isString(a.siteName,"site.siteName"))}return f});
define('ui/elements/site-selector/view-models/site-selector-view-model',['require','lodash','mi-assert','../models/site-user','system/lang/event','system/http/es6-ajax-request','mithril'],function(require){"use strict";var a=require("lodash"),b=require("mi-assert"),c=require("../models/site-user"),d=require("system/lang/event"),e=require("system/http/es6-ajax-request"),f=require("mithril");function g(){var a=new c;this.__private__={user:a,selectedSite:a.NullSite,isHidden:!1,isDisabled:!1,isReadOnly:!1},this.selectedSiteChanged=Object.resolve(d),this.setSelectedSite(this.getDefaultSite())}g.prototype.dispose=function a(){this.selectedSiteChanged.remove(),this.selectedSiteChanged=null},g.prototype.getDefaultSite=function a(){return h(this).getDefaultSite()};function h(a){p(a);var b=a.__private__.user;return q(a,b),b}g.prototype.setSelectedSite=function a(b){p(this),r(b),this.__private__.selectedSite=b,this.selectedSiteChanged.raise(this,{site:this.getSelectedSite()})},g.prototype.getSites=function a(){return h(this).getSites()},g.prototype.getSelectableSites=function a(){
var d=c.hasGlobalAccess(),e=this.getSites(),f=0===e.length,g=this.getSelectedSite(),j=h(this).NullSite;return d?e=i(this,e):(f||g===j)&&(e=[j]),b.isArray(e,"sites"),b.assert(e.length>=1,"expected sites to have at least one item"),e};function i(a,b){return b.unshift(h(a).NullSite),b}g.prototype.getSelectedSite=function a(){p(this);var b=this.__private__.selectedSite;return r(b),b},g.prototype.allowSelection=function a(){return h(this).hasMultipleSites()},g.prototype.isHidden=function a(){p(this);var c=this.__private__.isHidden||0===j(this)||k(this)<1;return b.isBoolean(c),c};function j(a){return p(a),a.getSites().length}function k(a){return p(a),h(a).getDBSiteCount()}g.prototype.isDisabled=function a(){p(this);var c=this.__private__.isDisabled;return b.isBoolean(c),c},g.prototype.isReadOnly=function a(){p(this);var c=this.__private__.isReadOnly;return b.isBoolean(c),c},g.prototype.setHidden=function a(c){p(this),b.isBoolean(c),this.__private__.isHidden=c},
g.prototype.setDisabled=function a(c){p(this),b.isBoolean(c),this.__private__.isDisabled=c},g.prototype.setReadOnly=function a(c){p(this),b.isBoolean(c),this.__private__.isReadOnly=c},g.prototype.selectSiteByKey=function a(b){p(this);var c=l(this,b);c&&this.setSelectedSite(c)};function l(b,c){return null===c?h(b).NullSite:a.find(b.getSites(),m.bind(null,c))}function m(a,b){return b.siteKey===a}g.prototype.selectSiteByAssetKey=function a(c){p(this),b.stringNotEmpty(c),n(c).then(o.bind(null,this))};function n(a){b.stringNotEmpty(a);var c="api/common/assetcontext/"+a;return e.get(c).send()}function o(a,b){a.selectSiteByKey("0"===b.siteKey?null:b.siteKey),f.redraw()}g.prototype.selectDefaultSite=function(){var a=this.getDefaultSite();a&&this.setSelectedSite(a)};function p(a){b.enabled&&(b.instanceOf(a,g,"this"),b.isNotUndefined(a.__private__,"this.__private__"),b.isObject(a.__private__.user,"this.__private__.user"),b.isObject(a.__private__.selectedSite,"this.__private__.selectedSite"),
b.isBoolean(a.__private__.isHidden,"this.__private__.isHidden"),b.isBoolean(a.__private__.isDisabled,"this.__private__.isDisabled"),b.isBoolean(a.__private__.isReadOnly,"this.__private__.isReadOnly"),b.instanceOf(a.selectedSiteChanged,d,"this.selectedSiteChanged"))}function q(a,d){d=d||h(a),b.enabled&&b.instanceOf(d,c,"user")}function r(a){b.enabled&&(b.ok(a,"site"),null!==a.siteKey&&b.isString(a.siteKey,"site.siteKey"),b.isString(a.siteName,"site.siteName"))}return g});
define('system/mithril/mithril-extensions',['require','lodash','mithril'],function(require){"use strict";var a=require("lodash"),b=require("mithril");function c(b,c,d){return b=f(b),b?a.isFunction(c)?c():c:d?a.isFunction(d)?d():d:void 0}function d(a,b,c){return a=f(a),a?b(a):c?c():void 0}function e(b,c,d){return b=f(b),a.size(b)?a.map(b,c):d?d():void 0}function f(b){return a.isFunction(b)?b():b}function g(){b.endComputation(),b.startComputation()}function h(a,b){return{currentTarget:a,args:b}}return{iif:c,exists:d,map:e,value:f,restartComputation:g,event:h}});
define('system/mithril/html-tags',['require','mithril','./mithril-extensions'],function(require){"use strict";var a=require("mithril"),b=require("./mithril-extensions");function c(b){return a("i"+b)}function d(b,c){return a(".inline",b,c)}function e(c,d,e){return a("video[controls]",{width:b.value(d),height:b.value(e),src:b.value(c)})}return{icon:c,idiv:d,video:e,header:a.bind(null,"header"),h1:a.bind(null,"h1"),h2:a.bind(null,"h2"),span:a.bind(null,"span"),div:a.bind(null,"div"),section:a.bind(null,"section"),label:a.bind(null,"label"),table:a.bind(null,"table"),thead:a.bind(null,"thead"),tbody:a.bind(null,"tbody"),tr:a.bind(null,"tr"),th:a.bind(null,"th"),td:a.bind(null,"td"),ul:a.bind(null,"ul"),li:a.bind(null,"li"),a:a.bind(null,"a"),output:a.bind(null,"output")}});
define('system/mithril/bootstrap-tags',['require','mithril','./mithril-extensions'],function(require){"use strict";var a=require("mithril"),b=require("./mithril-extensions");function c(c,d,e,f){return a("a.list-group-item",{href:b.value(c),class:b.value(e||!1)?"active":"",onclick:f},b.value(d))}return{aListGroupItem:c,button:a.bind(null,"button.btn.btn-default"),primaryButton:a.bind(null,"button.btn.btn-primary"),iconButton:a.bind(null,"button.btn.btn-icon"),panel:a.bind(null,".panel.panel-default"),panelHeading:a.bind(null,".panel-heading"),panelBody:a.bind(null,".panel-body.container"),layoutRow:a.bind(null,".row"),divListGroup:a.bind(null,".list-group"),inputGroupButton:a.bind(null,"span.input-group-btn"),formGroup:a.bind(null,".form-group"),textBox:a.bind(null,'input.form-control[type="text"]'),table:a.bind(null,"table.table"),dropdown:a.bind(null,".dropdown"),dropdownMenu:a.bind(null,"ul.dropdown-menu")}});
define('ui/elements/site-selector/views/site-selector-view',['require','mithril','system/mithril/html-tags','system/mithril/bootstrap-tags','ramda','system/globalization/translator'],function(require){"use strict";var a=require("mithril"),b=require("system/mithril/html-tags"),c=require("system/mithril/bootstrap-tags"),d=require("ramda"),e=require("system/globalization/translator");function f(a){if(!a.isHidden()){return(a.isReadOnly()?g:h)(a)}}function g(c){return a(".readonly",[b.icon(".icon-location"),j(),k(c)])}function h(a){return c.dropdown([i(a),l(a)])}function i(c){var d=c.getSelectedSite(),e={"data-toggle":"dropdown",title:d.siteName};return c.isDisabled()&&(e.disabled="disabled"),a("button.btn",e,[b.icon(".icon-location"),j(),k(c)])}function j(){var a=Object.resolve(e),c=a.translate("SITE");return b.label(c+":")}function k(a){var c=a.getSelectedSite();return c&&c.truncatedSiteName?b.output(c.truncatedSiteName):b.output(c.siteName)}function l(c){var d=c.getSelectableSites();return a(".dropdown-menu",[b.ul(m(c,d))])}function m(a,b){return d.map(n(a),q(b))}var n=d.curry(function a(c,d){return b.li({className:p(c,d),onclick:c.setSelectedSite.bind(c,d),
title:d.siteName},d.siteName)});function o(a){return!a.viewOnly}function p(a,b){return b===a.getSelectedSite()?"active":""}var q=d.filter(o);return f});
define('ui/elements/site-selector/site-selector-element',['require','exports','module','lodash','jquery','mi-assert','mithril','./i-site-selector-element','system/diagnostics/log-manager','./view-models/site-selector-view-model','./views/site-selector-view','system/text/formatter'],function(require,exports,module){"use strict";var a=require("lodash"),b=require("jquery"),c=require("mi-assert"),d=require("mithril"),e=require("./i-site-selector-element"),f=require("system/diagnostics/log-manager"),g=f.getLogger(module.id),h=require("./view-models/site-selector-view-model"),i=require("./views/site-selector-view"),j=require("system/text/formatter"),k=Object.resolve(j),l={},m=90,n=60,o=6;l.prototype=Object.create(HTMLElement.prototype),l.prototype.createdCallback=function(){try{p(this)}catch(a){B(a)}};function p(a){q(a),r(a),w(a),R(a),t(a).isHidden()&&b(a).addClass("customHide")}function q(a){a.__private__={root:null,vm:null,previousValue:null}}function r(a){s(a,Object.resolve(h)),t(a).setReadOnly(Element.booleanAttribute(a,"hidden")),t(a).setDisabled(Element.booleanAttribute(a,"disabled")),t(a).setReadOnly(Element.booleanAttribute(a,"readonly")),t(a).selectedSiteChanged.add(u,a,a)}function s(a,b){R(a),a.__private__.vm=b}function t(a){R(a);var b=a.__private__.vm
;return null!==b&&T(b),b}function u(a,b,d){T(b),c.ok(d,"e"),V(d.site,"e.site"),v(a,d.site),Element.raiseEvent(a,"change",{site:d.site,value:d.site.siteKey})}function v(a,b){a.clientWidth>100?b.truncatedSiteName=k.abbreviateByWidth(b.siteName,m,o):b.truncatedSiteName=k.abbreviateByWidth(b.siteName,n,o-2)}function w(a){Element.defineProperty(a,"value",{get:x.bind(null,a),set:y.bind(null,a)}),Element.defineProperty(a,"isSiteViewOnly",{get:z.bind(null,a),set:A})}function x(a){var b=t(a).getSelectedSite();return V(b),b.siteKey}function y(b,c){(a.isUndefined(c)||""===c)&&(c=null),t(b).selectSiteByKey(c),d.redraw()}function z(a){var b=t(a).getSelectedSite();return V(b),b.viewOnly}function A(){}function B(a){throw g.error(a.stack),console.error(a.stack),a}l.prototype.attachedCallback=function(){try{C(this)}catch(a){B(a)}};function C(a){D(a)||r(a),E(a),v(a,t(a).getSelectedSite()),G(a)}function D(a){return R(a),!!a.__private__.vm}function E(a){R(a),
F(a,Element.build("div",a,["site-selector-root"]))}function F(a,b){R(a),a.__private__.root=b}function G(a){S(a),U(i),d.mount(H(a),{controller:t.bind(null,a),view:i})}function H(a){R(a);var b=a.__private__.root;return S(a,b),b}l.prototype.detachedCallback=function(){try{I(this)}catch(a){B(a)}};function I(a){J(a),K(a),L(a)}function J(a){S(a),d.mount(H(a),null)}function K(a){R(a),S(a),Element.detach(H(a)),F(a,null)}function L(a){t(a).selectedSiteChanged.remove(a),t(a).dispose(),s(a,null)}l.prototype.attributeChangedCallback=function(a,b,c){try{M(this,a,b,c)}catch(a){B(a)}};function M(a,b,c,d){var e=N(b);e&&e(a,d)}function N(b){return{hidden:O,disabled:P,readonly:Q}[b]||a.noop}function O(a,b){t(a).setHidden(null!==b),d.redraw()}function P(a,b){t(a).setDisabled(null!==b),d.redraw()}function Q(a,b){t(a).setReadOnly(null!==b),d.redraw()}l.prototype.selectSiteByAssetKey=function(a){c.isNotUndefined(a,"siteKey"),c.isNotNull(a,"siteKey"),c.stringNotEmpty(a.toString(),"siteKey.toString()"),
t(this).selectSiteByAssetKey(a.toString()),d.redraw()},l.prototype.selectDefaultSite=function(){null!==t(this)&&t(this).selectDefaultSite(),d.redraw()};function R(a){c.enabled&&(c.implementsInterface(a,e,"this"),c.isNotUndefined(a.__private__,"this.__private__"),c.isNotUndefined(a.__private__.root,"this.__private__.root"),c.isNotUndefined(a.__private__.vm,"this.__private__.vm"))}function S(a,b){c.enabled&&(b=b||H(a),c.instanceOf(b,HTMLElement,"root"))}function T(a){c.enabled&&c.instanceOf(a,h,"vm")}function U(a){c.enabled&&c.isFunction(a,"view")}function V(a){c.enabled&&(c.ok(a,"site"),null!==a.siteKey&&c.isString(a.siteKey,"site.siteKey"),c.isString(a.siteName,"site.siteName"),a.truncatedSiteName&&c.isString(a.truncatedSiteName,"site.truncatedSiteName "))}return Element.registerElement("mi-site-selector",{prototype:l.prototype}),l});
define('state-management/services/dto/state-dto',['require','system/lang/converter'],function(require){"use strict";var a=require("system/lang/converter");function b(b){b=b||{},this.key=a.toString(b.key)||"0",this.id=a.toString(b.id),this.caption=a.toString(b.caption)}return b.fromDataCollection=function a(c){if(c){var d,e=[];for(d=0;d<c.length;d++)e[e.length]=new b(c[d]);return e}},b});
define('state-management/services/dto/assignment-dto',['require','system/lang/converter','./state-dto','security/services/user-dto'],function(require){"use strict";var a=require("system/lang/converter"),b=require("./state-dto"),c=require("security/services/user-dto");function d(d){d=d||{},this.key=a.toString(d.key)||"0",this.state=new b(d.state),this.familyKey=a.toString(d.familyKey)||"0",this.entityKey=a.toString(d.entityKey)||"0",this.assignedUser=d.assignedUser?new c(d.assignedUser):null,this.eligibleUsers=c.fromDataCollection(d.eligibleUsers)}return d.fromDataCollection=function a(b){if(b){var c,e=[];for(c=0;c<b.length;c++)e[e.length]=new d(b[c]);return e}},d});
define('state-management/services/dto/operation-dto',['require','system/lang/converter','./state-dto'],function(require){"use strict";var a=require("system/lang/converter"),b=require("./state-dto");function c(c){c=c||{},this.key=a.toString(c.key)||"0",this.id=a.toString(c.id),this.caption=a.toString(c.caption),this.isReserved=a.toBoolean(c.isReserved),this.successorState=new b(c.successorState)}return c.fromDataCollection=function a(b){if(b){var d,e=[];for(d=0;d<b.length;d++)e[e.length]=new c(b[d]);return e}},c});
define('state-management/services/dto/transition-dto',['require','system/lang/converter','./state-dto','./operation-dto'],function(require){"use strict";var a=require("system/lang/converter"),b=require("./state-dto"),c=require("./operation-dto");function d(d){d=d||{},this.activeState=new b(d.activeState),this.entityKey=a.toString(d.entityKey)||"0",this.familyKey=a.toString(d.familyKey)||"0",this.operation=new c(d.operation),this.isEditable=a.toBoolean(d.isEditable),this.successors=c.fromDataCollection(d.successors)}return d});
define('state-management/services/dto/history-record-dto',['require','system/lang/converter'],function(require){"use strict";var a=require("system/lang/converter");function b(b){b=b||{},this.key=a.toString(b.key)||"0",this.entityKey=a.toString(b.entityKey)||"0",this.stateId=a.toString(b.stateId),this.stateCaption=a.toString(b.stateCaption),this.userId=a.toString(b.userId),this.dateEntered=a.toDate(b.dateEntered)}return b.fromDataCollection=function a(c){if(c){var d,e=[];for(d=0;d<c.length;d++)e[e.length]=new b(c[d]);return e}},b});
define('state-management/services/state-management-service',['require','jquery','system/http/ajax-client','./dto/state-dto','./dto/assignment-dto','./dto/transition-dto','./dto/history-record-dto'],function(require){"use strict";var a=require("jquery"),b=require("system/http/ajax-client"),c=require("./dto/state-dto"),d=require("./dto/assignment-dto"),e=require("./dto/transition-dto"),f=require("./dto/history-record-dto"),g="api/core/state/";function h(a){this.ajaxClient=a}return h.dependsOn=[b],h.prototype.getAssignments=function b(c){var e=g+"assignments/"+c,f=a.Deferred();return this.ajaxClient.get(e,{}).done(function(b){var c=a.map(b,function(a){return new d(a)});f.resolve(c)}).fail(function(a){f.reject(a)}),f.promise()},h.prototype.putAssignments=function b(c,d){var e=a.Deferred(),f=g+"assignments/"+c;return this.ajaxClient.put(f,d).done(function(a){e.resolve(a)}).fail(function(a){e.reject(a)}),e.promise()},h.prototype.getHistoryRecords=function b(c){var d=g+"history/"+c,e=a.Deferred();return this.ajaxClient.get(d,{}).done(function(b){var c=a.map(b,function(a){return new f(a)});e.resolve(c)}).fail(function(a){e.reject(a)}),e.promise()},
h.prototype.getTransition=function b(c){var d=g+"transition/"+c,f=a.Deferred();return this.ajaxClient.get(d,{}).done(function(a){f.resolve(new e(a))}).fail(function(a){f.reject(a)}),f.promise()},h.prototype.postTransition=function b(c){var d=a.Deferred(),e=g+"transition/";return this.ajaxClient.post(e,c).done(function(a){d.resolve(a)}).fail(function(a){d.reject(a)}),d.promise()},h});
define('state-management/model/state-model',['require','knockout'],function(require){"use strict";var a=require("knockout");function b(b){b=b||{},this.key=a.observable(b.key),this.id=a.observable(b.id),this.caption=a.observable(b.caption)}return b});
define('state-management/adapters/state-adapter',['require','../services/dto/state-dto','../model/state-model'],function(require){"use strict";var a=require("../services/dto/state-dto"),b=require("../model/state-model");function c(){}return c.toModelObject=function a(c){return new b(c)},c.toModelObjectArray=function a(b){var c=0,d=[];if(b&&b.length){for(c=0;c!==b.length;c++)d.push(this.toModelObject(b[c]));return d}},c.toDTO=function b(c){var d=new a;return c=c||{},d.key=c.key(),d.id=c.id(),d.caption=c.caption(),d},c.toDTOArray=function a(b){var c=0,d=[];if(b&&b.length){for(c=0;c!==b.length;c++)d.push(this.toDTO(b[c]));return d}},c});
define('state-management/model/operation-model',['require','knockout','./state-model'],function(require){"use strict";var a=require("knockout"),b=require("./state-model");function c(c){c=c||{},this.key=a.observable(c.key),this.id=a.observable(c.id),this.caption=a.observable(c.caption),this.isReserved=a.observable(c.isReserved),this.isSelected=a.observable(!1),this.successorState=a.observable(new b(c.successorState))}return c.fromDataCollection=function a(b){var d,e=[];for(d=0;d<b.length;d++)e[d]=new c(b[d]);return e},c});
define('state-management/adapters/operation-adapter',['require','../services/dto/operation-dto','./state-adapter','../model/operation-model'],function(require){"use strict";var a=require("../services/dto/operation-dto"),b=require("./state-adapter"),c=require("../model/operation-model");function d(){}return d.toModelObject=function a(b){return new c(b)},d.toModelObjectArray=function a(b){var c=0,d=[];if(b&&b.length){for(c=0;c!==b.length;c++)d.push(this.toModelObject(b[c]));return d}},d.toDTO=function c(d){var e=new a;return d=d||{},e.key=d.key(),e.id=d.id(),e.caption=d.caption(),e.isReserved=d.isReserved(),e.successorState=b.toDTO(d.successorState()),e},d.toDTOArray=function a(b){var c=0,d=[];if(b&&b.length){for(c=0;c!==b.length;c++)d.push(this.toDTO(b[c]));return d}},d});
define('state-management/model/transition-model',['require','knockout','../adapters/state-adapter','../adapters/operation-adapter'],function(require){"use strict";var a=require("knockout"),b=require("../adapters/state-adapter"),c=require("../adapters/operation-adapter");function d(d){d=d||{},this.activeState=a.observable(b.toModelObject(d.activeState)),this.entityKey=a.observable(d.entityKey),this.familyKey=a.observable(d.familyKey),this.isEditable=a.observable(d.isEditable),this.operation=a.observable(c.toModelObject(d.operation)),this.successors=a.observableArray(c.toModelObjectArray(d.successors))}return d});
define('state-management/adapters/transition-adapter',['require','../services/dto/transition-dto','../model/transition-model','./operation-adapter','./state-adapter'],function(require){"use strict";var a=require("../services/dto/transition-dto"),b=require("../model/transition-model"),c=require("./operation-adapter"),d=require("./state-adapter");function e(){}return e.toModelObject=function a(c){return new b(c)},e.toDTO=function b(e){var f=new a;return e=e||{},f.activeState=d.toDTO(e.activeState()),f.familyKey=e.familyKey(),f.entityKey=e.entityKey(),f.operation=c.toDTO(e.operation()),f.successors=c.toDTOArray(e.successors()),f.isEditable=e.isEditable(),f},e});
define('security/model/user-model',['require','knockout','../services/role-dto','../services/usersite-dto','../services/group-dto'],function(require){"use strict";var a=require("knockout"),b=require("../services/role-dto"),c=require("../services/usersite-dto"),d=require("../services/group-dto");function e(e){var g=this;e=e||{},this.firstName=a.observable(e.firstName),this.id=a.observable(e.id),this.key=e.key,this.lastName=a.observable(e.lastName),this.contentGuid=a.observable(e.contentGuid),this.address1=a.observable(e.address1),this.address2=a.observable(e.address2),this.areaOfResponsibility=a.observable(e.areaOfResponsibility),this.badgeId=a.observable(e.badgeId),this.businessUnit=a.observable(e.businessUnit),this.city=a.observable(e.city),this.comments=a.observable(e.comments),this.company=a.observable(e.company),this.country=a.observable(e.country),this.cultureId=a.observable(e.cultureId),this.defaultSiteKey=a.observable(e.defaultSiteKey),this.department=a.observable(e.department),this.domain=a.observable(e.domain),this.email=a.observable(e.email),this.facility=a.observable(e.facility),
this.faxNumber=a.observable(e.faxNumber),this.firstName=a.observable(e.firstName),this.groups=a.observableArray(d.fromDataCollection(e.groups)),this.roles=a.observableArray(b.fromDataCollection(e.roles)),this.sites=a.observableArray(c.fromDataCollection(e.sites)),this.initial=a.observable(e.initial),this.isActive=a.observable(e.isActive),this.isLocked=a.observable(e.isLocked),this.isSuperUser=a.observable(e.isSuperUser),this.IsCatalogAdmin=a.observable(e.isCatalogAdmin),this.IsConfigAdmin=a.observable(e.isConfigAdmin),this.IsPowerUser=a.observable(e.isPowerUser),this.IsSecurityAdmin=a.observable(e.isSecurityAdmin),this.daysLeft=a.observable(e.daysLeft),this.newPassword=a.observable(e.newPassword),this.mustChangePassword=a.observable(e.mustChangePassword),this.password=a.observable(e.password),this.phoneNumber=a.observable(e.phoneNumber),this.phoneNumber2=a.observable(e.phoneNumber2),this.postalCode=a.observable(e.postalCode),this.queryPrivilege=a.observable(e.queryPrivilege),
this.siteCode=a.observable(e.siteCode),this.state=a.observable(e.state),this.timezoneId=a.observable(e.timezoneId),this.ianaTimezoneId=a.observable(e.ianaTimezoneId),this.title=a.observable(e.title),this.uomConversionSetId=a.observable(e.uomConversionSetId),this.hasThumbnailPhoto=a.observable(e.hasThumbnailPhoto),void 0===g.initial()?this.displayName=a.computed(function(){return g.lastName()+", "+g.firstName()}):this.displayName=a.computed(function(){return g.lastName()+", "+g.firstName()+" "+g.initial()}),this.fullDisplayName=a.computed(function(){return g.lastName()+", "+g.firstName()+" ("+g.id()+")"}),this.contentManagementDisplay=a.computed(function(){return g.firstName()+" "+g.lastName()+" "+g.email()}),this.v3DisplayName=a.computed(function(){return g.lastName()+", "+g.firstName()+" | "+g.id()}),this.userLockSeq=a.observable(e.userLockSeq),this.hrLockSeq=a.observable(e.hrLockSeq),this.isSelected=a.observable(!1),this.isDirty=a.observable(!1),
this.defaultSiteIsSet=a.observable(!1),this.isSuperUser.subscribe(f.bind(null,this))}function f(a){var b=0;a.isSuperUser()&&a.queryPrivilege("0")}return e});
define('security/adapters/user-adapter',['require','../services/user-dto','../model/user-model','mi-assert','system/lang/converter','../services/role-dto','../services/usersite-dto','../services/group-dto'],function(require){"use strict";var a=require("../services/user-dto"),b=require("../model/user-model"),c=require("mi-assert"),d=require("system/lang/converter"),e=require("../services/role-dto"),f=require("../services/usersite-dto"),g=require("../services/group-dto");function h(){}return h.serialize=function a(b){return{firstName:b.firstName,id:b.id,key:b.key,lastName:b.lastName,email:b.email,initial:b.initial}},h.serializeArray=function a(b){var c=0,d=[];if(b&&b.length){for(c=0;c!==b.length;c++)d.push(this.serialize(b[c]));return d}},h.deserialize=function b(e){c.isObject(e,"data"),c.isString(e.key,"data.key"),c.isString(e.id,"data.id");var f=new a;return f.key=d.toString(e.key),f.id=d.toString(e.id),f.firstName=d.toString(e.firstName),f.lastName=d.toString(e.lastName),f.initial=d.toString(e.initial),f.email=d.toString(e.email),f},h.deserializeArray=function a(b){var c=0,d=[];if(b&&b.length){for(c=0;c!==b.length;c++)d.push(this.deserialize(b[c]));return d}},
h.toModelObject=function a(c){return new b(c)},h.toModelObjectArray=function a(b){var c=0,d=[];if(b&&b.length){for(c=0;c!==b.length;c++)d.push(this.toModelObject(b[c]));return d}},h.toDTO=function b(c){var d=new a;return c=c||{},d.firstName=c.firstName(),d.id=c.id(),d.key=c.key,d.lastName=c.lastName(),d.contentGuid=c.contentGuid(),d.address1=c.address1(),d.address2=c.address2(),d.areaOfResponsibility=c.areaOfResponsibility(),d.badgeId=c.badgeId(),d.businessUnit=c.businessUnit(),d.city=c.city(),d.comments=c.comments(),d.company=c.company(),d.country=c.country(),d.cultureId=c.cultureId(),d.defaultSiteKey=c.defaultSiteKey(),d.department=c.department(),d.domain=c.domain(),d.email=c.email(),d.facility=c.facility(),d.faxNumber=c.faxNumber(),d.firstName=c.firstName(),d.groups=g.fromDataCollection(c.groups()),d.roles=e.fromDataCollection(c.roles()),d.sites=f.fromDataCollection(c.sites()),d.mustChangePassword=c.mustChangePassword(),d.initial=c.initial(),d.isActive=c.isActive(),
d.isLocked=c.isLocked(),d.isSuperUser=c.isSuperUser(),d.newPassword=c.newPassword(),d.password=c.password(),d.phoneNumber=c.phoneNumber(),d.phoneNumber2=c.phoneNumber2(),d.postalCode=c.postalCode(),d.queryPrivilege=c.queryPrivilege(),d.siteCode=c.siteCode(),d.state=c.state(),d.timezoneId=c.timezoneId(),d.ianaTimezoneId=c.ianaTimezoneId(),d.title=c.title(),d.uomConversionSetId=c.uomConversionSetId(),d.hasThumbnailPhoto=c.hasThumbnailPhoto(),d.displayName=c.lastName()+", "+c.firstName()+" "+c.initial(),d.fullDisplayName=c.lastName()+", "+c.firstName()+" ("+c.id()+")",d.v3DisplayName=c.lastName()+", "+c.firstName()+" | "+c.id(),d.userLockSeq=c.userLockSeq(),d.hrLockSeq=c.hrLockSeq(),d.daysLeft=c.daysLeft(),d.isSelected=!1,d.isDirty=!1,d.daysLeft=c.daysLeft(),d},h.toDTOArray=function a(b){var c=0,d=[];if(b){if(0===b.length)return d;for(c=0;c!==b.length;c++)d.push(this.toDTO(b[c]));return d}},h});
define('state-management/model/assignment-model',['require','knockout','./state-model','security/adapters/user-adapter','lodash'],function(require){"use strict";var a=require("knockout"),b=require("./state-model"),c=require("security/adapters/user-adapter"),d=require("lodash");function e(d){d=d||{},this.key=a.observable(d.key),this.state=a.observable(new b(d.state)),this.familyKey=a.observable(d.familyKey),this.entityKey=a.observable(d.entityKey),this.assignedUser=d.assignedUser?a.observable(c.toModelObject(d.assignedUser)):a.observable(),this.eligibleUsers=a.observableArray(c.toModelObjectArray(d.eligibleUsers)),this.assignableUsers=a.computed(f.bind(null,this)),this.assignedUserKey=this.assignedUser()?a.observable(this.assignedUser().key):a.observable(),this.assignedUserKey.subscribe(i.bind(null,this))}function f(a){var b=a.eligibleUsers().slice(0);if(a.assignedUser()){g(a.eligibleUsers(),a.assignedUser())||b.push(a.assignedUser())}return b}function g(a,b){return!!d.find(a,h.bind(null,b.key))}function h(a,b){return a===b.key}function i(a,b){var c=d.find(a.eligibleUsers(),h.bind(null,b))
;c&&a.assignedUser(c)}return e});
define('state-management/adapters/assignment-adapter',['require','../services/dto/assignment-dto','../model/assignment-model','./state-adapter','security/adapters/user-adapter'],function(require){"use strict";var a=require("../services/dto/assignment-dto"),b=require("../model/assignment-model"),c=require("./state-adapter"),d=require("security/adapters/user-adapter");function e(){}return e.toModelObject=function a(c){return new b(c)},e.toModelObjectArray=function a(b){var c=0,d=[];if(b&&b.length){for(c=0;c!==b.length;c++)d.push(this.toModelObject(b[c]));return d}},e.toDTOArray=function a(b){var c=0,d=[];if(b&&b.length){for(c=0;c!==b.length;c++)d.push(this.toDTO(b[c]));return d}},e.toDTO=function b(e){var f=new a;return e=e||{},f.key=e.key(),f.state=c.toDTO(e.state()),f.familyKey=e.familyKey(),f.entityKey=e.entityKey(),f.assignedUser=e.assignedUser()?d.toDTO(e.assignedUser()):null,f.eligibleUsers=d.toDTOArray(e.eligibleUsers()),f},e});

define('text!state-management/views/state-assignment.html',[],function () { return '<div class="state-assignment">\r\n\r\n    <ul class="state-assignment-tabs nav nav-tabs">\r\n        <li data-bind="css: { active: isAssignmentActive }">\r\n            <a data-bind="click: showAssignments, text: translate(\'STATE_ASSIGNMENT\')"></a>\r\n        </li>\r\n        <li data-bind="css: { active: isHistoryActive }">\r\n            <a data-bind="click: showHistory, text: translate(\'STATE_HISTORY\')"></a>\r\n        </li>\r\n    </ul>\r\n\r\n    <div class="state-assignment-tab-content"\r\n         data-bind="visible: isAssignmentActive">\r\n        <table class="table table-bordered table-condensed table-striped">\r\n            <thead>\r\n                <tr>\r\n                    <td data-bind="text: translate(\'STATE\')"></td>\r\n                    <td data-bind="text: translate(\'ASSIGNEE\')"></td>\r\n                </tr>\r\n            </thead>\r\n            <tbody data-bind="foreach: assignments">\r\n                <tr>\r\n                    <td data-bind="text: state().caption" />\r\n                    <td>\r\n                        <div class="form-group">\r\n                            <!-- ko if: assignableUsers().length -->\r\n                            <mi-select class="form-control" data-bind="miproperty: {options: assignableUsers, optionsText: \'fullDisplayName\', value: assignedUserKey, optionsValue: \'key\', optionsCaption: \' \' }"></mi-select>\r\n                            <!-- /ko -->\r\n                        </div>\r\n                    </td>\r\n                </tr>\r\n            </tbody>\r\n        </table>\r\n    </div>\r\n\r\n    <div class="state-assignment-tab-content"\r\n         data-bind="visible: isHistoryActive">\r\n        <table class="table table-bordered table-condensed table-striped">\r\n            <thead>\r\n                <tr>\r\n                    <td>\r\n                        <a data-bind="click: sortHistory(\'state\'),\r\n                                      text: translate(\'STATE\')"></a>\r\n                        <i class="icon-arrow pull-right"\r\n                           data-bind="visible: historySortCriteria.orderBy() === \'state\',\r\n                                      css: { \'rotate-180\': !historySortCriteria.reverse() }"></i>    <!--font awesome fa-flip-vertical has been removed, needs to be verified-->\r\n                    </td>\r\n                    <td>\r\n                        <a data-bind="click: sortHistory(\'user\'),\r\n                                      text: translate(\'STATE_HIST_LAST_SET_BY\')"></a>\r\n                        <i class="icon-arrow pull-right"\r\n                           data-bind="visible: historySortCriteria.orderBy() === \'user\',\r\n                                      css: { \'rotate-180\': !historySortCriteria.reverse() }"></i>    <!--font awesome fa-flip-vertical has been removed, needs to be verified-->\r\n                    </td>\r\n                    <td>\r\n                        <a data-bind="click: sortHistory(\'dateEntered\'),\r\n                                      text: translate(\'STATE_HIST_LAST_SET_ON\')"></a>\r\n                        <i class="icon-arrow pull-right"\r\n                           data-bind="visible: historySortCriteria.orderBy() === \'dateEntered\',\r\n                                      css: { \'rotate-180\': !historySortCriteria.reverse() }"></i>    <!--font awesome fa-flip-vertical has been removed, needs to be verified-->\r\n                    </td>\r\n                </tr>\r\n            </thead>\r\n            <tbody data-bind="foreach: historyRecords">\r\n                <tr>\r\n                    <td data-bind="text: stateCaption" />\r\n                    <td data-bind="text: userId" />\r\n                    <td data-bind="text: dateEntered.toLocaleDateString() + \' \' + dateEntered.toLocaleTimeString()" />\r\n                </tr>\r\n            </tbody>\r\n        </table>\r\n    </div>\r\n\r\n</div>';});

define('state-management/state-assignment-view-model',['require','jquery','application/application-events','spa/ko/knockout-view-model','system/globalization/translator','knockout','system/knockout/knockout-manager','system/error/error-message','./services/state-management-service','./adapters/assignment-adapter','text!./views/state-assignment.html','system/lang/object'],function(require){"use strict";var a=require("jquery"),b=require("application/application-events"),c=require("spa/ko/knockout-view-model"),d=require("system/globalization/translator"),e=require("knockout"),f=require("system/knockout/knockout-manager"),g=require("system/error/error-message"),h=require("./services/state-management-service"),i=require("./adapters/assignment-adapter"),j=require("text!./views/state-assignment.html");require("system/lang/object");function k(a,b,c){l.call(this,j),this.kom=a,this.kom.tracker.hashFunction=s.bind(null,this),this.applicationEvents=b,this.translator=Object.resolve(d),this.service=c,this.region=null,this.historySortCriteria={orderBy:this.kom.observable("dateEntered"),reverse:this.kom.observable(!0)},this.assignments=null,this.entityKey=null,this.historyRecords=null,this.isAssignmentActive=null,this.isHistoryActive=null}var l=Object.inherit(c,k);k.dependsOn=[f,b,h],k.prototype.open=function a(){
this.applicationEvents.titleChanged.raise(this.translate("STATE_ASSIGNMENT"),this)},k.prototype.load=function b(c){var d=new a.Deferred,e,f;return this.assignments=this.kom.observableArray(),this.entityKey=c,this.historyRecords=this.kom.observableArray(),this.isAssignmentActive=this.kom.observable(!0),this.isHistoryActive=this.kom.observable(!1),e=this.service.getAssignments(this.entityKey).done(n.bind(null,this)).fail(r.bind(null,this)),f=this.service.getHistoryRecords(this.entityKey).done(o.bind(null,this)).fail(r.bind(null,this)),a.when(e,f).done(p.bind(null,this,d)),d.promise()},k.prototype.activate=function a(){},k.prototype.attach=function a(b){l.prototype.attach.call(this,b),this.region=b},k.prototype.detach=function a(b){l.prototype.detach.call(this,b)},k.prototype.canUnload=function a(){return!0},k.prototype.deactivate=function a(){this.kom.disposeSubscriptions(),this.kom.disposeComputeds()},k.prototype.unload=function a(){this.kom.disposeObservables()},
k.prototype.sortHistory=function a(b){this.historySortCriteria.orderBy()===b?this.historySortCriteria.reverse(!this.historySortCriteria.reverse()):this.historySortCriteria.orderBy(b),m(this)},k.prototype.translate=function(a){return this.translator.translate(a)},k.prototype.showAssignments=function a(){this.isAssignmentActive(!0),this.isHistoryActive(!1)},k.prototype.showHistory=function a(){this.isAssignmentActive(!1),this.isHistoryActive(!0)},k.prototype.save=function b(){var c=a.Deferred();if(this.assignments&&this.assignments())return this.service.putAssignments(this.entityKey,i.toDTOArray(this.assignments())).done(q.bind(null,this,c)).fail(r.bind(null,this)),c.promise()},k.prototype.isDirty=function a(){return this.kom.isDirty()};function m(a){var b=a.historySortCriteria.orderBy(),c=a.historySortCriteria.reverse();a.historyRecords.sort(function(a,d){var e=a;switch(a=c?d:a,d=c?e:d,b){case"state":return a.stateCaption===d.stateCaption?0:a.stateCaption<d.stateCaption?-1:1;case"user":
return a.userId===d.userId?0:a.userId<d.userId?-1:1;case"dateEntered":return a.dateEntered===d.dateEntered?0:a.dateEntered<d.dateEntered?-1:1;default:return}})}function n(a,b){var c=i.toModelObjectArray(b);a.assignments(c)}function o(a,b){a.historyRecords(b)}function p(a,b){a.kom.tracker.markCurrentStateAsClean(),b.resolve()}function q(a,b,c){b.resolve(c)}function r(a,b){var c=2,d=b.statusText,e=new g(c,d);a.applicationEvents.errorOccured.raise(a,e)}function s(a){var b=[],c=0,d;if(a.assignments&&a.assignments()){for(c=0;c!==a.assignments().length;c++)d=a.assignments()[c],b.push({assignmentKey:d.key(),assignedUserKey:d.assignedUser()?d.assignedUser().key:null});return JSON.stringify(b)}}return k});

define('text!state-management/views/state-assignment-dialog.html',[],function () { return '<div class="state-assignment-dialog block-group">\r\n    <div class="state-assignment-container">\r\n        &nbsp;\r\n    </div>\r\n    <div class="controls pull-right">\r\n        <button type="button"\r\n                class="btn btn-primary"\r\n                data-bind="enable: canClickDone,\r\n                           text: translate(\'DONE\'),\r\n                           click: done"></button>\r\n        <button type="button"\r\n                class="btn btn-default"\r\n                data-bind="click: cancel,\r\n                           text: translate(\'CANCEL\')"></button>\r\n    </div>\r\n</div>';});

define('state-management/state-assignment-dialog',['require','jquery','spa/ko/knockout-view-model','spa/region','system/lang/event','system/ui/busy-indicator','system/ui/dialog-view-model','./state-assignment-view-model','system/globalization/translator','system/knockout/knockout-manager','./adapters/assignment-adapter','text!./views/state-assignment-dialog.html','system/lang/string','system/lang/object'],function(require){"use strict";var a=require("jquery"),b=require("spa/ko/knockout-view-model"),c=require("spa/region"),d=require("system/lang/event"),e=require("system/ui/busy-indicator"),f=require("system/ui/dialog-view-model"),g=require("./state-assignment-view-model"),h=require("system/globalization/translator"),i=require("system/knockout/knockout-manager"),j=require("./adapters/assignment-adapter"),k=require("text!./views/state-assignment-dialog.html");require("system/lang/string"),require("system/lang/object");function l(a,b,c){var g,j;m.call(this,k),this.stateAssignmentRegion=a,this.stateAssignmentViewModel=b,this.busyIndicator=Object.resolve(e),this.translator=Object.resolve(h),this.kom=Object.resolve(i),this.cancelEvent=new d,j=this.translator.translate("STATE_ASSIGNMENT"),g={height:"50%",width:"50%"},this.dialog=Object.resolve(f,this,j,g),this.title=this.dialog.title,this.requestedEntityKey=null,this.canClickDone=null,this.dfd=null}var m=Object.inherit(b,l)
;l.dependsOn=[c,g],l.prototype.show=function b(c,d){return this.requestedEntityKey=c,this.title=d||this.title,this.dialog.show(),this.dfd=a.Deferred(),this.busyIndicator.attachTo(document.querySelector(".dialog-wrapper .state-assignment-dialog .state-assignment-container")),this.dfd.promise()},l.prototype.open=function a(){},l.prototype.load=function b(){var c=new a.Deferred;return this.stateAssignmentViewModel.load(this.requestedEntityKey),this.canClickDone=this.kom.computed(n.bind(null,this)),c.promise()},l.prototype.activate=function a(){this.stateAssignmentViewModel.activate()},l.prototype.attach=function a(b){m.prototype.attach.call(this,b),this.region=b,this.stateAssignmentRegion.setElement(this.region.$element.find("div.state-assignment-container").get(0)),this.stateAssignmentViewModel.attach(this.stateAssignmentRegion)},l.prototype.detach=function a(b){this.stateAssignmentViewModel.detach(this.stateAssignmentRegion),this.stateAssignmentRegion.clear(),
m.prototype.detach.call(this,b)},l.prototype.canUnload=function a(){return this.stateAssignmentViewModel.canUnload()},l.prototype.deactivate=function a(){this.stateAssignmentViewModel.deactivate(this.stateAssignmentRegion)},l.prototype.unload=function a(){this.stateAssignmentViewModel.unload()},l.prototype.translate=function(a){return this.translator.translate(a)},l.prototype.done=function a(){this.busyIndicator.show(),this.stateAssignmentViewModel.save().done(o.bind(null,this))},l.prototype.cancel=function a(){this.busyIndicator.detach(),this.cancelEvent.raise(),this.dialog.closeDialog()};function n(a){return a.stateAssignmentViewModel.isDirty()}function o(a){var b;a.busyIndicator.hide(),a.busyIndicator.detach(),a&&a.stateAssignmentViewModel&&a.stateAssignmentViewModel.assignments&&a.stateAssignmentViewModel.assignments()&&(b=a.stateAssignmentViewModel.assignments(),a.dfd.resolve(j.toDTOArray(b)),a.dialog.closeDialog())}return l});

define('text!ui/elements/state-transition/popover-content.html',[],function () { return '<div class="state-transition">\r\n    <div class="form-group">\r\n        <!-- ko if: canDisplaySuccessors -->\r\n        <!--<label data-bind="text: translate(\'STATE_CHOOSE_OPERATION\')"></label>-->\r\n        <ul class="successors-list list-group"\r\n            data-bind="foreach: availableSuccessors,\r\n                       click: selectOperation">\r\n            <li class="list-group-item"\r\n                data-bind="text:caption,\r\n                            css: { active: isSelected }">\r\n            </li>\r\n        </ul>\r\n        <!-- /ko -->\r\n        <!-- ko ifnot: canDisplaySuccessors -->\r\n        <label data-bind="text: translate(\'STATE_NO_SUCCESSORS\')"></label>\r\n        <!-- /ko -->\r\n    </div>\r\n</div>\r\n<div class="state-assignment block-group">\r\n    <!-- ko if: successorAssignment -->\r\n    <div class="form-group">\r\n        <select data-bind="options: successorAssignment().eligibleUsers,\r\n                           optionsText: \'displayName\',\r\n                           optionsCaption: \'Assignee\'"></select>\r\n    </div>\r\n    <!-- /ko -->\r\n\r\n    <!-- ko ifnot: hideAssignments -->\r\n    <div class="assignment-dialog-link block">\r\n        <a data-bind="click: showAssignmentsDialog,\r\n                      text: translate(\'STATE_MGT_SHOW_ASSIGN_DLG\')">\r\n        </a>\r\n    </div>\r\n    <!-- /ko -->\r\n\r\n    <div class="done-control block">\r\n        <button type="button"\r\n                class="btn btn-text"\r\n                data-bind="text: translate(\'DONE\'),\r\n                           enable: canClickDone,\r\n                           click: done"></button>\r\n    </div>\r\n</div>\r\n';});

define('ui/elements/state-transition/popover-content-view-model',['require','lodash','knockout','system/lang/event','spa/ko/knockout-view-model','system/knockout/knockout-manager','system/globalization/translator','state-management/state-assignment-dialog','state-management/adapters/operation-adapter','state-management/model/operation-model','text!./popover-content.html','system/lang/object'],function(require){"use strict";var a=require("lodash"),b=require("knockout"),c=require("system/lang/event"),d=require("spa/ko/knockout-view-model"),e=require("system/knockout/knockout-manager"),f=require("system/globalization/translator"),g=require("state-management/state-assignment-dialog"),h=require("state-management/adapters/operation-adapter"),i=require("state-management/model/operation-model"),j=require("text!./popover-content.html");require("system/lang/object");function k(){l.call(this,j),this.kom=Object.resolve(e),this.translator=Object.resolve(f),this.stateAssignmentDialog=Object.resolve(g),this.transition=null,this.assignments=null,this.entityKey=null,this.disableTransition=null,this.hideAssignments=null,this.hiddenOperations=null,this.hideReservedOperations=null,this.canDisplaySuccessors=null,this.selectedSuccessor=null,this.successorAssignment=null,this.canClickDone=null,this.availableSuccessors=null,this.doneEvent=new c,this.closeEvent=new c,
this.assignmentsChanged=new c,this.region=null}var l=Object.inherit(d,k);k.prototype.activate=function(){this.canDisplaySuccessors=this.kom.pureComputed(o.bind(null,this)),this.selectedSuccessor=this.kom.pureComputed(m.bind(null,this)),this.successorAssignment=this.kom.pureComputed(r.bind(null,this)),this.canClickDone=this.kom.pureComputed(t.bind(null,this)),this.availableSuccessors=this.kom.pureComputed(p.bind(null,this))},k.prototype.attach=function(a){this.region=a,l.prototype.attach.apply(this,arguments)},k.prototype.deactivate=function(){this.kom.dispose()},k.prototype.detach=function(){l.prototype.detach.apply(this,arguments)},k.prototype.selectOperation=function a(c,d){var e=b.dataFor(d.target);this.disableTransition&&this.disableTransition()||e instanceof i&&(this.selectedSuccessor&&this.selectedSuccessor()&&this.selectedSuccessor().isSelected(!1),e.isSelected(!0))},k.prototype.showAssignmentsDialog=function(){
this.hideAssignments&&this.hideAssignments()||this.entityKey&&this.entityKey()&&(this.stateAssignmentDialog.show(this.entityKey()).done(this.assignmentsChanged.raise.bind(this.assignmentsChanged)),this.closeEvent.raise())},k.prototype.done=function(){this.disableTransition&&this.disableTransition()||this.selectedSuccessor&&this.selectedSuccessor()&&this.doneEvent.raise(h.toDTO(this.selectedSuccessor()))},k.prototype.translate=function(a){return this.translator.translate(a)};function m(b){if(b.transition&&b.transition()&&b.transition().successors&&b.transition().successors()&&b.transition().successors().length)return a.find(b.transition().successors(),n)}function n(a){return a.isSelected()}function o(a){return a.transition&&a.transition()&&a.transition().successors&&a.transition().successors()&&a.transition().successors().length}function p(b){if(b.canDisplaySuccessors())return a.filter(b.transition().successors(),q.bind(null,b.hiddenOperations(),b.hideReservedOperations()))}
function q(b,c,d){var e=c&&d.isReserved(),f=a.includes(b,d.id());return!(e||f)}function r(b){if(b.assignments&&b.assignments()&&b.selectedSuccessor&&b.selectedSuccessor())return a.find(b.assignments(),s.bind(null,b))}function s(a,b){return a.selectedSuccessor().key()===b.state().key()}function t(a){return(!a.disableTransition||!a.disableTransition())&&!(!a.selectedSuccessor||!a.selectedSuccessor())}return k});

define('text!ui/elements/state-transition/view.html',[],function () { return '<section class="mi-state-trans-container">\r\n    <button type="button"\r\n            class="btn mi-state-trans"\r\n            data-bind="disable: isReadOnly, click: togglePopover">\r\n        <span class="active-state"\r\n              data-bind="text: activeState"></span>\r\n        <i class="icon-arrow pull-right"></i>\r\n        <br />\r\n        <!-- ko if: assignmentOverride -->\r\n            <span class="assigned-user"\r\n                  data-bind="text: assignmentOverride"></span>\r\n        <!-- /ko -->\r\n        <!-- ko ifnot: assignmentOverride -->\r\n            <!-- ko if: activeAssignmentUser -->\r\n            <span class="assigned-user"\r\n                  data-bind="text: activeAssignmentUser"></span>\r\n            <!-- /ko -->\r\n            <!-- ko ifnot: activeAssignmentUser -->\r\n            <span class="assigned-user no-assignment"\r\n                  data-bind="text: translate(\'NOT_ASSIGNED\')">\r\n            </span>\r\n            <!-- /ko -->\r\n        <!-- /ko -->\r\n    </button>\r\n</section>';});

define('ui/elements/state-transition/view-model',['require','lodash','jquery','spa/ko/knockout-view-model','system/knockout/knockout-manager','application/application-events','system/error/error-message','system/globalization/translator','spa/region','spa/conductor','system/lang/event','state-management/services/state-management-service','state-management/adapters/transition-adapter','state-management/adapters/assignment-adapter','state-management/adapters/operation-adapter','./popover-content-view-model','text!./view.html','bluebird','system/lang/object'],function(require){"use strict";var a=require("lodash"),b=require("jquery"),c=require("spa/ko/knockout-view-model"),d=require("system/knockout/knockout-manager"),e=require("application/application-events"),f=require("system/error/error-message"),g=require("system/globalization/translator"),h=require("spa/region"),i=require("spa/conductor"),j=require("system/lang/event"),k=require("state-management/services/state-management-service"),l=require("state-management/adapters/transition-adapter"),m=require("state-management/adapters/assignment-adapter"),n=require("state-management/adapters/operation-adapter"),o=require("./popover-content-view-model"),p=require("text!./view.html"),q=require("bluebird");require("system/lang/object");function r(){s.call(this,p),this.kom=Object.resolve(d),this.appEvents=Object.resolve(e),this.translator=Object.resolve(g),this.popoverContentRegion=Object.resolve(h),this.popoverContentViewModel=Object.resolve(o),this.conductor=Object.resolve(i),
this.service=Object.resolve(k),this.kom.tracker.hashFunction=S.bind(null,this),this.isDirty=this.kom.tracker.isDirty,this.entityKey=this.kom.observable(),this.assignmentOverride=this.kom.observable(),this.disable=this.kom.observable(!1),this.disableTransition=this.kom.observable(!1),this.hideAssignments=this.kom.observable(!1),this.hiddenOperations=this.kom.observableArray(),this.transition=this.kom.observable(),this.assignments=this.kom.observableArray(),this.hideReservedOperations=this.kom.observable(!1),this.popoverContentViewModel.transition=this.transition,this.popoverContentViewModel.assignments=this.assignments,this.popoverContentViewModel.entityKey=this.entityKey,this.popoverContentViewModel.disableTransition=this.disableTransition,this.popoverContentViewModel.hideAssignments=this.hideAssignments,this.popoverContentViewModel.hiddenOperations=this.hiddenOperations,this.popoverContentViewModel.hideReservedOperations=this.hideReservedOperations,
this.popoverContentViewModel.doneEvent.add(z.bind(null,this),this),this.popoverContentViewModel.closeEvent.add(D.bind(null,this),this),this.popoverContentViewModel.assignmentsChanged.add(C.bind(null,this),this),this.isLoading=this.kom.observable(!0),this.activeAssignment=this.kom.pureComputed(E.bind(null,this)),this.activeState=this.kom.pureComputed(G.bind(null,this)),this.activeAssignmentUser=this.kom.pureComputed(H.bind(null,this)),this.isReadOnly=this.kom.pureComputed(I.bind(null,this)),this.kom.subscribe(this.entityKey,J.bind(null,this)),this.$popoverTarget=null,this.region=null,this.popoverContainer=null,this.beforeStateChanged=new j,this.stateChanged=new j}var s=Object.inherit(c,r);r.prototype.attach=function(a){this.region=a,s.prototype.attach.apply(this,arguments),Element.upgrade("mi-state-transition",this.region)},r.prototype.detach=function(){y(this,this.$popoverTarget),this.popoverContainer&&(this.popoverContainer.detach(),this.popoverContainer=null),
this.popoverContentViewModel.doneEvent.remove(),this.kom.dispose()},r.prototype.showPopover=function(a,c){var d=b(c.target);c.stopPropagation(),d=d.is("button")?d:d.parent("button"),v(this,d)},r.prototype.hidePopover=function(a,c){if(!c)return void w(this,this.$popoverTarget);var d=b(c.target);d=d.is("button")?d:d.parent("button"),w(this,d)},r.prototype.togglePopover=function(a,c){var d=b(c.target),e;this.isLoading()||(d=d.is("button")?d:d.parent("button"),e=d.data("bs.popover"),e&&e.$tip&&e.$tip.hasClass("in")?this.hidePopover(e,c):this.showPopover(e,c))},r.prototype.translate=function(a){return this.translator.translate(a)};function t(a){a.$popoverTarget&&w(a,a.$popoverTarget)}function u(a){a.stopPropagation()}function v(a,c){var d=Element.build("div",a.region.$element.get(0),["state-popover-content"],{"data-bind":"halt-bindings: {}"});a.popoverContentRegion.setElement(d),a.conductor.changeScreen(a.popoverContentViewModel,a.popoverContentRegion),
b(document).on("click.stateTransitionPopover.hide",t.bind(null,a)),b(d).on("click",u),c.data("bs.popover")||c.popover({template:'<div class="mi-state popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',placement:"bottom",trigger:"manual",container:"body",html:!0,content:d}),c.popover("show"),a.$popoverTarget=c,c.data("bs.popover")&&(a.popoverContainer=c.data("bs.popover").$tip)}function w(a,b){b&&b.data("bs.popover")&&y(a,b)}function x(a,c){b(document).off("click.stateTransitionPopover.hide"),c.popover().off("hidden.bs.popover"),c.popover("destroy"),a.conductor.clearScreen(a.popoverContentRegion),a.$popoverTarget=null}function y(a,b){b&&(b.popover().on("hidden.bs.popover",x.bind(null,a,b)),b.popover("hide"))}function z(a,b){var c=n.toModelObject(b),d;w(a,a.$popoverTarget),a.transition().operation(c),d={transitionData:l.toDTO(a.transition()),cancel:!1,promise:null},a.beforeStateChanged.raise(d),
d.cancel||q.resolve(d.promise).then(B.bind(null,a)).catch(A)}function A(){}function B(a){a.isLoading(!0),a.service.postTransition(l.toDTO(a.transition())).done(N.bind(null,a)).fail(Q.bind(null,a))}function C(a){var b=a.transition().entityKey();a.service.getAssignments(b).done(L.bind(null,a)).fail(Q.bind(null,a))}function D(a){w(a,a.$popoverTarget)}function E(b){if(b.assignments&&b.assignments()&&b.transition&&b.transition()&&b.transition().activeState&&b.transition().activeState())return a.find(b.assignments(),F.bind(null,b))}function F(a,b){return a.transition().activeState().key()===b.state().key()}function G(a){if(a.transition&&a.transition()&&a.transition().activeState&&a.transition().activeState()&&a.transition().activeState().caption&&a.transition().activeState().caption())return a.transition().activeState().caption()}function H(a){
if(a.activeAssignment&&a.activeAssignment()&&a.activeAssignment().assignedUser&&a.activeAssignment().assignedUser())return a.activeAssignment().assignedUser().displayName()}function I(a){var b=a.disable(),c=a.transition()&&a.transition().isEditable();return b||!c}function J(a,b){K(a,b)}function K(a,c){var d,e;c&&(a.isLoading(!0),d=a.service.getTransition(c).done(M.bind(null,a)).fail(Q.bind(null,a)),e=a.service.getAssignments(c).done(L.bind(null,a)).fail(Q.bind(null,a)),b.when(d,e).done(P.bind(null,a)))}function L(a,b){var c=m.toModelObjectArray(b);a.assignments(c),a.kom.tracker.markCurrentStateAsClean()}function M(a,b){a.transition(l.toModelObject(b))}function N(a){var c=a.service.getTransition(a.entityKey()).done(M.bind(null,a)).fail(Q.bind(null,a));b.when(c).done(O.bind(null,a))}function O(a,b){var c={transitionData:b};a.stateChanged.raise(c),P(a)}function P(a){a.isLoading(!1)}function Q(a,b){R(a,b.responseText),P(a)}function R(a,b){var c=2,d=b,e=new f(c,d)
;a.appEvents.errorOccured.raise(a,e)}function S(a){var b={};if(a.selectedSuccessor&&a.selectedSuccessor())return b.selectedSuccessor=a.selectedSuccessor().key(),JSON.stringify(b)}return r});
define('ui/elements/state-transition/component',['require','spa/region','spa/conductor','./view-model','system/lang/object'],function(require){"use strict";var a=require("spa/region"),b=require("spa/conductor"),c=require("./view-model"),d={};require("system/lang/object"),d.prototype=Object.create(HTMLElement.prototype),d.prototype.createdCallback=function(){var d,e,f,g,h,i,j;this.attached=!1,this.conductor=Object.resolve(b),this.region=new a,this.viewModel=Object.resolve(c),d=Element.stringAttribute(this,"entitykey"),Element.defineProperty(this,"entitykey",{get:this.viewModel.entityKey,set:this.viewModel.entityKey}),d&&(this.entitykey=d),j=Element.stringAttribute(this,"assignmentoverride"),Element.defineProperty(this,"assignmentoverride",{get:this.viewModel.assignmentOverride,set:this.viewModel.assignmentOverride}),j&&(this.assignmentoverride=j),e=Element.booleanAttribute(this,"disable"),Element.defineProperty(this,"disable",{get:this.viewModel.disable,set:this.viewModel.disable}),e&&(this.disable=e),f=Element.booleanAttribute(this,"disabletransition"),Element.defineProperty(this,"disabletransition",{
get:this.viewModel.disableTransition,set:this.viewModel.disableTransition}),f&&(this.disabletransition=f),g=Element.booleanAttribute(this,"hideassignments"),Element.defineProperty(this,"hideassignments",{get:this.viewModel.hideAssignments,set:this.viewModel.hideAssignments}),g&&(this.hideassignments=g),i=Element.booleanAttribute(this,"hidereservedops"),Element.defineProperty(this,"hidereservedops",{get:this.viewModel.hideReservedOperations,set:this.viewModel.hideReservedOperations}),i&&(this.hidereservedops=i),h=Element.stringAttribute(this,"hiddenops"),Element.defineProperty(this,"hiddenops",{get:this.getHiddenOps,set:this.setHiddenOps}),h&&(this.hiddenops=h)},d.prototype.attachedCallback=function(){this.attached=!0,Element.clearDom(this);var a=Element.build("section",this,["fill"],{"data-bind":"halt-bindings: {}"});this.region.setElement(a),this.conductor.changeScreen(this.viewModel,this.region),this.viewModel.beforeStateChanged.add(this.beforeStateChanged,this),
this.viewModel.stateChanged.add(this.stateChanged,this)},d.prototype.hideStatePopup=function(){this.viewModel.hidePopover(this)},d.prototype.detachedCallback=function(){this.attached=!1,this.conductor.clearScreen(this.region),this.viewModel.beforeStateChanged.remove(this),this.viewModel.stateChanged.remove(this)},d.prototype.beforeStateChanged=function(a){Element.raiseEvent(this,"beforeStateChanged",a)},d.prototype.stateChanged=function(a){Element.raiseEvent(this,"stateChanged",a)},d.prototype.attributeChangedCallback=function(a,b,c){Object.tryMethod(this,a+"Changed",b,c)},d.prototype.entitykeyChanged=function(a,b){this.entitykey=b},d.prototype.assignmentoverrideChanged=function(a,b){this.assignmentoverride=b},d.prototype.disableChanged=function(a,b){this.disable=null!==b},d.prototype.disabletransitionChanged=function(a,b){this.disabletransition=null!==b},d.prototype.hideassignmentsChanged=function(a,b){this.hideassignments=null!==b},d.prototype.hidereservedopsChanged=function(a,b){
this.hidereservedops=null!==b},d.prototype.hiddenopsChanged=function(a,b){this.hiddenops=b},d.prototype.getHiddenOps=function(){return JSON.stringify(this.viewModel.hiddenOperations())},d.prototype.setHiddenOps=function(a){var b;a=a||"[]",b=e(a)?JSON.parse(a):f(a),this.viewModel.hiddenOperations(b)};function e(a){try{return JSON.parse(a),!0}catch(a){return!1}}function f(a){var b=a.split(","),c=0;for(c=0;c<b.length;c++)b[c]=b[c].trim();return b}return Element.registerElement("mi-state-transition",{prototype:d.prototype}),d});

define('text!ui/elements/ref-doc/views/refdoc-container.html',[],function () { return '<div class="refdoc-container">\r\n    <mi-resultgrid allowcolumnresizing=true\r\n                   allowcolumnreordering=true\r\n                   selectionmode=\'multiple\'\r\n                   showgroupingpanel=false\r\n                   showrowfilter=true>\r\n    </mi-resultgrid>\r\n</div>\r\n';});

define('ui/elements/ref-doc/models/path-validator',['require','system/lang/object'],function(require){"use strict";require("system/lang/object");function a(){}return a.prototype.isValidUrl=function a(b){var c=/^http:\/\//,d=/^https:\/\//;return null!==b&&void 0!==b&&""!==b&&0!==b.length&&!(!c.test(b)&&!d.test(b))},a.prototype.isValidUncPath=function a(b){var c=/^\\\\/;if(null===b||void 0===b||""===b||0===b.length)return!1;if(""===b||0===b.length||b.length>32767)return!1;if(c.test(b)){var d=b.replace(/^(\\\\)/,"");if(0===d.length)return!1;if(/[. \\]$/.test(d))return!1;var e=d.split("\\");if(0===e.length)return!1;var f=e[0],g=/[<>:"\/|?*]/;if(g.test(f))return!1;e.splice(0,1);for(var h=0;h<e.length;h++){var i=e[h];if(g.test(i))return!1}return!0}return!1},a});
define('ui/elements/ref-doc/models/refdoc-model',['require','knockout'],function(require){"use strict";var a=require("knockout");function b(a){a=a||{},this.name=a.name,this.desc=a.desc,this.addedBy=a.addedBy||"-",this.addedOn=a.addedOn||"-"}return b});
define('ui/elements/ref-doc/models/refdoc-collection',['require','lodash','knockout','./path-validator','./refdoc-model'],function(require){"use strict";var a=require("lodash"),b=require("knockout"),c=require("./path-validator"),d=require("./refdoc-model");function e(){this.validator=Object.resolve(c),this.refdocs=[]}e.prototype.populate=function(a){var b,c,d,e,h,i,j,k,l,m,n;for(this.refdocs=[],b=0;b<a.length;b++)c=f(a[b].fields,"CTIT_ID"),d=f(a[b].fields,"CTIT_DESC_TX"),e=f(a[b].fields,"MI_REF_DOCUMENTS_STORE_BY_C"),h=f(a[b].fields,"MI_REF_DOCUMENTS_LAST_UPDAT_DATE_D"),j=f(a[b].fields,"MI_REF_DOCUMENTS_STORE_DOCUM_L"),l=f(a[b].fields,"MIRD_DOC_PATH_CHR"),n=!!this.validator.isValidUrl(l.value),m=!!this.validator.isValidUncPath(l.value),l=g(l.value),i=a[b].key,k=j.value===!0||"True"===j.value||"true"===j.value,this.refdocs.push({key:i,name:c.value||"-",desc:d.value||"-",addedBy:e.value||"-",addedOn:h.displayValue||"-",isStoredDocument:k,docType:l,isURL:n,isUncPath:m})};function f(b,c){return a.find(b,function(a){return a.id===c})}function g(a){var b=a.split(".");return b[b.length-1]}return e});

define('text!search/views/search-finder.html',[],function () { return '<section class="global-search-finder">\r\n    <div class="block-group">\r\n        <mi-select name="families"></mi-select>\r\n        <mi-select name="relationships"></mi-select>\r\n        <div class="input-group block-group">\r\n            <input type="text" class="form-control search-term block" />\r\n            <div class="btn-group search-options block" dropdown data-bind="click: searchOptionsClicked">\r\n                <button type="button" class="btn search-options-current-selection"><i class="icon-global-search"></i></button>\r\n                <button type="button" class="btn dropdown-toggle" dropdown-toggle><span class="caret"></span></button>\r\n                <ul class="dropdown-menu search-options-list" role="menu">\r\n                    <li><button class="btn"><i class="icon-text-asterisk"></i></button></li>\r\n                </ul>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <section class="search-message">\r\n        <span></span>\r\n    </section>\r\n    <section class="global-search-results">\r\n        <ul class="list-group">\r\n        </ul>\r\n    </section>\r\n    <button type="button" class="btn btn-text btn-ok pull-right"></button>\r\n    <button type="button" class="btn btn-text btn-secondary btn-cancel pull-right" style="margin-right:5px;"></button>\r\n\r\n</section>\r\n';});

define('search/search-finder',['require','jquery','system/globalization/translator','system/ui/dialog-view-model','search/ui-utils','search/search-view-model','search/related-entity-view-model','text!./views/search-finder.html','ramda'],function(require){"use strict";var a=require("jquery"),b=require("system/globalization/translator"),c=require("system/ui/dialog-view-model"),d=require("search/ui-utils"),e=require("search/search-view-model"),f=require("search/related-entity-view-model"),g=require("text!./views/search-finder.html"),h=require("ramda");function i(){this.translator=Object.resolve(b),this.dfd=null,this.dialog=null,this.element=null,this.settings={multiSelect:!1,selectRelated:!0,families:null,relationships:null,defaultFamily:null,defaultRelationship:null,initialSearch:null,autoSearch:!1,entityKeys:null,siteKeys:null,selectionRequired:!1,excludeSucc:null,excludePred:null},this.searchViewModel=new e,this.searchOptionOpened=!1,this.closeSearchOptionsHandler=m.bind(null,this)}i.prototype.show=function(b){var d={height:"90%",width:"90%"},e=b.title||this.translator.translate("SEARCH");return this.dialog=new c(this,e,d),b=b||{},this.settings.multiSelect=b.multiSelect===!0,
this.settings.selectRelated=b.selectRelated===!0,this.settings.families=b.families||[],this.settings.relationships=b.relationships||[],this.settings.defaultFamily=b.defaultFamily,this.settings.defaultRelationship=b.defaultRelationship,this.settings.initialSearch=b.initialSearch||"",this.settings.autoSearch=b.autoSearch===!0,this.settings.entityKeys=b.entityKeys||[],this.settings.siteKeys=b.siteKeys||[],this.settings.selectionRequired=b.selectionRequired===!0,this.settings.excludeSucc=b.excludeSucc||[],this.settings.excludePred=b.excludePred||[],this.searchViewModel.hasRelationship=!(b.hasRelationship===!1),this.searchViewModel.exactFamilyMatch=b.exactFamilyMatch===!0,this.dfd=a.Deferred(),this.dialog.show(),this.dfd.promise()},i.prototype.attach=function(b){var c,d,e,f=this.translator.translate("CANCEL");b.attach(a(g)),e=a(b.element).find("mi-select"),Element.upgrade(e),this.element=b.element,d=this.element.querySelector("input"),d.value=this.settings.initialSearch,
d.addEventListener("change",this),this.element.querySelector("input.search-term").addEventListener("keypress",this),this.element.addEventListener("click",this),this.element.querySelector(".global-search-results").addEventListener("scroll",this),j(this),this.element.querySelector("button.btn-cancel").appendChild(document.createTextNode(f)),c=this.element.querySelector('mi-select[name="families"]'),this.searchViewModel.loadFamilies().done(C.bind(null,this)),e.on("valueChange",this.handleEvent.bind(this))};function j(a){var b,c=a.translator.translate("OK");b=a.element.querySelector("button.btn-ok"),b.appendChild(document.createTextNode(c)),b.disabled=a.settings.selectionRequired}i.prototype.detach=function(b){this.element.querySelector("input").removeEventListener("change",this),this.element.removeEventListener("click",this),this.element.querySelector(".global-search-results").removeEventListener("scroll",this),a(this.element).find("mi-select").off(),b.clear(),
"resolved"!==this.dfd.state()&&this.dfd.reject()},i.prototype.handleEvent=function(a){var b;if(k(this,a),"valueChange"===a.type)"MI-SELECT"===a.target.tagName&&"families"===a.target.getAttribute("name")&&E(this,a.target),y(this);else if("scroll"===a.type)(b=this.searchViewModel.listScrolled(a))&&b.done(A.bind(null,this));else if("keypress"===a.type){var c=a.which||a.keyCode;13===c&&(a.preventDefault(),y(this))}};function k(a,b){"click"===b.type&&(l(a,b),n(a,b),q(a,b),r(a,b),s(a,b),t(a,b),v(a,b))}function l(a,b){var c=b.target.classList.contains("caret"),d="BUTTON"===b.target.nodeName&&!h.isNil(b.target.querySelector(".caret"));(c||d)&&(x(a),a.searchOptionOpened=!a.searchOptionOpened,a.searchOptionOpened?window.addEventListener("click",a.closeSearchOptionsHandler):window.removeEventListener("click",a.closeSearchOptionsHandler))}function m(a,b){var c=a.element.querySelector(".btn-group.search-options"),d=!h.isNil(c)&&c.contains(b.target),e=!h.isNil(c);e&&!d?(x(a,!1),
a.searchOptionOpened=!1,window.removeEventListener("click",a.closeSearchOptionsHandler)):e||window.removeEventListener("click",a.closeSearchOptionsHandler)}function n(a,b){var c=a.element.querySelector(".dropdown-menu.search-options-list").contains(b.target),d="I"===b.target.nodeName,e=1===b.target.querySelectorAll("i").length;if(c&&(d||e)){"icon-global-search"===p(b.target)&&o(a),x(a)}}function o(a){var b=a.element.querySelector(".search-options > button.search-options-current-selection > i"),c=a.element.querySelector(".dropdown-menu.search-options-list > li > button > i");b.classList.add("icon-global-search"),c.classList.remove("icon-global-search")}function p(a){return"I"===a.nodeName?a.className:a.querySelector("i").className}function q(a,b){a.element.querySelector(".btn.search-options-current-selection").contains(b.target)&&y(a)}function r(a,b){b.target.classList.contains("btn-ok")&&B(a)}function s(a,b){b.target.classList.contains("btn-cancel")&&a.dialog.closeDialog()}
function t(a,b){u(b.target)&&(b.preventDefault(),b.cancelBubble=!0,G(a,b))}function u(a){return"A"===a.tagName&&!!a.parentElement.classList.contains("relationship-links")}function v(a,b){w(b.target,"MI-RADIO-NOKO","MI-CHECKBOX-NOKO")&&a.settings.selectionRequired&&(a.element.querySelector("button.btn-ok").disabled=!a.element.querySelector("input:checked"))}function w(a){var b=Array.prototype.slice.call(arguments,1);return!!a&&(b.indexOf(a.nodeName)>-1||!!a.parentElement&&(b.unshift(a.parentElement),w.apply(null,b)))}function x(a,b){var c=a.element.querySelector(".dropdown-menu.search-options-list");return b===!0?void(c.style.display="block"):b===!1?void(c.style.display=""):void(""===c.style.display?c.style.display="block":c.style.display="")}function y(a){var b,c,e,f,g=a.element.querySelector(".global-search-results .list-group"),h=a.element.querySelector("input.search-term"),i;a.settings.autoSearch=!1,a.searchViewModel.cancelSearch(),z(a,""),g.scrollTop=0,g.innerHTML="",
b=d.getValueFromMiSelect(a.element.querySelector('mi-select[name="families"]')),b?c=[b]:a.settings.families.length>0&&(c=a.settings.families),e=d.getValueFromMiSelect(a.element.querySelector('mi-select[name="relationships"]')),e?(f=[],f[0]=e):a.settings.relationships.length>0&&(f=a.settings.relationships),i=a.searchViewModel.newSearch(h.value,c,f,a.settings.entityKeys,a.settings.siteKeys,a.settings.excludeSucc,a.settings.excludePred),i?i.done(A.bind(null,a)):z(a,a.translator.translate("INVALID_SEARCH"))}function z(a,b){a.element.querySelector(".search-message span").innerHTML=b,a.element.querySelector(".search-message").style.display="block",a.element.querySelector(".global-search-results").style.height="calc(100% - 90px)"}function A(a,b){var c,e,f,g,h,i,j;if(a.element.querySelector(".global-search-results .list-group")){if(j=a.element.querySelector(".global-search-results .list-group").children,0===j.length&&0===b.data.length)return void z(a,a.translator.translate("NO_RESULTS"))
;if(a.element.querySelector(".search-message").style.display="none",a.element.querySelector(".global-search-results").style.height="calc(100% - 45px)",d.setRecordCount(a.element.querySelector(".search-message span"),b),i=a.element.querySelector(".global-search-results .list-group"))for(h=0;h<b.data.length;h++)c=document.createElement("li"),c.classList.add("list-group-item"),c.mi_data=b.data[h],f=document.createElement("div"),f.classList.add("block-group"),f.appendChild(d.selector(a.settings.multiSelect)),g=document.createElement("div"),g.classList.add("result"),e=document.createElement("h4"),e.classList.add("list-group-item-heading"),e.appendChild(document.createTextNode(b.data[h].description)),g.appendChild(e),g.appendChild(d.familyElement(b.data[h])),b.data[h].relatedEntities&&g.appendChild(d.relatedEntities(b.data[h])),f.appendChild(g),c.appendChild(f),i.appendChild(c)}}function B(a){var b=[],c,d,e=a.element.querySelectorAll("input:checked");for(c=0;c<e.length;c++){
for(d=e[c];d&&"LI"!==d.nodeName;)d=d.parentElement;b[b.length]=d.mi_data}a.dfd.resolve(b),a.dialog.closeDialog()}function C(a){var b=D(a.searchViewModel.families,a.settings.families),c=a.element.querySelector('mi-select[name="families"]'),e=a.element.querySelector('mi-select[name="relationships"]'),f,g;c&&e&&(g=a.searchViewModel.hasRelationship?a.translator.translate("SEARCH_LINKED_TO"):a.translator.translate("SEARCH_EXCLUDE_FROM"),d.loadSelect(c,a.translator.translate("SEARCH_All_FAMILIES"),a.translator.translate("SEARCH_LOOK_IN"),a.settings.defaultFamily,b),1===b.length||a.settings.defaultFamily?E(a,c):a.settings.relationships.length>0?(f=D(a.searchViewModel.families,a.settings.relationships),d.loadSelect(e,a.translator.translate("SEARCH_All_FAMILIES"),g,a.settings.defaultRelationship,f),a.settings.autoSearch&&y(a)):a.settings.autoSearch&&y(a))}function D(a,b){var c,d,e;if(b&&b.length>0){for(e=[],c=0;c<b.length;c++)for(d=0;d<a.length;d++)if(a[d].key===b[c]){e[e.length]=a[d];break}
}else e=a;return e}function E(a,b){var c=a.element.querySelector('mi-select[name="relationships"]'),e=D(a.searchViewModel.families,a.settings.relationships),f,g,h;c&&(g=a.searchViewModel.hasRelationship?a.translator.translate("SEARCH_LINKED_TO"):a.translator.translate("SEARCH_EXCLUDE_FROM"),a.settings.relationships.length>0?(d.loadSelect(c,a.translator.translate("SEARCH_All_FAMILIES"),g,a.settings.defaultRelationship,e),a.settings.autoSearch&&y(a)):(c.implementation.options([]),(h=d.getValueFromMiSelect(b))&&(f=a.searchViewModel.loadRelationships(h),f.done(F.bind(null,a,c)))))}function F(a,b,c){var e;b.implementation&&(e=a.searchViewModel.hasRelationship?a.translator.translate("SEARCH_LINKED_TO"):a.translator.translate("SEARCH_EXCLUDE_FROM"),d.loadSelect(b,a.translator.translate("SEARCH_All_FAMILIES"),e,a.settings.defaultRelationship,c),a.settings.autoSearch&&y(a))}function G(a,b){var c,d;b.target.viewModel?b.target.viewModel.visible()?b.target.viewModel.hide():(H(b.target),
b.target.viewModel.show()):(H(b.target),d={url:b.target.getAttribute("href"),selector:"none",makeLink:!1},a.settings.selectRelated&&(d.selector=a.settings.multiSelect?"multiselect":"single"),c=new f(d),c.load(b.target.parentElement),c.show(),b.target.viewModel=c)}function H(a){var b,c;for(b=a.parentElement.querySelectorAll("a"),c=0;c<b.length;c++)b[c].viewModel&&b[c].viewModel.hide()}return i});
define('system/knockout/bindings/property',['require','lodash','jquery','knockout'],function(require){"use strict";var a=require("lodash"),b=require("jquery"),c=require("knockout"),d="property-changed-event-handlers";c.bindingHandlers.property||(c.bindingHandlers.property={init:function(e,f){var g,h=b(e),i={};a.each(f(),function(b,c){g=function(b,d){var e=f()[c];a.isFunction(e)&&e(d)},i[c]=g,h.on("attributes."+c+":changed",g),h.on("properties."+c+":changed",g)}),c.utils.domData.set(e,d,i),c.utils.domNodeDisposal.addDisposeCallback(e,function(){var b=c.utils.domData.get(e,d);a.each(f(),function(a,c){h.off("attributes."+c+":changed",b[c]),h.off("properties."+c+":changed",b[c])})})},update:function(b,d){var e;a.each(d(),function(a,d){e=c.unwrap(a),b[d]=e})}})});
define('system/lang/element',['require','lodash','jquery','jquery','knockout','system/lang/converter','system/knockout/knockout-manager','system/knockout/bindings/halt-bindings','system/knockout/bindings/property'],function(require){"use strict";var a=require("lodash"),b=require("jquery"),c=require("jquery"),d=require("knockout"),e=require("system/lang/converter"),f=require("system/knockout/knockout-manager");require("system/knockout/bindings/halt-bindings"),require("system/knockout/bindings/property"),Element.registeredElements={};function g(){var a=Array.prototype.slice.call(arguments,0),b=a[0];Element.registeredElements[b]?console.warn("Attemted to register element "+b+" after it was already registered"):(document.registerElement.apply(document,a),Element.registeredElements[b]=!0)}function h(a,b){var c=Object.create(HTMLElement.prototype);c.createdCallback=function(){this.implementation=Object.resolve(b),this.implementation.element=this,Object.tryMethod(this.implementation,"created")},c.attachedCallback=function(){Object.tryMethod(this.implementation,"attached")},c.detachedCallback=function(){Object.tryMethod(this.implementation,"detached")},c.attributeChangedCallback=function(a,b,c){
Object.tryMethod(this.implementation,a+"Changed",b,c)},document.registerElement(a,{prototype:c})}var i=function(){function a(a,b,c){this.kom=Object.resolve(f),this.properties=[],this.view=a,this.preserveContext=b||!1,this.appendAfterBindings=c||!1,this.container=null,this.element=null}a.prototype.created=function(){Object.tryMethod(this,"beforeCreated"),c(this),Object.tryMethod(this,"afterCreated")},a.prototype.attached=function(){Object.tryMethod(this,"beforeAttached"),e(this),Object.tryMethod(this,"afterAttached")},a.prototype.detached=function(){Object.tryMethod(this,"beforeDetached"),g(this),Object.tryMethod(this,"afterDetached")},a.prototype.bindAttribute=function(a,c,d){this[a]=this.kom.observable(),this[a+"Changed"]=function(b,c){this[a](c)}.bind(this),this.kom.subscribe(this[a],function(c){b(this.element).trigger("attributes."+a+":changed",[c])},this),d&&this.kom.subscribe(this[a],d,this),this[a](Object.defaultValue(this.element.getAttribute(a),c))},
a.prototype.bindProperty=function(a,c,d,e){this[a]=this.kom.observable();var f=e||!1;Object.defineProperty(this.element,a,{get:function(){return this[a]()}.bind(this),set:function(b){this[a](b)}.bind(this)}),this.properties.push(a),this.kom.subscribe(this[a],function(c){f||b(this.element).trigger("properties."+a+":changed",[c])},this),d&&this.kom.subscribe(this[a],d,this),this[a](Object.defaultValue(this.element[a],c))},a.prototype.bindArrayProperty=function(a,c,d,e){this[a]=this.kom.observableArray();var f=e||!1;Object.defineProperty(this.element,a,{get:function(){return this[a]()}.bind(this),set:function(b){this[a](b)}.bind(this)}),this.properties.push(a),this.kom.subscribe(this[a],function(c){f||b(this.element).trigger("properties."+a+":changed",[c])},this),d&&this.kom.subscribe(this[a],d,this),this[a](Object.defaultValue(this.element[a],c))};function c(a){var c=document.createElement("div"),d=b(c),e=b(a.view);a.preserveContext||d.attr("data-bind","halt-bindings"),d.append(e),
a.appendAfterBindings||b(a.element).empty().append(d),a.container=c}function e(a){d.applyBindingsToDescendants(a,a.container),a.appendAfterBindings&&b(a.element).empty().append(a.container)}function g(a){d.cleanNode(a.container),b(a.container).remove(),a.kom.dispose(),a.properties.forEach(h.bind(null,a))}function h(a,b){delete a[b]}return a}();function j(b,d){window.CustomElements&&(window.CustomElements.useNative||(a.isArray(b)?k(b,d):a.isString(b)?l(b,d):b instanceof c?m(b):n(b)))}function k(a,b){for(var c=0;c!==a.length;c++)j(a[c],b)}function l(a,c){c&&c.$element&&(c=c.$element),m(b(a,c))}function m(a){a.each(function(a,b){n(b)})}function n(a){window.CustomElements.upgrade(a)}function o(b,c,d,e,f){var g,h=document.createElement(b);if(d)for(g=0;g!==d.length;g++)h.classList.add(d[g]);return e&&a.each(e,function(a,b){e.hasOwnProperty(b)&&h.setAttribute(b,a)}),f&&(h.textContent=f),c&&c.appendChild(h),h}function p(a,b){return null!==a.getAttribute(b)}function q(a,b,c){
var d=a.getAttribute(b);return d?e.toInteger(d):c}function r(a,b,c){var d=a.getAttribute(b);return d?e.toString(d):c}function s(a){for(;a.firstChild;)a.removeChild(a.firstChild)}function t(a,b,c){var d=a[b];Object.defineProperty(a,b,c),a[b]=d}function u(a,b,c){a.dispatchEvent(new CustomEvent(b,{detail:c}))}function v(a){a.parentNode&&a.parentNode.removeChild(a)}var w={registerElement:g,register:h,ViewModel:i,upgrade:j,build:o,booleanAttribute:p,intAttribute:q,stringAttribute:r,clearDom:s,defineProperty:t,raiseEvent:u,detach:v};return b.extend(Element,w),w});
define('ui/elements/ref-doc/view-models/events',['require'],function(require){"use strict";function a(){this.IsValidPath=!1,this.IsLink=!1,this.AddRefSuccess=!1,this.AddRefFail=!1}return a.prototype.IsValidUrl=function a(b){return new RegExp("^(?:(?:https?|ftp)://)(?:\\S+(?::\\S*)?@)?(?:(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,})))(?::\\d{2,5})?(?:/\\S*)?$","i").test(b)},a.prototype.IsValidUnc=function a(b){return new RegExp("^[a-zA-Z]:\\.*|^\\\\.*").test(b)},a.prototype.ValidatePath=function a(b){return this.IsValidPath=this.IsValidUrl(b)||this.IsValidUnc(b),this.IsValidPath},a.prototype.IsStoredDocChecked=function a(b){return null!==b&&b.datasheet.entity.fields._byId.MI_REF_DOCUMENTS_STORE_DOCUM_L.attributes.value},a.prototype.GetPath=function a(b){var c=""
;return null!==b&&(c=b.datasheet.entity.fields._byId.MIRD_DOC_PATH_CHR.attributes.value),c},a.prototype.Reset=function a(){this.IsValidPath=!1,this.IsLink=!1,this.AddRefSuccess=!1,this.AddRefFail=!1},a});
define('ui/elements/ref-doc/views/ref-doc-container-view',['require','jquery','system/globalization/translator'],function(require){"use strict";var a=require("jquery"),b=require("system/globalization/translator");function c(a){this.translator=Object.resolve(b),this.refDocs=a}c.prototype.getView=function(){var a="",b;if(this.refDocs.length>0)for(b=0;b<this.refDocs.length;b++)a+='<section class="content block-group"  data-key="'+this.refDocs[b].key+'">',a+='<div class="block col-15"><span class="icon"><i class="'+d(this.refDocs[b])+'"></i></span>'+this.refDocs[b].name+"</div>",a+='<div class="block col-25">'+this.refDocs[b].desc+"</div>",this.refDocs[b].isStoredDocument&&""!==this.refDocs[b].docType?a+='<div class="block col-10"> <div> '+this.translator.translate("YES")+"</div></div>":a+='<div class="block col-10"> <div> '+this.translator.translate("NO")+"</div></div>",a+='<div class="block col-10"><div>'+this.refDocs[b].size+"</div></div>",
a+='<div class="block col-5"> <button class="btn btn-icon section-icon edit" title="'+this.translator.translate("EDIT")+'"> <i class="icon-edit"></i> </button></div>',a+='<div class="block col-5"> <button class="btn btn-icon section-icon unlink" title="'+this.translator.translate("UNLINK")+'"> <i class="icon-unlink"></i> </button></div>',(this.refDocs[b].isURL||this.refDocs[b].isUncPath)&&(a+='<div class="block col-5"> <button class="btn btn-icon section-icon open" title="'+this.translator.translate("OPEN_IN_NEW_WINDOW")+'"> <i class="icon-open-in-new-window"></i> </button></div>'),this.refDocs[b].isStoredDocument&&""!==this.refDocs[b].docType&&(a+='<div class="block col-5"> <button class="btn btn-icon section-icon download" title="'+this.translator.translate("DOWNLOAD")+'"> <i class="icon-download"></i> </button></div>'),a+="</section>";else a+='<section class="content block-group"> ',
a+='<section class="block text-info">'+this.translator.translate("REFDOCS_NO_REFERENCE_DOCUMENTS_AVAILABLE")+"</section>";return a};function d(a){return"pdf"===a.docType?"icon-image":"js"===a.docType?"icon-code":"xls"===a.docType||"xlsx"===a.docType?"icon-grid":"doc"===a.docType||"docx"===a.docType?"icon-doc":"jpg"===a.docType||"jpeg"===a.docType||"png"===a.docType||"bmp"===a.docType||"gif"===a.docType?"icon-image":(a.docType,"icon-doc")}return c});

define('text!ui/elements/filter/filter-template.html',[],function () { return '<div class="icon-filter-container">\r\n    <button class="icon-container btn btn-icon" data-bind="click: toggleFilter, css: {\'filter-active\': hasSelection}">\r\n        <i class="icon-collection-filter"></i>\r\n    </button>\r\n</div>\r\n';});


define('text!ui/elements/filter/generic-filter-view.html',[],function () { return '<div class="filter-container" data-bind="visible: visible,\r\n                                             css: {\'right-filter-container\': isRightOriented}">\r\n\r\n    <div class="filters" data-bind="css: {\'has-tag\': hasSelection}">\r\n        <!--<div class="clear-all" data-bind="css: {\'clear-all-active\': hasSelection}">\r\n            <a data-bind="click: $root.clearSelection,text:$root.translator.translate(\'MF_CLEAR_ALL\')"></a>\r\n        </div>-->\r\n        <div class="tag-section tag-area " data-bind="css: {\'filter-tag-active\': hasSelection}">\r\n            <!-- ko foreach: filterOptions -->\r\n            <!-- ko foreach: options -->\r\n            <!-- ko if: $data.isSelected-->\r\n            <div class="tag tag-style">\r\n                <span>\r\n                    <span data-bind="text: text"></span>\r\n                </span>\r\n                <i class="icon-close-popup" data-bind="click: $root.removeFilter.bind($data)"></i>\r\n            </div>\r\n            <!-- /ko -->\r\n            <!-- /ko -->\r\n            <!-- /ko -->\r\n        </div>\r\n        <div class="filter-content">\r\n            <div class="sort-header <!--border-active-->">\r\n                <!--<header class="header-title"> Sort by: </header>-->\r\n                <div data-bind="visible: sortOptions().length > 0" class="mi-select">\r\n                    <mi-select data-bind="miproperty:{\r\n                               options:sortOptions,\r\n                               value:sortvalue,\r\n                               optionsCaption:sortcaption\r\n                            }"></mi-select>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class="filter-header">\r\n            <header data-bind="text: $root.translator.translate(\'FILTER_HEADER_CAPTION\')"></header>\r\n            <header class="dotted-border"> </header>\r\n        </div>\r\n        <div class="filter-body" data-bind="foreach:filterOptions,css:{\'no-select\': !sortOptions().length}">\r\n            <div class="filter-section">\r\n                <header data-bind="text: caption"></header>\r\n                <div class="filter-item">\r\n                    <form class="form-item" data-bind="foreach:options">\r\n                        <div>\r\n                            <!--<input type="checkbox" data-bind="value: value, checked: isSelected" /> <span data-bind="text: text"></span>-->\r\n                            <mi-checkbox data-bind="miCheckboxProperty: {checked: isSelected, text: text}"></mi-checkbox>\r\n                        </div>\r\n                    </form>\r\n                    <div class="second-dotted-border"></div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n</div>';});

define('ui/elements/filter/filter-item',['require','knockout','system/lang/event'],function(require){"use strict";var a=require("knockout"),b=require("system/lang/event");function c(c,e){c=c||null,this.caption=e,this.value=a.observable(c.value),this.text=a.observable(c.text),this.isSelected=a.observable(c.isSelected),this.isSelected.subscribe(d.bind(null,this)),this.valueChanged=new b}function d(a,b){a.valueChanged.raise(b,a.text(),a.value())}return c});
define('ui/elements/filter/filter-group',['require','knockout','./filter-item','system/lang/event'],function(require){"use strict";var a=require("knockout"),b=require("./filter-item"),c=require("system/lang/event");function d(d){d=d||null,this.caption=d.caption,this.type=a.observable(d.type),this.options=a.observableArray(),this.valueChanged=new c;for(var f=0;f<d.options.length;f++)this.options.push(new b(d.options[f].option,this.caption)),this.options()[f].valueChanged.add(e.bind(null,this))}function e(a,b,c,d){a.valueChanged.raise(a.caption,c,b,d)}return d});
define('ui/elements/filter/filter-view-model',['require','lodash','jquery','knockout','text!./filter-template.html','text!./generic-filter-view.html','./filter-group','spa/region','system/globalization/translator','ui/elements/select/view-model','ui/elements/checkbox/checkbox-view-model'],function(require){"use strict";var a=require("lodash"),b=require("jquery"),c=require("knockout"),d=require("text!./filter-template.html"),e=require("text!./generic-filter-view.html"),f=require("./filter-group"),g=require("spa/region"),h=require("system/globalization/translator");require("ui/elements/select/view-model"),require("ui/elements/checkbox/checkbox-view-model");function i(){j.call(this,d,!1),this.translator=Object.resolve(h),this.visible=c.observable(!1),this.filterOptions=c.observableArray(),this.sortOptions=c.observableArray(),this.values=[],this.type=c.observable(),this.hasSelection=c.computed(q.bind(null,this)),this.isRightOriented=null,this.x=null,this.y=null,this.topOffset=0,this.leftOffset=0,this.genericFilterRegion=new g(null,null),this.isClicked=!1,b(document).bind("click",k.bind(null,this))}var j=Object.inherit(Element.ViewModel,i);i.prototype.beforeCreated=function(){this.bindProperty("type",null),this.bindProperty("sortvalue",null),
this.bindProperty("sortcaption",null),this.bindArrayProperty("filteroptions",null),this.bindArrayProperty("sortoptions",null),this.bindAttribute("value",null),this.bindAttribute("sortvalue",null),this.bindAttribute("sortcaption",this.translator.translate("SORT_BY")),this.bindProperty("orientation","left"),b(this.element).on("properties.sortoptions:changed",o.bind(null,this)),b(this.element).on("properties.filteroptions:changed",n.bind(null,this)),b(this.element).on("properties.type:changed",p.bind(null,this)),b(this.element).on("properties.orientation:changed",s.bind(null,this)),this.isRightOriented=c.computed(t.bind(null,this)),this.resizeProxy=b.proxy(a.debounce(this.resize,100),this),this.scrollProxy=b.proxy(this.resize,this),this.ignoreValueChange=!1};function k(a){a.isClicked?a.isClicked=!1:a.visible()&&(b(".filter-outer-container").remove(),a.visible(!1))}i.prototype.toggleFilter=function(){event.stopPropagation(),this.isClicked=!0,b(document).trigger("click"),
this.visible()?(c.cleanNode(this.genericFilterRegion.activeContainer),this.contentContainer.remove(),b(window).off("resize",this.resizeProxy),b("body").find(".content").off("scroll",this.scrollProxy)):(u(this),b(window).on("resize",this.resizeProxy),b("body").find(".content").on("scroll",this.scrollProxy)),this.visible(!this.visible())},i.prototype.removeFilter=function(a){a.isSelected(!1)},i.prototype.resize=function(){l(this),m(this)};function l(a){var c;(c=b(a.element).find(".icon-container").offset())&&(a.topOffset=c.top,a.leftOffset=c.left)}function m(a){if(a.contentContainer){var b="";window.innerWidth<a.leftOffset+250&&(a.leftOffset=a.leftOffset-215+"px",b="align-left"),a.contentContainer.css({position:"absolute",top:a.topOffset+42+"px",left:a.leftOffset}),a.contentContainer.find(".filters").addClass(b)}}i.prototype.clearSelection=function(a){var b,c,d,e;for(a.ignoreValueChange=!0,b=0;b<a.filterOptions().length;b++)for(d=a.filterOptions()[b],
c=0;c<d.options().length;c++)e=d.options()[c],e.isSelected()===!0&&e.isSelected(!1);a.values=[],a.value(""),a.ignoreValueChange=!1},i.prototype.afterDetached=function(){};function n(a,b,c){var d,e,g;if(0===a.filterOptions().length)for(d=0;d<c.length;d++)for(a.filterOptions.push(new f(c[d])),a.filterOptions()[d].valueChanged.add(r.bind(null,a)),e=0;e<c[d].options.length;e++)g=c[d].options[e].option,g.isSelected&&a.values.push(g.value)}function o(a,b,c){var d;if(c&&0===a.sortOptions().length)for(d=0;d<c.length;d++)a.sortOptions.push(c[d])}function p(a,b,c){a.type(c)}function q(a){var b,c,d,e;for(b=0;b<a.filterOptions().length;b++)for(d=a.filterOptions()[b],c=0;c<d.options().length;c++)if(e=d.options()[c],e.isSelected()===!0)return!0;return!1}function r(b,c,d,e,f){var g,h;b.ignoreValueChange||(e===!0?b.values.push(f):(h=a.findIndex(b.values,function(a){return a===f}))!==-1&&b.values.splice(h,1),g=b.values.join(),b.value(g))}function s(a,b,c){a.orientation(c)}function t(a){
return"right"===a.orientation()}function u(a){var d,f;f=b(".content-wrapper"),d=document.createElement("div"),b(d).addClass("filter-outer-container"),a.contentContainer=b(d),b(f).after(d),a.genericFilterRegion.setElement(d),a.genericFilterRegion.attach(b(e)),c.applyBindings(a,a.genericFilterRegion.activeContainer),b(".filter-outer-container").click(function(a){a.stopPropagation()}),l(a),m(a)}return Element.register("mi-filter",i),i});
define('ui/elements/ref-doc/view-models/refdoc-container-view-model',['require','lodash','jquery','knockout','text!../views/refdoc-container.html','../models/refdoc-collection','../services/service','system/lang/converter','system/ui/message-box','system/globalization/translator','logging/feedback-component/feedback-component','search/search-finder','system/lang/event','system/lang/element','../models/refdoc-path-model','./events','platform/metadata/services/metadata','application/application-context','platform/entity/services/dto/entity-dto','../views/ref-doc-container-view','ui/elements/ref-doc/view-models/downloaders/downloader','system/hardware/device','system/ui/busy-indicator','ui/elements/tool-bar/view-model','ui/elements/filter/filter-view-model','ui/elements/resultgrid/resultgrid-view-model'],function(require){"use strict";var a=require("lodash"),b=require("jquery"),c=require("knockout"),d=require("text!../views/refdoc-container.html"),e=require("../models/refdoc-collection"),f=require("../services/service"),g=require("system/lang/converter"),h=require("system/ui/message-box"),i=require("system/globalization/translator"),j=require("logging/feedback-component/feedback-component"),k=require("search/search-finder"),l=require("system/lang/event"),m=require("system/lang/element"),n=require("../models/refdoc-path-model"),o=require("./events"),p=require("platform/metadata/services/metadata"),q=require("application/application-context"),r=require("platform/entity/services/dto/entity-dto"),s=require("../views/ref-doc-container-view"),t=require("ui/elements/ref-doc/view-models/downloaders/downloader"),u=require("system/hardware/device"),v=require("system/ui/busy-indicator");require("ui/elements/tool-bar/view-model"),require("ui/elements/filter/filter-view-model"),
require("ui/elements/resultgrid/resultgrid-view-model");function w(){this.element=null,this.entityKey=null,this.siteKey=null,this.refDocEntity=null,this.familyKey=null,this.service=null,this.refDocs=null,this.translator=null,this.callback=null,this.refDocsUpdated=null,this.refDocEvents=null,this.refDocPathModel=null,this.refDocListContainer=null,this.datasheet=null,this.datasheetViewModel=null,this.canInsert=!1,this.canUpdate=!1,this.canView=!1,this.canDelete=!1,this.isSuperUser=!1,this.isAddAllowed=null,this.isUpdateAllowed=null,this.isUnlinkAllowed=null,this.readonly=null,this.showicon=null,this.failedRefDocLinkCount=0,this.refDocKeys=[],this.refDocFamilyKey=null,this.dialog=null}w.prototype=Object.create(HTMLElement.prototype),w.prototype.createdCallback=function(){this.element=this,this.refDocs=Object.resolve(e),this.service=Object.resolve(f),this.translator=Object.resolve(i),this.indicator=Object.resolve(v),this.isAddAllowed=c.observable(!0),this.isUpdateAllowed=c.observable(!0),
this.isUnlinkAllowed=c.observable(!0),this.refDocsUpdated=new l,this.refDocEvents=new o,this.familyKey="MI Reference Document",this.showicon=this.getAttribute("showicon"),this.entityKey=this.getAttribute("entitykey"),this.readonly=!!this.getAttribute("readonly")&&g.toBoolean(this.getAttribute("readonly").toLowerCase(),"true")},w.prototype.attachedCallback=function(){this.element.innerHTML=d,this.isSuperUser=q.user.isSuperUser,this.entityKey&&this.loadRefDocForDataSheet(),p.getEntityFamilyByid(this.familyKey).done(x.bind(null,this))},w.prototype.populateResultgrid=function a(){var c=this;c.resultGrid=b(c.element).find("mi-resultgrid")[0],m.upgrade(c.resultGrid),c.resultGrid.loadJSONData=c.loadData.bind(c),0===b(c.resultGrid).find(".editRefDoc").length&&(c.resultGrid.loadConfigurableButtons=c.loadButtons.bind(c)),c.resultGrid.toolbarItemClickCallback=c.toolBarItemClicked.bind(c),c.resultGrid.showGridBorder=!0,c.resultGrid.onRowMultiSelectCB=c.gridRefDocSelc.bind(null,c),
c.resultGrid.cellTemplateCB=c.cellTemplateCallback.bind(null,c),c.resultGrid.gridLoadedCB=c.gridLoadComplete.bind(null,c),b(c.resultGrid).find(".editRefDoc, .unlinkRefDoc, .deleteRefDoc").attr("disabled",!0),c.indicator.attachTo(b(c.element).find(".refdoc-container")[0])},w.prototype.cellTemplateCallback=function a(c,d,e){if(e.data.MIRD_DOC_PATH_CHR){var f=b("<a class='ref-doc-href'></a>").text(e.value);e.data.MI_REF_DOCUMENTS_STORE_DOCUM_L?(f.on("click",L.bind(null,c,e.column,e.data)),d.append(f)):e.data.MI_REF_DOCUMENTS_STORE_DOCUM_L===!1?(f.on("click",I.bind(null,c,e.column,e.data)),d.append(f)):d.text(e.value)}else d.text(e.value)},w.prototype.refDocCB=function(a){this.fromDataSheet=!0,this.callback=a,b(this.element).closest(".datasheet-layout-container").addClass("refdoc-datasheet-layout")},w.prototype.getState=function(){return this.element},w.prototype.setState=function(a){var b=this},w.prototype.gridRefDocSelc=function a(c,d){if(c.refDocKeys=[],
!c.readonly)if(void 0!==d&&void 0!==d[0]){for(var e=d.length,f=!0,g=0;g<e;g++)c.refDocKeys.push(d[g].ENTY_KEY),!f||c.isSuperUser||"0"!==d[g].MI_SITE_KEY.toString()&&""!==d[g].MI_SITE_KEY.toString()||(f=!1);1===e?b(c.resultGrid).find(".editRefDoc").removeAttr("disabled"):b(c.resultGrid).find(".editRefDoc").attr("disabled",!0),f&&b(c.resultGrid).find(".deleteRefDoc").removeAttr("disabled"),b(c.resultGrid).find(".unlinkRefDoc").removeAttr("disabled")}else b(c.resultGrid).find(".editRefDoc, .unlinkRefDoc, .deleteRefDoc").attr("disabled",!0)},w.prototype.gridLoadComplete=function a(c,d){0===b(c.resultGrid).find(".dx-selection").length?b(c.resultGrid).find(".editRefDoc, .unlinkRefDoc, .deleteRefDoc").attr("disabled",!0):b(c.resultGrid).find(".editRefDoc, .unlinkRefDoc, .deleteRefDoc").removeAttr("disabled"),b(c.resultGrid).find(".dx-selection").length>1&&b(c.resultGrid).find(".editRefDoc").attr("disabled",!0),c.fromDataSheet&&b(c.resultGrid).find(".backToDatasheet").show(),
d.option("columnAutoWidth",!1)},w.prototype.loadData=function a(){var c=this,d=b.Deferred();return c.service.getAllRefDocByRelatedEntyKey(this.entityKey).done(function(a){d.resolve(a)}).fail(G.bind(null,c,"REFDOCS_FAILED_TO_GET")),d},w.prototype.loadButtons=function a(){return[{action:"linkRefDoc",title:this.translator.translate("LINK"),iconClass:"icon-link",align:"left",btnClass:"linkRefDoc"},{action:"addRefDoc",title:this.translator.translate("ADD"),iconClass:"icon-plus",align:"left",btnClass:"addRefDoc"},{action:"backToDatasheet",title:this.translator.translate("BACK"),iconClass:"icon-header-back-arrow",align:"left",btnClass:"backToDatasheet"},{action:"deleteRefDoc",title:this.translator.translate("DELETE"),iconClass:"icon-delete-selected",align:"right",btnClass:"deleteRefDoc"},{action:"editRefDoc",title:this.translator.translate("EDIT"),iconClass:"icon-edit",align:"right",btnClass:"editRefDoc"},{action:"unlinkRefDoc",title:this.translator.translate("UNLINK"),
iconClass:"icon-unlink",align:"right",btnClass:"unlinkRefDoc"}]},w.prototype.toolBarItemClicked=function a(b){var c=this;"addRefDoc"===b?N(c,c.familyKey):"linkRefDoc"===b?T(c):"deleteRefDoc"===b?D(c):"editRefDoc"===b?S(c,c.refDocKeys[0]):"unlinkRefDoc"===b?B(c):"backToDatasheet"===b&&M(c)};function x(a,b){a.canInsert=b.canInsert,a.canView=b.canView,a.canUpdate=b.canUpdate,a.canDelete=b.canDelete,a.refDocFamilyKey=b.key,a.isAddAllowed(a.canInsert||a.isSuperUser),a.isUnlinkAllowed(a.canDelete||a.isSuperUser),a.isUpdateAllowed(a.canUpdate||a.isSuperUser),Z(a)}w.prototype.detachedCallback=function(){b(this.element).closest(".datasheet-layout-container").removeClass("refdoc-datasheet-layout")},w.prototype.attributeChangedCallback=function(a,b,c){"entitykey"===a?(this.entityKey=c,this.populateResultgrid(),this.service.getSiteKey(this.entityKey).done(F.bind(null,this)).fail(G.bind(null,this,"REFDOCS_FAILED_TO_GET_SITE"))):"readonly"===a&&(this.readonly=c),this.readonly?y(this):z(this)},
w.prototype.loadRefDocForDataSheet=function a(){this.populateResultgrid(),this.service.getSiteKey(this.entityKey).done(F.bind(null,this)).fail(G.bind(null,this,"REFDOCS_FAILED_TO_GET_SITE")),this.readonly?y(this):z(this)};function y(a){a.resultGrid&&(b(a.resultGrid).find(".editRefDoc, .unlinkRefDoc, .deleteRefDoc").attr("disabled",!0),b(a.resultGrid).find(".addRefDoc, .linkRefDoc").attr("disabled",!0))}function z(a){a.resultGrid&&(b(a.resultGrid).find(".editRefDoc, .unlinkRefDoc, .deleteRefDoc").removeAttr("disabled"),b(a.resultGrid).find(".addRefDoc, .linkRefDoc").removeAttr("disabled"))}function A(a,b){h.showOk(a,b)}function B(a){var b=a.translator.translate("DS_UNLINK_SELECTED_ENTITIES_MESSAGE"),c=a.translator.translate("RM_UNLINK_RECORD_TITLE");h.showOkCancel(b,c).done(C.bind(null,a)).fail(H.bind(null,a))}function C(a,b){0===b&&(_(a),a.service.unlinkRefDoc(a.entityKey,a.refDocKeys).done($.bind(null,a)).fail(G.bind(null,a,"REFDOCS_FAILED_TO_UNLINK")))}function D(a){
var b=a.translator.translate("DS_DELETE_SELECTED_ENTITIES_MESSAGE"),c=a.translator.translate("CONFIRM_DELETE");h.showOkCancel(b,c).done(E.bind(null,a)).fail(H.bind(null,a))}function E(a,b){0===b&&(_(a),a.service.delteRefDoc(a.refDocKeys).done($.bind(null,a)).fail(G.bind(null,a,"REFDOCS_FAILED_TO_DELETE")))}function F(a,b){a.siteKey=b&&"0"!==b?b:null}function G(a,b){aa(a),A(a.translator.translate(b),a.translator.translate("REFDOCS_ALERT"))}function H(a){console.log("dialog show ok cancel fail")}function I(a,b,c){var d=c.ENTY_KEY;_(a),a.service.getRefDocType(d).done(J.bind(null,a,d))}function J(a,b,c){var d=c.type;"URL"===c.type?("undefined"!=typeof cordova?cordova.InAppBrowser.open(c.documentPath,"_blank"):window.open(c.documentPath),aa(a)):(a.service.openRefDoc(b,c).fail(K.bind(null,a)),aa(a))}function K(a){new j({closeButton:!0,timeOut:"200",hideDuration:"200"}).error({code:"0",message:a.translator.translate("REFDOCS_FAILED_TO_OPEN_DOCUMENT")})}function L(a,b,c){
new t(a.indicator).download(c.ENTY_KEY)}function M(a){b(a.element).closest(".datasheet-layout-container").removeClass("refdoc-datasheet-layout");var c=a.resultGrid._totalCount();Object.tryMethod(a,"callback",c)}function N(a,b){var c={familykey:a.familyKey},d={functionsAvailable:["save"],readOnly:!1,canedit:!1,showDatasheetSelection:!0};require(["platform/datasheets/datasheet-dialog"],function(b){var e=a.translator.translate("REFDOCS_ADD_REFERENCE_DOCUMENT");a.dialog=new b(c,d,e,!1);var f={width:"60%",height:"75%"};a.dialog.show(f),a.dialog.datasheetViewModel.dfd.done(O.bind(null,a))})}function O(a,b){a.refDocEntity=b,b.entitySaved.add(P.bind(null,a),a),a.datasheet=a.dialog.datasheetViewModel.datasheet,void 0!==a.siteKey&&(a.datasheet.datasheetManager.layout.siteKey(a.siteKey),a.isSuperUser||a.datasheet.datasheetManager.layout.isSelectedSiteViewOnly(!0))}function P(a,b){a.service.linkRefDocEnntity(a.entityKey,b.key).done(Q.bind(null,a)).fail(R.bind(null,a))}function Q(a){
a.dialog&&(a.dialog.close(),a.dialog=null),a.resultGrid.reload(),a.refDocsUpdated.raise()}function R(a,b){A(b,a.translator.translate("REFDOCS_ALERT"))}function S(a,b){var c={entityObj:b},d={functionsAvailable:["save","delete"],readOnly:!1,canedit:!1,showDatasheetSelection:!0};require(["platform/datasheets/datasheet-dialog"],function(b){var e=a.translator.translate("REFDOCS_EDIT_REFERENCE_DOCUMENT");a.dialog=new b(c,d,e,!1);var f={width:"60%",height:"75%"};a.dialog.show(f),a.dialog.datasheetViewModel.dfd.done(function(b){var c=a.dialog.datasheetViewModel.datasheet;c.entitySaved.add(Q.bind(null,a),a),c.entityDeleted.add(Q.bind(null,a),a)})})}function T(a){var c=b.Deferred(),d=new k,e=null===a.siteKey?[a.siteKey]:[a.siteKey,null],f={multiSelect:!0,selectRelated:!1,families:[a.refDocFamilyKey],relationships:[],defaultFamily:a.refDocFamilyKey,siteKeys:e};return c.done(Y.bind(null,a)),d.show(f).done(U.bind(null,a,c)),c}function U(b,c,d){var e=d.length;a.each(d,V.bind(null,b,e,c))}
function V(a,b,c,d,e){a.failedRefDocLinkCount=0,_(a),a.service.linkRefDocEnntity(a.entityKey,d.key).done(W.bind(null,a,b,c,e)).fail(X.bind(null,a,b,c,e))}function W(a,b,c,d){b===d+1&&c.resolve(a.failedRefDocLinkCount),a.refDocsUpdated.raise(),aa(a)}function X(a,b,c,d){var e=b===d+1;a.failedRefDocLinkCount++,e&&c.resolve(a.failedRefDocLinkCount),aa(a)}function Y(a){0===a.failedRefDocLinkCount?a.resultGrid.reload():h.showOk(a.translator.translate("REFDOCS_FAILED_TO_LINK")+" "+a.failedRefDocLinkCount,a.translator.translate("REFDOCS_FAILED"))}function Z(a){a.isAddAllowed()||(b(a.element).find(".addRefDoc").addClass("no-access"),b(a.element).find(".linkRefDoc").addClass("no-access")),a.isUnlinkAllowed()||(b(a.element).find(".unlinkRefDoc").addClass("no-access"),b(a.element).find(".deleteRefDoc").addClass("no-access")),a.isUpdateAllowed()||b(a.element).find(".editRefDoc").addClass("no-access")}function $(a,b){aa(a),
b&&b[0]&&""!==b[0].errorMessage&&A(b[0].errorMessage,a.translator.translate("ERROR_MESSAGE")),a.resultGrid.reload(),a.refDocsUpdated.raise()}function _(a){a.indicator.show()}function aa(a){a.indicator.hide()}return m.registerElement("mi-ref-doc",{prototype:w.prototype}),w});
define('ui/elements/associated-pages-btn/services/dto/hyperlink-dto',[],function(){"use strict";function a(a){this.hyperLinkKey=a.hyperLinkKey,this.familyKey=a.familyKey,this.url=a.url,this.sequence=a.sequence,this.defaultText=a.defaultText,this.parentMenuKey=a.parentMenuKey,this.condition=a.condition,this.isDefaultMenu=a.isDefaultMenu,this.displayText=a.displayText,this.environment=a.environment,this.children=b(a.children),this.hasChildren=null,this.isOpen=!1,a.url||(this.hasChildren=!0),"-"===a.defaultText&&(this.hasChildren=!1)}function b(b){for(var c=[],d=0;d<b.length;d++)c.push(new a(b[d]));return c}return a});
define('ui/elements/associated-pages-btn/services/associated-pages-service',['require','jquery','./dto/hyperlink-dto','system/http/ajax-client','platform/entity/services/dto/entity-dto'],function(require){"use strict";var a=require("jquery"),b=require("./dto/hyperlink-dto"),c=require("system/http/ajax-client"),d=require("platform/entity/services/dto/entity-dto"),e="api/core/entity",f="api/core/entity/Urls/";function g(a){this.ajaxClient=a}return g.dependsOn=[c],g.prototype.getAssocPages=function c(d){var e,g=f+d,h=a.Deferred();return this.ajaxClient.get(g).done(function(a){var c=[];for(e=0;e<a.length;e++)c.push(new b(a[e]));h.resolve(c)}).fail(function(a){h.reject(a.responseText)}),h.promise()},g.prototype.getDataSheetDetails=function b(c){var f=a.Deferred();return this.ajaxClient.get(e+"/"+c).done(function(a){f.resolve(new d(a))}).fail(function(a){f.reject(a)}),f.promise()},g});

define('text!ui/elements/associated-pages-btn/component/component-view.html',[],function () { return '<div class="assoc-page-placeholder">    \r\n    <div class="assoc-pages-empty" data-bind="visible: !children().length ">\r\n        <h2 name="text" class="system-ellipsis-text" data-bind="text: translator.translate(\'NO_ASSOCIATED_PAGES\')"></h2>\r\n    </div>    \r\n    <div class="assoc-list-group-template" data-bind="template: { name: \'componentTemplate\'} ">\r\n    </div>\r\n</div>\r\n\r\n<script type="text/html" id="componentTemplate">\r\n    <ul class="assoc-list-group" data-bind="foreach: $data.children">\r\n        <li class="assoc-list-group-item">\r\n            <!-- ko if: $data.children.length == 0 -->\r\n            <span class="span-item-text" data-bind="style: { \'font-weight\': isDefaultMenu ? \'bold\' : \'\' }">\r\n                <a data-bind="text: displayText,click: $root.selectedElementNavigateUrl.bind($root, url), attr:{ href: url, target:\'_blank\' }"></a>\r\n            </span>\r\n            <!-- /ko -->\r\n            <!-- ko if: $data.children.length > 0 -->\r\n            <span class="span-item-text" data-bind="style: { \'font-weight\': isDefaultMenu ? \'bold\' : \'\' }, click: function() { isOpen(!isOpen()) }">\r\n                <i class="icon-tree-collapse" data-bind="css: { \'icon-tree-expand\': isOpen }"></i>\r\n                <span data-bind="text: displayText"></span>\r\n            </span>\r\n\r\n            <!-- ko if: $data.isOpen && $data.isOpen() -->\r\n            <span data-bind="template: { name: \'componentTemplate\' }"></span>\r\n            <!-- /ko -->\r\n            <!-- /ko -->\r\n        </li>\r\n    </ul>\r\n</script>';});

define('ui/elements/associated-pages-btn/model/hyperlink-model',['knockout','system/text/clean-href'],function(){"use strict";var a=require("knockout"),b=require("system/text/clean-href");function c(c){this.hyperLinkKey=c.hyperLinkKey,this.familyKey=c.familyKey,this.url=b(c.url),this.sequence=c.sequence,this.defaultText=c.defaultText,this.parentMenuKey=c.parentMenuKey,this.condition=c.condition,this.isDefaultMenu=c.isDefaultMenu,this.displayText=c.displayText,this.environment=c.environment,this.children=d(c.children),this.hasChildren=null,this.isOpen=a.observable(!1),c.url||(this.hasChildren=!0),"-"===c.defaultText&&(this.hasChildren=!1)}function d(a){for(var b=[],d=0;d<a.length;d++)b.push(new c(a[d]));return b}return c});
define('ui/elements/associated-pages-btn/component/component-view-model',['require','jquery','system/knockout/knockout-manager','spa/ko/knockout-view-model','system/globalization/translator','text!./component-view.html','../services/associated-pages-service','../model/hyperlink-model','spa/region','knockout','application/application-events','system/lang/object'],function(require){"use strict";var a=require("jquery"),b=require("system/knockout/knockout-manager"),c=require("spa/ko/knockout-view-model"),d=require("system/globalization/translator"),e=require("text!./component-view.html"),f=require("../services/associated-pages-service"),g=require("../model/hyperlink-model"),h=require("spa/region"),i=require("knockout"),j=require("application/application-events");require("system/lang/object");function k(a){l.call(this,e);var b=this;b.appEvents=Object.resolve(j),b.navigate=b.appEvents.navigate,b.children=i.observableArray([]),b.entitykey=a.entitykey,b.familykey=a.familykey,b.associatedPagesService=Object.resolve(f),b.translator=Object.resolve(d),b.getPagesFromService(b.familykey).done(b.createAssocPages.bind(null,b)),b.callback=null}var l=Object.inherit(c,k);k.prototype.attach=function a(b){var c=this;l.prototype.attach.call(c,b),c.region=b},k.prototype.getPagesFromService=function b(c){var d=this
;return c&&!isNaN(c)?d.associatedPagesService.getAssocPages(c).done(function(a){m(a,d)}).fail(function(a){console.error(a)}):a.Deferred()},k.prototype.createAssocPages=function a(b){var c,d,e,f,g;e=document.getElementsByClassName("assoc-page-placeholder")[0],b.contentConatiner=e,e&&b.initAssociatedPages(b)};function m(a,b){var c=[];b.dataKeys={};for(var d=0;d<a.length;d++){var e=new g(a[d]);c.push(e),b.dataKeys[e.hyperLinkKey]=e.children,e.children.length&&n(b,e.children)}b.children(c),b.componentCallback(b,b.children())}k.prototype.componentCallback=function a(b){Object.tryMethod(b,"callback")},k.prototype.initAssociatedPages=function a(b){b.loadAssociatedPages(b)},k.prototype.loadAssociatedPages=function b(c){var d=a.Deferred();return d.resolve(c.children()),d};function n(a,b){for(var c=0;c<b.length;c++){var d=b[c];a.dataKeys[d.hyperLinkKey]=d.children,d.children.length&&n(a,d.children)}}k.prototype.selectedElementNavigateUrl=function a(b){var c=this;if(b){var d=!1
;if((b.indexOf("webmacros/macrorunner")>-1||0===b.indexOf("!"))&&(d=!0),"#"===b.charAt(0)||"!"===b.charAt(0))if(/\{[0-9]\}/.test(b)&&(b=b.replace(/\{[0-9]\}/,c.entitykey),b=b.replace(/\{[0-9]\}/,c.familykey),d?(b=b.substring(1),c.navigate.raise(b,{isActionRoute:!0})):c.navigate.raise(b,{tab:!0})),(/\[ENTY_KEY\]/.test(b)||/\[enty_key\]/.test(b)||/\[FMLY_KEY\]/.test(b)||/\[fmly_key\]/.test(b))&&(b=b.replace("[ENTY_KEY]",c.entitykey),b=b.replace("[FMLY_KEY]",c.familykey),b=b.replace("[enty_key]",c.entitykey),b=b.replace("[fmly_key]",c.familykey)),/\[([A-Z]|[a-z]|[0-9]|\_)*\]/.test(b)){var e=/\[([A-Z]|[a-z]|[0-9]|\_)*\]/g.exec(b),f=e[0],g=f.slice(1,f.length-1);c.associatedPagesService.getDataSheetDetails(c.entitykey).done(function(a){for(var h=0;h<a.fields.length;h++)a.fields[h].id.toLowerCase()!==g.toLowerCase()||(b=b.replace(f,a.fields[h].dbValue),null===(e=/\[([A-Z]|[a-z]|[0-9]|\_)*\]/g.exec(b)))||(f=e[0],g=f.slice(1,f.length-1),h=-1);d?(b=b.substring(1),c.navigate.raise(b,{
isActionRoute:!0})):c.navigate.raise(b,{tab:!0})}).fail(function(a){console.error(a)})}else d?(b=b.substring(1),c.navigate.raise(b,{isActionRoute:!0})):c.navigate.raise(b,{tab:!0});else window.open(b);o()}};function o(){a(".filter-outer-container").remove()}return k.prototype.detach=function a(b){l.prototype.detach.call(this,b)},k});

define('text!ui/elements/associated-pages-btn/associated-pages-view.html',[],function () { return '<mi-filter-no-ko data-bind="" icon="icon-duplicate-entries" custom-filter="true" isfilterscrollable="false">\r\n</mi-filter-no-ko>';});

define('ui/elements/associated-pages-btn/associated-pages',['require','lodash','jquery','system/globalization/translator','system/lang/converter','./services/associated-pages-service','./component/component-view-model','text!./associated-pages-view.html','ui/elements/filter/filter-no-ko'],function(require){"use strict";var a=require("lodash"),b=require("jquery"),c=require("system/globalization/translator"),d=require("system/lang/converter"),e=require("./services/associated-pages-service"),f=require("./component/component-view-model"),g=require("text!./associated-pages-view.html");require("ui/elements/filter/filter-no-ko");var h=Object.create(HTMLElement.prototype);h.createdCallback=function(){var a;a=this,a.translator=Object.resolve(c),a.familykey=a.getFamilyKey(),a.entitykey=a.getEntityKey(),a.disabled=a.getDisabled(),a.componentViewModel=Object.resolve(f,a),a.hideifnorecords=a.getAssociatedPagesVisible()},h.getFamilyKey=function(){return this.getAttribute("familykey")},h.getEntityKey=function(){return this.getAttribute("entitykey")},h.getDisabled=function(){return this.getAttribute("disabled")},h.getAssociatedPagesVisible=function(){return this.getAttribute("hideifnorecords")},h.setFamilyKey=function(a){var b=this
;b.filter&&b.filter.filterViewModel&&(b.filter.filterViewModel.familykey=a)};function i(a,b){a.filter&&a.filter.filterViewModel&&(a.filter.filterViewModel.entitykey=b)}h.attributeChangedCallback=function(a,b,c){var d=this;"familykey"===a?(d.familykey=c,d.setFamilyKey(c),d.componentViewModel&&d.componentViewModel.getPagesFromService(d.familykey).done(d.componentViewModel.createAssocPages.bind(null,d.componentViewModel)),k(d)):"entitykey"===a?(d.entitykey=c,i(d,c),k(d)):"disabled"===a&&(d.disabled=c,d.filter&&(d.filter.disabled=c))},h.attachedCallback=function(){var a=this;b(a).empty(),b(a).append(g),a.filter=b(a).find("mi-filter-no-ko")[0],a.componentViewModel.familykey=a.familykey,a.componentViewModel.entitykey=a.entitykey,a.componentViewModel.callback=j.bind(null,a),a.filter.filterViewModel=a.componentViewModel,a.filter.icon="icon-duplicate-entries",a.filter.disabled=a.disabled,b(a.filter).attr("title",a.translator.translate("ASSOCIATED_PAGES_TITLE")),k(a)};function j(a){k(a)}
function k(a){a.hideifnorecords=a.getAssociatedPagesVisible();var c=d.toBoolean(a.hideifnorecords,"true");"0"===a.entitykey?b(a).css("display","none"):"0"!==a.entitykey&&(c&&a.componentViewModel.children()&&0===a.componentViewModel.children().length?b(a).css("display","none"):b(a).css("display","inline"))}return h.detachedCallback=function(){b(this).empty(),this.familykey=null,this.entitykey=null,this.disabled=null},document.registerElement("mi-associated-pages-btn",{prototype:h}),h});
define('platform/datasheets/layout/ui/datasheet-view-model',['require','lodash','jquery','knockout','spa/ko/knockout-view-model','./layout-element-view-model','../services/datasheet-service','system/lang/event','../model/field-value-model','../model/entity-model','../model/datasheet-clipboard-model','../adapters/datasheet-adapter','application/export-service','../adapters/datasheet-field-info-adapter','platform/datasheets/layout/ui/utils','./helpers/ref-doc-helper','./helpers/js-module-helper','./helpers/ui-helper','./helpers/print-helper','./helpers/record-manager-helper','text!./views/datasheet.html','text!./field-control-template-map.json','text!./views/templates/layout-control-template.html','text!./views/templates/layout-element-template.html','text!./views/templates/layout-empty-space-template.html','text!./views/templates/layout-group-template.html','text!./views/templates/layout-label-template.html','text!./views/templates/layout-root-template.html','text!./views/templates/layout-tabbed-group-template.html','text!./views/templates/layout-table-column-template.html','text!./views/templates/layout-table-row-template.html','text!./views/templates/layout-table-template.html','text!./views/templates/field-check-box-template.html','text!./views/templates/field-combo-box-template.html','text!./views/templates/field-date-template.html','text!./views/templates/field-date-alt-template.html','text!./views/templates/field-radio-template.html','text!./views/templates/field-text-area-template.html','text!./views/templates/field-hyperlink-template.html','text!./views/templates/field-text-template.html','text!./views/templates/field-select-template.html','text!./views/templates/field-multivalue-template.html','text!./views/templates/field-empty-template.html','text!./views/templates/field-browse-template.html','text!./views/templates/field-multi-text-template.html','text!./views/templates/field-masked-template.html','text!./views/templates/field-uom-template.html','system/globalization/translator','application/application-events','ui/elements/ref-doc/models/refdoc-path-model','ui/elements/ref-doc/models/refdoc-path-adapter','system/error/error-message','system/knockout/knockout-manager','platform/metadata/services/metadata','ui/elements/ref-doc/services/service','../../layout/model/uom-conversion-model','platform/entity/entity-factory','logging/feedback-component/feedback-component','system/knockout/knockout-helpers','./bootstrap-tabs','ui/elements/select/view-model','ui/elements/multi-value/view-model','ui/elements/text-ext/view-model','ui/elements/date-time/bootstrap-datetimepicker','ui/elements/date-time/element','ui/elements/more-options/more-options','ui/elements/site-selector/site-selector-element','ui/elements/state-transition/component','ui/elements/ref-doc/view-models/refdoc-container-view-model','ui/elements/associated-pages-btn/associated-pages'],function(require){"use strict"
;var a=require("lodash"),b=require("jquery"),c=require("knockout"),d=require("spa/ko/knockout-view-model"),e=require("./layout-element-view-model"),f=require("../services/datasheet-service"),g=require("system/lang/event"),h=require("../model/field-value-model"),i=require("../model/entity-model"),j=require("../model/datasheet-clipboard-model"),k=require("../adapters/datasheet-adapter"),l=require("application/export-service"),m=require("../adapters/datasheet-field-info-adapter"),n=require("platform/datasheets/layout/ui/utils"),o=require("./helpers/ref-doc-helper"),p=require("./helpers/js-module-helper"),q=require("./helpers/ui-helper"),r=require("./helpers/print-helper"),s=require("./helpers/record-manager-helper"),t=require("text!./views/datasheet.html"),u=JSON.parse(require("text!./field-control-template-map.json")),v=require("text!./views/templates/layout-control-template.html")+require("text!./views/templates/layout-element-template.html")+require("text!./views/templates/layout-empty-space-template.html")+require("text!./views/templates/layout-group-template.html")+require("text!./views/templates/layout-label-template.html")+require("text!./views/templates/layout-root-template.html")+require("text!./views/templates/layout-tabbed-group-template.html")+require("text!./views/templates/layout-table-column-template.html")+require("text!./views/templates/layout-table-row-template.html")+require("text!./views/templates/layout-table-template.html"),w=require("text!./views/templates/field-check-box-template.html")+require("text!./views/templates/field-combo-box-template.html")+require("text!./views/templates/field-date-template.html")+require("text!./views/templates/field-date-alt-template.html")+require("text!./views/templates/field-radio-template.html")+require("text!./views/templates/field-text-area-template.html")+require("text!./views/templates/field-hyperlink-template.html")+require("text!./views/templates/field-text-template.html")+require("text!./views/templates/field-select-template.html")+require("text!./views/templates/field-multivalue-template.html")+require("text!./views/templates/field-empty-template.html")+require("text!./views/templates/field-browse-template.html")+require("text!./views/templates/field-multi-text-template.html")+require("text!./views/templates/field-masked-template.html")+require("text!./views/templates/field-uom-template.html"),x=require("system/globalization/translator"),y=require("application/application-events"),z=require("ui/elements/ref-doc/models/refdoc-path-model"),A=require("ui/elements/ref-doc/models/refdoc-path-adapter"),B=require("system/error/error-message"),C=require("system/knockout/knockout-manager"),D=require("platform/metadata/services/metadata"),E=require("ui/elements/ref-doc/services/service"),F=require("../../layout/model/uom-conversion-model"),G=require("platform/entity/entity-factory"),H=require("logging/feedback-component/feedback-component")
;require("system/knockout/knockout-helpers"),require("./bootstrap-tabs"),require("ui/elements/select/view-model"),require("ui/elements/multi-value/view-model"),require("ui/elements/text-ext/view-model"),require("ui/elements/date-time/bootstrap-datetimepicker"),require("ui/elements/date-time/element"),require("ui/elements/more-options/more-options"),require("ui/elements/site-selector/site-selector-element"),require("ui/elements/state-transition/component"),require("ui/elements/ref-doc/view-models/refdoc-container-view-model"),require("ui/elements/associated-pages-btn/associated-pages");function I(a){var b=this;J.call(this,t),this.kom=Object.resolve(C),this.util=Object.resolve(n),this.region=null,this.scrollEl=null,this.collapsibleChangeEventHandler=null,this.translator=Object.resolve(x),this.datasheetService=a,this.title=c.observable(""),this.appEvents=Object.resolve(y),this.exportService=Object.resolve(l),this.refDocHelper=Object.resolve(o),this.jsModuleHelper=Object.resolve(p),
this.printHelper=Object.resolve(r),this.uiHelper=Object.resolve(q),this.recordManagerHelper=Object.resolve(s),b.refDocPathModel=null,b.teamModel=null,this.entityFactory=new G,j.onChange.add(b.onChangingClipboardData,b),this.entykey=c.observable(),this.currentEntyKey=c.observable(),this.isBulkDatasheet=c.observable(!1),this.datasheetKeys=c.observableArray(),this.datasheets=c.observableArray(),this.currentDatasheetKey=c.observable(),this.previousDatasheetKey=c.observable(),this.cachedFieldValues=null,this.cachedFamilykey=null,this.assocFamilykey=c.observable(),this.assocDisabled=c.observable(!0),this.currentDatasheet=c.observable(),this.currentEntity=c.observable(),this.fieldInfos=c.observableArray(),this.layoutElements=c.observableArray(),this.entityReference=null,this.kom.subscribe(this.currentEntity,_.bind(null,this)),this.kom.subscribe(this.currentEntity,$.bind(null,this),null,"beforeChange"),this.isSaveAvailable=c.observable(!0),this.isNewAvailable=c.observable(!0),
this.isDeleteAvailable=c.observable(!0),this.isHistoryAvailable=c.observable(!0),this.isHistoryEnabled=c.observable(!0),this.isSiteFiltered=c.observable(!1),this.siteKey=c.observable(),this.isSelectedSiteViewOnly=c.observable(!1),this.showSiteSelector=c.observable(!0),this.assetContextKey=c.observable(),this.kom.subscribe(this.assetContextKey,ba.bind(b,this)),this.isRefDocEnabled=c.observable(!1),this.refDocCount=c.observable(""),this.isReferencesAvailable=c.observable(!0),this.isCopyAvailable=c.observable(!0),this.isPasteEnabled=c.observable(!0),this.isDatasheetReadOnly=c.observable(!1),this.showEditButton=c.observable(!1),this.canEdit=c.observable(!1),this.showStateManagement=c.observable(!0),this.showDatasheetSelection=c.observable(!0),this.isReadOnly=c.observable(!1),this.helpTextModeOn=c.observable(!1),this.helpButtonText=c.observable(this.translate("DS_TURN_ON_HELPTEXT")),this.bindKeypress=c.observable(!1),this.isSilmmerHeader=c.observable(!1),this.canPaste=c.observable(!0),
this.overlayTop=c.observable("0"),this.overlayHeight=c.observable(),this.kom.subscribe(this.isDatasheetReadOnly,aa.bind(b,this)),this.isMasterDatasheet=c.observable(!1),this.kom.subscribe(this.isMasterDatasheet,va.bind(b,this)),this.entityState=c.observable(),this.oldEntity=null,this.isDatasheetRendered=c.observable(!1),this.isRefDocRendered=c.observable(!1),this.isNewEntityCreated=c.observable(!1),this.isDatasheetRenderedInRM=c.observable(!1),this.isRootRecordAvailable=c.observable(!0),this.isUnlinkRecordAvailable=c.observable(!0),this.isUnlinkRecordEnabled=c.observable(!0),this.isDefaultHelpTextAvailable=c.observable(!0),this.hideMoreOptionsForIcons=c.observable(!1),this.tabWidth=c.observable(0),this.containerWidth=c.observable(0),this.showTabScroll=this.kom.computed(ua.bind(null,b)),this.datasheetNavWidth=c.observable(0),this.appEvents.windowResized.add(this.handleNavAppearance,this),this.layoutRendered=new g,this.entityRendered=new g,this.fieldValueChanged=new g,
this.fieldTouched=new g,this.currentEntityChanged=new g,this.datasheetSaved=new g,this.datasheetNew=new g,this.datasheetDelete=new g,this.datasheetReference=new g,this.datasheetHistory=new g,this.onMasterDetail=new g,this.changeCanPaste=new g,this.beforeStateTransition=new g,this.onStateTransition=new g,this.onSiteChange=new g,this.tabSwitched=new g,this.refDocsHidden=new g,this.refDocsRendered=new g,this.datasheetChanged=new g,this.toggleEditBtnClicked=new g,this.siteSelector=null,b.uiHelper.attachTemplates(b,v,w),this.refDocService=Object.resolve(E),this.isStateTransitionDisabled=c.observable(!1),this.loadingPromises=[],this.isReferenceDocument=!1}var J=Object.inherit(d,I);I.dependsOn=[f],I.prototype.setErrorMessageForDate=function(a){for(var b=this.entityReference.fields.length,c=0;c<b;c++)a.id()===this.entityReference.fields.models[c].id&&(this.entityReference.fields.models[c].attributes.errorMessage=this.translator.translate("FORMAT_IS_NOT_VALID"),
a.errorMessage(this.translator.translate("FORMAT_IS_NOT_VALID")))},I.prototype.clearErrorMessageForDate=function(a){for(var b=this.entityReference.fields.length,c=0;c<b;c++)a.id()===this.entityReference.fields.models[c].id&&(this.entityReference.fields.models[c].attributes.errorMessage="",a.errorMessage(""))},I.prototype.onControlTouched=function(a){return this.fieldTouched.raise(a.id()),!0},I.prototype.attach=function c(d,e){if(d.element){if(J.prototype.attach.call(this,d),this.region=d,e){var f=this.scrollEl=b(e);f.on("scroll.ds",a.debounce(K.bind(null,this,d,f),100)),this.collapsibleChangeEventHandler=a.defer.bind(a,K.bind(null,this,d,f))}else this.collapsibleChangeEventHandler=a.defer.bind(a,this.uiHelper.handleNavAppearance.bind(null,this,d));b("mi-collapsible").on("change.ds",this.collapsibleChangeEventHandler)}};function K(a,b,c){a.uiHelper.handleNavAppearance(a,b),a.uiHelper.handleStickyHeader(a,b,c)}I.prototype.onLayoutChanged=function a(){var b=this
;b.uiHelper.handleHeaderHeight(b,b.region),b.uiHelper.handleNavAppearance(b)},I.prototype.detach=function a(c){J.prototype.detach.call(this,c),sa(this),this.scrollEl&&this.scrollEl.off("scroll.ds"),b("mi-collapsible")&&b("mi-collapsible").length&&b("mi-collapsible").off("change.ds",this.collapsibleChangeEventHandler)},I.prototype.handleNavAppearance=function a(){var b=this;b.uiHelper.handleNavAppearance(b),b.region&&b.scrollEl&&(b.uiHelper.handleStickyHeader(b,b.region,b.scrollEl),b.uiHelper.handleHeaderHeight(b,b.region))},I.prototype.translate=function a(b){return this.translator.translate(b)},I.prototype.setTitle=function a(b){this.title(b)},I.prototype.handleSiteChange=function a(b,c){b.onSiteChange.raise(c.originalEvent.detail.value)},I.prototype.print=function a(){D.retrieveFamilyReports(this.cachedFamilykey).then(xa.bind(null,this))},I.prototype.saveDatasheet=function a(){var b=this;b.datasheetSaved.raise(b.refDocPathModel)},I.prototype.newDatasheet=function a(){
this.datasheetNew.raise()},I.prototype.deleteDatasheet=function a(){this.datasheetDelete.raise()},I.prototype.showRefDocs=function a(b){var c=this;c.refDocHelper.showRefDocs(c,b)},I.prototype.hideRefDocs=function(a,b){var c=this;c.refDocHelper.hideRefDocs(c,a,b)},I.prototype.downloadRefdoc=function(a,b){b&&b.preventDefault();var c=this;return c.refDocHelper.downloadRefDoc(c,c.currentEntyKey(),b),!1},I.prototype.uncDownloadRefDoc=function a(b,c){var d=this;c&&c.preventDefault(),d.entityFactory.hasRefDocServerCredentials().done(U.bind(null,d,b)).fail(W.bind(null,d))},I.prototype.updateRefDocView=function(a){this.showRefDocs(a)},I.prototype.showJSModule=function a(b,c,d,e,f,g,h){var i={key:b,jsModuleName:c,jsModuleParams:d,jsModuleUseApply:h,type:"form"};this.jsModuleHelper.showJSModule(this,i)},I.prototype.callOnFocus=function a(b,c,d,e,f,g){var h={key:b,entityKey:c,clientID:d,jsModuleName:e,jsModuleParams:f,popJSModuleOnFocus:g,type:"form"};this.jsModuleHelper.callOnFocus(this,h)},
I.prototype.showHistory=function a(){this.datasheetHistory.raise()},I.prototype.onBeforeStateChanged=function(a,b){this.beforeStateTransition.raise(a,b)},I.prototype.onAfterStateChanged=function(a,b){this.onStateTransition.raise(a,b)},I.prototype.copyDatasheet=function a(){var b=this.currentEntity().fieldValues();j.setData(this.cachedFamilykey,b)},I.prototype.pasteDatasheet=function a(){var b=j.getData(),c=b.fieldValues,d;if(b.familykey.toString()===this.cachedFamilykey.toString())for(d=0;d<c.length;d++)this.updateFieldValue(c[d].key,c[d].value,c[d].values,c[d].displayValue,c[d].picklist,c[d].isDisabled,c[d].required,c[d].hidden,c[d].errorMessage,c[d].backColor,c[d].maxNumberOfValues,!1)},I.prototype.showTextEditor=function a(b,c){var d=this,e=b.fieldValue().showTextEditor.call(b,d.isDatasheetReadOnly());return e.onSave.add(function a(){}),e.onClose.add(function a(){}),e},I.prototype.setCachedFamilyKey=function a(b){this.cachedFamilykey=b},I.prototype.setCurrentEntity=function a(b){
L(this,b),la(this),this.currentEntity().fieldValueChanged.add(fa.bind(null,this))},I.prototype.showUOMConversionTool=function a(b,c){b.uomConversion=Object.resolve(F),b.uomConversion.show(c)};function L(a,b){var c=b.length,d,e=[],f;for(d=0;d!==c;d++)e.push(new h(b[d].fieldKey,b[d].fieldId,b[d].fieldValue,b[d].fieldDisplayValue,{required:b[d].options.required,disabled:b[d].options.disabled,isHtmlField:b[d].options.isHtmlField,unitOfMeasure:b[d].options.unitOfMeasure,unitOfMeasureKey:b[d].options.unitOfMeasureKey,picklist:b[d].options.picklist,backColor:b[d].options.backColor,jsModuleName:b[d].options.jsModuleName,jsModuleParams:b[d].options.jsModuleParams,jsModuleUseApply:b[d].options.jsModuleUseApply,popJSModuleOnFocus:b[d].options.popJSModuleOnFocus,addParseValueParam:b[d].options.addParseValueParam,dependentFields:b[d].options.dependentFields,isPicklistRestricted:b[d].options.isPicklistRestricted,maxNumberOfValues:b[d].options.maxNumberOfValues,values:b[d].options.values,
helpText:b[d].options.helpText,format:b[d].options.format,dbLength:b[d].options.dbLength,behaviors:b[d].options.behaviors,hidden:b[d].options.hidden}));f=new i(e),a.currentEntity(f)}I.prototype.showDatasheet=function a(c,d,e,f){var g=this,h=b.Deferred(),i=b.Deferred(),j,k,l;return e?g.cachedFieldValues=e:e=g.cachedFieldValues,d?g.cachedFamilykey=d:d=g.cachedFamilykey,g.assocFamilykey(d),f&&(g.entityReference=f,g.currentEntyKey(f.key)),sa(g),l=h.then(function(){var a=g.datasheetService.getDatasheets(d);return g.loadingPromises&&g.loadingPromises.push(a),a}).then(function(a){if(0===a.length||g.uiHelper.isAllDatasheetsHidden(a))return void g.throwException(g.translate("DS_DATASHEET_NOT_CONFIGURED_MESSAGE"));N(g,c,a)}),j=l.then(function(){var a;return void 0!==c&&g.currentDatasheetKey&&g.currentDatasheetKey()?(a=g.datasheetService.getDatasheet(g.currentDatasheetKey(),"False"),g.loadingPromises&&g.loadingPromises.push(a),
a):g.currentDatasheetKey&&g.currentDatasheetKey()?(a=g.datasheetService.getDatasheet(g.currentDatasheetKey()),g.loadingPromises&&g.loadingPromises.push(a),a):void 0}).then(function(a){a&&(da(g,a),O(g,a),ga(g))}),k=j.then(function(){if(g.currentDatasheet&&g.currentDatasheet()){var a=g.datasheetService.getFieldInfo(g.currentDatasheet().familyKey());return g.loadingPromises&&g.loadingPromises.push(a),a}}).then(function(a){try{return ea(g,a)}catch(a){}}).done(function(a){if(!a)return void i.resolve();try{P(g,i,e)}catch(a){console.error(a)}}).fail(function(a){"abort"===a?i.reject(a):(g.throwException(g.translate("DS_LOAD_DATASHEET_FAIL_EXCEPTION")),i.reject())}),h.resolve(),i},I.prototype.abortLoadingPromises=function a(){var b,c=this;for(b=0;b<c.loadingPromises.length;b++)M(c.loadingPromises[b]);c.loadingPromises=null};function M(a){a.request.abort()}function N(a,b,c){try{var d=0,e=!1;if(void 0!==b&&"string"==typeof b)for(d=0;d<c.length;d++)if(c[d].id===b){b=c[d].key;break}
for(d=0;d<c.length;d++)c[d].isHidden||(a.datasheets.push(c[d]),a.datasheetKeys.push({key:c[d].key,caption:c[d].caption,id:c[d].id}),c[d].lastViewed===!0?(a.currentDatasheetKey(b||c[d].key),e=!0):c[d].isDefault===!0&&(a.currentDatasheetKey(b||c[d].key),e=!0));e||(a.currentDatasheetKey(b||c[0].key),e=!0),a.previousDatasheetKey(a.currentDatasheetKey())}catch(a){}}function O(b,c){if(b.currentDatasheet().isMasterDetail()){var d=a.find(b.datasheetKeys(),function(a){return c.customFormParameters["master Family Datasheet ID"]===a.id});if(d&&d.key)return void b.onMasterDetail.raise(b.currentDatasheetKey(),c,d.key,b.datasheetKeys())}}function P(a,b,c){a.attachEntityToLayout(c).done(function(){ia(a),la(a),qa(a),a.kom.subscribe(a.currentDatasheetKey,Q.bind(null,a)),a.calculateTabWidth(),a.calculateContainerWidth(),a.uiHelper.handleNavAppearance(a,a.region),b.resolve()})}function Q(a){if(a.proceed===!1)return void(a.proceed=!0);a.datasheetChanged.raise()}
I.prototype.executeDatasheetChanged=function c(d,e){var f=b.Deferred(),g=b.Deferred(),h,i,j,k=this;return j=e?e:k.cachedFieldValues,k.isDatasheetRendered(!1),sa(k),h=f.then(function(){if(da(k,d),k.currentDatasheet().isMasterDetail()){var b=a.find(k.datasheetKeys(),function(a){return d.customFormParameters["master Family Datasheet ID"]==a.id});if(b&&b.key)return void k.onMasterDetail.raise(k.currentDatasheetKey(),d,b.key,k.datasheetKeys())}ga(k)}),i=h.then(function(){return k.datasheetService.getFieldInfo(k.currentDatasheet().familyKey())}).then(function(a){try{ea(k,a)}catch(a){}}).done(function(){try{k.attachEntityToLayout(j).done(function(){ia(k),la(k),qa(k),k.uiHelper.setOverlay(k),g.resolve()})}catch(a){}}).fail(function(){k.throwException(k.translate("DS_LOAD_DATASHEET_FAIL_EXCEPTION")),g.reject()}),f.resolve(),g},I.prototype.throwException=function a(b){var c=new B(1,b,"platform/datasheets/layout/ui/datasheet-view-model.js");this.appEvents.errorOccured.raise(this,c)},
I.prototype.attachEntityToLayout=function a(c){var d=b.Deferred();return L(this,c),d.resolve(),d},I.prototype.updateFieldValue=function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){var v=0,w=0,x=[],y=null,z=this;if(this.currentEntity&&this.currentEntity()&&(x=this.currentEntity().fieldValues()),s&&null!==m)for(v=0;v!==x.length;v++){for(w=0;w!==m.length;w++)x[v].key().toString()===m[w].toString()&&x[v].clientDisabled(!1);x[v].key().toString()===b.toString()&&x[v].clientDisabled(!1)}for(v=0;v!==x.length;v++){if(x[v].key().toString()===b.toString()){y=x[v];break}x[v].changedFromView(!0)}R(z,y,{newValue:c,newValues:d,newDisplayValue:e,picklist:f,isDisabled:g,isRequired:h,isHidden:i,errorMessage:j,backColor:k,maxNumberOfValues:l,jsModuleName:n,jsModuleParams:o,popJSModuleOnFocus:p,addParseValueParam:q,stopPropagate:s,format:r,successMessage:t},u)};function R(b,c,d,e){if(c){if(d.stopPropagate&&c.changedFromView(!1),c.value(d.newValue),a.isEqual(c.values(),d.newValues)||(c.values(d.newValues),
c._values(d.newValues)),c.dateSubscription&&(c.dateValue(d.newValue),c.handleDateFormat(d.format)),d.newDisplayValue&&d.newDisplayValue.toString().indexOf("&parseValue=true")>-1){var f=d.newDisplayValue.toString().substring(0,d.newDisplayValue.toString().indexOf("&parseValue=true"));b.isReferenceDocument&&"MIRD_DOC_PATH_CHR"===c.id()?Y(b,c,f):c.displayValue(f)}else b.isReferenceDocument&&"MIRD_DOC_PATH_CHR"===c.id()?b.isReferenceDocument&&"MIRD_DOC_PATH_CHR"===c.id()&&Z(c,e):c.displayValue(d.newDisplayValue);c.disabled(d.isDisabled),c.required(d.isRequired),c.hidden(d.isHidden),c.layoutElement&&c.layoutElement.isHidden&&c.layoutElement.isHidden(d.isHidden),c.errorMessage(d.errorMessage),c.backColor(d.backColor),c.maxNumberOfValues(d.maxNumberOfValues),c.successMessage(d.successMessage),void 0!==c.jsModuleName&&c.jsModuleName()&&null!==c.jsModuleName()&&c.jsModuleName(d.jsModuleName),
void 0!==c.jsModuleParams&&c.jsModuleParams()&&null!==c.jsModuleParams()&&c.jsModuleParams(d.jsModuleParams),void 0!==c.popJSModuleOnFocus&&c.popJSModuleOnFocus()&&null!==c.popJSModuleOnFocus()&&c.popJSModuleOnFocus(d.popJSModuleOnFocus),void 0!==c.picklist&&c.picklist(c.createPickList(d.picklist)),c.changedFromView(!0)}}function S(a,b){b&&b.preventDefault(),a.refDocHelper.downloadRefDoc(a,a.currentEntyKey(),b)}function T(a,b,c){c&&c.preventDefault(),a.entityFactory.hasRefDocServerCredentials().done(U.bind(null,a,b)).fail(W.bind(null,a))}function U(a,b,c){var d=new H({closeButton:!0,timeOut:"200",hideDuration:"200"});c===!0?a.refDocService.openRefDoc(a.currentEntyKey(),b).fail(X.bind(null,a,d)):V(a,d)}function V(a,b){b.error({message:a.translate("REFDOCSERVER_NO_CREDENTIALS")},a.translate("DS_REFERENCE_DOCS_TITLE"))}function W(a){new H({closeButton:!0,timeOut:"200",hideDuration:"200"}).error({message:a.translate("REFDOCSERVER_FAILED_CREDENTIALS")
},a.translate("DS_REFERENCE_DOCS_TITLE"))}function X(a,b){b.error({message:a.translate("REFDOCS_FAILED_TO_OPEN_DOCUMENT")},a.translate("DS_REFERENCE_DOCS_TITLE"))}function Y(a,c,d){var e;try{e=JSON.parse(d)}catch(a){e=null}if(e&&e.path)if(e.isStored)c.displayValue('<a href="#" id="ref-doc-download-link">'+e.path+"</a>"),b("#ref-doc-download-link").on("click",S.bind(null,a));else if(!e.isStored&&e.path.startsWith("\\")){c.displayValue('<a href="#" id="ref-doc-unc-link">'+e.path+"</a>");var f={type:"UNC",documentPath:e.path};b("#ref-doc-unc-link").on("click",T.bind(null,a,f))}else c.displayValue('<a href="'+e.path+'" target="tab">'+e.path+"</a>")}function Z(a,b){if(a.layoutElement){var c=a.layoutElement.elementCss(),d="inactiveHyperlink",e="";b===!0?c.indexOf(d)===-1&&(e=c+" "+d,a.layoutElement.elementCss(e)):b===!1&&(e=a.layoutElement.elementCss().replace(d,""),a.layoutElement.elementCss(e))}}I.prototype.dispose=function a(){this.currentEntity()&&this.currentEntity().dispose(),
this.layoutRendered.remove(),this.entityRendered.remove()};function $(a,b){a.oldEntity=b}function _(a,b){a.oldValue&&a.oldValue.dispose(),b.fieldValueChanged.add(fa.bind(null,a)),a.currentEntityChanged.raise(b,a.oldEntity)}function aa(a){var b=0,c;for(a.isDatasheetReadOnly()===!0&&(a.isSelectedSiteViewOnly(!0),a.isStateTransitionDisabled(!0)),b=0;b!==a.layoutElements().length;b++)c=a.layoutElements()[b],ra(a,c)}function ba(a,b){void 0!==b&&null!==b&&""!==b&&(a.siteSelector=a.region.$element.find("mi-site-selector")[0],Element.upgrade(a.siteSelector),a.siteSelector&&a.siteSelector.selectSiteByAssetKey(b))}function ca(a){if(a&&a.region&&a.region.$element){var b=a.region.$element.find("mi-site-selector");if(b.length){a.siteSelector=b[0],Element.upgrade(a.siteSelector);var c=a.siteSelector.isSiteViewOnly;c&&(a.isSelectedSiteViewOnly(c),a.isSaveAvailable(!1),a.isDeleteAvailable(!1))}}}I.prototype.afterLoad=function a(){ca(this)},I.prototype.toggleEdit=function a(){
this.isDatasheetReadOnly(!this.isDatasheetReadOnly()),this.showEditButton(!1),this.isSelectedSiteViewOnly(this.siteSelector.isSiteViewOnly),this.isStateTransitionDisabled(!1),this.toggleEditBtnClicked.raise()},I.prototype.toggleHelpText=function a(){this.helpTextModeOn(!this.helpTextModeOn()),this.helpTextModeOn()===!0?this.helpButtonText(this.translate("DS_TURN_OFF_HELPTEXT")):this.helpButtonText(this.translate("DS_TURN_ON_HELPTEXT"))};function da(a,b){var c=k.toModelObject(b);a.currentDatasheet(c)}function ea(a,c){if(c){var d=b.map(c,function(a){return m.toModelObject(a)});a.fieldInfos(d)}return c}function fa(a,b,c,d,e,f,g,h){var i=0,j=0,k=[];for(a.currentEntity()&&(k=a.currentEntity().fieldValues()),i=0;i!==k.length;i++){for(j=0;j!==g.length;j++)k[i].key()===g[j]&&k[i].clientDisabled(!0);k[i].key()!==c||k[i].dateValue()||null===k[i].dateValue()||k[i].clientDisabled(!0)}a.fieldValueChanged.raise(b,c,d,e,h)}function ga(a){var c=b.map(a.currentDatasheet().layout.elements(),function(b){
return new e(b,a.isReadOnly())});a.layoutElements(c),a.uiHelper.attachTabClickHandlers(a),ha(a)}function ha(a){var b=j.getData();b&&a.cachedFamilykey.toString()===b.familykey.toString()&&(a.isReadOnly()||j.isEmpty()||a.canPaste(!1))}function ia(a){var b=0,c;for(b=0;b!==a.layoutElements().length;b++)c=a.layoutElements()[b],ja(a,c)}function ja(a,b){var c=0,d,e;if("0"===b.controlName().toString())d="Empty";else for(c=0;c!==a.fieldInfos().length;c++)if(a.fieldInfos()[c].fieldId===b.controlName()){d=a.fieldInfos()[c].inputType;break}for(ka(a,b,d),b.controlTemplate(u[d]||null),ra(a,b),c=0;c!==b.children().length;c++)e=b.children()[c],ja(a,e)}function ka(a,b,c){for(var d,e=0;e!==a.currentEntity().fieldValues().length;e++)a.currentEntity().fieldValues()[e].id().toString()===b.controlName().toString()&&(d=a.currentEntity().fieldValues()[e],d.inputType(c),b.fieldValue(d))}function la(a){var b=0,c;for(b=0;b!==a.layoutElements().length;b++)c=a.layoutElements()[b],ma(a,c);a.entityRendered.raise()}
function ma(a,b){var c=0,d,e;for(na(a,b),c=0;c!==b.children().length;c++)e=b.children()[c],ma(a,e)}function na(a,b){var c=0,d;if("0"===b.controlName().toString())b.controlTemplate(u.Empty);else for(c=0;c!==a.currentEntity().fieldValues().length;c++)if(a.currentEntity().fieldValues()[c].id().toString()===b.controlName().toString()){oa(a.currentEntity().fieldValues()[c],b),a.currentEntity().fieldValues()[c].isMaskedField===!0?(b.controlTemplate(u.MaskedTextBox),a.currentEntity().fieldValues()[c].inputType("MaskedTextBox")):void 0===a.currentEntity().fieldValues()[c].picklist||a.currentEntity().fieldValues()[c].isPicklistRestricted()?void 0!==a.currentEntity().fieldValues()[c].picklist?(b.controlTemplate(u.ComboBox),a.currentEntity().fieldValues()[c].inputType("ComboBox")):parseInt(a.currentEntity().fieldValues()[c].maxNumberOfValues())>1?(b.controlTemplate(u.MultiText),
a.currentEntity().fieldValues()[c].inputType("MultiText")):(!pa(a.currentEntity().fieldValues()[c].displayValue())&&a.currentEntity().fieldValues()[c].displayValue().indexOf("href")>0||a.currentEntity().fieldValues()[c].isHtmlField()||a.isReferenceDocument&&"MIRD_DOC_PATH_CHR"===a.currentEntity().fieldValues()[c].id().toString())&&a.currentEntity().fieldValues()[c].isCleanHref()?(b.controlTemplate(u.Hyperlink),a.currentEntity().fieldValues()[c].inputType("Hyperlink")):"-1"!==a.currentEntity().fieldValues()[c].uomKey()&&(b.controlTemplate(u.UOMTextbox),a.currentEntity().fieldValues()[c].inputType("UOMTextbox")):(b.controlTemplate(u.MultiValue),a.currentEntity().fieldValues()[c].inputType("MultiValue")),b.controlTemplate()===u.Date&&a.currentEntity().fieldValues()[c].handleDate();break}}function oa(a,b){a.layoutElement=b,a.layoutElement.isHidden(a.hidden())}function pa(a){return/<a href=(|'|")#datasheet-dialog.*<\/a>/.test(a)}function qa(a){if(a.layoutRendered.raise(),
a.isDatasheetRendered(!0),a.uiHelper.addMoreOptionsForIcons(a,".form-ds-iconbar","form"),a&&a.region&&a.region.$element){var b=a.region.$element.find("mi-site-selector");if(b.length){a.siteSelector=b[0],Element.upgrade(a.siteSelector),"0"===a.siteKey()&&0===a.currentEntyKey()&&a.showSiteSelector()&&a.siteSelector.selectDefaultSite();var c=a.siteSelector.isSiteViewOnly;c&&(a.isSelectedSiteViewOnly(c),a.isSaveAvailable(!1),a.isDeleteAvailable(!1))}}}function ra(a,b){a.isDatasheetReadOnly()===!0?(a.uiHelper.setOverlay(a),b.elementCss("form-control-readonly"),b.headerCss("ds-group-header-disabled")):(b.elementCss("form-control"),b.headerCss("ds-group-header-enabled"))}I.prototype.setTabsOptions=function a(){var c=this,d=b.Deferred();return d=c.uiHelper.setTabsOptions(c,d)};function sa(a){a.region&&a.region.$element.find('[data-toggle="tab"], [data-toggle="pill"]').each(function(a,c){b(c).off("click")})}I.prototype.deallocateMem=function a(){!!this.kom&&this.kom.dispose(),
this.cachedFieldValues=null,this.translator=null,this.layoutElements=null,this.currentDatasheet=null,this.fieldInfos=null,this.iconsMoreOptions&&(this.iconsMoreOptions=null),this.datasheets=null,this.appEvents=null,this.isDatasheetRendered=null,this.datasheetKeys=null,this.isDatasheetReadOnly=null,this.currentDatasheetKey=null,this.isMasterDatasheet=null,this.isBulkDatasheet=null,this.helpTextModeOn=null,this.tabWidth=null,this.currentEntity&&this.currentEntity()&&this.currentEntity().dispose(),this.currentEntity=null,this.overlayHeight=null,this.overlayTop=null,this.canEdit=null,this.containerWidth=null,this.isReadOnly=null,this.isRefDocRendered=null,this.isRootRecordAvailable=null,this.isSaveAvailable=null,this.isSiteFiltered=null,this.showDatasheetSelection=null,this.showEditButton=null,this.showStateManagement=null,this.title=null,this.iconOptions=null,this.showTabScroll=null,this.currentEntyKey=null,this.isHistoryEnabled=null,
!!this.datasheetChanged&&this.datasheetChanged.remove(),!!this.datasheetHistory&&this.datasheetHistory.remove(),!!this.datasheetReference&&this.datasheetReference.remove(),!!this.refDocsRendered&&this.refDocsRendered.remove(),!!this.tabSwitched&&this.tabSwitched.remove(),this.canPaste=null,this.entityState=null,this.entykey=null,this.helpButtonText=null,this.hideMoreOptionsForIcons=null,this.isCopyAvailable=null,this.isDatasheetRenderedInRM=null,this.isDefaultHelpTextAvailable=null,this.isDeleteAvailable=null,this.isHistoryAvailable=null,this.isNewAvailable=null,this.isNewEntityCreated=null,this.isPasteEnabled=null,this.isRefDocEnabled=null,this.refDocCount=null,this.isReferencesAvailable=null,this.isUnlinkRecordAvailable=null,this.isUnlinkRecordEnabled=null,this.previousDatasheetKey=null,this.siteKey=null,!!this.beforeStateTransition&&this.beforeStateTransition.remove(),!!this.changeCanPaste&&this.changeCanPaste.remove(),!!this.currentEntityChanged&&this.currentEntityChanged.remove(),
!!this.datasheetDelete&&this.datasheetDelete.remove(),!!this.datasheetNew&&this.datasheetNew.remove(),!!this.datasheetSaved&&this.datasheetSaved.remove(),this.datasheetService=null,!!this.entityRendered&&this.entityRendered.remove(),!!this.fieldValueChanged&&this.fieldValueChanged.remove(),!!this.layoutRendered&&this.layoutRendered.remove(),!!this.onMasterDetail&&this.onMasterDetail.remove(),!!this.onStateTransition&&this.onStateTransition.remove(),!!this.refDocsHidden&&this.refDocsHidden.remove(),this.subscriptions=null,this.exportService=null,j.onChange.remove(this),this.assetContextKey=null,this.beforeStateTransition=null,this.cachedFamilykey=null,this.changeCanPaste=null,this.currentEntityChanged=null,this.datasheetChanged=null,this.datasheetDelete=null,this.datasheetHistory=null,this.datasheetNew=null,this.datasheetReference=null,this.datasheetSaved=null,this.entityReference=null,this.entityRendered=null,this.fieldValueChanged=null,this.kom=null,this.layoutRendered=null,
this.makeRootRecordEvent=null,this.onMasterDetail=null,this.onStateTransition=null,this.refDocsHidden=null,this.tabSwitched=null,this.unlinkRecordEvent=null,this.util=null,this.refDocsRendered=null,this.view=null,this.refDocPathModel=null,this.teamModel=null,this.siteSelector=null,this.oldEntity=null,this.assocFamilykey=null,this.assocDisabled=null,this.tabsMoreOptions&&(this.tabsMoreOptions=null),this.tabContainer&&(this.tabContainer=null),this.tabs&&(this.tabs=null),this.tabWidths&&(this.tabWidths=null),this.tabVms&&(this.tabVms=null),this.alternativeTabsContainer&&(this.alternativeTabsContainer=null),this.moreOptions&&(this.moreOptions=null),this.tabContainerContext&&(this.tabContainerContext=null),this.refdocEl&&(this.refdocEl=null),ta(this),this.region=null,this.refDocService=null,this.isStateTransitionDisabled=null,this.toggleEditBtnClicked=null,this.datasheetNavWidth=null,
this.appEvents&&this.appEvents.windowResized&&this.handleNavAppearance&&this.appEvents.windowResized.remove(this.handleNavAppearance,this)};function ta(a){if(a.region&&a.region.$element){var b=a.region.$element.find("mi-more-options-noko"),c;for(c=0;c<b.length;c++)"function"==typeof b[c].deallocateMem&&b[c].deallocateMem()}}I.prototype.onChangingClipboardData=function a(){var b=this;ha(b),b.changeCanPaste.raise(b.canPaste())},I.prototype.calculateTabWidth=function(){var a=this;a.uiHelper.calculateTabWidth(a)},I.prototype.calculateContainerWidth=function(){var a=this;a.uiHelper.calculateContainerWidth(a)};function ua(a){return a.tabWidth()>a.containerWidth()}I.prototype.makeRootRecord=function a(){this.recordManagerHelper.makeRootRecord()},I.prototype.unlinkRecord=function a(){this.recordManagerHelper.unlinkRecord()},I.prototype.addMoreOptionsForIcons=function a(){this.uiHelper.addMoreOptionsForIcons(this,".form-ds-iconbar","form")},I.prototype.setIconOptions=function a(){
var c=b.Deferred();return c=this.uiHelper.setIconOptions(this,"form")},I.prototype.setErrorAndReturnErrorFlag=function a(b){var c=this,d=!1;return this.util.clearAllErrorNotifications(b),d=this.util.setErrorAndReturnErrorFlag("form",b)},I.prototype.removeDOMElements=function a(c){var d=this;(c?b("."+c):d.region.$element).find("*").each(function(a,c){b.event.remove(c),b.removeData(c),wa(c)})};function va(a){a.isMasterDatasheet()&&a.region.$element.find(".datasheet-disabled-overlay").css("display","none")}function wa(a){var c=a.childNodes;if(c)for(var d=!1;!d;){for(var e=c.length,f=0;f<e;f+=1){var g=c[f];if(0===g.childNodes.length){b.event.remove(g),a.removeChild(g),d=!0;break}wa(g)}if(!d)break;d=!1}}function xa(a,b){a.printHelper.print(a,"form",b)}return I});

define('text!platform/datasheets/layout/ui/views/datasheetReference.html',[],function () { return '<div class="datasheetRefContainer">\r\n    <div class="row">\r\n        <button class="datasheetRefAddNew btn btn-primary pull-right" data-bind="click:addNewRef">Add</button>\r\n    </div>\r\n    <div class="row">\r\n        <div class="col-md-4">\r\n\r\n            <div class="list-group datasheetRefList" data-bind="foreach: references">\r\n\r\n                <div class="list-group-item" data-bind="text: $data.caption, click:function(){$parent.selectRef($data);}"></div>\r\n\r\n            </div>\r\n\r\n        </div>\r\n        <div class="col-md-8 dataReferenceInfo" data-bind="visible:isSelected">\r\n            <p><strong data-bind="text: selectedRef.caption"></strong> </p>\r\n            <div class="detailsView"></div>\r\n        </div>\r\n    </div>\r\n</div>';});

define('platform/datasheets/layout/ui/datasheet-reference-view-model',['require','knockout','spa/ko/knockout-view-model','system/lang/event','text!./views/datasheetReference.html'],function(require){"use strict";var a=require("knockout"),b=require("spa/ko/knockout-view-model"),c=require("system/lang/event"),d=require("text!./views/datasheetReference.html");function e(b){this.contentEl=d,f.call(this,this.contentEl),this.region=null,this.entityKey=b,this.references=a.observableArray(),this.newReference=new c,this.isSelected=a.observable(!1),this.selectedRef=a.mapping.fromJS({caption:null})}var f=Object.inherit(b,e);return e.prototype.attach=function a(b){f.prototype.attach.call(this,b),this.region=b},e.prototype.addNewRef=function a(){console.log("adding new reference")},e.prototype.selectRef=function b(c){a.mapping.fromJS(c,this.selectedRef)},e.prototype.loadReferences=function a(b){this.renderRefs(b)},e.prototype.renderRefs=function b(c){var d;for(d=0;d<c.length;d++)this.references.push(c[d]);a.mapping.fromJS(this.references()[0],this.selectedRef),this.isSelected(!0)},e});

define('text!platform/datasheets/layout/ui/views/DSFieldHistory.html',[],function () { return '<div class="datasheet-field-history" style="font-size:12px; height:100%;overflow:hidden;">\r\n    <div data-bind="visible: isAuthenticationEnabled" class="block-group auth-div-group">\r\n        <div class="block auth-div"><span data-bind="text: $root.translate(\'DS_AUTH_BY\') + \': \'"></span><span data-bind="text: createdBy"></span></div>\r\n        <div class="block auth-div"><span data-bind="text: $root.translate(\'DS_AUTH_DATE\') + \': \'"></span><span data-bind="text: createdDate"></span></div>\r\n    </div>\r\n    <div style="height: calc( 100% - 100px); overflow:auto;" class="table-responsive">\r\n        <table class="table table-bordered" data-bind="visible:FieldHistoryDTOs().length">\r\n            <thead style="background:#fff;">\r\n                <tr>\r\n                    <th class="sortable" data-bind="sort: { arr: FieldHistoryDTOs, prop: \'fieldCaption\'}, text: $root.translate(\'DS_FIELD\')"></th>\r\n                    <th class="sortable" data-bind="sort: { arr: FieldHistoryDTOs, prop: \'updateDate\' }, text: $root.translate(\'DS_CHANGED_ON\')"></th>\r\n                    <th class="sortable" data-bind="sort: { arr: FieldHistoryDTOs, prop: \'updateUser\' }, text: $root.translate(\'DS_CHANGED_BY\')"></th>\r\n                    <th data-bind="text: $root.translate(\'DS_NEW_VALUE\')"></th>\r\n                    <th data-bind="text: $root.translate(\'DS_PREVIOUS_VALUE\')"></th>\r\n                </tr>\r\n            </thead>\r\n            <tbody data-bind="foreach:FieldHistoryDTOs">\r\n                <tr>\r\n                    <td data-bind="text:$data.fieldCaption"></td>\r\n                    <td data-bind="text:$data.updateDate"></td>\r\n                    <td data-bind="text:$data.updateUser"></td>\r\n                    <td data-bind="text:$data.formattedNewValue"></td>\r\n                    <td data-bind="text:$data.formattedOldValue"></td>\r\n                </tr>\r\n            </tbody>\r\n        </table>\r\n    </div>\r\n    <div class="" style="height:50px;">\r\n        <button class="btn btn-primary pull-right" data-bind="click:closeHistory.bind($root), text: $root.translate(\'DS_CLOSE\')"></button>\r\n    </div>\r\n</div>';});

define('platform/datasheets/layout/services/manager-service',['require','jquery','system/http/ajax-client','security/services/user-dto'],function(require){"use strict";var a=require("jquery"),b=require("system/http/ajax-client"),c="api/core/security",d=require("security/services/user-dto");function e(a){this.ajaxClient=a}return e.dependsOn=[b],e.prototype.getUserFull=function(){var b=a.Deferred();return this.ajaxClient.get(c+"/sessionuser",{}).done(function(a){b.resolve(new d(a))}).fail(function(a){b.reject(a)}),b.promise()},e.prototype.getUserByKey=function(b){var e=a.Deferred();return this.ajaxClient.get(c+"/user/"+b).done(function(a){e.resolve(new d(a))}).fail(function(a){e.reject(a)}),e.promise()},e.prototype.login=function(b,d,e){var f=a.Deferred();return this.ajaxClient.post(c+"/login",{DatasourceId:b,Id:d,Password:e}).done(function(a){f.resolve(a)}).fail(function(a){a.preventSessionTimeoutDefault=!0,f.reject(a)}),f.promise()},e});
define('platform/datasheets/layout/ui/datasheet-history-view-model',['require','knockout','spa/ko/knockout-view-model','text!./views/DSFieldHistory.html','system/globalization/translator','platform/datasheets/layout/services/manager-service','application/application-context','moment','system/knockout/knockout-helpers'],function(require){"use strict";var a=require("knockout"),b=require("spa/ko/knockout-view-model"),c=require("text!./views/DSFieldHistory.html"),d=require("system/globalization/translator"),e=require("platform/datasheets/layout/services/manager-service"),f=require("application/application-context"),g=require("moment");require("system/knockout/knockout-helpers");function h(b){this.contentEl=c,i.call(this,this.contentEl),this.region=null,this.entity=null,this.dialog=null,this.entityKey=b,this.FieldHistoryDTOs=a.observableArray([]),this.translator=Object.resolve(d),this.managerService=Object.resolve(e),this.isAuthenticationEnabled=!1,this.createdBy=a.observable(),this.createdDate=a.observable(),this.dateFormat=a.observable(),f.user&&f.user.formats&&f.user.formats.dateTime&&this.dateFormat(f.user.formats.dateTime)}var i=Object.inherit(b,h);h.prototype.attach=function a(b,c){i.prototype.attach.call(this,b),this.region=b,this.entity=c},h.prototype.translate=function a(b){
return this.translator.translate(b)},h.prototype.loadHistory=function a(){var b=this,c;b.entity.getHistory().then(n.bind(null,b)),b.entity.isAuditable&&(b.isAuthenticationEnabled=!0,c=j(b,b.entity.createdDate),b.createdDate(c),b.managerService.getUserByKey(b.entity.createdBy).done(o.bind(null,b)))},h.prototype.setDialog=function a(b){this.dialog=b},h.prototype.closeHistory=function a(){this.dialog.closeDialog()};function j(a,b){return b?g(b).format(k(a.dateFormat())):b}function k(a){var b=a;return b=l("d","D",b),b=l("y","Y",b),b=l("h","H",b),b=l("tt","A",b)}function l(a,b,c){return c.replace(new RegExp(a,"g"),b)}function m(a,b){var c;for(c=0;c<a.length;c++)b.FieldHistoryDTOs.push(a[c])}function n(a,b){b.length?m(b,a):a.region.$element.find(".table-responsive").append(a.translate("DS_NO_HISTORY_AVAILABLE"))}function o(a,b){a.createdBy(b.displayName)}return h});

define('text!platform/datasheets/layout/ui/views/spinner.html',[],function () { return '<div class="load-spinner">\r\n    <span class="loading-med loading-active center-block"></span>\r\n</div>';});


define('text!platform/datasheets/layout/ui/views/datasheet-authentication-dialog.html',[],function () { return '<div>\r\n    <div>\r\n        <div data-bind="text: $root.translate(\'DS_AUTH_USER_ID\')"></div>\r\n        <div><input type="text" class="form-control" data-bind="value: $root.userId" disabled /></div>\r\n        <br />\r\n        <div data-bind="text: $root.translate(\'DS_AUTH_PASSWORD\')"></div>\r\n        <div><input type="password" class="form-control" data-bind="value: $root.password, attr: {placeholder: $root.translate(\'DS_AUTH_PASSWORD_PLACEHOLDER\')}" /></div>\r\n    </div>\r\n    <br />\r\n    <br />\r\n    <div class="authentication-dialog-buttons-div">\r\n        <button data-bind="text: $root.translate(\'DS_AUTH_SAVE\'), click: saveClicked" class="btn authentication-dialog-save-btn"></button>\r\n        <button data-bind="text: $root.translate(\'DS_AUTH_CANCEL\'), click: cancelClicked" class="btn"></button>\r\n    </div>\r\n</div>';});

define('platform/datasheets/layout/ui/datasheet-authentication-dialog-view-model',['require','jquery','knockout','spa/ko/knockout-view-model','text!platform/datasheets/layout/ui/views/datasheet-authentication-dialog.html','system/globalization/translator','system/lang/event','platform/datasheets/layout/services/manager-service','system/ui/message-box'],function(require){"use strict";var a=require("jquery"),b=require("knockout"),c=require("spa/ko/knockout-view-model"),d=require("text!platform/datasheets/layout/ui/views/datasheet-authentication-dialog.html"),e=require("system/globalization/translator"),f=require("system/lang/event"),g=require("platform/datasheets/layout/services/manager-service"),h=require("system/ui/message-box");function i(){var c=this;j.call(this,d),c.translator=Object.resolve(e),c.saveAllowed=new f,c.saveDenied=new f,c.saveCancelled=new f,c.password=b.observable(""),c.securityService=Object.resolve(g),c.userId=a.parseJSON(window.sessionStorage.getItem("meridium-session")).userId}var j=Object.inherit(c,i);i.prototype.translate=function a(b){return this.translator.translate(b)},i.prototype.saveClicked=function b(){var c=a.parseJSON(sessionStorage.getItem("meridium-session")).datasourceId,d=this
;if(""===d.password().trim())return void h.showOk(d.translate("DS_AUTH_PASSWORD_BLANK_MSG"),d.translate("DS_AUTH_FAILURE_DIALOG_TITLE"));d.securityService.login(c,d.userId,d.password()).done(k.bind(null,d)).fail(l.bind(null,d))},i.prototype.cancelClicked=function a(){this.saveCancelled.raise()};function k(a){a.saveAllowed.raise()}function l(a){a.saveDenied.raise()}return i});
define('platform/team-component/dto/member-dto',['require','mithril','system/lang/converter'],function(require){"use strict";var a=require("mithril"),b=require("system/lang/converter");function c(a){a=a||{},this.id=b.toString(a.id),this.entityKey=b.toString(a.key),this.firstName=b.toString(a.firstName),this.lastName=b.toString(a.lastName),this.jobTitle=b.toString(a.jobTitle),this.contentGuid=b.toString(a.contentGuid),this.email=b.toString(a.email),this.phoneNumber=b.toString(a.phoneNumber),this.hasPhoto=b.toString(a.hasPhoto),this.photoURL=b.toString(a.photoURL),this.areaOfResponsibility=b.toString(a.areaOfResponsibility),this.facility=b.toString(a.facility),this.modificationType=b.toString(a.modificationType),this.hrKey=b.toString(a.hrKey)}return c.fromDataCollection=function a(b){if(void 0===b||null===b)return[];var d,e=[];for(d=0;d<b.length;d++)e[e.length]=new c(b[d]);return e},c.prototype.PopulateHTML=function b(){var c="";return c+='<section class="content block-group"  data-key="'+this.entityKey+'">',c+='<div class="block col-10 icon-user">',
this.hasPhoto&&this.photoURL&&this.photoURL.length>0&&(c+='<img id="thumbnailPhoto" class="thumbnailPhoto" src="'+this.photoURL+'"/><br />',c+=this.id.toString()),c+="</div>",c+='<div class="block col-30"><b>',c+=this.lastName,this.firstName&&(c+=", "+this.firstName),c+="</b>",this.jobTitle&&(c+="<div>"+this.jobTitle.toString()+"</div>"),this.email&&(c+="<div>"+this.email.toString()+"</div>"),this.phoneNumber&&(c+="<div>"+this.phoneNumber.toString()+"</div>"),c+="</div>",c+="</section>",a.trust(c)},c});
define('platform/team-component/dto/team-dto',['require','mithril','system/lang/converter','application/application-context','./member-dto'],function(require){"use strict";var a=require("mithril"),b=require("system/lang/converter"),c=require("application/application-context"),d=require("./member-dto");function e(a){a=a||{},this.key=b.toString(a.key),this.id=b.toString(a.id),this.siteKey=b.toString(a.siteKey),this.members=f(a.teamMembers||a.members||[]),this.teamName=b.toString(a.id),this.modificationType=b.toString(a.modificationType)}e.prototype.PopulateHTML=function b(){var c="";return c+='<section class="content block-group"  data-key="'+this.key+'">',c+='<div class="block col-10 icon-resources">',this.hasPhoto&&this.photoURL&&this.photoURL.length>0&&(c+='<img id="thumbnailPhoto" class="thumbnailPhoto" src="'+this.photoURL+'"/><br />',c+=this.id.toString()),c+="</div>",c+='<a class="block col-30 team-name" style="color: #4A90E2; width: calc(100% - 170px)" data-bind="attr:{ href: ";rte=teams", title:  this.teamName  }" key='+this.key+">",c+=this.teamName,c+="</a>",
this.members&&this.members.length?(c+='<div class="block col-30 members-count-message" style="width: 100px; float:right;">'+this.members.length,c+=" Members</div>"):c+='<div class="block col-30 members-count-message" style="width: 100px; float:right;">0 Members</div>',c+="</section>",a.trust(c)},e.fromTeamCollection=function a(b){if(void 0===b||null===b)return[];var c,d=[];for(c=0;c<b.length;c++)d[d.length]=new e(b[c]);return d};function f(a){if(void 0===a||null===a)return[];var b,c=[];for(b=0;b<a.length;b++)c[c.length]=new d(a[b]);return c}return e});
define('platform/team-assignment-component/services/dto/team-member-dto',['require','mithril','system/lang/converter'],function(require){"use strict";var a=require("mithril"),b=require("system/lang/converter");function c(a){a=a||{},this.id=b.toString(a.id),this.entityKey=b.toString(a.key||a.entityKey),this.key=b.toString(a.key),this.hrKey=b.toString(a.hrKey),this.firstName=b.toString(a.firstName),this.lastName=b.toString(a.lastName),this.jobTitle=b.toString(a.jobTitle),this.contentGuid=b.toString(a.contentGuid),this.email=b.toString(a.email),this.phoneNumber=b.toString(a.phoneNumber),this.hasPhoto=b.toString(a.hasPhoto),this.photoURL=b.toString(a.photoURL),this.areaOfResponsibility=b.toString(a.areaOfResponsibility),this.facility=b.toString(a.facility),this.modificationType=b.toString(a.modificationType)}c.fromDataCollection=function a(b){if(void 0!==b){var d,e=[];for(d=0;d<b.length;d++)e[e.length]=new c(b[d]);return e}},c.prototype.PopulateHTML=function b(){var c="";return c+='<section class="content block-group"  data-key="'+this.entityKey+'">',c+='<div class="block col-10">',
this.hasPhoto&&this.photoURL&&this.photoURL.length>0&&(c+='<img id="thumbnailPhoto" class="thumbnailPhoto" src="'+this.photoURL+'"/><br />',c+=this.id.toString()),c+="</div>",c+='<div class="block col-30"><div class="name">',c+=this.lastName,this.firstName&&(c+=", "+this.firstName),c+="</div>",this.jobTitle&&(c+="<div>"+this.jobTitle.toString()+"</div>"),this.email&&(c+="<div>"+this.email.toString()+"</div>"),this.phoneNumber&&(c+="<div>"+this.phoneNumber.toString()+"</div>"),c+="</div>",c+="</section>",a.trust(c)},c.fromMembersContextDTO=function a(b){return new c({entityKey:b.entityKey,id:b.description})};function d(a){var c,d=[];for(c=0;c<a.length;c++)d[c]=b.toInteger(a[c][0]);return d}return c.fromJson=function(a){var b=new c;return b.description=a.description||"",b.isComplete=a.isComplete||!1,b},c.prototype.toJson=function(){return{description:this.description,isComplete:this.isComplete}},c});
define('platform/team-assignment-component/services/dto/assignment-dto',['require','platform/team-component/dto/team-dto','./team-member-dto'],function(require){"use strict";var a=require("platform/team-component/dto/team-dto"),b=require("./team-member-dto");function c(a){a=a||{},this.teams=d(a.teams),this.teamMembers=e(a.teamMembers)}function d(b){if(void 0===b||null===b)return[];var c,d=[];for(c=0;c<b.length;c++)d[d.length]=new a(b[c]);return d}function e(a){if(void 0!==a){var c,d=[];for(c=0;c<a.length;c++)d[d.length]=new b(a[c]);return d}}return c});
define('platform/team-assignment-component/services/assignment-service',['require','jquery','system/http/ajax-client','./dto/assignment-dto'],function(require){"use strict";var a=require("jquery"),b=require("system/http/ajax-client"),c=require("./dto/assignment-dto"),d="api/core/teammember";function e(a){this.ajaxClient=a}return e.dependsOn=[b],e.prototype.SyncTeamMembersAndTeams=function b(e,f,g,h,i){var j=a.Deferred(),k={teamMembersAndTeamsDTO:g};return this.ajaxClient.post(d+"/syncmembersandteams/"+e+"/"+f+"/"+h+"/"+i,g).done(function(a){j.resolve(new c(a))}).fail(function(a){j.reject(a)}),j.promise()},e.prototype.GetTeamMembersAndTeams=function b(e,f,g,h){var i=a.Deferred();return this.ajaxClient.get(d+"/getmembersandteams/"+e+"/"+f+"/"+g+"/"+h).done(function(a){i.resolve(new c(a))}).fail(function(a){i.reject(a)}),i.promise()},e});
define('platform/datasheets/forms-datasheet-manager',['require','jquery','lodash','./layout/ui/datasheet-view-model','spa/region','../entity/entity-factory','./layout/ui/datasheet-reference-view-model','./layout/ui/datasheet-history-view-model','logging/feedback-component/feedback-component','system/ui/dialog-view-model','text!./layout/ui/views/spinner.html','system/lang/event','system/ui/message-box','system/ui/unsaved-changes-message-box','./layout/services/manager-service','system/globalization/translator','system/lang/converter','application/application-events','ui/elements/ref-doc/models/refdoc-path-model','system/error/error-message','platform/metadata/services/metadata','application/application-context','system/ui/busy-indicator','./error-dialog/ui/error-dialog-view-model','platform/datasheets/layout/ui/datasheet-authentication-dialog-view-model','system/hardware/device','platform/team-assignment-component/services/assignment-service','bluebird'],function(require){"use strict"
;var a=require("jquery"),b=require("lodash"),c=require("./layout/ui/datasheet-view-model"),d=require("spa/region"),e=require("../entity/entity-factory"),f=require("./layout/ui/datasheet-reference-view-model"),g=require("./layout/ui/datasheet-history-view-model"),h=require("logging/feedback-component/feedback-component"),i=require("system/ui/dialog-view-model"),j=require("text!./layout/ui/views/spinner.html"),k=require("system/lang/event"),l=require("system/ui/message-box"),m=require("system/ui/unsaved-changes-message-box"),n=require("./layout/services/manager-service"),o=require("system/globalization/translator"),p=require("system/lang/converter"),q=require("application/application-events"),r=require("ui/elements/ref-doc/models/refdoc-path-model"),s=require("system/error/error-message"),t=require("platform/metadata/services/metadata"),u=require("application/application-context"),v=require("system/ui/busy-indicator"),w=require("./error-dialog/ui/error-dialog-view-model"),x=require("platform/datasheets/layout/ui/datasheet-authentication-dialog-view-model"),y=require("system/hardware/device"),z=require("platform/team-assignment-component/services/assignment-service"),A=require("bluebird")
;function B(a){this.defaultConfig={functionsavailable:["save","new","delete","references","history","copy"],readonly:!1,canedit:!0,showdatasheetselection:!0,delegatedatasheetsave:!1,loadedfrommodule:!0,loadedfromrecordmanager:!1,showdefaulthelptext:!0,showsiteselector:!0,disablesiteselector:!1,capturekeypress:!1,slimmerheader:!1},this.translator=Object.resolve(o),this.containerEl=a.containerel,this.scrollEl=a.scrollel,this.datasheetkey=a.datasheetkey,this.entityObj=a.entityobj,this.familyKey=a.familykey,this.assetContextKey=a.assetcontextkey,this.isEntity=a.isentity,this.savedSiteKey=null,this.preventSiteChangeUpdate=!1,this.currentDatasheetKey=a.currentDatasheetKey,this.dto=a.dto,this.datasheetKeys=a.datasheetKeys,this.refDocs=null,this.runningSpinner=null,this.appEvents=Object.resolve(q),this.entityFactory=new e,this.entityDeleted=new k,this.entityModified=new k,this.entityCreated=new k,this.entitySaved=new k,this.onMasterDetail=new k,this.beforeEntitiesSaved=new k,
this.fieldTouched=new k,this.entityIdChanged=new k,this.window=window,this.canInsert=!1,this.canUpdate=!1,this.canView=!1,this.canDelete=!1,this.isSuperUser=!1,this.makeRootRecordEvent=new k,this.unlinkRecordEvent=new k,this.masterDatasheetDirtyEvent=new k,this.refDocsSet=new k,this.newDatasheet=new k,this.indicator=Object.resolve(v),this.device=Object.resolve(y),this.messagebox=null,this.loadingPromises=[],this.canUpdateRefDocView=!1,this.teamAssignmentService=Object.resolve(z),this.savingFromUnsavedChangesDialog=new k}B.prototype.getState=function a(){return this.detachEntityEventHandlers(),pa(this)},B.prototype.getRefDocState=function a(){return this.layout&&this.layout.refdocEl&&this.layout.isRefDocRendered()?this.layout.refdocEl.getState():null},B.prototype.updateRefDocState=function a(b){b&&(this.refDocs=b,this.canUpdateRefDocView=!0)},B.prototype.removeDOMElements=function a(b){this.layout&&this.layout.removeDOMElements(b)},B.prototype.load=function b(c){
var d=this,e=a.Deferred(),f,g,h;return d.showSpinner(),d.setConfig(c),d.attachEventListeners(),g=d.getSecurityPrivPromise(),g.done(function(b){f=d.getEntityPromise(),f.done(function(b){d.cachedEntity&&(b=d.cachedEntity),d.entity=b,d.familyKey||(d.familyKey=d.entity.familyKey),d.attachEntityEventListeners(b),h=d.renderDatasheet(b),h.done(function(b){if(b)return d.clearSpinner(),void e.resolve();I(d),d.layout.afterLoad(),0!==d.entity.key&&d.layout.currentEntyKey(d.entity.key),d.entityCopy=a.extend(!0,{},d.entity),d.entityCopy.fields=d.entityCopy.fields.toJSON(),d.clearSpinner(),e.resolve(d.entity)}).fail(function(){d.throwException(d.translate("DS_RENDER_DATASHEET_FAIL_EXCEPTION")),e.reject()})}).fail(function(a,b){b&&403===b.status?(d.clearSpinner(),l.showOk(b.statusText)):d.entityObj&&0!==d.entityObj||d.canInsert?(d.clearSpinner(),d.throwException(d.translate("DS_LOAD_ENTITY_FAIL_EXCEPTION")+": "+b.responseText)):(d.clearSpinner(),
l.showOk(d.translate("DS_ENTITY_NO_INSERT_PRIV"),d.translator.translate("DS_INFORMATION"))),e.reject()})}),e},B.prototype.translate=function a(b){return this.translator.translate(b)},B.prototype.changeDatasheet=function b(c,d){var e=this,f=a.Deferred(),g;return e.setConfig(d),e.attachEventListeners(),e.showSpinner(),e.entity=c,e.familyKey||(e.familyKey=e.entity.familyKey),e.datasheetkey=e.currentDatasheetKey,e.attachEntityEventListeners(c),t.getEntityFamilyByKey(c.familyKey).done(function(a){e.canInsert=a.canInsert,e.canView=a.canView,e.canUpdate=a.canUpdate,e.canDelete=a.canDelete,e.fieldMetadata=a.fields,g=e.renderDatasheet(c),g.done(function(){e.clearSpinner(),I(e),f.resolve(e.entity)}).fail(function(){e.throwException(e.translate("DS_RENDER_DATASHEET_FAIL_EXCEPTION")),f.reject()})}).fail(function(a){f.reject(null,a)}),f},B.prototype.attachEventListeners=function a(){},B.prototype.unload=function b(c){var d=this,e=a.Deferred();c=c!==!0&&c!==!1||c
;var f=d.entityFactory.checkIfEntityDirty(d.entity);return f.done(C.bind(null,d,e)),f.fail(D.bind(null,d,e,c)),e};function C(a,b){if(!a.layout)return b.resolve(),b;if(a.layout.isRefDocEnabled&&a.layout.isRefDocEnabled()&&a.layout.isRefDocRendered()&&a.layout.refdocEl&&a.layout.refdocEl.datasheet){a.layout.refdocEl.datasheet.unload().done(fa.bind(null,a,b)).fail(F.bind(null,b))}else fa(a,b)}function D(a,b,c){c?N().done(E.bind(null,a,b)).fail(F.bind(null,b)):fa(a,b)}function E(b,c,d){if(0===d)fa(b,c);else if(1===d){var e=b.layout?b.layout.refDocPathModel:null,f=a.Deferred();b.showSpinner(),P(b,f,e,!0),b.savingFromUnsavedChangesDialog.raise(),a.when(f).done(fa.bind(null,b,c)).fail(F.bind(null,c))}}function F(a){a.reject()}B.prototype.setTitle=function a(b){var c=this;c.layout&&c.layout.setTitle(b)},B.prototype.showSpinner=function a(){this.containerEl.parent().prepend(j),this.spinner=this.containerEl.parent().find(".load-spinner"),this.runningSpinner=!0},
B.prototype.clearSpinner=function a(){this.spinner&&this.spinner.remove(),this.runningSpinner=!1},B.prototype.getSecurityPrivPromise=function b(){var c=a.Deferred(),d=this;return d.isSuperUser=u.user.isSuperUser,d.entityObj&&0!==d.entityObj?c.resolve():d.familyKey&&(isNaN(parseInt(d.familyKey))?t.getEntityFamilyByid(d.familyKey).done(function(a){d.canInsert=a.canInsert,d.canView=a.canView,d.canUpdate=a.canUpdate,d.canDelete=a.canDelete,d.fieldMetadata=a.fields,c.resolve(a)}):t.getEntityFamilyByKey(d.familyKey).done(function(a){d.canInsert=a.canInsert,d.canView=a.canView,d.canUpdate=a.canUpdate,d.canDelete=a.canDelete,d.fieldMetadata=a.fields,c.resolve(a)})),c.promise()},B.prototype.getEntityPromise=function b(){var c=this;if(c.entityObj&&0!==c.entityObj){if(p.toBoolean(c.isEntity,"true")){var d=a.Deferred();return d.resolve(c.entityObj),d.promise()}return c.loadEntity()}if(c.familyKey)return c.createEntity()},B.prototype.createEntity=function b(){var c=a.Deferred(),d=this
;return d.entityFactory.new(d.familyKey).done(function(a){c.resolve(a)}).fail(function(a){c.reject(null,a)}),c.promise()},B.prototype.loadEntity=function b(){var c=a.Deferred(),d=this;return d.entityFactory.get(d.entityObj).done(function(a){t.getEntityFamilyByKey(a.familyKey).done(function(b){d.canInsert=b.canInsert,d.canView=b.canView,d.canUpdate=b.canUpdate,d.canDelete=b.canDelete,d.fieldMetadata=b.fields,c.resolve(a)}).fail(function(a){c.reject(null,a)})}).fail(function(a,b){c.reject(a,b)}),c.promise()},B.prototype.updateState=function a(b){var c=!1,d;b&&(this.entityObj?(d=typeof this.entityObj,"string"===d||"number"===d?this.entityObj.toString()===b.key.toString()&&(c=!0):this.entityObj.key.toString()===b.key.toString()&&(c=!0)):this.familyKey&&(this.familyKey.toString()!==b.familyKey.toString()&&this.familyKey.toString()!==b.familyID.toString()||(c=!0)),c&&(this.cachedEntity=b))},B.prototype.renderDatasheet=function a(b){return this.renderGenericDatasheet(b)},
B.prototype.renderGenericDatasheet=function b(e){var f=a.Deferred(),g=this,h,i;return g.layout||(g.layout=Object.resolve(c)),0!==g.config.functionsavailable.length||g.config.showdefaulthelptext||g.layout.hideMoreOptionsForIcons(!0),g.region=new d,g.attachLayoutEventListeners(),g.region.setElement(g.containerEl),g.layout.isHistoryEnabled(e.isHistoryEnabled&&e.key),g.layout.isSiteFiltered(e.isSiteFiltered),"0"===e.siteKey&&M(g,e.siteKey),g.layout.siteKey(e.siteKey),g.savedSiteKey=e.siteKey,h=g.getRefDocStatus(e),h.done(function(a){g.layout.isRefDocEnabled&&g.layout.isRefDocEnabled(a),p.toBoolean(a,"true")&&(i=g.getRefDocCount(e),i.done(function(a){g.layout.refDocCount&&g.layout.refDocCount(a)}).fail(function(){g.layout.refDocCount("")}),g.loadingPromises&&g.loadingPromises.push(i))}).fail(function(){g.layout.isRefDocEnabled&&g.layout.isRefDocEnabled(!1)}),g.loadingPromises&&g.loadingPromises.push(h),
g.layout.showStateManagement(e.showStateManagement&&e.isStateManagementActive&&e.key&&g.config.functionsavailable.indexOf("state")>0),g.config.showsiteselector||g.layout.showSiteSelector(!1),g.layout.attach(g.region,g.scrollEl),"MI Reference Document"===e.familyID&&(g.layout.isReferenceDocument=!0,la(e)),g.layout.showDatasheet(g.datasheetkey,g.familyKey,da(g,e),e).done(function(){var b,c,d,h,i;if(!g.layout||!g.layout.cachedFieldValues)return void f.resolve(!0);e.isSiteFiltered&&0===e.key&&g.assetContextKey>0&&g.layout.assetContextKey(g.assetContextKey),g.config.loadedfromrecordmanager&&g.layout.isDatasheetRenderedInRM(!0),g.config.showdefaulthelptext||g.layout.isDefaultHelpTextAvailable(!1),0===e.key||g.isSuperUser||g.layout.isSelectedSiteViewOnly(!0),g.config.disablesiteselector&&g.layout.isSelectedSiteViewOnly(!0),0!==e.key&&g.layout.assocDisabled(!1),e.useUrlRedirection&&!g.config.loadedfrommodule?(g.layout.isDatasheetReadOnly(!0),g.layout.isCopyAvailable(!1),
g.layout.isSaveAvailable(!1),g.layout.isDeleteAvailable(!1),g.layout.isNewAvailable(!1),g.layout.showEditButton(!1),g.layout.canEdit(!1)):g.config.readonly?(g.layout.isDatasheetReadOnly(!0),g.layout.showEditButton(!0),g.layout.canEdit(g.config.canedit)):g.layout.isDatasheetReadOnly(!1),g.config.showdatasheetselection||g.layout.showDatasheetSelection(!1),g.config.capturekeypress&&g.layout.bindKeypress(!0),g.config.showdatasheetselection||g.config.showdefaulthelptext||0!==g.config.functionsavailable.length||(g.region.$element.find(".datasheet-layout-container .datasheet-nav").hide(),g.layout.uiHelper.setOverlay(g.layout)),g.layout.entityState(e.activeState),c=a(".datasheet-layout-container mi-date-time"),c.on("keypress keydown",G.bind(null,g)),b=c.css("background-color"),b&&c.find(".form-control").css("background-color",b),g.canUpdateRefDocView&&!g.layout.currentDatasheet().isMasterDetail()&&(g.layout.updateRefDocView(g.refDocs),g.canUpdateRefDocView=!1),
g.config.slimmerheader&&(g.layout.isSilmmerHeader(!0),g.region.$element.find(".datasheet-layout-container .datasheet-nav").addClass("slimmer-ds-nav")),g.layout.isReferenceDocument&&(a("#ref-doc-download-link").on("click",ma.bind(null,g)),d=oa(e.fields,"MIRD_DOC_PATH_CHR"),h=d.attributes.value,i={type:"UNC",documentPath:h},a("#ref-doc-unc-link").on("click",na.bind(null,g,i))),f.resolve()}).fail(function(a){"abort"===a?f.resolve():f.reject()}),f};function G(a,b){a&&a.device&&a.device.isMobile()&&b.preventDefault()}function H(b,c,d,e){return a.inArray(c,b.config.functionsavailable)>=0&&(d||e)}function I(b){b.config.functionsavailable&&(b.layout.isNewAvailable(!b.layout.isDatasheetReadOnly()&&H(b,"new",b.isSuperUser,b.canInsert)),0===b.entity.key?b.layout.isSaveAvailable(!b.layout.isDatasheetReadOnly()&&H(b,"save",b.isSuperUser,b.canInsert)):b.layout.isSaveAvailable(!b.layout.isDatasheetReadOnly()&&H(b,"save",b.isSuperUser,b.canUpdate)),
b.layout.isDeleteAvailable(!b.layout.isDatasheetReadOnly()&&H(b,"delete",b.isSuperUser,b.canDelete)),b.layout.isUnlinkRecordEnabled(H(b,"unlinkRecord",b.isSuperUser,b.canDelete)),b.layout.isPasteEnabled(!b.layout.isDatasheetReadOnly()&&H(b,"copy",b.isSuperUser,b.canInsert)&&H(b,"copy",b.isSuperUser,b.canUpdate)),a.inArray("references",b.config.functionsavailable)<0&&b.layout.isReferencesAvailable(!1),a.inArray("history",b.config.functionsavailable)<0&&b.layout.isHistoryAvailable(!1),a.inArray("copy",b.config.functionsavailable)<0&&b.layout.isCopyAvailable(!1),a.inArray("state",b.config.functionsavailable)<0&&b.layout.showStateManagement(!1),a.inArray("rootRecord",b.config.functionsavailable)<0&&b.layout.isRootRecordAvailable(!1),a.inArray("unlinkRecord",b.config.functionsavailable)<0&&b.layout.isUnlinkRecordAvailable(!1))}function J(a){a.config.disablesiteselector&&a.layout.isSelectedSiteViewOnly(!0),
a.layout.isNewAvailable(!a.layout.isDatasheetReadOnly()&&H(a,"new",a.isSuperUser,a.canInsert)),a.layout.isSaveAvailable(!a.layout.isDatasheetReadOnly()&&H(a,"save",a.isSuperUser,a.canUpdate)),a.layout.isDeleteAvailable(!a.layout.isDatasheetReadOnly()&&H(a,"delete",a.isSuperUser,a.canDelete)),a.layout.isPasteEnabled(!a.layout.isDatasheetReadOnly()&&H(a,"copy",a.isSuperUser,a.canInsert)&&H(a,"copy",a.isSuperUser,a.canUpdate))}B.prototype.getUserFamilyPrivileges=function a(){return this.userFamilyPrivileges},B.prototype.getRefDocStatus=function a(b){var c,d;return c=b.familyID,d=b.key,this.entityFactory.canRefDoc(c,d)},B.prototype.getRefDocCount=function a(b){var c;return c=b.key,this.entityFactory.getRefDocCount(c)},B.prototype.attachEntityEventListeners=function a(b){var c=this;b.entityModified&&b.entityModified.add(c.onEntityChanged,c),b.entitySaved&&b.entitySaved.add(c.onEntitySaved,c),b.entityDeleted&&b.entityDeleted.add(c.onEntityDeleted,c),
b.entityChangedEvent&&b.entityChangedEvent.add(c.onEntityChanged,c),b.entityIdChanged&&b.entityIdChanged.add(c.onEntityIdChanged,c)},B.prototype.attachLayoutEventListeners=function a(){var b=this;b.layout.fieldValueChanged.add(b.onLayoutFieldChanged,b),b.layout.datasheetNew.add(b.onDatasheetNew,b),b.layout.datasheetSaved.add(b.onDatasheetSaved,b),b.layout.datasheetDelete.add(b.onDatasheetDelete,b),b.layout.datasheetReference.add($.bind(null,b)),b.layout.datasheetHistory.add(_.bind(null,b)),b.layout.onMasterDetail.add(b.executeMasterDetail,b),b.layout.beforeStateTransition.add(b.beforeStateTransition,b),b.layout.onStateTransition.add(b.onStateTransition,b),b.layout.onSiteChange.add(b.handleSiteChange,b),b.layout.recordManagerHelper.makeRootRecordEvent.add(ia.bind(null,b)),b.layout.recordManagerHelper.unlinkRecordEvent.add(ja.bind(null,b)),b.layout.refDocsRendered.add(ka.bind(null,b)),b.layout.datasheetChanged.add(aa.bind(null,b)),b.layout.toggleEditBtnClicked.add(J.bind(null,b)),
b.layout.fieldTouched.add(K.bind(null,b)),b.appEvents&&b.appEvents.layoutChanged&&b.appEvents.layoutChanged.add(L.bind(null,b))};function K(a,b){a.fieldTouched.raise(b)}function L(a){a&&a.layout&&a.layout.onLayoutChanged()}B.prototype.handleSiteChange=function a(b){var c=this;if(c.preventSiteChangeUpdate)return void(c.preventSiteChangeUpdate=!1);c.entity&&(c.entity.siteKey=b,c.entityFactory.updateEntitySite(c.entity))};function M(a,b){return a.layout.siteKey()!==b&&(a.preventSiteChangeUpdate=!0,!0)}B.prototype.detachEntityEventHandlers=function a(){var b=this;b.entity&&(b.entity.entityModified&&b.entity.entityModified.remove(b),b.entity.entitySaved&&b.entity.entitySaved.remove(b),b.entity.entityDeleted&&b.entity.entityDeleted.remove(b),b.entity.entityChangedEvent&&b.entity.entityChangedEvent.remove(b),b.entity.entityIdChanged&&b.entity.entityIdChanged.remove(b)),b.layout&&(b.layout.fieldValueChanged&&b.layout.fieldValueChanged.remove(b),
b.layout.datasheetSaved&&b.layout.datasheetSaved.remove(b),b.layout.datasheetNew&&b.layout.datasheetNew.remove(b),b.layout.datasheetDelete&&b.layout.datasheetDelete.remove(b),b.layout.onMasterDetail&&b.layout.onMasterDetail.remove(b),b.layout.beforeStateTransition&&b.layout.beforeStateTransition.remove(b),b.layout.onStateTransition&&b.layout.onStateTransition.remove(b)),b.appEvents&&b.appEvents.layoutChanged&&b.appEvents.layoutChanged.remove(L.bind(null,b))},B.prototype.tabSwitched=function a(){var b=this;if(b.layout)return b.layout.tabSwitched},B.prototype.setConfig=function b(c){var d=this;d.config=c||{},d.config=ca(d.config),a.extend(d.defaultConfig,d.config),d.config=d.defaultConfig,d.validateConfig()},B.prototype.validateConfig=function a(){var b=this;b.entityObj&&0!==b.entityObj||b.familyKey||b.throwException(b.translate("DS_ENTITY_FAMILY_KEY_EXCEPTION"))},B.prototype.throwException=function a(b){var c=new s(1,b,"platform/datasheets/forms-datasheet-manager.js")
;this.appEvents.errorOccured.raise(this,c)},B.prototype.confirm=function a(b){return this.window.confirm(b)},B.prototype.callOnDatasheetNew=function b(){var c=a.Deferred();return this.onDatasheetNew().done(function(a){c.resolve(a)}),c},B.prototype.callOnDatasheetDelete=function b(){var c=this,d=a.Deferred();return c.onDatasheetDelete().done(function(a){d.resolve(a)}),d},B.prototype.callOnDatasheetCopy=function a(b){var d=this;d.layout||(d.layout=Object.resolve(c)),d.layout.setCachedFamilyKey(b.familyKey),d.layout.copyDatasheet()},B.prototype.callOnDatasheetPaste=function a(b){var d=this;d.layout||(d.layout=Object.resolve(c)),d.layout.pasteDatasheet()},B.prototype.callBeforeStateTransition=function a(b,c){this.beforeStateTransition(b,c)},B.prototype.callOnStateTransition=function a(b,c){this.onStateTransition(b,c)};function N(){return l.showUnsavedChanges()}B.prototype.onEntityChanged=function b(c,d,e,f,g,h){var i,j=this;i=e?d.dependentFields:null;var k=f?d.value:d.displayValue
;j.layout&&(j.entity.siteKey=j.layout.siteKey(),j.layout.updateFieldValue(d.key.toString(),d.value,d.values,k,d.pickList,d.isDisabled,d.isRequired,d.isHidden,d.errorMessage,d.backColor,d.maxNumberOfValues,i,d.jsModuleName,d.jsModuleParams,d.popJSModuleOnFocus,d.addParseValueParam,d.format,!0,d.successMessage,c.isDirty)),j.cachedEntity?j.cachedEntity=a.extend(!0,c,j.cachedEntity):j.cachedEntity=c,h&&g&&g!==h.lockSeqNbr&&j.layout.uiHelper.lockEntityUpdateHelper(j),j.entityModified.raise(d,e)},B.prototype.onEntitySaved=function b(c,d,e){var f,g=this;if(g.layout){for("function"==typeof d&&d.call(g,c,e),
f=0;f!==c.fields.length;f++)g.layout.updateFieldValue(c.fields[f].key.toString(),c.fields[f].value,c.fields[f].values,c.fields[f].displayValue,c.fields[f].pickList,c.fields[f].isDisabled,c.fields[f].isRequired,c.fields[f].isHidden,c.fields[f].errorMessage,c.fields[f].backColor,c.fields[f].maxNumberOfValues,c.fields[f].dependentFields,c.fields[f].jsModuleName,c.fields[f].jsModuleParams,c.fields[f].popJSModuleOnFocus,c.fields[f].addParseValueParam,c.fields[f].format,!1,c.fields[f].successMessage,c.isDirty);g.layout.isHistoryEnabled(g.entity.isHistoryEnabled&&g.entity.key),g.layout.isSiteFiltered(g.entity.isSiteFiltered),M(g,g.entity.siteKey),g.layout.siteKey(g.entity.siteKey),g.layout.currentEntyKey(c.key),0===g.entity.key||g.isSuperUser||g.layout.isSelectedSiteViewOnly(!0),g.savedSiteKey=g.entity.siteKey,g.getRefDocStatus(g.entity).done(function(a){null!==g.layout&&g.layout.isRefDocEnabled(a)}).fail(function(){null!==g.layout&&g.layout.isRefDocEnabled(!1)}),
g.layout.showStateManagement(g.entity.showStateManagement&&g.entity.isStateManagementActive&&g.entity.key&&g.config.functionsavailable.indexOf("state")>0)}g.entityCopy=a.extend(!0,{},g.entity),g.entityCopy.fields=g.entityCopy.fields.toJSON(),g.entitySaved.raise(g.entity),g.cachedEntity=g.entity},B.prototype.onEntityDeleted=function a(){var b=this;b.layout&&b.layout.isReadOnly(!0),b.entityDeleted.raise(b.entity),b.entity=null},B.prototype.onEntityIdChanged=function a(b){this.entityIdChanged.raise(b)},B.prototype.onDatasheetSaved=function b(c){var d=this,e,f=a.Deferred();return d.showSpinner(),d.entity.checkIfEntityDirty().done(O.bind(null,d,f,c)).fail(P.bind(null,d,f,c,!1)),f};function O(a,b,c){0===a.entity.key||a.savedSiteKey!==a.layout.siteKey()?P(a,b,c,!1):b.resolve(),a.clearSpinner()}function P(a,b,c){if(0===a.entity.updateReqCount&&0===a.entity.saveQueue)R(a,b,c);else{var d={};d.clearIntervalRef=setInterval(Q,100,d,a,b,c)}}function Q(a,b,c,d){
0===b.entity.updateReqCount&&0===b.entity.saveQueue&&(R(b,c,d),clearInterval(a.clearIntervalRef))}function R(a,b,c){if(a.layout.setErrorAndReturnErrorFlag(a))return b.reject(),void a.clearSpinner();a.entity.isAuditable?S(a,T,b,c):T(a,b,c)}function S(a,b,c,d){var e,f;e=Object.resolve(x),f=new i(e,a.translate("DS_AUTH_DIALOG_TITLE"),{height:300,width:400}),f.show(),e.saveAllowed.add(b.bind(null,a,c,d,f)),e.saveDenied.add(W.bind(null,a,f,c)),e.saveCancelled.add(V.bind(null,a,f))}function T(a,b,c,d){if(0!==a.entity.key||!a.layout.isNewEntityCreated()){if(0===a.entity.key&&a.layout.isNewEntityCreated(!0),a.config.delegatedatasheetsave){var e={entity:a.entity,datasheetSaveDfd:b};a.entity.entityModified=null,a.entity.entityDeleted=null,a.entity.entitySaved=null,a.entity.entityIdChanged=null,a.entity.entityChangedEvent=null,a.entity.siteKey=a.layout.siteKey(),a.beforeEntitiesSaved.raise(e),a.clearSpinner()}else if(a.layout.showSiteSelector()&&(a.entity.siteKey=a.layout.siteKey()),
a.entity.checkIfEntityDirty()||a.savedSiteKey!==a.layout.siteKey()){if(0===a.entity.key&&"-1"===a.entity.siteKey&&(a.entity.siteKey="0"),a.runningSpinner&&c){var f=a.region.$element.closest(".dialog-wrapper");f.length>0&&(f.find(".close-btn").attr("disabled",!0),f.find(".close-btn").parent().css("overflow","hidden"),f.find(".icon-close-popup").css("pointer-events","none"))}a.entityFactory.save(a.entity).done(function(d){c?c.isStored()?a.entityFactory.uploadRefDoc(c.formData,d.key).done(function(){a.clearSpinner(),f.length>0&&(f.find(".close-btn").attr("disabled",!1),f.find(".icon-close-popup").css("pointer-events","auto"))}).fail(function(){a.clearSpinner(),a.throwException(a.translate("REFDOCS_FAILED_TO_UPLOAD_REF_DOC"))
}):c.isUnc()?a.entityFactory.hasRefDocServerCredentials().done(X.bind(null,a)).fail(Y.bind(null,a)):a.clearSpinner():a.layout.teamModel?a.teamAssignmentService.SyncTeamMembersAndTeams(d.key,d.siteKey,a.layout.teamModel,a.layout.teamModel.hrRelId,a.layout.teamModel.teamRelId).done(function(a,b){a.clearSpinner()}.bind(null,a)).fail(U.bind(null,a)):a.clearSpinner(),a.layout.currentEntyKey(d.key),a.layout.isNewEntityCreated(!1),b.resolve()}).fail(function(c){a.clearSpinner(),a.layout.isNewEntityCreated(!1),c.statusCode&&409===c.statusCode().status?a.layout.uiHelper.lockEntityUpdateHelper(a):a.throwException(a.translate("DS_SAVE_ENTITY_FAIL_EXCEPTION")+": "+c.responseText),b.reject()})}V(a,d)}}function U(a,b){a.clearSpinner(),a.throwException("Failed to sync Members and Teams: "+b.responseText)}function V(a,b){b&&b.closeDialog()}function W(a,b,c){V(a,b),l.showOk(a.translate("DS_AUTH_FAILURE_MSG"),a.translate("DS_AUTH_FAILURE_DIALOG_TITLE")),c.reject()}function X(a,b){var c=new h({
closeButton:!0,timeOut:"200",hideDuration:"200"});b===!1&&c.warning(a.translate("REFDOCSERVER_NO_CREDENTIALS"),a.translate("REFDOCSERVER")),a.clearSpinner()}function Y(a){new h({closeButton:!0,timeOut:"200",hideDuration:"200"}).error(a.translate("REFDOCSERVER_FAILED_CREDENTIALS"),a.translate("REFDOCSERVER")),a.clearSpinner()}B.prototype.onDatasheetNew=function b(){var c=a.Deferred(),d=this;if(d.layout.isDatasheetRenderedInRM())return d.newDatasheet.raise(d.familyKey),c.resolve(),c;if(null!==d.entity){if(0!==d.entity.updateReqCount)return void d.throwException(d.translate("DS_CANNOT_ADD_NEW_ENTITY_EXCEPTION"));d.entityFactory.checkIfEntityDirty(d.entity).done(function(){if(d.layout.isMasterDatasheet())return c.resolve(d.entity),c;d.layout&&d.layout.isReadOnly(!1),d.entityFactory.new(d.familyKey).done(function(a){d.entity=a,d.attachEntityEventListeners(a),d.layout.isHistoryEnabled(a.isHistoryEnabled&&a.key),d.layout.isSiteFiltered(a.isSiteFiltered),M(d,a.siteKey),
d.layout.siteKey(a.siteKey),d.savedSiteKey=a.siteKey,d.getRefDocStatus(d.entity).done(function(a){d.layout.isRefDocEnabled(a)}).fail(function(){d.layout.isRefDocEnabled(!1)}),d.layout.showStateManagement(a.showStateManagement&&a.isStateManagementActive&&a.key&&d.config.functionsavailable.indexOf("state")>0),d.layout.setCurrentEntity(da(d,d.entity)),d.entityCreated.raise(a),c.resolve(a)})}).fail(function(){N().done(function(b){if(0===b)Z(d,c);else if(1===b){var e=d.layout?d.layout.refDocPathModel:null,f=a.Deferred();d.showSpinner(),P(d,f,e,!0),a.when(f).done(Z.bind(null,d,c))}})})}else d.entityFactory.new(d.familyKey).done(function(a){d.entity=a,d.attachEntityEventListeners(a),d.layout.isHistoryEnabled(a.isHistoryEnabled&&a.key),d.layout.isSiteFiltered(a.isSiteFiltered),M(d,a.siteKey),d.layout.siteKey(a.siteKey),d.savedSiteKey=a.siteKey,d.getRefDocStatus(d.entity).done(function(a){d.layout.isRefDocEnabled(a)}).fail(function(){d.layout.isRefDocEnabled(!1)}),
d.layout.showStateManagement(a.showStateManagement&&a.isStateManagementActive&&a.key&&d.config.functionsavailable.indexOf("state")>0),d.layout.setCurrentEntity(da(d,d.entity)),d.entityCreated.raise(a),c.resolve(a)});return c};function Z(a,b){a.cachedEntity=null,a.layout&&a.layout.isReadOnly(!1),a.entityFactory.new(a.familyKey).done(function(c){a.entity=c,a.attachEntityEventListeners(c),a.layout.isHistoryEnabled(c.isHistoryEnabled&&c.key),a.layout.isSiteFiltered(c.isSiteFiltered),M(a,c.siteKey),a.layout.siteKey(c.siteKey),a.savedSiteKey=c.siteKey,a.getRefDocStatus(a.entity).done(function(b){a.layout.isRefDocEnabled(b)}).fail(function(){a.layout.isRefDocEnabled(!1)}),a.layout.showStateManagement(c.showStateManagement&&c.isStateManagementActive&&c.key&&a.config.functionsavailable.indexOf("state")>0),a.layout.setCurrentEntity(da(a,a.entity)),a.entityCreated.raise(c),b.resolve(c)}),a.masterDatasheetDirtyEvent.raise()}B.prototype.onDatasheetDelete=function b(){var c=a.Deferred(),d=!0,e=this
;return 0!==e.entity.key?l.showYesNo(e.translate("DS_DELETE_ENTITY_MESSAGE"),e.translate("CONFIRM_REC_DEL")).done(function(a){0===a&&e.entityFactory.delete(e.entity).done(function(a){c.resolve(a)}).fail(function(a){l.show(a,"Error!"),c.reject()})}):l.showOk(e.translate("DS_CANNOT_DELETE_ENTITY_EXCEPTION"),e.translate("DS_ALERT_TITLE")),c};function $(a){a.layout.entykey(a.entity.key)}function _(a){var b=Object.resolve(g),c=new d;b.attach(c,a.entity),b.loadHistory();var e=new i(b,a.translate("DS_FIELD_HISTORY_TITLE"),{height:"90%",width:"80%"});b.setDialog(e),e.show()}function aa(b){b.layout.datasheetService.getDatasheet(b.layout.currentDatasheetKey()).done(function(c){c&&c.isMasterDetail?b.entityFactory.checkIfEntityDirty(b.entity).done(function(){b.layout.previousDatasheetKey(b.layout.currentDatasheetKey()),b.layout.executeDatasheetChanged(c)}).fail(function(){N().done(function(d){if(0===d)ba(b,c);else if(1===d){var e=b.layout?b.layout.refDocPathModel:null,f=a.Deferred()
;b.showSpinner(),P(b,f,e,!0),a.when(f).done(ba.bind(null,b,c))}}).fail(function(){b.layout.proceed=!1,b.layout.currentDatasheetKey(b.layout.previousDatasheetKey())})}):c&&!c.isMasterDetail&&b.layout.executeDatasheetChanged(c,da(b,b.entity))})}function ba(a,b){a.cachedEntity=null,a.layout.previousDatasheetKey(a.layout.currentDatasheetKey()),a.layout.executeDatasheetChanged(b)}B.prototype.onLayoutFieldChanged=function a(b,c,d,e,f){var g=this;g.entity.siteKey=g.layout.siteKey(),f?g.entityFactory.updateFieldByKey(g.entity,c,d,f):g.entityFactory.updateFieldValue(g.entity,c,d,e,!0)},B.prototype.executeMasterDetail=function a(b,c,d,e){var f=this,g;f.layout.detach(f.region),g=0===f.entity.key?f.entityFactory.new(f.entity.familyKey):f.entityFactory.get(f.entity.key),g.done(function(a){a=qa(f,a),f.onMasterDetail.raise(b,c,a,d,e)}).fail(function(){f.throwException(f.translate("DS_LOAD_ENTITY_FAIL_EXCEPTION"))})},B.prototype.beforeStateTransition=function a(b,c){},
B.prototype.onStateTransition=function a(b,c){var d=this,e=c.originalEvent.detail;new h({closeButton:!0,timeOut:"200",hideDuration:"200"}).success(d.translator.translate("STATE_CHANGE")+e.transitionData.activeState.caption);var f=d.layout.isMasterDatasheet();d.unload().done(function(){d.load(d.config).done(function(){d.entitySaved.raise(d.entity),d.layout.isMasterDatasheet(f)})})},B.prototype.displayError=function a(b,c){for(var d="",e="",f=!1,g=[],j=0;j<c.length;j++)c[j].errorMessage&&(d=c[j].id,e="locerror"===c[j].errorMessage?b.translate("CMMS_ERROR_LOC"):b.translate("CMMS_ERROR_RISK"),g.push({id:d,errorMessage:e}),f=!0);if(f){var k=new w(g),l=new i(k,b.translate("MSG_CMMS_ERROR"));k.closeDialog.add(function(){l.closeDialog()}),l.show()}else{new h({closeButton:!0,timeOut:"200",hideDuration:"200"}).success(b.translate("MSG_CMMS_SUCC"))}};function ca(b){var c={};return a.each(b,function(a,b){c[a.toLowerCase()]=b}),c}function da(a,c){
for(var d=c.fields.models.length,e,f,g=[],h=0;h<d;h++)e=c.fields.models[h].get("key"),f=b.find(a.fieldMetadata,ea.bind(null,e)),g.push({fieldKey:e,fieldId:c.fields.models[h].get("id"),fieldValue:c.fields.models[h].get("value"),fieldDisplayValue:c.fields.models[h].get("displayValue"),options:{required:c.fields.models[h].get("isRequired"),disabled:c.fields.models[h].get("isDisabled"),isHtmlField:c.fields.models[h].get("isHtmlField"),unitOfMeasure:c.fields.models[h].get("unitOfMeasure"),unitOfMeasureKey:c.fields.models[h].get("unitOfMeasureKey"),picklist:c.fields.models[h].get("pickList"),backColor:c.fields.models[h].get("backColor"),jsModuleName:c.fields.models[h].get("jsModuleName"),jsModuleParams:c.fields.models[h].get("jsModuleParams"),jsModuleUseApply:c.fields.models[h].get("jsModuleUseApply"),popJSModuleOnFocus:c.fields.models[h].get("popJSModuleOnFocus"),addParseValueParam:c.fields.models[h].get("addParseValueParam"),dependentFields:c.fields.models[h].get("dependentFields"),
isPicklistRestricted:c.fields.models[h].get("isPicklistRestricted"),maxNumberOfValues:c.fields.models[h].get("maxNumberOfValues"),values:c.fields.models[h].get("values"),helpText:c.fields.models[h].get("helpText"),format:c.fields.models[h].get("format"),dbLength:c.fields.models[h].get("dbLength"),behaviors:f?f.behaviors:null,hidden:c.fields.models[h].get("isHidden")}});return g}function ea(a,b){return b.key===a}function fa(a,b){a.cachedEntity=null,a.layout&&(ga(a),a.detachEntityEventHandlers(),a.layout.deallocateMem(),a.layout.detach(a.region),a.layout=null,b.resolve())}function ga(a){var b;for(b=0;b<a.loadingPromises.length;b++)ha(a.loadingPromises[b]);a.loadingPromises=[],a.layout.abortLoadingPromises()}function ha(a){a.request.abort()}function ia(a){a.makeRootRecordEvent.raise(a.entity)}function ja(a){a.unlinkRecordEvent.raise(a.entity)}function ka(a,b){a.refDocs=b,t.getEntityFamilyByid("MI Reference Document").done(function(a,b){a.refDocs.isAddAllowed(b.canInsert||a.isSuperUser),
a.refDocs.isUnlinkAllowed(b.canDelete||a.isSuperUser)}.bind(null,a)),a.refDocsSet.raise()}function la(a){var b,c,d,e;b=oa(a.fields,"MI_REF_DOCUMENTS_STORE_DOCUM_L"),c=oa(a.fields,"MIRD_DOC_PATH_CHR"),d=!(!b.attributes.value||"true"!==b.attributes.value.toString().toLowerCase()),""!==(e=c.attributes.value)&&(d?c.attributes.displayValue='<a href="#" id="ref-doc-download-link">'+e+"</a>":!d&&e.startsWith("\\")?c.attributes.displayValue='<a href="#" id="ref-doc-unc-link">'+e+"</a>":c.attributes.displayValue='<a href="'+e+'" target="tab">'+e+"</a>")}function ma(a,b){a.layout.downloadRefdoc(),b&&b.preventDefault()}function na(a,b,c){a.layout.uncDownloadRefDoc(b,c),c&&c.preventDefault()}function oa(a,c){return b.find(a.models,function(a){return a.id===c})}function pa(a){return a.entity&&"-1"===a.entity.siteKey?a.cachedEntity=a.entity:a.cachedEntity&&a.entity&&"0"===a.entity.siteKey&&(a.cachedEntity.siteKey="0"),a.cachedEntity}function qa(a,b){
return"-1"===a.savedSiteKey&&0===b.key&&(b.siteKey=a.savedSiteKey),b}return B});
define('platform/datasheets/layout/ui/bulk-column-view-model',['require','knockout','system/knockout/knockout-helpers'],function(require){"use strict";var a=require("knockout");require("system/knockout/knockout-helpers");function b(b){b=b||{},this.columnCaption=b.columnCaption,this.columnFieldKey=b.columnFieldKey,this.model=b,this.controlTemplate=a.observable(),this.fieldValue=a.observable(),this.fieldValue.subscribe("function"==typeof this.model.fieldValue?this.model.fieldValue:function(){}),this.isSelected=a.observable(!1),this.entitykey=null,this.clientid=null,this.elementCss=a.observable("form-control")}return b.prototype.deallocateMem=function a(){this.columnCaption=null,this.columnFieldKey=null,this.controlTemplate=null,this.fieldValue=null,this.isSelected=null,this.entitykey=null,this.clientid=null,this.elementCss=null},b});
define('platform/datasheets/layout/ui/bulk-row-view-model',['require','lodash','jquery','knockout','./bulk-column-view-model','application/application-context','system/knockout/knockout-helpers'],function(require){"use strict";var a=require("lodash"),b=require("jquery"),c=require("knockout"),d=require("./bulk-column-view-model"),e=require("application/application-context");require("system/knockout/knockout-helpers");function f(a,d,f,g){var j=this;b.isArray(a)?this.entityKeyArray=c.observableArray(a):this.entitykey=c.observable(a),this.isCheckboxDisabled=c.observable(!1),this.clientid=c.observable(d),this.cols=c.observableArray(),this.isReadonly=c.observable(!1),this.isModified=c.observable(!1),this.isSelected=c.observable(!1),this.isFrozen=c.observable(!1),this.entityStatus=c.observable(),this.refDocPathModel=c.observable(),this.siteKey=c.observable(),this.isSelectedSiteViewOnly=c.observable(!1),this.preventSiteChangeUpdate=!1,this.isSuperUser=e.user.isSuperUser,0!==a&&(this.siteKey(g),this.isSuperUser||this.isSelectedSiteViewOnly(!0)),f.isSelectedSiteViewOnly&&f.isSelectedSiteViewOnly()&&this.isSelectedSiteViewOnly(!0),
f.frozenColsKeys&&(this.frozenColsKeys=f.frozenColsKeys,this.freezedCols=c.pureComputed(i.bind(j,j)),this.floatCols=c.pureComputed(l.bind(j,j))),this.entityStatusClass=c.computed(h.bind(null,this))}f.prototype.addColumns=function b(c){var e=this,f=a.map(c,function(a){return new d(a)});e.cols(f)},f.prototype.addColumn=function a(b){this.cols.push(new d(b))},f.prototype.deallocateMem=function a(){this.entityKeyArray&&(this.entityKeyArray=null),this.entitykey&&(this.entitykey=null),this.isCheckboxDisabled=null,this.clientid=null,g(this),this.cols=null,this.isReadonly=null,this.isModified=null,this.isSelected=null,this.isFrozen=null,this.entityStatus=null,this.frozenColsKeys&&(this.frozenColsKeys=null),this.freezedCols&&(this.freezedCols.dispose(),this.freezedCols=null),this.floatCols&&(this.floatCols.dispose(),this.floatCols=null),this.entityStatusClass&&(this.entityStatusClass.dispose(),this.entityStatusClass=null)};function g(a){var b
;for(b=0;b<a.cols().length;b++)a.cols()[b].deallocateMem(),a.cols()[b]=null}function h(a){return"new-clean"===a.entityStatus()?"ds-more":"new-dirty"===a.entityStatus()?"ds-add":"clean"===a.entityStatus()?"ds-save":"ds-edit"}function i(b){return a.filter(b.cols(),j.bind(null,b.frozenColsKeys()))}function j(b,c){return a.includes(b,c.columnFieldKey)}function k(a,b){return b.columnFieldKey===a}function l(b){return a.filter(b.cols(),m.bind(null,b.frozenColsKeys()))}function m(b,c){return!a.includes(b,c.columnFieldKey)}function n(a,b){return a.columnFieldKey===b}return f});
define('platform/datasheets/layout/ui/bulk-column-chooser',['require','lodash','jquery','knockout','spa/ko/knockout-view-model','system/knockout/knockout-helpers'],function(require){"use strict";var a=require("lodash"),b=require("jquery"),c=require("knockout"),d=require("spa/ko/knockout-view-model");require("system/knockout/knockout-helpers");function e(a){this.layout=a,f.call(this,'<div data-bind="template:\'bdf-column-chooser\'" style="height:100%;"></div>'),this.dialog=null,this.selCols=this.layout.selectedColumns()}var f=Object.inherit(d,e);e.prototype.toggleSelectAll=function a(){this.layout.selectedColumns().length!==this.layout.columns().length&&this.layout.selectedColumns([].concat(this.layout.columns()))},e.prototype.toggleSelectColumn=function a(c,d,e){var f=this.selectedColumns();if(d.fieldValue&&d.fieldValue()&&d.fieldValue().required())return!1;if(c.isActive(d)){if(f.length>2){var h=b.grep(f,function(a){return a.columnFieldKey!==d.columnFieldKey});this.selectedColumns(h)}}else{f=[].concat(f),f.push(d);var i=g(this.columns(),f);this.selectedColumns(i)}};function g(b,c){var d=[];return a.each(b,function(b){
var e=a.find(c,function(a){return b.columnFieldKey===a.columnFieldKey});e&&d.push(e)}),d}return e.prototype.isActive=function b(c){return!!a.find(this.layout.selectedColumns(),function(a){return a.columnFieldKey===c.columnFieldKey})},e.prototype.reOrder=function a(){this.dialog&&this.dialog.closeDialog(),this.layout.changeColumns()},e.prototype.cancel=function a(){this.layout.selectedColumns([].concat(this.selCols)),this.dialog&&this.dialog.closeDialog()},e.prototype.setDialog=function a(b){this.dialog=b},e});

define('text!platform/datasheets/layout/ui/views/bulk-datasheet.html',[],function () { return '<div class="datasheet-layout-container bulk-form-datasheet" data-bind="css:{\'edit\':!isDatasheetReadOnly() || !canEdit(), \'bulk-datasheet-readonly-container\': isDatasheetReadOnly}">\r\n    <div style="height:100%">\r\n\r\n        <!-- Bulk DS Nav Section -->\r\n        <div class="bulk-datasheet-header-container">\r\n            <h2 data-bind="text: title"></h2>\r\n            <div data-bind="if: isDatasheetRendered" class="datasheet-nav">\r\n                <div class="bulk-datasheet-nav datasheet-toolbar">\r\n                    <div class="datasheet-selector-container block b7" data-bind="visible: showDatasheetSelection">\r\n                        <div class="datasheet-lbl1">\r\n                            <span data-bind="text: $root.translate(\'DS_DATASHEET_ID_LABEL\')"></span>:\r\n                        </div>\r\n                        <mi-select class="" data-bind="miproperty:{\r\n                        value: currentDatasheetKey,\r\n                        options: datasheetKeys,\r\n                        optionsValue:\'key\',\r\n                        optionsText:\'caption\'}"></mi-select>\r\n                    </div>\r\n                    <div class="datasheet-empty-space-container block b7" data-bind="visible: !showDatasheetSelection()">\r\n                    </div>\r\n                    <div class="datasheet-controls-container block b5">\r\n                        <!-- ko if: canEdit -->\r\n                        <div class="datasheet-btn-group bulk-datasheet-edit-control" data-bind="visible: isDatasheetReadOnly, click:showEditMode">\r\n                            <button class="btn btn-icon" data-bind="attr: {title: translate(\'DS_EDIT_TOOLTIP\')}">\r\n                                <i class="icon-edit"></i>\r\n                            </button>\r\n                        </div>\r\n                        <!-- /ko -->\r\n                        <div class="datasheet-btn-group bulk-ds-iconbar" data-bind="visible: !isDatasheetReadOnly()">\r\n                            <button class="btn btn-icon " data-bind="visible: isDatasheetRendered(), click: toggleSelectMode, attr: {title: translate(\'DS_SELECT_TOOLTIP\')}"><i class="icon-select-all"></i> </button>\r\n                            <mi-associated-pages-btn familykey entitykey data-bind="attr: { familykey: assocFamilyKey(), entitykey: assocEntityKey(), disabled: !isSingleEntitySelected() } " hideifnorecords="true"></mi-associated-pages-btn>\r\n                            <button class="btn btn-icon" data-bind="visible: isDatasheetRendered() && isSaveAvailable() && !ValidateBeforeSave(), click: saveDatasheet, attr: {title: translate(\'DS_SAVE_TOOLTIP\')}"><i class="icon-save"></i></button>\r\n                            <button class="btn btn-icon" data-bind="visible: isDatasheetRendered() && isSaveAvailable() && ValidateBeforeSave(), click: saveDatasheet2, attr: {title: translate(\'DS_SAVE_TOOLTIP\')}"><i class="icon-save"></i> </button>\r\n                        </div>\r\n                        <!-- ko if: isRefDocFamily() -->\r\n                        <div class="datasheet-btn-group reference-doc-download">\r\n                            <button class="btn btn-icon" data-bind="click: downloadRefDoc, disable: !(isSingleEntitySelected() && canDownloadRefDoc()), attr: {title: translate(\'DS_DOWNLOAD_REF_DOC\')}"><i class="icon-download"></i></button>\r\n                        </div>\r\n                        <!-- /ko -->\r\n                        <!-- ko if: !isMasterDatasheet()-->\r\n                        <div class="datasheet-btn-group  print-btn-group">\r\n                            <button class="btn btn-icon" data-bind="click : print, attr: {title: translate(\'PRINT\')}"><i class="icon-printer"></i></button>\r\n                        </div>\r\n                        <!-- /ko -->\r\n                        <div class="datasheet-btn-group" data-bind="visible:maxPage()>1">\r\n                            <mi-select data-bind="miproperty:{\r\n                                   options:pageOptions,\r\n                                   optionsValue:\'value\',\r\n                                   optionsText:\'text\',\r\n                                   value:pageSelector,\r\n                                   editable:false\r\n                                   }"></mi-select>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <h5 data-bind="visible: isMasterDatasheet(), text: currentDatasheetCaption"></h5>\r\n        </div>\r\n        <!-- end of Bulk DS  Nav-->\r\n        <!-- Custom Table for Bulk DS -->\r\n        <div class="bulk-datasheet-table" style="height:calc(100% - 65px);overflow:auto;">\r\n\r\n            <!-- Table header -->\r\n            <div class="bulk-datasheet-table-header">\r\n\r\n                <!-- table header frozen columns -->\r\n                <div class="freezed-cols-container pull-left">\r\n                    <table class="table table-cust1-header">\r\n                        <thead>\r\n                            <tr data-bind="">\r\n                                <th class="status-col"></th>\r\n                                <th class="row-selector" data-bind="visible:$root.selectMode()">\r\n                                    <div class="checkbox-selectall">\r\n                                        <mi-checkbox class="row-selection" data-bind="miCheckboxProperty:{ checked:$root.selectAll}"> </mi-checkbox>\r\n\r\n                                    </div>\r\n                                </th>\r\n                                <!-- ko if: $root.isDatasheetRendered() && $root.isSiteFiltered() && $root.showSiteSelector -->\r\n                                <th class="site-selector-caption" data-bind="text: translate(\'DS_SITE_CAPTION\')"></th>\r\n                                <!-- /ko -->\r\n                                <!-- ko foreach:freezedCols -->\r\n                                <th class="freezed-column" data-bind="text:columnCaption,attr:{title:columnCaption},event:{click:$parent.selectColumn.bind($parent)},css:{\'selected\':$data.isSelected}"></th>\r\n                                <!-- /ko -->\r\n\r\n                            </tr>\r\n                        </thead>\r\n                    </table>\r\n                </div>\r\n                <!-- end of table header frozen columns -->\r\n                <!-- table header floating columns -->\r\n                <div class="table-responsive" data-bind="css: {\'datasheet-readonly-container\': isDatasheetReadOnly}">\r\n                    <table class="table table-cust1-header bulk-float-table">\r\n                        <thead>\r\n                            <tr data-bind="">\r\n                                <!-- ko foreach:floatCols -->\r\n                                <th data-bind="text:columnCaption,attr:{title:columnCaption},event:{click:$parent.selectColumn.bind($parent)},css:{\'selected\':$data.isSelected}"></th>\r\n                                <!-- /ko -->\r\n                            </tr>\r\n                        </thead>\r\n                    </table>\r\n                </div>\r\n                <!-- end of table header floating columns -->\r\n            </div>\r\n            <!-- end of Table Header -->\r\n            <!-- Table Body section-->\r\n            <div class="bulk-datasheet-table-body">\r\n\r\n                <!-- Frozen rows section -->\r\n                <div class="freezed-rows-container">\r\n\r\n                    <!-- frozen rows\'s frozen columns -->\r\n\r\n                    <div class="freezed-cols-container pull-left">\r\n                        <table class="table table-cust1">\r\n                            <tbody data-bind="foreach:frozenRows">\r\n                                <tr data-bind="css:{\'active\':$data.isSelected}">\r\n                                    <td class="status-col">\r\n                                        <span data-bind="attr: {class: entityStatusClass}"></span>\r\n                                    </td>\r\n                                    <td class="row-selector" data-bind="visible:$root.selectMode()">\r\n                                        <div class="checkbox-selectall">\r\n                                            <mi-checkbox class="row-selection" data-bind="miCheckboxProperty:{ checked:$data.isSelected, value:$data.entitykey, disable:$data.isCheckboxDisabled}"> </mi-checkbox>\r\n\r\n                                        </div>\r\n                                    </td>\r\n                                    <!-- ko if: $root.isDatasheetRendered() && $root.isSiteFiltered() && $root.showSiteSelector() -->\r\n                                    <td class="site-selector-container">\r\n                                        <div class="site-filter-component">\r\n                                            <mi-site-selector data-bind="value: $data.siteKey,attr: { readonly: $data.isSelectedSiteViewOnly },event:{\'change\': $root.handleSiteChange.bind(null, $root)}, visible: $root.showSiteSelector"></mi-site-selector>\r\n                                        </div>\r\n                                    </td>\r\n                                    <!-- /ko -->\r\n                                    <!-- ko foreach:freezedCols -->\r\n                                    <td class="datasheetCell" data-bind="template:{name: controlTemplate() ? \'bulk-\'+controlTemplate() : controlTemplate()} , event: { keyup: function bulkdatasheet_element_onkeyup(data,event){ $root.focusNextRow(data,event,$index,$parentContext.$index);}}"></td>\r\n                                    <!-- /ko -->\r\n                                </tr>\r\n                            </tbody>\r\n\r\n\r\n                        </table>\r\n                    </div>\r\n                    <!-- end of frozen rows\'s frozen columns -->\r\n                    <!-- frozen rows floating columns-->\r\n                    <div class="table-responsive" data-bind="css: {\'datasheet-readonly-container\': isDatasheetReadOnly}">\r\n\r\n                        <table class="table table-cust1 bulk-float-table">\r\n                            <tbody data-bind="foreach:frozenRows">\r\n                                <tr data-bind="css:{\'active\':$data.isSelected}">\r\n\r\n                                    <!-- ko foreach:$data.floatCols -->\r\n                                    <td class="datasheetCell" data-bind="template:{name: controlTemplate() ? \'bulk-\'+controlTemplate() : controlTemplate()} , event: { keyup: function bulkdatasheet_element_onkeyup(data,event){ $root.focusNextRow(data,event,$index,$parentContext.$index);}}"></td>\r\n                                    <!-- /ko -->\r\n                                </tr>\r\n                            </tbody>\r\n\r\n\r\n                        </table>\r\n\r\n                    </div>\r\n                    <!-- end of frozen rows floating columns-->\r\n                </div>\r\n                <!-- end of frozen rows -->\r\n                <!-- floating rows -->\r\n                <div class="floating-rows-container" data-bind="css:\'offset-rows-\'+ frozenRows().length">\r\n\r\n                    <!-- floating rows frozen columns -->\r\n                    <div class="freezed-cols-container pull-left">\r\n                        <table class="table table-cust1">\r\n                            <tbody data-bind="foreach:rows">\r\n                                <!-- ko ifnot:$data.isFrozen() -->\r\n                                <tr data-bind="css:{\'active\':$data.isSelected}">\r\n                                    <td class="status-col">\r\n                                        <span data-bind="attr: {class: entityStatusClass}"></span>\r\n                                    </td>\r\n                                    <td class="row-selector" data-bind="visible:$root.selectMode()">\r\n                                        <div class="checkbox-selectall">\r\n                                            <mi-checkbox class="row-selection" data-bind="miCheckboxProperty:{ checked:$data.isSelected, value:$data.entitykey, disable:$data.isCheckboxDisabled}"> </mi-checkbox>\r\n\r\n                                        </div>\r\n                                    </td>\r\n                                    <!-- ko if: $root.isDatasheetRendered() && $root.isSiteFiltered() && $root.showSiteSelector() -->\r\n                                    <td class="site-selector-container">\r\n                                        <div class="site-filter-component">\r\n                                            <mi-site-selector data-bind="value: $data.siteKey,attr: { readonly: $data.isSelectedSiteViewOnly },event:{\'change\': $root.handleSiteChange.bind(null, $root)},visible: $root.showSiteSelector "></mi-site-selector>\r\n                                        </div>\r\n                                    </td>\r\n                                    <!-- /ko -->\r\n                                    <!-- ko foreach:freezedCols -->\r\n                                    <td class="datasheetCell" data-bind="template:{name:controlTemplate() ? \'bulk-\'+controlTemplate() : controlTemplate()} , event: { keyup: function bulkdatasheet_element_onkeyup(data,event){ $root.focusNextRow(data,event,$index,$parentContext.$index);}}"></td>\r\n                                    <!-- /ko -->\r\n                                </tr>\r\n                                <!-- /ko -->\r\n                            </tbody>\r\n\r\n\r\n                        </table>\r\n                    </div>\r\n                    <!-- end of floating rows frozen columns -->\r\n                    <!-- floating rows floating columns -->\r\n                    <!-- This is the floating section all the time -->\r\n                    <div class="table-responsive" data-bind="css: {\'datasheet-readonly-container\': isDatasheetReadOnly}">\r\n\r\n                        <table class="table table-cust1 bulk-float-table">\r\n                            <tbody data-bind="foreach:rows">\r\n                                <!-- ko ifnot:$data.isFrozen() -->\r\n                                <tr data-bind="css:{\'active\':$data.isSelected}">\r\n\r\n                                    <!-- ko foreach:$data.floatCols -->\r\n                                    <td class="datasheetCell" data-bind="template:{name:controlTemplate() ? \'bulk-\'+controlTemplate() : controlTemplate()} , event: { keyup: function bulkdatasheet_element_onkeyup(data,event){ $root.focusNextRow(data,event,$index,$parentContext.$index);}}"></td>\r\n                                    <!-- /ko -->\r\n                                </tr>\r\n                                <!-- /ko -->\r\n                            </tbody>\r\n                        </table>\r\n\r\n                    </div>\r\n\r\n                    <!-- end of floating rows floating columns -->\r\n                </div>\r\n                <!-- end of floating rows -->\r\n            </div>\r\n            <!-- end of table body section -->\r\n            <!-- table floating sections horizontal scrollbar-->\r\n            <div class="bulk-float-table-scrollbar"></div>\r\n        </div>\r\n\r\n        <!-- end of custom table -->\r\n\r\n        <!--<div class="bulk-datasheet-disabled-overlay" data-bind="visible: isDatasheetReadOnly,style: { top: overlayTop}"></div>-->\r\n\r\n    </div>\r\n\r\n\r\n    <script type="text/html" id="bdf-column-chooser">\r\n        <div class="bdf-column-chooser">\r\n            <div data-bind="" class="bdf-column-chooser-list">\r\n                <div class="list-item">\r\n                    <div data-bind="event:{click:toggleSelectAll},\r\n                    css:{\'dx-checkbox-indeterminate\':layout.selectedColumns().length && layout.selectedColumns().length !== layout.columns().length ,\r\n                        \'dx-checkbox-checked\':layout.selectedColumns().length === layout.columns().length}"\r\n                         class="pull-left dx-select-checkbox dx-datagrid-checkbox-size dx-widget dx-checkbox"\r\n                         tabindex="0" onclick="void(0)">\r\n                        <div class="dx-checkbox-container">\r\n                            <span class="dx-checkbox-icon"></span>\r\n                        </div>\r\n                    </div>\r\n                    <div>\r\n                        <span data-bind="text: layout.translate(\'DS_BULK_COLUMN_CHOOSER_ALLCOLUMNS_CAPTION\')"></span>\r\n                    </div>\r\n                </div>\r\n\r\n                <div data-bind="foreach:layout.columns">\r\n                    <div class="list-item">\r\n                        <div data-bind="event:{click:$parent.toggleSelectColumn.bind($parent.layout,$parent)},\r\n                    css:{ \'dx-checkbox-checked\':$parent.isActive && $parent.isActive($data),\r\n                             \'dx-state-disabled\' :  $data.fieldValue && $data.fieldValue() && $data.fieldValue().required() }"\r\n                             class="pull-left dx-select-checkbox dx-datagrid-checkbox-size dx-widget dx-checkbox"\r\n                             tabindex="0" onclick="void(0)">\r\n                            <div class="dx-checkbox-container">\r\n                                <span class="dx-checkbox-icon"></span>\r\n                            </div>\r\n                        </div>\r\n                        <div>\r\n                            <span data-bind="text:$data.columnCaption"></span>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div class="button-control">\r\n                <button class="btn btn-text" data-bind="click:reOrder, text: layout.translate(\'OK\')">  </button>\r\n                <button class="btn btn-text btn-primary" data-bind="click:cancel, text: layout.translate(\'CANCEL\')" style="margin-left:10px;">  </button>\r\n            </div>\r\n        </div>\r\n    </script>    \r\n</div>';});


define('text!platform/datasheets/layout/ui/views/templates/bulk-controls/field-check-box-template.html',[],function () { return '<script type="text/html" id="bulk-field-check-box-template">\r\n    <div class="checkbox" data-bind="css: { \'has-error\': fieldValue() && !fieldValue().isValid(),\r\n                                            \'hide-field\': fieldValue() && fieldValue().hidden }">\r\n        <mi-checkbox data-bind="miCheckboxProperty:{ checked: fieldValue().computedBoolVal, disable: fieldValue().disabled() || fieldValue().clientDisabled()}"> </mi-checkbox>\r\n        \r\n            <i class="bulk-datasheet-error-indicator icon-node-warning" title=""\r\n               data-bind="visible: !fieldValue().isValid() ,\r\n                    click: fieldValue().showErrorMessage,\r\n                    toolTip: fieldValue().validationMessage()"></i>\r\n            <!--ko if: fieldValue().successMessage() -->\r\n            <i class="bulk-datasheet-warning-indicator icon-node-warning" title=""\r\n               data-bind="visible: fieldValue().isValid(),\r\n                    warningMsg: fieldValue().successMessage()"></i>\r\n            <!-- /ko -->\r\n      \r\n\r\n    </div>\r\n</script>\r\n ';});


define('text!platform/datasheets/layout/ui/views/templates/bulk-controls/field-combo-box-template.html',[],function () { return '<script type="text/html" id="bulk-field-combo-box-template">\r\n\r\n    <div class="form-group-mi-select" data-bind="css: { \'has-error\': fieldValue() && !fieldValue().isValid() }">\r\n\r\n        <!-- ko if:(fieldValue().maxNumberOfValues() > 1) -->\r\n        <mi-select data-bind="miproperty:{\r\n                                   selectedOptions: fieldValue()._values,\r\n                                   options: fieldValue().picklist,\r\n                                   optionsValue:\'value\',\r\n                                   optionsText: \'displayValue\',\r\n                                   disabled: fieldValue().disabled() || fieldValue().clientDisabled(),\r\n                                    multiple: fieldValue().maxNumberOfValues() > 1\r\n                           },event:{selected:function(self, ev, values){\r\n                                fieldValue().values(values);\r\n                            }},\r\n                                   style: {\'backgroundColor\': fieldValue().backColor}"></mi-select>\r\n\r\n        <!-- /ko -->\r\n        <!-- ko ifnot:(fieldValue().maxNumberOfValues() > 1) -->\r\n        <mi-select data-bind="miproperty:{\r\n                                           value: fieldValue().picklistValue,\r\n                                           options: fieldValue().picklist,\r\n                                           optionsValue:\'value\',\r\n                                           optionsText: \'displayValue\',\r\n                                           disabled: fieldValue().disabled() || fieldValue().clientDisabled(),\r\n                                            multiple: fieldValue().maxNumberOfValues() > 1\r\n                                   },\r\n                                           style: {\'backgroundColor\': fieldValue().backColor}"></mi-select>\r\n        <!-- /ko -->\r\n       \r\n       \r\n        <i class="bulk-datasheet-error-indicator icon-node-warning" title=""\r\n           data-bind="visible: !fieldValue().isValid() ,\r\n                click: fieldValue().showErrorMessage,\r\n                toolTip: fieldValue().validationMessage()"></i>\r\n        <!--ko if: fieldValue().successMessage() -->\r\n        <i class="bulk-datasheet-warning-indicator icon-node-warning" title=""\r\n           data-bind="visible: fieldValue().isValid(),\r\n                warningMsg: fieldValue().successMessage()"></i>\r\n        <!-- /ko -->\r\n       \r\n    </div>\r\n\r\n</script>';});


define('text!platform/datasheets/layout/ui/views/templates/bulk-controls/field-date-template.html',[],function () { return '<script type="text/html" id="bulk-field-date-template">\r\n\r\n    <div class="form-group date-template"\r\n         data-bind="css: { \'has-error\': fieldValue() && !fieldValue().isValid() }">\r\n\r\n\r\n        <mi-date-time data-bind=" hasFocus: fieldValue().isSelected,\r\n                      attr:{\r\n                        format:fieldValue().dateFormat,\r\n                        \'pick-time\': \'true\',\r\n                        \'use-seconds\': true,\r\n                        disabled: fieldValue().disabled() || fieldValue().clientDisabled()\r\n                      },\r\n                      value:fieldValue().dateValue,\r\n                      style: {\'backgroundColor\': fieldValue().backColor},\r\n                       event: {invalid: $root.setErrorMessageForDate.bind($root, fieldValue()),\r\n                      clear:$root.clearErrorMessageForDate.bind($root,fieldValue())}"\r\n                      ></mi-date-time>\r\n\r\n        \r\n       \r\n        <i class="bulk-datasheet-error-indicator icon-node-warning" title=""\r\n           data-bind="visible: !fieldValue().isValid() ,\r\n                click: fieldValue().showErrorMessage,\r\n                toolTip: fieldValue().validationMessage()"></i>\r\n        <!--ko if: fieldValue().successMessage() -->\r\n        <i class="bulk-datasheet-warning-indicator icon-node-warning" title=""\r\n           data-bind="visible: fieldValue().isValid(),\r\n                warningMsg: fieldValue().successMessage()"></i>\r\n        <!-- /ko -->\r\n\r\n       \r\n    </div>\r\n\r\n</script>';});


define('text!platform/datasheets/layout/ui/views/templates/bulk-controls/field-date-alt-template.html',[],function () { return '\r\n<script type="text/html" id="bulk-field-date-alt-template">\r\n\r\n    <div class="form-group date-alt-template"\r\n         data-bind="css: { \'has-error\': fieldValue() && !fieldValue().isValid() },\r\n    ">\r\n      \r\n      \r\n\r\n        <input type="text"\r\n               class="form-control"\r\n               placeholder="---"\r\n               data-bind="event:{focus:$root.renderDateControl.bind($root,$root)},value:fieldValue().convertDate(),\r\n                                disable: fieldValue().disabled() || fieldValue().clientDisabled(),\r\n                                style: {\'backgroundColor\': fieldValue().backColor},\r\n                                flash: fieldValue().shouldFlash()" />\r\n\r\n\r\n        <button type="button"\r\n                data-bind=" event:{focus:$root.renderDateControl.bind($root,$root)},disable: fieldValue().disabled() || fieldValue().clientDisabled()"\r\n                class="btn btn-icon custom-form-button custom-icon-field-button" style="z-index:0;right:0;margin-top:-38px;">\r\n            <i class="icon-calendar"></i>\r\n        </button>\r\n\r\n        <i class="bulk-datasheet-error-indicator icon-node-warning" title=""\r\n           data-bind="visible: !fieldValue().isValid() ,\r\n                click: fieldValue().showErrorMessage,\r\n                toolTip: fieldValue().validationMessage()"></i>\r\n\r\n\r\n     \r\n    </div>\r\n\r\n</script>';});


define('text!platform/datasheets/layout/ui/views/templates/bulk-controls/field-radio-template.html',[],function () { return '<script type="text/html" id="bulk-field-radio-template">\r\n\r\n    <div class="checkbox" data-bind="">\r\n        <label>\r\n            <input type="checkbox"\r\n                   data-bind="checked: fieldValue().value,\r\n                              disable: fieldValue().disabled() || fieldValue().clientDisabled()" />\r\n           \r\n        </label>\r\n    </div>\r\n\r\n</script>';});


define('text!platform/datasheets/layout/ui/views/templates/bulk-controls/field-text-area-template.html',[],function () { return '<script type="text/html" id="bulk-field-text-area-template">\r\n                        \r\n    <div class="form-group"\r\n         data-bind="css: { \'has-error\': fieldValue() && !fieldValue().isValid() }">\r\n       \r\n\r\n        \r\n        <textarea class="form-control"\r\n                  placeholder="---"\r\n                  data-bind="text: fieldValue().displayValue,\r\n                            value: fieldValue().isSelected() ? fieldValue().value : fieldValue().displayValue,\r\n                            hasFocus: fieldValue().isSelected,\r\n                            disable: fieldValue().disabled,\r\n                            style: {\'backgroundColor\': fieldValue().backColor}, attr: {readonly: fieldValue().clientDisabled}" />\r\n        <button class="btn btn-icon textareaIcon" tabindex="-1"  data-bind="event: {click: function showTextEditor(data){ $root.showTextEditor(data, $index, $parentContext.$index);}}">\r\n            <i class="icon-expand-text-area"></i>\r\n        </button>\r\n        <i class="bulk-datasheet-error-indicator icon-node-warning" title=""\r\n           data-bind="visible: !fieldValue().isValid() ,\r\n                click: fieldValue().showErrorMessage,\r\n                toolTip: fieldValue().validationMessage()"></i>\r\n        <!--ko if: fieldValue().successMessage() -->\r\n        <i class="bulk-datasheet-warning-indicator icon-node-warning" title=""\r\n           data-bind="visible: fieldValue().isValid(),\r\n                warningMsg: fieldValue().successMessage()"></i>\r\n        <!-- /ko -->\r\n       \r\n\r\n\r\n    </div>\r\n\r\n</script>';});


define('text!platform/datasheets/layout/ui/views/templates/bulk-controls/field-hyperlink-template.html',[],function () { return '<script type="text/html" id="bulk-field-hyperlink-template">\r\n\r\n    <div class="form-group"\r\n         data-bind="css: { \'has-error\': fieldValue() && !fieldValue().isValid() }">\r\n        <div class="form-control hyperlinkEllipsis" data-bind="html: fieldValue().displayValue,attr:{title:fieldValue().innerText()}"></div>\r\n                                     \r\n\r\n       \r\n        <!--ko if: fieldValue().jsModuleName() && fieldValue().jsModuleName().length -->\r\n        <input type="button"\r\n               class="btn btn-icon custom-bulk-ds-button"\r\n               placeholder="..."\r\n               data-bind="value: \'...\',\r\n                            click: function bulk_datasheet_view_model_showJSModule(data){ $root.showJSModule(fieldValue().key(), fieldValue().entityKey(), fieldValue().clientid(), fieldValue().jsModuleName(), fieldValue().jsModuleParams(), $data, $index, $parentContext.$index);}">\r\n        <!-- /ko -->\r\n            <i class="bulk-datasheet-error-indicator icon-node-warning" title=""\r\n               data-bind="visible: !fieldValue().isValid() ,\r\n                    click: fieldValue().showErrorMessage,\r\n                    toolTip: fieldValue().validationMessage()"></i>\r\n            <!--ko if: fieldValue().successMessage() -->\r\n            <i class="bulk-datasheet-warning-indicator icon-node-warning" title=""\r\n               data-bind="visible: fieldValue().isValid(),\r\n                    warningMsg: fieldValue().successMessage()"></i>\r\n            <!-- /ko -->\r\n\r\n    </div>\r\n\r\n</script> ';});


define('text!platform/datasheets/layout/ui/views/templates/bulk-controls/field-text-template.html',[],function () { return '<script type="text/html" id="bulk-field-text-template">\r\n\r\n    <div class="form-group"\r\n         data-bind="css: { \'has-error\': fieldValue() && !fieldValue().isValid() }">\r\n     \r\n       \r\n       \r\n        <input type="text"\r\n               class="form-control"\r\n               placeholder="---"\r\n               data-bind="hasFocus: fieldValue().isSelected,\r\n                              value: fieldValue().isSelected() ? fieldValue().value : fieldValue().disValue,\r\n                                disable: fieldValue().disabled,\r\n                                style: {\'backgroundColor\': fieldValue().backColor},\r\n                                flash: fieldValue().shouldFlash(), attr: { maxLength: fieldValue().dbLength , readonly:fieldValue().clientDisabled}" />\r\n        <i class="bulk-datasheet-error-indicator icon-node-warning" title=""\r\n           data-bind="visible: !fieldValue().isValid() ,\r\n                click: fieldValue().showErrorMessage,\r\n                toolTip: fieldValue().validationMessage()"></i>\r\n        <!--ko if: fieldValue().successMessage() -->\r\n        <i class="bulk-datasheet-warning-indicator icon-node-warning" title=""\r\n            data-bind="visible: fieldValue().isValid(),\r\n                warningMsg: fieldValue().successMessage()"></i>\r\n        <!-- /ko -->\r\n       \r\n    </div>\r\n\r\n</script>';});


define('text!platform/datasheets/layout/ui/views/templates/bulk-controls/field-select-template.html',[],function () { return '<script type="text/html" id="bulk-field-select-template">\r\n\r\n    <div class="form-group-select">\r\n        <select class="form-control" data-bind="value: fieldValue().picklistValue,\r\n                                           options: fieldValue().picklist,\r\n                                           optionsValue:\'value\',\r\n                                           optionsText: \'displayValue\',\r\n                                           disable: fieldValue().disabled() || fieldValue().clientDisabled(),\r\n                                           visible:fieldValue(),\r\n                                           style: {\'backgroundColor\': fieldValue().backColor}"></select>\r\n       \r\n            <i class="bulk-datasheet-error-indicator icon-node-warning" title=""\r\n               data-bind="visible: !fieldValue().isValid() ,\r\n                    click: fieldValue().showErrorMessage,\r\n                    toolTip: fieldValue().validationMessage()"></i>\r\n            <!--ko if: fieldValue().successMessage() -->\r\n            <i class="bulk-datasheet-warning-indicator icon-node-warning" title=""\r\n               data-bind="visible: fieldValue().isValid(),\r\n                    warningMsg: fieldValue().successMessage()"></i>\r\n            <!-- /ko -->\r\n      \r\n    </div>\r\n</script>';});


define('text!platform/datasheets/layout/ui/views/templates/bulk-controls/field-multivalue-template.html',[],function () { return '<script type="text/html" id="bulk-field-multivalue-template">\r\n\r\n    <div data-bind="css: { \'has-error\': fieldValue() && !fieldValue().isValid() }">\r\n\r\n\r\n\r\n        <!-- ko if:(fieldValue().maxNumberOfValues() > 1) -->\r\n\r\n        <mi-multi-value data-bind="miproperty:{\r\n                                        selectedOptions: fieldValue().values,\r\n                                       options: fieldValue().picklist,\r\n                                       optionsValue: \'value\',\r\n                                       optionsText:  \'displayValue\',\r\n                                       disabled: fieldValue().disabled() || fieldValue().clientDisabled(),\r\n                                       multiple: fieldValue().maxNumberOfValues() > 1\r\n                                       },\r\n                                       style: {\'backgroundColor\': fieldValue().backColor}"></mi-multi-value>\r\n\r\n        <!-- /ko -->\r\n        <!-- ko ifnot:(fieldValue().maxNumberOfValues() > 1) -->\r\n\r\n        <mi-multi-value data-bind="miproperty:{\r\n                                       value: fieldValue().picklistValue,\r\n                                       options: fieldValue().picklist,\r\n                                       optionsValue: \'value\',\r\n                                       optionsText:  \'displayValue\',\r\n                                       disabled: fieldValue().disabled() || fieldValue().clientDisabled(),\r\n                                       multiple: fieldValue().maxNumberOfValues() > 1\r\n                                       },\r\n                                       style: {\'backgroundColor\': fieldValue().backColor}"></mi-multi-value>\r\n\r\n        <!-- /ko -->\r\n        \r\n       \r\n       \r\n        <i class="bulk-datasheet-error-indicator icon-node-warning" title=""\r\n           data-bind="visible: !fieldValue().isValid() ,\r\n                click: fieldValue().showErrorMessage,\r\n                toolTip: fieldValue().validationMessage()"></i>\r\n        <!--ko if: fieldValue().successMessage() -->\r\n        <i class="bulk-datasheet-warning-indicator icon-node-warning" title=""\r\n           data-bind="visible: fieldValue().isValid(),\r\n                    warningMsg: fieldValue().successMessage()"></i>\r\n        <!-- /ko -->\r\n       \r\n    </div>\r\n\r\n</script>';});


define('text!platform/datasheets/layout/ui/views/templates/bulk-controls/field-empty-template.html',[],function () { return '<script type="text/html" id="bulk-field-empty-template">\r\n\r\n    <div class="form-group disabled" data-bind="style:{\'background-color\':\'#eee\',\'min-height\':\'25px\'}">\r\n\r\n    </div>\r\n\r\n</script>';});


define('text!platform/datasheets/layout/ui/views/templates/bulk-controls/field-multi-text-template.html',[],function () { return '<script type="text/html" id="bulk-field-multi-text-template">\r\n\r\n    <div data-bind="css: { \'has-error\': fieldValue() && !fieldValue().isValid() }">\r\n\r\n        <mi-text-ext data-bind="miproperty:{\r\n                           value: fieldValue().value,\r\n                           options: fieldValue().values,\r\n                           disable: fieldValue().disabled() || fieldValue().clientDisabled(),\r\n                           },\r\n                           style: {\'backgroundColor\': fieldValue().backColor}"></mi-text-ext>\r\n\r\n\r\n       \r\n       \r\n            <i class="bulk-datasheet-error-indicator icon-node-warning" title=""\r\n               data-bind="visible: !fieldValue().isValid() ,\r\n                    click: fieldValue().showErrorMessage,\r\n                    toolTip: fieldValue().validationMessage()"></i>\r\n            <!--ko if: fieldValue().successMessage() -->\r\n            <i class="bulk-datasheet-warning-indicator icon-node-warning" title=""\r\n               data-bind="visible: fieldValue().isValid(),\r\n                    warningMsg: fieldValue().successMessage()"></i>\r\n            <!-- /ko -->\r\n\r\n        \r\n    </div>\r\n\r\n</script>';});


define('text!platform/datasheets/layout/ui/views/templates/bulk-controls/field-jsmodule-template.html',[],function () { return '<script type="text/html" id="bulk-field-jsmodule-template">\r\n\r\n    <div class="form-group"\r\n         data-bind="css: { \'has-error\': fieldValue() && !fieldValue().isValid() }">\r\n\r\n\r\n      \r\n        <input type="text"\r\n               style="margin-right: 26px;"\r\n               class="form-control custom-form-text"\r\n               placeholder="..."\r\n               data-bind="hasFocus: fieldValue().isSelected,\r\n                                  value: fieldValue().isSelected() ? fieldValue().jsModuleValue : fieldValue().disValue,\r\n                                    disable: fieldValue().disabled() || fieldValue().clientDisabled(),\r\n                                    style: {\'backgroundColor\': fieldValue().backColor},\r\n                                    flash: fieldValue().shouldFlash(),\r\n    event: {focus: function bulk_datasheet_view_model_showJSModule(data){ $root.callOnFocus(fieldValue(), $data, $index, $parentContext.$index);}}\r\n                                    ">\r\n        <input type="button"\r\n               class="btn btn-icon custom-bulk-ds-button"\r\n               placeholder="..."\r\n               data-bind="value: \'...\',\r\n                            click: function bulk_datasheet_view_model_showJSModule(data){ $root.showJSModule(fieldValue().key(), fieldValue().entityKey(), fieldValue().clientid(), fieldValue().jsModuleName(), fieldValue().jsModuleParams(), $data, $index, $parentContext.$index, fieldValue().jsModuleUseApply);}">\r\n\r\n\r\n        <i class="bulk-datasheet-error-indicator icon-node-warning" title=""\r\n           data-bind="visible: !fieldValue().isValid() ,\r\n                click: fieldValue().showErrorMessage,\r\n                toolTip: fieldValue().validationMessage()"></i>\r\n        <!--ko if: fieldValue().successMessage() -->\r\n        <i class="bulk-datasheet-warning-indicator icon-node-warning" title=""\r\n           data-bind="visible: fieldValue().isValid(),\r\n                warningMsg: fieldValue().successMessage()"></i>\r\n        <!-- /ko -->\r\n\r\n    </div>\r\n\r\n</script>\r\n';});


define('text!platform/datasheets/layout/ui/views/templates/bulk-controls/field-masked-template.html',[],function () { return '<script type="text/html" id="bulk-field-masked-template">\r\n    <div class="form-group" data-bind="css: { \'has-error\': fieldValue() && !fieldValue().isValid() }">\r\n              \r\n\r\n      \r\n        <input type="password" data-bind="hasFocus: fieldValue().isSelected,\r\n                                          value: fieldValue().isSelected() ? fieldValue().value : fieldValue().disValue,\r\n                                          style: {\'backgroundColor\': fieldValue().backColor},\r\n                                          attr:{maxLength: fieldValue().dbLength}" class="form-control" placeholder="---" />\r\n        <i class="bulk-datasheet-error-indicator icon-node-warning" title=""\r\n           data-bind="visible: !fieldValue().isValid() ,\r\n                click: fieldValue().showErrorMessage,\r\n                toolTip: fieldValue().validationMessage()"></i>\r\n        <!--ko if: fieldValue().successMessage() -->\r\n        <i class="bulk-datasheet-warning-indicator icon-node-warning" title=""\r\n           data-bind="visible: fieldValue().isValid(),\r\n                warningMsg: fieldValue().successMessage()"></i>\r\n        <!-- /ko -->\r\n      \r\n    </div>\r\n</script>';});


define('text!platform/datasheets/layout/ui/views/templates/bulk-controls/field-uom-template.html',[],function () { return '<script type="text/html" id="bulk-field-uom-template">\r\n\r\n    <div class="form-group"\r\n         data-bind="css: { \'has-error\': fieldValue() && !fieldValue().isValid() }">\r\n       \r\n        <input type="text"\r\n               class="form-control"\r\n               placeholder="---"\r\n               data-bind="hasFocus: fieldValue().isSelected,\r\n                              value: fieldValue().isSelected() ? fieldValue().value : fieldValue().disValue,\r\n                                disable: fieldValue().disabled,\r\n                                style: {\'backgroundColor\': fieldValue().backColor},\r\n                                flash: fieldValue().shouldFlash(), attr: { maxLength: fieldValue().dbLength , readonly:fieldValue().clientDisabled}" />\r\n        <button type="button"\r\n                placeholder="..."\r\n                data-bind="click: $root.showUOMConversionTool.bind(null, $root),\r\n                 disable: !fieldValue().value() || fieldValue().disabled"\r\n                class="btn btn-icon custom-form-button custom-icon-field-button bulk-uom-button">\r\n            <i class="icon-uom"></i>\r\n        </button>\r\n        <i class="bulk-datasheet-error-indicator icon-node-warning" title=""\r\n           data-bind="visible: !fieldValue().isValid() ,\r\n                click: fieldValue().showErrorMessage,\r\n                toolTip: fieldValue().validationMessage()"></i>\r\n        <!--ko if: fieldValue().successMessage() -->\r\n        <i class="bulk-datasheet-warning-indicator icon-node-warning" title=""\r\n           data-bind="visible: fieldValue().isValid(),\r\n                warningMsg: fieldValue().successMessage()"></i>\r\n        <!-- /ko -->\r\n      \r\n    </div>\r\n\r\n</script>';});

var jQuery=require("jquery"),_=require("lodash"),Device=require("system/hardware/device");!function(a){"use strict";var b=!1,c;"function"==typeof Device&&(c=Object.resolve(Device),b=c.isIE()),a.fn.autoScroll=function(a,c){var d=this;function e(a){d.find(c).scrollLeft(a.currentTarget.scrollLeft)}return d.find(a).off("scroll.autoScroll").on("scroll.autoScroll",b?_.debounce(e,1):e),d},a.fn.touchScroll=function(){var a=this,b=null,c=null,d=null;function e(e){var f=e.originalEvent;b=f.touches[0].clientX,c=f.touches[0].clientY,d=a.scrollLeft()}function f(e){var f=e.originalEvent;if(b&&c){var g=f.touches[0].clientX,h=f.touches[0].clientY,i=b-g,j=c-h;if(Math.abs(i)>Math.abs(j)){var k=d+i;a.scrollLeft(k)}}}function g(a){b=null,c=null,d=null}return this.off("touchstart.touchScroll").on("touchstart.touchScroll",e).off("touchmove.touchScroll").on("touchmove.touchScroll",f).off("touchend.touchScroll").on("touchend.touchScroll",g)},a.fn.gridScroll=function(b){
var c=this,d=".table-responsive",e=".floating-rows-container",f=".freezed-cols-container",g=".freezed-rows-container",h={table:".grid-table",header:".grid-table-header ",body:".grid-table-body",scrollBar:".grid-table-scrollbar",rowSelectorCol:"grid-row-selector",excludeCols:"grid-exclude-col"},i=a.extend(h,b),j=a.Deferred();function k(){var a=c.find(i.body+" "+e+" "+d).height(),b=c.find(i.body+" "+e).height();c.find(i.body).removeClass("has-overflow-rows"),b<a&&c.find(i.table).addClass("has-overflow-rows")}function l(){var b=c.find(i.body+" "+e+" "+d).width(),f=c.find(i.body+" "+e+" "+d+" table"),g=f.width(),h=a("<p/>").css({width:g,height:2});c.find(i.scrollBar).empty().append(h).width(b)}function m(){n(d),n(f)}function n(b){var d=c.find(i.header+" "+b+" table"),f=d.find("tr:first-child th"),h=c.find(i.body+" "+e+" "+b+" table"),j=h.find("tr:first-child td"),k=c.find(i.body+" "+g+" "+b+" table"),l=k.find("tr:first-child td");a(l).add(f).add(j).css({"min-width":"none",
"max-width":"none"});for(var m,n,o,p=0;p<j.length;p++)a(j[p]).hasClass(i.rowSelectorCol)||a(j[p]).hasClass(i.excludeCols)||(n=j[p].clientWidth-j[p].style.paddingLeft-j[p].style.paddingRight,l[p]&&(o=l[p].clientWidth-l[p].style.paddingLeft-l[p].style.paddingRight,o>n&&(n=o),l[p].style.minWidth=n+1+"px",l[p].style.maxWidth=n+1+"px"),f[p].style.minWidth=n+1+"px",f[p].style.maxWidth=n+1+"px",j[p].style.minWidth=n+1+"px",j[p].style.maxWidth=n+1+"px")}return c.is(":visible")&&(m(),l(),k(),c.autoScroll(i.scrollBar,d),c.autoScroll(d,d),c.find(d).touchScroll()),j.resolve(),j.promise()}}(jQuery);
define("platform/datasheets/layout/ui/helpers/gridScroll", function(){});

define('platform/datasheets/layout/ui/bulk-datasheet-view-model',['require','lodash','jquery','knockout','spa/region','spa/ko/knockout-view-model','./bulk-column-view-model','./bulk-row-view-model','./bulk-column-chooser','../services/datasheet-service','system/lang/event','../model/field-value-model','../model/entity-model','../adapters/datasheet-adapter','application/export-service','../model/datasheet-clipboard-model','../adapters/datasheet-field-info-adapter','text!./views/bulk-datasheet.html','./helpers/print-helper','./helpers/js-module-helper','./helpers/ui-helper','system/ui/dialog-view-model','text!./field-control-template-map.json','text!./views/templates/bulk-controls/field-check-box-template.html','text!./views/templates/bulk-controls/field-combo-box-template.html','text!./views/templates/bulk-controls/field-date-template.html','text!./views/templates/bulk-controls/field-date-alt-template.html','text!./views/templates/bulk-controls/field-radio-template.html','text!./views/templates/bulk-controls/field-text-area-template.html','text!./views/templates/bulk-controls/field-hyperlink-template.html','text!./views/templates/bulk-controls/field-text-template.html','text!./views/templates/bulk-controls/field-select-template.html','text!./views/templates/bulk-controls/field-multivalue-template.html','text!./views/templates/bulk-controls/field-empty-template.html','text!./views/templates/bulk-controls/field-multi-text-template.html','text!./views/templates/bulk-controls/field-jsmodule-template.html','text!./views/templates/bulk-controls/field-masked-template.html','text!./views/templates/bulk-controls/field-uom-template.html','system/globalization/translator','application/application-events','system/error/error-message','platform/datasheets/layout/ui/utils','system/knockout/knockout-manager','platform/metadata/services/metadata','system/hardware/device','ui/elements/ref-doc/services/service','./helpers/ref-doc-helper','../../layout/model/uom-conversion-model','system/knockout/knockout-helpers','jquery-ui','ui/elements/checkbox/checkbox-view-model','ui/elements/select/view-model','ui/elements/multi-value/view-model','ui/elements/text-ext/view-model','ui/elements/site-selector/site-selector-element','./helpers/gridScroll','ui/elements/associated-pages-btn/associated-pages'],function(require){"use strict"
;var a=require("lodash"),b=require("jquery"),c=require("knockout"),d=require("spa/region"),e=require("spa/ko/knockout-view-model"),f=require("./bulk-column-view-model"),g=require("./bulk-row-view-model"),h=require("./bulk-column-chooser"),i=require("../services/datasheet-service"),j=require("system/lang/event"),k=require("../model/field-value-model"),l=require("../model/entity-model"),m=require("../adapters/datasheet-adapter"),n=require("application/export-service"),o=require("../model/datasheet-clipboard-model"),p=require("../adapters/datasheet-field-info-adapter"),q=require("text!./views/bulk-datasheet.html"),r=require("./helpers/print-helper"),s=require("./helpers/js-module-helper"),t=require("./helpers/ui-helper"),u=require("system/ui/dialog-view-model"),v=JSON.parse(require("text!./field-control-template-map.json")),w=require("text!./views/templates/bulk-controls/field-check-box-template.html")+require("text!./views/templates/bulk-controls/field-combo-box-template.html")+require("text!./views/templates/bulk-controls/field-date-template.html")+require("text!./views/templates/bulk-controls/field-date-alt-template.html")+require("text!./views/templates/bulk-controls/field-radio-template.html")+require("text!./views/templates/bulk-controls/field-text-area-template.html")+require("text!./views/templates/bulk-controls/field-hyperlink-template.html")+require("text!./views/templates/bulk-controls/field-text-template.html")+require("text!./views/templates/bulk-controls/field-select-template.html")+require("text!./views/templates/bulk-controls/field-multivalue-template.html")+require("text!./views/templates/bulk-controls/field-empty-template.html")+require("text!./views/templates/bulk-controls/field-multi-text-template.html")+require("text!./views/templates/bulk-controls/field-jsmodule-template.html")+require("text!./views/templates/bulk-controls/field-masked-template.html")+require("text!./views/templates/bulk-controls/field-uom-template.html"),x=require("system/globalization/translator"),y=require("application/application-events"),z=require("system/error/error-message"),A=require("platform/datasheets/layout/ui/utils"),B=require("system/knockout/knockout-manager"),C=require("platform/metadata/services/metadata"),D=require("system/hardware/device"),E=require("ui/elements/ref-doc/services/service"),F=require("./helpers/ref-doc-helper"),G=require("../../layout/model/uom-conversion-model")
;require("system/knockout/knockout-helpers"),require("jquery-ui"),require("ui/elements/checkbox/checkbox-view-model"),require("ui/elements/select/view-model"),require("ui/elements/multi-value/view-model"),require("ui/elements/text-ext/view-model"),require("ui/elements/site-selector/site-selector-element"),require("./helpers/gridScroll"),require("ui/elements/associated-pages-btn/associated-pages");function H(a,b,d,e){var f=this;I.call(this,q),this.kom=Object.resolve(B),this.region=null,this.datasheetService=a,this.translator=Object.resolve(x),this.appEvents=Object.resolve(y),this.exportService=Object.resolve(n),this.printHelper=Object.resolve(r),this.jsModuleHelper=Object.resolve(s),this.uiHelper=Object.resolve(t),this.title=c.observable(""),this.isBulkDatasheet=c.observable(!0),this.isMasterDatasheet=c.observable(!1),this.updatePref=null,this.datasheetKeys=c.observableArray(),this.datasheets=c.observableArray(),this.currentDatasheetKey=c.observable(),
this.currentDatasheetCaption=c.observable(),this.cachedFieldValues=null,this.cachedFamilykey=null,this.assocFamilyKey=c.observable(),this.assocEntityKey=c.observable(),this.isAssociatedPagesDisabled=c.observable(!0),this.currentDatasheet=c.observable(),this.currentEntity=c.observable(),this.currentEntities=c.observable(),this.fieldInfos=c.observableArray(),this.columns=c.observableArray(),this.rows=c.observableArray(),this.currentCellIndex=c.observable(0),this.entities=c.observableArray(),this.ValidateBeforeSave=c.observable(!1),this.isSaveAvailable=c.observable(!0),this.isCopyAvailable=c.observable(!0),this.isPasteEnabled=c.observable(!0),this.isDeleteAvailable=c.observable(!0),this.isHistoryAvailable=c.observable(!0),this.isHistoryDisabled=c.observable(!1),this.isRefDocAvailable=c.observable(!0),this.isRefDocDisabled=c.observable(!0),this.isSingleEntitySelected=c.observable(!1),this.isLinkAvailable=c.observable(!0),this.isUnlinkAvailable=c.observable(!0),
this.isNewAvailable=c.observable(!0),this.isSiteFiltered=c.observable(!1),this.isSelectedSiteViewOnly=c.observable(!1),this.showSiteSelector=c.observable(!0),this.showColumnChooser=c.observable(!0),this.assetContextKey=c.observable(),this.kom.subscribe(this.assetContextKey,Ha.bind(f,this)),this.isDatasheetReadOnly=c.observable(!1),this.canEdit=c.observable(!1),this.canPaste=c.observable(!1),this.overlayTop=c.observable("0"),this.showDatasheetSelection=c.observable(!0),this.oldEntity=null,this.isDatasheetRendered=c.observable(!1),this.isReadOnly=c.observable(!1),this.loadedFromCache=c.observable(""),this.predEntitySiteKey=c.observable(""),this.layoutRendered=new j,this.entityRendered=new j,this.fieldValueChanged=new j,this.currentEntityChanged=new j,this.datasheetSaved=new j,this.datasheetNew=new j,this.datasheetDelete=new j,this.datasheetHistory=new j,this.datasheetRefDoc=new j,this.hasSelectionChanged=new j,this.unlinkEntities=new j,this.datasheetChanged=new j,this.onSiteChange=new j,
this.PreventSiteChangeUpdate=new j,this.ValidateBeforeEveryThing=new j,this.entitySelected=new j,this.selectMode=c.observable(!1),this.hasSelection=c.observable(!0),this.selectAll=c.observable(!1),this.selectedEntities=c.observableArray([]),this.selectedRows=c.observableArray([]),this.frozenRows=this.kom.computed(Ga.bind(null,f)),this.currentEntityChangedSubscription=this.kom.subscribe(this.currentEntity,ha.bind(null,this)),this.currentEntityBeforeChangeSubscription=this.kom.subscribe(this.currentEntity,ga.bind(null,this),null,"beforeChange"),this.useNativeSelect=c.observable(!1),this.siteSelector=[],this.pageChangeEvent=new j,this.preventPageChange=!1,this.pageSelector=c.observable("1"),this.kom.subscribe(this.pageSelector,Oa.bind(null,this)),this.pageSize=e,this.minPage=1,this.maxPage=c.observable(),this.pageOptions=c.observableArray(),this.totalRows=void 0===b?d:b.length,this.updatePageCount(this.totalRows),this.queryColumns=[],this.selectedColumns=c.observableArray([]),
this.columnsToView=c.observableArray([]),this.focusedColumn=null,this.frozenColsKeys=c.observableArray([]),this.freezedCols=c.computed(Pa.bind(f,f)),this.floatCols=c.computed(Ra.bind(f,f)),f.uiHelper.attachTemplatesForBulk(f,w),f.util=Object.resolve(A),this.device=Object.resolve(D),this.isRefDocFamily=c.observable(!1),this.canDownloadRefDoc=c.observable(!1),this.refDocService=Object.resolve(E),this.refDocHelper=Object.resolve(F),this.entitiesReference=null}var I=Object.inherit(e,H);H.dependsOn=[i],H.prototype.setErrorMessageForDate=function(a){a.errorMessage(this.translator.translate("FORMAT_IS_NOT_VALID"));for(var b=0;b<this.entitiesReference.length;b++)if(this.entitiesReference[b].key===a.entityKey())for(var c=this.entitiesReference[b].fields,d=0;d<c.length;d++)c.models[d].id===a.id()&&(c.models[d].attributes.errorMessage=this.translator.translate("FORMAT_IS_NOT_VALID"))},H.prototype.clearErrorMessageForDate=function(a){a.errorMessage(this.translator.translate(""))
;for(var b=0;b<this.entitiesReference.length;b++)if(this.entitiesReference[b].key===a.entityKey())for(var c=this.entitiesReference[b].fields,d=0;d<c.length;d++)c.models[d].id===a.id()&&(c.models[d].attributes.errorMessage="")};function J(a,b){for(var c=[],d=0;d<a.maxPage();d++)c.push({text:d*a.pageSize+1+" - "+((d+1)*a.pageSize<b?(d+1)*a.pageSize:b),value:d+1});return c}H.prototype.updatePageCount=function a(b){var c=this;c.maxPage(Math.ceil(b/c.pageSize)),c.pageOptions(J(this,b))},H.prototype.activate=function a(){},H.prototype.translate=function a(b){return this.translator.translate(b)},H.prototype.attach=function a(c){I.prototype.attach.call(this,c),this.region=c,b(window).on("resize",this.handleScrolling.bind(this,this))},H.prototype.detach=function a(c){I.prototype.detach.call(this,c),b(window).off("resize",this.handleScrolling.bind(this,this))},H.prototype.setTitle=function a(b){this.title(b)},H.prototype.handleSiteChange=function a(b,c,d){
c.entitykey&&b.onSiteChange.raise(c.entitykey(),d.originalEvent.detail.value)},H.prototype.newDatasheet=function a(){this.datasheetNew.raise()},H.prototype.saveDatasheet=function a(){this.datasheetSaved.raise(this.entities())},H.prototype.saveDatasheet2=function a(){this.ValidateBeforeEveryThing.raise(this)},H.prototype.deleteDatasheet=function a(){this.datasheetDelete.raise(this.selectedEntities())},H.prototype.toggleSelectMode=function a(){this.selectMode(!this.selectMode()),this.region&&this.region.$element&&Ua(this)},H.prototype.unlinkRelatedEntities=function a(){this.unlinkEntities.raise()},H.prototype.showEditMode=function a(){this.isDatasheetReadOnly(!1)},H.prototype.print=function a(){C.retrieveFamilyReports(this.cachedFamilykey).done(Va.bind(null,this))},H.prototype.showDatasheet=function a(c,d,e,f){var g=this,h=b.Deferred(),i=b.Deferred(),j,k,l,m,n,o;g.updatePref=f
;for(var p=0;p<this.entitiesReference.length;p++)for(var q=this.entitiesReference[p].fields,r=0;r<q.length;r++)"Date"===q.models[r].attributes.dataType&&(q.models[r].attributes.errorMessage="");return e?g.cachedFieldValues=e.slice():e=g.cachedFieldValues.slice(),d?g.cachedFamilykey=d:d=g.cachedFamilykey,g.assocFamilyKey(d),o=h.then(K.bind(null,g,d)).then(L.bind(null,g,c)).then(M.bind(null,g,"BULKDSFROZENCOLS")).then(N.bind(null,g)).then(M.bind(null,g,"BULKDSCOLCHOOSER")).then(O.bind(null,g)).then(P.bind(null,g)).then(Q.bind(null,g)).then(R.bind(null,g)).then(S.bind(null,g,e,i)).fail(T.bind(null,g,i)),h.resolve(),i};function K(a,b){return a.datasheetService.getDatasheets(b)}function L(a,c,d){var e=b.Deferred();return a.isAllDatasheetsHidden=a.uiHelper.isAllDatasheetsHidden(d),a.isAllDatasheetsHidden?e.reject():U(a,c,d),e.resolve(),e}function M(a,b){return a.datasheetService.getBDFLayoutPreferences(a.currentDatasheetKey(),b)}function N(a,b){a.frozenColsKeys(b)}function O(a,b){
a.excludedColumnsKeys=b}function P(a){return a.datasheetService.getBulkDatasheet(a.currentDatasheetKey(),a.updatePref)}function Q(a,b){ia(a,b),la(a)}function R(a){return a.datasheetService.getFieldInfo(a.currentDatasheet().familyKey())}function S(a,b,c,d){ja(a,d),Aa(a),a.kom.subscribe(a.currentDatasheetKey,ba.bind(null,a)),aa(a,b),V(a,d,b),c.resolve()}function T(a,c){a.isAllDatasheetsHidden?a.isMasterDatasheet()?c.reject():(a.throwException(a.translate("DS_DATASHEET_NOT_CONFIGURED_MESSAGE")),b(".bdf-container h4.bulkTitle").css("display","none")):(a.throwException(a.translate("DS_LOAD_DATASHEET_FAIL_EXCEPTION")),c.reject())}function U(b,c,d){var e=0,f=!1,g;if(void 0!==c&&"string"==typeof c)for(e=0;e<d.length;e++)if(d[e].id===c){c=d[e].key;break}for(e=0;e<d.length;e++)d[e].isMasterDetail||d[e].isHidden||(b.datasheets.push(d[e]),b.datasheetKeys.push({key:d[e].key,caption:d[e].caption}),d[e].lastViewed===!0?(b.currentDatasheetKey(c||d[e].key),
f=!0):d[e].isDefault===!0&&(b.currentDatasheetKey(c||d[e].key),f=!0));f||(b.currentDatasheetKey(c||b.datasheets()[0].key),f=!0),g=a.find(d,function(a){return a.key===b.currentDatasheetKey()}),b.currentDatasheetCaption(g.caption)}function V(c,d,e){var f,h=[],i=[],j=c.rows(),k,l,m=b.Deferred();for(k=0;k<e.length;k++)f=new g(e[k].entitykey,e[k].clientid,c,e[k].siteKey),0!==e[k].entitykey?f=e[k].isDirty?_(f,"dirty"):_(f,"clean"):(f=e[k].isDirty?_(f,"new-dirty"):_(f,"new-clean"),0===e[k].entitykey&&c.showSiteSelector()&&i.push({entity:e[k],index:k}),f.isCheckboxDisabled(!0)),c.attachEntityToLayout(e[k].entitykey,e[k].fields,k,e[k].clientid,e[k].isAuditable),ra(c,k,f),h.push(f);return Y(j,h),c.rows(h),X(c),i&&i.length&&a.each(i,function(a){Z(c,a.entity,!0,a.index)}),a.delay(function(){Ua(c).done(W.bind(null,m))},10),m.promise()}function W(a){a.resolve()}function X(a){a.selectedEntities=a.kom.computed(Ca.bind(null,a)),a.selectedRows=a.kom.computed(Fa.bind(null,a)),
a.kom.subscribe(a.selectedEntities,Da.bind(null,a)),a.kom.subscribe(a.selectAll,Ea.bind(null,a))}function Y(a,b){for(var c=0;c<a.length;c++)for(var d=0;d<b.length;d++)if(a[c].entitykey().toString()===b[d].entitykey().toString()){b[d].isSelected(a[c].isSelected()),b[d].isFrozen(a[c].isFrozen());break}return b}function Z(a,b,c,d){c&&Ba(a);var e=a.region.$element.find("mi-site-selector"),f=d>=0?d:e.length-1;if(e.length){var g=e[f];c||(a.siteSelector.push(g),Element.upgrade(g)),0!==b.entitykey||"0"!==b.siteKey&&a.loadedFromCache()||""===a.predEntitySiteKey()||!a.showSiteSelector()?0===b.entitykey&&!a.predEntitySiteKey()&&"0"===b.siteKey&&a.showSiteSelector()?(a.handlePreventSiteChangeUpdate(a,f,b.siteKey),g.selectDefaultSite()):0===b.entitykey&&"0"!==b.siteKey&&a.showSiteSelector()&&$(a,f,b.siteKey):c?$(a,f,b.siteKey):$(a,f,a.predEntitySiteKey())}}function $(a,b,c){a.rows&&a.rows()&&(a.handlePreventSiteChangeUpdate(a,b,c),a.rows()[b].siteKey(c))}function _(a,b){return a.entityStatus(b),a}
function aa(b,c){var d=0;a.each(c,function(b){a.each(b.fields,function(a){a.options.picklist&&d++})}),d>20&&b.useNativeSelect(!0)}H.prototype.throwException=function a(b){var c=new z(1,b,"platform/datasheets/layout/ui/bulk-datasheet-view-model.js");this.appEvents.errorOccured.raise(this,c)},H.prototype.setQueryColumns=function a(b,c){var d,e,f,g;for(d=0;d<b.length;d++)e={},g=b[d],e.columnCaption=""===g.getAlias()?g.getFieldId():g.getAlias(),e.columnFieldKey=g.getFieldId().replace(/\[|\]/g,""),f=Wa(c,e.columnFieldKey),f?Xa(e,f):Ya(e,g),this.queryColumns.push(e)},H.prototype.setErrorAndReturnErrorFlag=function a(b,c){var d=this,e=!1;return d.util.clearAllErrorNotifications(b),e=d.util.setErrorAndReturnErrorFlag("bulk",b,c)};function ba(a){a.datasheetChanged.raise()}H.prototype.executeDatasheetChanged=function a(c){var d=b.Deferred(),e=b.Deferred(),f=this,g,h,i;return i=c?c:f.cachedFieldValues.slice(),f.isDatasheetRendered(!1),g=d.then(function(){
return f.datasheetService.getBulkDatasheet(f.currentDatasheetKey(),f.updatePref)}).then(function(a){if(0===a.length||f.uiHelper.isAllDatasheetsHidden(a))return void f.throwException(f.translate("DS_DATASHEET_NOT_CONFIGURED_MESSAGE"));f.currentDatasheetCaption(a.caption),ia(f,a),la(f)}),h=g.then(function(){return f.datasheetService.getFieldInfo(f.currentDatasheet().familyKey())}).then(function(a){ja(f,a),Aa(f),f.entities([]),f.siteSelector=[],V(f,a,i).done(W.bind(null,e))}).done(function(){}).fail(function(){f.throwException(f.translate("DS_LOAD_DATASHEET_FAIL_EXCEPTION")),e.reject()}),d.resolve(),e},H.prototype.attachEntityToLayout=function a(b,c,d,e,f){var g=c.length,h,i=[],j,m=this;for(h=0;h!==g;h++)i.push(new k(c[h].fieldKey,c[h].fieldId,c[h].fieldValue,c[h].fieldDisplayValue,{required:c[h].options.required,disabled:c[h].options.disabled,unitOfMeasure:c[h].options.unitOfMeasure,unitOfMeasureKey:c[h].options.unitOfMeasureKey,picklist:c[h].options.picklist,
backColor:c[h].options.backColor,jsModuleName:c[h].options.jsModuleName,jsModuleParams:c[h].options.jsModuleParams,popJSModuleOnFocus:c[h].options.popJSModuleOnFocus,addParseValueParam:c[h].options.addParseValueParam,dependentFields:c[h].options.dependentFields,isPicklistRestricted:c[h].options.isPicklistRestricted,maxNumberOfValues:c[h].options.maxNumberOfValues,values:c[h].options.values,format:c[h].options.format,dbLength:c[h].options.dbLength,behaviors:c[h].options.behaviors},e,b));j=new l(i,b,e,f),m.entities.push(j),m.entities()[d].fieldValueChanged.add(ka.bind(null,this))},H.prototype.updateFieldValue=function b(c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){var v=0,w=0,x,y=[],z=null,A=this;if(this.entities()&&(x=a.find(this.entities(),function(a){return void 0===c.clientid?a.key===c.key:a.clientid===c.clientid}),y=x.fieldValues()),t)for(v=0;v!==y.length;v++){if(null!==n)for(w=0;w!==n.length;w++)y[v].key().toString()!==n[w]&&y[v].key()!==n[w]||y[v].clientDisabled(!1)
;y[v].key().toString()===d.toString()&&y[v].clientDisabled(!1)}for(v=0;v!==y.length;v++){if(y[v].key().toString()===d||y[v].key()===d){z=y[v];break}y[v].changedFromView(!0)}ca(z,x,{newValue:e,newValues:f,newDisplayValue:g,picklist:h,isDisabled:i,isRequired:j,errorMessage:k,backColor:l,maxNumberOfValues:m,jsModuleName:o,jsModuleParams:p,popJSModuleOnFocus:q,addParseValueParam:r,stopPropagate:t,format:s,entityKey:c.key,clientid:c.clientid,successMessage:u})};function ca(b,c,d){var e=0;b&&(d.stopPropagate&&b.changedFromView(!1),b.value(d.newValue),a.isEqual(b.values(),d.newValues)||(b.values(d.newValues),b._values(d.newValues)),b.displayValue(d.newDisplayValue),b.disabled(d.isDisabled),b.required(d.isRequired),b.errorMessage(d.errorMessage),b.backColor(d.backColor),b.maxNumberOfValues(d.maxNumberOfValues),b.handleDateFormat(d.format),b.successMessage(d.successMessage),
c.fieldValues()[e].isDateControl()&&/^\d{1,2}\/\d{1,2}\/\d{1,4} \d{1,2}:\d{2}:\d{2} AM|PM$/.test(d.newValue)&&c.fieldValues()[e].handleDate(),void 0!==b.jsModuleName&&b.jsModuleName()&&null!==b.jsModuleName()&&b.jsModuleName(d.jsModuleName),void 0!==b.jsModuleParams&&b.jsModuleParams()&&null!==b.jsModuleParams()&&b.jsModuleParams(d.jsModuleParams),void 0!==b.popJSModuleOnFocus&&b.popJSModuleOnFocus()&&null!==b.popJSModuleOnFocus()&&b.popJSModuleOnFocus(d.popJSModuleOnFocus),void 0!==b.picklist&&b.picklist(b.createPickList(d.picklist)),b.changedFromView(!0),b.entityKey(d.entityKey),b.clientid(d.clientid))}H.prototype.updateRow=function a(b,c,d){var e=this,f;if("delete"===b)f=e.deleteRow(c);else if("new"===b){for(var g=!1,h=0;h<e.rows().length;h++)"new-clean"===e.rows()[h].entityStatus()&&(g=!0);!g&&e.isNewAvailable()&&(f=e.addNewRow(c))}else"status"===b?(f=e.getRowByKey(c),f.entityStatus(d)):"save"===b?(e.entities()[d].key=c.key,e.entities()[d].clientid=void 0,
e.rows()[d].entitykey(c.key),0!==c.key&&e.rows()[d].isCheckboxDisabled(!1)):"clientid"===b&&(e.entities()[0].clientid=c.clientid,e.rows()[0].clientid(c.clientid),0!==c.key&&void 0!==c.key||e.rows()[0].isCheckboxDisabled(!0))},H.prototype.addNewRow=function a(b){var c=this,d,e=c.rows().length;d=new g(b.entitykey,b.clientid,c,b.siteKey),d.entityStatus("new-clean"),d.isCheckboxDisabled(!0),c.cachedFieldValues.push(b),c.attachEntityToLayout(b.entitykey,b.fields,e,b.clientid,b.isAuditable),ra(c,e,d),c.rows.push(d),Z(c,b,!1)},H.prototype.handlePreventSiteChangeUpdate=function a(b,c,d){d&&b.PreventSiteChangeUpdate.raise(c,d)},H.prototype.deleteRow=function a(b){var c=this,d,e,f;for(f=0;f<c.rows().length;f++)if(c.rows()[f].entitykey().toString()===b.toString()){d=c.rows()[f],e=f;break}for(c.rows.remove(d),f=0;f<c.entities().length;f++)if(c.entities()[f].key.toString()===b.toString()){d=c.entities()[f],e=f;break}return c.entities.remove(d),d},H.prototype.getRowByKey=function a(b){
var c=this,d=c.rows(),e,f;if(0!==b.key&&"0"!==b.key){for(f=0;f<d.length;f++)if(d[f].entitykey().toString()===b.key.toString()){e=d[f];break}}else for(f=0;f<d.length;f++)if(d[f].clientid()==b.clientid){e=d[f];break}return e},H.prototype.dispose=function a(){this.currentEntity()&&this.currentEntity().dispose(),this.layoutRendered.remove(),this.entityRendered.remove()},H.prototype.renderDateControl=function c(d,e,f){if(!e.fieldValue().disabled()){var g=b(f.currentTarget).closest("td");e.controlTemplate(v.Date),e.fieldValue().handleDate(),a.delay(function(){var a=b(g).find("input.form-control");a.trigger("focus"),a.on("keypress keydown",da.bind(null,d))},10)}};function da(a,b){a&&a.device&&a.device.isMobile()&&b.preventDefault()}H.prototype.changeColumns=function b(){var c=this,d=c.rows(),e=d.length,f=[],g=!0
;(g=!ea(a.map(c.columnsToView(),"columnFieldKey"),a.map(c.selectedColumns(),"columnFieldKey")))&&(c.selectedColumns().length!==c.columns().length&&(f=a.difference(a.map(c.columns(),"columnFieldKey"),a.map(c.selectedColumns(),"columnFieldKey"))),c.datasheetService.updateBDFLayoutPreferences(c.currentDatasheetKey(),"BULKDSCOLCHOOSER",f).done(function(){c.excludedColumnsKeys=f,c.columnsToView(oa(c.selectedColumns()));for(var b=0;b<e;b++)ra(c,b,d[b]);a.defer(Ua.bind(null,c))}).fail(function(){throw"Failed to save bulk datasheet layout preferences"}))};function ea(b,c){return b.length===c.length&&a.every(b,fa.bind(null,c))}function fa(b,c){return a.includes(b,c)}function ga(a,b){a.oldEntity=b}function ha(a,b){a.oldValue&&a.oldValue.dispose(),b.fieldValueChanged.add(ka.bind(null,a)),a.currentEntityChanged.raise(b,a.oldEntity)}function ia(a,b){var c=m.toModelObject(b);a.currentDatasheet(c)}function ja(a,c){var d=b.map(c,function(a){return p.toModelObject(a)});a.fieldInfos(d)}
function ka(b,c,d,e,f,g,h,i){var j=0,k=0,l,m=[];for(b.entities()&&(l=a.find(b.entities(),function(a){return void 0===g?a.key===c:a.clientid===g}),m=l.fieldValues()),j=0;j!==m.length;j++){for(k=0;k!==h.length;k++)m[j].key().toString()!==h[k]&&m[j].key()!==h[k]||m[j].clientDisabled(!0);m[j].key()!==d||m[j].dateValue()||null===m[j].dateValue()||m[j].clientDisabled(!0)}for(var n=0;n<b.entitiesReference.length;n++)for(var o=b.entitiesReference[n].fields,p=0;p<o.length;p++)o.models[p].attributes.key===d&&(o.models[p].attributes.errorMessage="");b.fieldValueChanged.raise(c,d,e,f,g,i),b.handleScrolling()}function la(a){var c={};c=0!==a.queryColumns.length?qa(a.queryColumns):a.currentDatasheet().columns;var d=b.map(c,function(b){return new f(b,a.isReadOnly())});if(a.columns(d),a.excludedColumnsKeys.length){var e=na(a);a.selectedColumns(oa(e)),a.columnsToView(oa(e))}else a.selectedColumns(oa(d)),a.columnsToView(oa(d));ma(a)}function ma(a){var b=o.getData()
;b&&a.cachedFamilykey.toString()===b.familykey.toString()&&(a.isReadOnly()||o.isEmpty()||a.canPaste(!0))}function na(b){for(var c=b.columns(),d=a.difference(a.map(c,"columnFieldKey"),b.excludedColumnsKeys),e=[],f,g=0;g<d.length;g++)(f=a.find(c,pa.bind(null,d[g])))&&e.push(f);return e}function oa(a){return[].concat(a)}function pa(a,b){return b.columnFieldKey===a}function qa(a){var b=[],c;for(c=0;c<a.length;c++)a[c].isVisible&&b.push(a[c]);return b}function ra(a,b,c){var d=0;c.cols([]);var e=a.selectedColumns(),f=e.length;c.addColumns(e),sa(a,b,c)}function sa(a,b,c){var d=0,e,f=a.entities()[b],g;for(d=0;d!==c.cols().length;d++)e=va(a,c.cols()[d]),g=wa(a,f,c.cols()[d],c),c.cols()[d].fieldValue(g),xa(a,c.cols()[d],g,e),g&&g.inputType(e)}function ta(a,b){a.entityRendered.raise()}function ua(a,b){var c=0,d=0,e,f;for(e=a.entities()[b],c=0;c!==a.rows()[b].cols().length;c++)for(d=0;d!==e.fieldValues().length;d++)if(e.fieldValues()[d].id()==a.rows()[b].cols()[c].columnFieldKey){
f=e.fieldValues()[d],xa(a,a.rows()[b].cols()[c],f);break}}function va(a,b){var c;if("-1"===b.columnFieldKey.toString())c="Empty";else{var d=0;for(d=0;d!==a.fieldInfos().length;d++)if(a.fieldInfos()[d].fieldId.toString()===b.columnFieldKey.toString()){c=a.fieldInfos()[d].inputType;break}}return c}function wa(a,b,c,d){for(var e,f=b.fieldValues(),g=0;g<f.length;g++)if(f[g].id().toString()===c.columnFieldKey.toString()&&b.key.toString()===d.entitykey().toString()){e=f[g],c.fieldValue(e);break}return e}function xa(a,b,c,d){d=d||null,c&&c.isMaskedField===!0?d="MaskedTextBox":c&&void 0!==c.picklist?d=a.useNativeSelect()&&parseInt(c.maxNumberOfValues())<2&&c.isPicklistRestricted()?"Select":c.isPicklistRestricted()?"ComboBox":"MultiValue":c&&parseInt(c.maxNumberOfValues())>1?d="MultiText":c&&c.displayValue().indexOf("href")>0?d="Hyperlink":c&&void 0!==c.uomKey()&&"-1"!==c.uomKey()?d="UOMTextbox":c&&c.jsModuleName()&&c.jsModuleName().length&&(d="JSModule"),"Date"===d&&(d="DateAlt"),
b.controlTemplate(v[d]||null),b.fieldValue(c),"field-date-template"===b.controlTemplate()&&c.handleDate()}H.prototype.handleOverlay=function a(){ya(this)};function ya(a){var c=0,d,e,f,g;a.isDatasheetReadOnly()&&a.containerEl&&(d=b(a.containerEl).find(".freezed-cols-container .table.table-cust1"),d.length>0&&(c=b(d[0]).width()),e=b(a.containerEl).find(".table-responsive .table.table-cust1").width()+c,b(a.containerEl).find(".bulk-datasheet-disabled-overlay").width(e),(f=b(a.containerEl).find(".datasheet-layout-container .bulk-datasheet-header-container").height()+10)&&(g=b(a.containerEl).find(".datasheet-layout-container").height(),za(a.region.$element.find(".datasheet-layout-container .table-responsive"))?b(a.containerEl).find(".bulk-datasheet-disabled-overlay").height(g-f-37):b(a.containerEl).find(".bulk-datasheet-disabled-overlay").height(g-f-20),a.overlayTop(f+"px")))}function za(a){return 0!==a.length&&a[0].clientWidth<a[0].scrollWidth}function Aa(a){a.layoutRendered.raise(),
a.isDatasheetRendered(!0),a.uiHelper.addMoreOptionsForIcons(a,".bulk-ds-iconbar","bulk")}function Ba(b){var c=b.region.$element.find("mi-site-selector");b.siteSelector=[],c.length&&a.each(c,function(a){b.siteSelector.push(a);var c=a.isSiteViewOnly;Element.upgrade(a),c&&(b.isSelectedSiteViewOnly(c),b.isSaveAvailable(!1))})}H.prototype.afterLoad=function a(){Ba(this)},H.prototype.focusNextRow=function a(c,d,e,f){var g=this.rows(),h=this;switch(d.which){case b.ui.keyCode.LEFT:this.moveLeft(c,g,e,f);break;case b.ui.keyCode.UP:this.moveUp(c,g,e,f);break;case b.ui.keyCode.RIGHT:this.moveRight(c,g,e,f);break;case b.ui.keyCode.DOWN:this.moveDown(c,g,e,f);break;case b.ui.keyCode.SPACE:"field-check-box-template"===c.controlTemplate()&&c.fieldValue().value(!c.fieldValue().value());break;case b.ui.keyCode.TAB:if(b(d.target).hasClass("custom-bulk-ds-button")){if(h.moveRight(c,h.rows(),e,f),e()<h.rows()[f()].cols().length-1){var i=h.rows()[f()].cols()[e()+1]
;"field-text-template"===i.controlTemplate()&&i.fieldValue().jsModuleName()&&i.fieldValue().jsModuleName().length>0&&h.callOnFocus(i.fieldValue(),i,function(){return e()+1},f)}}else"field-text-template"===c.controlTemplate()&&c.fieldValue().jsModuleName()&&c.fieldValue().jsModuleName().length&&h.callOnFocus(c.fieldValue(),c,e,f);break;default:return!0}return!0},H.prototype.moveToNextCell=function a(b,c){c.fieldValue().isSelected(!0)},H.prototype.moveLeft=function a(b,c,d,e){var f,g=this,h;h=g.freezedCols()&&g.freezedCols().length?d()+g.freezedCols().length:d(),f=c[e()].cols()[h-1],h>0&&f.fieldValue().isSelected(!0)},H.prototype.moveRight=function a(b,c,d,e){var f,g=this,h;h=g.freezedCols()&&g.freezedCols().length?d()+g.freezedCols().length:d(),f=c[e()].cols()[h+1],h<c[e()].cols().length-1&&(f.fieldValue()?f.fieldValue().isSelected(!0):g.moveRight(null,g.rows(),function(){return h+1},e))},H.prototype.focusCell=function a(b,c,d,e){var f;e&&d&&(f=c[e()].cols()[d()],
f.fieldValue().isSelected(!0))},H.prototype.moveUp=function a(b,c,d,e){e()>0&&c[e()-1].cols()[d()].fieldValue().isSelected(!0)},H.prototype.moveDown=function a(b,c,d,e){e()<c.length-1?c[e()+1].cols()[d()].fieldValue().isSelected(!0):e()===c.length-1&&"new-dirty"===c[e()].entityStatus()&&(this.currentCellIndex(d()),this.datasheetNew.raise())},H.prototype.showTextEditor=function a(b,c,d){var e=this,f=b.fieldValue().showTextEditor.call(b,e.isDatasheetReadOnly());return f.onSave.add(function a(){e.focusCell(b,e.rows(),c,d)}),f.onClose.add(function a(){e.focusCell(b,e.rows(),c,d)}),f},H.prototype.multipleRowSelect=function a(b,c,d){var e;if(c.shiftKey){var f=[];for(e=0;e<this.rows().length;e++)this.rows()[e].isSelected()&&f.push(e);if(0!==f.length)if(d()<f[0])for(e=d()+1;e<f[0];e++)this.rows()[e].isSelected(!0);else if(d()>f[f.length-1])for(e=f[f.length-1];e<d();e++)this.rows()[e].isSelected(!0)}},H.prototype.showHistory=function a(){this.datasheetHistory.raise(this.selectedEntities())},
H.prototype.showRefDocs=function a(){this.datasheetRefDoc.raise(this.selectedEntities())};function Ca(a){var b=[];return c.utils.arrayForEach(a.rows(),function(a){a.isSelected()&&a.entitykey()&&(b.push(a.entitykey()),this.entitySelected.raise(this.entities()))}.bind(a)),b}function Da(a,b){a.hasSelection(!b.length),a.canDownloadRefDoc(!1),1===b.length?(a.isSingleEntitySelected(!0),a.isRefDocFamily()&&0!==b[0]&&Ia(a,b[0])&&a.canDownloadRefDoc(!0)):a.isSingleEntitySelected(!1)}function Ea(a,b){c.utils.arrayForEach(a.rows(),function(a){a.entitykey()&&!a.isReadonly()?a.isSelected(b):a.isSelected(!1)})}function Fa(a){var b=[];return c.utils.arrayForEach(a.rows(),function(a){a.isSelected()&&a.entitykey()&&b.push(a)}.bind(a)),b}function Ga(a){var b=[];return c.utils.arrayForEach(a.rows(),function(a){a.isFrozen()&&b.push(a)}.bind(a)),b}function Ha(a,b){void 0!==b&&null!==b&&""!==b&&(a.siteSelector=a.region.$element.find("mi-site-selector")[0],Element.upgrade(a.siteSelector),
a.siteSelector&&a.siteSelector.selectSiteByAssetKey(b))}H.prototype.getSelectedEntities=function a(){return this.selectedEntities()};function Ia(a,b){var c,d,e,f,g=Ja(a.entities(),b);return c=Ka(g.fieldValues(),"MI_REF_DOCUMENTS_STORE_DOCUM_L"),d=Ka(g.fieldValues(),"MIRD_DOC_PATH_CHR"),e=!(!c.value()||"true"!==c.value().toString().toLowerCase()),f=d.value(),e&&""!==f}function Ja(b,c){return a.find(b,function(a){return a.key===c})}function Ka(b,c){return a.find(b,function(a){return a.id()===c})}H.prototype.showJSModule=function a(b,c,d,e,f,g,h,i){var j={key:b,jsModuleName:e,jsModuleParams:f,type:"bulk",entityKey:c,clientID:d,data:g,cellIndex:h,rowIndex:i,fieldKey:b};this.jsModuleHelper.showJSModule(this,j)},H.prototype.callOnFocus=function a(b,c,d,e){var f={key:b.key(),data:c,cellIndex:d,rowIndex:e,type:"bulk",entityKey:b.entityKey(),clientID:b.clientid(),fieldKey:b.key()};this.jsModuleHelper.callOnFocus(this,f,b)},H.prototype.getSelectedRowIndex=function a(){
for(var b=[],c=0;c<this.rows().length;c++)this.rows()[c].isSelected()&&b.push(c);return b},H.prototype.copyDatasheet=function a(){var b=this.entities()[this.getSelectedRowIndex()].fieldValues();o.setData(this.cachedFamilykey,b),this.canPaste(!0)},H.prototype.pasteDatasheet=function a(){for(var b=o.getData(),c=this,d=b.fieldValues,e=0;e<this.rows().length;e++)if("new-clean"===this.rows()[e].entityStatus()){for(var f=0;f<this.rows()[e].cols().length;f++)for(var g=0;g<d.length;g++)if(d[g].id.toString()===this.rows()[e].cols()[f].columnFieldKey.toString()){var h=this.rows()[e].cols()[f].fieldValue();this.updateFieldValue({clientid:this.rows()[e].clientid(),entitykey:this.rows()[e].entitykey(),fields:d,isDirty:!0},h.key(),d[g].value,d[g].values,d[g].displayValue,d[g].picklist,!1,d[g].required,d[g].required?"this is required field":"",d[g].backColor,d[g].maxNumberOfValues,d[g].dependentFields);break}
for(var i=0;i<c.excludedColumnsKeys.length;i++)for(var j=0;j<d.length;j++)if(d[j].id.toString()===c.excludedColumnsKeys[i].toString()){this.updateFieldValue({clientid:this.rows()[e].clientid(),entitykey:this.rows()[e].entitykey(),fields:d,isDirty:!0},d[j].key,d[j].value,d[j].values,d[j].displayValue,d[j].picklist,!1,d[j].required,d[j].required?"this is required field":"",d[j].backColor,d[j].maxNumberOfValues,d[j].dependentFields);break}}},H.prototype.addMoreOptionsForIcons=function a(){this.uiHelper.addMoreOptionsForIcons(this,".bulk-ds-iconbar","bulk")},H.prototype.setIconOptions=function a(){var c=b.Deferred();return c=this.uiHelper.setIconOptions(this,"bulk")},H.prototype.selectColumn=function a(b){var c=this;c.focusedColumn&&c.focusedColumn.isSelected(!1),c.focusedColumn=b,b.isSelected(!0)},H.prototype.isFrozenColumn=function b(c){var d=this;return d.focusedColumn&&a.indexOf(d.frozenColsKeys(),d.focusedColumn.columnFieldKey)!==-1},H.prototype.freezeColumn=function b(c){var d=this
;if(d.focusedColumn&&d.frozenColsKeys().length<4){var e=a.includes(d.frozenColsKeys(),d.focusedColumn.columnFieldKey),f=oa(d.frozenColsKeys());d.focusedColumn&&!e&&(f.push(d.focusedColumn.columnFieldKey),d.datasheetService.updateBDFLayoutPreferences(d.currentDatasheetKey(),"BULKDSFROZENCOLS",f).done(function(){d.frozenColsKeys.push(d.focusedColumn.columnFieldKey),Ua(d)}).fail(function(){throw"Failed to update Bulk datasheet layout preferences"}))}},H.prototype.unfreezeColumn=function b(c){var d=this;if(d.focusedColumn){var e=a.includes(d.frozenColsKeys(),d.focusedColumn.columnFieldKey),f=oa(d.frozenColsKeys());d.focusedColumn&&e&&(a.pull(f,d.focusedColumn.columnFieldKey),d.datasheetService.updateBDFLayoutPreferences(d.currentDatasheetKey(),"BULKDSFROZENCOLS",f).done(function(){d.frozenColsKeys.remove(d.focusedColumn.columnFieldKey),Ua(d)}).fail(function(){throw"Failed to update Bulk datasheet layout preferences"}))}},H.prototype.openColumnChooser=function a(){
var b=this,c=new h(this),e=new d;c.attach(e);var f=new u(c,b.translate("DATASHEET_REORDER_COLUMNS"),{height:"50%",width:"50%"});c.setDialog(f),f.show()},H.prototype.downloadRefDoc=function a(){var b=this;b.refDocHelper.downloadRefDoc(b,b.selectedEntities()[0])},H.prototype.deallocateMem=function a(){Ma(this),La(this),Na(this),this.kom.dispose(),this.kom=null,this.datasheetService=null,this.translator=null,this.appEvents=null,this.exportService=null,this.printHelper=null,this.jsModuleHelper=null,this.uiHelper=null,this.title=null,this.isBulkDatasheet=null,this.isMasterDatasheet=null,this.datasheetKeys=null,this.datasheets=null,this.currentDatasheetKey=null,this.currentDatasheetCaption=null,this.cachedFieldValues=null,this.cachedFamilykey=null,this.assocFamilyKey=null,this.assocEntityKey=null,this.isAssociatedPagesDisabled=null,this.currentDatasheet=null,this.currentEntity=null,this.currentEntities=null,this.fieldInfos=null,this.columns=null,this.rows=null,this.currentCellIndex=null,
this.entities=null,this.ValidateBeforeSave=null,this.isSaveAvailable=null,this.isCopyAvailable=null,this.isPasteEnabled=null,this.isDeleteAvailable=null,this.isHistoryAvailable=null,this.isHistoryDisabled=null,this.isRefDocAvailable=null,this.isRefDocDisabled=null,this.isSingleEntitySelected=null,this.isLinkAvailable=null,this.isUnlinkAvailable=null,this.isNewAvailable=null,this.isSiteFiltered=null,this.isSelectedSiteViewOnly=null,this.showSiteSelector=null,this.loadedFromCache=null,this.predEntitySiteKey=null,this.assetContextKey=null,this.isDatasheetReadOnly=null,this.canEdit=null,this.canPaste=null,this.overlayTop=null,this.showDatasheetSelection=null,this.oldEntity=null,this.isDatasheetRendered=null,this.isReadOnly=null,this.layoutRendered.remove(),this.entityRendered.remove(),this.fieldValueChanged.remove(),this.currentEntityChanged.remove(),this.datasheetSaved.remove(),this.datasheetNew.remove(),this.datasheetDelete.remove(),this.datasheetHistory.remove(),
this.datasheetRefDoc.remove(),this.hasSelectionChanged.remove(),this.unlinkEntities.remove(),this.datasheetChanged.remove(),this.ValidateBeforeEveryThing.remove(),this.entitySelected.remove(),this.pageChangeEvent.remove(),this.PreventSiteChangeUpdate.remove(),this.onSiteChange.remove(),this.layoutRendered=null,this.entityRendered=null,this.fieldValueChanged=null,this.currentEntityChanged=null,this.datasheetSaved=null,this.datasheetNew=null,this.datasheetDelete=null,this.datasheetHistory=null,this.datasheetRefDoc=null,this.hasSelectionChanged=null,this.unlinkEntities=null,this.datasheetChanged=null,this.ValidateBeforeEveryThing=null,this.entitySelected=null,this.selectMode=null,this.hasSelection=null,this.selectAll=null,this.selectedEntities=null,this.selectedRows=null,this.frozenRows=null,this.useNativeSelect=null,this.siteSelector=null,this.pageChangeEvent=null,this.preventPageChange=null,this.pageSelector=null,this.pageSize=null,this.minPage=null,this.maxPage=null,
this.pageOptions=null,this.totalRows=null,this.queryColumns=null,this.selectedColumns=null,this.columnsToView=null,this.focusedColumn=null,this.frozenColsKeys=null,this.freezedCols=null,this.floatCols=null,this.util=null,this.currentEntityChangedSubscription=null,this.currentEntityBeforeChangeSubscription=null,this.iconOptions=null,this.excludedColumnsKeys=null,this.subscriptions=null,this.view=null,this.iconsMoreOptions=null,this.region=null,this.isRefDocFamily=null,this.refDocHelper=null,this.refDocService=null,this.canDownloadRefDoc=null,this.updatePref=null,this.entitiesReference=null,this.showColumnChooser=null,this.PreventSiteChangeUpdate=null,this.onSiteChange=null,this.device=null};function La(a){var b=a.region.$element.find("mi-more-options-noko"),c;for(c=0;c<b.length;c++)"function"==typeof b[c].deallocateMem&&b[c].deallocateMem()}function Ma(a){var b;for(b=0;b<a.rows().length;b++)a.rows()[b].deallocateMem(),a.rows()[b]=null
;for(b=0;b<a.columns().length;b++)a.columns()[b].deallocateMem(),a.columns()[b]=null}function Na(a){var b;for(b=0;b<a.entities().length;b++)a.entities()[b].fieldValueChanged.remove(),a.entities()[b].deallocateMem(),a.entities()[b]=null}function Oa(a,b){if(a.preventPageChange)return void(a.preventPageChange=!1);a.pageChangeEvent.raise(b)}function Pa(b){var c=[];return a.each(b.frozenColsKeys(),Qa.bind(null,b,c)),c}function Qa(b,c,d){function e(a,b){return b.columnFieldKey===a}var f=a.find(b.columnsToView(),e.bind(null,d));return f&&c.push(f),c}function Ra(b){var c=[];return a.each(b.columnsToView(),Sa.bind(null,b,c)),c}function Sa(b,c,d){function e(a,b){return a.columnFieldKey===b}return a.find(b.frozenColsKeys(),e.bind(null,d))||c.push(d),c}H.prototype.isFrozenRow=function a(b){var c=this;return 1===c.selectedRows().length&&c.selectedRows()[0].isFrozen()},H.prototype.freezeRow=function a(b){var c=this;c.selectedRows()[0].isFrozen(!0),Ua(c)},H.prototype.unfreezeRow=function a(b){
var c=this;c.selectedRows()[0].isFrozen(!1),Ua(c)},H.prototype.freezeRowsByKeys=function b(c){for(var d=this,e=0;e<c.length;e++){a.find(d.rows(),Ta.bind(null,c[e])).isFrozen(!0)}},H.prototype.showUOMConversionTool=function a(b,c){b.uomConversion=Object.resolve(G),b.uomConversion.show(c)};function Ta(a,b){return a.toString()===b.entitykey().toString()}H.prototype.handleScrolling=function a(){Ua(this)};function Ua(a){return a.region.$element.gridScroll({table:".bulk-datasheet-table",header:".bulk-datasheet-table-header ",body:".bulk-datasheet-table-body",scrollBar:".bulk-float-table-scrollbar",rowSelectorCol:"row-selector",excludeCols:"site-selector-container"})}function Va(a,b){a.printHelper.print(a,"bulk",b)}function Wa(b,c){return a.find(b,function(a){return a.id.replace(/\[|\]/g,"")===c})}function Xa(a,b){a.isVisible=b.display}function Ya(a,b){a.isVisible=b.getIsDisplayed()}return H});

define('text!platform/datasheets/layout/ui/views/refdoc-view.html',[],function () { return '<div class="datasheet-refdoc-container">\r\n    <mi-ref-doc data-bind="attr: {entitykey: $root.entityKey}"></mi-ref-doc>\r\n</div>\r\n<footer>\r\n    <button class="btn btn-text pull-right datasheet-refdoc-closebtn" data-bind="click: $root.closeRefDoc, text: $root.translate(\'DS_CLOSE\')"></button>\r\n</footer>\r\n';});

define('platform/datasheets/layout/ui/datasheet-refdoc-view-model',['require','knockout','spa/ko/knockout-view-model','text!./views/refdoc-view.html','system/globalization/translator'],function(require){"use strict";var a=require("knockout"),b=require("spa/ko/knockout-view-model"),c=require("text!./views/refdoc-view.html"),d=require("system/globalization/translator");function e(b){this.contentEl=c,f.call(this,this.contentEl),this.region=null,this.entity=null,this.dialog=null,this.entityKey=a.observable(b),this.translator=Object.resolve(d)}var f=Object.inherit(b,e);e.prototype.attach=function a(b){f.prototype.attach.call(this,b),this.region=b,this.refdocEl=this.region.$element.find("mi-ref-doc")[0],Element.upgrade(this.refdocEl)},e.prototype.translate=function a(b){return this.translator.translate(b)},e.prototype.setDialog=function a(b){this.dialog=b},e.prototype.closeRefDoc=function a(){g(this)};function g(a){a.dialog.closeDialog()}return e});
define('platform/datasheets/bulk-datasheet-manager',['require','lodash','jquery','./layout/ui/bulk-datasheet-view-model','spa/region','../entity/entity-factory','text!./layout/ui/views/spinner.html','system/lang/event','system/lang/converter','./error-dialog/ui/error-dialog-view-model','system/ui/dialog-view-model','./layout/ui/datasheet-history-view-model','./layout/ui/datasheet-refdoc-view-model','logging/feedback-component/feedback-component','system/ui/message-box','system/ui/unsaved-changes-message-box','./layout/services/manager-service','system/globalization/translator','application/application-events','system/error/error-message','platform/metadata/services/metadata','application/application-context','system/ui/busy-indicator','platform/datasheets/layout/ui/datasheet-authentication-dialog-view-model','catalog/services/catalog-service','query/execution/query-execution-engine'],function(require){"use strict"
;var a=require("lodash"),b=require("jquery"),c=require("./layout/ui/bulk-datasheet-view-model"),d=require("spa/region"),e=require("../entity/entity-factory"),f=require("text!./layout/ui/views/spinner.html"),g=require("system/lang/event"),h=require("system/lang/converter"),i=require("./error-dialog/ui/error-dialog-view-model"),j=require("system/ui/dialog-view-model"),k=require("./layout/ui/datasheet-history-view-model"),l=require("./layout/ui/datasheet-refdoc-view-model"),m=require("logging/feedback-component/feedback-component"),n=require("system/ui/message-box"),o=require("system/ui/unsaved-changes-message-box"),p=require("./layout/services/manager-service"),q=require("system/globalization/translator"),r=require("application/application-events"),s=require("system/error/error-message"),t=require("platform/metadata/services/metadata"),u=require("application/application-context"),v=require("system/ui/busy-indicator"),w=require("platform/datasheets/layout/ui/datasheet-authentication-dialog-view-model"),x=require("catalog/services/catalog-service"),y=require("query/execution/query-execution-engine")
;function z(a){this.defaultConfig={functionsavailable:["save","new","delete"],readonly:!1,canedit:!0,hasspinner:!0,showdatasheetselection:!0,loadedfrommodule:!0,showsiteselector:!0,disablesiteselector:!1,columnchooser:!0},this.options=a,this.translator=Object.resolve(q),this.containerEl=a.containerel,this.datasheetkey=a.datasheetkey,this.updatePref=a.updatepref,this.entityObj=[].concat(a.entityobj),this.inEntityFormat=a.inEntityFormat,this.familyKey=a.familykey,this.catalogItemPath=a.catalogitempath,this.assetContextKey=a.assetcontextkey,this.validationCB=a.validationcb||!1,this.predEntityKey=a.predentitykey||"",this.entityFactory=new e,this.appEvents=Object.resolve(r),this.entitySaved=new g,this.entityModified=new g,this.entityDeleted=new g,this.entityCreated=new g,this.unlinkEntities=new g,this.entitySelected=new g,this.pageChangeDone=new g,this.detailDatasheetEditDenied=new g,this.entityIdChanged=new g,this.ValidateBeforeEveryThing=new g,this.noEntitiesToSave=new g,
this.sequenceNumber=1,this.isCreatingNewRow=!1,this.newEntityFlag=!1,this.window=window,this.canInsert=!1,this.canUpdate=!1,this.canView=!1,this.canDelete=!1,this.isSuperUser=!1,this.isMasterDatasheetDirty=!1,this.indicator=Object.resolve(v,"loading-med"),this.pageSize=a.pagesize||100,this.startIndex=0,this.endIndex=this.pageSize,this.catalogService=Object.resolve(x),this.queryColumns=null,this.totalRows=0,this.maxRows=100,this.frozenRowKeys=[],this.viewOnly=!1,this.masterSiteKey=null,this.predEntitySiteKey=null,this.queryColumnDesigns=null}z.prototype.translate=function a(b){return this.translator.translate(b)},z.prototype.getState=function a(){var b;for(b=0;this.entity&&b<this.entity.length;b++)this.detachEntityEventHandlers(this.entity[b]);return A(this)};function A(b){return b.region.$element.find("mi-site-selector").length&&a.each(b.cachedEntity,function(c,d){a.each(b.layout.rows(),function(a,e){
c.key.toString()===a.entitykey().toString()&&d===e&&(b.cachedEntity[d].siteKey=a.siteKey())})}),b.cachedEntity}z.prototype.load=function a(c){var d=this,e=b.Deferred(),f,g,h;return d.setConfig(c),d.config.hasspinner&&(d.indicator.attachTo(this.containerEl.parent()[0]),b(this.containerEl.parent()[0]).find(".busy-indicator-wrap").css("min-height","400px"),d.indicator.show()),g=d.getSecurityPrivPromise(),g.done(function(a){f=d.getEntityPromise(),f.done(function(a){if(d.clearSpinner(),a)if(d.cachedEntity&&(a=d.cachedEntity),a.length>0){d.entity=a,d.familyKey||(d.familyKey=d.entity[0].familyKey);for(var b=0;b<a.length;b++)d.attachEntityEventListeners(a[b]);d.entityFactory.bulkDeleteEvent.add(T.bind(null,d)),d.entityFactory.updateEntitiesEvent.add(U.bind(null,d)),""!==d.predEntityKey?d.getSiteKey().done(function(b){d.predEntitySiteKey=b,B(d,e,a)}):B(d,e,a)}else d.clearSpinner(),d.catalogItemPath&&n.showOk(d.translate("NO_RECORD_MSG"));else e.resolve()}).fail(function(a,b){
b&&403===b.status?n.showOk(b.statusText):d.entityObj&&0===d.entityObj.length&&!d.canInsert?n.showOk(d.translate("DS_ENTITY_NO_INSERT_PRIV"),d.translator.translate("DS_INFORMATION")):d.throwException(d.translate("DS_LOAD_ENTITY_FAIL_EXCEPTION")),e.reject(),d.clearSpinner()})}),e};function B(a,b,c){var d;d=a.renderDatasheet(c),a.layout.isHistoryDisabled(!a.getHistoryStatus(c)),a.layout.isSiteFiltered(a.getSiteFilteredStatus(c)),a.getRefDocStatus(c).done(function(b){a.layout.isRefDocDisabled(!b)}).fail(function(){a.layout.isHistoryDisabled(!0)}),d.done(function(){L(a),a.layout.afterLoad(),M(a),b.resolve(a.entity),a.clearSpinner()}).fail(function(){a.config.ismasterdatasheet||a.throwException(a.translate("DS_RENDER_DATASHEET_FAIL_EXCEPTION")),a.layout.isAllDatasheetsHidden?b.reject(!0):b.reject(),a.clearSpinner()})}z.prototype.changeDatasheet=function a(c,d,e){var f=this,g=b.Deferred();return 0===c.length&&f.canInsert?f.entityFactory.new(e).done(function(a){
null!==f.masterSiteKey&&(a.siteKey=f.masterSiteKey),c.push(a),f.familyKey=c[0].familyKey,C(f,c,d).done(function(){g.resolve(f.entity)})}):C(f,c,d).done(function(){g.resolve(f.entity)}),g};function C(a,c,d){var e,f=b.Deferred();a.setConfig(d),a.entity=c,a.familyKey||(a.familyKey=a.entity[0].familyKey),a.clearSpinner();for(var g=0;g<c.length;g++)a.attachEntityEventListeners(c[g]);return a.entityFactory.bulkDeleteEvent.add(T.bind(null,a)),a.entityFactory.updateEntitiesEvent.add(U.bind(null,a)),e=a.renderDatasheet(c),a.layout.isHistoryDisabled(!a.getHistoryStatus(c)),a.layout.isSiteFiltered(a.getSiteFilteredStatus(c)),e.done(function(){L(a),M(a),f.resolve(a.entity)}).fail(function(){a.throwException(a.translate("DS_RENDER_DATASHEET_FAIL_EXCEPTION")),f.reject()}),f}z.prototype.getEntityPromise=function a(){var c=this,d=b.Deferred()
;return c.entityObj&&0===c.entityObj.length?c.familyKey&&!c.viewOnly?c.createEntity():(c.viewOnly&&(b(".detail-datasheet-container").length?b(".detail-datasheet-container").html(""):b(c.containerEl).html('<div class="empty-detail-datasheet">'+c.translate("NO_RECORD_MSG")+"</div>"),b(".empty-detail-datasheet").show()),d.resolve(!1),d.promise()):h.toBoolean(c.inEntityFormat,"true")?(d.resolve(c.entityObj),d.promise()):c.loadEntity()};function D(a){!a.canView||a.canInsert||a.canUpdate||a.canDelete||(a.viewOnly=!0)}z.prototype.getSecurityPrivPromise=function a(){var c=b.Deferred(),d=this;return d.isSuperUser=u.user.isSuperUser,d.entityObj&&0===d.entityObj.length?d.familyKey&&(isNaN(parseInt(d.familyKey))?t.getEntityFamilyByid(d.familyKey).done(function(a){d.canInsert=a.canInsert,d.canView=a.canView,d.canUpdate=a.canUpdate,d.canDelete=a.canDelete,d.fieldMetadata=a.fields,D(d),c.resolve(a)}):t.getEntityFamilyByKey(d.familyKey).done(function(a){d.canInsert=a.canInsert,d.canView=a.canView,
d.canUpdate=a.canUpdate,d.canDelete=a.canDelete,d.fieldMetadata=a.fields,D(d),c.resolve(a)})):d.catalogItemPath?(d.canInsert=!0,d.canView=!0,d.canUpdate=!0,d.canDelete=!0,c.resolve()):c.resolve(),c.promise()},z.prototype.setConfig=function a(c){var d=this;d.config=c||{},d.config=ma(d.config),b.extend(d.defaultConfig,d.config),d.config=d.defaultConfig,d.validateConfig()},z.prototype.validateConfig=function a(){var b=this;b.entityObj&&0!==b.entityObj||b.familyKey||b.catalogItemPath||b.throwException(b.translate("DS_BULK_VALID_CONFIG_EXCEPTION"))},z.prototype.showSpinner=function a(){this.config.hasspinner&&this.indicator.show()},z.prototype.clearSpinner=function a(){this.config.hasspinner&&this.indicator.hide()},z.prototype.callOnMasterDatasheetDelete=function a(){var c=this,d=b.Deferred();return c.layout&&(c.layout.detach(c.region),d.resolve()),d},z.prototype.unload=function a(c){var d=this,e=b.Deferred();c=c!==!0&&c!==!1||c;var f=d.entityFactory.checkIfEntitiesDirty(d.entity)
;return f.done(function(){d.layout&&d.layout.detach(d.region),e.resolve()}),f.fail(function(){d.isMasterDatasheetDirty===!1&&c?ja().done(function(a){0===a?E(d,e):1===a&&U(d,d.entity).done(E.bind(null,d,e))}).fail(function(){e.reject()}):E(d,e)}),e};function E(a,b){a.layout&&(a.layout.detach(a.region),b.resolve())}z.prototype.setTitle=function a(b){var c=this;c.layout&&c.layout.setTitle(b)},z.prototype.repaint=function a(){var b=this;b.layout&&b.layout.handleScrolling(b)},z.prototype.loadEntity=function a(){var c=b.Deferred(),d=this;if(d.catalogItemPath)d.getBulkQueryData().done(function(a){c.resolve(a)});else{var e=F(d);d.entityFactory.get(e).done(function(a){t.getEntityFamilyByKey(a[0].familyKey).done(function(b){d.canInsert=b.canInsert,d.canView=b.canView,d.canUpdate=b.canUpdate,d.canDelete=b.canDelete,d.fieldMetadata=b.fields,c.resolve(a)}).fail(function(a){c.reject(null,a)})}).fail(function(a){c.reject(null,a)})}return c.promise()},z.prototype.getSiteKey=function a(){
var c=b.Deferred(),d=this;return d.entityFactory.getSiteKey(d.predEntityKey).done(function(a){c.resolve(a)}).fail(function(a){c.reject(null,a)}),c.promise()};function F(b){var c=b.entityObj.length>b.pageSize?b.entityObj.slice(b.startIndex,b.endIndex):b.entityObj;return a.union(c,b.frozenRowKeys)}z.prototype.createEntity=function a(){var c=b.Deferred(),d=this,e=[];return d.canInsert?d.entityFactory.new(d.familyKey).done(function(a){null!==d.masterSiteKey&&(a.siteKey=d.masterSiteKey),e.push(a),c.resolve(e)}).fail(function(a,b){c.reject(a,b)}):c.reject(),c.promise()},z.prototype.updateState=function b(c,d,e){c&&(this.sequenceNumber=a.max(a.compact(a.map(c,"clientid")))+1,d&&(this.entityObj=d),this.cachedEntity=c)},z.prototype.getBulkQueryData=function a(){var c=b.Deferred(),d=this;return 0===d.totalRows?d.getCatalogQueryEntity().done(function(a){d.getCatalogQueryTotalCount(d,a),d.compositeObject=ra(d,a),d.entityFactory.getBulkEntitiesByQuery(d.compositeObject).done(function(a){
c.resolve(a)}).fail(function(a){c.reject(null,a)})}):(d.compositeObject.startRow=d.startIndex,d.entityFactory.getBulkEntitiesByQuery(d.compositeObject).done(function(a){c.resolve(a)}).fail(function(a){c.reject(null,a)})),c.promise()},z.prototype.getCatalogQueryEntity=function a(){var c=b.Deferred(),d=this,e={};return e.suppressPrompts=!1,e.pageSize=100,e.startPage="0",d.catalogService.getCatalogItemKey(d.catalogItemPath).done(function(a){e.catalogItemKey=a,e.sync=!0,d.queyExecutionEngine=new y(e),d.queyExecutionEngine.execute(e).done(function(a){d.queryColumnDesigns=a.queryContainer.columnDesigns,d.queryColumns=a.result.getColumns(),c.resolve(a)})}),c.promise()},z.prototype.getCatalogQueryTotalCount=function a(c,d){var e=b.Deferred(),f={};return f.evalOnly=!0,f.suppressPrompts=!0,f.queryContainer=d.queryContainer,c.queyExecutionEngine=new y(f),c.queyExecutionEngine.execute(f).done(function(a){c.totalRows=a.rowCount}),e.promise()},z.prototype.renderDatasheet=function a(b){
return G(this,b)};function G(a,e){var f=b.Deferred(),g=[];a.layout=Object.resolve(c,a.entityObj,a.totalRows,a.pageSize),a.catalogItemPath&&a.layout.setQueryColumns(a.queryColumns,a.queryColumnDesigns),a.validationCB&&a.layout.ValidateBeforeSave(!0),e.length&&"MI Reference Document"===e[0].familyID&&a.layout.isRefDocFamily(!0),a.region=new d,a.attachLayoutEventListeners(),a.layout.fieldValueChanged.add(R.bind(null,a)),a.region.setElement(a.containerEl),1===u.dbSiteCount&&(a.config.showsiteselector=!1),a.config.showsiteselector||a.layout.showSiteSelector(!1),a.config.disablesiteselector&&a.layout.isSelectedSiteViewOnly(!0),a.config.columnchooser||a.layout.showColumnChooser(!1),a.predEntitySiteKey&&a.layout.predEntitySiteKey(a.predEntitySiteKey),a.cachedEntity&&a.layout.loadedFromCache(!0),a.layout.attach(a.region);for(var h=0;h<e.length;h++)g.push({entitykey:e[h].key,clientid:e[h].clientid,fields:N(a,e[h]),isAuditable:e[h].isAuditable,siteKey:e[h].siteKey})
;return(e[0]&&e[0].useUrlRedirection&&!a.config.loadedfrommodule||a.config.readonly)&&a.layout.isSelectedSiteViewOnly(!0),a.layout.entitiesReference=a.entity,a.config.ismasterdatasheet&&a.layout.isMasterDatasheet(a.config.ismasterdatasheet),a.layout.showDatasheet(a.datasheetkey,a.familyKey,g,a.updatePref).done(function(){var c,d;if(e[0]&&e[0].isSiteFiltered&&0===e[0].siteKey&&a.assetContextKey>0&&a.layout.assetContextKey(a.assetContextKey),a.layout.preventPageChange=a.layout.pageSelector()!==(a.endIndex/a.layout.pageSize).toString(),a.layout.pageSelector((a.endIndex/a.layout.pageSize).toString()),e[0]&&e[0].useUrlRedirection&&!a.config.loadedfrommodule?(a.layout.isDatasheetReadOnly(!0),a.layout.isSaveAvailable(!1),a.layout.isDeleteAvailable(!1),a.layout.isNewAvailable(!1),a.layout.canEdit(!1),a.containerEl&&(a.layout.containerEl=a.containerEl),a.detailDatasheetEditDenied.add(J.bind(null,a))):a.config.readonly?(a.layout.isDatasheetReadOnly(!0),a.layout.canEdit(a.config.canedit),
a.containerEl&&(a.layout.containerEl=a.containerEl),a.detailDatasheetEditDenied.add(J.bind(null,a))):a.layout.isDatasheetReadOnly(!1),a.config.showdatasheetselection&&!a.catalogItemPath||a.layout.showDatasheetSelection(!1),a.cachedEntity)for(var g=0;g<e.length;g++)a.getEntityStatus(e[g],a).done(function(b,c,d){a.layout.updateRow("status",b,c)}.bind(null,e[g]));a.canInsert&&a.entity&&0!==a.entity[0].key?ka.call(null,a):(a.entity[0].clientid=a.sequenceNumber++,a.attachEntityEventListeners(a.entity[0]),a.layout.updateRow("clientid",{clientid:a.entity[0].clientid,key:a.entity[0].key}),0===a.entity[0].key&&a.entityCreated.raise(a.entity[0])),d=b(".datasheet-layout-container mi-date-time"),d.on("keypress keydown",I.bind(null,a)),c=d.css("background-color"),c&&(d.find(".date").css("background-color",c),d.find(".form-control").css("background-color",c)),f.resolve()}).fail(function(){f.reject()}),f}function H(a,b,c){
return a.layout.rows()[b].siteKey()!==c&&(a.layout.rows()[b].preventSiteChangeUpdate=!0,!0)}function I(a,b){a&&a.device&&a.device.isMobile()&&b.preventDefault()}function J(a){var b=a.region.$element.find(".table.table-cust1").width();if(a.region.$element.find(".bulk-datasheet-disabled-overlay").width(b),a.layout.isNewAvailable()){var c=a.region.$element.find(".table-responsive").height();a.region.$element.find(".bulk-datasheet-disabled-overlay").height(c-71)}}function K(a,c,d,e){return b.inArray(c,a.config.functionsavailable)>=0&&(d||e)}function L(a){a.config.functionsavailable&&(a.layout.isSaveAvailable(K(a,"save",a.isSuperUser,a.canUpdate)),a.layout.isDeleteAvailable(K(a,"delete",a.isSuperUser,a.canDelete)),a.layout.isNewAvailable(K(a,"new",a.isSuperUser,a.canInsert)),a.layout.isLinkAvailable(K(a,"link",a.isSuperUser,a.canInsert)),a.layout.isUnlinkAvailable(K(a,"unlink",a.isSuperUser,a.canDelete)),
a.layout.isPasteEnabled(K(a,"copy",a.isSuperUser,a.canInsert)&&K(a,"copy",a.isSuperUser,a.canUpdate)),b.inArray("references",a.config.functionsavailable)<0&&a.layout.isRefDocAvailable(!1),b.inArray("history",a.config.functionsavailable)<0&&a.layout.isHistoryAvailable(!1),b.inArray("copy",a.config.functionsavailable)<0&&a.layout.isCopyAvailable(!1),b.inArray("references",a.config.functionsavailable)>0&&a.entity&&a.entity[0]&&"MI Reference Document"===a.entity[0].familyID&&a.layout.isRefDocAvailable(!1))}function M(a){a.layout.isNewAvailable()||1!==a.entity.length||0===a.layout.rows()[0].entitykey()&&a.layout.rows.pop()}function N(b,c){for(var d=c.fields.models.length,e=[],f,g,h=0;h<d;h++)f=c.fields.models[h].get("key"),g=a.find(b.fieldMetadata,O.bind(null,f)),e.push({fieldKey:f,fieldId:c.fields.models[h].get("id"),fieldValue:c.fields.models[h].get("value"),fieldDisplayValue:c.fields.models[h].get("displayValue"),options:{required:c.fields.models[h].get("isRequired"),
disabled:c.fields.models[h].get("isDisabled"),unitOfMeasure:c.fields.models[h].get("unitOfMeasure"),unitOfMeasureKey:c.fields.models[h].get("unitOfMeasureKey"),picklist:c.fields.models[h].get("pickList"),backColor:c.fields.models[h].get("backColor"),jsModuleName:c.fields.models[h].get("jsModuleName"),jsModuleParams:c.fields.models[h].get("jsModuleParams"),popJSModuleOnFocus:c.fields.models[h].get("popJSModuleOnFocus"),addParseValueParam:c.fields.models[h].get("addParseValueParam"),dependentFields:c.fields.models[h].get("dependentFields"),isPicklistRestricted:c.fields.models[h].get("isPicklistRestricted"),maxNumberOfValues:c.fields.models[h].get("maxNumberOfValues"),values:c.fields.models[h].get("values"),format:c.fields.models[h].get("format"),dbLength:c.fields.models[h].get("dbLength"),behaviors:g?g.behaviors:null}});return e}function O(a,b){return b.key===a}z.prototype.attachEntityEventListeners=function a(b){var c=this;b.entityModified.add(c.onEntityChanged,c),
b.entityIdChanged.add(c.onEntityIdChanged,c)},z.prototype.attachLayoutEventListeners=function a(){var b=this;b.layout.datasheetSaved.add(U.bind(null,b)),b.layout.datasheetDelete.add(la.bind(null,b)),b.layout.datasheetNew.add(ka.bind(null,b)),b.layout.datasheetHistory.add(na.bind(null,b)),b.layout.datasheetRefDoc.add(oa.bind(null,b)),b.layout.unlinkEntities.add(pa.bind(null,b)),b.layout.entitySelected.add(qa.bind(null,b)),b.layout.onSiteChange.add(P.bind(null,b)),b.layout.PreventSiteChangeUpdate.add(H.bind(null,b)),b.layout.ValidateBeforeEveryThing.add(S.bind(null,b)),b.layout.pageChangeEvent.add(Q.bind(null,b)),b.layout.datasheetChanged.add(ha.bind(null,b))};function P(b,c,d){var e,f=a.find(b.entity,function(a){return a.key===c}),g=a.find(b.layout.rows(),function(a){return a.entitykey()===c});if(g&&g.preventSiteChangeUpdate)return void(g.preventSiteChangeUpdate=!1);f&&(e=null===d?"0":d,f.siteKey!==e&&(f.siteKey=e,b.entityFactory.updateEntitySite(f)))}function Q(a,c){var d
;for(d=0;a.entity&&d<a.entity.length;d++)a.detachEntityEventHandlers(a.entity[d]);a.containerEl.find("div.table-responsive").remove(),a.config.hasspinner&&a.indicator.show(),c=parseInt(c),a.endIndex=c*a.layout.pageSize,a.startIndex=(c-1)*a.layout.pageSize;var e=a.layout.isMasterDatasheet(),f=a.layout.isHistoryDisabled(),g=a.layout.isSiteFiltered(),h=a.layout.isRefDocDisabled,i=b.Deferred(),j,k,l=a.layout.frozenRows();a.frozenRowKeys=[];for(var m=0;m<l.length;m++)a.frozenRowKeys.push(l[m].entitykey().toString());return j=a.getEntityPromise(),j.done(function(b){if(a.clearSpinner(),b){a.entity=b,a.familyKey||(a.familyKey=a.entity[0].familyKey);for(var c=0;c<b.length;c++)a.attachEntityEventListeners(b[c]);a.layout&&(a.layout.detach(a.region),a.layout.deallocateMem(),a.layout=null),k=a.renderDatasheet(b),a.layout.isHistoryDisabled(f),a.layout.isSiteFiltered(g),a.layout.isRefDocDisabled(h),k.done(function(){L(a),a.layout.afterLoad(),a.layout.isMasterDatasheet(e),i.resolve(a.entity),
a.clearSpinner(),a.pageChangeDone.raise(a.entity),a.frozenRowKeys.length&&a.layout.freezeRowsByKeys(a.frozenRowKeys)}).fail(function(){a.throwException(a.translate("DS_RENDER_DATASHEET_FAIL_EXCEPTION")),i.reject()})}}).fail(function(b,c){c&&403===c.status?n.showOk(c.statusText):a.throwException(a.translate("DS_LOAD_ENTITY_FAIL_EXCEPTION")),i.reject(),a.clearSpinner()}),i}z.prototype.detachEntityEventHandlers=function a(b){var c=this;b&&(b.entityModified&&b.entityModified.remove(c),b.entityIdChanged&&b.entityIdChanged.remove(c))},z.prototype.throwException=function a(b){var c=new s(1,b,"platform/datasheets/bulk-datasheet-manager.js");this.appEvents.errorOccured.raise(this,c)},z.prototype.confirm=function a(b){return this.window.confirm(b)},z.prototype.getSelectedEntities=function a(){var b=this;if(b.layout)return b.layout.getSelectedEntities()},z.prototype.updateRow=function a(b,c,d){var e=this;if(e.layout)return e.layout.updateRow(b,c,d)},z.prototype.handleOverlay=function a(){
var b=this;b.layout&&b.layout.handleOverlay()};function R(b,c,d,e,f,g,h){var i=!0,j;j=a.find(b.entity,function(a){return void 0===g||0!==a.key?a.key===c:a.clientid===g}),h?b.entityFactory.updateFieldByKey(j,d,e,h):b.entityFactory.updateFieldValue(j,d,e,f,i)}z.prototype.onEntityChanged=function a(c,d,e,f,g,h,i){var j,k,l=this,m;m=e?d.dependentFields:null,i!==!0&&i!==!1||(c.updatedFromModule=i);var n=f?d.value:d.displayValue;if(l.layout&&(l.layout.updateFieldValue(c,d.key,d.value,d.values,n,d.pickList,d.isDisabled,d.isRequired,d.errorMessage,d.backColor,d.maxNumberOfValues,m,d.jsModuleName,d.jsModuleParams,d.popJSModuleOnFocus,d.addParseValueParam,d.format,!0,d.successMessage),l.getEntityStatus(c,l).done(function(a){l.layout.updateRow("status",c,a),l.layout.datasheetNew.raise()})),l.cachedEntity){
for(k=0;k<l.cachedEntity.length;k++)if((void 0===l.cachedEntity[k].clientid||0!==c.key)&&c.key.toString()===l.cachedEntity[k].key.toString()||l.cachedEntity[k].clientid&&l.cachedEntity[k].clientid===c.clientid){l.cachedEntity[k]=b.extend(!0,c,l.cachedEntity[k]);break}}else for(l.cachedEntity=l.entity,k=0;k<l.cachedEntity.length;k++)if(l.cachedEntity[k].clientid&&l.cachedEntity[k].clientid===c.clientid||(void 0===l.cachedEntity[k].clientid||0!==c.key)&&c.key.toString()===l.cachedEntity[k].key.toString()){l.cachedEntity[k]=c;break}h&&g&&g!==h.lockSeqNbr&&l.layout.uiHelper.lockEntityUpdateHelper(l),l.entityModified.raise(d,e,c)},z.prototype.onEntityIdChanged=function a(b){this.entityIdChanged.raise(b)},z.prototype.getEntityStatus=function a(c,d){var e=b.Deferred();return d.entityFactory.checkIfEntityDirty(c).done(function(){d.entityFactory.checkIfEntityNew(c)?e.resolve("new-clean",c):e.resolve("clean",c)}).fail(function(){
d.entityFactory.checkIfEntityNew(c)?e.resolve("new-dirty",c):e.resolve("dirty",c)}),e},z.prototype.onDatasheetSaved=function a(){return U(this,this.entity)};function S(a,b){a.ValidateBeforeEveryThing.raise(a,b)}function T(a,b,c){var d=[],e=0,f=0,g=!1,h;for(c=c||[],d=b.filter(function(a){return c.indexOf(a)===-1}),e=0;e<c.length;e++)if(""!==c[e].errorMessage){g=!0,h=c[e].errorMessage;break}if(g)n.show(h,a.translate("DS_ERROR"));else for(a.entityDeleted.raise(d),e=0;e<d.length;e++){a.layout.updateRow("delete",d[e]),function(){for(f=0;f<a.entity.length;f++)if(a.entity[f].key===d[e])return}();var i=f;a.entity.splice(i,1)}}function U(a,c){var d=b.Deferred();return a.getEntitiesToBeSaved(c).done(V.bind(null,a,d)),d}function V(a,b,c,d){0===c.length?(a.clearSpinner(),b.resolve()):W(a,c,d,b)}function W(a,b,c,d){if(a.layout.setErrorAndReturnErrorFlag(a,b))return d.reject(),void a.clearSpinner();b.length&&b[0].isAuditable?ea(a,X,b,c,d):X(a,b,c,d)}function X(b,c,d,e,f){
var g=[],h=0,i=0,j=!1,k=!1,l=$(c);c=Z(c),b.showSpinner(),b.entityFactory.save(c).done(function(b,c,f){if(b.clearSpinner(),!(c&&f&&_(b,c,f))){for(b.layout.isHistoryDisabled(!b.getHistoryStatus(f)),b.layout.isSiteFiltered(b.getSiteFilteredStatus(f)),f.length,h=0;h<f.length;h++)if(""===f[h].errorMessage)for(k=!0,0===f[h].key||a.includes(b.entityObj,f[h].key.toString())||(b.entityObj?(b.entityObj.unshift(f[h].key.toString()),b.layout.updatePageCount(b.entityObj.length)):b.layout.updatePageCount(b.totalRows)),b.layout.updateRow("save",f[h],d[h]),aa(b,f[h],d[h]),b.getEntityStatus(b.entity[d[h]],b).done(function(a,c,d){b.layout.updateRow("status",a,c)}.bind(null,f[h])),
i=0;i!==f[h].fields.models.length;i++)b.layout.updateFieldValue(f[h],f[h].fields.models[i].get("key").toString(),f[h].fields.models[i].get("value"),f[h].fields.models[i].get("values"),f[h].fields.models[i].get("displayValue"),f[h].fields.models[i].get("pickList"),f[h].fields.models[i].get("isDisabled"),f[h].fields.models[i].get("isRequired"),f[h].fields.models[i].get("errorMessage"),f[h].fields.models[i].get("backColor"),f[h].fields.models[i].get("maxNumberOfValues"),f[h].fields.models[i].get("dependentFields"),f[h].fields.models[i].get("jsModuleName"),f[h].fields.models[i].get("jsModuleParams"),f[h].fields.models[i].get("popJSModuleOnFocus"),f[h].fields.models[i].get("addParseValueParam"),!1);else j=!0;k&&(Y(b),b.entitySaved.raise(f),e.resolve()),j&&(b.displayError(b),k||e.reject())}}.bind(null,b,l)).fail(function(a){b.clearSpinner(),a.statusCode&&409===a.statusCode().status&&b.layout.uiHelper.lockEntityUpdateHelper(b),e.reject()}),ga(b,f)}function Y(b){
a.each(b.layout.rows(),function(a,b,c){0===a.layout.rows()[c].entitykey()||a.isSuperUser||a.layout.rows()[c].isSelectedSiteViewOnly(!0)}.bind(null,b))}function Z(b){return a.each(b,function(a,b,c){null===b.siteKey&&(a[c].siteKey="0")}.bind(null,b)),b}function $(b){return a.map(b,function(a){return{entitykey:a.key,lockSeqNbr:a.lockSeqNbr}})}function _(a,b,c){for(var d=!1,e=0;e<b.length;e++)for(var f=0;f<c.length;f++)if(c[f].errorMessage===a.translator.translate("DS_BULK_ENTITY_CONCURRENT_WARNING_MESSSAGE")){a.layout.uiHelper.lockEntityUpdateHelper(a,"bulk"),d=!0;break}return d}function aa(a,b,c){var d=a.layout.rows()[c].refDocPathModel();d&&(d.isStored()?a.entityFactory.uploadRefDoc(d.formData,b.key).done(ba.bind(null,a,b.key,c)).fail(function(){a.throwException(a.translate("REFDOCS_FAILED_TO_UPLOAD_REF_DOC"))}):d.isUnc()&&a.entityFactory.hasRefDocServerCredentials().done(ca.bind(null,a)).fail(da.bind(null,a)),
d.isStored()||a.layout.selectedEntities()[0]!==b.key||a.layout.canDownloadRefDoc(!1))}function ba(a,b,c){a.layout.rows()[c].refDocPathModel(null),a.layout.selectedEntities()[0]===b&&a.layout.canDownloadRefDoc(!0)}function ca(a,b){var c=new m({closeButton:!0,timeOut:"200",hideDuration:"200"});b===!1&&c.warning(a.translate("REFDOCSERVER_NO_CREDENTIALS"),a.translate("REFDOCSERVER"))}function da(a){new m({closeButton:!0,timeOut:"200",hideDuration:"200"}).error(a.translate("REFDOCSERVER_FAILED_CREDENTIALS"),a.translate("REFDOCSERVER"))}function ea(a,b,c,d,e){var f,g;f=Object.resolve(w),g=new j(f,a.translate("DS_AUTH_DIALOG_TITLE"),{height:300,width:400}),g.show(),f.saveAllowed.add(b.bind(null,a,c,d,e,g)),f.saveDenied.add(fa.bind(null,a,g,e)),f.saveCancelled.add(ga.bind(null,a,g))}function fa(a,b,c){ga(a,b),n.showOk(a.translate("DS_AUTH_FAILURE_MSG"),a.translate("DS_AUTH_FAILURE_DIALOG_TITLE")),c.reject()}function ga(a,b){b&&b.closeDialog()}function ha(a){var b=[];a.showSpinner()
;for(var c=0;c<a.entity.length;c++)(0!==a.entity[c].key||a.layout.isNewAvailable())&&b.push({entitykey:a.entity[c].key,clientid:a.entity[c].clientid,fields:N(a,a.entity[c]),isAuditable:a.entity[c].isAuditable,isDirty:a.entity[c].isDirty,siteKey:a.entity[c].siteKey});b=ia(a,b),a.layout.executeDatasheetChanged(b).always(a.clearSpinner.bind(a))}function ia(b,c){return b.region.$element.find("mi-site-selector").length&&a.each(c,function(c,d,e){a.each(b.layout.rows(),function(a,b,c){d.entitykey.toString()===b.entitykey().toString()&&e===c&&(a[e].siteKey=b.siteKey())}.bind(null,c))}.bind(null,c)),c}z.prototype.getHistoryStatus=function a(b){for(var c=0;c<b.length;c++)if(0!==b[c].key)return b[0].isHistoryEnabled;return!1},z.prototype.getSiteFilteredStatus=function a(b){for(var c=0;c<b.length;c++)return b[0].isSiteFiltered;return!1},z.prototype.getRefDocStatus=function a(b){var c,d,e;for(d=0;d<b.length;d++){c=b[0].familyID,e=b[0].key;break}return this.entityFactory.canRefDoc(c,e)},
z.prototype.getEntitiesToBeSaved=function a(c){var d=this,e,f=[],g=[],h=0,i=b.Deferred();for(c=c||d.entity,e=0;e<c.length;e++)d.entity[e].clientid=c[e].clientid,h++,d.getEntityStatus(d.entity[e],d).done(function(a,b,c){h--,"new-clean"!==b&&"clean"!==b&&(d.layout.isSiteFiltered()&&d.layout.isDatasheetRendered()&&(d.layout.showSiteSelector()?c.siteKey=d.layout.rows()[a].siteKey():0===c.key&&(c.siteKey=u.user.defaultSiteKey)),0===c.key&&null!==d.masterSiteKey&&(c.siteKey=d.masterSiteKey),f.push(c),g.push(a)),h||i.resolve(f,g)}.bind(null,e));return i},z.prototype.hasNewCleanRow=function a(c){var d=this,e=0,f=!1,g=0,h=b.Deferred();for(c=c||d.entity,e=0;e<c.length;e++)d.entity[e].clientid=c[e].clientid,g++,d.getEntityStatus(d.entity[e],d).done(function(a,b,c){g--,"new-dirty"===b&&c.updatedFromModule===!0&&(f=!0),"new-clean"===b&&(f=!0),g||h.resolve(f)}.bind(d,e));return h},z.prototype.displayError=function a(b){var c,d,e=0,f=[]
;for(e=0;e<b.entity.length;e++)""!==b.entity[e].errorMessage&&f.push({id:b.entity[e].id,errorMessage:b.entity[e].errorMessage});c=new i(f),d=new j(c,this.translate("DS_ERROR_REPORT")),c.closeDialog.add(function(){d.closeDialog()}),d.show()};function ja(){return n.showUnsavedChanges()}function ka(a){if(a.newEntityFlag)return!1;a.newEntityFlag=!0,a.hasNewCleanRow().done(function(c){if(c||!a.canInsert||!a.layout.isNewAvailable())return void(a.newEntityFlag=!1);a.isCreatingNewRow=a.entityFactory.new(a.familyKey),a.isCreatingNewRow.done(function(c){var d,e;c.clientid=a.sequenceNumber++,null!==a.masterSiteKey&&(c.siteKey=a.masterSiteKey),a.entity.push(c),a.attachEntityEventListeners(c),a.layout.updateRow("new",{entitykey:c.key,isDirty:c.isDirty,fields:N(a,c),clientid:c.clientid,siteKey:c.siteKey}),a.entityCreated.raise(c),a.isCreatingNewRow=!1,a.newEntityFlag=!1,e=b(".datasheet-layout-container mi-date-time"),e.on("keypress keydown",function(a){console.log("bulk manager"),a.preventDefault()
}),(d=e.css("background-color"))&&(e.find(".date").css("background-color",d),e.find(".form-control").css("background-color",d))})})}function la(a,b){var c=[];n.showYesNo(a.translate("DS_DELETE_SELECTED_ENTITIES_MESSAGE"),a.translate("CONFIRM_REC_DEL")).done(function(d){if(0===d){for(var e=0;e<a.entity.length;e++)for(var f=0;f<b.length;f++)a.entity[e].key==b[f]&&c.push(a.entity[e].key);a.entityFactory.delete(c)}})}function ma(a){var c={};return b.each(a,function(a,b){c[a.toLowerCase()]=b}),c}function na(b,c){var e,f,g;g=a.find(b.entity,function(a){return a.key.toString()===c.toString()}),e=Object.resolve(k),f=new d,e.attach(f,g),e.loadHistory();var h=new j(e,b.translate("DS_FIELD_HISTORY_TITLE"),{height:"90%",width:"80%"});e.setDialog(h),h.show()}function oa(a,b){var c=Object.resolve(l,b[0]),d=new j(c,a.translate("DS_REFERENCE_DOCS_TITLE"),{height:"90%",width:"80%"});c.setDialog(d),d.show()}function pa(a){a.unlinkEntities.raise()}function qa(a,b){a.entitySelected.raise(b)}
function ra(a,b){var c=[],d={};if(a.catalogQuery="(!"+a.catalogItemPath+")",b.queryContainer.parmContainer){var e=b.queryContainer.parmContainer.parmDesigns;if(void 0!==e)for(var f=0;f<e.length;f++)c.push(e[f].parmPrompts[0])}return d.Query=a.catalogQuery,d.startRow=a.startIndex,d.maxRows=a.maxRows,d.parameters=c,d}return z});

define('text!platform/datasheets/layout/ui/views/master-detail-datasheet.html',[],function () { return '<div class="master-detail-datasheet-layout-container" data-bind="visible: isDatasheetRendered">\r\n    <div data-bind="" class="datasheet-nav">\r\n        <div class="datasheet-toolbar" data-bind="visible: !isRefDocsDisplayed()">\r\n            <div class="datasheet-selector-container block b8">\r\n\r\n                <div class="datasheet-selector-label-container block" data-bind="visible: showDatasheetSelection">\r\n                    <div class="datasheet-lbl">\r\n                        <span data-bind="text: $root.translate(\'DS_DATASHEET_ID_LABEL\')"></span>:\r\n                    </div>                    \r\n                </div>\r\n                <div class="datasheet-selector-select-container block" data-bind="visible: showDatasheetSelection">                    \r\n                    <mi-select class="datasheet-selector" data-bind="miproperty:{\r\n                        value: currentDatasheetKey,\r\n                        options: datasheetKeys,\r\n                        optionsValue: \'key\',\r\n                        optionsText: \'caption\'\r\n                           }"></mi-select>\r\n                </div>\r\n            </div>\r\n            <div class="datasheet-controls-container block b4 pull-right">\r\n                <div class="pull-right datasheet-btn-group master-ds-iconbar" data-bind="visible: !showEditButton()">\r\n                    <!--<button class="btn btn-icon" data-bind="visible: isRootRecordAvailable(), click: makeRootRecord, attr: {title: $root.translate(\'RM_MAKE_ROOT_RECORD_TOOLTIP\')}"><i class="icon-open-in-new-window"></i></button>-->\r\n                    <mi-associated-pages-btn familykey entitykey disabled data-bind="attr: { familykey: assocFamilykey(), entitykey: currentEntyKey(), disabled: assocDisabled() }" hideifnorecords="true"></mi-associated-pages-btn>\r\n                    <button class="btn btn-icon" data-bind="visible: isDatasheetRendered() && isSaveAvailable(), click: saveDatasheet, attr: {title: translate(\'DS_SAVE_TOOLTIP\')}"><i class="icon-save"></i></button>\r\n                </div>\r\n                <div class="pull-right datasheet-btn-group" data-bind="visible: showEditButton()">\r\n                    <!-- ko if: canEdit -->\r\n                    <button class="btn btn-icon pull-right" data-bind="click : toggleEdit, attr: {title: translate(\'DS_EDIT_TOOLTIP\')}"><i class="icon-edit"></i> </button>\r\n                    <!-- /ko -->\r\n                </div>\r\n                <!-- ko if: $root.datasheetNavWidth() > 768 -->\r\n                <!--<div class="pull-right datasheet-btn-group print-btn-group">\r\n                    <button class="btn btn-icon" data-bind="click : print, attr: {title: translate(\'PRINT\')}"><i class="icon-printer"></i></button>\r\n                </div>-->\r\n                <!-- /ko -->\r\n                <!-- ko if: isDatasheetRendered() && isSiteFiltered() && $root.showSiteSelector-->\r\n                <div class="pull-right datasheet-btn-group site-filter-component">\r\n                    <mi-site-selector data-bind="value: siteKey,attr: { readonly: isSelectedSiteViewOnly }, event:{\'change\': handleSiteChange}"></mi-site-selector>\r\n                </div>\r\n                <!-- /ko -->\r\n                <!-- ko if: isDatasheetRendered() && showStateManagement() -->\r\n                <div class="pull-right datasheet-btn-group">\r\n                    <mi-state-transition hidereservedops data-bind="attr: { entitykey: currentEntyKey, disable: isStateTransitionDisabled },\r\n                                    event: {\r\n                                        beforeStateChanged: onBeforeStateChanged,\r\n                                        stateChanged: onAfterStateChanged\r\n                                    }"></mi-state-transition>\r\n                </div>\r\n                <!-- /ko -->\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n    <div class="mdf-tab-header">\r\n        <mi-tab-group tabs="2">\r\n            <mi-tab value="master" number="" selected="true" data-bind="attr:{text: translate(\'DS_MASTER_CAPTION\')}, event:{click: $root.masterTabClick}"></mi-tab>\r\n            <mi-tab value="detail" number="" data-bind="attr: {text: translate(\'DS_DETAIL_CAPTION\')}, event:{click: $root.detailTabClick}"></mi-tab>\r\n\r\n        </mi-tab-group>\r\n\r\n    </div>\r\n\r\n    <div class="master-datasheet-tab-content" data-bind="css:{\'master-datasheet-readonly-container\': isDatasheetReadOnly}">\r\n        <div class="master-tab-pane" data-bind="visible:showMasterTab">\r\n            <div class="master-tab-header" data-bind="visible:showMasterTabForPrint">\r\n                <ul class="nav nav-tabs">\r\n                    <li class="active">\r\n                        <a data-toggle="tab" data-bind="text: translate(\'DS_MASTER_CAPTION\')"></a>\r\n                    </li>\r\n\r\n                    <li>\r\n                        <a data-toggle="tab" data-bind="text: translate(\'DS_DETAIL_CAPTION\')"></a>\r\n                    </li>\r\n                </ul>\r\n\r\n            </div>\r\n            <div class="master-datasheet-container" data-bind="text: translate(\'DS_MASTER_DATASHEET_CAPTION\')">\r\n\r\n            </div>\r\n        </div>\r\n\r\n        <div class="detail-tab-pane" data-bind="visible: !isRefDocsDisplayed() && !showMasterTab()">\r\n            <div class="detail-tab-header" data-bind="visible:showMasterTabForPrint">\r\n                <ul class="nav nav-tabs">\r\n                    <li>\r\n                        <a data-toggle="tab" data-bind="text: translate(\'DS_MASTER_CAPTION\')"></a>\r\n                    </li>\r\n\r\n                    <li class="active">\r\n                        <a data-toggle="tab" data-bind="text: translate(\'DS_DETAIL_CAPTION\')"></a>\r\n                    </li>\r\n                </ul>\r\n            </div>\r\n            <div class="detail-datasheet-container" data-bind="text: translate(\'DS_DETAIL_DATASHEET_CAPTION\')"></div>\r\n            <div class="empty-detail-datasheet" data-bind="text: translate(\'NO_RECORD_MSG\')"></div>\r\n        </div>\r\n\r\n        <!--<div class="master-detail-datasheet-disabled-overlay" data-bind="visible: isDatasheetReadOnly, style: { top: overlayTop}">-->\r\n\r\n    </div>\r\n\r\n</div>\r\n</div>\r\n<div class="load-spinner" data-bind="visible: !isDatasheetRendered()">\r\n    <span class="loading-med loading-active center-block"></span>\r\n</div>';});

define('platform/datasheets/layout/ui/master-detail-view-model',['require','lodash','jquery','knockout','spa/ko/knockout-view-model','../services/datasheet-service','../adapters/datasheet-adapter','system/lang/event','application/export-service','text!./views/master-detail-datasheet.html','system/error/error-message','application/application-events','system/globalization/translator','platform/datasheets/layout/ui/utils','platform/metadata/services/metadata','./helpers/print-helper','./helpers/ui-helper','ui/elements/state-transition/component','ui/elements/site-selector/site-selector-element','ui/elements/associated-pages-btn/associated-pages'],function(require){"use strict";var a=require("lodash"),b=require("jquery"),c=require("knockout"),d=require("spa/ko/knockout-view-model"),e=require("../services/datasheet-service"),f=require("../adapters/datasheet-adapter"),g=require("system/lang/event"),h=require("application/export-service"),i=require("text!./views/master-detail-datasheet.html"),j=require("system/error/error-message"),k=require("application/application-events"),l=require("system/globalization/translator"),m=require("platform/datasheets/layout/ui/utils"),n=require("platform/metadata/services/metadata"),o=require("./helpers/print-helper"),p=require("./helpers/ui-helper");require("ui/elements/state-transition/component"),require("ui/elements/site-selector/site-selector-element"),require("ui/elements/associated-pages-btn/associated-pages");function q(a){r.call(this,i),this.region=null,this.translator=Object.resolve(l),this.util=Object.resolve(m),this.datasheetKeys=c.observableArray(),
this.currentDatasheetKey=c.observable(),this.appEvents=Object.resolve(k),this.previousDatasheetKey=c.observable(),this.currentDatasheet=c.observable(),this.isDatasheetRendered=c.observable(!1),this.detailFamilyCaption=c.observable(),this.showEditButton=c.observable(!1),this.canEdit=c.observable(!1),this.overlayTop=c.observable("93px"),this.exportService=Object.resolve(h),this.datasheetService=a,this.masterDetailShellRendered=new g,this.onFormsDatasheet=new g,this.onMasterDetail=new g,this.onNewMasterDetail=new g,this.isSaveAvailable=c.observable(!0),this.isNewAvailable=c.observable(!0),this.isDeleteAvailable=c.observable(!0),this.isCopyAvailable=c.observable(!0),this.isHistoryAvailable=c.observable(!0),this.isHistoryEnabled=c.observable(!0),this.isReferencesAvailable=c.observable(!0),this.isRefDocEnabled=c.observable(!1),this.refDocCount=c.observable(""),this.showDatasheetSelection=c.observable(!0),this.isDatasheetReadOnly=c.observable(!1),this.canPaste=c.observable(!0),
this.isMasterDatasheet=c.observable(!1),this.showStateManagement=c.observable(!0),this.entityState=c.observable(),this.isDatasheetReadOnly.subscribe(z.bind(null,this)),this.helpTextModeOn=c.observable(!1),this.helpButtonText=c.observable(this.translate("DS_TURN_ON_HELPTEXT")),this.isDatasheetRenderedInRM=c.observable(!1),this.isRefDocsDisplayed=c.observable(!1),this.isRootRecordAvailable=c.observable(!0),this.isUnlinkRecordAvailable=c.observable(!0),this.isUnlinkRecordEnabled=c.observable(!0),this.isPasteEnabled=c.observable(!0),this.hideMoreOptionsForIcons=c.observable(!1),this.isDefaultHelpTextAvailable=c.observable(!0),this.siteKey=c.observable(),this.isSiteFiltered=c.observable(!1),this.assetContextKey=c.observable(),this.assetContextKey.subscribe(y.bind(this,this)),this.isSelectedSiteViewOnly=c.observable(!1),this.showSiteSelector=c.observable(!0),this.assocFamilykey=c.observable(),this.assocDisabled=c.observable(!0),this.masterDetailSaved=new g,this.masterDetailNew=new g,
this.masterDetailDelete=new g,this.masterDatasheetHistory=new g,this.masterDatasheetCopy=new g,this.masterDatasheetPaste=new g,this.beforeStateTransition=new g,this.onStateTransition=new g,this.datasheetReadOnlyChange=new g,this.toggleHelpTextButtonClicked=new g,this.makeRootRecordEvent=new g,this.unlinkRecordEvent=new g,this.masterDatasheetRefDocs=new g,this.datasheetChanged=new g,this.detailTabClicked=new g,this.onSiteChange=new g,this.toggleEditBtnClicked=new g,this.showMasterTab=c.observable(!0),this.showMasterTabForPrint=c.observable(!1),this.familyKey=null,this.printHelper=Object.resolve(o),this.uiHelper=Object.resolve(p),this.currentEntyKey=c.observable(),this.isStateTransitionDisabled=c.observable(!1),this.collapsibleChangeEventHandler=null,this.scrollEl=null,this.datasheetNavWidth=c.observable(0),this.appEvents.windowResized.add(this.handleNavAppearance,this)}var r=Object.inherit(d,q);q.dependsOn=[e],q.prototype.activate=function a(){},q.prototype.attach=function c(d,e){
if(r.prototype.attach.call(this,d),this.region=d,this.masterDetailShellRendered.raise(),this.currentDatasheetKey.subscribe(w.bind(null,this)),e){var f=this.scrollEl=b(e);f.on("scroll.mdf",a.debounce(this.uiHelper.handleStickyHeader.bind(null,this,d,f),100)),this.collapsibleChangeEventHandler=a.defer.bind(a,this.uiHelper.handleStickyHeader.bind(null,this,d,f))}else this.collapsibleChangeEventHandler=a.defer.bind(a,this.uiHelper.handleNavAppearance.bind(null,this,d));b("mi-collapsible").on("change.mdf",this.collapsibleChangeEventHandler)},q.prototype.detach=function a(b){r.prototype.detach.call(this,b)},q.prototype.handleNavAppearance=function a(){var b=this;b.uiHelper.handleNavAppearance(b),b.region&&b.scrollEl&&(b.uiHelper.handleStickyHeader(b,b.region,b.scrollEl),b.uiHelper.handleHeaderHeight(b,b.region))},q.prototype.masterTabClick=function a(){this.showMasterTab(!0)},q.prototype.detailTabClick=function a(){this.showMasterTab(!1),this.detailTabClicked.raise()},
q.prototype.onLayoutChanged=function a(){var b=this;b.uiHelper.handleHeaderHeight(b,b.region),b.uiHelper.handleNavAppearance(b)},q.prototype.deallocateMem=function a(){this.region=null,this.translator=null,this.datasheetKeys=null,this.currentDatasheetKey=null,this.previousDatasheetKey=null,this.currentDatasheet=null,this.isDatasheetRendered=null,this.detailFamilyCaption=null,this.showEditButton=null,this.canEdit=null,this.overlayTop=null,this.exportService=null,this.datasheetService=null,this.masterDetailShellRendered=null,this.onFormsDatasheet=null,this.onMasterDetail=null,this.onNewMasterDetail=null,this.isSaveAvailable=null,this.isNewAvailable=null,this.isDeleteAvailable=null,this.isCopyAvailable=null,this.isHistoryAvailable=null,this.isHistoryEnabled=null,this.isReferencesAvailable=null,this.isRefDocEnabled=null,this.refDocCount=null,this.showDatasheetSelection=null,this.isDatasheetReadOnly=null,this.canPaste=null,this.isMasterDatasheet=null,this.showStateManagement=null,
this.entityState=null,this.helpTextModeOn=null,this.helpButtonText=null,this.isDatasheetRenderedInRM=null,this.isRefDocsDisplayed=null,this.isRootRecordAvailable=null,this.isUnlinkRecordAvailable=null,this.hideMoreOptionsForIcons=null,this.isDefaultHelpTextAvailable=null,this.siteKey=null,this.isSiteFiltered=null,this.assetContextKey=null,this.assocFamilykey=null,this.assocDisabled=null,this.masterDetailSaved=null,this.masterDetailNew=null,this.masterDetailDelete=null,this.masterDatasheetHistory=null,this.masterDatasheetCopy=null,this.masterDatasheetPaste=null,this.beforeStateTransition=null,this.onStateTransition=null,this.datasheetReadOnlyChange=null,this.toggleHelpTextButtonClicked=null,this.makeRootRecordEvent=null,this.unlinkRecordEvent=null,this.masterDatasheetRefDocs=null,this.datasheetChanged=null,this.familyKey=null,this.printHelper=null,this.isStateTransitionDisabled=null,this.toggleEditBtnClicked=null,this.datasheetNavWidth=null,
this.appEvents&&this.appEvents.windowResized&&this.handleNavAppearance&&this.appEvents.windowResized.remove(this.handleNavAppearance,this)},q.prototype.toggleEdit=function a(){this.isDatasheetReadOnly(!this.isDatasheetReadOnly()),this.showEditButton(!1),this.isStateTransitionDisabled(!1),this.toggleEditBtnClicked.raise()},q.prototype.toggleHelpText=function a(){this.helpTextModeOn(!this.helpTextModeOn()),this.toggleHelpTextButtonClicked.raise(),this.helpTextModeOn()===!0?this.helpButtonText(this.translate("DS_TURN_OFF_HELPTEXT")):this.helpButtonText(this.translate("DS_TURN_ON_HELPTEXT"))},q.prototype.translate=function a(b){return this.translator.translate(b)},q.prototype.saveDatasheet=function a(){this.masterDetailSaved.raise()},q.prototype.newDatasheet=function a(){this.masterDetailNew.raise()},q.prototype.deleteDatasheet=function a(){this.masterDetailDelete.raise()},q.prototype.setDetailFamilyCaption=function a(b){this.detailFamilyCaption(b)},q.prototype.showHistory=function a(){
this.masterDatasheetHistory.raise()},q.prototype.copyDatasheet=function a(){this.masterDatasheetCopy.raise()},q.prototype.pasteDatasheet=function a(){this.masterDatasheetPaste.raise()},q.prototype.showStateAssignment=function a(){this.beforeStateTransition.raise()},q.prototype.showStateTransition=function a(){this.onStateTransition.raise()},q.prototype.showRefDocs=function a(){this.masterDatasheetRefDocs.raise(),this.isRefDocsDisplayed(!0),this.showMasterTab()||(this.showMasterTab(!0),this.region.$element.find(".mdf-tab-header .tab-group-item.block.two-tab").first().addClass("active"),this.region.$element.find(".mdf-tab-header .tab-group-item.block.two-tab").last().removeClass("active"))},q.prototype.getRelationshipFamilyById=function a(b){var c=this;return n.getRelationshipFamilyById(b)},q.prototype.getBulkHtmlForPrinting=function c(d){
var e="<div style='padding:10px;'>",f=b("div.table-responsive > table.table > thead > tr > th"),g=d.region.$element.find("div.freezed-cols-container > table.table > thead > tr > th"),h=[],i=[],j="---",k="#fff";return d.region.$element.find("div.table-responsive > table.table > tbody > tr").each(function(a,c){h[a]=b(this).find("td")}),d.region.$element.find("div.freezed-cols-container > table.table > tbody > tr").each(function(a,c){i[a]=b(this).find("td")}),e=s(g,i,j,e),a.each(f,function(b,c){if(c>=0&&"status-col"!==b.className&&"row-selector"!==b.className){var d=0===c?"border-left: 1px solid #e6e6e6;":"";e=t(e,b,c,d),a.each(h,function(a,f){a.length>=0&&"status-col"!==b.className&&"row-selector"!==b.className&&(e=u(e,j,a,f,c,d))}),e+="</div>"}}),e+="</div>"};function s(c,d,e,f){return a.each(c,function(c,g){if(g>=2&&(b(c).hasClass("freezed-column")||b(c).hasClass("site-selector-caption"))){var h=2===g?"border-left: 1px solid #e6e6e6;":"";f=t(f,c,g,h),a.each(d,function(a,b){
a.length>=2&&"status-col"!==c.className&&"row-selector"!==c.className&&(f=u(f,e,a,b,g,h))}),f+="</div>"}}),f}function t(a,c,d,e){return a+="<div style='display:inline-block;vertical-align:top;margin-top:20px;border-top:1px solid #444;'><div style='padding:5px;border: 0;"+e+"border-bottom: 1px solid #e6e6e6;border-right: 1px solid #e6e6e6;'>"+b(c).text()+"</div>"}function u(a,c,d,e,f,g){var h;return b(d[f]).find(".site-filter-component").length>0?c=b(d[f]).find("mi-site-selector li.active").text():b(d[f]).find(".hyperlinkEllipsis").length>0?(c=b(d[f]).find(".hyperlinkEllipsis").html(),h=b(d[f]).find(".form-control").css("background-color")):b(d[f]).find(".form-control").length>0&&!b(d[f]).find("input:password")?(c=b(d[f]).find(".form-control").val(),h=b(d[f]).find(".form-control").css("background-color")):b(d[f]).find("mi-checkbox").length>0?(c=b(d[f]).find("mi-checkbox").html(),h=b(d[f]).find(".form-control").css("background-color")):c=b(d[f]).html(),
a+="<div style='padding:5px;height:70px;background-color:"+h+";border: 0;"+g+"border-bottom: 1px solid #e6e6e6;border-right: 1px solid #e6e6e6 !important;'>"+c+"</div>"}q.prototype.print=function a(){var b=this;n.retrieveFamilyReports(b.familyKey).done(v.bind(null,b))};function v(a,b){a.printHelper.print(a,"mdf",b)}function w(a){if(a.proceed===!1)return void(a.proceed=!0);a.datasheetChanged.raise(),a.uiHelper.handleNavAppearance(a)}q.prototype.executeDatasheetChanged=function c(){var d,e=b.Deferred(),f=this;return d=e.then(function(){return f.datasheetService.getDatasheet(f.currentDatasheetKey())}).then(function(b){if(x(f,b),f.currentDatasheet().isMasterDetail()){var c=a.find(f.datasheetKeys(),function(a){return b.customFormParameters["master Family Datasheet ID"]===a.id});f.onNewMasterDetail.raise(f.currentDatasheetKey(),b,c.key,f.datasheetKeys())}else f.onFormsDatasheet.raise(f.currentDatasheetKey(),b,f.datasheetKeys())}),e.resolve(),e};function x(a,b){var c=f.toModelObject(b)
;a.currentDatasheet(c)}function y(a,b){void 0!==b&&null!==b&&""!==b&&(a.siteSelector=a.region.$element.find("mi-site-selector")[0],a.siteSelector&&(Element.upgrade(a.siteSelector),a.siteSelector.selectSiteByAssetKey(b)))}function z(a){a.isDatasheetReadOnly()===!0&&(a.isSelectedSiteViewOnly(!0),a.isStateTransitionDisabled(!0)),a.datasheetReadOnlyChange.raise()}q.prototype.makeRootRecord=function a(){this.makeRootRecordEvent.raise()},q.prototype.unlinkRecord=function a(){this.unlinkRecordEvent.raise()},q.prototype.addMoreOptionsForIcons=function a(){var c=this;if(!c.hideMoreOptionsForIcons()){var d=c.region.$element.find(".master-ds-iconbar"),e=b("<mi-more-options-noko/>").attr("data-bind",'property: {icon: "icon-options"}');e.attr("class","datasheet-icons-more-options"),window.CustomElements&&!window.CustomElements.useNative&&window.CustomElements.upgrade(e.get(0)),c.iconsMoreOptions=e.get(0),c.iconsMoreOptions.loader=c.setIconOptions.bind(c),d.append(c.iconsMoreOptions),
c.iconsMoreOptions.moreoptionsCB(B.bind(null,c))}},q.prototype.setIconOptions=function a(){var c=b.Deferred();return A(this),c.resolve(this.iconOptions),c},q.prototype.setFamilyKey=function a(b){b&&(this.familyKey=b)},q.prototype.setErrorAndReturnErrorFlag=function a(b,c){var d=this,e=!1;return this.util.clearAllErrorNotifications(b),e=this.util.setErrorAndReturnErrorFlag("mdf",b,c)},q.prototype.handleSiteChange=function a(b,c){b.onSiteChange.raise(c.originalEvent.detail.value)},q.prototype.displaySmallTabs=function a(){var b=this,c;(c=b.region.$element.find("mi-tab-group")[0])&&(Element.upgrade(c),c.setAttribute("size","small"),c.updateTabSize())},q.prototype.onBeforeStateChanged=function(a,b){this.beforeStateTransition.raise(a,b)},q.prototype.onAfterStateChanged=function(a,b){this.onStateTransition.raise(a,b)},q.prototype.setCurrentEntyKey=function a(b){b&&this.currentEntyKey(b)};function A(a){var b=[];b.push({type:"text",text:a.translate("PRINT"),icon:"icon-printer"}),
a.isDefaultHelpTextAvailable()&&b.push({type:"text",text:a.helpButtonText(),icon:"icon-questionmark"}),b.push({type:"text",text:a.translate("DS_ADD"),icon:"icon-add-alt",noaccess:!a.isNewAvailable()}),a.isUnlinkRecordAvailable()&&b.push({type:"text",text:a.translate("RM_UNLINK_RECORD"),icon:"icon-unlink",noaccess:!a.isUnlinkRecordEnabled()}),b.push({type:"text",text:a.translate("DS_DELETE"),icon:"icon-bin",noaccess:!a.isDeleteAvailable()}),a.isReferencesAvailable()&&a.isRefDocEnabled()&&b.push({type:"text",text:a.refDocCount()+" "+a.translate("DS_REF_DOCS"),icon:"icon-doc"}),a.isHistoryAvailable()&&a.isHistoryEnabled()&&b.push({type:"text",text:a.translate("DS_HISTORY"),icon:"icon-history"}),a.isCopyAvailable()&&(b.push({type:"text",text:a.translate("DS_COPY"),icon:"icon-copy",noaccess:!a.isPasteEnabled()}),b.push({type:"text",text:a.translate("DS_PASTE"),icon:"icon-paste",disabled:a.canPaste(),noaccess:!a.isPasteEnabled()})),a.iconOptions=b}function B(a,b){
b.noaccess||(b.text===a.helpButtonText()?a.toggleHelpText():b.text===a.translate("DS_STATE_TRANSITION")?a.showStateTransition():b.text===a.translate("DS_STATE_ASSIGNMENT")?a.showStateAssignment():b.text===a.translate("DS_ADD")?a.newDatasheet():b.text===a.translate("RM_UNLINK_RECORD")?a.unlinkRecord():b.text===a.translate("DS_DELETE")?a.deleteDatasheet():b.text&&b.text.indexOf(a.translate("DS_REF_DOCS"))>=0?a.showRefDocs():b.text===a.translate("DS_HISTORY")?a.showHistory():b.text===a.translate("DS_COPY")?a.copyDatasheet():b.text===a.translate("DS_PASTE")?a.pasteDatasheet():b.text===a.translate("PRINT")&&a.print())}return q});
define('platform/datasheets/master-detail-datasheet-manager',['require','lodash','jquery','./layout/ui/master-detail-view-model','./forms-datasheet-manager','./bulk-datasheet-manager','./layout/ui/datasheet-history-view-model','system/ui/dialog-view-model','spa/region','../entity/entity-factory','system/lang/event','system/ui/message-box','system/ui/unsaved-changes-message-box','system/globalization/translator','./layout/services/manager-service','application/application-events','system/error/error-message','platform/datasheets/layout/ui/datasheet-authentication-dialog-view-model','system/ui/busy-indicator'],function(require){"use strict";var a=require("lodash"),b=require("jquery"),c=require("./layout/ui/master-detail-view-model"),d=require("./forms-datasheet-manager"),e=require("./bulk-datasheet-manager"),f=require("./layout/ui/datasheet-history-view-model"),g=require("system/ui/dialog-view-model"),h=require("spa/region"),i=require("../entity/entity-factory"),j=require("system/lang/event"),k=require("system/ui/message-box"),l=require("system/ui/unsaved-changes-message-box"),m=require("system/globalization/translator"),n=require("./layout/services/manager-service"),o=require("application/application-events"),p=require("system/error/error-message"),q=require("platform/datasheets/layout/ui/datasheet-authentication-dialog-view-model"),r=require("system/ui/busy-indicator");function s(a,b,c,d,e,f){this.defaultConfig={functionsavailable:["save","new","delete","references","history","copy"],readonly:!1,showdatasheetselection:!0,loadedfrommodule:!0,loadedfromrecordmanager:!1,
showdefaulthelptext:!0,displaysmalltabs:!1,showmastersiteselector:!0,disablemastersiteselector:!1,showdetailsiteselector:!1,disabledetailsiteselector:!0,detailfunctionsavailable:null},this.translator=Object.resolve(m),this.containerEl=a.containerel,this.scrollEl=a.scrollel,this.assetContextKey=a.assetcontextkey,this.datasheetkey=b,this.datasheetdto=c,this.entity=d,this.masterdatasheetkey=e,this.datasheetkeys=f,this.refDocs=null,this.savedSiteKey=null,this.appEvents=Object.resolve(o),this.indicator=Object.resolve(r),this.entityFactory=new i,this.window=window,this.onFormsDatasheet=new j,this.onMasterDetailDatasheet=new j,this.onNewMasterDetail=new j,this.onMasterDetailDatasheetSaved=new j,this.onMasterDetailDatasheetNew=new j,this.onBulkEntitiesDeleted=new j,this.onBulkEntitiesUnlinked=new j,this.onMasterDatasheetLoaded=new j,this.makeRootRecordEvent=new j,this.unlinkRecordEvent=new j,this.refDocsSet=new j,this.entityDeleted=new j,this.newDatasheet=new j,this.preventSiteChangeUpdate=!1,
this.isSuperUser=!1,this.siteSelector=null,this.entityModified=new j,this.canUpdateRefDocView=!1,this.entityIdChanged=new j,this.canDeleteRelationshipFamily=!0,this.canInsertRelationshipFamily=!0}s.prototype.getState=function a(){return this.detachEntityEventHandlers(),Fa(this)},s.prototype.getRefDocState=function a(){return this.masterDatasheet&&this.masterDatasheet.layout&&this.masterDatasheet.layout.refdocEl&&this.masterDatasheet.layout.isRefDocRendered()?this.masterDatasheet.layout.refdocEl.getState():null},s.prototype.updateRefDocState=function a(b){b&&(this.refDocs=b,this.canUpdateRefDocView=!0)},s.prototype.removeDOMElements=function a(){},s.prototype.load=function a(b){this.setConfig(b),this.renderDatasheet(),this.entityFactory.bulkUnlinkEvent.add(U.bind(null,this))},s.prototype.translate=function a(b){return this.translator.translate(b)},s.prototype.updateState=function a(b){b&&(this.cachedEntity=b)},s.prototype.getUserFamilyPrivileges=function a(){
return this.userFamilyPrivileges},s.prototype.renderDatasheet=function a(){var b=this;b.layout||(b.layout=Object.resolve(c)),0!==b.config.functionsavailable.length||b.config.showdefaulthelptext||b.layout.hideMoreOptionsForIcons(!0),b.attachLayoutHandlers(),b.layout.datasheetKeys(b.datasheetkeys),b.layout.currentDatasheetKey(b.datasheetkey),b.layout.previousDatasheetKey(b.datasheetkey),b.region=new h,b.region.setElement(b.containerEl),b.layout.attach(b.region,b.scrollEl),b.indicator.attachTo(b.containerEl[0]),b.config.displaysmalltabs&&b.layout.displaySmallTabs()},s.prototype.attachLayoutHandlers=function a(){this.layout.masterDetailShellRendered.add(E.bind(null,this)),this.layout.onFormsDatasheet.add(Q.bind(null,this)),this.layout.onMasterDetail.add(R.bind(null,this)),this.layout.onNewMasterDetail.add(S.bind(null,this)),this.layout.masterDetailSaved.add(V.bind(null,this)),this.layout.masterDetailNew.add(ea.bind(null,this)),this.layout.masterDetailDelete.add(ga.bind(null,this)),
this.layout.masterDatasheetHistory.add(ka.bind(null,this)),this.layout.masterDatasheetCopy.add(ha.bind(null,this)),this.layout.masterDatasheetPaste.add(ia.bind(null,this)),this.layout.beforeStateTransition.add(ma.bind(null,this)),this.layout.onStateTransition.add(na.bind(null,this)),this.layout.datasheetReadOnlyChange.add(oa.bind(null,this)),this.layout.toggleHelpTextButtonClicked.add(w.bind(null,this)),this.layout.makeRootRecordEvent.add(Ca.bind(null,this)),this.layout.unlinkRecordEvent.add(Da.bind(null,this)),this.layout.masterDatasheetRefDocs.add(la.bind(null,this)),this.layout.datasheetChanged.add(qa.bind(null,this)),this.layout.detailTabClicked.add(pa.bind(null,this)),this.layout.onSiteChange.add(this.handleSiteChange,this),this.layout.toggleEditBtnClicked.add(z.bind(null,this)),this.appEvents&&this.appEvents.layoutChanged&&this.appEvents.layoutChanged.add(u.bind(null,this))},s.prototype.handleSiteChange=function a(b){var c=this
;if(c.preventSiteChangeUpdate)return void(c.preventSiteChangeUpdate=!1);c.entity&&(c.entity.siteKey=b,c.masterDatasheet.layout.siteKey(b),c.masterDatasheet.entity.siteKey=b,c.entityFactory.updateEntitySite(c.entity))};function t(a,b){return a.layout.siteKey()!==b&&(a.preventSiteChangeUpdate=!0,!0)}function u(a){a&&a.layout&&a.layout.onLayoutChanged()}s.prototype.setConfig=function a(c){var d=this;d.config=c||{},d.config=Aa(d.config),b.extend(d.defaultConfig,d.config),d.config=d.defaultConfig},s.prototype.renderMasterDatasheet=function a(){var c=b(".master-datasheet-container"),e,f=this,g=b.Deferred();return f.cachedEntity.master&&(f.entity=f.cachedEntity.master),f.layout.isSiteFiltered(f.entity.isSiteFiltered),"0"===f.entity.siteKey&&t(f,f.entity.siteKey),f.layout.siteKey(f.entity.siteKey),f.savedSiteKey=f.entity.siteKey,e={containerel:c,entityobj:f.entity,currentDatasheetKey:f.masterdatasheetkey},0===f.entity.key||f.isSuperUser||f.layout.isSelectedSiteViewOnly(!0),
f.config.showmastersiteselector||f.layout.showSiteSelector(!1),f.isSuperUser&&f.config.disablemastersiteselector&&f.layout.isSelectedSiteViewOnly(!1),f.config.functionsavailable&&(b.inArray("history",f.config.functionsavailable)<0&&f.layout.isHistoryAvailable(!1),b.inArray("copy",f.config.functionsavailable)<0&&f.layout.isCopyAvailable(!1),b.inArray("references",f.config.functionsavailable)<0&&f.layout.isReferencesAvailable(!1),b.inArray("rootRecord",f.config.functionsavailable)<0&&f.layout.isRootRecordAvailable(!1),b.inArray("unlinkRecord",f.config.functionsavailable)<0&&f.layout.isUnlinkRecordAvailable(!1)),f.config.loadedfromrecordmanager&&f.layout.isDatasheetRenderedInRM(!0),f.config.showdefaulthelptext||f.layout.isDefaultHelpTextAvailable(!1),f.entity&&0!==f.entity.key&&(f.layout.assocDisabled(!1),f.layout.assocFamilykey(f.entity.familyKey)),f.entity.useUrlRedirection&&!f.config.loadedfrommodule?(f.layout.isDatasheetReadOnly(!0),f.layout.isCopyAvailable(!1),
f.layout.isSaveAvailable(!1),f.layout.isDeleteAvailable(!1),f.layout.isNewAvailable(!1),f.layout.showEditButton(!1),f.layout.canEdit(!1)):f.config.readonly?(f.layout.isDatasheetReadOnly(!0),f.layout.showEditButton(!0),f.layout.canEdit(f.config.canedit)):f.layout.isDatasheetReadOnly(!1),f.config.showdatasheetselection||f.layout.showDatasheetSelection(!1),this.masterDatasheet=new d(e),this.masterDatasheet.changeDatasheet(f.entity,f.config).done(x.bind(null,f,g)),f.layout.isHistoryEnabled(f.entity.isHistoryEnabled&&f.entity.key),g},s.prototype.renderDetailDatasheet=function a(){var c=b(".detail-datasheet-container"),d,f,g=this,h=[],i=["delete","new","link","unlink","history","references"],j=g.datasheetdto.customFormParameters,k=b.Deferred(),l,m,n,o=!1;return m=j["relationship Family ID"],n=j["detail Family ID"],l=g.entityFactory.getRelatedEntities(g.entity.key,m,n),l.then(function(a){var b,l,m=g.userFamilyPrivileges,o=m.isSuperUser;for(g.isSuperUser=m.isSuperUser,
b=0;b<m.privileges.length;b++)if(m.privileges[b].familyKey.toString()===g.entity.familyKey.toString()){l=m.privileges[b];break}if(h=a,d={containerel:c,entityobj:h,datasheetkey:j["detail Family Datasheet ID"],pagesize:25},h.length||(d.familykey=n),g.config.detailfunctionsavailable&&(i=g.config.detailfunctionsavailable),i=Ba(i,j),f={functionsavailable:i,showdatasheetselection:!1,ismasterdatasheet:!0},g.config&&(f.showsiteselector=g.config.showdetailsiteselector,f.disablesiteselector=g.config.disabledetailsiteselector),"False"===j["allow Edit"]&&(f.readonly=!0,f.canedit=!1),g.config=f,g.detailDatasheet=new e(d),g.detailDatasheet.unlinkEntities.add(T.bind(null,g)),g.detailDatasheet.entityDeleted.add(v.bind(null,g)),g.detailDatasheet.pageChangeDone.add(B.bind(null,g)),!o&&l&&!l.vw)return g.noAccessToDetailDatasheet=!0,g.region.$element.find(".detail-datasheet-container").addClass("no-access"),void k.resolve();(o||l&&l.ins)&&(g.detailDatasheet.canInsert=!0),
(o||l&&l.del)&&(g.detailDatasheet.canDelete=!0),(o||l&&l.upd)&&(g.detailDatasheet.canUpdate=!0),(o||l&&l.vw)&&(g.detailDatasheet.canView=!0),o||!l||!l.vw||l.ins||l.del||l.upd||(f.readonly=!0,f.canedit=!1),g.config=f,g.cachedEntity.detail&&g.detailDatasheet.updateState(g.cachedEntity.detail,h),g.detailDatasheet.masterSiteKey=g.layout.siteKey(),g.detailDatasheet.load(f).done(C.bind(null,g,k)).fail(D.bind(null,g,k))}).fail(function(){g.throwException(g.translate("DS_LOAD_BULK_ENTITY_FAIL_EXCEPTION")),k.resolve()}),k},s.prototype.throwException=function a(b){var c=new p(1,b,"platform/datasheets/master-detail-datasheet-manager.js");this.appEvents.errorOccured.raise(this,c)},s.prototype.onDatasheetSaved=function a(){return V(this)};function v(a){a.onBulkEntitiesDeleted.raise()}function w(a){a.masterDatasheet.layout.toggleHelpText()}function x(a,b,c){a.entity=c,a.masterDatasheet.setTitle(""),a.masterDatasheet.layout.isMasterDatasheet(!0),
a.masterDatasheet.layout.changeCanPaste.add(ja.bind(null,a),a),a.layout.canPaste(a.masterDatasheet.layout.canPaste()),a.layout.showStateManagement(a.masterDatasheet.layout.showStateManagement()),a.layout.entityState(a.masterDatasheet.layout.entityState()),a.layout.isSiteFiltered(c.isSiteFiltered),a.layout.siteKey(c.siteKey),a.savedSiteKey=c.siteKey,"0"===a.masterDatasheet.entity.siteKey&&t(a,a.masterDatasheet.entity.siteKey),a.masterDatasheet.layout.isRefDocEnabled()&&a.layout.isRefDocEnabled(!0),a.layout.refDocCount(a.masterDatasheet.layout.refDocCount()),a.masterDatasheet.layout.refDocsHidden.add(O.bind(null,a)),a.masterDatasheet.layout.refDocsRendered.add(P.bind(null,a)),a.onMasterDatasheetLoaded.raise(),a.entity&&(a.layout.setFamilyKey(a.entity.familyKey),a.layout.setCurrentEntyKey(a.entity.key)),b.resolve()}function y(a,b){var c,d,e;if(b){for(a.userFamilyPrivileges=b,c=b.isSuperUser,a.isSuperUser=c,
d=0;d<b.privileges.length;d++)if(b.privileges[d].familyKey.toString()===a.entity.familyKey.toString()){e=b.privileges[d];break}a.layout.isNewAvailable(A(a,"new",e,c,"ins")),0===a.entity.key?a.layout.isSaveAvailable(A(a,"save",e,c,"ins")):a.layout.isSaveAvailable(A(a,"save",e,c,"upd")),a.layout.isDeleteAvailable(A(a,"delete",e,c,"del")),a.layout.isUnlinkRecordEnabled(A(a,"unlinkRecord",e,c,"del")),a.layout.isPasteEnabled(A(a,"copy",e,c,"ins")&&A(a,"copy",e,c,"upd"))}}function z(a){a.layout.isSelectedSiteViewOnly(a.siteSelector.isSiteViewOnly)}function A(a,c,d,e,f){var g=d&&d[f];return b.inArray(c,a.config.functionsavailable)>=0&&(e||g)}function B(a,b){a.entities=b}function C(a,b,c){a.entities=c,a.detailDatasheet.setTitle(""),a.detailDatasheet.layout&&(a.detailDatasheet.layout.isMasterDatasheet(!0),a.layout.setDetailFamilyCaption(a.entities[0].familyCaption),a.canDeleteRelationshipFamily===!1&&a.detailDatasheet.layout.isUnlinkAvailable(!1)),
0===a.entity.key||a.isSuperUser||a.layout.isSelectedSiteViewOnly(!0),b.resolve()}function D(a,b,c){c&&(a.throwException(a.translate("DS_DATASHEET_NOT_CONFIGURED_MESSAGE")),a.region.$element.find(".load-spinner").css("display","none")),b.reject()}function E(a){var c=Object.resolve(n),d,e,f=a.datasheetdto.customFormParameters["relationship Family ID"];a.cachedEntity||(a.cachedEntity={master:null,detail:null}),d=a.layout.getRelationshipFamilyById(f),e=c.getUserFull(),b.when(d,e).then(F.bind(null,a))}function F(a,c,d){var e,f;c&&(a.canDeleteRelationshipFamily=c.canDelete,a.canInsertRelationshipFamily=c.canInsert),y(a,d),e=a.renderMasterDatasheet(),f=a.renderDetailDatasheet(),b.when(e,f).then(a.renderMasterDetailDatasheet_done.bind(null,a))}s.prototype.renderMasterDetailDatasheet_done=function a(b){var c,d;b.entity.isSiteFiltered&&0===b.entity.key&&b.assetContextKey>0&&b.layout.assetContextKey(b.assetContextKey),b.layout.isDatasheetRendered(!0),b.layout.addMoreOptionsForIcons(),
b.masterDatasheet.layout.isDatasheetRendered(!1),b.masterDatasheet.layout.isDatasheetRendered(!0),d=K(b),0!==b.region.$element.find(".master-datasheet-container .nav-tabs").length&&(d+=40),c=H(b),I(b,c,d),b.region.$element.find(".master-detail-datasheet-disabled-overlay").is(":visible")&&b.masterDatasheet.tabSwitched()&&b.masterDatasheet.tabSwitched().add(L.bind(null,b)),b.masterDatasheet.entityModified.add(M.bind(null,b)),b.detailDatasheet.entityModified.add(N.bind(null,b)),b.masterDatasheet.entityDeleted.add(G.bind(null,b)),b.masterDatasheet.entityIdChanged.add(Ea.bind(null,b)),b.detailDatasheet.entityIdChanged.add(Ea.bind(null,b));var e=b.region.$element.find("mi-site-selector");if(e.length){b.siteSelector=e[0],Element.upgrade(b.siteSelector),"0"===b.layout.siteKey()&&0===b.entity.key&&b.siteSelector.selectDefaultSite();var f=b.siteSelector.isSiteViewOnly;f&&(b.layout.isSelectedSiteViewOnly(f),b.isSaveAvailable(!1),b.isDeleteAvailable(!1))}
b.canUpdateRefDocView&&(b.masterDatasheet.refDocs=b.refDocs,b.layout.showRefDocs()),b.layout.handleNavAppearance()};function G(a){a.entityDeleted.raise(a.entity)}function H(a){var b,c,d,e,f;return c=a.region.$element.find(".datasheet-layout-container.bulk-form-datasheet>div").height(),d=a.region.$element.find(".master-datasheet-container").height(),e=41,f=31,"True"===a.datasheetdto.customFormParameters["allow Insert"]?(b=d+c+e+f+51,a.detailDatasheet.newEntityFlag||(b=d+c+e+f)):"False"===a.datasheetdto.customFormParameters["allow Insert"]&&(b=d+c+e+f),b}function I(a,b,c){a.region.$element.find(".master-datasheet-container .nav-tabs").is(":visible")&&(b-=40),J(a.region.$element.find(".datasheet-layout-container .table-responsive"))&&(b-=30),a.layout.overlayTop(c+"px"),a.region.$element.find(".master-detail-datasheet-disabled-overlay").css("height",b)}function J(a){return 0!==a.length&&a[0].clientWidth<a[0].scrollWidth}function K(a){var b,c;return b=a.layout.overlayTop().split("px"),
c=parseInt(b[0])}function L(a){var b,c;b=K(a),c=H(a),I(a,c,b)}function M(a,b,c){a.cachedEntity.master=a.masterDatasheet.cachedEntity,a.entityModified.raise(b,c)}function N(a,b,c,d){a.detailDatasheet.masterSiteKey=a.layout.siteKey(),a.cachedEntity.detail=a.detailDatasheet.cachedEntity,a.entityModified.raise(b,c,d)}function O(a){a.layout.isRefDocsDisplayed(!1)}function P(a,b){a.refDocs=b,a.refDocsSet.raise()}function Q(a,b,c,d){var e;a.layout&&a.layout.detach(a.region),e=0===a.entity.key?a.entityFactory.new(a.entity.familyKey):a.entityFactory.get(a.entity.key),e.done(function(e){a.onFormsDatasheet.raise(b,c,d,e)}).fail(function(){a.throwException(a.translate("DS_LOAD_ENTITY_FAIL_EXCEPTION"))})}function R(a,b,c,d){a.layout&&a.layout.detach(a.region),a.onMasterDetailDatasheet.raise(b,c,d,a.entity)}function S(a,b,c,d,e){var f;a.layout.detach(a.region),f=0===a.entity.key?a.entityFactory.new(a.entity.familyKey):a.entityFactory.get(a.entity.key),f.done(function(f){
a.onNewMasterDetail.raise(b,c,f,d,e)}).fail(function(){a.throwException(a.translate("DS_LOAD_ENTITY_FAIL_EXCEPTION"))})}function T(a){var b=a.detailDatasheet.getSelectedEntities(),c=a.datasheetdto.customFormParameters,d=[],e,f=!1,g;k.showYesNo(a.translate("DS_UNLINK_SELECTED_ENTITIES_MESSAGE"),a.translate("DS_ALERT_TITLE")).done(function(h){if(0===h){for(var i=0;i<b.length;i++)d.push(b[i]);e=a.entityFactory.deleteRelationships(c["relationship Family ID"],a.entity.key,d),e.done(function(b){for(var c=0;c<b.length;c++)if(""!==b[c].errorMessage){f=!0,g=b[c].errorMessage;break}if(f)return void k.show(g,a.translate("DS_ERROR"));a.onBulkEntitiesUnlinked.raise()})}})}function U(b,c,d){var e=[],f=0;for(d=d||[],e=c.filter(function(a){return d.indexOf(a)===-1}),f=0;f<e.length;f++){b.detailDatasheet.updateRow("delete",c[f]);var g=a.findIndex(b.detailDatasheet.entity,function(a){return a.key===e[f]});b.detailDatasheet.entity.splice(g,1)}b.entities=b.detailDatasheet.entity}function V(a){
var c=b.Deferred();a.indicator.show();var d=a.entityFactory.checkIfEntityDirty(a.entity),e=a.entityFactory.checkIfEntitiesDirty(a.entities);return e.always(W.bind(null,a,d,e,c)),c}function W(a,c,d,e){var f=!1,g;"rejected"===d.state()&&(f=!0),g=b.when(c,d),g.done(X.bind(null,a,e)).fail(Y.bind(null,a,f,e))}function X(a,b){t(a,a.masterDatasheet.entity.siteKey),0===a.entity.key||a.savedSiteKey!==a.layout.siteKey()?Y(a,!1,b):(b.resolve(),da(a))}function Y(a,b,c){a.detailDatasheet.masterSiteKey=a.layout.siteKey(),a.detailDatasheet.getEntitiesToBeSaved(a.entities).done(Z.bind(null,a,b,c))}function Z(a,b,c,d){$(a,b,c,d)}function $(a,b,c,d){var e,f;if(a.layout.setErrorAndReturnErrorFlag(a,d))return c.reject(),void da(a);e=(a.entity.isDirty||a.entity.isNew)&&a.entity.isAuditable,f=a.entities.length>0&&(b||a.entity.isNew)&&a.entities[0].isAuditable,e||f?_(a,ca,c):ca(a,c)}function _(a,b,c){var d,e;d=Object.resolve(q),e=new g(d,a.translate("DS_AUTH_DIALOG_TITLE"),{height:300,width:400}),e.show(),
d.saveAllowed.add(b.bind(null,a,c,e)),d.saveDenied.add(aa.bind(null,a,c,e)),d.saveCancelled.add(ba.bind(null,a,e))}function aa(a,b,c){ba(a,c),k.showOk(a.translate("DS_AUTH_FAILURE_MSG"),a.translate("DS_AUTH_FAILURE_DIALOG_TITLE")),b.reject()}function ba(a,b){b&&(b.closeDialog(),da(a))}function ca(a,b,c){a.saveMasterEntity().done(xa.bind(null,a,b)).fail(ya.bind(null,a,b)),c&&c.closeDialog()}function da(a){a.indicator.hide()}function ea(a){var b,c;b=a.datasheetdto.customFormParameters["detail Family ID"],a.masterDatasheet.masterDatasheetDirtyEvent.add(fa.bind(null,a)),c=a.masterDatasheet.callOnDatasheetNew(),c.then(function(){if(a.entity=a.masterDatasheet.entity,a.layout.isDatasheetRenderedInRM())return void a.newDatasheet.raise(a.entity.familyKey);a.detailDatasheet.unload().done(function(){var c;a.onMasterDetailDatasheetNew.raise(a.entity),c=a.detailDatasheet.changeDatasheet([],a.config,b),c.then(function(){a.entities=a.detailDatasheet.entity}),
a.masterDatasheet.layout.isMasterDatasheet(!1),a.masterDatasheet.callOnDatasheetNew().done(function(){a.masterDatasheet.layout.isMasterDatasheet(!0),a.detailDatasheet.isMasterDatasheetDirty=!1})})})}function fa(a){a.detailDatasheet.isMasterDatasheetDirty=!0}function ga(a){a.masterDatasheet.callOnDatasheetDelete().done(function(){a.detailDatasheet.callOnMasterDatasheetDelete(),a.layout.isSaveAvailable(!1),a.layout.isDeleteAvailable(!1),a.layout.isHistoryAvailable(!1),a.layout.isCopyAvailable(!1),a.layout.setDetailFamilyCaption("")})}function ha(a){a.masterDatasheet.callOnDatasheetCopy(a.entity)}function ia(a){a.masterDatasheet.callOnDatasheetPaste(a.entity)}function ja(a,b){a.layout.canPaste&&a.layout.canPaste(b)}function ka(a){var b=Object.resolve(f),c=new h;b.attach(c,a.entity),b.loadHistory();var d=new g(b,a.translate("DS_FIELD_HISTORY_TITLE"),{height:"90%",width:"80%"});b.setDialog(d),d.show()}function la(a){
a.canUpdateRefDocView?(a.masterDatasheet.layout.updateRefDocView(a.refDocs),a.canUpdateRefDocView=!1):a.masterDatasheet.layout.showRefDocs()}function ma(a,b,c){a.masterDatasheet.callBeforeStateTransition(b,c)}function na(a,b,c){a.masterDatasheet.callOnStateTransition(b,c)}function oa(b){a.defer(function(){b.masterDatasheet&&b.detailDatasheet&&(b.masterDatasheet.layout.isDatasheetReadOnly(!1),b.detailDatasheet.layout&&(b.config.readonly===!0?(b.detailDatasheet.layout.isDatasheetReadOnly(!0),b.detailDatasheet.detailDatasheetEditDenied.raise()):b.detailDatasheet.layout.isDatasheetReadOnly(!1)))})}function pa(a){a.detailDatasheet&&(a.detailDatasheet.handleOverlay(),a.detailDatasheet.layout.handleScrolling())}function qa(a){var c,d,e;c=a.entityFactory.checkIfEntityDirty(a.entity),d=a.entityFactory.checkIfEntitiesDirty(a.entities),e=b.when(c,d),e.done(function(){a.layout.previousDatasheetKey(a.layout.currentDatasheetKey()),a.layout.executeDatasheetChanged()}).fail(function(){
wa().done(function(c){if(0===c)ra(a);else if(1===c){var e=b.Deferred(),f=!1;a.indicator.show(),"rejected"===d.state()&&(f=!0),Y(a,f,e),b.when(e).done(ra.bind(null,a))}}).fail(function(){a.layout.proceed=!1,a.layout.currentDatasheetKey(a.layout.previousDatasheetKey())})})}function ra(a){a.cachedEntity={master:null,detail:null},a.layout.previousDatasheetKey(a.layout.currentDatasheetKey()),a.layout.executeDatasheetChanged()}s.prototype.saveMasterEntity=function a(){var c=b.Deferred(),d=this,e=d.masterDatasheet.entity.checkIfEntityDirty();return d.savedSiteKey!==d.layout.siteKey()&&(d.masterDatasheet.entity.siteKey=d.layout.siteKey(),e.reject()),0===d.entity.key&&e.reject(),e.done(function(){c.reject(d.masterDatasheet.entity)}).fail(function(){d.entityFactory.save(d.masterDatasheet.entity).done(function(a){d.entity=a,c.resolve(a)}).fail(function(a){if(a.statusCode&&409===a.statusCode().status)d.layout.uiHelper.lockEntityUpdateHelper(d);else if(a.statusCode&&500===a.statusCode().status){
var b=d.translator.translate("MDF_SAVE_ERROR"),e=new p(1,b,a.responseJSON);d.appEvents.errorOccured.raise(d,e)}c.reject()})}),c},s.prototype.saveDetailEntities=function a(){var c=b.Deferred(),d=this,e=[],f,g,h;return f=d.datasheetdto.customFormParameters["relationship Family ID"],d.detailDatasheet.getEntitiesToBeSaved(d.entities).done(function(a,b){if(a.length>0){var e=sa(a);g=d.entityFactory.saveAndLinkEntities(a,d.entity.key,f),g.then(ua.bind(null,d,c,b,e))}else c.resolve(d.entities)}),c};function sa(b){return a.map(b,function(a){return{entitykey:a.key,lockSeqNbr:a.lockSeqNbr,sitekey:a.siteKey}})}function ta(a,b,c){for(var d=!1,e=0;e<b.length;e++)for(var f=0;f<c.length;f++)if(c[f].errorMessage===a.translator.translate("DS_BULK_ENTITY_CONCURRENT_WARNING_MESSSAGE")){a.layout.uiHelper.lockEntityUpdateHelper(a,"master"),d=!0;break}return d}function ua(b,c,d,e,f){var g=!1;if(e&&f&&ta(b,e,f))return c.reject(),void da(b)
;b.detailDatasheet.layout.isHistoryDisabled(!b.detailDatasheet.getHistoryStatus(f));for(var h=0;h<f.length;h++)""===f[h].errorMessage?(0===f[h].key||a.includes(b.detailDatasheet.entityObj,f[h].key.toString())||(b.detailDatasheet.entityObj.unshift(f[h].key.toString()),b.detailDatasheet.layout.updatePageCount(b.detailDatasheet.entityObj.length)),b.detailDatasheet.layout.updateRow("save",f[h],d[h]),b.detailDatasheet.getEntityStatus(b.entities[d[h]],b.detailDatasheet).done(function(a,c,d){b.detailDatasheet.layout.updateRow("status",a,c)}.bind(null,f[h]))):g=!0;g&&b.detailDatasheet.displayError(b.detailDatasheet),b.cachedEntity.detail=b.detailDatasheet.entity,c.resolve(b.entities)}s.prototype.unload=function a(){var c=this,d=b.Deferred(),e,f,g,h;return f=c.entityFactory.checkIfEntityDirty(c.entity),g=c.entityFactory.checkIfEntitiesDirty(c.entities),h=b.when(f,g),h.done(function(){d.resolve()}),h.fail(function(){wa().done(function(a){if(0===a)va(c,d);else if(1===a){var e=b.Deferred(),f=!1
;c.indicator.show(),"rejected"===g.state()&&(f=!0),Y(c,f,e),b.when(e).done(va.bind(null,c,d))}}).fail(function(){d.reject()})}),d};function va(a,b){a.layout&&(a.layout.detach(a.region),a.layout&&a.layout.deallocateMem(),a.layout=null,a.masterDatasheet.layout.changeCanPaste.remove(a),a.masterDatasheet.detachEntityEventHandlers(),b.resolve())}s.prototype.detachEntityEventHandlers=function a(){if(this.masterDatasheet&&this.masterDatasheet.detachEntityEventHandlers(),this.detailDatasheet)for(var b=0;this.detailDatasheet.entity&&b<this.detailDatasheet.entity.length;b++)this.detailDatasheet.detachEntityEventHandlers(this.detailDatasheet.entity[b]);this.appEvents&&this.appEvents.layoutChanged&&this.appEvents.layoutChanged.remove(u.bind(null,this))};function wa(){return k.showUnsavedChanges()}function xa(a,b,c){if(a.entity=c,0===a.entity.key||a.isSuperUser||a.layout.isSelectedSiteViewOnly(!0),a.noAccessToDetailDatasheet)return a.onMasterDetailDatasheetSaved.raise(a.entity),b.resolve(),
void da(a);a.detailDatasheet&&a.saveDetailEntities().done(za.bind(null,a,b))}function ya(a,b){a.detailDatasheet&&a.entityFactory.checkIfEntitiesDirty(a.entities).done(function(){b.resolve(),da(a)}).fail(function(){a.saveDetailEntities().done(za.bind(null,a,b))})}function za(a,b,c){a.entities=c,a.onMasterDetailDatasheetSaved.raise(a.entity),b.resolve(),da(a)}function Aa(a){var c={};return b.each(a,function(a,b){c[a.toLowerCase()]=b}),c}function Ba(a,b){var c;return b["allow Delete"]&&"false"!==b["allow Delete"].toLowerCase()||(c=a.indexOf("delete"))>-1&&a.splice(c,1),b["allow Insert"]&&"false"!==b["allow Insert"].toLowerCase()||(c=a.indexOf("new"),c>-1&&a.splice(c,1),(c=a.indexOf("link"))>-1&&a.splice(c,1)),b["allow Linking"]&&"false"!==b["allow Linking"].toLowerCase()||(c=a.indexOf("link"))>-1&&a.splice(c,1),b["allow Unlinking"]&&"false"!==b["allow Unlinking"].toLowerCase()||(c=a.indexOf("unlink"))>-1&&a.splice(c,1),a}function Ca(a){a.makeRootRecordEvent.raise(a.entity)}function Da(a){
a.unlinkRecordEvent.raise(a.entity)}function Ea(a,b){a.entityIdChanged.raise(b)}function Fa(a){return"-1"===a.entity.siteKey&&(a.cachedEntity=a.entity),a.cachedEntity}return s});

define('text!platform/datasheets/layout/ui/views/aggregate-datasheet.html',[],function () { return '<div class="datasheet-layout-container bulk-form-datasheet" data-bind="css:{\'edit\':!isDatasheetReadOnly()}">\r\n    <div class="datasheet-header-container">\r\n        <h2 data-bind="visible: noData, text: translate(\'DS_NO_DATA\')" class="no-data"></h2>\r\n        <h2 data-bind="text: title, visible: !noData"></h2>\r\n        <div data-bind="if: isDatasheetRendered" class="datasheet-nav">\r\n            <div class="pull-right">\r\n                <button class="btn btn-icon " data-bind="visible: isDatasheetRendered() && isSelectAllAvailable(), click: toggleSelectMode, attr: {title: translate(\'DS_SELECT_TOOLTIP\')}"><i class="icon-select-all"></i> </button>\r\n                <button class="btn btn-icon " data-bind="visible: isDatasheetRendered() && isDeleteAvailable(), click: deleteDatasheet, disable: hasSelection(), attr: {title: translate(\'DS_DELETE_TOOLTIP\')}"><i class="icon-bin"></i> </button>\r\n                <button class="btn btn-icon" data-bind="visible: isDatasheetRendered() && isSaveAvailable(), click: saveDatasheet, attr: {title: translate(\'DS_SAVE_TOOLTIP\')}"><i class="icon-save"></i> </button>\r\n            </div>\r\n        </div>\r\n        <h5 data-bind="text: currentDatasheetCaption"></h5>\r\n    </div>\r\n\r\n\r\n    <div class="table-responsive" data-bind="css:{\'title\':title,\'caption\':currentDatasheetCaption,\'full\':title() && currentDatasheetCaption()}">\r\n        <table class="table table-cust1">\r\n            <thead>\r\n                <tr data-bind="">\r\n                    <th data-bind="visible:$root.selectMode()">\r\n                        <div class="checkbox-selectall">\r\n                            <mi-checkbox data-bind="miCheckboxProperty:{ checked:$root.selectAll}"> </mi-checkbox>\r\n\r\n                        </div>\r\n                    </th>\r\n                    <!-- ko foreach:columns -->\r\n                    <th data-bind="text:columnCaption"></th>\r\n                    <!-- /ko -->\r\n                </tr>\r\n            </thead>\r\n            <tbody data-bind="foreach:rows">\r\n                <tr data-bind="css:{\'active\':$data.isSelected},visible:!isReadonly()">\r\n                    <td data-bind="visible:$root.selectMode()">\r\n                        <div class="checkbox-selectall">\r\n                            <mi-checkbox data-bind="miCheckboxProperty:{ checked:$data.isSelected, value:$data.entitykey, disable:$data.isCheckboxDisabled}"> </mi-checkbox>\r\n\r\n                        </div>\r\n                    </td>\r\n\r\n                    <!-- ko foreach:$data.cols -->\r\n                    <td class="datasheetCell" data-bind="template:{name:controlTemplate()} , event: { keyup: function bulkdatasheet_element_onkeyup(data,event){ $root.focusNextRow(data,event,$index,$parentContext.$index);}}"></td>\r\n                    <!-- /ko -->\r\n                </tr>\r\n            </tbody>\r\n\r\n\r\n        </table>\r\n\r\n        <div class="bulk-datasheet-disabled-overlay" data-bind="visible: isDatasheetReadOnly,style: { top: overlayTop}"></div>\r\n\r\n    </div>\r\n</div>';});

define('platform/datasheets/layout/ui/aggregate-datasheet-view-model',['require','lodash','jquery','knockout','spa/ko/knockout-view-model','./bulk-column-view-model','./bulk-row-view-model','../services/datasheet-service','system/lang/event','../model/field-value-model','../model/entity-model','../adapters/datasheet-adapter','../adapters/datasheet-field-info-adapter','./helpers/ui-helper','./helpers/js-module-helper','text!./views/aggregate-datasheet.html','text!./field-control-template-map.json','text!./views/templates/field-check-box-template.html','text!./views/templates/field-combo-box-template.html','text!./views/templates/field-date-template.html','text!./views/templates/field-radio-template.html','text!./views/templates/field-text-area-template.html','text!./views/templates/field-hyperlink-template.html','text!./views/templates/field-text-template.html','text!./views/templates/field-select-template.html','text!./views/templates/field-multivalue-template.html','text!./views/templates/field-date-alt-template.html','text!./views/templates/field-empty-template.html','text!./views/templates/field-multi-text-template.html','system/globalization/translator','system/knockout/knockout-helpers','jquery-ui','ui/elements/checkbox/checkbox-view-model','ui/elements/select/view-model','ui/elements/multi-value/view-model','ui/elements/text-ext/view-model'],function(require){"use strict"
;var a=require("lodash"),b=require("jquery"),c=require("knockout"),d=require("spa/ko/knockout-view-model"),e=require("./bulk-column-view-model"),f=require("./bulk-row-view-model"),g=require("../services/datasheet-service"),h=require("system/lang/event"),i=require("../model/field-value-model"),j=require("../model/entity-model"),k=require("../adapters/datasheet-adapter"),l=require("../adapters/datasheet-field-info-adapter"),m=require("./helpers/ui-helper"),n=require("./helpers/js-module-helper"),o=require("text!./views/aggregate-datasheet.html"),p=JSON.parse(require("text!./field-control-template-map.json")),q=require("text!./views/templates/field-check-box-template.html")+require("text!./views/templates/field-combo-box-template.html")+require("text!./views/templates/field-date-template.html")+require("text!./views/templates/field-radio-template.html")+require("text!./views/templates/field-text-area-template.html")+require("text!./views/templates/field-hyperlink-template.html")+require("text!./views/templates/field-text-template.html")+require("text!./views/templates/field-select-template.html")+require("text!./views/templates/field-multivalue-template.html")+require("text!./views/templates/field-date-alt-template.html")+require("text!./views/templates/field-empty-template.html")+require("text!./views/templates/field-multi-text-template.html"),r=require("system/globalization/translator")
;require("system/knockout/knockout-helpers"),require("jquery-ui"),require("ui/elements/checkbox/checkbox-view-model"),require("ui/elements/select/view-model"),require("ui/elements/multi-value/view-model"),require("ui/elements/text-ext/view-model");function s(a){t.call(this,o),this.region=null,this.datasheetService=a,this.translator=Object.resolve(r),this.uiHelper=Object.resolve(m),this.jsModuleHelper=Object.resolve(n),this.title=c.observable("Datasheet"),this.isBulkDatasheet=c.observable(!0),this.datasheetKeys=c.observableArray(),this.datasheets=c.observableArray(),this.currentDatasheetKey=c.observable(),this.currentDatasheetCaption=c.observable(),this.cachedFieldValues=null,this.cachedFamilykey=null,this.currentDatasheet=c.observable(),this.currentEntity=c.observable(),this.currentEntities=c.observable(),this.fieldInfos=c.observableArray(),this.columns=c.observableArray(),this.rows=c.observableArray(),this.currentCellIndex=c.observable(0),this.entities=c.observableArray(),
this.isSelectAllAvailable=c.observable(!0),this.isSaveAvailable=c.observable(!0),this.isDeleteAvailable=c.observable(!0),this.isHistoryAvailable=c.observable(!0),this.isHistoryDisabled=c.observable(!1),this.isSingleEntitySelected=c.observable(!1),this.isLinkAvailable=c.observable(!0),this.isUnlinkAvailable=c.observable(!0),this.isNewAvailable=c.observable(!0),this.isDatasheetReadOnly=c.observable(!1),this.canEdit=c.observable(!1),this.overlayTop=c.observable("0"),this.showDatasheetSelection=c.observable(!0),this.oldEntity=null,this.isDatasheetRendered=c.observable(!1),this.isReadOnly=c.observable(!1),this.layoutRendered=new h,this.entityRendered=new h,this.fieldValueChanged=new h,this.currentEntityChanged=new h,this.datasheetSaved=new h,this.datasheetNew=new h,this.datasheetDelete=new h,this.datasheetHistory=new h,this.hasSelectionChanged=new h,this.unlinkEntities=new h,this.selectMode=c.observable(!1),this.hasSelection=c.observable(!0),this.selectAll=c.observable(!1),
this.isTextareaFocused=c.observable(!1),this.noData=c.observable(!1),this.selectedEntities=c.computed(I.bind(null,this)),this.currentEntityChangedSubscription=this.currentEntity.subscribe(x.bind(null,this)),this.currentEntityBeforeChangeSubscription=this.currentEntity.subscribe(w.bind(null,this),null,"beforeChange"),this.selectedEntities.subscribe(J.bind(null,this)),this.selectAll.subscribe(K.bind(null,this)),this.useNativeSelect=c.observable(!1),this.uiHelper.attachTemplatesForAggregate(this,q)}var t=Object.inherit(d,s);s.dependsOn=[g],s.prototype.activate=function a(){},s.prototype.attach=function a(b){t.prototype.attach.call(this,b),this.region=b},s.prototype.detach=function a(b){t.prototype.detach.call(this,b)},s.prototype.translate=function a(b){return this.translator.translate(b)},s.prototype.setTitle=function a(b){this.title(b)},s.prototype.newDatasheet=function a(){this.datasheetNew.raise()},s.prototype.saveDatasheet=function a(){this.datasheetSaved.raise(this.entities())},
s.prototype.deleteDatasheet=function a(){this.datasheetDelete.raise(this.selectedEntities())},s.prototype.toggleSelectMode=function a(){this.selectMode(!this.selectMode())},s.prototype.unlinkRelatedEntities=function a(){this.unlinkEntities.raise()},s.prototype.showEditMode=function a(){this.isDatasheetReadOnly(!1)},s.prototype.showDatasheet=function a(c){var d=this,e=b.Deferred(),f=b.Deferred(),g,h,i,j;return u(d,c),B(d,c),H(d),f.resolve(c),e.resolve(),f},s.prototype.assignFieldValues=function a(b){for(var c=this,d=0,e=0;e<b.length;e++)F(c,e,b),d=0};function u(b,c){var d=0;a.each(c,function(b){a.each(b,function(b){a.each(b.fields,function(a){a.options.picklist&&d++})})}),d>5&&b.useNativeSelect(!0)}s.prototype.updateFieldValue=function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){var s=0,t=0,u,w=[],x=null,y=this;if(this.entities()){for(var z=0;z<this.entities().length;z++)for(var A=0;A<this.entities()[z].length;A++){
if("0"===this.entities()[z][A].key.toString()&&"0"===b.key.toString()&&this.entities()[z][A].clientid===b.clientid){u=this.entities()[z][A];break}if("0"!==b.key.toString()&&this.entities()[z][A].key.toString()===b.key.toString()){u=this.entities()[z][A];break}}w=u.fieldValues()}if(r&&null!==m)for(s=0;s!==w.length;s++)for(t=0;t!==m.length;t++)w[s].key().toString()!==m[t]&&w[s].key()!==m[t]&&w[s].key()!==c||w[s].clientDisabled(!1);for(s=0;s!==w.length;s++){if(w[s].key().toString()===c||w[s].key()===c){x=w[s];break}w[s].changedFromView(!0)}v(x,{newValue:d,newValues:e,newDisplayValue:f,picklist:g,isDisabled:h,isRequired:i,errorMessage:j,backColor:k,maxNumberOfValues:l,jsModuleName:n,jsModuleParams:o,popJSModuleOnFocus:p,stopPropagate:r,addParseValueParam:q})};function v(a,b){a&&(b.stopPropagate&&a.changedFromView(!1),a.value(b.newValue),a.values(b.newValues),a._values(b.newValues),a.displayValue(b.newDisplayValue),a.disabled(b.isDisabled),a.required(b.isRequired),
a.errorMessage(b.errorMessage),a.backColor(b.backColor),a.maxNumberOfValues(b.maxNumberOfValues),void 0!==a.jsModuleName&&a.jsModuleName()&&null!==a.jsModuleName()&&a.jsModuleName(b.jsModuleName),void 0!==a.jsModuleParams&&a.jsModuleParams()&&null!==a.jsModuleParams()&&a.jsModuleParams(b.jsModuleParams),void 0!==a.popJSModuleOnFocus&&a.popJSModuleOnFocus()&&null!==a.popJSModuleOnFocus()&&a.popJSModuleOnFocus(b.popJSModuleOnFocus),void 0!==a.picklist&&a.picklist(a.createPickList(b.picklist)),a.changedFromView(!0))}s.prototype.updateRow=function a(b,d,e){var f=this,g;if("delete"===b)g=f.deleteRow(d);else if("new"===b){for(var h=!1,i=0;i<f.rows().length;i++)"new-clean"===f.rows()[i].entityStatus()&&(h=!0);h||(g=f.addNewRow(d))}else"status"===b?(g=f.getRowByKey(d),g.entityStatus(e)):"save"===b?(f.entities()[e].key=d.key,f.entities()[e].clientid=void 0,f.rows()[e].entitykey(d.key),0!==d.key&&f.rows()[e].isCheckboxDisabled(!1),
window.entitykey=c.observable(d.key)):"clientid"===b&&(f.entities()[0].clientid=d.clientid,f.rows()[0].clientid(d.clientid))},s.prototype.renderDateControl=function c(d,e,f){if(!e.fieldValue().disabled()){var g=b(f.currentTarget).closest("td");e.controlTemplate(p.Date),e.fieldValue().handleDate(),a.delay(function(){var a=b(g).find("input.form-control");a.trigger("focus"),a.on("keypress keydown",function(a){a.preventDefault()})},10)}},s.prototype.addNewRow=function a(b){var c=this,d,e=c.rows().length;c.rows.push(new f(b.entitykey,b.clientid,c)),d=c.rows()[e],d.entityStatus("new-clean"),d.isCheckboxDisabled(!0),c.cachedFieldValues.push(b),c.attachEntityToLayout(b.entitykey,b.fields,e,b.clientid),F(c,e)},s.prototype.deleteRow=function a(b){var c=this,d,e,f;for(f=0;f<c.rows().length;f++)if(c.rows()[f].entitykey().toString()===b.toString()){d=c.rows()[f],e=f;break}for(c.rows.remove(d),f=0;f<c.entities().length;f++)if(c.entities()[f].key.toString()===b.toString()){d=c.entities()[f],e=f;break
}return c.entities.remove(d),d},s.prototype.getRowByKey=function a(b){var c=this,d=c.rows(),e,f;if(0!==b.key&&"0"!==b.key){for(f=0;f<d.length;f++)if(d[f].entityKeyArray().indexOf(b.key)>-1){e=d[f];break}}else for(f=0;f<d.length;f++)if(d[f].clientid()==b.clientid){e=d[f];break}return e},s.prototype.dispose=function a(){this.currentEntity()&&this.currentEntity().dispose(),this.layoutRendered.remove(),this.entityRendered.remove()};function w(a,b){a.oldEntity=b}function x(a,b){a.oldValue&&a.oldValue.dispose(),b.fieldValueChanged.add(A.bind(null,a)),a.currentEntityChanged.raise(b,a.oldEntity)}function y(a,b){var c=k.toModelObject(b);a.currentDatasheet(c)}function z(a,c){var d=b.map(c,function(a){return l.toModelObject(a)});a.fieldInfos(d)}function A(a,b,c,d,e,f,g,h){var i=0,j=0,k,l=[];if(a.entities()){for(var m=0;m<a.entities().length;m++)for(var n=0;n<a.entities()[m].length;n++){
if("0"===a.entities()[m][n].key.toString()&&"0"===b.toString()&&a.entities()[m][n].clientid.toString()===f.toString()){k=a.entities()[m][n];break}if("0"!==b.toString()&&a.entities()[m][n].key.toString()===b.toString()){k=a.entities()[m][n];break}}l=k.fieldValues()}for(i=0;i!==l.length;i++)for(j=0;j!==g.length;j++)l[i].key().toString()!==g[j]&&l[i].key()!==g[j]&&l[i].key()!==c||l[i].clientDisabled(!0);a.fieldValueChanged.raise(b,c,d,e,f,h)}function B(a,b){for(var c=b.length-1,d=[],g=0;g<b.length;g++){for(var h=[],i=0;i<b[g].length;i++)h.push(b[g][i].entitykey);var j=new f(h,b[g][0].clientid,a);d.push(j),a.attachEntityToLayout(b[g],g);for(var k=0;k<b[g].length;k++){var l=j.cols().length,m=a.entities()[g][k];if(b[g][k].fields.length>0)for(var n=0;n<b[g][k].fields.length;n++){var o={},q=m.fieldValues()[n];o.columnCaption=b[g][k].fields[n].fieldCaption,o.columnFieldKey=b[g][k].fields[n].fieldKey;var r=new e(o);j.addColumn(r),j.cols()[l+n].fieldValue(q)
;var s=p[b[g][k].fields[n].fieldDataType]||"Character";E(a,q,j.cols()[l+n],s)}else for(var t=0;t<b[c][k].fields.length;t++){var u={};u.columnCaption=b[c][k].fields[t].fieldCaption,u.columnFieldKey=b[c][k].fields[t].fieldKey,j.addColumn(new e(u))}}}a.rows(d),a.columns(a.rows()[c].cols())}s.prototype.attachEntityToLayout=function a(b,c){var d=this,e=[];C(d,b,e),d.entities.push(e)};function C(a,b,c){for(var d=0;d<b.length;d++){for(var e=b[d].fields.length,f=[],g,h=0;h!==e;h++)f.push(new i(b[d].fields[h].fieldKey,b[d].fields[h].fieldId,b[d].fields[h].fieldValue,b[d].fields[h].fieldDisplayValue,{required:b[d].fields[h].options.required,disabled:b[d].fields[h].options.disabled,unitOfMeasure:b[d].fields[h].options.unitOfMeasure,picklist:b[d].fields[h].options.picklist,backColor:b[d].fields[h].options.backColor,jsModuleName:b[d].fields[h].options.jsModuleName,jsModuleParams:b[d].fields[h].options.jsModuleParams,popJSModuleOnFocus:b[d].fields[h].options.popJSModuleOnFocus,
addParseValueParam:b[d].fields[h].options.addParseValueParam,dependentFields:b[d].fields[h].options.dependentFields,isPicklistRestricted:b[d].fields[h].options.isPicklistRestricted,maxNumberOfValues:b[d].fields[h].options.maxNumberOfValues,values:b[d].fields[h].options.values,format:b[d].fields[h].options.format},b[d].clientid,b[d].entitykey));g=new j(f,b[d].entitykey,b[d].clientid),c.push(g),c[d].fieldValueChanged.add(A.bind(null,a))}}function D(a,b,c){var d=0,e=0,f=0,g=0,h,i,j;for(h=a.entities()[b],g=c.length-1,d=0;d<h.length;d++)if(i=h[d],i.fieldValues().length>0){for(e=0;e!==i.fieldValues().length;e++)j=i.fieldValues()[e],a.rows()[b].cols()[f+e].fieldValue(j);f+=i.fieldValues().length}else{var k=c[g][d].fields.length;for(e=0;e!==k;e++)a.rows()[b].cols()[f].fieldValue(null),f+=1}}function E(a,b,c,d){d=d||null,
void 0!==b.picklist?d=a.useNativeSelect()&&parseInt(b.maxNumberOfValues())<2?p.Select:b.isPicklistRestricted()?p.ComboBox:p.MultiValue:parseInt(b.maxNumberOfValues())>1?d=p.MultiText:b.displayValue().indexOf("href")>0&&(d=p.Hyperlink),d===p.Date&&(d=p.DateAlt),c.controlTemplate(d),"field-date-template"===c.controlTemplate()&&b.handleDate()}function F(a,b,c){G(a,b,c),a.entityRendered.raise()}function G(a,b,c){var d=0,e=0,f=0,g=0,h,i,j;for(h=a.entities()[b],g=c.length-1,d=0;d<h.length;d++)if(i=h[d],i.fieldValues().length>0)f+=i.fieldValues().length;else{var k=c[g][d].fields.length;for(e=0;e!==k;e++)a.rows()[b].cols()[f].controlTemplate(p.Empty),f+=1}}function H(a){a.layoutRendered.raise(),a.isDatasheetRendered(!0)}s.prototype.focusNextRow=function a(c,d,e,f){var g=this.rows(),h=this;switch(d.which){case b.ui.keyCode.LEFT:this.moveLeft(c,g,e,f);break;case b.ui.keyCode.UP:this.moveUp(c,g,e,f);break;case b.ui.keyCode.RIGHT:this.moveRight(c,g,e,f);break;case b.ui.keyCode.DOWN:
this.moveDown(c,g,e,f);break;case b.ui.keyCode.SPACE:"field-check-box-template"===c.controlTemplate()&&c.fieldValue().value(!c.fieldValue().value());break;case b.ui.keyCode.TAB:if("field-text-area-template"!==c.controlTemplate()||this.isTextareaFocused())if(b(d.target).hasClass("custom-bulk-ds-button")){if(h.moveRight(c,h.rows(),e,f),e()<h.rows()[f()].cols().length-1){var i=h.rows()[f()].cols()[e()+1];"field-text-template"===i.controlTemplate()&&i.fieldValue().jsModuleName()&&i.fieldValue().jsModuleName().length>0&&h.callOnFocus(i.fieldValue(),i,function(){return e()+1},f)}}else"field-text-template"===c.controlTemplate()&&c.fieldValue().jsModuleName()&&c.fieldValue().jsModuleName().length&&h.callOnFocus(c.fieldValue(),c,e,f);else{var j=this.showTextEditor(c);this.isTextareaFocused(!0),j.onSave.add(function(){h.isTextareaFocused(!1),h.focusCell(c,h.rows(),e,f)}),j.onClose.add(function(){h.isTextareaFocused(!1),h.focusCell(c,h.rows(),e,f)})}break;default:return!0}return!0},
s.prototype.moveToNextCell=function a(b,c){c.fieldValue().isSelected(!0),"field-text-area-template"===c.controlTemplate()&&b.fieldValue().showTextEditor.call(c)},s.prototype.moveLeft=function a(b,c,d,e){var f;f=c[e()].cols()[d()-1],d()>0&&(f.fieldValue().isSelected(!0),"field-text-area-template"===f.controlTemplate()&&b.fieldValue().showTextEditor.call(f))},s.prototype.moveRight=function a(b,c,d,e){var f,g=this;f=c[e()].cols()[d()+1],d()<c[e()].cols().length-1&&(f.fieldValue().isSelected(!0),"field-text-area-template"===f.controlTemplate()&&g.showTextEditor(b,function(){return d()+1},e))},s.prototype.focusCell=function a(b,c,d,e){var f;f=c[e()].cols()[d()],f.fieldValue().isSelected(!0)},s.prototype.moveToNextModuleCell=function a(b,c,d,e){for(var f,g,h,i=e();i<c.length;i++){for(i+=1,h=d();c[i]&&h<c[i].cols().length;h++)if(f=c[i].cols()[h],f.fieldValue().popJSModuleOnFocus()){f.fieldValue().isSelected(!0);break}break}},s.prototype.moveUp=function a(b,c,d,e){
e()>0&&c[e()-1].cols()[d()].fieldValue().isSelected(!0)},s.prototype.moveDown=function a(b,c,d,e){e()<c.length-1?c[e()+1].cols()[d()].fieldValue().isSelected(!0):e()===c.length-1&&"new-dirty"===c[e()].entityStatus()&&(this.currentCellIndex(d()),this.datasheetNew.raise())},s.prototype.showTextEditor=function a(b,c,d){var e=this,f=b.fieldValue().showTextEditor.call(b);return this.isTextareaFocused(!0),f.onSave.add(function a(){e.isTextareaFocused(!1),e.focusCell(b,e.rows(),c,d)}),f.onClose.add(function a(){e.isTextareaFocused(!1),e.focusCell(b,e.rows(),c,d)}),f},s.prototype.multipleRowSelect=function a(b,c,d){var e;if(c.shiftKey){var f=[];for(e=0;e<this.rows().length;e++)this.rows()[e].isSelected()&&f.push(e);if(0!==f.length)if(d()<f[0])for(e=d()+1;e<f[0];e++)this.rows()[e].isSelected(!0);else if(d()>f[f.length-1])for(e=f[f.length-1];e<d();e++)this.rows()[e].isSelected(!0)}};function I(a){var b=[];return c.utils.arrayForEach(a.rows(),function(a){
if(a.isSelected()&&a.entityKeyArray()!==[])for(var c=0;c<a.entityKeyArray().length;c++)b.push(a.entityKeyArray()[c])}),b}function J(a,b){a.hasSelection(!b.length),1===b.length?a.isSingleEntitySelected(!0):a.isSingleEntitySelected(!1)}function K(a,b){c.utils.arrayForEach(a.rows(),function(a){a.entitykey()&&!a.isReadonly()?a.isSelected(b):a.isSelected(!1)})}return s.prototype.getSelectedEntities=function a(){return this.selectedEntities()},s.prototype.showJSModule=function a(b,c,d,e,f,g,h,i){var j={key:b,jsModuleName:e,jsModuleParams:f,type:"aggregate",entityKey:c,clientID:d,data:g,cellIndex:h,rowIndex:i,fieldKey:g.columnFieldKey};this.jsModuleHelper.showJSModule(this,j)},s.prototype.callOnFocus=function a(b,c,d,e){var f={key:b.key(),data:c,cellIndex:d,rowIndex:e,type:"aggregate",entityKey:b.entityKey(),clientID:b.clientid(),fieldKey:c.columnFieldKey};this.jsModuleHelper.callOnFocus(this,f,b)},s});
define('platform/datasheets/aggregate-datasheet-manager',['require','jquery','./layout/ui/aggregate-datasheet-view-model','application/application-context','spa/region','../entity/entity-factory','text!./layout/ui/views/spinner.html','system/lang/event','./error-dialog/ui/error-dialog-view-model','system/ui/dialog-view-model','./layout/ui/datasheet-history-view-model','system/ui/message-box','system/ui/unsaved-changes-message-box','system/globalization/translator','application/application-events','system/error/error-message'],function(require){"use strict";var a=require("jquery"),b=require("./layout/ui/aggregate-datasheet-view-model"),c=require("application/application-context"),d=require("spa/region"),e=require("../entity/entity-factory"),f=require("text!./layout/ui/views/spinner.html"),g=require("system/lang/event"),h=require("./error-dialog/ui/error-dialog-view-model"),i=require("system/ui/dialog-view-model"),j=require("./layout/ui/datasheet-history-view-model"),k=require("system/ui/message-box"),l=require("system/ui/unsaved-changes-message-box"),m=require("system/globalization/translator"),n=require("application/application-events"),o=require("system/error/error-message");function p(a){this.defaultConfig={functionsavailable:["select","save","delete"],readonly:!1},this.translator=Object.resolve(m),this.containerEl=a.containerel,this.aggregateObject=a.aggregateobject,this.disableNonInputColumns=a.disablenoninputcolumns,this.entityFactory=new e,this.appEvents=Object.resolve(n),
this.entitySaved=new g,this.beforeEntitiesSaved=new g,this.entityModified=new g,this.entityDeleted=new g,this.beforeEntitiesDelete=new g,this.entityCreated=new g,this.unlinkEntities=new g,this.sequenceNumber=1,this.window=window,this.siteKey=void 0}p.prototype.translate=function a(b){return this.translator.translate(b)},p.prototype.load=function e(f){var g=this,h=a.Deferred(),i,j;return g.showSpinner(),i=g.getEntityPromise(),f&&(g.setConfig(f),g.siteKey=g.config.sitekey),i.done(function(a){if(g.cachedEntity&&(a=g.cachedEntity),0===a.length)return h.reject(),g.layout=Object.resolve(b),g.region=new d,g.region.setElement(g.containerEl),g.layout.attach(g.region),g.clearSpinner(),void g.layout.noData(!0);g.entity=a;for(var e=1,f=0;f<a.length;f++)for(var i=0;i<a[f].length;i++)g.attachEntityEventListeners(a[f][i]),g.entity[f][i].clientid=e++,0===a[f][i].key&&void 0!==g.siteKey?g.entity[f][i].siteKey=g.siteKey:0===a[f][i].key&&void 0===g.siteKey&&(g.entity[f][i].siteKey=c.user.defaultSiteKey)
;j=g.renderDatasheet(a),j.done(function(a){g.clearSpinner(),h.resolve(g.entity),g.layout.assignFieldValues(a)}).fail(function(){g.clearSpinner(),g.throwException(g.translate("DS_RENDER_DATASHEET_FAIL_EXCEPTION")),h.reject()})}).fail(function(){g.clearSpinner(),g.throwException(g.translate("DS_LOAD_ENTITY_FAIL_EXCEPTION")),h.reject()}),h},p.prototype.reload=function a(b){var c=this;return b&&(c.aggregateObject=b),c.load()},p.prototype.getEntityPromise=function a(){return this.loadEntity()},p.prototype.loadEntity=function b(){var c=a.Deferred(),d=this;return"query"===z(d.aggregateObject)?d.entityFactory.getAggregatedEntities(d.aggregateObject).done(function(a){c.resolve(a)}).fail(function(a){d.clearSpinner(),d.throwException(a),c.reject()}):d.entityFactory.getAggregateEntitiesForCompositeObj(d.aggregateObject).done(function(a){c.resolve(a)}).fail(function(a){d.clearSpinner(),d.throwException(a),c.reject()}),c.promise()},p.prototype.setConfig=function b(c){var d=this;d.config=c||{},
d.config=y(d.config),a.extend(d.defaultConfig,d.config),d.config=d.defaultConfig},p.prototype.updateState=function a(b){b&&(this.cachedEntity=b)},p.prototype.getState=function a(){var b,c;for(b=0;b<this.entity.length;b++)for(c=0;c<this.entity[b].length;c++)this.detachEntityEventListeners(this.entity[b][c]);return this.cachedEntity},p.prototype.renderDatasheet=function a(b){return q(this,b)},p.prototype.attachEntityEventListeners=function a(b){var c=this;b.entityModified.add(c.onEntityChanged,c)},p.prototype.detachEntityEventListeners=function a(b){var c=this;b.entityModified&&b.entityModified.remove(c)},p.prototype.attachLayoutEventListeners=function a(){var b=this;b.layout.datasheetSaved.add(u.bind(null,b)),b.layout.datasheetDelete.add(v.bind(null,b))},p.prototype.throwException=function a(b){var c=new o(1,b,"platform/datasheets/aggregate-datasheet-manager.js");this.appEvents.errorOccured.raise(this,c)};function q(c,e){var f=a.Deferred(),g=[];c.layout=Object.resolve(b),c.region=new d,
c.attachLayoutEventListeners(),c.layout.fieldValueChanged.add(t.bind(null,c)),c.region.setElement(c.containerEl),c.layout.attach(c.region);for(var h=0;h<e.length;h++){for(var i=[],j=0;j<e[h].length;j++)i.push({entitykey:e[h][j].key,clientid:c.sequenceNumber++,fields:r(c,e[h][j]),sitekey:e[h][j].siteKey});g.push(i)}return c.layout.showDatasheet(g).done(function(b){if(c.config.functionsavailable&&(a.inArray("select",c.config.functionsavailable)<0&&c.layout.isSelectAllAvailable(!1),a.inArray("save",c.config.functionsavailable)<0&&c.layout.isSaveAvailable(!1),a.inArray("delete",c.config.functionsavailable)<0&&c.layout.isDeleteAvailable(!1)),c.config.readonly){c.layout.isDatasheetReadOnly(!0),c.layout.canEdit(c.config.canedit);var d=0;0!==a(".datasheet-layout-container").find(".datasheet-nav").length&&(d+=80),c.layout.overlayTop(d+"px")}else c.layout.isDatasheetReadOnly(!1);f.resolve(b)}).fail(function(){c.clearSpinner(),f.reject()}),f}function r(a,b){
for(var c=b.fields.models.length,d=[],e=0;e<c;e++)d.push({fieldKey:b.fields.models[e].get("key"),fieldId:b.fields.models[e].get("id"),fieldCaption:b.fields.models[e].get("caption"),fieldDataType:b.fields.models[e].get("dataType"),fieldValue:b.fields.models[e].get("value"),fieldDisplayValue:b.fields.models[e].get("displayValue"),options:{required:b.fields.models[e].get("isRequired"),disabled:s(a,b.key,b.fields.models[e].get("id"),b.fields.models[e].get("isDisabled")),unitOfMeasure:b.fields.models[e].get("unitOfMeasure"),picklist:b.fields.models[e].get("pickList"),backColor:b.fields.models[e].get("backColor"),jsModuleName:b.fields.models[e].get("jsModuleName"),jsModuleParams:b.fields.models[e].get("jsModuleParams"),popJSModuleOnFocus:b.fields.models[e].get("popJSModuleOnFocus"),addParseValueParam:b.fields.models[e].get("addParseValueParam"),dependentFields:b.fields.models[e].get("dependentFields"),isPicklistRestricted:b.fields.models[e].get("isPicklistRestricted"),
maxNumberOfValues:b.fields.models[e].get("maxNumberOfValues"),values:b.fields.models[e].get("values"),format:b.fields.models[e].get("format")}});return d}function s(a,b,c,d){return void 0!==a.disableNonInputColumns&&"true"===a.disableNonInputColumns.toString()&&"0"!==b.toString()||d}function t(a,b,c,d,e,f,g){for(var h=!0,i,j=0;j<a.entity.length;j++)for(var k=0;k<a.entity[j].length;k++){if("0"===a.entity[j][k].key.toString()&&"0"===b.toString()&&a.entity[j][k].clientid===f){i=a.entity[j][k];break}if("0"!==b.toString()&&a.entity[j][k].key.toString()===b.toString()){i=a.entity[j][k];break}}g?a.entityFactory.updateFieldByKey(i,c,d,g):a.entityFactory.updateFieldValue(i,c,d,e,h)}p.prototype.onEntityChanged=function b(c,d,e,f){var g,h,i,j=this,k;k=e?d.dependentFields:null;var l=f?d.value:d.displayValue;if(j.layout&&(g=j.getEntityStatus(c,j),
j.layout.updateFieldValue(c,d.key,d.value,d.values,l,d.pickList,d.isDisabled,d.isRequired,d.errorMessage,d.backColor,d.maxNumberOfValues,k,d.jsModuleName,d.jsModuleParams,d.popJSModuleOnFocus,d.addParseValueParam,!0)),j.cachedEntity){for(h=0;h<j.cachedEntity.length;h++)for(i=0;i<j.cachedEntity[h].length;i++)if((void 0===j.cachedEntity[h][i].clientid||0!==c.key)&&c.key.toString()===j.cachedEntity[h][i].key.toString()||j.cachedEntity[h][i].clientid&&j.cachedEntity[h][i].clientid===c.clientid){j.cachedEntity[h][i]=a.extend(!0,c,j.cachedEntity[h][i]);break}}else for(j.cachedEntity=j.entity,h=0;h<j.cachedEntity.length;h++)for(i=0;i<j.cachedEntity[h].length;i++)if(j.cachedEntity[h][i].clientid&&j.cachedEntity[h][i].clientid===c.clientid||(void 0===j.cachedEntity[h][i].clientid||0!==c.key)&&c.key.toString()===j.cachedEntity[h][i].key.toString()){j.cachedEntity[h][i]=c;break}j.entityModified.raise(d,e,c)};function u(a,b,c){var d=[],e=0,f=0,g=!1;d=a.getEntitiesToBeSaved(b),d.done(function(b){
var d={entity:b,datasheetSaveDfd:c};a.beforeEntitiesSaved.raise(d)})}function v(a,b){var c=[];k.showYesNo(a.translate("DS_DELETE_SELECTED_ENTITIES_MESSAGE"),a.translate("CONFIRM_REC_DEL")).done(function(d){if(0===d){for(var e=0;e<a.entity.length;e++)for(var f=0;f<a.entity[e].length;f++)for(var g=0;g<b.length;g++)a.entity[e][f].key==b[g]&&c.push(a.entity[e][f].key);a.beforeEntitiesDelete.raise(c)}})}p.prototype.unload=function b(){var c=this,d=a.Deferred(),e=c.entityFactory.checkIfCompositeEntitiesDirty(c.entity);return e.done(function(){c.layout&&c.layout.detach(c.region),d.resolve()}),e.fail(function(){x().done(function(b){if(0===b)w(c,d);else if(1===b){var e=a.Deferred();u(c,c.entity,e),a.when(e).done(w.bind(null,c,d))}}).fail(function(){d.reject()})}),d};function w(a,b){a.layout&&(a.layout.detach(a.region),b.resolve())}p.prototype.setTitle=function a(b){var c=this;c.layout&&c.layout.setTitle(b)},p.prototype.showSpinner=function a(){this.containerEl.append(f)},
p.prototype.clearSpinner=function a(){this.containerEl.find(".load-spinner").remove()},p.prototype.getEntitiesToBeSaved=function b(c){var d=this,e,f,g=[],h=0,i=a.Deferred();for(e=0;e<c.length;e++)for(f=0;f<c[e].length;f++){d.entity[e][f].clientid=c[e][f].clientid,h++;var j=d.getEntityStatus(d.entity[e][f],d);j.done(function(a,b){h--,"dirty"!==a&&"new-dirty"!==a||g.push(b),h||i.resolve(g)}).fail(function(){--h||i.resolve(g)})}return i},p.prototype.getEntityStatus=function b(c,d){var e=a.Deferred(),f=d.entityFactory.checkIfEntityDirty(c);return f.fail(function(){d.entityFactory.checkIfEntityNew(c)?e.resolve("new-dirty",c):e.resolve("dirty",c)}),f.done(function(){d.entityFactory.checkIfEntityNew(c)?e.reject("new-clean",c):e.reject("clean",c)}),e},p.prototype.displayError=function a(b){var c,d,e=0,f=0,g=[];for(e=0;e<b.entity.length;e++)for(f=0;f<b.entity[e].length;f++)""!==b.entity[e][f].errorMessage&&g.push({id:b.entity[e][f].id,errorMessage:b.entity[e][f].errorMessage});c=new h(g),
d=new i(c,b.translate("DS_ERROR_REPORT")),c.closeDialog.add(function(){d.closeDialog()}),d.show()};function x(){return k.showUnsavedChanges()}function y(b){var c={};return a.each(b,function(a,b){c[a.toLowerCase()]=b}),c}function z(a){return"string"==typeof a||a instanceof String?"query":"compositeObject"}return p});
define('platform/datasheets/datasheet',['require','jquery','./forms-datasheet-manager','./bulk-datasheet-manager','./master-detail-datasheet-manager','./aggregate-datasheet-manager','system/lang/event','../entity/entity-factory','system/globalization/translator','application/application-events','system/error/error-message'],function(require){"use strict";var a=require("jquery"),b=require("./forms-datasheet-manager"),c=require("./bulk-datasheet-manager"),d=require("./master-detail-datasheet-manager"),e=require("./aggregate-datasheet-manager"),f=require("system/lang/event"),g=require("../entity/entity-factory"),h=require("system/globalization/translator"),i=require("application/application-events"),j=require("system/error/error-message");function k(a){if(a=a||{},a=B(a),this.options=a,this.translator=Object.resolve(h),this.appEvents=Object.resolve(i),a.containerel||this.throwException(this.translate("DS_CONTAINER_UNDEFINED_EXCEPTION")),this.entityObj=a.entityobj,this.catalogItemPath=a.catalogitempath,this.aggregateObject=a.aggregateobject,this.entitySaved=new f,this.entityModified=new f,this.entityDeleted=new f,this.entityCreated=new f,this.entitySelected=new f,this.onMasterDetail=new f,this.beforeEntitiesSave=new f,this.beforeEntitiesDelete=new f,this.entityFactory=new g,
void 0!==this.aggregateObject)this.datasheetManager=new e(a);else switch(this.resolveDatasheetType()){case"forms":this.datasheetManager=new b(a);break;case"bulk":this.datasheetManager=new c(a)}this.window=window,this.switchDatasheetManager=new f,this.onMasterDatasheetLoaded=new f,this.newDatasheet=new f,this.fieldTouched=new f,this.entityIdChanged=new f,this.savingFromUnsavedChangesDialog=!1,this.datasheetSaveDfd=null}k.prototype.load=function b(c){var d=this,e=a.Deferred();return d.attachEventListeners(),d.config=c,d.datasheetManager.load(c).done(function(a){d.entity=a,e.resolve()}).fail(function(){e.reject()}),e},k.prototype.translate=function a(b){return this.translator.translate(b)},k.prototype.throwException=function a(b){var c=new j(1,b,"platform/datasheets/datasheet.js");this.appEvents.errorOccured.raise(this,c)},k.prototype.unload=function a(b){return this.datasheetManager.unload(b)},k.prototype.getState=function a(){return this.datasheetManager.getState()},
k.prototype.removeDOMElements=function a(b){return this.datasheetManager.removeDOMElements(b)},k.prototype.updateState=function a(b){return b&&(this.cachedEntity=b,b.length||!b.master&&null!==b.master||(b=b.master)),this.datasheetManager.updateState(b)},k.prototype.getRefDocState=function a(){return this.datasheetManager.getRefDocState()},k.prototype.updateRefDocState=function a(b){this.datasheetManager.updateRefDocState(b)},k.prototype.getRefDocDatasheet=function a(){return!!(this.datasheetManager.layout&&this.datasheetManager.layout.refdocEl&&this.datasheetManager.layout.refdocEl.datasheet)&&this.datasheetManager.layout.refdocEl.datasheet},k.prototype.getUserFamilyPrivileges=function a(){return this.datasheetManager.getUserFamilyPrivileges()},k.prototype.toggleHelpText=function a(){this.datasheetManager.layout.toggleHelpText()},k.prototype.setTitle=function a(b){this.datasheetManager.setTitle(b)},k.prototype.repaint=function a(){
this.datasheetManager&&this.datasheetManager.repaint&&this.datasheetManager.repaint(this)},k.prototype.getDatasheetType=function a(){var b=this.resolveDatasheetType();return"bulk"===b?b:"forms"===b?this.datasheetManager.layout.isMasterDatasheet()?"master":"forms":void 0},k.prototype.attachEventListeners=function a(){var b=this;b.datasheetManager.beforeEntitiesSaved&&b.datasheetManager.beforeEntitiesSaved.add(n.bind(null,this)),b.datasheetManager.entitySaved.add(p.bind(null,this)),b.datasheetManager.entityModified.add(q.bind(null,this)),b.datasheetManager.entitySelected&&b.datasheetManager.entitySelected.add(t.bind(null,this)),b.datasheetManager.entityCreated.add(r.bind(null,this)),b.datasheetManager.beforeEntitiesDelete&&b.datasheetManager.beforeEntitiesDelete.add(o.bind(null,this)),b.datasheetManager.entityDeleted.add(s.bind(null,this)),b.datasheetManager.onMasterDetail&&b.datasheetManager.onMasterDetail.add(x.bind(null,this)),
b.datasheetManager.onFormsDatasheet&&b.datasheetManager.onFormsDatasheet.add(A.bind(null,this)),b.datasheetManager.onNewMasterDetail&&b.datasheetManager.onNewMasterDetail.add(x.bind(null,this)),b.datasheetManager.newDatasheet&&b.datasheetManager.newDatasheet.add(C.bind(null,b)),b.datasheetManager.fieldTouched&&b.datasheetManager.fieldTouched.add(D.bind(null,b)),b.datasheetManager.entityIdChanged&&b.datasheetManager.entityIdChanged.add(v.bind(null,b)),b.datasheetManager.savingFromUnsavedChangesDialog&&b.datasheetManager.savingFromUnsavedChangesDialog.add(w.bind(null,b))},k.prototype.tabSwitched=function a(){var b=this;if(b.datasheetManager.tabSwitched)return b.datasheetManager.tabSwitched()},k.prototype.resolveDatasheetType=function b(){return a.isArray(this.entityObj)||this.catalogItemPath?"bulk":"forms"},k.prototype.handleDatasheetSave=function b(){var c=this,d=a.Deferred();return c.datasheetManager.onDatasheetSaved().done(l.bind(null,d)).fail(m.bind(null,d)),d};function l(a){
a.resolve()}function m(a){a.reject()}function n(a,b){a.datasheetSaveDfd=b.datasheetSaveDfd,a.beforeEntitiesSave.raise(b)}function o(a,b){a.beforeEntitiesDelete.raise(b)}function p(a,b){a.entitySaved.raise(b)}function q(a,b,c,d){a.entityModified.raise(b,c,d)}function r(a,b){a.entityCreated.raise(b)}function s(a,b){a.entityDeleted.raise(b)}function t(a,b){a.entitySelected.raise(b)}function u(a){a.tabSwitched.raise()}function v(a,b){a.entityIdChanged.raise(b)}function w(a){a.savingFromUnsavedChangesDialog=!0}function x(a,b,c,e,f,g){var h=a.datasheetManager.canUpdateRefDocView,i;h&&(i=a.datasheetManager.refDocs),a.datasheetManager.layout&&(a.datasheetManager.detachEntityEventHandlers(),a.datasheetManager.layout.deallocateMem()),a.datasheetManager=new d(a.options,b,c,e,f,g),a.cachedEntity&&a.datasheetManager.updateState(a.cachedEntity),a.datasheetManager.canUpdateRefDocView=h,a.datasheetManager.refDocs=i,a.datasheetManager.onFormsDatasheet.add(A.bind(null,a)),
a.datasheetManager.onNewMasterDetail.add(x.bind(null,a)),a.datasheetManager.onMasterDetailDatasheetSaved.add(y.bind(null,a)),a.datasheetManager.onMasterDetailDatasheetNew.add(z.bind(null,a)),a.datasheetManager.onMasterDatasheetLoaded.add(function(){a.onMasterDatasheetLoaded.raise()}),a.datasheetManager.load(a.config),a.switchDatasheetManager.raise(),a.datasheetManager.newDatasheet.add(C.bind(null,a)),a.datasheetManager.entityDeleted.add(s.bind(null,a)),a.datasheetManager.entityModified.add(q.bind(null,a)),a.datasheetManager.entityIdChanged&&a.datasheetManager.entityIdChanged.add(v.bind(null,a))}function y(a,b){a.entitySaved.raise(b)}function z(a,b){a.entityCreated.raise(b)}function A(c,d,e,f,g){var h={currentDatasheetKey:d,dto:e,datasheetKeys:f};a.extend(h,c.options),c.datasheetManager.layout&&c.datasheetManager.layout.deallocateMem(),c.datasheetManager=new b(h),c.datasheetManager.onMasterDetail.add(x.bind(null,c)),c.datasheetManager.entitySaved.add(p.bind(null,c)),
c.datasheetManager.changeDatasheet(g,c.config),c.switchDatasheetManager.raise(),c.datasheetManager.newDatasheet.add(C.bind(null,c)),c.datasheetManager.entityDeleted.add(s.bind(null,c)),c.datasheetManager.entityModified.add(q.bind(null,c)),c.datasheetManager.entityIdChanged&&c.datasheetManager.entityIdChanged.add(v.bind(null,c))}function B(b){var c={};return a.each(b,function(a,b){c[a.toLowerCase()]=b}),c}function C(a,b){a.newDatasheet.raise(b)}function D(a,b){a.fieldTouched.raise(b)}return k});
define('strategy/recommendations/models/recommendation-raw-dto',['require','system/globalization/translator','system/text/formatter','system/lang/converter'],function(require){"use strict";var a=require("system/globalization/translator"),b=require("system/text/formatter"),c=require("system/lang/converter");function d(a){this.ID=c.toString(a.id),this.FamilyID=c.toString(a.familyID),this.State=c.toString(a.state),this.StateAssignedUser=a.stateAssignedUser||null,this.Headline=c.toString(a.headline),this.Key=c.toString(a.key),this.AuthorName=a.authorName||null,this.LastUpdatedDate=c.toDate(a.lastUpdatedDate),this.LastUpdatedBy=c.toString(a.lastUpdatedBy),this.AssetId=c.toString(a.assetDescription),this.EquipmentId=c.toString(this.AssetId),this.Interval=a.interval||null,this.StrategyID=c.toString(a.strategyID),this.StrategyKey=c.toString(a.strategyKey),this.AssetKey=c.toString(a.assetKey),this.IDUrl=f(this),this.descriptionHTML=h(this),this.PerformanceRecType=g(this),this.strategyIDUrl=e(this),this.damageMechanism=c.toString(a.damageMechanism),this.nonRecurring=c.toBoolean(a.nonRecurring),
this.targetCompletionDate=c.toDate(a.targetCompletionDate),this.taskType=c.toString(a.taskType)}d.fromDataCollection=function a(b){var c,e=[];for(c=0;c<b.length;c++)e[c]=new d(b[c]);return e};function e(a){return"<a data-id='strategy' data-stratkey='"+a.StrategyKey+"' data-assetkey='"+a.AssetKey+"'>"+a.StrategyID+"</a>"}function f(a){return"<a data-key='"+a.Key+"'>"+c.toString(a.ID)+"</a>"}function g(b){var c=Object.resolve(a),d="";switch(b.FamilyID){case"MI_RECCLBN":d=c.translate("CALIBRATION");break;case"MI_GENRECOM":d=c.translate("GENERAL");break;case"MI_POLRECOM":d=c.translate("POLICY");break;case"MI_OPR_REC":d=c.translate("OPR");break;case"MI_RECINSP":d=c.translate("INSPECTION");break;case"MI RCA Recommendation":d=c.translate("RCA");break;case"MI Reliability Recommendation":d=c.translate("RELIABILITY");break;case"MI_APTAGREC":d=c.translate("AMS")}return d}function h(c){var d=Object.resolve(b),e=Object.resolve(a)
;return'<div class="block-group list-sizing"><div class="block recommendation-list list-group-item ;"><div class="block rec-details"><span class="rec-details-headline item-semi-bold">'+c.Headline+'</span><span class="rec-details-headline">'+c.AssetId+"</span><span>"+e.translate("UPDATED_BY")+":&nbsp"+c.LastUpdatedBy+"&nbsp;"+e.translate("ON")+"&nbsp;"+d.format(c.LastUpdatedDate,Date.Formats.LongDate)+'</span></div><div class="block item-status-position"><span class="status-text-warning">'+c.State+"</span></div></div></div>"}return d});
define('strategy/recommendations/models/paged-recommendation-dto',['require','./recommendation-raw-dto'],function(require){"use strict";var a=require("./recommendation-raw-dto");function b(b){this.PageSize=void 0===b.paging?0:b.paging.page,this.PerPage=void 0===b.paging?0:b.paging.per_page,this.Total=void 0===b.paging?0:b.paging.total,this.Recommendations=void 0===b.data?void 0:a.fromDataCollection(b.data)}return b});
define('ui/elements/risk-matrix/models/risk-rank-dto',['require','system/lang/converter'],function(require){"use strict";var a=require("system/lang/converter");function b(b){b=b||{},this.key=a.toString(b.key),this.categoryName=a.toString(b.categoryName),this.consequence=a.toNullableFloat(b.consequence),this.maintenanceCost=a.toNullableFloat(b.maintenanceCost),this.productionLoss=a.toNullableFloat(b.productionLoss),this.probability=a.toNullableFloat(b.probability),this.protectionLevel=a.toNullableFloat(b.protectionLevel),this.rank=a.toNullableFloat(b.rank),this.index=a.toNullableFloat(b.index),this.weight=a.toNullableFloat(b.weight),this.notApplicable=a.toNullableBoolean(b.notApplicable),this.isFinancial=a.toNullableBoolean(b.isFinancial),this.financialImpact=a.toNullableFloat(b.financialImpact),this.riskRankAlias=a.toString(" - "===b.riskRankAlias?null:b.riskRankAlias),this.probabilities=b.probabilities||[]}return b.fromDataCollection=function a(c){var d,e=[];if(c)for(d=0;d<c.length;d++)e[d]=new b(c[d]);return e},b.isEqual=function a(b,c){
var d,e,f=["key","categoryName","consequence","maintenanceCost","productionLoss","financialImpact","probability","protectionLevel","rank","index","weight","notApplicable","isFinancial","riskRankAlias"];for(d=0;d<f.length;d++)if(b[f[d]]!==c[f[d]])return!1;return!0},b});
define('ui/elements/risk-matrix/models/risk-assessment-dto',['require','system/lang/converter','ui/elements/risk-matrix/models/risk-rank-dto'],function(require){"use strict";var a=require("system/lang/converter"),b=require("ui/elements/risk-matrix/models/risk-rank-dto");function c(c){c=c||{},this.key=a.toString(c.key),this.riskMatrixKey=a.toString(c.riskMatrixKey),this.siteKey=a.toString(c.siteKey),this.globalID=a.toString(c.globalID),this.familyID=a.toString(c.familyID),this.financialRiskRank=a.toFloat(c.financialRiskRank),this.riskRank=a.toFloat(c.riskRank),this.drivingRiskRank=a.toFloat(c.drivingRiskRank),this.riskRankAlias=a.toString(c.riskRankAlias),this.riskThreshold=a.toString(c.riskThreshold),this.riskThresholdAlias=a.toString(c.riskThresholdAlias),this.drivingRiskCategory=a.toString(c.drivingRiskCategory),this.drivingRiskAlias=a.toString(c.drivingRiskAlias),this.drivingRiskThreshold=a.toString(c.drivingRiskThreshold),this.drivingRiskThresholdAlias=a.toString(c.drivingRiskThresholdAlias),this.basisForAssessment=a.toString(c.basisForAssessment),this.risks=b.fromDataCollection(c.risks)}
return c.fromDataCollection=function a(b){var d,e=[];if(b)for(d=0;d<b.length;d++)e[d]=new c(b[d]);return e},c.isEqual=function a(c,d){var e,f,g,h=["key","riskMatrixKey","globalID","familyID","financialRiskRank","riskRank","drivingRiskRank","riskRankAlias","riskThreshold","riskThresholdAlias","drivingRiskCategory","drivingRiskAlias","drivingRiskThreshold","drivingRiskThresholdAlias","basisForAssessment"];for(e=0;e<h.length;e++)if(c[h[e]]!==d[h[e]])return!1;if(c.risks.length!==d.risks.length)return!1;for(e=0;e<c.risks.length;e++)for(g=c.risks[e].index,f=0;f<d.risks.length;f++)if(g===d.risks[f].index&&!b.isEqual(c.risks[e],d.risks[f]))return!1;return!0},c});
define('strategy/recommendations/models/recommendation-dto',['require','system/lang/converter','ui/elements/risk-matrix/models/risk-assessment-dto','state-management/model/operation-model','system/text/formatter','globalize','system/globalization/translator'],function(require){"use strict";var a=require("system/lang/converter"),b=require("ui/elements/risk-matrix/models/risk-assessment-dto"),c=require("state-management/model/operation-model"),d=require("system/text/formatter"),e=require("globalize"),f=require("system/globalization/translator"),g;function h(e){switch(this.formatter=Object.resolve(d),this.translator=Object.resolve(f),this.ID=a.toString(e.id),this.Description=a.toString(e.description),this.Key=a.toString(e.key),this.ParentKey=a.toString(e.parentKey),this.FamilyID=a.toString(e.familyID),this.Type=a.toString(e.type),this.State=a.toString(e.state),this.StateId=a.toString(e.stateId),this.Headline=a.toString(e.headline),this.url="#"+this.Key,this.IDUrl="<a data-key='"+this.Key+"'>"+a.toString(e.id)+"</a>",this.HasTargetRecommendations=a.toBoolean(e.hasTargetRecommendations),this.AnalysisKey=a.toString(e.analysisKey),this.AssetId=a.toString(e.assetDescription),this.EquipmentId=a.toString(e.assetId),
this.ActionId=a.toString(e.actionId),this.Basis=a.toString(e.basis),this.PriorityId=a.toString(e.priority),this.PriorityColor=a.toString(e.priorityColor),this.BusinessImpact=a.toString(e.businessImpact),this.LastUpdatedBy=a.toString(e.lastUpdatedBy),this.LastUpdatedDate=a.toDate(e.lastUpdatedDate),this.StrategyID=a.toString(e.strategyID),this.AssetKey=a.toString(e.assetKey),this.strategyurl="#"+this.AssetKey,this.Interval=e.interval||null,this.AuthorName=e.authorName||null,this.StateAssignedUser=e.stateAssignedUser||null,this.PerformanceRecType="",this.FamilyID){case"MI_RECCLBN":this.PerformanceRecType=this.translator.translate("CALIBRATION");break;case"MI_GENRECOM":this.PerformanceRecType=this.translator.translate("GENERAL");break;case"MI_POLRECOM":this.PerformanceRecType=this.translator.translate("POLICY");break;case"MI_OPR_REC":this.PerformanceRecType=this.translator.translate("OPR");break;case"MI_RECINSP":this.PerformanceRecType=this.translator.translate("INSPECTION");break
;case"MI RCA Recommendation":this.PerformanceRecType=this.translator.translate("RCA");break;case"MI Reliability Recommendation":this.PerformanceRecType=this.translator.translate("RELIABILITY");break;case"MI_APTAGREC":this.PerformanceRecType=this.translator.translate("AMS")}if(this.strategyIDUrl="<a data-id='strategy' data-key='"+this.AssetKey+"'>"+this.StrategyID+"</a>",this.Selected=!1,this.hasLinkedAction=!1,void 0!==e.actionId&&""!==e.actionId&&(this.hasLinkedAction=!0),this.TargetRecommendationsUrl="<a data-id='target' data-key='"+this.Key+"'></a>",this.Entity=e.entity,this.RiskAssessment=void 0===e.riskAssessment?void 0:new b(e.riskAssessment),this.LinkedRecommendations=void 0===e.supersededRecommendations?[]:h.fromDataCollection(e.supersededRecommendations),void 0!==e.consolidatedRecommendations)for(g=0;g<e.consolidatedRecommendations.length;g++)this.LinkedRecommendations.push(new h(e.consolidatedRecommendations[g]))
;this.TargetRecommendation=void 0===e.targetRecommendation?void 0:new h(e.targetRecommendation),void 0!==e.targetRecommendation&&this.LinkedRecommendations.push(new h(e.targetRecommendation)),this.Operations=void 0===e.operations?[]:c.fromDataCollection(e.operations),this.descriptionHTML='<div class="block-group list-sizing"><div class="block recommendation-list list-group-item '+this.PriorityColor+';"><div class="block rec-details"><span class="rec-details-headline item-semi-bold">'+this.Headline+'</span><span class="rec-details-headline">'+this.AssetId+"</span><span>"+this.translator.translate("UPDATED_BY")+":&nbsp"+this.LastUpdatedBy+"&nbsp;"+this.translator.translate("ON")+"&nbsp;"+this.formatter.format(this.LastUpdatedDate,Date.Formats.LongDate)+'</span></div><div class="block item-status-position"><span class="status-text-warning">'+this.State+"</span></div></div></div>",this.consolidatedRecommendationsCount=e.consolidatedRecommendationsCount||null,
this.supersededRecommendationsCount=e.supersededRecommendationsCount||null}return h.fromDataCollection=function a(b){var c,d=[];for(c=0;c<b.length;c++)d[c]=new h(b[c]);return d},h});
define('strategy/recommendations/models/recommendation-security-config-dto',['require','system/lang/converter'],function(require){"use strict";var a=require("system/lang/converter");function b(b){this.canCreateRecommendation=a.toString(b.canCreateRecommendation),this.canEditRecommendation=a.toString(b.canEditRecommendation),this.canDeleteRecommendation=a.toString(b.canDeleteRecommendation),this.canConsolidateRecommendation=a.toString(b.canConsolidateRecommendation),this.canSupersedeRecommendation=a.toString(b.canSupersedeRecommendation)}return b.fromDataCollection=function a(c){var d,e=[];for(d=0;d<c.length;d++)e[d]=new b(c[d]);return e},b});
define('strategy/recommendations/services/recommendation-service',['require','jquery','system/http/ajax-client','../models/paged-recommendation-dto','../models/recommendation-dto','platform/metadata/models/family-metadata','../models/recommendation-security-config-dto','ramda'],function(require){"use strict";var a=require("jquery"),b=require("system/http/ajax-client"),c=require("../models/paged-recommendation-dto"),d=require("../models/recommendation-dto"),e="api/internal/recommendations",f="api/internal/recommendations/metadata",g="api/core/metadata/entityfamily",h=require("platform/metadata/models/family-metadata"),i=require("../models/recommendation-security-config-dto"),j="api/internal/recommendations/securityconfiguration",k="api/core/relationship",l=require("ramda"),m=null;function n(a){this.ajaxClient=a}n.dependsOn=[b],n.prototype.getFamilyKey=function b(c){var d=a.Deferred();return this.ajaxClient.get(f+"/"+c).done(function(a){d.resolve(a)}).fail(function(a){d.reject(a)}),d.promise()},n.prototype.getRecommendationFamilyByKey=function b(c){var d=a.Deferred();return this.ajaxClient.get(g+"/"+c).done(function(a){d.resolve(new h(a))}).fail(function(a){d.reject(a)}),d.promise()},n.prototype.getFamilyStates=function b(c){var d=a.Deferred()
;return this.ajaxClient.get(f+"/states/"+c).done(function(a){d.resolve(a)}).fail(function(a){d.reject(a)}),d.promise()},n.prototype.getMultipleFamilyStates=function b(c){var d=a.Deferred();return this.ajaxClient.get(f+"/states/multiple/"+c).done(function(a){d.resolve(a)}).fail(function(a){d.reject(a)}),d.promise()},n.prototype.createRelationship=function b(c,d,e){var f=a.Deferred();return this.ajaxClient.post(k+"/"+c+"/predecessorKey/"+d+"/successorKey/"+e).done(function(a){f.resolve(a)}).fail(function(a){f.reject(a)}),f.promise()},n.prototype.getRecommendation=function b(c){var f=a.Deferred();return this.ajaxClient.get(e+"/"+c).done(function(a){f.resolve(new d(a))}).fail(function(a){f.reject(a)}),f.promise()},n.prototype.getRecommendationFilter=function b(c){var d=a.Deferred();return this.ajaxClient.get(e+"/filterdata").done(function(a){d.resolve(a)}).fail(function(a){d.reject(a)}),d.promise()},n.prototype.postRecommendation=function b(c){var f=a.Deferred()
;return this.ajaxClient.post(e,c).done(function(a){f.resolve(new d(a))}).fail(function(a){f.reject(a)}),f.promise()},n.prototype.createRecommendation=function b(c){var f=a.Deferred();return this.ajaxClient.post(e+"/create",c).done(function(a){f.resolve(new d(a))}).fail(function(a){f.reject(a)}),f.promise()},n.prototype.putRecommendation=function b(c){var f=a.Deferred();return this.ajaxClient.put(e+"/"+c.Key,c).done(function(a){f.resolve(new d(a))}).fail(function(a){f.reject(a)}),f.promise()},n.prototype.deleteRecommendation=function b(c){var d=a.Deferred();return this.ajaxClient.delete(e+"/"+c).done(function(a){d.resolve(a)}).fail(function(a){d.reject(a)}),d.promise()},n.prototype.deleteRecommendations=function b(c){var d=a.Deferred();return this.ajaxClient.put(e+"/bulkdelete",c).done(function(a){d.resolve(a)}).fail(function(a){d.reject(a)}),d.promise()},n.prototype.getRecommendationList=function b(d,f,g,h,i,j,k,l,m,n){var o=a.Deferred(),p=e+"/list";j||(j=""),f||(f=""),k||(k=""),
l||(l=""),null!==g&&void 0!==g||(g=!0),h||(h=-1),i||(i="");var q={isStrategicRec:g,parentKey:d,assetKey:h,familyId:f,perfRecTypes:i,state:j,sortOrder:k,searchText:l,page:m,pageSize:n};return this.ajaxClient.post(p,q).done(function(a){o.resolve(new c(a))}).fail(function(a){o.reject(a)}),o.promise()};function o(a){return!l.isNil(a)&&(!l.isNil(a.request)&&(!l.isNil(a.request.abort)&&"function"==typeof a.request.abort))}return n.prototype.getRecommendationList_abortPrevious=function(d,f,g,h,i,j,k,l,n,p){var q=a.Deferred(),r=e+"/list/";o(m)&&m.request.abort(),j||(j=""),f||(f=""),k||(k=""),l||(l=""),null!==g&&void 0!==g||(g=!0),h||(h=-1),i||(i="");var s={isStrategicRec:g,parentKey:d,assetKey:h,familyId:f,perfRecTypes:i,state:j,sortOrder:k,searchText:l,page:n,pageSize:p},t=this.ajaxClient.post(r,s).done(function(a){q.resolve(new c(a))}).fail(function(a){q.reject(a)});return m=b.promise(q,t)},n.prototype.getAllEquipmentID=function(b,c){var d=a.Deferred(),f=e+"/list/equipment",g={parentKey:b,
familyId:c};return this.ajaxClient.post(f,g).done(function(a){d.resolve(a)}).fail(function(a){d.reject(a)}),d.promise()},n.prototype.getRecommendations=function b(c){var f=a.Deferred();return this.ajaxClient.put(e,c).done(function(a){f.resolve(d.fromDataCollection(a))}).fail(function(a){f.reject(a)}),f.promise()},n.prototype.updateStateAssignments=function b(c,d,f){var g=a.Deferred(),h=e+"/assign/"+c+"/"+d;return this.ajaxClient.put(h,f).done(function(a){g.resolve(a)}).fail(function(a){g.reject(a)}),g.promise()},n.prototype.bulkUpdateStateAssignments=function b(c,d){var f=a.Deferred(),g=e+"/assign/bulk-state-assignments",h={stateAssignments:c,recommendationKeys:d};return this.ajaxClient.put(g,h).done(function(a){f.resolve(a)}).fail(function(a){f.reject(a)}),f.promise()},n.prototype.performSupersede=function b(c,d){var f=a.Deferred(),g=e+"/supersede/"+c;return this.ajaxClient.put(g,d).done(function(a){f.resolve(a)}).fail(function(a){f.reject(a)}),f.promise()},
n.prototype.GetConsolidationTarget=function b(c){var d=a.Deferred(),f=e+"/consolidatetarget";return this.ajaxClient.put(f,c).done(function(a){d.resolve(a)}).fail(function(a){d.reject(a)}),d.promise()},n.prototype.PerformConsolidate=function b(c,d){var f=a.Deferred(),g={TargetEntity:c,SourceKeys:d},h=e+"/consolidate";return this.ajaxClient.put(h,g).done(function(a){f.resolve(a)}).fail(function(a){f.reject(a)}),f.promise()},n.prototype.UnlinkRecommendations=function b(c){var d=a.Deferred(),f=e+"/unlink";return this.ajaxClient.put(f,c).done(function(a){d.resolve(a)}).fail(function(a){d.reject(a)}),d.promise()},n.prototype.AssignedUserRequired=function b(c,d){var f=a.Deferred(),g=e+"/requiresuser/"+c;return this.ajaxClient.put(g,d).done(function(a){f.resolve(a)}).fail(function(a){f.reject(a)}),f.promise()},n.prototype.PerformOperation=function b(c,d){var f=a.Deferred(),g=e+"/operation/"+c;return this.ajaxClient.put(g,d).done(function(a){f.resolve(a)}).fail(function(a){f.reject(a)}),
f.promise()},n.prototype.GetSecurityConfiguration=function b(c){var d=a.Deferred();return this.ajaxClient.get(j+"/"+c).done(function(a){d.resolve(new i(a))}).fail(function(a){d.reject(a)}),d.promise()},n.prototype.getSiteKey=function(b){var c=a.Deferred();return this.ajaxClient.get(e+"/sitekey/"+b).done(function(a){c.resolve(a)}).fail(function(a){c.reject(a)}),c.promise()},n});
define('ui/elements/risk-matrix/services/risk-assessment-service',['require','jquery','system/http/ajax-client','../models/risk-assessment-dto'],function(require){"use strict";var a=require("jquery"),b=require("system/http/ajax-client"),c=require("../models/risk-assessment-dto"),d="api/internal/risk/assessments";function e(a){this.ajaxClient=a}return e.dependsOn=[b],e.prototype.getDefaultRiskAssessment=function b(e){var f=a.Deferred();return this.ajaxClient.get(d+"/new/"+e).done(function(a){f.resolve(new c(a))}).fail(function(a){f.reject(a)}),f.promise()},e.prototype.getDefaultMitigatedRiskAssessment=function b(e){var f=a.Deferred();return this.ajaxClient.get(d+"/copy/"+e).done(function(a){f.resolve(new c(a))}).fail(function(a){f.reject(a)}),f.promise()},e.prototype.getRiskAssessment=function b(e){var f=a.Deferred();return this.ajaxClient.get(d+"/"+e).done(function(a){f.resolve(new c(a))}).fail(function(a){f.reject(a)}),f.promise()},e.prototype.insertRiskAssessment=function b(c){var e=a.Deferred();return this.ajaxClient.post(d,c).done(function(a){e.resolve(a)}).fail(function(a){e.reject(a)}),e.promise()},
e.prototype.updateRiskAssessment=function b(c){var e=a.Deferred(),f=d;return this.ajaxClient.put(f,c).done(function(a){e.resolve(a)}).fail(function(a){e.reject(a)}),e.promise()},e});
define('strategy/strategy-utility',['require','jquery','platform/metadata/services/metadata'],function(require){"use strict";var a=require("jquery"),b=require("platform/metadata/services/metadata");function c(){this.DATASHEET_VALUE="value",this.DATASHEET__DISPLAYVALUE="displayValue",this.TYPE="All",this.IS_NA="N/A",this.SPACE=" ",this.warningIcon="icon-node-warning",this.NEW_ENTITY_KEY="0",this.metadataService=b,this.RISK_ASSE_FAMILY_ID="MI_RISKASSE",this.ASI_LICENSE="ASM",this.ASI_FOR_SAP_LICENSE="SAP_Content_for_ASI"}return c.prototype.escapeRegex=function a(b){if(b)return String(b).replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")},c.singleton=!0,c.factory=function(){return new c},c.prototype.isRiskAssessmentReadonly=function(b){var c=a.Deferred();return this.metadataService.getEntityFamilyByid(this.RISK_ASSE_FAMILY_ID).done(function(a){var d=b.riskRankAlias||b.riskRank,e=!(a.canInsert||a.canUpdate&&d);c.resolve(e)}).fail(function(a){c.reject(a)}),c.promise()},c.prototype.getErrorMessageFromResponse=function(a,b){var c=b||""
;return a?(a.responseJSON&&a.responseJSON.message?c=a.responseJSON.message:a.responseJSON&&"string"==typeof a.responseJSON?c=a.responseJSON:a.responseText&&(c=a.responseText),c):c},c.prototype.getStatusIcon=function(a){switch(a){case"A":return"icon-ASM-added";case"M":return"icon-ASM-edited";case"D":return"icon-ASM-removed";default:return""}},c});
define('strategy/recommendations/recommendation-utility',['require','strategy/strategy-utility'],function(require){"use strict";var a=require("strategy/strategy-utility");function b(){this.REC_ID="MI_REC_ID",this.REC_RELATED_ASSET_ID="MI_REC_ASSET_ID_CHR",this.REC_ANALYSIS_KEY="MI_REC_ANALY_KEY_NBR",this.REC_TYPE_FIELD="MI_REC_TYPE_CHR",this.PENDING_STATE="MI_PENDING",this.CONSOLIDATED_STATE="MI_CONSOLIDATED",this.SUPERSEDED_STATE="MI_SUPERSEDED",this.ACCEPTED_STATE="MI_ACCEPTED",this.CREATED_STATE="MI_CREATED",this.CANCELLED_STATE="MI_CANCELLED",this.APPROVED_STATE="MI_APPROVED",this.REJECTED_STATE="MI_REJECTED",this.IMPLEMENTED_STATE="MI_IMPLEMENTED",this.CONSOLIDATE_OPERATION="MI_CONSOLIDATE",this.SUPERSEDE_OPERATION="MI_SUPERSEDE",this.PROMOTE_OPERATION="MI_PROMOTE",this.REJECT_OPERATION="MI_REJECT",this.APPROVE_OPERATION="MI_APPROVE",this.IMPLEMENT_OPERATION="MI_IMPLEMENT",this.REVERT_CONSOLIDATE_OPERATION="MI_UN_CONSOLIDATE",this.REVERT_SUPERSEDE_OPERATION="MI_UN_SUPERSEDE",this.REVERT_PROMOTE_OPERATION="MI_UN_PROMOTE",this.PROMOTETOTASK_OPERATION="MI_PROMOTETASK"}
return b.prototype=new a,b.singleton=!0,b.factory=function(){return new b},b});
define('strategy/recommendations/details/recommendation-datasheet',['require','jquery','ramda','system/globalization/translator','platform/datasheets/datasheet','strategy/recommendations/services/recommendation-service','ui/elements/risk-matrix/services/risk-assessment-service','strategy/recommendations/recommendation-utility','system/ui/message-box','toastr','strategy/recommendations/recommendation-events'],function(require){"use strict";var a=require("jquery"),b=require("ramda"),c=require("system/globalization/translator"),d=require("platform/datasheets/datasheet"),e=require("strategy/recommendations/services/recommendation-service"),f=require("ui/elements/risk-matrix/services/risk-assessment-service"),g=require("strategy/recommendations/recommendation-utility"),h=require("system/ui/message-box"),i=require("toastr"),j=require("strategy/recommendations/recommendation-events");function k(a){this.parentClass=a,this.config=this.parentClass.config,this.dsheet=null,this.cachedDataSheetEntity=null,this.unmitigatedRiskAssessment=this.parentClass.unmitigatedRiskAssessment,this.translator=Object.resolve(c),this.recommendationService=Object.resolve(e),this.riskAssessmentService=Object.resolve(f),this.RecommendationUtility=Object.resolve(g),this.events=Object.resolve(j)}var l=b.curry(function a(b,c){return b.parentClass.disableIdentificationTab=!0,
b.parentClass.observables.recommendationIconsContainer(!0),c.Key===b.RecommendationUtility.NEW_ENTITY_KEY?(b.parentClass.isNew=!0,b.parentClass.disableMitigatedTab=!1,b.parentClass.disableLinkedTab=!0,b.parentClass.observables.recommendationIconsContainer(!1),I(b.parentClass)):(0===Object.keys(b.unmitigatedRiskAssessment).length&&"MI_CONSOLIDATED"===b.parentClass.currentRecommendation.StateId?(b.parentClass.disableMitigatedTab=!0,I(b.parentClass)):(b.parentClass.disableMitigatedTab=!1,I(b.parentClass)),b.parentClass.disableLinkedTab=!1),c}),m=b.curry(function b(c,d){c.dsheet.beforeEntitiesSave.add(x.bind(null,c),c),c.dsheet.setTitle(c.translator.translate("RECOMMENDATION_LABEL")),d===c.RecommendationUtility.NEW_ENTITY_KEY&&(void 0!==c.config.newRecommendationID&&c.dsheet.entityFactory.updateField(c.dsheet.entity,c.RecommendationUtility.REC_ID,c.RecommendationUtility.DATASHEET_VALUE,c.config.newRecommendationID),
void 0!==c.config.assetID&&c.dsheet.entityFactory.updateField(c.dsheet.entity,c.RecommendationUtility.REC_RELATED_ASSET_ID,c.RecommendationUtility.DATASHEET_VALUE,c.config.assetID),void 0!==c.config.analysisKey&&c.dsheet.entityFactory.updateField(c.dsheet.entity,c.RecommendationUtility.REC_ANALYSIS_KEY,c.RecommendationUtility.DATASHEET_VALUE,c.config.analysisKey),void 0!==c.config.analysisType&&c.dsheet.entityFactory.updateField(c.dsheet.entity,c.RecommendationUtility.REC_TYPE_FIELD,c.RecommendationUtility.DATASHEET_VALUE,c.config.analysisType),void 0!==c.config.recDataSheetDefaultValues&&a(c.config.recDataSheetDefaultValues).each(function(a,b){c.dsheet.entityFactory.updateField(c.dsheet.entity,b.id,c.RecommendationUtility.DATASHEET_VALUE,b.value)}),o(c))}),n=b.curry(function a(b,c){"0"===c||null===c?p(b,null):p(b,c)});function o(a){var b=a.config.assetKey&&Number(a.config.assetKey)>0?a.config.assetKey:a.config.parentKey,c=a.config.siteKey
;c.override?p(a,c.key):a.recommendationService.getSiteKey(b).done(n(a)).fail(J.bind(null,a))}function p(a,b){a.dsheet.datasheetManager.layout.siteKey(b),a.dsheet.entity.siteKey=b,a.dsheet.entityFactory.updateEntitySite(a.dsheet.entity)}var q=b.curry(function c(e,f){var g=e.config.readOnly,h=!0,i=".strategy-recommendation-datasheet",j=f.Key,k=0,l=e.config.siteKey.showSiteSelector,n=e.config.siteKey.disableSiteSelector;f.Entity?k=f.Entity:j!==e.RecommendationUtility.NEW_ENTITY_KEY&&(k=j),e.config.allowAdd&&(g=!1),0===Object.keys(e.unmitigatedRiskAssessment).length&&"MI_CONSOLIDATED"===e.parentClass.currentRecommendation.StateId&&(h=!1),e.config.userPermission.canEditRecommendation&&e.config.editMode||(h=!1);var o={functionsAvailable:["save","references"],readOnly:g,showDatasheetSelection:!0,canEdit:h,delegateDatasheetSave:!0,showsiteselector:l,disablesiteselector:n},p={containerEl:a(i),entityObj:k,scrollEl:".strategy-recommendation-datasheet"}
;j===e.RecommendationUtility.NEW_ENTITY_KEY&&(p={containerEl:a(i),entityObj:k,familyKey:e.config.recommendationFamilyKey,scrollEl:".strategy-recommendation-datasheet"}),e.dsheet=new d(p),e.parentClass.cachedDataSheetEntity&&(e.dsheet.updateState(e.parentClass.cachedDataSheetEntity),e.parentClass.cachedDataSheetEntity=null),e.dsheet.load(o).done(b.partial(m,[e,j])).always(L.bind(null,e))});k.prototype.loadDataSheet=function(a){return K(this),b.compose(q(this),l(this))(a)};var r=b.curry(function a(b,c){L(b),J(b,c),b.dsheet.datasheetManager.layout.isNewEntityCreated(!1)}),s=b.curry(function a(b,c){L(b),b.parentClass.observables.headerName(c.Headline),b.events.recommendationCountEvent.raise(),C(b,c)}),t=b.curry(function a(b,c){b.parentClass.currentRecommendation.assetKey=b.config.assetKey,b.parentClass.currentRecommendation.assetRelID=b.config.assetRelationshipID,b.parentClass.currentRecommendation.parentRelID=b.config.parentRelationshipID,
b.recommendationService.createRecommendation(b.parentClass.currentRecommendation).done(s(b)).fail(r(b))}),u=b.curry(function a(b,c){L(b),b.parentClass.observables.headerName(c.Headline),C(b,c)}),v=b.curry(function a(b,c){b.recommendationService.putRecommendation(b.parentClass.currentRecommendation).done(u(b)).fail(J.bind(null,b))}),w=b.curry(function a(c,d){return K(c),b.cond([[b.equals(0),t(c)],[b.T,v(c)]])(d)});function x(a,b){var c=b.entity;a.parentClass.currentRecommendation.Entity=c,a.parentClass.currentRecommendation.FamilyID=a.config.recommendationFamilyID,a.parentClass.currentRecommendation.ParentKey=a.config.parentKey,w(a,c.key)}var y=b.curry(function a(b,c){var d=c.ID,e=parseInt(d.slice(-1))+1;return b.config.newRecommendationID=d.substring(0,d.length-1)+e,c}),z=b.curry(function a(b,c){b.parentClass.isNew=!1,b.parentClass.observables.headerName(c.Headline+" : "+c.State),b.parentClass.Recommendations.push(c),b.parentClass.currentRecommendation=c,
b.events.recDataSheetSavedEvent.raise(c),i.success(b.translator.translate("REC_SIDEPANEL_CREATED")),L(b),b.dsheet.savingFromUnsavedChangesDialog||b.loadDataSheet(c),b.config.autoCreateMitigatedRisk&&!b.parentClass.currentRecommendation.RiskAssessment&&H(b),b.events.recommendationCreated.raise(c),b.dsheet.savingFromUnsavedChangesDialog&&b.dsheet.datasheetSaveDfd.resolve()}),A=b.curry(function a(b,c,d){D(b,c),b.dsheet.savingFromUnsavedChangesDialog||b.loadDataSheet(c),i.success(b.translator.translate("REC_SIDEPANEL_UPDATED")),b.events.cachedClearList.raise(),b.events.recDataSheetSavedEvent.raise(c),b.dsheet.savingFromUnsavedChangesDialog&&(b.dsheet.datasheetSaveDfd.resolve(),b.dsheet=null)}),B=b.curry(function a(c,d,e){var f=c.config.assetKey?c.config.assetKey:c.config.parentKey,g=c.config.assetKey?c.config.assetRelationshipID:c.config.parentRelationshipID;c.config.isStrategicRec?d.ParentKey=c.config.parentKey:(d.ParentKey=f,c.config.parentRelationshipID=g),
c.events.cachedClearList.raise(),b.compose(z(c),y(c))(d)});function C(a,c){return void 0!==a.unmitigatedRiskAssessment&&(a.unmitigatedRiskAssessment.hasOwnProperty("length")&&a.unmitigatedRiskAssessment.length>0&&(a.parentClass.disableMitigatedTab=!1),a.unmitigatedRiskAssessment.hasOwnProperty("Key")&&a.unmitigatedRiskAssessment.Key!==a.RecommendationUtility.NEW_ENTITY_KEY&&(a.parentClass.disableMitigatedTab=!1)),b.cond([[b.identity,B(a,c)],[b.T,A(a,c)]])(a.parentClass.isNew)}function D(a,c){var d=b.findIndex(b.propEq("Key",c.Key))(a.parentClass.Recommendations);d>0&&(a.parentClass.observables.headerName(c.Headline+" : "+c.State),a.parentClass.Recommendations[d]=c)}var E=b.curry(function a(b,c){b.parentClass.riskInserted(c)}),F=b.curry(function a(b,c){b.riskAssessmentService.getRiskAssessment(c).done(E(b)).fail(J.bind(null,b))}),G=b.curry(function a(b,c){b.riskAssessmentService.insertRiskAssessment(c).done(F(b)).fail(J.bind(null,b))});function H(a){
a.unmitigatedRiskAssessment&&a.unmitigatedRiskAssessment.hasOwnProperty("key")&&a.riskAssessmentService.getDefaultMitigatedRiskAssessment(a.unmitigatedRiskAssessment.key).done(G(a)).fail(J.bind(null,a))}function I(a){var b=["MI_STRATREC","MI_APIRECOM","MI_RBIRECOM","MI_RECRCM","MI_RSKASREC"],c=["MI_PERFREC","MI_RECCLBN","MI_RECINSP","MI_GENRECOM","MI_OPR_REC","MI_ORRCINER","MI_POLRECOM","MI RCA Recommendation","MI Reliability Recommendation"];b.indexOf(a.config.recommendationFamilyID)>-1&&!a.isNew?(a.observables.showMitigatedTab(!0),0===Object.keys(a.unmitigatedRiskAssessment).length&&a.observables.showMitigatedTab(!1)):(c.indexOf(a.config.recommendationFamilyID),a.observables.showMitigatedTab(!1))}function J(a,c){var d;L(a),d=b.is(Object,c)?c.responseJSON?c.responseJSON.message:c.responseText:c,h.showOk(d,a.translator.translate("ERROR"),a.RecommendationUtility.warningIcon)}function K(a){a.parentClass.busyIndicator.show()}function L(a){a.parentClass.busyIndicator.hide()}return k});
define('system/notifications/broker',['require','logging/error-notification-handler','logging/feedback-component/feedback-component','system/error-handler/error-handler'],function(require){"use strict";var a=require("logging/error-notification-handler"),b=require("logging/feedback-component/feedback-component"),c=require("system/error-handler/error-handler");function d(){this.notificationPanel=Object.resolve(a),this.nonInterruptiveErrors=c,this.feedback=Object.resolve(b)}return d});

define('text!strategy/recommendations/details/views/recommendation-risk-details.html',[],function () { return '<mi-risk-matrix-summary data-bind="attr: { \'risk-of\': unmititgatedRiskName, \'mitigated-by\': recHeadline }"></mi-risk-matrix-summary>\r\n';});

define('ui/elements/risk-matrix/utilities',[],function(){"use strict";var a="{c}",b="{r}",c="{pl}",d="{t}";function e(){}return e.calculateRiskRank=function(a,b,c,d,e){return b?c*d:c*d*(e||1)*a},e.calculateRiskRankAlias=function(f,g,h,i,j,k){var l="",m;return l=f.replace(a,g),l=l.replace(b,h),l=l.replace(c,i),m=e.getThreshold(k,j),m&&(l=l.replace(d,m.alias)),l},e.getThreshold=function(a,b){var c=-1,d,e;if(b&&b.length>0)for(d=0;d<b.length;d++)b[d].value<=a&&b[d].value>c&&(e=b[d],c=b[d].value);return e},e.findRiskRank=function(a,b){var c;for(c=0;c<b.length;c++)if(b[c]&&b[c].categoryName===a)return b[c];return{}},e.checkRiskRankAlias=function(a,b){return a.showAlias&&" - "!==b?b:""},e.findFinancialCategory=function(a){var b;for(b=0;b<a.length;b++)if(a[b]&&a[b].isFinancial)return a[b]},e});
define('ui/elements/risk-matrix/views/risk-matrix-summary-view',["require","exports","react","system/lang/object","system/text/parser","system/globalization/translator","system/text/formatter","ramda","application/application-context","ui/elements/risk-matrix/utilities"],function(require,exports,a,b,c,d,e,f,g){"use strict";var h=require("ui/elements/risk-matrix/utilities"),i="risk-rank-category-up",j=" -- ",k=a.DOM,l=k.div,m=k.text,n=k.span;return function(){function k(){this.financialRank="",this.matrix=null,this.categoryIndex=0}return k.prototype.view=function(a){this.init(a);var b=this.getDrivingValue(),c=h.checkRiskRankAlias(this.matrix,b.riskRankAlias)||b.riskRank,d=this.getTotalDrivingRiskThreshold(b,c),e=this.getCategoriesDiv(),f=c?void 0:this.getNoRiskDiv(),g=this.getTotalRiskValueContainer(b,c),i=[g,f||this.getTotalsDivText()],j=l.apply(void 0,[{className:"totals-div"}].concat(i)),k=a.clickHandler;return l({className:"concise-summary",style:this.summaryViewStyle(d),onClick:k},j,e)},k.prototype.init=function(a){
this.settings=a.settings,this.matrix=a.matrix},k.prototype.getTotalRiskValueContainer=function(a,b){var c=l(),d;return b&&(d=h.getThreshold(a.riskRank,this.matrix.thresholds),c=l({className:"number"},this.getDrivingRiskValue(b,this.totalRiskStyle(d)))),c},k.prototype.getTotalDrivingRiskThreshold=function(a,b){var c;return b&&(c=h.getThreshold(a.riskRank,this.matrix.thresholds)),c},k.prototype.summaryViewStyle=function(a){var b;return a&&(b={borderRightColor:null},b.borderRightColor=a.color),b},k.prototype.totalRiskStyle=function(a){var b;return a&&(b={color:null},b.color=a.color),b},k.prototype.getTotalsDivText=function(){var a,b,c=this.createLabel("TOTAL_RISK");return a=n({className:i},c),b=this.getDrivingInfoContainer(),l.apply(void 0,[{className:"text"},a].concat(b))},k.prototype.getDrivingInfoContainer=function(){
var a=this.getDrivingValue(),b=h.checkRiskRankAlias(this.matrix,a.riskRankAlias)||a.riskRank,c=this.getTotalDrivingRiskThreshold(a,b),d=[],e=c?c.color:"",f=this.createLabel("DRIVING_RISK"),g=a.drivingRiskCategory||j,i=this.createLabel("DRIVING_RISK_ALIAS"),k=a.drivingRiskAlias||j,l=this.createLabel("DRIVING_RISK_THRESHOLD"),m=a.drivingRiskThreshold||j;return d.push(this.getDrivingInfoSpan(f,g)),this.drivingRiskStringExists(k)&&d.push(this.getDrivingInfoSpan(i,k,e)),this.drivingRiskStringExists(m)&&d.push(this.getDrivingInfoSpan(l,m,e)),d},k.prototype.drivingRiskStringExists=function(a){return a!==j&&" - "!==a},k.prototype.getDrivingInfoSpan=function(a,b,c){var d=[m({},a+": "),m({style:{color:c}},b)];return n.apply(void 0,[{className:"risk-rank-category"}].concat(d))},k.prototype.getDrivingRiskValue=function(a,b){return n({className:"total",style:b},m({},this.formatFloat(a,4)||"Â "))},k.prototype.getDrivingValue=function(){var a
;return a=this.settings.value.mitigated?this.settings.value.mitigated:this.settings.value.unmitigated},k.prototype.getNoRiskDiv=function(){var b=this.createLabel("NO_RISK_ASSIGNED"),c=n({className:i},m({},b)),d=a.createElement("span"),e=this.settings.readonly?d:this.createLabel("ASSIGN_RISK"),f=n({className:"risk-rank-category"},e);return l({className:"no-risk-div"},c,f)},k.prototype.getCategoriesDiv=function(){for(var b=null,c=0,d=0,e=a.createElement("div"),f=[];this.categoryIndex<this.matrix.categories.length;)e=this.populateCategories(d,c,b,f),this.categoryIndex++;return this.categoryIndex=0,e},k.prototype.populateCategories=function(a,b,c,d){var e=this.matrix.categories[this.categoryIndex],f=this.getFinancialRisk();c={color:"#666666"},e.isFinancial?d.push(this.getCategoryDiv(f,e,c)):d=this.populateCategoryRiskRanks(e,d,c,b);var g=l.apply(void 0,[{className:"category-div-wrapper"}].concat(d));return l({className:"cats-all-div"},g)},
k.prototype.populateCategoryRiskRanks=function(a,b,c,d){var e=h.findRiskRank(a.name,this.getDrivingValue().risks);if(e.notApplicable)b.push(this.getCategoryDiv(this.createLabel("NA"),a,c));else if(e.riskRankAlias||e.rank){d=h.checkRiskRankAlias(this.matrix,e.riskRankAlias)||e.rank;var f=h.getThreshold(e.rank,this.matrix.thresholds);f&&(c={color:f.color}),b.push(this.getCategoryDiv(this.formatFloat(d,4)||"Â ",a,c))}else b.push(this.getCategoryDiv(j,a,c));return b},k.prototype.getCategoryDiv=function(a,b,c){var d=new Array;return d.push(n({className:"risk-rank-category"},b.formattedName)),l.apply(void 0,[{className:"cat-div"}].concat(d.concat([this.getCategoryInfo(b,a,c)])))},k.prototype.getCategoryInfo=function(a,b,c){var d=[this.getRiskOrRiskAliasForCategory(a,c,b),this.getThresholdForCategory(a,c,b)];return n.apply(void 0,[{className:i,style:c}].concat(d))},k.prototype.getRiskOrRiskAliasForCategory=function(a,b,c){
if(!a.isFinancial&&this.matrix.showAlias)return this.getAliasMaskForCategory(a,b);var d=a.isFinancial?this.matrix.financialPrecision:2;return this.getRiskValueForCategory(c,b,d)},k.prototype.getThresholdForCategory=function(a,b,c){var d=h.findRiskRank(a.name,this.getDrivingValue().risks),e=h.getThreshold(d.rank,this.matrix.thresholds),f={className:i,style:b},g=c!==j,k=!a.isFinancial&&e&&!d.notApplicable,l=n(f);return g?k&&(l=n(f,e.formattedDescription)):l=n(f,j),l},k.prototype.getRiskValueForCategory=function(a,b,c){return n({className:i,style:b},this.formatFloat(a,c))},k.prototype.getAliasMaskForCategory=function(a,b){var c="";return a.isFinancial||(c=this.getRiskAliasForCategory(a)),n({className:i,style:b},c)},k.prototype.getRiskAliasForCategory=function(a){var b=this.settings.value.mitigated||this.settings.value.unmitigated,c="";return f.forEach(function(b){a.name===b.categoryName&&(c=b.riskRankAlias)},b.risks),c},k.prototype.formatFloat=function(a,b){var d="m",h=c.parseFloat(a)
;if(!isNaN(h)){var i=new e;return f.isNil(b)?b=d:f.is(Number,b)&&(b=d+b.toString()),i.format(h,b,g.user.cultureId)}return a},k.prototype.getFinancialRisk=function(){var a,b,c;return c=this.settings.value.mitigated?this.settings.value.mitigated.risks:this.settings.value.unmitigated.risks,a=h.findFinancialCategory(c),b=j,a&&a.notApplicable?b=this.createLabel("NA"):a&&a.rank&&(b=a.rank),b},k.prototype.createLabel=function(a){return b.resolve(d).translate(a)},k}()});
define('ui/elements/risk-matrix/models/probability-dto',['require','system/lang/converter'],function(require){"use strict";var a=require("system/lang/converter");function b(b){this.key=b.key.toString(),this.factor=a.toFloat(b.factor);var c;c=b.factorUI?b.factorUI:a.toFloat(b.factor),this.factorUI=c,this.nameID=a.toString(b.name),this.descriptionID=a.toString(b.description),this.alias=a.toString(b.alias),this.formattedName=a.toString(b.formattedName),this.formattedDescription=a.toString(b.formattedDescription),this.headerTitle="",this.headerValue=""}return b.fromDataCollection=function a(c){var d,e=[];if(c)for(d=0;d<c.length;d++)e[d]=new b(c[d]);return e},b});
define('ui/elements/risk-matrix/models/consequence-dto',['require','system/lang/converter'],function(require){"use strict";var a=require("system/lang/converter");function b(b){this.key=b.key.toString(),this.factor=a.toFloat(b.factor);var c;c=b.factorUI?b.factorUI:a.toFloat(b.factor),this.factorUI=c,this.nameID=a.toString(b.name),this.descriptionID=a.toString(b.description),this.alias=a.toString(b.alias),this.formattedName=a.toString(b.formattedName),this.formattedDescription=a.toString(b.formattedDescription),this.headerTitle="",this.headerValue=""}return b.fromDataCollection=function a(c){var d,e=[];if(c)for(d=0;d<c.length;d++)e[d]=new b(c[d]);return e},b});
define('ui/elements/risk-matrix/models/protection-level-dto',['require','system/lang/converter'],function(require){"use strict";var a=require("system/lang/converter");function b(b){this.key=b.key.toString(),this.factor=a.toInteger(b.factor),this.nameID=a.toString(b.name),this.descriptionID=a.toString(b.description),this.alias=a.toString(b.alias),this.formattedName=a.toString(b.formattedName),this.formattedDescription=a.toString(b.formattedDescription)}return b.fromDataCollection=function a(c){var d,e=[];if(c)for(d=0;d<c.length;d++)e[d]=new b(c[d]);return e},b});
define('ui/elements/risk-matrix/models/risk-matrix-cell',[],function(){"use strict";function a(){this.value="",this.rank=0,this.riskRankAlias="",this.threshold=null,this.probability=0,this.consequence=0}return a});
define('ui/elements/risk-matrix/models/risk-category-dto',['require','system/lang/converter','ui/elements/risk-matrix/models/probability-dto','ui/elements/risk-matrix/models/consequence-dto','ui/elements/risk-matrix/models/protection-level-dto','ui/elements/risk-matrix/models/risk-matrix-cell','ui/elements/risk-matrix/utilities'],function(require){"use strict";var a=require("system/lang/converter"),b=require("ui/elements/risk-matrix/models/probability-dto"),c=require("ui/elements/risk-matrix/models/consequence-dto"),d=require("ui/elements/risk-matrix/models/protection-level-dto"),e=require("ui/elements/risk-matrix/models/risk-matrix-cell"),f=require("ui/elements/risk-matrix/utilities");function g(e,f,g){e=e||{},this.matrix=f||{},this.index=a.toFloat(e.index),this.weight=a.toNullable(e.weight),this.name=a.toString(e.name),this.formattedName=a.toString(e.formattedName),this.formattedDescription=a.toString(e.formattedDescription),this.isFinancial=a.toBoolean(e.isFinancial),this.probabilities=b.fromDataCollection(e.probabilities),this.consequences=c.fromDataCollection(e.consequences),this.protectionLevels=d.fromDataCollection(e.protectionLevels),this.protectionLevel=g,this.processCategory()}g.prototype.processCategory=function(){g.sortAxis(this.probabilities,this.matrix.probabilitySortOrderValue),
g.sortAxis(this.consequences,this.matrix.consequenceSortOrderValue),this.setXCollection(),this.setYCollection(),this.setHeaders(this.xCollection),this.setHeaders(this.yCollection),this.populateRows()},g.prototype.setXCollection=function(){"XAXIS"===this.matrix.probabilityAxisValue?this.xCollection=this.probabilities:this.xCollection=this.consequences},g.prototype.setYCollection=function(){"XAXIS"!==this.matrix.probabilityAxisValue?this.yCollection=this.probabilities:this.yCollection=this.consequences},g.prototype.populateRows=function(){var a,b,c,d;if(this.rowArray=[],this.yCollection)for(a=0;a<this.yCollection.length;a++)if(d={headerTitle:this.yCollection[a].headerTitle,headerValue:this.yCollection[a].headerValue,data:[],formattedDescription:this.yCollection[a].formattedDescription},this.rowArray[this.rowArray.length]=d,this.xCollection)for(b=0;b<this.xCollection.length;b++)c=this.populateCell(this.xCollection[b],this.yCollection[a]),d.data[d.data.length]=c},
g.prototype.populateCell=function(a,b){var c=new e;return c.value=f.calculateRiskRank(this.weight,this.isFinancial,a.factor,b.factor,this.protectionLevel),c.value=parseFloat(c.value.toFixed(5)),c.rank=c.value,c.threshold=f.getThreshold(c.value,this.matrix.thresholds),this.matrix.hideNumericRiskRank&&!this.matrix.showAlias&&(c.value=""),this.matrix.showAlias&&(c.value=f.calculateRiskRankAlias(this.matrix.aliasMask,a.alias,b.alias,this.protectionLevel,this.matrix.thresholds,c.value),c.riskRankAlias=c.value),"XAXIS"===this.matrix.probabilityAxisValue?(c.probability=a.factor,c.consequence=b.factor):(c.probability=b.factor,c.consequence=a.factor),c},g.prototype.setHeaders=function(a){var b,c;if(a)for(b=a.length-1;b>-1;b--)c=a[b],this.matrix.hideProbabilityAndConsequenceNames||(c.headerTitle=c.formattedName),this.matrix.showAlias?c.headerValue=c.alias:c.headerValue=c.factor},g.sortAxis=function(a,b){return"ASC"===b?a.sort(i):a.sort(h)},g.fromDataCollection=function a(b,c){var d,e=[]
;if(b)for(d=0;d<b.length;d++)e[d]=new g(b[d],c);return e};function h(a,b){return b.factorUI-a.factorUI}function i(a,b){return a.factorUI-b.factorUI}return g});
define('ui/elements/risk-matrix/models/risk-threshold-dto',['require','system/lang/converter'],function(require){"use strict";var a=require("system/lang/converter");function b(b){this.value=a.toFloat(b.value),this.alias=a.toString(b.alias),this.color=a.toString(b.color),this.description=a.toString(b.description),this.formattedDescription=a.toString(b.formattedDescription)}return b.fromDataCollection=function a(c){var d,e=[];if(c)for(d=0;d<c.length;d++)e[d]=new b(c[d]);return e},b});
define('ui/elements/risk-matrix/models/risk-matrix-dto',['require','system/lang/converter','ui/elements/risk-matrix/models/risk-category-dto','ui/elements/risk-matrix/models/risk-threshold-dto'],function(require){"use strict";var a=require("system/lang/converter"),b=require("ui/elements/risk-matrix/models/risk-category-dto"),c=require("ui/elements/risk-matrix/models/risk-threshold-dto");function d(d){this.key=d.key.toString(),this.name=a.toString(d.name),this.isLogarithmic=a.toBoolean(d.isLogarithmic),this.isDefault=a.toBoolean(d.isDefault),this.showAlias=a.toBoolean(d.showAlias),this.isUsingMaxRisk=a.toBoolean(d.isUsingMaxRisk),this.hideNumericRiskRank=a.toBoolean(d.hideNumericRiskRank),this.hideProtectionLevelText=a.toBoolean(d.hideProtectionLevelText),this.hideProbabilityAndConsequenceNames=a.toBoolean(d.hideProbabilityAndConsequenceNames),this.showFinancialImpactValues=a.toBoolean(d.showFinancialImpactValues),this.lockMitigatedConsequence=a.toBoolean(d.lockMitigatedConsequence),this.maxRiskRank=a.toFloat(d.maxRiskRank),this.minRiskRank=a.toFloat(d.minRiskRank),this.aliasMask=a.toString(d.aliasMask),this.dialogCaption=a.toString(d.dialogCaption),
this.currency=a.toString(d.currency),this.financialPrecision="N"+a.toInteger(d.financialPrecision),this.consequenceAxisValue=a.toString(d.consequenceAxisValue),this.probabilityAxisValue=a.toString(d.probabilityAxisValue),this.consequenceSortOrderValue=a.toString(d.consequenceSortOrderValue),this.probabilitySortOrderValue=a.toString(d.probabilitySortOrderValue),this.unmitigatedObjectLabel=a.toString(d.unmitigatedObjectLabel),this.mitigatedObjectLabel=a.toString(d.mitigatedObjectLabel),this.unmitigatedRiskLabel=a.toString(d.unmitigatedRiskLabel),this.mitigatedRiskLabel=a.toString(d.mitigatedRiskLabel),this.thresholds=c.fromDataCollection(d.thresholds),this.categories=b.fromDataCollection(d.categories,this)}return d.fromDataCollection=function a(b){var c,e=[];for(c=0;c<b.length;c++)e[c]=new d(b[c]);return e},d});
define('platform/risk/models/risk-metadata-dto',['require','system/lang/converter'],function(require){"use strict";var a=require("system/lang/converter");function b(b){this.RiskFamilyCaption=a.toString(b.riskMatrixFamilyCaption),this.RiskFamilyKey=a.toInteger(b.riskMatrixFamilyKey),this.RiskDatasheetKey=a.toInteger(b.riskMatrixDatasheetKey)}return b.fromDataCollection=function a(c){var d,e=[];for(d=0;d<c.length;d++)e[d]=new b(c[d]);return e},b});
define('ui/elements/risk-matrix/services/risk-matrix-service',['require','jquery','system/http/ajax-client','ui/elements/risk-matrix/models/risk-matrix-dto','platform/risk/models/risk-metadata-dto'],function(require){"use strict";var a=require("jquery"),b=require("system/http/ajax-client"),c=require("ui/elements/risk-matrix/models/risk-matrix-dto"),d="api/internal/risk/matrix",e=require("platform/risk/models/risk-metadata-dto"),f=d+"/default",g="api/internal/risk/matrix/lite",h="api/internal/risk/metadata";function i(a){this.ajaxClient=a}return i.dependsOn=[b],i.prototype.getMetadata=function b(){var c=a.Deferred();return this.ajaxClient.get(h).done(function(a){c.resolve(new e(a))}).fail(function(a){c.reject(a)}),c.promise()},i.prototype.getRiskMatrices=function b(){var e=a.Deferred();return this.ajaxClient.get(d).done(function(a){e.resolve(new c.fromDataCollection(a))}).fail(function(a){e.reject(a)}),e.promise()},i.prototype.getRiskMatricesLite=function b(){var d=a.Deferred();return this.ajaxClient.get(g).done(function(a){d.resolve(new c.fromDataCollection(a))}).fail(function(a){d.reject(a)}),d.promise()},i.prototype.getDefaultRiskMatrix=function b(){var d=a.Deferred()
;return this.ajaxClient.get(f).done(function(a){d.resolve(new c(a))}).fail(function(a){d.reject(a)}),d.promise()},i.prototype.getRiskMatrixByKey=function b(e){var f=a.Deferred();return this.ajaxClient.get(d+"/"+e).done(function(a){f.resolve(new c(a))}).fail(function(a){f.reject(a)}),f.promise()},i});
define('ui/elements/risk-matrix/risk-assessment',['require','jquery','system/ui/dialog-view-model','ui/elements/risk-matrix/services/risk-matrix-service','ui/elements/risk-matrix/models/risk-assessment-dto','system/error/error-message','application/application-events','ui/elements/risk-matrix/models/risk-rank-dto','system/globalization/translator','system/text/formatter','system/text/parser','system/ui/busy-indicator','ramda'],function(require){"use strict";var a=require("jquery"),b=require("system/ui/dialog-view-model"),c=require("ui/elements/risk-matrix/services/risk-matrix-service"),d=require("ui/elements/risk-matrix/models/risk-assessment-dto"),e=require("system/error/error-message"),f=require("application/application-events"),g=require("ui/elements/risk-matrix/models/risk-rank-dto"),h=require("system/globalization/translator"),i=require("system/text/formatter"),j=require("system/text/parser"),k=require("system/ui/busy-indicator"),l=require("ramda"),m="m";function n(){this.dialog=null,this.dfd=null,this.service=Object.resolve(c),this.translator=Object.resolve(h),this.formatter=Object.resolve(i),this.errorOccured=Object.resolve(f).errorOccured,this.element=null,this.originalValue=null,this.settings={matrix:null,value:null,riskOf:null,mitigatedBy:null,readonly:!1,calculator:null}}n.prototype.show=function(c){var e={height:"100%",width:"75%"},f;return c.value&&(this.originalValue=l.clone(c.value),
this.settings.value={},f=this.translator.translate("UNMITIGATED_ASSESSMENT_MSG"),c.value.unmitigated&&(this.settings.value.unmitigated=new d(c.value.unmitigated)),c.value.mitigated&&(this.settings.value.mitigated=new d(c.value.mitigated),f=this.translator.translate("MITIGATED_ASSESSMENT_MSG"))),c.matrix?(this.settings.matrix=c.matrix,this.settings.matrix.dialogCaption&&(f=this.settings.matrix.dialogCaption)):this.settings.value&&this.service.getRiskMatrixByKey(this.settings.value.unmitigated.riskMatrixKey).done(y.bind(null,this)).fail(x.bind(null,this)),this.settings.riskOf=c.riskOf,this.settings.mitigatedBy=c.mitigatedBy,this.settings.readonly=c.readonly===!0,this.settings.calculator=c.calculator,this.dialog=new b(this,f,e),this.dfd=a.Deferred(),this.dialog.show(),this.busyIndicator=Object.resolve(k),this.dfd.promise()},n.prototype.attach=function(a){var b;b=document.createElement("div"),b.className="risk-assessment-dialog",s(this,b),r(this,b),a.attach(b),this.element=a.element,
o(this),this.element.addEventListener("click",this),this.element.addEventListener("change",this)};function o(b){a(b.element).find(".risk-assessment-side-panel").css("width",a(b.element).find(".risk-matrix-wrapper").css("width")),a(b.element).find(".risk-assessment-side-panel").css("max-width",a(b.element).find(".risk-matrix-wrapper").css("max-width"))}n.prototype.handleEvent=function(a){"click"===a.type&&p(this,a)};function p(a,b){"cancel"===b.target.getAttribute("name")?(a.dfd.notify(a.originalValue,{dfd:null}),a.dialog.closeDialog()):"save"===b.target.getAttribute("name")&&q(a)}function q(a){var b=a.element.querySelector("mi-risk-matrix"),c={dfd:null},d;d=a.element.querySelector('textarea[name="basis-for-assessment"]').value,b.value.mitigated?(a.settings.value.mitigated.risks=b.value.mitigated,a.settings.value.mitigated.basisForAssessment=d):b.calculator?(a.settings.value.unmitigated.risks=b.value.unmitigated,a.settings.value.unmitigated.basisForAssessment=d,
a.settings.value.mitigated.risks=b.value.mitigated||[]):(a.settings.value.unmitigated.risks=b.value.unmitigated,a.settings.value.unmitigated.basisForAssessment=d),a.dfd.notify(a.settings.value,c),null===c.dfd?a.dialog.closeDialog():(a.busyIndicator.attachTo(a.dialog.dialogContentRegion.element),a.busyIndicator.show(),c.dfd.done(function(){a.dialog.closeDialog()}),c.dfd.always(function(){a.busyIndicator.hide()}))}function r(a,b){var c,d,e;e=document.createElement("div"),e.className="block-group risk-assessment-footer",b.appendChild(e),c=document.createElement("div"),c.className="risk-controls clearfix pull-right",e.appendChild(c),a.settings.readonly?(d=document.createElement("button"),d.className="btn btn-text pull-right",d.setAttribute("name","cancel"),d.appendChild(document.createTextNode(a.translator.translate("OK"))),c.appendChild(d)):(d=document.createElement("button"),d.className="btn btn-text pull-right",d.setAttribute("name","save"),
d.appendChild(document.createTextNode(a.translator.translate("SAVE"))),c.appendChild(d),d=document.createElement("button"),d.className="btn btn-text pull-right",d.setAttribute("name","cancel"),d.appendChild(document.createTextNode(a.translator.translate("CANCEL"))),c.appendChild(d))}function s(a,b){var c,e,f;c=document.createElement("div"),c.className="block-group risk-assessment-body",b.appendChild(c),e=document.createElement("mi-risk-matrix"),e.calculator=a.settings.calculator,a.settings.readonly&&e.setAttribute("readonly","readonly"),a.settings.matrix&&(e.matrix=a.settings.matrix),f={unmitigated:null,mitigated:null},a.settings.value&&(f={unmitigated:a.settings.value.unmitigated.risks},a.settings.value.mitigated?f.mitigated=a.settings.value.mitigated.risks:a.settings.calculator&&(f.mitigated=a.settings.value.mitigated=new d)),e.value=f,c.appendChild(e),c.appendChild(t(a))}function t(a){var b,c,d;return d=document.createElement("div"),d.className="risk-assessment-side-panel",u(a,d),d}
function u(a,b){var c,d,e,f;c=document.createElement("div"),c.className="side-panel-footer",b.appendChild(c),f=document.createElement("div"),f.className="form-group",c.appendChild(f),d=document.createElement("label"),d.className="control-label",d.appendChild(document.createTextNode(a.translator.translate("BASIS_FOR_ASSESSMENT"))),f.appendChild(d),e=document.createElement("textarea"),e.setAttribute("name","basis-for-assessment"),e.className="basis-for-assessment",e.setAttribute("rows","2"),a.settings.readonly&&e.setAttribute("disabled","disabled"),a.settings.value&&(a.settings.value.mitigated?e.value=a.settings.value.mitigated.basisForAssessment:e.value=a.settings.value.unmitigated.basisForAssessment),f.appendChild(e)}function v(a,b){var c,d;b||(b=a.element.querySelector(".risk-assessment-side-panel")),a.settings.mitigatedBy&&(a.settings.matrix&&(c=a.settings.matrix.mitigatedObjectLabel),w(a,b,c,"MITIGATED_BY","mitigated-by-label",a.settings.mitigatedBy)),
a.settings.value&&(d=a.settings.matrix&&a.settings.matrix.showAlias?a.settings.value.mitigated.riskRankAlias:a.settings.value.mitigated.riskRank),w(a,b,c,"MITIGATED_RISK_RANK","mitigated-risk-rank-label",d,"mitigated-risk-rank")}function w(a,b,c,d,e,f,g){var h,i,j,k;h=document.createElement("div"),b.appendChild(h),h.className="form-group",i=document.createElement("label"),i.className="control-label",c&&(j=c),j||(j=a.translator.translate(d)),i.setAttribute("name",e),i.appendChild(document.createTextNode(j)),h.appendChild(i),k=document.createElement("p"),k.className="form-control-static",g&&k.setAttribute("name",g),k.appendChild(document.createTextNode(B(a,f,4))),h.appendChild(k)}function x(a,b,c,d){var f=new e("RM3",d,(new Error).stack);a.errorOccured.raise(a,f)}function y(a,b){var c,d;a.settings.matrix=b,d=a.element.querySelector("mi-risk-matrix"),d.matrix=b,a.settings.value.mitigated&&(b.mitigatedObjectLabel&&(c=a.element.querySelector('label[name="mitigated-by-label"]'),
Element.clearDom(c),c.appendChild(document.createTextNode(b.mitigatedObjectLabel))),b.mitigatedRiskLabel&&(c=a.element.querySelector('label[name="mitigated-risk-rank-label"]'),Element.clearDom(c),c.appendChild(document.createTextNode(B(a,b.mitigatedRiskLabel)))),b.showAlias&&(c=a.element.querySelector('p[name="mitigated-risk-rank"]'),Element.clearDom(c),c.appendChild(document.createTextNode(a.settings.value.mitigated.riskRankAlias))))}function z(a){return!l.isNil(a.mitigated)}function A(a,b){var c,d=0,e;for(c=0;c<b.length;c++)b[c]&&(b[c].isFinancial||b[c].notApplicable||!isNaN(b[c].rank)&&b[c].rank&&(a.settings.matrix.isUsingMaxRisk?d<b[c].rank&&(d=b[c].rank,e=b[c].riskRankAlias):d+=b[c].rank));return{rank:d,alias:e}}function B(a,b,c){return isNaN(j.parseFloat(b))?b:a.formatter.format(b,m+(c?c.toString():""))}return n});
define('ui/elements/risk-matrix/views/components/categories-list',["require","exports","react","ramda"],function(require,exports,a,b){"use strict";var c=a.DOM,d=c.ul,e=c.li,f=c.a,g=c.span;function h(a){var b=a.categories,c=i.bind(null,a);return d({className:"nav"},b.map(c))}exports.CategoriesList=h;function i(a,c,d){var g=a.value.mitigated&&b.find(b.propEq("isFinancial",!1),a.value.mitigated)?a.value.mitigated:a.value.unmitigated,h=b.find(b.propEq("categoryName",c.name))(g),i=function(){return a.onClick(c)};return e({key:d,title:c.formattedName},f({className:b.equals(c.name,a.category.name)?"active":"nav-category",style:j(c,h,a.category),onClick:i},c.formattedName,l(a.vm,c,h)))}function j(a,c,d){return{borderLeftColor:b.isNil(c)||b.equals(a.isFinancial,!0)||b.not(b.isNil(c))&&b.isNil(c.rank)?"#808080":k(a,c.rank).color}}function k(a,b){var c=a.matrix.thresholds,d=-1,e,f;for(e=0;e<c.length;e++)c[e].value<=b&&c[e].value>d&&(f=c[e],d=c[e].value);return f}function l(a,c,d){return b.isNil(d)?null:d.notApplicable?g({className:"risk-rank-tab-title"
},a.translate("NA")):!c.isFinancial&&c.matrix.showAlias&&""!==d.riskRankAlias&&" - "!==d.riskRankAlias?g({className:"risk-rank-tab-title"},d.riskRankAlias):g({className:"risk-rank-tab-title"},m(a,c,d.rank))}function m(a,b,c){var d=b.isFinancial?a.formatFloat(c,a.getMatrix().financialPrecision):a.formatFloat(c,4);return!b.isFinancial&&isNaN(c)?"":d}});
define('ui/elements/risk-matrix/views/components/financial-matrix',["require","exports","react","ramda","system/react/react-common","system/text/formatter"],function(require,exports,a,b,c,d){"use strict";var e=a.DOM,f=e.div,g=e.input,h=e.tbody,i=e.tr,j=e.td,k=e.select,l=e.option,m=e.label,n=b.objOf("className"),o=b.partial(f,[b.objOf("className")("risk-matrix-wrapper")]),p=function(){for(var a=[],b=0;b<arguments.length;b++)a[b-0]=arguments[b];return f.apply(void 0,[n("block-group risk-matrix-tab")].concat(a))},q=function(){for(var b=[],c=0;c<arguments.length;c++)b[c-0]=arguments[c];return(d=a.DOM).table.apply(d,[n("risk-matrix-container-financial")].concat(b));var d},r=void 0,s=new d;function t(a){return o(p(C(a),ha(a),u(a)))}exports.FinancialMatrix=t;function u(a){if(a.vm.getMatrix().showFinancialImpactValues===!1)return f();var b=a.vm,c=b.getValue(),d=b.getMatrix(),e=[];e.push(v(b.translate("CATEGORY"),b.translate("FINANCIAL_IMPACT_CAPTION")));for(var g={},h=0;h<d.categories.length;h++)g[d.categories[h].name]=d.categories[h].formattedName
;for(var i=0;i<c.unmitigated.length;i++)c.unmitigated[i].isFinancial===!1&&(c.unmitigated[i].notApplicable===!1?e.push(y(g[c.unmitigated[i].categoryName],c.unmitigated[i].financialImpact)):e.push(y(g[c.unmitigated[i].categoryName],b.translate("NA"))));return B(e)}function v(a,b){return i({className:"impact-grid-row",key:a},w(a),x(b))}function w(a){return j({className:"impact-grid-cell-bold",key:a},a)}function x(a){return j({className:"impact-grid-cell-bold",key:a},a)}function y(a,b){return i({className:"impact-grid-row",key:a},z(a),A(b))}function z(a){return j({className:"impact-grid-cell",key:a},a)}function A(a){return j({className:"impact-grid-cell",key:a},a)}function B(a){return f(n("risk-matrix-block-group"),q(h(r,a)))}function C(a){var c=a.vm,d=a.category,e=a.risk.unmitigated,f=b.isNil(a.risk.mitigated)?null:a.risk.mitigated,g=b.not(b.isNil(e))&&e.notApplicable||c.getReadOnly()||b.not(b.isNil(f))&&!c.hasCalculatorFunction(),h=b.not(b.isNil(e))&&e.notApplicable||c.getReadOnly()
;return D([E(c,f),K(c,d,a.onInputChange,e,f,g,h,c.translate("PROBABILITY_LABEL")),L(c,a.onInputChange,e,f,g,h,c.translate("PRODUCTION_LOSS_CAPTION")),M(c,a.onInputChange,e,f,g,h,c.translate("MAINTENANCE_COST")),N(c,a.onInputChange,e,f,g,h,c.translate("CONSEQUENCE_CAPTION")),O(c,d,e,f,c.translate("FINANCIAL_RANK_CAPTION")),P(c,a.risk,c.translate("BENEFIT_LABEL"))])}function D(a){return f(n("risk-matrix-block-group"),q(h(r,a)))}function E(a,b){return i({className:"risk-matrix-row",key:"hdr-column"},F(a,""),G(a,a.translate("UNMITIGATED_RISK_CAPTION")),H(a,b,a.translate("MITIGATED_RISK")))}function F(a,b){return j({className:"risk-matrix-cell header empty",key:"hdr-empty"},b)}function G(a,b){return j({className:"risk-matrix-cell header top",key:"hdr-unmtg",title:b},s.abbreviate(b,15)+": ")}function H(a,b,c){return b?j({className:"risk-matrix-cell header top",key:"hdr-mtg",title:c},s.abbreviate(c,15)+": "):j({style:{display:"none"},key:"hdr-mtg-hide"})}function I(a,b,c){void 0===c&&(c=!0)
;var d={className:"risk-matrix-cell header side",key:"hdr-cell",title:b},e=s.abbreviate(b,15)+": ";return c?j(d,e,J(a.getMatrix().currency)):j(d,e)}function J(a){return f({className:"risk-matrix-currency"},a)}function K(a,c,d,e,f,g,h,j){var k=b.length(c.probabilities);return i({className:"risk-matrix-row",key:"probability-row"},I(a,j,!1),k>0?Q(a,c,d,e,g):T(a,d,e,g),k>0?$(a,c,d,e,f,h):aa(a,d,f,h))}function L(a,b,c,d,e,f,g){return i({className:"risk-matrix-row",key:"productionLoss-row"},I(a,g),U(a,b,c,e),ba(a,b,d,f))}function M(a,b,c,d,e,f,g){return i({className:"risk-matrix-row",key:"maintananceCost-row"},I(a,g),V(a,b,c,e),ca(a,b,d,f))}function N(a,b,c,d,e,f,g){return i({className:"risk-matrix-row",key:"consequence-row"},I(a,g),W(a,b,c,e),da(a,b,d,f))}function O(a,b,c,d,e){return i({className:"risk-matrix-row",key:"financialRisk-row"},I(a,e),X(a,b,c),ea(a,b,d))}function P(a,b,c){return b.mitigated?i({className:"risk-matrix-row",key:"benefit-row"
},I(a,c),Y(),fa(a,b.unmitigated,b.mitigated)):i({style:{display:"none"},key:"benefit-row-hide"})}function Q(a,d,e,f,g){var h=d.probabilities;_(h)||h.unshift({factor:"",formattedName:""});var i=S.bind(null,a,null,null),l=ja.bind(null,e,a,!0),m=b.isNil(f)?"":f.notApplicable?"":b.isNil(f.probability)?"":f.probability;return j(n("risk-matrix-cell"),k(b.merge(n("picklist"),{key:"pick-unmtg",name:"unmitigated-probability",value:m,disabled:g,onChange:c.withTargetProperty("value",l),title:R(m,h)}),h.map(i)))}function R(a,c){if(b.or(b.isNil(a),b.isNil(c)))return"";var d=b.find(b.propEq("factor",a))(c);return b.isNil(d)?"":d.formattedName}function S(a,c,d,e){return b.not(b.isNil(d))&&b.not(b.isNil(c))&&Number(c.probability)<Number(e.factor)?f():l({key:e.factor,value:e.factor,name:e.formattedName},""===e.formattedName?"":e.formattedName+" ( "+a.formatFloat(e.factor)+" )")}function T(a,d,e,f){var h=ja.bind(null,d,a,!1),i=ja.bind(null,d,a,!0)
;return j(n("risk-matrix-cell"),g(b.merge(n("financial-input"),{type:"text",name:"unmitigated-probability-input",value:ia(e,"probabilityFmtValue"),disabled:f,onChange:c.withTargetProperty("value",h),onBlur:c.withTargetProperty("value",i)})))}function U(a,d,e,f){var h=ja.bind(null,d,a,!1),i=ja.bind(null,d,a,!0);return j(n("risk-matrix-cell"),g(b.merge(n("financial-input"),{type:"text",name:"unmitigated-production-loss",value:ia(e,"productionLossFmtValue"),disabled:f,onChange:c.withTargetProperty("value",h),onBlur:c.withTargetProperty("value",i)})))}function V(a,d,e,f){var h=ja.bind(null,d,a,!1),i=ja.bind(null,d,a,!0);return j(n("risk-matrix-cell"),g(b.merge(n("financial-input"),{type:"text",name:"unmitigated-maintanance-cost",value:ia(e,"maintenanceCostFmtValue"),disabled:f,onChange:c.withTargetProperty("value",h),onBlur:c.withTargetProperty("value",i)})))}function W(a,d,e,f){var h=ja.bind(null,d,a,!1),i=ja.bind(null,d,a,!0)
;return j(n("risk-matrix-cell"),g(b.merge(n("financial-input"),{type:"text",name:"unmitigated-consequence",value:ia(e,"consequenceFmtValue"),disabled:f,onChange:c.withTargetProperty("value",h),onBlur:c.withTargetProperty("value",i)})))}function X(a,c,d){return j(n("risk-matrix-cell"),g(b.merge(n("financial-input"),{type:"text",name:"unmitigated-financial-risk",value:ia(d,"rankFmtValue"),disabled:"disabled"})))}function Y(){return j(n("risk-matrix-cell top"),g(b.merge(n("financial-input"),{type:"text",name:"unmitigated-benefit",value:"",disabled:"disabled"})))}function Z(a){return b.compose(b.gte(a),b.prop("factor"))}function $(a,d,e,f,g,h){if(!g)return j({style:{display:"none"},key:"mtg-pick-prob-hide"});var i=isNaN(Number(f.probability))?d.probabilities:b.filter(Z(f.probability),d.probabilities);_(i)||i.unshift({factor:"",formattedName:""});var l=S.bind(null,a,f,g),m=ja.bind(null,e,a,!0),o=b.isNil(g)?"":g.notApplicable?"":b.isNil(g.probability)?"":g.probability
;return j(n("risk-matrix-cell"),k(b.merge(n("picklist"),{key:"mtg-pick-prob",name:"mitigated-probability",value:o,disabled:h,onChange:c.withTargetProperty("value",m),title:R(o,i)}),i.map(l)))}function _(a){return b.any(b.propEq("factor",""),a)}function aa(a,d,e,f){if(!e)return j({style:{display:"none"},key:"mtg-input-prob-hide"});var h=ja.bind(null,d,a,!1),i=ja.bind(null,d,a,!0);return j(n("risk-matrix-cell"),g(b.merge(n("financial-input"),{type:"text",name:"mitigated-probability-input",value:ia(e,"probabilityFmtValue"),disabled:f,onChange:c.withTargetProperty("value",h),onBlur:c.withTargetProperty("value",i)})))}function ba(a,d,e,f){if(!e)return j({style:{display:"none"},key:"mtg-prodloss-hide"});var h=ja.bind(null,d,a,!1),i=ja.bind(null,d,a,!0);return j(n("risk-matrix-cell"),g(b.merge(n("financial-input"),{type:"text",name:"mitigated-production-loss",value:ia(e,"productionLossFmtValue"),disabled:f,onChange:c.withTargetProperty("value",h),onBlur:c.withTargetProperty("value",i)})))}
function ca(a,d,e,f){if(!e)return j({style:{display:"none"},key:"mtg-maintcost-hide"});var h=ja.bind(null,d,a,!1),i=ja.bind(null,d,a,!0);return j(n("risk-matrix-cell"),g(b.merge(n("financial-input"),{type:"text",name:"mitigated-maintanance-cost",value:ia(e,"maintenanceCostFmtValue"),disabled:f,onChange:c.withTargetProperty("value",h),onBlur:c.withTargetProperty("value",i)})))}function da(a,d,e,f){if(!e)return j({style:{display:"none"},key:"mtg-conseq-hide"});var h=ja.bind(null,d,a,!1),i=ja.bind(null,d,a,!0);return j(n("risk-matrix-cell"),g(b.merge(n("financial-input"),{type:"text",name:"mitigated-consequence",value:ia(e,"consequenceFmtValue"),disabled:f,onChange:c.withTargetProperty("value",h),onBlur:c.withTargetProperty("value",i)})))}function ea(a,c,d){return d?j(n("risk-matrix-cell"),g(b.merge(n("financial-input"),{type:"text",name:"mitigated-financial-risk",value:ia(d,"rankFmtValue"),readOnly:!0}))):j({style:{display:"none"},key:"mtg-fnrisk-hide"})}function fa(a,c,d){
return d?j(n("risk-matrix-cell"),g(b.merge(n("financial-input"),{type:"text",name:"mitigated-benefit",value:d.notApplicable?"":ga(a,c,d),readOnly:!0}))):j({style:{display:"none"},key:"mtg-benefit-hide"})}function ga(a,c,d){var e=b.isNil(d)?"":c.rank-d.rank;return isNaN(e)?"":a.formatFloat(e,0)}function ha(a){if(a.vm.getHideNotApplicable())return f({style:{display:"none"},key:"notappl-hide"},"");var d=b.isNil(a.risk.mitigated)?a.risk.unmitigated:a.risk.mitigated,e=ka.bind(null,a.onNAChange,a.vm,d),h=a.readonly||b.not(b.isNil(a.risk.mitigated))&&!a.vm.hasCalculatorFunction();return f({className:"legend-icon-container",key:"notappl-show"},g({type:"checkbox",name:"not-applicable-financial",className:"notApplicable",checked:!!d&&d.notApplicable,disabled:h,onChange:c.withTargetProperty("checked",e)}),m(r,a.vm.translate("NOT_APPLICABLE_TEXT")))}function ia(a,c){return b.isNil(a)||a.notApplicable||!a[c]?"":a[c]}function ja(a,b,d,e,f){var g=f.target,h={value:{self:b,format:d}}
;a(c.newEvent(g,h))}function ka(a,b,d,e,f){var g=f.target,h={value:{vm:b,checked:e,risk:d}};a(c.newEvent(g,h))}});
define('ui/elements/risk-matrix/views/components/nonfinancial-matrix',["require","exports","react","ramda","system/react/react-common"],function(require,exports,a,b,c){"use strict";var d=a.DOM,e=d.div,f=d.input,g=d.i,h=d.span,i=d.tbody,j=d.tr,k=d.td,l=d.label,m=b.objOf("className"),n=function(a){return g(m(a))},o=function(){for(var a=[],b=0;b<arguments.length;b++)a[b-0]=arguments[b];return e.apply(void 0,[m("risk-matrix-tab")].concat(a))},p=function(){for(var b=[],c=0;c<arguments.length;c++)b[c-0]=arguments[c];return(d=a.DOM).table.apply(d,[m("risk-matrix-container")].concat(b));var d},q=void 0;function r(a){var c=a.category,d=a.risk.unmitigated,f=b.isNil(a.risk.mitigated)?null:a.risk.mitigated;return e({className:"risk-matrix-wrapper",style:Q(c)},o(u(a.vm,c),v(a,d,f),L(a),s(a)))}exports.NonfinancialMatrix=r;function s(a){if(a.vm.getMatrix().showFinancialImpactValues===!1)return e();var d=a.vm,g=a.risk.unmitigated,h=t.bind(null,a.onInputChange,d,!1),i=t.bind(null,a.onInputChange,d,!0),j=b.not(b.isNil(a.risk.mitigated)||void 0===a.risk.mitigated)
;return e(m("risk-matrix-block-group"),l(q,d.translate("FINANCIAL_IMPACT_CAPTION")),f(b.merge(m("block financial-input"),{type:"text",name:"unmitigated-financial-impact",value:g.notApplicable?"":g.financialImpact?g.financialImpact:"",disabled:!!b.or(j,g.notApplicable),onChange:c.withTargetProperty("value",h),onBlur:c.withTargetProperty("value",i)})))}function t(a,b,d,e,f){var g=f.target,h={value:{self:b,format:d}};a(c.newEvent(g,h))}function u(a,b){var c=b.matrix.probabilityAxisValue,d="XAXIS"===c?"PROBABILITY":"CONSEQUENCE";return e({className:"x-axis-caption",key:"x-axis-caption"},a.translate(d))}function v(a,b,c){var d=P(a.category);return w([x(a.vm,a.category,d),D(a,b,c,d)])}function w(a){return e(m("risk-matrix-block-group"),p(i.apply(void 0,[q].concat(a))))}function x(a,b,c){var d=b.xCollection,e=z.bind(null,a,c);return j({className:"risk-matrix-row header",key:b.name},y(a,b),d.map(e))}function y(a,b){var c=b.matrix.probabilityAxisValue,d="XAXIS"!==c?"PROBABILITY":"CONSEQUENCE"
;return k({className:"y-axis-caption"},a.translate(d))}function z(a,b,c){return k({style:C(b),className:"risk-matrix-cell",key:c.headerValue,title:c.formattedDescription},e({key:c.headerTitle},A(c.headerTitle),B(a.formatFloat(c.headerValue))))}function A(a){return e({className:"header-title",key:a},a)}function B(a){return h({className:"header-value"},a)}function C(a){return{width:a.width,height:a.height}}function D(a,b,c,d){var e=a.category.rowArray,f=E.bind(null,a,b,c,d);return e.map(f)}function E(a,b,c,d,e){var f=e.data,g=G.bind(null,a,b,c,d,a.value);return j({className:"risk-matrix-row",key:e.headerValue},F(a.vm,e),f.map(g))}function F(a,b){return k({className:"risk-matrix-cell header",title:b.formattedDescription},e({key:b.headerTitle},A(b.headerTitle),B(a.formatFloat(b.headerValue))))}function G(a,d,f,g,h,i){var j=!!H(a,d,f,i)||(b.isNil(f)?d.notApplicable:f.notApplicable),l=S.bind(null,a.onCellClick,a.vm,i,j);return k({key:i.consequence+"/"+i.probability,style:K(g,i),
name:"matrix-cell",className:"risk-matrix-cell clickable",title:i.threshold.formattedDescription,disabled:j,"data-probability":i.probability,"data-consequence":i.consequence,onClick:c.withTargetProperty("data",l)},e({key:i.headerTitle},a.vm.formatFloat(i.value),I(d,i),J(f,i)))}function H(a,c,d,e){return!!(a.readonly||a.category.matrix.hideNumericRiskRank&&b.isNil(a.category.matrix.showAlias))||!b.isNil(a.risk.mitigated)&&!a.vm.hasCalculatorFunction()&&(!(!b.lt(Number(c.consequence),e.consequence)&&!b.lt(Number(c.probability),e.probability))||!(!b.equals(a.category.matrix.lockMitigatedConsequence,!0)||!b.not(b.equals(c.consequence,e.consequence))))}function I(a,b){return!a||a.notApplicable?q:a.probability===b.probability&&a.consequence===b.consequence?n("icon-riskmatrix-exclamation"):void 0}function J(a,b){return!a||a.notApplicable?null:a&&a.probability===b.probability&&a.consequence===b.consequence?n("icon-riskmatrix-tick"):void 0}function K(a,b){return{width:a.width,height:a.height,
backgroundColor:b.threshold.color}}function L(a){return e({className:"legend-icon-container",key:2},M(a),N(a.vm),O(a.vm))}function M(a){if(a.vm.getHideNotApplicable())return h({style:{display:"none"}},"");var d=b.isNil(a.risk.mitigated)?a.risk.unmitigated:a.risk.mitigated,e=R.bind(null,a.onNAChange,a.vm,d),g=a.readonly||b.not(b.isNil(a.risk.mitigated));return h({className:"legend-icon-container",key:"notApplicable"},f({type:"checkbox",name:"not-applicable-nonfinancial",className:"notApplicable",checked:!!d&&d.notApplicable,disabled:g,onChange:c.withTargetProperty("checked",e)}),l(q,a.vm.translate("NOT_APPLICABLE_TEXT")))}function N(a){return h(q,n("icon-riskmatrix-tick"),l(q,a.translate("MITIGATED_RISK")))}function O(a){return h(q,n("icon-riskmatrix-exclamation"),l(q,a.translate("UNMITIGATED_RISK")))}function P(a){var b={width:"",height:""};return b.width=Math.floor(100/(a.xCollection.length+1))+"%",b.height="calc("+Math.floor(100/a.yCollection.length)+"% - 20px)",b}function Q(a){
return{maxWidth:b.isEmpty(a.protectionLevels)?"calc(100% - 105px)":"calc(100% - 205px)"}}function R(a,b,d,e,f){var g=f.target,h={value:{vm:b,checked:e,risk:d}};a(c.newEvent(g,h))}function S(a,b,d,e,f,g){var h=g.target,i={value:{cell:d,vm:b}};e||a(c.newEvent(h,i))}});
define('system/drawing/linear-scale',[],function(){"use strict";function a(a,b){this.inputRange=a,this.outputRange=b}return a.prototype.calculate=function a(b){var c=(b-this.inputRange[0])/(this.inputRange[1]-this.inputRange[0]);return(this.outputRange[1]-this.outputRange[0])*c+this.outputRange[0]},a.prototype.calculateInt=function a(b){return Math.floor(this.calculate(b))},a.prototype.calculateInverse=function a(b){var c=(b-this.outputRange[0])/(this.outputRange[1]-this.outputRange[0]);return(this.inputRange[1]-this.inputRange[0])*c+this.inputRange[0]},a.prototype.calculateInverseInt=function a(b){return Math.floor(this.calculateInverse(b))},a});
define('ui/elements/range/range-point',['require','knockout'],function(require){"use strict";var a=require("knockout"),b=24;function c(b){b=b||{},this.barColorBefore=a.observable(a.unwrap(b.barColorBefore)),this.barColorAfter=a.observable(a.unwrap(b.barColorAfter)),this.allowCrossPoints=a.observable(a.unwrap(b.allowCrossPoints===!0)),this.color=a.observable(a.unwrap(b.color)),this.cssClass=a.observable(a.unwrap(b.cssClass)),this.name=a.observable(a.unwrap(b.name)),this.value=a.observable(a.unwrap(b.value)),this.landscape=a.observable(a.unwrap(b.landscape)),this.position=a.observable(a.unwrap(b.position)),this.handlePosition=a.pureComputed(d.bind(null,this)),this.zIndex=a.observable(b.zIndex||1)}function d(a){return a.position()-Math.floor(b/2)+"px"}return c.prototype.getTransform=function(a){return"translate("+(a?this.handlePosition():"0px")+", "+(a?"0px":this.handlePosition())+")"},c.prototype.getLabelTransform=function(a){var c=this.position()-b;return"translate("+(a?c+"px":"0px")+", "+(a?"0px":c+"px")+")"},c});

define('text!./view.html!strip',[],function () { return '\r\n<section class="mi-range-container" data-bind="css: { \'horizontal\': landscape(), \'vertical\': !landscape(), \'rtl\': rtl() }">\r\n    <div class="mi-range-bar" data-bind="style: { \'background-image\': barGradient }, click: onBarClicked.bind($data)"></div>\r\n    \r\n    <span class="mi-range-min h4" data-bind="text: formatValue(min())"></span>\r\n    <span class="mi-range-max h4" data-bind="text: formatValue(max())"></span>\r\n\r\n    <!-- ko foreach: points -->\r\n    <div class="mi-range-point" data-bind="css: cssClass,\r\n        style: {\r\n            \'backgroundColor\': color,\r\n            \'transform\': getTransform($parent.landscape()),\r\n            \'-webkit-transform\': getTransform($parent.landscape()),\r\n            \'zIndex\': zIndex\r\n        },\r\n        \'mi-range-slider-point-drag\': {\r\n            onmove: $parent.onPointMoved.bind($parent, $data),\r\n            ondragstart: $parent.onPointDragStart.bind($parent, $data),\r\n            ondragend: $parent.onPointDragEnd.bind($parent, $data)\r\n        }">\r\n    </div>\r\n    \r\n    <div class="mi-range-point-value popover" data-bind="\r\n        style: {\r\n            \'transform\': getLabelTransform($parent.landscape()),\r\n            \'-webkit-transform\': getLabelTransform($parent.landscape()),\r\n        }">\r\n        <h3 class="popover-title">\r\n            <!-- ko if: name -->\r\n            <span data-bind="text: name"></span>\r\n            <!-- /ko -->\r\n            <span data-bind="text: $parent.getDisplayValue(value())"></span>\r\n        </h3>\r\n    </div>\r\n    <!-- /ko -->\r\n</section>';});

define('ui/elements/range/view-model',['require','lodash','jquery','spa/ko/knockout-view-model','knockout','application/application-events','system/text/formatter','system/drawing/linear-scale','./range-point','system/lang/event','text!./view.html!strip','system/lang/object'],function(require){"use strict";var a=require("lodash"),b=require("jquery"),c=require("spa/ko/knockout-view-model"),d=require("knockout"),e=require("application/application-events"),f=Object.resolve(require("system/text/formatter")),g=require("system/drawing/linear-scale"),h=require("./range-point"),i=require("system/lang/event"),j=require("text!./view.html!strip"),k="#CCC",l="#CCC";require("system/lang/object");function m(){n.call(this,j),this.appEvents=Object.resolve(e),this.min=d.observable(0),this.max=d.observable(100),this.step=d.observable(),this.stepValues=d.observableArray(),this.barStartColor=d.observable(l),this.barEndColor=d.observable(l),this.region=null,this.componentSize=d.observable(200),this.valueFormat=d.observable("n0"),this.value=d.observable(),this.points=d.pureComputed(v.bind(null,this)),this.landscape=d.observable(!0),this.landscape.subscribe(o.bind(null,this)),this.barGradient=d.pureComputed(r.bind(null,this)),this.rtl=d.observable(!1),
this.scale=d.computed(p.bind(null,this)),this.scale.subscribe(u.bind(null,this)),this.nextZIndex=2,this.dragData=null,this.rangeBarClicked=new i,this.afterPointMoved=new i}var n=Object.inherit(c,m);function o(a){if(!a.region)return 0;var b=a.landscape()?a.region.$element.width():a.region.$element.height();a.componentSize(b)}function p(a){var b=a.min(),c=a.max(),d=a.componentSize();return q(a)?new g([c,b],[0,d]):new g([b,c],[0,d])}function q(a){var b=a.landscape(),c=a.rtl();return c&&b||!c&&!b}function r(a){return q(a)?t(a):s(a)}function s(b){var c=b.barStartColor()||l,d=b.landscape()?"to right, ":"",e="linear-gradient("+d+c;return a.each(b.points(),function(a){a.barColorBefore()&&(c=a.barColorBefore(),e+=", "+c+" "+a.position()+"px"),a.barColorAfter()&&(c=a.barColorAfter(),e+=", "+c+" "+a.position()+"px")}),c=b.barEndColor()?b.barEndColor():l,e+=", "+c+")"}function t(b){var c=b.barEndColor()||l,d=b.landscape()?"to right, ":"",e="linear-gradient("+d+c,f
;return f=b.points().slice(0).reverse(),a.each(f,function(a){a.barColorAfter()&&(c=a.barColorAfter(),e+=", "+c+" "+a.position()+"px"),a.barColorBefore()&&(c=a.barColorBefore(),e+=", "+c+" "+a.position()+"px")}),c=b.barStartColor()?b.barStartColor():l,e+=", "+c+")"}function u(b,c){a.each(b.points(),function(a){a.position(c.calculate(a.value()))})}function v(b){return b.value()?a.map(b.value(),w.bind(null,b)):[]}function w(c,d){var e={color:k,landscape:c.landscape()};return a.isObject(d)?e=b.extend(e,d):isNaN(d)?e.value=c.min():e.value=d,e.value=parseFloat(e.value),e.value<parseFloat(c.min())&&(e.value=parseFloat(c.min())),e.value>parseFloat(c.max())&&(e.value=parseFloat(c.max())),e.position=c.scale().calculate(e.value),new h(e)}m.prototype.attach=function(b){this.region=b,o(this),n.prototype.attach.apply(this,arguments),this.debouncedResize=a.debounce(this.windowResized.bind(this),250),this.appEvents.windowResized.add(this.debouncedResize,this)},m.prototype.windowResized=function(){
o(this)},m.prototype.detach=function(){this.appEvents.windowResized.remove(this)},m.prototype.onBarClicked=function(a,b){var c=this.landscape()?b.offsetX:b.offsetY,d=this.scale().calculateInverse(c);d=C(this.step(),this.stepValues(),d),this.rangeBarClicked.raise(d)},m.prototype.onPointDragStart=function(b,c){var d=a.indexOf(this.points(),b),e=this.points().length;this.dragData={index:d,previousPoint:a(this.points()).slice(0,d).filter(x).last(),nextPoint:a(this.points()).slice(d+1).filter(x).first()},this.nextZIndex++,b.zIndex(this.nextZIndex)};function x(a){return!a.allowCrossPoints()}m.prototype.onPointMoved=function(a,b){var c=this.landscape()?b.dx:b.dy,d=a.value()+(this.scale().calculateInverse(c)-this.scale().inputRange[0]),e;d=y(this,d),d=z(this,a,d),e=this.scale().calculate(d),a.position(e),a.value(d)};function y(a,b){return b<a.min()?b=a.min():b>a.max()&&(b=a.max()),b}function z(a,b,c){return b.allowCrossPoints()?c:(c=A(a,c),c=B(a,c))}function A(a,b){
return a.dragData.index>0&&a.dragData.previousPoint&&b<a.dragData.previousPoint.value()&&(b=a.dragData.previousPoint.value()),b}function B(a,b){return a.dragData.index<a.points().length-1&&a.dragData.nextPoint&&b>a.dragData.nextPoint.value()&&(b=a.dragData.nextPoint.value()),b}m.prototype.onPointDragEnd=function(a,b){var c=this.step(),e=this.stepValues(),f,g;c&&(f=C(c,e,a.value()),g=this.scale().calculate(f),a.position(g),a.value(f)),this.afterPointMoved.raise(d.toJS(a)),this.dragData=null,E(this)};function C(a,b,c){var d=c;return a&&b&&b.length>0?d=D(c,b):a&&(d=Math.round(c/a)*a),d}function D(a,b){return b.reduce(function(b,c){return Math.abs(c-a)<Math.abs(b-a)?c:b})}function E(b){var c=[];a.each(b.points(),function(e,f){var g;a.isObject(b.value()[f])?(g=b.value()[f],d.isObservable(g.value)?g.value(e.value()):g.value=e.value(),d.isObservable(g.zIndex)?g.zIndex(e.zIndex()):g.zIndex=e.zIndex(),c.push(g)):c.push(e.value())}),b.value(c)}return m.prototype.formatValue=function(a){
return f.format(a,this.valueFormat())},m.prototype.getDisplayValue=function(a){return this.formatValue(C(this.step(),this.stepValues(),a))},m});
define('ui/elements/range/drag-binding',['require','jquery','knockout','interact'],function(require){"use strict";var a=require("jquery"),b=require("knockout"),c=require("interact");b.bindingHandlers["mi-range-slider-point-drag"]={init:function(d,e){var f=e();b.utils.domNodeDisposal.addDisposeCallback(d,function(){c.isSet(d)&&c(d).off("dragstart",f.ondragstart||a.noop).off("dragmove",f.onmove||a.noop).off("dragend",f.ondragend||a.noop).draggable(!1).unset()})},update:function(b,d){var e=d();c(b).draggable(!0).on("dragstart",e.ondragstart||a.noop).on("dragmove",e.onmove||a.noop).on("dragend",e.ondragend||a.noop)}}});
define('ui/elements/range/component',['require','spa/region','spa/conductor','./view-model','system/lang/object','./drag-binding'],function(require){"use strict";var a=require("spa/region"),b=require("spa/conductor"),c=require("./view-model"),d={};require("system/lang/object"),require("./drag-binding"),d.prototype=Object.create(HTMLElement.prototype),d.prototype.createdCallback=function(){this.attached=!1,this.conductor=Object.resolve(b),this.region=new a,this.viewModel=new c;var d=this;Element.defineProperty(this,"min",{get:this.viewModel.min,set:e.bind(null,this.viewModel.min)}),Element.defineProperty(this,"max",{get:this.viewModel.max,set:e.bind(null,this.viewModel.max)}),Element.defineProperty(this,"step",{get:this.viewModel.step,set:e.bind(null,this.viewModel.step)}),Element.defineProperty(this,"stepValues",{get:this.viewModel.stepValues,set:this.viewModel.stepValues}),Element.defineProperty(this,"valueFormat",{get:this.viewModel.valueFormat,set:this.viewModel.valueFormat}),Element.defineProperty(this,"barStartColor",{get:this.viewModel.barStartColor,set:this.viewModel.barStartColor}),
Element.defineProperty(this,"barEndColor",{get:this.viewModel.barEndColor,set:this.viewModel.barEndColor}),Element.defineProperty(this,"landscape",{get:this.viewModel.landscape,set:function(a){void 0!==a&&null!==a&&d.viewModel.landscape(a)}}),Element.defineProperty(this,"rtl",{get:this.viewModel.rtl,set:function(a){void 0!==a&&null!==a&&d.viewModel.rtl(a)}}),Element.defineProperty(this,"value",{get:this.viewModel.value,set:this.viewModel.value}),this.viewModel.value.subscribe(f.bind(null,this))};function e(a,b){var c=b;isNaN(c)&&(c=0),a(c)}function f(a,b){Element.raiseEvent(a,"change")}return d.prototype.attachedCallback=function(){this.attached=!0,Element.clearDom(this);var a=Element.build("section",this,["fill"],{"data-bind":"halt-bindings: {}"});this.region.setElement(a),this.conductor.changeScreen(this.viewModel,this.region),this.viewModel.afterPointMoved.add(this.afterPointMoved,this),this.viewModel.rangeBarClicked.add(this.rangeBarClicked,this)},
d.prototype.afterPointMoved=function(a){Element.raiseEvent(this,"afterPointMoved",{point:a})},d.prototype.rangeBarClicked=function(a){Element.raiseEvent(this,"rangeBarClicked",{valueAtPoint:a})},d.prototype.detachedCallback=function(){this.viewModel.afterPointMoved.remove(this),this.viewModel.rangeBarClicked.remove(this),this.attached=!1,this.conductor.clearScreen(this.region)},d.prototype.attributeChangedCallback=function(a,b,c){Object.tryMethod(this,a+"Changed",b,c)},Element.registerElement("mi-range",{prototype:d.prototype}),d});
define('ui/elements/risk-matrix/views/components/slider',["require","exports","jquery","react","react-dom","ramda","ui/elements/range/component"],function(require,exports,a,b,c,d){"use strict";var e=b.DOM.div,f=d.objOf("className");return require("ui/elements/range/component"),function(g){__extends(h,g);function h(a){var b=g.call(this,a)||this;return b.slider=null,b}return h.prototype.render=function(){var a=this.props;return e(f("risk-protection-level-slider"),b.createElement("mi-range",{value:a.value,valueFormat:"n1",min:this.sliderMinValue,max:this.sliderMaxValue,stepValues:this.sliderValues,step:this.sliderStep,landscape:!1,barStartColor:"#00bfff",barEndColor:"#87cefa"}))},h.prototype.componentDidMount=function(){this.setSlider(this)},h.prototype.shouldComponentUpdate=function(a){return!d.equals(this.props.stepValues,a.stepValues)||this.props.value[0].value[0]!==a.value[0].value[0]},h.prototype.componentWillUpdate=function(a){if(!this.slider){var b=c.findDOMNode(this);this.slider=b.querySelectorAll("mi-range")[0]}
this.setSlider(this,a)},h.prototype.setSlider=function(b,e){var f=c.findDOMNode(b);b.slider=f.querySelectorAll("mi-range")[0],b.sliderMinValue=d.isNil(e)?b.props.min:e.min,b.sliderMaxValue=d.isNil(e)?b.props.max:e.max,b.sliderStep=1,b.sliderValues=d.isNil(e)?b.props.stepValues:e.stepValues,b.slider.value=d.isNil(e)?b.props.value:e.value,b.slider.valueFormat="n0",b.slider.min=d.isNil(e)?b.props.min:e.min,b.slider.max=d.isNil(e)?b.props.max:e.max,b.slider.step=1,b.slider.stepValues=d.isNil(e)?b.props.stepValues:e.stepValues,b.slider.landscape=!1,b.slider.barStartColor="#00bfff",b.slider.barEndColor="#87cefa",a(b.slider).on("change",b.props.vm.updateProtectionLevel.bind(null,b.props.vm))},h}(b.Component)});
define('ui/elements/risk-matrix/views/components/protection-level',["require","exports","react","ramda","ui/elements/risk-matrix/views/components/slider"],function(require,exports,a,b,c){"use strict";var d=a.DOM,e=d.div,f=d.input,g=d.label,h=b.objOf("className"),i=void 0;function j(a){return k(a)}exports.ProtectionLevel=j;function k(a){return e({className:"risk-protection-level"},l(a),p(a.vm,a.risk.unmitigated))}function l(a){if(0===a.category.protectionLevels.length)return e({style:{display:"none"}},"");var b=n(a)||1;return e({className:a.readonly?"risk-protection-level-div no-access":"risk-protection-level-div"},m(a,b),o(a.vm,b))}function m(d,e){if(e){var f=b.pluck("factor")(d.category.protectionLevels),g=b.reduce(b.min,1/0,f),h=b.reduce(b.max,-(1/0),f),i=[{value:[e],valueFormat:"n1",barColorBefore:"#00bfff",barColorAfter:"#87cefa"}];return a.createElement(c,{value:i,min:g,max:h,stepValues:f,landscape:!1,vm:d.vm,readonly:d.readonly})}}function n(a){if(!b.isNil(a.risk)){var c=a.risk
;return b.isNil(a.risk.mitigated)?c.unmitigated.protectionLevel:c.mitigated.protectionLevel}}function o(a,c){return e(h("protection-level-caption"),a.translate("PROTECTION_LEVEL"),f(b.merge(h("protection-value"),{type:"text",name:"protectionCaption",value:b.isNil(c)?1:c,disabled:"disabled"})))}function p(a,c){return e(h("protected-text"),g(i,a.translate("UNMITIGATED_CAPTION")),f(b.merge(h("form-control"),{type:"text",name:"protectionText",value:b.isNil(c.protectionLevel)?1:c.protectionLevel,disabled:"disabled"})))}});
define('ui/elements/risk-matrix/views/risk-matrix-view',["require","exports","react","ramda","ui/elements/risk-matrix/views/components/categories-list","ui/elements/risk-matrix/views/components/financial-matrix","ui/elements/risk-matrix/views/components/nonfinancial-matrix","ui/elements/risk-matrix/views/components/protection-level"],function(require,exports,a,b,c,d,e,f){"use strict";var g=a.DOM,h=g.div,i=g.span,j=b.partial(h,[b.objOf("className")("risk-matrix-component")]),k=b.partial(h,[b.objOf("className")("risk-matrix-area")]);function l(a){var b=a.vm,c=a.value||b.getValue(),d=a.matrix||b.getMatrix(),e=d?d.categories:[],f=b.getCategory()||e[0];return d&&f?j(m(b,c,d,e),k(p(b,c,e,f),q(b,c,f),t(b,f))):h()}exports.RiskMatrixView=l;function m(a,b,c,d){return h({className:"total-risk",key:0},a.translate("TOTAL_RISK"),n(a,b,c,d))}function n(a,c,d,e){var f,g=c.mitigated&&b.find(b.propEq("isFinancial",!1),c.mitigated)?c.mitigated:c.unmitigated,h=function(a){var c=b.find(b.propEq("name",a.categoryName),d.categories),e=!!c&&c.isFinancial
;return null===a.rank||e===!0||a.notApplicable===!0},j=b.reject(h,g);if(!j||0===j.length)return i(void 0,"");var k;if(d.isUsingMaxRisk){if(j){var l=b.sortBy(b.prop("rank")),m=b.last(l(j));k=m.rank}}else{k=b.compose(b.sum,b.pluck("rank"))(j)}var n=o(e[0],k);if(d.showAlias)if(j){var l=b.sortBy(b.prop("rank")),m=b.last(l(j));f=m.riskRankAlias}else f=" - ";return i({style:{color:n.color,marginLeft:"15px"}},f?f:a.formatFloat(k,2))}function o(a,b){var c=a.matrix.thresholds,d=-1,e,f;for(e=0;e<c.length;e++)c[e].value<=b&&c[e].value>d&&(f=c[e],d=c[e].value);return f}function p(b,d,e,f){return a.createElement(c.CategoriesList,{vm:b,key:1,value:d,categories:e,category:f,onClick:b.setCategory})}function q(a,b,c){return c.isFinancial?r(a,b,c):s(a,b,c)}function r(b,c,e){return a.createElement(d.FinancialMatrix,{vm:b,key:2,readonly:b.getReadOnly(),lockconsequence:b.getLockConsequence(),lockprobability:b.getLockProbability(),hidenotapplicable:b.getHideNotApplicable(),value:c,
calculator:b.getCalculator(),category:e,risk:b.getRisk(),onInputChange:b.updateFinancialRisk,onNAChange:b.setNotApplicable})}function s(b,c,d){return b.validThreshold(d)?a.createElement(e.NonfinancialMatrix,{vm:b,key:3,readonly:b.getReadOnly(),hidenotapplicable:b.getHideNotApplicable(),value:c,calculator:b.getCalculator(),category:d,risk:b.getRisk(),onInputChange:b.updateFinancialRisk,onCellClick:b.updateRiskRank,onNAChange:b.setNotApplicable}):h({style:{display:"none"},key:"nonfn-matrix-hide"},"")}function t(b,c){return c.isFinancial||0===c.protectionLevels.length?h({style:{display:"none"},key:"prot-level-hide"},""):a.createElement(f.ProtectionLevel,{vm:b,key:4,readonly:b.getReadOnly(),risk:b.getRisk(),category:c})}});
define('ui/elements/risk-matrix/view-models/risk-matrix-view-model',["require","exports","ramda","bluebird","system/lang/object","ui/elements/risk-matrix/views/risk-matrix-view","spa/react/react-view-model","system/text/formatter","system/globalization/translator","system/text/parser","system/ui/message-box","application/application-context","system/lang/converter","ui/elements/risk-matrix/models/risk-category-dto","ui/elements/risk-matrix/models/risk-rank-dto","ui/elements/risk-matrix/services/risk-matrix-service"],function(require,exports,a,b,c,d,e,f,g,h,i,j){"use strict";var k=require("system/lang/converter"),l=require("ui/elements/risk-matrix/services/risk-matrix-service"),m=require("ui/elements/risk-matrix/models/risk-category-dto"),n=require("ui/elements/risk-matrix/models/risk-rank-dto"),o="m",p=require("globalize");return function(e){__extends(q,e);function q(a){var b=e.call(this,d.RiskMatrixView)||this;return b.translator=c.resolve(g),b.formatter=new f,b.readonly=!1,b.riskmatrixkey="",b.lockConsequence=!1,b.lockProbability=!1,
b.hideNotApplicable=!1,b.showFinancialImpactValues=!1,b.matrix=null,b.value={unmitigated:[],mitigated:null},b.calculator=null,b.risk={unmitigated:new n,mitigated:null},a&&b.initProps(a),b.element=null,b.updateViewAfter(["initProps","setCategory","setMatrixByKey","raiseChangeEvent"]),b}return q.prototype.translate=function(a){return this.translator.translate(a)},q.prototype.formatFloat=function(b,c){var d=h.parseFloat(b);if(!isNaN(d)){var e=new f;return a.isNil(c)?c=o:a.is(Number,c)&&(c=o+c.toString()),e.format(d,c,j.user.cultureId)}return b},q.prototype.attachRegion=function(a){this.attach(a)},q.prototype.initProps=function(a){this.props=a,this.setMatrix(a.matrix?a.matrix:null),this.setValue(a.value),this.setCalculator(a.calculator),this.setReadOnly(!!a.readonly&&a.readonly),this.setLockConsequence(!!a.lockconsequence&&a.lockconsequence),this.setLockProbability(!!a.lockprobability&&a.lockprobability),this.setHideNotApplicable(!!a.hidenotapplicable&&a.hidenotapplicable),
this.setShowFinancialImpactValues(!!a.showFinancialImpactValues&&a.showFinancialImpactValues),this.setRiskMatrixKey(a.riskmatrixkey?a.riskmatrixkey:null)},q.prototype.getReadOnly=function(){return this.readonly},q.prototype.setReadOnly=function(a){this.readonly=a||!1},q.prototype.getRiskMatrixKey=function(){return this.riskmatrixkey},q.prototype.setRiskMatrixKey=function(a){this.riskmatrixkey=a||"",a&&void 0!==a&&this.updateMatrix(a)},q.prototype.updateMatrix=function(a){var d=c.resolve(l);return b.resolve(d.getRiskMatrixByKey(a)).then(this.setMatrixByKey.bind(null,this)).catch(b.reject)},q.prototype.setMatrixByKey=function(a,b){a.setMatrixAndRisk(a,b)},q.prototype.getLockConsequence=function(){return this.lockConsequence},q.prototype.setLockConsequence=function(a){this.lockConsequence=a},q.prototype.getLockProbability=function(){return this.lockProbability},q.prototype.setLockProbability=function(a){this.lockProbability=a},q.prototype.getHideNotApplicable=function(){
return this.hideNotApplicable},q.prototype.setHideNotApplicable=function(a){this.hideNotApplicable=a},q.prototype.getShowFinancialImpactValues=function(){return this.showFinancialImpactValues},q.prototype.setShowFinancialImpactValues=function(a){this.showFinancialImpactValues=a},q.prototype.getValue=function(){return this.value},q.prototype.setValue=function(b){if(b){var c=a.sortBy(a.prop("index"));this.value.unmitigated=c(b.unmitigated),this.value.mitigated=b.mitigated?b.mitigated:null,this.checkMitigatedFinancial(),this.setRisk()}},q.prototype.getCalculator=function(){return this.calculator},q.prototype.setCalculator=function(a){a&&(this.calculator=a,this.checkMitigatedFinancial(),this.setRisk())},q.prototype.hasCalculatorFunction=function(){var a=this.getCalculator();return a&&null!==a&&"function"==typeof a||!1},q.prototype.setCategory=function(a){a&&(this.category=a,this.setRisk(),this.raiseChangeEvent(this))},q.prototype.getCategory=function(){
var b=this.category?this.category:this.getDefaultCategory();return a.propEq("isFinancial",!1)?this.checkProtection(b):b},q.prototype.checkProtection=function(a){var b=this.getProtectionLevel();return b?new m(a,a.matrix,b):a},q.prototype.getProtectionLevel=function(){var a=this.getRisk(),b;return a.mitigated?a.mitigated.protectionLevel&&null!==a.mitigated.protectionLevel&&(b=a.mitigated.protectionLevel):a.unmitigated&&a.unmitigated.protectionLevel&&null!==a.unmitigated.protectionLevel&&(b=a.unmitigated.protectionLevel),b},q.prototype.getRisk=function(){return this.risk},q.prototype.setRisk=function(){var b=this.getCategory(),c=this.getValue();b&&(b&&c.unmitigated.length>0&&(this.risk.unmitigated=a.find(a.propEq("categoryName",b.name))(c.unmitigated),this.risk.mitigated=a.not(a.isNil(c.mitigated))?a.find(a.propEq("categoryName",b.name),c.mitigated||[]):null),
b.isFinancial&&this.risk.unmitigated&&(this.risk.unmitigated.probabilityFmtValue=this.formatRiskValue(this.risk.unmitigated.probability,!0,5),this.risk.unmitigated.productionLossFmtValue=this.formatRiskValue(this.risk.unmitigated.productionLoss,!0),this.risk.unmitigated.maintenanceCostFmtValue=this.formatRiskValue(this.risk.unmitigated.maintenanceCost,!0),this.risk.unmitigated.consequenceFmtValue=this.formatRiskValue(this.risk.unmitigated.consequence,!0),this.risk.unmitigated.rankFmtValue=this.formatRiskValue(this.risk.unmitigated.rank,!0)),b.isFinancial&&this.risk.mitigated&&(this.risk.mitigated.probabilityFmtValue=this.formatRiskValue(this.risk.mitigated.probability,!0,5),this.risk.mitigated.productionLossFmtValue=this.formatRiskValue(this.risk.mitigated.productionLoss,!0),this.risk.mitigated.maintenanceCostFmtValue=this.formatRiskValue(this.risk.mitigated.maintenanceCost,!0),this.risk.mitigated.consequenceFmtValue=this.formatRiskValue(this.risk.mitigated.consequence,!0),
this.risk.mitigated.rankFmtValue=this.formatRiskValue(this.risk.mitigated.rank,!0)))},q.prototype.checkMitigatedFinancial=function(){var b=this.getValue();if(b&&this.hasCalculatorFunction()&&this.hasUnmitigatedFinancial(b)&&!this.hasMitigatedFinancial(b)){var c=a.clone(a.find(a.propEq("isFinancial",!0),b.unmitigated)),d=null===b.mitigated?[]:b.mitigated;d.push(c),this.value.mitigated=d}},q.prototype.hasUnmitigatedFinancial=function(b){return!a.isNil(b.unmitigated)&&!a.equals(a.length(b.unmitigated),0)&&a.any(a.propEq("isFinancial",!0),b.unmitigated)},q.prototype.hasMitigatedFinancial=function(b){return!a.isNil(b.mitigated)&&!a.equals(a.length(b.mitigated),0)&&a.any(a.propEq("isFinancial",!0),b.mitigated)},q.prototype.getMatrix=function(){return this.matrix},q.prototype.setMatrix=function(a){a&&this.setMatrixAndRisk(this,a)},q.prototype.setMatrixAndRisk=function(a,b){if(a.matrix=b,a.matrix&&a.matrix.categories){var c=a.getMatrix().categories[0];c&&(a.setDefaultCategory(c),a.setRisk())}
},q.prototype.getDefaultCategory=function(){return this.defaultCategory},q.prototype.setDefaultCategory=function(a){this.defaultCategory=a},q.prototype.setNotApplicable=function(a){if(a){var b=this||a.value.vm;if(!b.getReadOnly()){var c=a.value.risk,d=a.value.checked;c.notApplicable=d,b.raiseChangeEvent(b)}}},q.prototype.updateRiskRank=function(a){if(a){var c=a.value.vm,d=this||c,e=a.value.cell,f=c.getRisk(),g;if(!f.mitigated||d.hasCalculatorFunction()){if(f.unmitigated.notApplicable)return;if(f.unmitigated.probability=e.probability,f.unmitigated.consequence=e.consequence,g=f.unmitigated.probability*f.unmitigated.consequence,f.unmitigated.rank=f.unmitigated.protectionLevel?g*f.unmitigated.protectionLevel:g,f.unmitigated.riskRankAlias=e.riskRankAlias,d.hasCalculatorFunction()){var h=d.getCalculator();b.resolve(h(f.unmitigated)).then(d.setCalculatedMitigated.bind(null,f,d.getValue())).then(d.raiseChangeEvent.bind(null,d))}else d.raiseChangeEvent(d)}else{
if(f.mitigated.notApplicable)return;f.mitigated.probability=e.probability,f.mitigated.consequence=e.consequence,g=f.mitigated.probability*f.mitigated.consequence,f.mitigated.rank=f.mitigated.protectionLevel?g*f.mitigated.protectionLevel:g,f.mitigated.riskRankAlias=e.riskRankAlias,d.raiseChangeEvent(d)}}},q.prototype.setCalculatedMitigated=function(b,c,d){if(!a.equals(b.mitigated,d)&&(b.mitigated=a.clone(d),c&&c.mitigated)){var e=a.indexOf(d.categoryName,a.pluck("categoryName",c.unmitigated));a.not(a.equals(-1,e))&&(c.mitigated[e]=b.mitigated)}},q.prototype.setProtectionLevel=function(a,b){return new m(a,a.matrix,b)},q.prototype.updateProtectionLevel=function(a,b){if(b){var c=this||a;if(c){var d=c.getCategory(),e=b.currentTarget.value[0].value[0]||b.currentTarget.value[0].value;if(e!==d.protectionLevel){var f=c.getRisk(),g=d.protectionLevels.length-1,h=0;if(c.validProtectionLevel(c,e,f)){
for(h=0;h<=g;h++)d.protectionLevels[h].factor===k.toInteger(e)&&(d.protectionLevels[h].nameID=k.toString(e),d.protectionLevels[h].descriptionID=k.toString(e),d.protectionLevels[h].formattedName=k.toString(e),d.protectionLevels[h].formattedDescription=k.toString(e)),d.consequences[g-h].factorUI=d.consequences[g-h].factor*e,d.probabilities[h].factorUI=d.probabilities[h].factor*e;d=new m(d,d.matrix,e),c.setCategory(d),c.updateProtection(c,e),c.raiseChangeEvent(c)}}}}},q.prototype.updateProtection=function(a,b){var c=a.getRisk();c.mitigated?(c.mitigated.protectionLevel=b,c.mitigated.probability&&c.mitigated.consequence&&(c.mitigated.rank=c.mitigated.probability*c.mitigated.consequence*b)):(c.unmitigated.protectionLevel=b,c.unmitigated.probability&&c.unmitigated.consequence&&(c.unmitigated.rank=c.unmitigated.probability*c.unmitigated.consequence*b))},q.prototype.updateFinancialRisk=function(b){if(b){
var c=b.target.name,d=b.target.value,e=this||b.value.self,f=b.value.format,g=a.head(a.filter(a.propEq("isFinancial",!0),e.getValue().unmitigated)),h=a.isNil(e.getValue().mitigated)?null:a.head(a.filter(a.propEq("isFinancial",!0),e.getValue().mitigated||[]));switch(c){case"unmitigated-probability-input":case"unmitigated-probability":e.probability_change(e,d,g,f);break;case"unmitigated-production-loss":e.productionLoss_change(e,d,g,f);break;case"unmitigated-financial-impact":e.financialImpact_change(e,d,g,f);break;case"unmitigated-maintanance-cost":e.maintenanceCost_change(e,d,g,f);break;case"unmitigated-consequence":e.consequence_change(e,d,g,f);break;case"mitigated-probability-input":case"mitigated-probability":e.mitigatedProbability_change(e,d,g,h,f);break;case"mitigated-production-loss":e.mitigatedProductionLoss_change(e,d,g,h,f);break;case"mitigated-maintanance-cost":e.mitigatedMaintenanceCost_change(e,d,g,h,f);break;case"mitigated-consequence":
e.mitigatedConsequence_change(e,d,g,h,f);break;default:return}e.raiseChangeEvent(e)}},q.prototype.raiseChangeEvent=function(a){var b=new CustomEvent("change",{bubbles:!0}),c=document.querySelector("mi-risk-matrix");c&&c.dispatchEvent(b)},q.prototype.probability_change=function(b,c,d,e){if(!a.isNil(d)){if("."===c&&(c="0."),!this.isNumber(c)){return void(e||this.displayErrorMsg(b,"RISK_ASSESSMENT_PROBABILITY_ERROR_MSG"))}c=this.changeDecSep(c),d.probability=h.parseFloat(c),d.probabilityFmtValue=this.formatRiskValue(c,e,5),e&&this.calculateFinancialRiskUnmtg(d)}},q.prototype.changeDecSep=function(a,b){var c=p.findClosestCulture(b),d=c.numberFormat,e=d["."];return a=a.replace(".",e)},q.prototype.validProtectionLevel=function(b,c,d){if(d.mitigated&&a.and(a.not(a.isNil(d.unmitigated.protectionLevel)),a.gt(c,h.parseFloat(d.unmitigated.protectionLevel)))){var e=b.translator.translate("PROTECTION_LEVEL_Exceeded_ERROR_MSG");return this.displayErrorMsg(b,e),!1}return!0},
q.prototype.formatRiskValue=function(b,c,d){return a.isEmpty(b)?null:(a.isNil(d)&&(d=this.getMatrix().financialPrecision),c?this.formatFloat(b,d):b)},q.prototype.productionLoss_change=function(b,c,d,e){if(!a.isNil(d)){if(!this.isNumber(c)){return void this.displayErrorMsg(b,"RISK_ASSESSMENT_PRODUCTION_LOSS_ERROR_MSG")}var f=h.parseFloat(c);d.productionLoss=isNaN(f)?null:f,d.productionLossFmtValue=this.formatRiskValue(c,e),e&&this.calculateConsequence(d,!1)}},q.prototype.financialImpact_change=function(b,c,d,e){if(!this.isNumber(c)){return void this.displayErrorMsg(b,"RISK_ASSESSMENT_FINANCIAL_IMPACT_ERROR_MSG")}a.isNil(b.risk)||a.isNil(b.risk.unmitigated)||(b.risk.unmitigated.financialImpact=a.equals("",c)?null:e?this.formatFloat(c,4):c)},q.prototype.maintenanceCost_change=function(b,c,d,e){if(!a.isNil(d)){if(!this.isNumber(c)){return void this.displayErrorMsg(b,"RISK_ASSESSMENT_MAINTENANCE_COST_ERROR_MSG")}var f=h.parseFloat(c);d.maintenanceCost=isNaN(f)?null:f,
d.maintenanceCostFmtValue=this.formatRiskValue(c,e),e&&this.calculateConsequence(d,!1)}},q.prototype.consequence_change=function(b,c,d,e){if(!a.isNil(d)){if(!this.isNumber(c)){return void this.displayErrorMsg(b,"RISK_ASSESSMENT_CONSEQUENCE_ERROR_MSG")}d.consequence=h.parseFloat(c),d.consequenceFmtValue=this.formatRiskValue(c,e),e&&this.calculateFinancialRiskUnmtg(d)}},q.prototype.mitigatedProbability_change=function(b,c,d,e,f){if("."===c&&(c="0."),!this.isNumber(c)){return void(f||this.displayErrorMsg(b,"RISK_ASSESSMENT_PROBABILITY_ERROR_MSG"))}if(c=this.changeDecSep(c),(a.or(a.isEmpty(c),a.isNil(c))?0:h.parseFloat(c))>d.probability)return void(f||this.displayErrorMsg(b,"PROBABILITY_Exceeded_ERROR_MSG"));e&&(e.probability=h.parseFloat(c),e.probabilityFmtValue=this.formatRiskValue(c,f,5),f&&this.calculateFinancialRiskMtg(e))},q.prototype.mitigatedProductionLoss_change=function(b,c,d,e,f){if(!this.isNumber(c)){
return void this.displayErrorMsg(b,"RISK_ASSESSMENT_PRODUCTION_LOSS_ERROR_MSG")}if((a.or(a.isEmpty(c),a.isNil(c))?0:h.parseFloat(c))>d.productionLoss)return void(f||this.displayErrorMsg(b,"PRODUCTION_LOSS_Exceeded_ERROR_MSG"));if(e){var g=h.parseFloat(c);e.productionLoss=isNaN(g)?null:g,e.productionLossFmtValue=this.formatRiskValue(c,f),f&&this.calculateConsequence(e,!0)}},q.prototype.mitigatedMaintenanceCost_change=function(b,c,d,e,f){if(!this.isNumber(c)){return void this.displayErrorMsg(b,"RISK_ASSESSMENT_MAINTENANCE_COST_ERROR_MSG")}if((a.or(a.isEmpty(c),a.isNil(c))?0:h.parseFloat(c))>d.maintenanceCost)return void(f||this.displayErrorMsg(b,"MAINTENANCE_COST_Exceeded_ERROR_MSG"));if(e){var g=h.parseFloat(c);e.maintenanceCost=isNaN(g)?null:g,e.maintenanceCostFmtValue=this.formatRiskValue(c,f),f&&this.calculateConsequence(e,!0)}},q.prototype.mitigatedConsequence_change=function(b,c,d,e,f){if(!this.isNumber(c)){return void this.displayErrorMsg(b,"RISK_ASSESSMENT_CONSEQUENCE_ERROR_MSG")
}if((a.or(a.isEmpty(c),a.isNil(c))?0:h.parseFloat(c))>d.consequence)return void(f||this.displayErrorMsg(b,"CONSEQUENCE_Exceeded_ERROR_MSG"));e&&(e.consequence=h.parseFloat(c),e.consequenceFmtValue=this.formatRiskValue(c,f),f&&this.calculateFinancialRiskMtg(e))},q.prototype.calculateFinancialRiskUnmtg=function(b){var c=h.parseFloat(b.probability);isNaN(c)||a.isNil(c)||isNaN(b.consequence)||a.isNil(b.consequence)?b.rank=NaN:b.rank=c*b.consequence,b.rankFmtValue=this.formatRiskValue(b.rank,!0);var d=this.getValue();d&&d.unmitigated&&(d.unmitigated[b.index-1]=b)},q.prototype.calculateFinancialRiskMtg=function(b){var c=h.parseFloat(b.probability);isNaN(c)||a.isNil(c)||isNaN(b.consequence)||a.isNil(b.consequence)?b.rank=NaN:b.rank=c*b.consequence,b.rankFmtValue=this.formatRiskValue(b.rank,!0);var d=this.getValue();d&&d.mitigated&&(d.mitigated[b.index-1]=b)},q.prototype.calculateConsequence=function(b,c){
var d=a.isNil(b.productionLoss)?null:b.productionLoss,e=a.isNil(b.maintenanceCost)?null:b.maintenanceCost;this.isNumber(b.productionLoss)&&this.isNumber(b.maintenanceCost)&&!a.isNil(d)&&!a.isNil(e)&&(b.consequence=d+e,b.consequenceFmtValue=this.formatRiskValue(d+e,!0),c?this.calculateFinancialRiskMtg(b):this.calculateFinancialRiskUnmtg(b))},q.prototype.displayErrorMsg=function(a,b){var c=a.translate(b),d=a.translate("ERROR");i.showOk(c,d,"icon-riskmatrix-exclamation")},q.prototype.validThreshold=function(b){var c=b.rowArray;if(a.any(a.propEq("threshold",void 0),a.flatten(a.map(a.prop("data"),c)))){var d=this.translator.translate("THRESHOLD_NOT_FOUND_ERROR_MSG");return this.displayErrorMsg(this,d),!1}return!0},q.prototype.isNumber=function(a){return!a||!isNaN(h.parseFloat(a))},q}(e)});
define('ui/elements/risk-matrix/mi-risk-matrix',["require","exports","ramda","system/lang/object","spa/region","ui/elements/risk-matrix/view-models/risk-matrix-view-model"],function(require,exports,a,b,c,d){"use strict";var e=require("system/lang/element"),f=function(a){__extends(f,a);function f(){return a.call(this)||this}return f.prototype.createdCallback=function(){this.vm=b.resolve(d),this.initAttributes(this),this.initProperties(this)},f.prototype.initAttributes=function(a){var b=a.vm;g(b,e.booleanAttribute(a,"readonly")),h(b,e.booleanAttribute(a,"lock-consequence")),i(b,e.booleanAttribute(a,"lock-probability")),j(b,e.booleanAttribute(a,"hide-not-applicable")),k(a.vm,e.stringAttribute(a,"risk-matrix-key"))},f.prototype.initProperties=function(a){e.defineProperty(a,"matrix",{get:a.matrix_get.bind(null,a),set:a.matrix_set.bind(null,a)}),e.defineProperty(a,"value",{get:a.value_get.bind(null,a),set:a.value_set.bind(null,a)}),e.defineProperty(a,"calculator",{get:a.calculator_get.bind(null,a),set:a.calculator_set.bind(null,a)
}),e.defineProperty(a,"category",{get:a.category_get.bind(null,a),set:a.category_set.bind(null,a)})},f.prototype.matrix_get=function(a){return a.vm.getMatrix()},f.prototype.matrix_set=function(a,b){b&&void 0!==b&&(a.vm.setMatrix(b),a.attachRegion(a))},f.prototype.value_get=function(a){return a.vm.getValue()},f.prototype.value_set=function(a,b){b&&void 0!==b&&b.unmitigated instanceof Array&&(a.vm.setValue(b),a.attachRegion(a))},f.prototype.calculator_get=function(a){return a.vm.getCalculator()},f.prototype.calculator_set=function(a,b){b&&void 0!==b&&a.vm.setCalculator(b)},f.prototype.category_get=function(a){return a.vm.getCategory()},f.prototype.category_set=function(a,b){b&&void 0!==b&&a.vm.setCategory(b)},f.prototype.attachedCallback=function(){this.attachRegion(this)},f.prototype.attachRegion=function(a){var b;b=a.querySelector(".risk-matrix-root"),b&&null!==b||(b=e.build("div",this,["risk-matrix-root"])),this.region||(this.region=new c(b)),this.vm.attachRegion(this.region)},
f.prototype.attributeChangedCallback=function(a,b,c){var d=this.vm;switch(a){case"readonly":g(d,c);break;case"lock-consequence":h(d,c);break;case"lock-probability":i(d,c);break;case"hide-not-applicable":j(d,c);break;case"risk-matrix-key":k(d,c);break;default:return}},f}(HTMLElement);function g(b,c){var d=[!0,"true","readonly"];b.setReadOnly(!!c&&a.any(a.equals(c),d))}function h(a,b){a.setLockConsequence(!!b&&(b===!0||"true"===b))}function i(a,b){a.setLockProbability(!!b&&(b===!0||"true"===b))}function j(a,b){a.setHideNotApplicable(!!b&&(b===!0||"true"===b))}function k(a,b){b&&a.setRiskMatrixKey(b)}return document.registerElement("mi-risk-matrix",{prototype:f.prototype}),f});
define('ui/elements/risk-matrix/mi-risk-assessment',['require','system/globalization/translator','ui/elements/risk-matrix/risk-assessment','ui/elements/risk-matrix/mi-risk-matrix'],function(require){"use strict";var a=require("system/globalization/translator"),b=require("ui/elements/risk-matrix/risk-assessment"),c=Object.create(HTMLElement.prototype);require("ui/elements/risk-matrix/mi-risk-matrix"),c.createdCallback=function(){f(this),this.classList.add("btn"),this.classList.add("btn-primary"),this.hasChildNodes()||this.appendChild(document.createTextNode(this.translator.translate("ASSESS_RISK")))},c.attachedCallback=function(){this.addEventListener("click",this)},c.handleEvent=function(a){"click"===a.type&&d(this)};function d(a){var c=new b,d={matrix:a.settings.matrix,value:a.settings.value,riskOf:a.getAttribute("risk-of"),mitigatedBy:a.getAttribute("mitigated-by"),readonly:null!==a.getAttribute("readonly"),calculator:a.settings.calculator};c.show(d).progress(e.bind(null,a))}function e(a,b){var c;a.settings.value=b,c=new CustomEvent("change",{bubbles:!0}),a.dispatchEvent(c)}function f(b){b.translator=Object.resolve(a),b.settings={matrix:null,value:null,
calculator:null},Element.defineProperty(b,"matrix",{get:g.bind(null,b),set:h.bind(null,b)}),Element.defineProperty(b,"value",{get:i.bind(null,b),set:j.bind(null,b)}),Element.defineProperty(b,"calculator",{get:k.bind(null,b),set:l.bind(null,b)})}function g(a){return a.settings.matrix}function h(a,b){a.settings.matrix=b}function i(a){return a.settings.value}function j(a,b){a.settings.value=b}function k(a){return a.settings.calculator}function l(a,b){a.settings.calculator=b}return document.registerElement("mi-risk-assessment",{prototype:c}),c});
define('ui/elements/risk-matrix/component/risk-matrix-summary-react',["require","exports","react","ui/elements/risk-matrix/views/risk-matrix-summary-view","ramda","system/lang/object","react-dom","application/application-events","system/error/error-message","ui/elements/risk-matrix/services/risk-matrix-service","ui/elements/risk-matrix/risk-assessment","ui/elements/risk-matrix/models/risk-assessment-dto","system/ui/busy-indicator","ui/elements/risk-matrix/mi-risk-assessment"],function(require,exports,a,b,c,d,e,f,g){"use strict";var h=require("ui/elements/risk-matrix/services/risk-matrix-service"),i=require("ui/elements/risk-matrix/risk-assessment"),j=require("ui/elements/risk-matrix/models/risk-assessment-dto"),k=require("system/ui/busy-indicator");require("ui/elements/risk-matrix/mi-risk-assessment");var l=a.DOM.div;return function(a){__extends(m,a);function m(b){var c=a.call(this,b)||this;return c.props=b,c.settings={calculator:null,matrix:null,riskRank:"",service:d.resolve(h),value:null},c.matrix=b.matrix,c.state={matrix:null},
c.state.matrix=b.matrix,c.settings.value=c.setValue(b.settings.value),c.errorOccured=d.resolve(f).errorOccured,c.busyIndicator=d.resolve(k,"loading-med"),c.calculator=null,c.value=c.settings.value,c.props.clickHandler=c.launchRiskAssessment.bind(null,c),c.el=null,c}return m.prototype.attach=function(a,b){a&&(this.el=a,e.render(this.render(b),a),this.busyIndicator.hide())},m.prototype.render=function(a){var c=new b;return this.state.matrix?(this.busyIndicator&&this.busyIndicator.hide(),c.view(a||this.props)):(this.showBusyIndicator(),l({className:"risk-summary-placeholder"}))},m.prototype.launchRiskAssessment=function(a){var b=new i,c={matrix:a.matrix,value:a.props.settings.value,calculator:a.settings.calculator,riskOf:a.props.settings.riskOf,mitigatedBy:a.settings.mitigatedBy,readonly:a.props.settings.readonly};b.show(c).progress(a.dialogClosed.bind(null,a))},m.prototype.getValue=function(){return this.settings.value},m.prototype.setValue=function(a){this.settings.value=a,
a&&(this.tryFixFinancial(),this.loadRiskMatrix())},m.prototype.getMatrix=function(){return this.settings.matrix},m.prototype.setMatrix=function(a){this.settings.matrix=a,this.render()},m.prototype.getCalculator=function(){return this.settings.calculator},m.prototype.setCalculator=function(a){this.settings.calculator=a,this.tryFixFinancial()},m.prototype.tryFixFinancial=function(){this.shouldFixFinancial()&&this.fixFinancial()},m.prototype.fixFinancial=function(){var a=c.clone(this.getUnmitigatedFinancial());this.settings.value.mitigated.risks.push(a)},m.prototype.getUnmitigatedFinancial=function(){var a=this.settings.value;return c.find(c.propEq("isFinancial",!0),a.unmitigated.risks)},m.prototype.shouldFixFinancial=function(){return this.hasCalculatorFunction()&&this.hasUnmitigatedFinancial()&&!this.hasMitigatedFinancial()},m.prototype.hasCalculatorFunction=function(){return this.settings.calculator&&"function"==typeof this.settings.calculator},m.prototype.dialogClosed=function(a,b,c){
a.shouldShowBusyIndicator(a,b)&&a.showBusyIndicator(),a.setValue(b),a.props.settings.value=b,a.attach(a.el),a.props.dialogClosedHandler(),a.props.settings.shouldCloseDfd&&(c.dfd=a.props.settings.shouldCloseDfd)},m.prototype.shouldShowBusyIndicator=function(a,b){return!j.isEqual(a.settings.value.unmitigated,b.unmitigated)||a.hasMitigatedFinancial()&&!j.isEqual(a.settings.value.mitigated,b.mitigated)},m.prototype.hasMitigatedFinancial=function(){var a=this.settings.value;return!c.isNil(a.mitigated)&&!c.isNil(a.mitigated.risks)&&c.any(c.propEq("isFinancial",!0),a.mitigated.risks)},m.prototype.hasUnmitigatedFinancial=function(){var a=this.settings.value;return!c.isNil(a.unmitigated)&&!c.isNil(a.unmitigated.risks)&&c.any(c.propEq("isFinancial",!0),a.unmitigated.risks)},m.prototype.loadRiskMatrix=function(){var a=this,b=this.settings.value.unmitigated.riskMatrixKey
;this.shouldFetchRiskMatrix(b)?this.settings.service.getRiskMatrixByKey(this.settings.value.unmitigated.riskMatrixKey).done(function(b){a.matrix=b,a.props.matrix=b,a.state.matrix=b,a.attach(a.el)}).fail(function(b,c,d){var e=new g("RM1",d,(new Error).stack);a.errorOccured.raise(e),a.busyIndicator.hide()}):this.attach(this.el)},m.prototype.shouldFetchRiskMatrix=function(a){return!(!a||this.matrix&&this.matrix.key===a)},m.prototype.showBusyIndicator=function(){this.busyIndicator.attachTo(this.el),this.busyIndicator.show()},m}(a.Component)});
define('ui/elements/risk-matrix/mi-risk-matrix-summary',["require","exports","ui/elements/risk-matrix/component/risk-matrix-summary-react"],function(require,exports,a){"use strict";var b=require("system/lang/element"),c=function(c){__extends(d,c);function d(){return c.call(this)||this}return d.prototype.createdCallback=function(){this.setValue(this,null),b.defineProperty(this,"matrix",{get:this.getMatrix.bind(null,this),set:this.setMatrix.bind(null,this)}),b.defineProperty(this,"value",{get:this.getValue.bind(null,this),set:this.setValue.bind(null,this)}),b.defineProperty(this,"calculator",{get:this.getCalculator.bind(null,this),set:this.setCalculator.bind(null,this)}),b.defineProperty(this,"readonly",{get:this.getReadonly.bind(null,this),set:this.setReadonly.bind(null,this)}),this.initializeAttributes()},d.prototype.initializeAttributes=function(){var a=this.getAttribute("readonly");this.attributeChangedCallback("readonly",null,a);var b=this.getAttribute("risk-of");this.attributeChangedCallback("risk-of",null,b)
;var c=this.getAttribute("mitigated-by");this.attributeChangedCallback("mitigated-by",null,c)},d.prototype.attributeChangedCallback=function(a,b,c){var d=["readonly","risk-of","mitigated-by"],e;d.indexOf(a)>-1&&(e=this.querySelector("mi-risk-assessment"),e&&(null!==c?e.setAttribute(a,c):e.removeAttribute(a)),"readonly"===a&&c?this.props.settings.readonly="true"===c:"risk-of"===a&&c?this.props.settings.riskOf=c:"mitigated-by"===a&&c&&(this.props.settings.mitigatedBy=c),this.reactComponent.attach(this,this.props))},d.prototype.getMatrix=function(a){return a.reactComponent.getMatrix()},d.prototype.setMatrix=function(a,b){a.reactComponent.setMatrix(b),a.reactComponent.attach(a)},d.prototype.getValue=function(a){return a.reactComponent.getValue()},d.prototype.setValue=function(b,c){b.props=b.props||{settings:{}},b.props.settings.value=c,b.props.dialogClosedHandler=b.dispatch.bind(null,b),b.reactComponent=new a(b.props),b.reactComponent.setValue(c),b.reactComponent.attach(b)},
d.prototype.dispatch=function(a){var b=new CustomEvent("change",{bubbles:!0});a.dispatchEvent(b)},d.prototype.getCalculator=function(a){return a.reactComponent.getCalculator()},d.prototype.setCalculator=function(a,b){a.reactComponent.setCalculator(b),a.reactComponent.attach(a)},d.prototype.setReadonly=function(a,b){a.props.settings.readonly=b,a.reactComponent.attach(a)},d.prototype.getReadonly=function(a){return a.props.settings.readonly},d}(HTMLElement);return document.registerElement("mi-risk-matrix-summary",{prototype:c.prototype}),c});
define('strategy/recommendations/details/recommendation-risk-details-view-model',['require','bluebird','ramda','system/notifications/broker','spa/ko/knockout-view-model','text!./views/recommendation-risk-details.html','ui/elements/risk-matrix/services/risk-assessment-service','strategy/recommendations/services/recommendation-service','strategy/recommendations/recommendation-utility','system/ui/message-box','strategy/recommendations/recommendation-events','system/globalization/translator','ui/elements/risk-matrix/mi-risk-matrix-summary'],function(require){"use strict";var a=require("bluebird"),b=require("ramda"),c=Object.resolve(require("system/notifications/broker")),d=require("spa/ko/knockout-view-model"),e=require("text!./views/recommendation-risk-details.html"),f=require("ui/elements/risk-matrix/services/risk-assessment-service"),g=require("strategy/recommendations/services/recommendation-service"),h=require("strategy/recommendations/recommendation-utility"),i=require("system/ui/message-box"),j=require("strategy/recommendations/recommendation-events"),k=require("system/globalization/translator");require("ui/elements/risk-matrix/mi-risk-matrix-summary");function l(a,b){m.call(this,e),this.events=Object.resolve(j),this.riskAssessmentService=Object.resolve(f),this.translator=Object.resolve(k),this.recommendationUtility=Object.resolve(h),this.recommendationService=Object.resolve(g),this.parentClass=a,this.unmititgatedRiskName=b.unmititgatedRiskName,this.unmitigatedRiskAssessment=b.unmitigatedRiskAssessment,
this.mitigatedAssessment=b.mitigatedAssessment,this.recHeadline=b.headline,this.currentRecKey=b.currentRecKey,this.mitigatedAssessment.drivingRiskCategory=this.unmitigatedRiskAssessment.drivingRiskCategory,this.assessmentControl=null,this.value={unmitigated:null,mitigated:null}}var m=Object.inherit(d,l);l.prototype.reload=function(a){this.unmititgatedRiskName=a.unmititgatedRiskName,this.unmitigatedRiskAssessment=a.unmitigatedRiskAssessment,this.mitigatedAssessment=a.mitigatedAssessment,this.recHeadline=a.headline};var n=b.curry(function a(b,c){b.value={unmitigated:b.unmitigatedRiskAssessment,mitigated:b.mitigatedAssessment},b.assessmentControl.value=b.value,b.assessmentControl.readonly=c,E(b)});function o(b){return a.resolve(b.recommendationUtility.isRiskAssessmentReadonly(b.unmitigatedRiskAssessment)).catch(C.bind(null,b))}l.prototype.attach=function(a){m.prototype.attach.call(this,a),this.assessmentControl=a.element.querySelector("mi-risk-matrix-summary"),
Element.upgrade(this.assessmentControl),this.assessmentControl.addEventListener("change",this),D(this),s(this),this.events.reloadRiskAssessment.add(r.bind(null,this),this)};var p=b.curry(function a(b,c){b.mitigatedAssessment=c.RiskAssessment}),q=b.curry(function b(c,d){return a.resolve(c.recommendationService.getRecommendation(d)).catch(C.bind(null,c))});function r(a,c){return a.unmitigatedRiskAssessment=c,b.composeP(b.partial(s,[a]),p(a),q(a))(a.currentRecKey)}function s(a){return b.composeP(n(a),o)(a)}l.prototype.handleEvent=function(a){"MI-RISK-MATRIX-SUMMARY"===a.target.nodeName&&A(this,a)},l.prototype.detach=function(){this.assessmentControl.removeEventListener("change",this),this.events.reloadRiskAssessment.remove(this),this.assessmentControl=null,m.prototype.detach.apply(this,arguments)};function t(a){a.riskAssessmentService.getRiskAssessment(a.value.mitigated.key).done(u.bind(null,a)).fail(a.translator.translate("ASSESSMENT_FAILURE_MSG"))}function u(a,b){
b.drivingRiskCategory=a.unmitigatedRiskAssessment.drivingRiskCategory,a.value.mitigated=b,a.assessmentControl.value=a.value,a.mitigatedAssessment=a.value.mitigated,a.events.raInserted.raise(b),E(a)}var v=b.curry(function a(b,c){t(b)}),w=b.curry(function a(b,c){b.value.mitigated=c,b.mitigatedAssessment=b.value.mitigated,v(b,c)}),x=b.curry(function b(c,d){return a.resolve(c.riskAssessmentService.getRiskAssessment(d)).catch(C.bind(null,c))}),y=b.curry(function b(c,d,e){var f=c.riskAssessmentService.updateRiskAssessment(e);return d.currentTarget.props.settings.shouldCloseDfd=f,a.resolve(f).catch(B.bind(null,c))}),z=b.curry(function b(c,d,e){var f=c.riskAssessmentService.insertRiskAssessment(e);return d.currentTarget.props.settings.shouldCloseDfd=f,a.resolve(f).catch(B.bind(null,c))});function A(a,c){var d;c.target.value.mitigated&&(d=c.target.value.mitigated),D(a),
b.cond([[b.compose(b.equals("0"),b.invoker(0,"toString"),b.prop("key")),b.composeP(w(a),x(a),z(a,c))],[b.T,b.composeP(v(a),y(a,c))]])(d)}function B(a,b){c.feedback.errorMessageFromResponse(b),a.mitigatedAssessment=a.value.mitigated}function C(c,d){var e;return E(c),e=b.is(Object,d)?d.responseJSON?d.responseJSON.message:d.responseText:d,i.showOk(e,c.translator.translate("ERROR"),c.recommendationUtility.warningIcon),a.reject()}function D(a){a.parentClass.busyIndicator.show()}function E(a){a.parentClass.busyIndicator.hide()}return l});

define('text!strategy/recommendations/details/views/recommendation-linked.html',[],function () { return '<div class="block-group as-recommendation-linked-main">\r\n    <mi-tool-bar>\r\n        <button class="btn btn-icon" data-bind="attr: {title: translator.translate(\'UNLINK\') },enable: canEditRecommendation,css:{\'no-access\': !canEditRecommendation}, click: unlinkRecommendations,css:{deactive: ! canEditRecommendation()}">\r\n            <i class="icon-unlink"></i>\r\n        </button>\r\n    </mi-tool-bar>\r\n\r\n    <mi-resultgrid showrowfilter="true" showgroupingpanel="true"></mi-resultgrid>\r\n</div>\r\n';});

define('strategy/recommendations/details/recommendation-linked-view-model',['require','knockout','jquery','ramda','bluebird','system/globalization/translator','spa/ko/knockout-view-model','text!./views/recommendation-linked.html','strategy/recommendations/recommendation-utility','strategy/recommendations/services/recommendation-service','system/ui/message-box','system/lang/converter','strategy/recommendations/recommendation-events','system/lang/object','ui/elements/searchbox/view-model','ui/elements/filter/filter-view-model','ui/elements/checkbox/checkbox-view-model','ui/elements/resultgrid/resultgrid-view-model'],function(require){"use strict";var a=require("knockout"),b=require("jquery"),c=require("ramda"),d=require("bluebird"),e=require("system/globalization/translator"),f=require("spa/ko/knockout-view-model"),g=require("text!./views/recommendation-linked.html"),h=require("strategy/recommendations/recommendation-utility"),i=require("strategy/recommendations/services/recommendation-service"),j=require("system/ui/message-box"),k=require("system/lang/converter"),l=require("strategy/recommendations/recommendation-events");require("system/lang/object"),require("ui/elements/searchbox/view-model"),require("ui/elements/filter/filter-view-model"),require("ui/elements/checkbox/checkbox-view-model"),require("ui/elements/resultgrid/resultgrid-view-model");function m(a,b,c,d){n.call(this,g),this.events=Object.resolve(l),this.translator=Object.resolve(e),this.RecommendationUtility=Object.resolve(h),this.recommendationService=Object.resolve(i),this.parentClass=a,this.canEditRecommendation=null,
this.currentRecommendation=b,this.filteredRecommendations=[],this.selectedRecommendations=[],this.userPermissionConfig=c,this.selectedStateOperation="",this.recommendationGridData={},this.targetRecKey=d}var n=Object.inherit(f,m);m.prototype.load=function(){void 0!==this.currentRecommendation.LinkedRecommendations&&(this.filteredRecommendations=this.currentRecommendation.LinkedRecommendations)},m.prototype.attach=function(b){this.canEditRecommendation=a.observable(!1),n.prototype.attach.call(this,b),this.resultGrid=b.element.querySelector("mi-resultgrid"),Element.upgrade(this.resultGrid),Element.upgrade(b.element.querySelector("mi-tool-bar")),this.resultGrid.onRowMultiSelectCB=q(this),this.resultGrid.onCellHyperlinkClickCB=u(this),this.resultGrid.gridLoadedCB=C.bind(null,this),o(this)},m.prototype.detach=function(){this.resultGrid=null,this.canEditRecommendation=null,n.prototype.detach.apply(this,arguments)};function o(a){a.recommendationGridData.columns=[{id:"IDUrl",
alias:a.translator.translate("REC_ID"),isActionColumn:"true"},{id:"Headline",alias:a.translator.translate("REC_HEADLINE")},{id:"AssetId",alias:a.translator.translate("EQUIPMENT_ID")},{id:"State",alias:a.translator.translate("IMPLEMENTATION_STATE")}],a.recommendationGridData.data=a.filteredRecommendations,a.resultGrid.loadJSONData=p.bind(null,a),C(a)}function p(a){var c=b.Deferred();return c.resolve(a.recommendationGridData),c}var q=c.curry(function a(b,c){b.selectedRecommendations=c,r(b)});function r(a){if(void 0!==a.targetRecKey){c.contains(c.propEq("Key",a.targetRecKey))(a.selectedRecommendations)&&a.canEditRecommendation(!1)}else a.userPermissionConfig.canEditRecommendation&&a.selectedRecommendations.length>0?a.canEditRecommendation(!0):a.canEditRecommendation(!1)}var s=c.curry(function a(b,c){b.events.recommendationSummaryLoadEvent.raise(c)}),t=c.curry(function a(b,c){return d.resolve(b.recommendationService.getRecommendation(c)).catch(A.bind(null,b))}),u=c.curry(function a(b,d){
return c.composeP(s(b),t(b))(k.toString(d.key))}),v=c.curry(function a(b,c){c&&(b.selectedRecommendations=[],b.filteredRecommendations=[],b.currentRecommendation=c,b.filteredRecommendations=b.currentRecommendation.LinkedRecommendations,0===b.filteredRecommendations.length&&b.canEditRecommendation(!1),b.recommendationGridData.data=b.filteredRecommendations,b.resultGrid.loadJSONData=p.bind(null,b))}),w=c.curry(function a(b,c){b.events.loadRecommendationListEvent.raise(),C(b)}),x=c.curry(function a(b,c){return d.resolve(b.recommendationService.getRecommendation(c)).catch(w(b))}),y=c.curry(function a(b,c){return b.events.cachedClearList.raise(),b.currentRecommendation.Key}),z=c.curry(function a(b,c){return d.resolve(b.recommendationService.UnlinkRecommendations(c)).catch(A.bind(null,b))});m.prototype.unlinkRecommendations=function(){if(this.selectedRecommendations.length){B(this);var a=c.map(c.prop("Key"),this.selectedRecommendations);return c.composeP(v(this),x(this),y(this),z(this))(a)}}
;function A(a,b){C(a);var e;return e=c.is(Object,b)?b.responseJSON?b.responseJSON.message:b.responseText:b,j.showOk(e,a.translator.translate("ERROR"),a.RecommendationUtility.warningIcon),d.reject()}function B(a){a.parentClass.busyIndicator.show()}function C(a){a.parentClass.busyIndicator.hide()}return m});
define('strategy/rcm/models/rcm-template-dto',['require','system/lang/converter','system/globalization/translator'],function(require){"use strict";var a=require("system/lang/converter"),b=require("system/globalization/translator");function c(b){this.ID=a.toString(b.id),this.Description=a.toString(b.description),this.Key=a.toString(b.key),this.url="#"+this.Key,this.TemplateType=a.toString(b.templateType),this.AnalysisType=a.toString(b.analysisType),this.LastModifiedDate=a.toDate(b.lastModifiedDate),this.LastModifiedBy=a.toString(b.lastModifiedBy),this.Entity=b.entity,this.RootEntity=b.rootEntity,this.RootKey=a.toString(b.rootKey),this.siteKey=a.toString(b.siteKey)}return c.fromDataCollection=function a(d){this.translator=Object.resolve(b);var e,f=[];if(d)for(e=0;e<d.length;e++){switch(d[e].templateType){case"MI_RCMANALY":d[e].templateType=this.translator.translate("ANALYSIS_LABEL_CAPTION");break;case"MI_RCMFUNCN":d[e].templateType=this.translator.translate("FUNCTION_TAB_LABEL");break;case"MI_RCMFFAIL":d[e].templateType=this.translator.translate("FUNCTION_FAILURE");break;case"MI_RCMFMODE":
d[e].templateType=this.translator.translate("FAILURE_MODE_STATUS");break;case"MI_RCMFEFFT":d[e].templateType=this.translator.translate("FAILURE_EFFECT_STATUS");break;case"MI_RECRCM":d[e].templateType=this.translator.translate("RECOMMENDATION_LABEL");break;case"MI_RCMEQPMT":d[e].templateType=this.translator.translate("ASSET_LABEL")}f[e]=new c(d[e])}return f},c});
define('strategy/rcm/models/asset-replacement-dto',['require','system/lang/converter'],function(require){"use strict";var a=require("system/lang/converter");function b(b){this.nodeKey=a.toString(b.nodeKey),this.replacementKey=a.toString(b.replacementKey)}return b.fromDataCollection=function a(c){var d,e=[];if(c)for(d=0;d<c.length;d++)e[d]=new b(c[d]);return e},b});
define('strategy/rcm/models/analysis-asset-replacement-dto',['require','system/lang/converter','strategy/rcm/models/asset-replacement-dto'],function(require){"use strict";var a=require("system/lang/converter"),b=require("strategy/rcm/models/asset-replacement-dto");function c(a){this.ModeReplacementList=b.fromDataCollection(a.modeReplacementList),this.ReplacementAssetKeys=a.replacementAssetKeys?a.replacementAssetKeys:[]}return c.fromDataCollection=function a(b){var d,e=[];if(b)for(d=0;d<b.length;d++)e[d]=new c(b[d]);return e},c});
define('strategy/rcm/services/template-service',['require','system/http/ajax-client','strategy/rcm/models/rcm-template-dto','strategy/rcm/models/analysis-asset-replacement-dto'],function(require){"use strict";var a=require("system/http/ajax-client"),b=require("strategy/rcm/models/rcm-template-dto"),c=require("strategy/rcm/models/analysis-asset-replacement-dto"),d="api/internal/recommendations/metadata",e="api/internal/as/rcm/templates";function f(a){this.ajaxClient=a}f.dependsOn=[a],f.prototype.getAllTemplates=function(){return this.ajaxClient.get(e).then(b.fromDataCollection)},f.prototype.getFamilyKey=function(a){return this.ajaxClient.get(d+"/{0}".format(a))},f.prototype.getRCMTemplate=function(a){return this.ajaxClient.get(e+"/{0}".format(a)).then(g.bind(null,b))},f.prototype.getDefaultRCMTemplate=function(a){return this.ajaxClient.get(e+"/{0}/default".format(a)).then(g.bind(null,b))},f.prototype.getAllSitesUsingSameMatrix=function(a){return this.ajaxClient.get(e+"/{0}/sites".format(a))},f.prototype.postRCMTemplate=function(a,b){return this.ajaxClient.post(e+"/{0}".format(a),b)},f.prototype.postNewRCMTemplate=function(a){
return this.ajaxClient.post(e,a)},f.prototype.updateRCMTemplate=function(a){return this.ajaxClient.put(e,a)},f.prototype.deleteRCMTemplate=function(a){return this.ajaxClient.delete(e+"/{0}".format(a))},f.prototype.applyRCMTemplate=function(a,b,c,d,f){return this.ajaxClient.put(e+"/{0}/nodeKey/{1}/analysisKey/{2}/analysisType/{3}".format(b,a,c,d),f)},f.prototype.applyMultipleFailureModeTemplate=function(a,b,c,d){return this.ajaxClient.put(e+"/nodeKey/{0}/analysisKey/{1}/analysisType/{2}".format(a,b,c),d)},f.prototype.addAnalysisTemplate=function(a,b){return this.ajaxClient.put(e+"/{0}/createanalysis".format(a),b)},f.prototype.promoteTemplate=function(a){return this.ajaxClient.put(e+"/{0}/promote".format(a),!0)},f.prototype.getPendingRecommendationsCount=function(a){return this.ajaxClient.get(e+"/{0}/pendingRecommendations".format(a),!0)};function g(a,b){return new a(b)}return f});
define('strategy/rcm/rcm-utility',['require','ramda','strategy/strategy-utility','application/application-context'],function(require){"use strict";var a=require("ramda"),b=require("strategy/strategy-utility"),c=require("application/application-context");function d(){this.ANALYSIS_TYPE_RCM="RCM",this.ANALYSIS_TYPE_FMEA="FMEA",this.ASPECT_FUNCTION="FUNCTION",this.ASPECT_FAILURE="FAILURE",this.ASPECT_MODE="MODE",this.ASPECT_EFFECT="EFFECT",this.LOGIC_ITEM_YES="YES",this.LOGIC_ITEM_NO="NO",this.OBJECT_DATE="[object Date]",this.ANALYSIS_ID_FIELD="MI_AN_ANALY_ID_CHR",this.ANALYSIS_TYPE_FIELD="MI_AN_ANALY_TYPE_CHR",this.ANALYSIS_SHORT_DESC_FIELD="MI_AN_SHORT_DESCR_CHR",this.ANALYSIS_COMPLETE_STATE="MI_COMPLETE",this.FAMILY_ID_ANALYSIS="MI_RCMANALY",this.FAMILY_ID_FUNCTION="MI_RCMFUNCN",this.FAMILY_ID_FAILURE="MI_RCMFFAIL",this.FAMILY_ID_MODE="MI_RCMFMODE",this.FAMILY_ID_EFFECT="MI_RCMFEFFT",this.FAMILY_ID_RECOMMENDATION="MI_RECRCM",this.FAMILY_ID_ASSET="MI_RCMEQPMT",this.FAMILY_ID_TEMPLATE="MI_RCMTMPLT",this.TEAM_MEMBER_FAMILY_ID="MI Human Resource",
this.HAS_TEAMMEMBER_RELATIONSHIP_ID="MIR_HRCMTMMEM",this.IS_RCM_EQUIPMENT_RELATIONSHIP_ID="MIR_IRCMEQP",this.HAS_CONSOLIDATED_RECOMMENDATIONS_RELATIONSHIP_ID="MIR_HSCONREC",this.HAS_SUPERSEDED_RECOMMENDATIONS_RELATIONSHIP_ID="MIR_HSSUPREC",this.FUNCTION_NAME_FIELD="MI_RCMFUNCN_NAME_C",this.FUNCTION_ID_FIELD="MI_RCMFUNCN_ID_C",this.FAILURE_ID_FIELD="MI_RCMFFAIL_ID_C",this.FAILURE_NAME_FIELD="MI_RCMFFAIL_NAME_C",this.MODE_NAME_FIELD="MI_RCMFMODE_NAME_C",this.MODE_ID_FIELD="MI_RCMFMODE_ID_C",this.EFFECT_ID_FIELD="MI_RCMFEFFT_ID_C",this.EFFECT_NAME_FIELD="MI_RCMFEFFT_NAME_C",this.EQUIP_ID_FIELD="MI_RCMEQPMT_ID_C",this.RCM_FAIL_ID="MI_RCMFFAIL_ID_C",this.RCM_MODE_ID="MI_RCMFMODE_ID_C",this.RCM_FUNC_ID="MI_RCMFUNCN_ID_C",this.RCM_RECOMMENDATION_ID="MI_REC_ID",this.REC_HEADER="MI_REC_SHORT_DESCR_CHR",this.RCM_EQUIPMENT_ID="MI_RCMEQPMT_EQUIP_ID_C",this.CREATE_ANALYSIS_URI="strategy/{0}/analysis/0",this.LOAD_ANALYSIS_URI="strategy/{0}/analysis/{1}",
this.LOAD_TEMPLATE_URI="strategy/{0}/template/{1}",this.AssetURL="<a data-header='RcmFmeaAsset' data-assetKey='{2}' href='{0}'>{1}</a>"}return d.prototype=new b,d.singleton=!0,d.factory=function(){return new d},d.prototype.createAnalysisURI=function(a){return this.CREATE_ANALYSIS_URI.format(a)},d.prototype.loadAnalysisURI=function(a,b){return this.LOAD_ANALYSIS_URI.format(a,b)},d.prototype.loadTemplateURI=function(a,b){return this.LOAD_TEMPLATE_URI.format(a,b)},d.prototype.hasPrivilege=function(b,d){var e={familyId:d?d:this.FAMILY_ID_ANALYSIS};return e[b]=!0,c.user.isSuperUser||a.any(a.whereEq(e),c.user.privileges)},d});

define('text!strategy/rcm/views/rcm-template-dialog.html',[],function () { return '<div class="block-group">\r\n    <div class="block">\r\n        <div class="save-as-template-datasheet-placeholder"></div>\r\n    </div>\r\n</div>\r\n';});

define('strategy/rcm/rcm-template-dialog-view-model',['require','jquery','knockout','system/globalization/translator','system/notifications/broker','spa/ko/knockout-view-model','strategy/rcm/services/template-service','platform/datasheets/datasheet','system/lang/event','strategy/rcm/rcm-utility','text!./views/rcm-template-dialog.html','system/lang/object'],function(require){"use strict";var a=require("jquery"),b=require("knockout"),c=require("system/globalization/translator"),d=Object.resolve(require("system/notifications/broker")),e=require("spa/ko/knockout-view-model"),f=require("strategy/rcm/services/template-service"),g=require("platform/datasheets/datasheet"),h=require("system/lang/event"),i=require("strategy/rcm/rcm-utility"),j=require("text!./views/rcm-template-dialog.html");require("system/lang/object");function k(a,b){l.call(this,j),this.translator=Object.resolve(c),this.RCMUtility=Object.resolve(i),this.templateService=Object.resolve(f),this.nodeKey=a,this.template=b,this.dsheet=null,this.templateCreatedEvent=new h}var l=Object.inherit(e,k);k.prototype.attach=function a(b){var c=this;l.prototype.attach.call(this,b),c.loadTemplateDataSheet()},k.prototype.loadTemplateDataSheet=function b(){var c=this,d=!1,e=a(".save-as-template-datasheet-placeholder"),f={containerEl:e,entityObj:c.template.Entity,canEdit:!0,
scrollEl:".dialog-content"},h={functionsAvailable:["references","save"],readOnly:d,showDatasheetSelection:!0,delegateDatasheetSave:!0};c.dsheet=new g(f),c.dsheet.load(h).done(function(){c.dsheet.beforeEntitiesSave.add(m.bind(null,c)),c.dsheet.entityFactory.updateField(c.dsheet.entity,"MI_RCMTMPLT_ANALY_TYPE_C",c.RCMUtility.DATASHEET_VALUE,c.template.AnalysisType),c.dsheet.entityFactory.updateField(c.dsheet.entity,"MI_RCMTMPLT_ANALY_TYPE_C",c.RCMUtility.DATASHEET__DISPLAYVALUE,c.template.AnalysisType),c.dsheet.entityFactory.updateField(c.dsheet.entity,"MI_TM000000_TEMP_TYPE_C",c.RCMUtility.DATASHEET_VALUE,c.template.TemplateType),c.dsheet.entityFactory.updateField(c.dsheet.entity,"MI_TM000000_TEMP_TYPE_C",c.RCMUtility.DATASHEET__DISPLAYVALUE,c.template.TemplateType),c.dsheet.entityFactory.updateField(c.dsheet.entity,"MI_TM000000_SHRT_DSC_C",c.RCMUtility.DATASHEET_VALUE,c.template.Description),
c.dsheet.entityFactory.updateField(c.dsheet.entity,"MI_TM000000_SHRT_DSC_C",c.RCMUtility.DATASHEET__DISPLAYVALUE,c.template.Description),c.dsheet.entityFactory.updateField(c.dsheet.entity,"MI_RCMTMPLT_APPRO_DATE_D",c.RCMUtility.DATASHEET_VALUE,null),c.dsheet.entityFactory.updateField(c.dsheet.entity,"MI_RCMTMPLT_APPRO_DATE_D",c.RCMUtility.DATASHEET__DISPLAYVALUE,null)})};function m(a,b){var c=b.entity;a.template.Entity=c,a.templateService.postRCMTemplate(a.nodeKey,a.template).done(n.bind(null,a)).fail(o.bind(null,a))}function n(a,b){a.templateCreatedEvent.raise(b,a.dsheet.savingFromUnsavedChangesDialog),a.dsheet.datasheetSaveDfd.resolve()}function o(a,b){d.feedback.errorMessageFromResponse(b),a.dsheet.datasheetManager.clearSpinner(),a.dsheet.datasheetManager.layout.isNewEntityCreated(!1),a.dsheet.datasheetSaveDfd.reject()}return k.prototype.closeDialog=function a(){return this.dsheet.unload()},k});
define('ui/elements/tab-group-item/view-model',['require','jquery'],function(require){"use strict";var a=require("jquery"),b=Object.create(HTMLElement.prototype);b.createdCallback=function(){var a,b,c;this.element=this,this.$element=null,this.text=this.getAttribute("text"),this.hasError=this.getAttribute("haserror"),this.number=this.getAttribute("number"),this.value=this.getAttribute("value"),this.isSelected=this.getAttribute("selected"),this.disabled=this.getAttribute("disable"),this.noAccess=this.getAttribute("noaccess"),a=document.createElement("div"),a.className="tab-group-item block",this.appendChild(a),c=document.createElement("span"),c.className="number",c.innerHTML="&nbsp",b=document.createElement("span"),b.className="text",b.innerHTML="&nbsp",a.appendChild(this.wrapTab(b,c))},b.attachedCallback=function(){this.setElement(),this.setText(this.text),this.setNumber(this.number),this.setNoAccess(this.noAccess),this.setDisabledTab(this.disabled),this.attachClickHandlers(),this.tabWidthClass=this.element.getAttribute("tabWidthClass"),
this.setTabWidth(),this.isSelected&&this.setActive()},b.detachedCallback=function(){},b.attributeChangedCallback=function(a,b,c){this.$element||this.setElement(),"haserror"===a&&this.setHasError(c),"tabwidthclass"===a?(this.tabWidthClass=c,this.removePrevWidthClass(b),this.setTabWidth()):"value"===a?this.setValue(c):"text"===a?this.setText(c):"number"===a?this.setNumber(c):"selected"===a?(this.isSelected=c,this.isSelected?this.setActive():this.setInactive()):"disable"===a?this.setDisabledTab(c):"noaccess"===a&&this.setNoAccess(c)},b.setElement=function(){this.$element=a(this.element)},b.setText=function(a){a&&(this.text=a,this.$element.find(".text").empty().append(a))},b.setValue=function(a){a&&(this.value=a)},b.setNumber=function(a){isFinite(a)&&(this.number=a,this.$element.find(".number").html("&nbsp").append(a),this.$element.find(".text").parent("td").removeClass("tdtxtcenter").addClass("tdtxtleft")),
a&&!isNaN(parseInt(a))||this.$element.find(".text").parent("td").removeClass("tdtxtleft").addClass("tdtxtcenter")},b.attachClickHandlers=function(){this.$element.on("click",c.bind(null,this))},b.detachClickHandlers=function(){this.$element.off("click")},b.setActive=function(){var a=this.$element.find(".tab-group-item"),b=a.hasClass("no-access"),c=a.hasClass("disabled-tab");b||c||this.$element.find(".tab-group-item").addClass("active")},b.setInactive=function(){this.$element.find(".tab-group-item").removeClass("active")},b.setTabWidth=function(){this.$element.find(".tab-group-item").addClass(this.tabWidthClass)},b.removePrevWidthClass=function(a){this.$element.find(".tab-group-item").removeClass(a)},b.setNoAccess=function(a){a?this.$element.find(".tab-group-item").addClass("no-access"):this.$element.find(".tab-group-item").removeClass("no-access")},b.setDisabledTab=function(a){
a?this.$element.find(".tab-group-item").addClass("disabled-tab"):this.$element.find(".tab-group-item").removeClass("disabled-tab")},b.setHasError=function(a){"true"===a?this.$element.find(".tab-group-item").append('<i class="icon-alert"></i>'):this.$element.find(".tab-group-item").find("i.icon-alert").remove()},b.wrapTab=function a(b,c){var d,e,f,g,h,i;return h=document.createElement("div"),h.className="tbldiv",i=document.createElement("div"),i.className="tblInnerDiv",h.appendChild(i),d=document.createElement("table"),d.className="tbl",e=document.createElement("tbody"),f=document.createElement("tr"),g=document.createElement("td"),g.className="tdtxtright",g.appendChild(c),f.appendChild(g),g=document.createElement("td"),g.className="tdtxtleft",g.appendChild(b),f.appendChild(g),e.appendChild(f),d.appendChild(e),i.appendChild(d),i};function c(a){}function d(a){a._value=null,a._tabWidthClass=a._tabWidthClass||null,Element.defineProperty(a,"value",{get:function(){return this._value}.bind(a),
set:function(a){this._value=a}.bind(a)})}return document.registerElement("mi-tab",{prototype:b}),b});
define('ui/elements/tab-group/view-model',['require','jquery','system/lang/converter','ui/elements/tab-group-item/view-model'],function(require){"use strict";var a=require("jquery"),b=require("system/lang/converter");require("ui/elements/tab-group-item/view-model");var c=Object.create(HTMLElement.prototype);c.createdCallback=function(){this.element=this,this.$element=null,this.tabs=this.getTabsAttribute(),this.size=this.getSizeAttribute(),this.selectedTab=null},c.attachedCallback=function(){this.setElement(),this.insertInnerHTML(),this.checkActiveTab(),this.upgradeTabs(),this.cascadeAttributes(),this.attachHandlers()},c.checkActiveTab=function(){var b=this.getSelectedTab&&this.getSelectedTab()&&this.getSelectedTab().text;if(null!==b)for(var c=this.$element.find(".tab-group-item"),d=0;d<c.length;d++)if(a(c[d]).hasClass("active")){var e=String(c[d].textContent).replace(/\s/g,"");e===b||a(c[d]).removeClass("active")}},c.detachedCallback=function(){},c.attributeChangedCallback=function(a,c,d){"tabs"===a&&d!==c&&(this.tabs=b.toInteger(d),this.cascadeAttributes())},c.getSelectedTab=function(){var a
;return this.selectedTab?this.setSelectedTab(this.selectedTab):(a=d(this))&&this.setSelectedTab(a),this.selectedTab},c.setElement=function(){this.$element=a(this.element)},c.upgradeTabs=function(){Element.upgrade(this.$element.find("mi-tab"))},c.extractInnerHTML=function(){return this.$element.html()},c.insertInnerHTML=function(){var b=document.createElement("div");b.className="tab-group block-group tab-group-default",a(this.$element).wrapInner(b)},c.cascadeAttributes=function(){var b,c,d;for(d=f(this.tabs),"small"===this.size&&a(this).find("div.tab-group").height(36).addClass("tab-group-small"),b=this.$element.find("mi-tab"),c=0;c<b.length;c++)c>=this.tabs?a(b[c]).hide():(b[c].setAttribute("tabWidthClass",d),"small"===this.size&&(a(b[c]).find("div.tab-group-item").addClass("small-tab").removeClass("block"),a(b[c]).find("span.number").hide()))},c.attachHandlers=function(){this.$element.on("click",e.bind(null,this))},c.getTabsAttribute=function a(){
return b.toInteger(this.getAttribute("tabs"))},c.getSizeAttribute=function a(){return this.getAttribute("size")?this.getAttribute("size").toLowerCase():"large"},c.setSelectedTab=function a(b){this.selectedTab={value:b.value,number:b.number,text:b.text}},c.updateTabSize=function a(){this.size=this.getSizeAttribute(),this.cascadeAttributes()};function d(a){var b,c;for(b=a.$element&&a.$element.find("mi-tab"),c=0;c<b&&b.length;c++)if(b[c].isSelected)return b[c]}function e(b,c){var d,e,f,g;if(e=a(c.target),!e.hasClass("tab-group")){for(d=e.closest("mi-tab")[0],f=b.$element.find("mi-tab"),g=0;g<f.length;g++)f[g].setInactive();d.setActive(),b.setSelectedTab(d)}}function f(a){return 2===a?"two-tab":3===a?"three-tab":4===a?"four-tab":5===a?"five-tab":6===a?"six-tab":7===a?"seven-tab":8===a?"eight-tab":"one-tab"}return document.registerElement("mi-tab-group",{prototype:c}),c});
define('strategy/recommendations/details/recommendation-details-control',['require','knockout','jquery','ramda','bluebird','system/globalization/translator','spa/ko/knockout-view-model','system/knockout/knockout-manager','text!./views/recommendation-details.html','strategy/recommendations/details/recommendation-datasheet','strategy/recommendations/details/recommendation-risk-details-view-model','strategy/recommendations/details/recommendation-linked-view-model','strategy/rcm/rcm-template-dialog-view-model','strategy/recommendations/services/recommendation-service','ui/elements/risk-matrix/services/risk-assessment-service','strategy/rcm/services/template-service','system/ui/dialog-box','system/ui/busy-indicator','spa/region','application/application-events','strategy/recommendations/recommendation-utility','system/ui/message-box','toastr','strategy/recommendations/recommendation-events','spa/conductor','application/application-context','system/lang/object','ui/elements/tab-group/view-model','ui/elements/tab-group-item/view-model','ui/elements/header/header-view-model','ui/elements/tool-bar/view-model'],function(require){"use strict"
;var a=require("knockout"),b=require("jquery"),c=require("ramda"),d=require("bluebird"),e=require("system/globalization/translator"),f=require("spa/ko/knockout-view-model"),g=require("system/knockout/knockout-manager"),h=require("text!./views/recommendation-details.html"),i=require("strategy/recommendations/details/recommendation-datasheet"),j=require("strategy/recommendations/details/recommendation-risk-details-view-model"),k=require("strategy/recommendations/details/recommendation-linked-view-model"),l=require("strategy/rcm/rcm-template-dialog-view-model"),m=require("strategy/recommendations/services/recommendation-service"),n=require("ui/elements/risk-matrix/services/risk-assessment-service"),o=require("strategy/rcm/services/template-service"),p=require("system/ui/dialog-box"),q=require("system/ui/busy-indicator"),r=require("spa/region"),s=require("application/application-events"),t=require("strategy/recommendations/recommendation-utility"),u=require("system/ui/message-box"),v=require("toastr"),w=require("strategy/recommendations/recommendation-events"),x=require("spa/conductor"),y=require("application/application-context")
;require("system/lang/object"),require("ui/elements/tab-group/view-model"),require("ui/elements/tab-group-item/view-model"),require("ui/elements/header/header-view-model"),require("ui/elements/tool-bar/view-model");function z(a,b,c,d){A.call(this,h),this.region=null,this.config=d,this.kom=Object.resolve(g),this.events=Object.resolve(w),this.translator=Object.resolve(e),this.conductor=Object.resolve(x),this.applicationEvents=Object.resolve(s),this.busyIndicator=Object.resolve(q),this.recommendationService=Object.resolve(m),this.riskAssessmentService=Object.resolve(n),this.templateService=Object.resolve(o),this.RecommendationUtility=Object.resolve(t),this.recDatasheet=null,this.riskName=c,this.currentRecommendation=a,this.Recommendations=[],this.isNew=!1,this.unmitigatedRiskAssessment=b,this.unmititgatedRiskName=c,this.disableIdentificationTab=!0,this.disableLinkedTab=!1,this.recommendationLinkedViewModel=null,this.recommendationRisksViewModel=null,this.templateDialogViewModel=null,
this.tabs=null,this.dialog=null,this.detailsRegion=null,this.contentDiv=null,this.cachedDataSheetEntity=null,this.linkedRecsCanDelete=!1,this.observables={effectName:null,isTemplate:null,hasDeleteAccess:null,showCopyAction:null,hasCopyAccess:null,recommendationIconsContainer:null,canSaveTemplate:null,showMitigatedTab:null,headerName:null,effectNameVisible:null,showRiskCardComputed:null,showRiskCard:null}}var A=Object.inherit(f,z);z.dependsOn=[s,x],z.prototype.attach=function a(b){this.region=b,B(this),A.prototype.attach.call(this,b),D(this),E(this),this.contentDiv=this.region.element.querySelector(".strategy-recommendation-datasheet"),this.detailsRegion=new r,this.detailsRegion.setElement(this.contentDiv),this.currentRecommendation.Key!==this.RecommendationUtility.NEW_ENTITY_KEY?this.recommendationService.getRecommendation(this.currentRecommendation.Key).done(F.bind(null,this)).fail($.bind(null,this)):this.recDatasheet.loadDataSheet(this.currentRecommendation),
this.region.$element.find("mi-icon").on("click",this.toggleDataSheet.bind(this)),this.busyIndicator.attachTo(this.region.element),this.busyIndicator.show()};function B(a){a.observables.effectName=a.kom.observable(a.riskName),a.observables.isTemplate=a.kom.observable(a.config.isTemplate),a.observables.hasDeleteAccess=a.kom.observable(""),a.observables.showCopyAction=a.kom.observable(!1),a.observables.hasCopyAccess=a.kom.observable(""),a.observables.recommendationIconsContainer=a.kom.observable(!0),a.observables.canSaveTemplate=a.kom.observable(),a.observables.showMitigatedTab=a.kom.observable(!1),a.observables.effectNameVisible=a.kom.observable(!0),a.observables.headerName=a.kom.observable(),a.observables.showRiskCard=a.kom.observable(!1),a.observables.showRiskCardComputed=a.kom.computed(C.bind(null,a)),a.recDatasheet=Object.resolve(i,a),void 0===a.riskName&&a.observables.effectNameVisible(!1),
"0"!==a.currentRecommendation.Key?a.observables.headerName(a.currentRecommendation.Headline+" : "+a.currentRecommendation.State):a.observables.headerName(a.translator.translate("DRAFT_INFO"))}function C(a){a.observables.showRiskCard()&&a.contentDiv?a.contentDiv.classList.add("risk-summary"):a.contentDiv&&a.contentDiv.classList.remove("risk-summary")}function D(a){Element.upgrade(a.region.element.querySelector("mi-tool-bar")),Element.upgrade(a.region.element.querySelector("mi-header mi-icon")),Element.upgrade(a.region.element.querySelector("mi-header")),Element.upgrade(a.region.element.querySelector("mi-tab-group")),Element.upgrade(a.region.element.querySelector("mi-icon")),a.tabs=a.region.element.querySelectorAll("mi-tab"),Element.upgrade(a.tabs)}function E(a){a.config.userPermission&&(a.observables.canSaveTemplate(a.config.userPermission.canSaveAsTemplate),void 0===a.observables.canSaveTemplate()&&a.observables.canSaveTemplate(!0)),
a.config.allowCopy?a.observables.showCopyAction(!0):a.observables.showCopyAction(!1),a.config.linkRec&&(a.config.setAssetFun&&a.region.element.querySelector("mi-tab-group mi-tab:nth-child(3) div.tab-group-item").classList.add("disableLinkedRec"),a.config.setLinkMode&&a.region.element.querySelector("mi-tab-group mi-tab:nth-child(3) div.tab-group-item").classList.add("disableLinkedRec"),(a.config.setAssetFun||a.config.setLinkMode)&&a.region.element.querySelector(".disableLinkedRec").addEventListener("click",a))}function F(a,b){a.currentRecommendation.Entity=b.Entity,a.currentRecommendation.RiskAssessment=b.RiskAssessment,a.currentRecommendation.LinkedRecommendations=b.LinkedRecommendations,a.config.userPermission.canDeleteRecommendation&&a.config.allowDelete?(b.LinkedRecommendations.length>0?(a.config.userPermission.canDeleteRecommendation=!1,a.observables.hasDeleteAccess("no-access")):a.config.userPermission.canDeleteRecommendation=!0,
a.linkedRecsCanDelete=!0):(a.config.userPermission.canDeleteRecommendation=!1,a.observables.hasDeleteAccess("no-access")),a.config.userPermission.canCopyPaste||a.observables.hasCopyAccess("no-access"),"MI_ACCEPTED"===a.currentRecommendation.StateId&&a.observables.hasDeleteAccess("no-access"),a.recDatasheet&&a.recDatasheet.loadDataSheet(a.currentRecommendation),a.currentRecommendation.Headline||a.observables.headerName(b.Headline+" : "+b.State)}z.prototype.handleEvent=function(a){b(a.target).parents("disableLinkedRec")&&a.stopPropagation()},z.prototype.canUnloadDataSheet=function a(){var c=b.Deferred();return this.recDatasheet&&this.recDatasheet.dsheet?this.recDatasheet.dsheet.unload():(c.resolve(!0),c)},z.prototype.detach=function(){(this.config.setAssetFun||this.config.setLinkMode)&&this.region.element.querySelector(".disableLinkedRec").removeEventListener("click",this),this.region.$element.find("mi-icon").off("click"),this.busyIndicator.detach(),
this.recDatasheet&&this.recDatasheet.dsheet&&this.recDatasheet.dsheet.beforeEntitiesSave.remove(this.recDatasheet),this.events.raInserted.remove(this),this.events.reloadRiskAssessment.remove(this),this.templateDialogViewModel&&this.templateDialogViewModel.templateCreatedEvent.remove(this),this.recommendationLinkedViewModel=null,this.recommendationRisksViewModel=null,this.templateDialogViewModel=null,this.recDatasheet=null,this.cachedDataSheetEntity=null,this.tabs=null,this.contentDiv=null,this.detailsRegion=null,this.kom.dispose(),A.prototype.detach.apply(this,arguments)},z.prototype.canUnload=function a(){return this.canUnloadDataSheet()},z.prototype.copyRecommendation=function a(){v.success(this.translator.translate("COPY_REC_SUCCESS")),this.events.copyRecEvent.raise(this.currentRecommendation)};function G(a){return d.resolve(u.showYesNo(a.translator.translate("DELETE_RECOMMENDATION_MSG"),a.translator.translate("CONFIRMATION_DELETE")))}var H=c.curry(function a(b,c){
if(0===c)return b.events.cachedClearList.raise(),b.events.recommendationCountEvent.raise(),b.config.isTemplateRec});function I(a){a.applicationEvents.navigate.raise("strategy/"+a.config.analysisType)}function J(a,b){a.Recommendations=c.filter(c.compose(c.equals(b),c.prop("key")),a.Recommendations),a.events.detailsLoadRecommendationList.raise(a.config.newRecommendationID),a.events.deleteRecommendationLoadActionList.raise(a.config.newRecommendationID),a.busyIndicator.hide(),v.success(a.translator.translate("REC_SIDEPANEL_DELETED"))}var K=c.curry(function a(b,c){void 0!==c&&b.templateService.deleteRCMTemplate(b.config.parentKey).done(I.bind(null,b,b.config.parentKey)).fail($.bind(null,b))}),L=c.curry(function a(b,c){void 0!==c&&(b.busyIndicator.show(),b.recommendationService.deleteRecommendation(b.currentRecommendation.Key).done(J.bind(null,b,b.currentRecommendation.Key)).fail($.bind(null,b)))}),M=c.curry(function a(b,d){return c.cond([[c.identity,K(b)],[c.T,L(b)]])(d)})
;z.prototype.deleteRecommendation=function(){c.composeP(M(this),H(this),G)(this)};function N(a){return a.disableIdentificationTab=!1,a.disableLinkedTab=!1,a.observables.recommendationIconsContainer(!1),a.observables.showRiskCard(!0),a.currentRecommendation.RiskAssessment}var O=c.curry(function a(b,c){var d={mitigatedAssessment:c,unmitigatedRiskAssessment:b.unmitigatedRiskAssessment,unmititgatedRiskName:b.unmititgatedRiskName,headline:b.currentRecommendation.Headline,currentRecKey:b.currentRecommendation.Key};b.recommendationRisksViewModel?b.recommendationRisksViewModel.reload(d):(b.events.raInserted.add(b.riskInserted,b),b.events.reloadRiskAssessment.add(P.bind(null,b),b),b.recommendationRisksViewModel=new j(b,d)),b.conductor.changeScreen(b.recommendationRisksViewModel,b.detailsRegion,{positional:[b]},!1)});function P(a,b){a.unmitigatedRiskAssessment=b}var Q=c.curry(function a(b,c){
b.riskAssessmentService.getDefaultMitigatedRiskAssessment(b.unmitigatedRiskAssessment.key).done(O(b)).fail($.bind(null,b))}),R=c.curry(function a(b,d){return c.cond([[c.isNil,Q(b)],[c.T,c.compose(O(b),c.partial(N,[b]))]])(d)});z.prototype.loadMitigatedRisk=function a(){this.canUnloadDataSheet().done(c.compose(R(this),c.partial(N,[this]))).fail(S.bind(null,this))};function S(a){a.tabs[1].setInactive(),a.tabs[0].setActive()}var T=c.curry(function a(b,c){b.currentRecommendation.RiskAssessment=c}),U=c.curry(function a(b,c,d){b.recommendationService.createRelationship(d,b.currentRecommendation.Key,c.key).done(T(b,c)).fail($.bind(null,b,b.translator.translate("RISK_AND_PARENT_FAILURE_MSG")))});z.prototype.riskInserted=function(a){
return void 0!==this.currentRecommendation.RiskAssessment?void(this.currentRecommendation.RiskAssessment=a):this.config.riskAssessmentRelationshipID.length<1?void u.showOk(this.translator.translate("RECOM_AND_ASSESSMENT_RELATION_MSG"),this.translator.translate("ERROR"),this.RecommendationUtility.warningIcon):void this.recommendationService.getFamilyKey(this.config.riskAssessmentRelationshipID).done(U(this,a)).fail($.bind(null,this,this.translator.translate("GET_FAMILYKEY_MSG")))},z.prototype.loadIdentification=function a(){var b=this;b.disableIdentificationTab||(b.disableIdentificationTab=!0,b.disableLinkedTab=!1,b.observables.recommendationIconsContainer(!0),b.observables.showRiskCard(!1),b.recommendationService.getRecommendation(b.currentRecommendation.Key).done(F.bind(null,b)).fail($.bind(null,b)))},z.prototype.getDataSheetState=function a(){return this.recDatasheet&&this.recDatasheet.dsheet?this.recDatasheet.dsheet.getState():null};var V=c.curry(function a(b,c){var d
;void 0!==c.TargetRecommendation&&(d=c.TargetRecommendation.Key),b.recommendationLinkedViewModel=new k(b,c,b.config.userPermission,d),b.conductor.changeScreen(b.recommendationLinkedViewModel,b.detailsRegion,{positional:[b]},!1)});function W(a){a.disableLinkedTab=!0,a.disableIdentificationTab=!1,a.observables.recommendationIconsContainer(!1),a.observables.showRiskCard(!1),a.busyIndicator.show(),a.recommendationService.getRecommendation(a.currentRecommendation.Key).done(V(a)).fail($.bind(null,a,a.translator.translate("LOAD_RECOM_MSG")))}function X(a){a.tabs[2].setInactive(),a.tabs[0].setActive()}z.prototype.loadLinkedRecommendations=function(){this.disableLinkedTab?(this.tabs[2].setInactive(),this.tabs[0].setActive()):this.canUnloadDataSheet().done(W.bind(null,this)).fail(X.bind(null,this))};function Y(a){
void 0!==a.currentRecommendation.LinkedRecommendations&&a.currentRecommendation.LinkedRecommendations.length>0&&a.linkedRecsCanDelete&&(a.config.userPermission.canDeleteRecommendation=!0),a.linkedRecsCanDelete=!1,b(".strategy-recommendation-datasheet-tabs").toggle("slow"),a.events.detailsLoadRecommendationList.raise(a.config.newRecommendationID)}z.prototype.toggleDataSheet=function(){this.canUnloadDataSheet().done(Y.bind(null,this))},z.prototype.changeUnmitigatedAssessment=function(a){this.unmitigatedRiskAssessment=a};var Z=c.curry(function a(b,c){var d={height:"70%",width:"80%",buttons:[{name:b.translator.translate("CANCEL"),value:"closeDialog",cssClass:"btn btn-primary"}]};c.ID=b.currentRecommendation.Headline,c.Description=b.translator.translate("ANALYSIS_STATUS_TEMPLATE")+": "+b.currentRecommendation.Headline,c.TemplateType=b.config.recommendationFamilyID,
b.templateDialogViewModel?b.templateDialogViewModel=new l(b.currentRecommendation.Key,c):(b.templateDialogViewModel=new l(b.currentRecommendation.Key,c),b.templateDialogViewModel.templateCreatedEvent.add(b.recommendationTemplateCreated,b)),b.dialog=new p(b.templateDialogViewModel,b.translator.translate("RECOMMENDATION_TEMPLATE_TITLE"),d),b.dialog.show()});z.prototype.saveRecommendationAsTemplate=function(){void 0!==this.config.analysisType&&this.templateService.getDefaultRCMTemplate(this.config.analysisType).done(Z(this)).fail($.bind(null,this))},z.prototype.recommendationTemplateCreated=function(a){var b=this;b.dialog.closeDialog(),v.success(b.translator.translate("ANALYSES_RCM_TEMPLATES_SUCCESS_MSG"))};function $(a,b){var e;return a.busyIndicator.hide(),e=c.is(Object,b)?b.responseJSON?b.responseJSON.message:b.responseText:b,u.showOk(e,a.translator.translate("ERROR"),a.RecommendationUtility.warningIcon),d.reject()}return z});

define('text!strategy/recommendations/list/views/recommendation-list.html',[],function () { return '<div class="block recommendation-shell-header">\r\n    <div class="block-group">\r\n        <section class="block list-title">\r\n            <div class="block recommendation-header">\r\n                <span class="rec-number-count" data-bind="text:  observables.recommendationCount"></span>\r\n                <header class="rec-title-style" data-bind="text: translator.translate(\'RECOMMENDED_ACTIONS\')"></header> \r\n               \r\n                    <a class="action management-navigate" data-bind="visible: !config.isStrategicRec, click: navigateToActionManagement">\r\n                        <i class="icon-open-in-new-window"></i>\r\n                        <label class="action-management" data-bind="text: translator.translate(\'ACTION_MANAGEMENT\')"></label>\r\n                    </a>               \r\n               \r\n                <div class="rec-btn-toolbar-divider" data-bind="visible: !config.isStrategicRec"></div>                                          \r\n            </div>\r\n            <div class="block expanded" align="right">\r\n               \r\n            </div>\r\n        </section>\r\n    </div>\r\n</div>\r\n<div class="block-group as-recommendation-details-main">\r\n    <div class="block recListData" data-bind="visible: !observables.isControlFullyExpanded()">\r\n        <mi-list-group multiselect="true"\r\n                       key="Key"\r\n                       use-html="true"\r\n                       description="descriptionHTML"\r\n                       page="1"\r\n                       page-size="25"\r\n                       scroll-percent="0.75"\r\n                       allow-add="false"\r\n                       data-bind="\r\n                            attr: {\r\n                                selector: observables.listSelector\r\n                            },\r\n                            event:{\r\n                                selected: recSelectedEvent,\r\n                                \'add-item\': addItem\r\n                            }">\r\n            <mi-toolbar>\r\n                <div>\r\n                    <mi-filter data-bind="\r\n                        property: {\r\n                            type:\'generic\',\r\n                            sortoptions: observables.sortOptions,\r\n                            sortvalue: observables.sortValue,\r\n                            sortcaption: sortCaption,\r\n                            filteroptions: observables.filterOptions,\r\n                            value: observables.gridFilterValues\r\n                        },\r\n                        attr:{\r\n                            title:translator.translate(\'FILTER\')\r\n                        }"></mi-filter>\r\n                </div>\r\n                <div class="state-management-control pull-right" data-bind="visible: observables.isAnalysisLevel() && observables.recommendationCount() > 0">\r\n                    <mi-state-transition \r\n                        data-bind="\r\n                            attr: {\r\n                                entitykey: $root.processState.observables.firstSelectedRecommendation,\r\n                                disable: $root.processState.observables.disableStateTransition,\r\n                                hiddenops: $root.processState.observables.hiddenOps\r\n                            },\r\n                            event: {\r\n                                beforeStateChanged: $root.processState.onBeforeStateChanged.bind($root.processState)\r\n                            },\r\n                            style: {\r\n                                display: displayState\r\n                            }">\r\n                    </mi-state-transition>\r\n                    <span class="state-management-message" \r\n                          data-bind="text: stateMsgText,\r\n                                     style: { display: displayStateMsg }">\r\n                    </span>\r\n                </div>\r\n            </mi-toolbar>\r\n        </mi-list-group>\r\n    </div>\r\n    <div class="block recResultGrid" data-bind="visible: observables.isControlFullyExpanded">\r\n       \r\n        <div class="block performance-rec-filter-list" id="performance-rec-filter-list" ></div>\r\n        <mi-toolbar>\r\n               <div class="toolbar-wrap">\r\n                <div class="filter-item">\r\n                    <mi-filter data-bind="\r\n                               property: {\r\n                               type:\'generic\',\r\n                               sortoptions: observables.sortOptions,\r\n                               sortvalue: observables.sortValue,\r\n                               sortcaption: sortCaption,\r\n                               filteroptions: observables.filterOptions,\r\n                               value: observables.gridFilterValues},\r\n                               attr:{\r\n                               title:translator.translate(\'FILTER\')\r\n                               }"></mi-filter>\r\n                </div>\r\n                <div class="search-item">\r\n                    <mi-searchbox custom-search="true"></mi-searchbox>\r\n                </div>\r\n                <div class="addRec" data-bind="visible: observables.recAdd">\r\n                    <button class="btn btn-icon" data-bind="\r\n                            attr: {\r\n                            title:translator.translate(\'NEWITEM\')\r\n                            },\r\n                            visible: observables.hasAddAccess(),\r\n                            click: addItemfromGrid"><i class="icon-plus"></i> </button>\r\n                </div>\r\n            </div>\r\n        </mi-toolbar>\r\n        <div class="resultGridState" data-bind="visible: observables.isAnalysisLevel() && observables.recommendationCount() > 0">\r\n            <mi-state-transition data-bind="\r\n                                 attr: {\r\n                                 entitykey: $root.processState.observables.firstSelectedRecommendation,\r\n                                 disable: $root.processState.observables.disableStateTransition,\r\n                                 hiddenops: $root.processState.observables.hiddenOps\r\n                                 },\r\n                                 event: {\r\n                                 beforeStateChanged: $root.processState.onBeforeStateChanged.bind($root.processState)\r\n                                 },\r\n                                 style: {\r\n                                 display: displayState\r\n                                 }\r\n                                 ">\r\n            </mi-state-transition>\r\n            <span class="state-management-message"\r\n                  data-bind="text: stateMsgText,\r\n                                     style: { display: displayStateMsg }">\r\n            </span>\r\n        </div>\r\n        <mi-resultgrid showrowfilter="false" hascolumnchooser="false" showgroupingpanel="true" pagesize="25"></mi-resultgrid>\r\n    </div>\r\n</div>';});


define('text!strategy/recommendations/supersede/views/recommendation-supersede.html',[],function () { return '<div class="as-recommendation-supersede-main">\r\n    <div class="as-recommendation-supersede-main-grid">\r\n        <div class="supersede-message" data-bind="text:translator.translate(\'SUPERSEDE_REC_DESC\')"></div>\r\n        <mi-resultgrid selectionmode=\'single\'></mi-resultgrid>\r\n    </div>\r\n</div>\r\n';});

define('strategy/recommendations/supersede/recommendation-supersede-view-model',['require','knockout','jquery','ramda','bluebird','system/globalization/translator','spa/ko/knockout-view-model','system/lang/converter','text!./views/recommendation-supersede.html','strategy/recommendations/recommendation-events','strategy/recommendations/services/recommendation-service','system/ui/message-box','strategy/recommendations/recommendation-utility','state-management/state-assignment-dialog','system/lang/object','ui/elements/resultgrid/resultgrid-view-model'],function(require){"use strict";var a=require("knockout"),b=require("jquery"),c=require("ramda"),d=require("bluebird"),e=require("system/globalization/translator"),f=require("spa/ko/knockout-view-model"),g=require("system/lang/converter"),h=require("text!./views/recommendation-supersede.html"),i=require("strategy/recommendations/recommendation-events"),j=require("strategy/recommendations/services/recommendation-service"),k=require("system/ui/message-box"),l=require("strategy/recommendations/recommendation-utility"),m=require("state-management/state-assignment-dialog");require("system/lang/object"),require("ui/elements/resultgrid/resultgrid-view-model");function n(a){o.call(this,h),this.events=Object.resolve(i),this.translator=Object.resolve(e),this.RecommendationUtility=Object.resolve(l),this.recommendationService=Object.resolve(j),this.stateAssignmentDialog=Object.resolve(m),this.recommendations=a,this.region=null,this.gridData={},this.driverKey=null,this.linkedKeys=[],
this.responseText=null,this.errors=0}var o=Object.inherit(f,n);n.prototype.reload=function(a){this.recommendations=a},n.prototype.attach=function(a){o.prototype.attach.call(this,a),this.region=a,this.resultGrid=this.region.element.querySelector("mi-resultgrid"),Element.upgrade(this.resultGrid),this.resultGrid.onRowSelectCB=r.bind(null,this),p(this)},n.prototype.detach=function(a){this.resultGrid=null,this.region=null,o.prototype.detach.apply(this,arguments)};function p(a){a.driverKey=c.compose(c.prop("Key"),c.head)(a.recommendations),a.linkedKeys=c.compose(c.map(c.prop("Key")),c.remove(0,1))(a.recommendations),a.gridData.selectedRows=a.recommendations[0],a.gridData.columns=[{id:"Headline",alias:a.translator.translate("HEADLINE")},{id:"PriorityId",alias:a.translator.translate("PRIORITY")}],a.gridData.data=a.recommendations,a.resultGrid.loadJSONData=q.bind(null,a)}function q(a){var c=b.Deferred();return c.resolve(a.gridData),c}function r(a,b){
a.driverKey=c.compose(c.prop("Key"),c.head,c.filter(c.compose(c.equals(g.toString(b.Key)),c.prop("Key"))))(a.recommendations),a.linkedKeys=c.compose(c.map(c.prop("Key")),c.filter(c.compose(c.compose(c.not,c.equals(g.toString(b.Key))),c.prop("Key"))))(a.recommendations)}var s=c.curry(function a(b,e){var f=c.compose(c.compose(c.prop("id"),c.prop("assignedUser"),c.head),c.filter(c.compose(c.equals(b.RecommendationUtility.SUPERSEDED_STATE),c.compose(c.prop("id"),c.prop("state")))))(e);return b.events.supersededLoadingEvent.raise(),d.resolve(b.recommendationService.updateStateAssignments(f,b.RecommendationUtility.SUPERSEDED_STATE,b.linkedKeys)).catch(z.bind(null,b,b.translator.translate("SUPERSEDE_USER_ASSIGNED_ERROR")))}),t=c.curry(function a(b,c){return d.resolve(b.stateAssignmentDialog.show(b.linkedKeys[0],b.translator.translate("STATE_ASSIGNMENT"))).then(b.events.supersededHideLoadingEvent.raise()).catch(z.bind(null,b))}),u=c.curry(function a(b,d){
return c.cond([[c.identity,c.composeP(x(b),c.partial(y,[b]),s(b),t(b))],[c.T,c.composeP(x(b),c.partial(y,[b]))]])(d)}),v=c.curry(function a(b,c){return d.resolve(b.recommendationService.AssignedUserRequired(c,b.linkedKeys)).catch(z.bind(null,b))}),w=c.curry(function a(b,d){return c.length(c.prop("LinkedRecommendations",d))});n.prototype.performSupersede=function(){var a=this.RecommendationUtility.SUPERSEDE_OPERATION,b=c.map(w(this),this.recommendations),d=c.sum(b);this.errors=0,d>0?k.showOk(this.translator.translate("SUPERSEDE_NOT_ALLOWED"),this.translator.translate("ERROR"),this.RecommendationUtility.warningIcon):(this.events.supersededLoadingEvent.raise(),c.composeP(u(this),v(this))(a))};var x=c.curry(function a(b,c){if(!(b.errors>0)){var d=Number(b.responseText)-1+" "+b.translator.translate("SUPERSEDE_ACTION_SUCCESS");b.events.supersededActionDone.raise(b,d)}}),y=c.curry(function a(b){return b.responseText=b.recommendations.length,
d.resolve(b.recommendationService.performSupersede(b.driverKey,b.linkedKeys)).catch(z.bind(null,b))});n.prototype.cancel=function(){this.events.closeSupersedeDialogBox.raise(this)};function z(a,b){a.events.supersededHideLoadingEvent.raise(),a.errors=c.inc(a.errors);var e;return e=c.is(Object,b)?b.responseJSON?b.responseJSON.message:b.responseText:b,k.showOk(e,a.translator.translate("ERROR"),a.RecommendationUtility.warningIcon),d.reject()}return n});
define('system/lang/mixin',['require','lodash','ramda'],function(require){"use strict";var a=require("lodash"),b=require("ramda");function c(a){return{mixinProperties:b.partial(d,[a]),mixinMethods:e(a.prototype)}}function d(a,b){a.call(b)}function e(b){return function c(){return void 0!==arguments[0]?c.call(arguments[0]):(a.extend(this,b),this)}}return{create:c,mixin:e}});
define('system/globalization/has-translator',['require','system/lang/mixin','system/lang/private','system/globalization/translator'],function(require){"use strict";var a=require("system/lang/mixin"),b=require("system/lang/private"),c=require("system/globalization/translator");function d(){b(this).translator=Object.resolve(c)}return d.prototype.transl=function(a){return b(this).translator.translate(a)},a.create(d)});
define('strategy/recommendations/list/recommendations-list-more-options',['require','ramda','bluebird','system/ui/message-box','system/globalization/has-translator','strategy/recommendations/recommendation-utility','strategy/recommendations/services/recommendation-service'],function(require){"use strict";var a=require("ramda"),b=require("bluebird"),c=require("system/ui/message-box"),d=require("system/globalization/has-translator"),e=require("strategy/recommendations/recommendation-utility"),f=require("strategy/recommendations/services/recommendation-service"),g=/ /g;function h(){d.mixinProperties(this),this.RecommendationUtility=Object.resolve(e),this.recommendationService=Object.resolve(f),this.selectedRecs=[],this.config=null}var i=h.prototype;d.mixinMethods(i);var j=a.curry(function a(b,c,d,e){var f=v(e);f.id!==b.RecommendationUtility.SUPERSEDE_OPERATION&&f.id!==b.RecommendationUtility.CONSOLIDATE_OPERATION&&f.id!==b.RecommendationUtility.PROMOTE_OPERATION&&d.userPermission.canEditRecommendation&&c.push(f)}),k=a.curry(function b(c,d,e){if(e.Key!==c.Key){return!!a.compose(a.head,a.filter(a.compose(a.equals(d.id()),a.invoker(0,"id"))))(e.Operations)}return!1}),l=a.curry(function b(c,d,e){return a.compose(a.any(a.equals(!0)),a.map(k(c,e)))(d)
}),m=a.curry(function b(c,d){var e=a.head(c);return d.AssetId.replace(g,"")===e.AssetId.replace(g,"")}),n=a.curry(function b(c,d){return a.compose(a.all(a.equals(!0)),a.map(m(d)))(d)}),o=a.curry(function b(c,d){var e=a.prop("consolidatedRecommendationsCount",d)?a.prop("consolidatedRecommendationsCount",d):0,f=a.prop("supersededRecommendationsCount",d)?a.prop("supersededRecommendationsCount",d):0;return a.sum([e,f])}),p=a.curry(function b(c,d,e,f,g){var h=a.remove(0,1,f),i=a.head(f),j=v(g),k=g.id(),m=n(c,f),p=a.map(o(c),f),q=a.compose(a.gt(a.__,0),a.sum)(p)
;l(i,h,g)&&(k===c.RecommendationUtility.CONSOLIDATE_OPERATION?e.userPermission.canConsolidateRecommendation&&m&&!q&&d.push(j):k===c.RecommendationUtility.SUPERSEDE_OPERATION?e.userPermission.canSupersedeRecommendation&&m&&!q&&d.push(j):k===c.RecommendationUtility.REJECT_OPERATION?e.userPermission.canEditRecommendation&&m&&d.push(j):k===c.RecommendationUtility.APPROVE_OPERATION?e.userPermission.canEditRecommendation&&m&&d.push(j):k!==c.RecommendationUtility.PROMOTE_OPERATION&&d.push(j))});function q(b,c,d){return b.selectedRecs&&(1===b.selectedRecs.length?a.map(j(b,c,b.config),b.selectedRecs[0].Operations):b.selectedRecs.length>1&&a.map(p(b,c,b.config,b.selectedRecs),b.selectedRecs[0].Operations)),d(c)}var r=a.curry(function a(b,c){b.selectedRecs.push(c)}),s=a.curry(function b(c,d){a.map(r(c),d)}),t=a.curry(function c(d,e){var f=a.pluck("Key",e);return b.resolve(d.recommendationService.getRecommendations(f)).catch(w.bind(null,d))});i.enableMoreOptions=function(a,c){var d=[]
;return this.selectedRecs=[],this.config=a,new b(u.bind(null,this,d,c))};function u(b,c,d,e){if(d.length>0)return a.composeP(a.partial(q,[b,c,e]),s(b),t(b))(d);e([])}function v(a){return{id:a.id(),type:"text",text:a.caption(),successorStateId:a.successorState().id(),successorStateCaption:a.successorState().caption()}}function w(d,e){var f;return f=a.is(Object,e)?e.responseJSON?e.responseJSON.message:e.responseText:e,c.showOk(f,d.transl("ERROR"),d.RecommendationUtility.warningIcon),b.reject()}return h});
define('strategy/recommendations/list/recommendations-list-filters',['require','ramda','system/globalization/translator'],function(require){"use strict";var a=require("ramda"),b=require("system/globalization/translator");function c(){this.translator=Object.resolve(b)}var d=a.curry(function b(c,d,e,f){var g=e?"state-":"",h=a.compose(a.gt(a.__,0),a.length)(c),i=!!h&&a.compose(a.gt(a.__,-1),a.indexOf(f.id))(c);d.push({option:{text:f.caption,value:g+f.id,isSelected:i}})}),e=a.curry(function b(c,d,e,f){var g=d?"state-":"",h=e?"type-":"",i=a.findIndex(a.compose(a.equals(h+g+f),a.compose(a.prop("value"),a.prop("option"))))(c);i>-1&&(c[i].option.isSelected=!0)}),f=a.curry(function a(b,c,d){return{option:{text:b.translator.translate("ALL"),value:d,isSelected:0===c.length}}});c.prototype.loadGridFilterValues=function(b,c,g){var h=[];return h.push(f(this,c,"All")),a.map(d(c,h,!1),b),g.filter.state&&a.compose(a.map(e(h,!1,!1)),a.split(","))(g.filter.state),[{type:"checkbox",options:h}]},c.prototype.loadPerformanceGridFilters=function(b,c,h){var i=g(this),j=[];return j.push(f(this,c,"state-All")),
a.map(d(c,j,!0),b),h.filter.state&&a.compose(a.map(e(j,!0,!1)),a.split(","))(h.filter.state),h.filter.perf&&a.compose(a.map(e(i,!1,!0)),a.split(","))(h.filter.perf),[{caption:this.translator.translate("RECOMMENDATIONS_TYPE"),options:i},{caption:this.translator.translate("REC_STATE"),options:j}]};function g(a){return[{option:{text:a.translator.translate("ALL"),value:"type-All",isSelected:!0}},{option:{text:a.translator.translate("CALIBRATION"),value:"type-MI_RECCLBN",isSelected:!1}},{option:{text:a.translator.translate("GENERAL"),value:"type-MI_GENRECOM",isSelected:!1}},{option:{text:a.translator.translate("POLICY"),value:"type-MI_POLRECOM",isSelected:!1}},{option:{text:a.translator.translate("OPR"),value:"type-MI_OPR_REC",isSelected:!1}},{option:{text:a.translator.translate("INSPECTION"),value:"type-MI_RECINSP",isSelected:!1}},{option:{text:a.translator.translate("RCA"),value:"type-MI RCA Recommendation",isSelected:!1}},{option:{text:a.translator.translate("RELIABILITY"),
value:"type-MI Reliability Recommendation",isSelected:!1}},{option:{text:a.translator.translate("AMS"),value:"type-MI_APTAGREC",isSelected:!1}}]}return c});
define('strategy/action-management/viewmodels/recommended-action/state-options',['require','ramda','strategy/recommendations/recommendation-utility'],function(require){"use strict";var a=require("ramda"),b=require("strategy/recommendations/recommendation-utility"),c=/ /g;function d(){this.RecommendationUtility=Object.resolve(b)}var e=a.curry(function a(b,c,d,e){var f=j(e);e.isReserved()||f.id!==b.RecommendationUtility.SUPERSEDE_OPERATION&&f.id!==b.RecommendationUtility.CONSOLIDATE_OPERATION&&f.id!==b.RecommendationUtility.PROMOTE_OPERATION&&d.userPermission.canEditRecommendation&&c.push(f)}),f=a.curry(function b(c,d,e){if(e.Key!==c.Key){return!!a.compose(a.head,a.filter(a.compose(a.equals(d.id()),a.invoker(0,"id"))))(e.Operations)}return!1}),g=a.curry(function b(c,d,e){return a.compose(a.any(a.equals(!0)),a.map(f(c,e)))(d)}),h=a.curry(function b(c,d){var e=a.prop("consolidatedRecommendationsCount",d)?a.prop("consolidatedRecommendationsCount",d):0,f=a.prop("supersededRecommendationsCount",d)?a.prop("supersededRecommendationsCount",d):0;return a.sum([e,f])}),i=a.curry(function b(c,d,e,f,i){
var k=a.remove(0,1,f),l=a.head(f),m=j(i),n=i.id(),o=a.map(h(c),f),p=a.compose(a.gt(a.__,0),a.sum)(o);i.isReserved()&&n!==c.RecommendationUtility.CONSOLIDATE_OPERATION&&n!==c.RecommendationUtility.SUPERSEDE_OPERATION||g(l,k,i)&&(n===c.RecommendationUtility.CONSOLIDATE_OPERATION?e.userPermission.canConsolidateRecommendation&&!p&&d.push(m):n===c.RecommendationUtility.SUPERSEDE_OPERATION?e.userPermission.canSupersedeRecommendation&&!p&&d.push(m):n===c.RecommendationUtility.REJECT_OPERATION?e.userPermission.canEditRecommendation&&d.push(m):n===c.RecommendationUtility.APPROVE_OPERATION?e.userPermission.canEditRecommendation&&d.push(m):n!==c.RecommendationUtility.PROMOTE_OPERATION&&d.push(m))});d.prototype.enableMoreOptions=function(b,c){var d=[];return c&&(1===c.length?a.map(e(this,d,b),c[0].Operations):c.length>1&&a.map(i(this,d,b,c),c[0].Operations)),d};function j(a){return{id:a.id(),type:"text",text:a.caption()}}return d});

define('text!strategy/recommendations/consolidate/views/recommendation-consolidate.html',[],function () { return '<div class="as-recommendation-consolidate-main" data-bind="css:{\'recommendation-manager\': isRecManager() === true}">\r\n    <div class="mainPanel">\r\n\r\n        <div class="block strategy-recommendation-shell-nav">\r\n            <div class="block-group">\r\n                <div class="block recommendation-label">\r\n                    <mi-header>\r\n                        <mi-icon icon="icon-header-back-arrow"></mi-icon>\r\n                        <mi-title data-bind="attr:{title: translator.translate(\'CONSOLIDATE_RECOMMENDATIONS\')}"></mi-title>\r\n                    </mi-header>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        <div class="block headers">\r\n            <div class="block-group">\r\n                <div class="block accordion-header">\r\n                    <div class="accordion-title">\r\n                        <h3 data-bind="text: translator.translate(\'RECOMMENDATION_PROPERTIES\')"></h3>\r\n                    </div>\r\n                    <div class="accordion-button">\r\n                        <input type="button" data-bind="attr:{value: translator.translate(\'MERGE_REMAINING_ON_SELECTED\')}, click: mergeRemainingFields, disable:disableMerge" class="btn btn-primary" />\r\n                    </div>\r\n                </div>\r\n                <div class="block datasheet-header">\r\n                    <div class="datasheet-title">\r\n                        <h3 data-bind="text: translator.translate(\'CONSOLIDATE_PROPERTIES\')"></h3>\r\n                    </div>\r\n                    <div class="datasheet-button">\r\n                        <input type="button" data-bind="attr:{value: translator.translate(\'CONSOLIDATION_TAB_LABEL\')}, click: performConsolidate" class="btn btn-primary" />\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        <div class="accordion-container">\r\n\r\n            <div id="accordionPanel">\r\n                <!-- ko foreach: consolidationData -->\r\n                    <div class="accordion-group">\r\n                        <div class="accordion-heading">\r\n                            <a class="accordion-circle-toggleTag" data-toggle="collapse" data-parent="#accordionPanel" data-bind="attr: { href: \'#\' + order}">\r\n                                <div class="circle">\r\n                                    <div class="arrow">\r\n                                        <div class="icon-right-arrow active"></div>\r\n                                        <div class="icon-arrow"></div>\r\n                                    </div>\r\n                                </div>\r\n                            </a>\r\n                            <a class="accordion-toggleTag" data-toggle="collapse" data-parent="#accordionPanel" data-bind="text: fieldName, attr: { href: \'#\' + order}"></a>\r\n                            <div class="check-mark-wrap">\r\n                                <div class="icon-tick"></div>\r\n                            </div>\r\n                        </div>\r\n                        <div class="accordion-body collapse" data-bind="attr: { id: order}">\r\n                            <div class="accordion-inner block textAlign">\r\n                                <!-- ko foreach: recData -->\r\n                                <div class="accordion-item">\r\n                                    <div class="recNameField">\r\n                                        <span data-bind="text: entityId"></span>\r\n                                    </div>\r\n                                    <div class="recImageField">\r\n                                        <mi-radio-noko  data-bind="attr:{name:entityFieldId}, event:{ mousedown: $root.setAttribute.bind($root) }, css:\'key-\' + entityKey" ></mi-radio-noko>\r\n                                    </div>\r\n                                    <div class="recValueField">\r\n                                        <span data-bind="text: entityFieldValue"></span>\r\n                                    </div>\r\n                                </div>\r\n                                <!-- /ko -->\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                <!-- /ko -->\r\n            </div>\r\n        </div>\r\n\r\n        <div class="dataSheetContainer">\r\n            <div class="consolidate-data-sheet"></div>\r\n        </div>\r\n        <div class="block-group consolidate-recommendation">\r\n            <div class="block rec-consolidate">\r\n                <input type="button" data-bind="attr: {value: translator.translate(\'CANCEL\')}, click:cancel" class="btn btn-primary" />&nbsp;\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n</div>\r\n';});

define('strategy/recommendations/services/recommendation-configuration-service',['require','jquery','system/http/ajax-client'],function(require){"use strict";var a=require("jquery"),b=require("system/http/ajax-client"),c="api/internal/recommendations/configuration";function d(a){this.ajaxClient=a}return d.dependsOn=[b],d.prototype.getBlockedMergeFields=function b(d){var e=a.Deferred();return this.ajaxClient.get(c+"/"+d).done(function(a){e.resolve(a)}).fail(function(a){e.reject(a)}),e.promise()},d});
define('strategy/recommendations/consolidate/recommendation-consolidate-view-model',['require','knockout','jquery','ramda','bluebird','system/globalization/translator','spa/ko/knockout-view-model','text!./views/recommendation-consolidate.html','strategy/recommendations/recommendation-events','strategy/recommendations/services/recommendation-service','strategy/recommendations/services/recommendation-configuration-service','platform/datasheets/datasheet','system/ui/message-box','platform/entity/services/entity-service','strategy/recommendations/recommendation-utility','state-management/state-assignment-dialog','system/ui/busy-indicator','system/hardware/device','spa/conductor','system/lang/object','ui/elements/radio/view-model'],function(require){"use strict";var a=require("knockout"),b=require("jquery"),c=require("ramda"),d=require("bluebird"),e=require("system/globalization/translator"),f=require("spa/ko/knockout-view-model"),g=require("text!./views/recommendation-consolidate.html"),h=require("strategy/recommendations/recommendation-events"),i=require("strategy/recommendations/services/recommendation-service"),j=require("strategy/recommendations/services/recommendation-configuration-service"),k=require("platform/datasheets/datasheet"),l=require("system/ui/message-box"),m=require("platform/entity/services/entity-service"),n=require("strategy/recommendations/recommendation-utility"),o=require("state-management/state-assignment-dialog"),p=require("system/ui/busy-indicator"),q=require("system/hardware/device"),r=require("spa/conductor");require("system/lang/object"),require("ui/elements/radio/view-model");function s(a,b){t.call(this,g),this.region=null,this.config=b,this.targetRecommendationEntity=null,
this.recommendationFields=[],this.sourceKeys=a,this.selectedRecommendationKey=null,this.recommendations=[],this.blockedFields=[],this.consolidatedFields=[],this.dsheet=null,this.events=Object.resolve(h),this.translator=Object.resolve(e),this.conductor=Object.resolve(r),this.RecommendationUtility=Object.resolve(n),this.recommendationService=Object.resolve(i),this.recommendationConfigurationService=Object.resolve(j),this.stateAssignmentDialog=Object.resolve(o),this.entityService=Object.resolve(m),this.busyIndicator=Object.resolve(p),this.device=Object.resolve(q),this.consolidationData=null,this.disableMerge=null,this.recFieldIdx=0,this.isRecManager=!1}var t=Object.inherit(f,s);s.prototype.attach=function(b){this.consolidationData=a.observableArray(),this.disableMerge=a.observable(!1),this.isRecManager=a.observable(this.isRecManager),t.prototype.attach.call(this,b),this.region=b,this.busyIndicator.attachTo(this.region.element.querySelector(".as-recommendation-consolidate-main")),
this.busyIndicator.show(),this.region.$element.find("mi-icon").on("click",u.bind(null,this)),this.stateAssignmentDialog.cancelEvent.add(u.bind(null,this)),A(this),this.device.isMobileApp()&&this.events.panelFullWidth.raise()},s.prototype.detach=function(){this.region.$element.find(".accordion-toggleTag").off("click"),this.region.$element.find("mi-icon").off("click"),this.region.$element.find(".accordion-toggleTag, .accordion-circle-toggleTag").off("click"),this.stateAssignmentDialog.cancelEvent.remove(this),this.busyIndicator.detach(),this.consolidationData=null,this.disableMerge=null,this.isRecManager=null,this.region=null,t.prototype.detach.apply(this,arguments)},s.prototype.setIsRecManager=function(a){this.isRecManager=a};function u(a,b){a.events.loadRecommendationListEvent.raise()}var v=c.curry(function a(b,c){b.targetRecommendationEntity=c,H(b)}),w=c.curry(function a(b,c){return b.selectedRecommendationKey=b.sourceKeys[0],
d.resolve(b.recommendationService.GetConsolidationTarget(b.sourceKeys)).catch(ha.bind(null,b))}),x=c.curry(function a(b,e){var f=c.compose(c.compose(c.prop("id"),c.prop("assignedUser"),c.head),c.filter(c.compose(c.equals(b.RecommendationUtility.CONSOLIDATED_STATE),c.compose(c.prop("id"),c.prop("state")))))(e);return b.busyIndicator.show(),d.resolve(b.recommendationService.updateStateAssignments(f,b.RecommendationUtility.CONSOLIDATED_STATE,b.sourceKeys)).catch(ha.bind(null,b))}),y=c.curry(function a(b,c){return d.resolve(b.stateAssignmentDialog.show(b.sourceKeys[0],b.translator.translate("STATE_ASSIGNMENT"))).then(b.busyIndicator.hide()).catch(u.bind(null,b))}),z=c.curry(function a(b,d){return c.cond([[c.identity,c.composeP(v(b),w(b),x(b),y(b))],[c.T,c.composeP(v(b),w(b))]])(d)});function A(a){a.recommendationService.AssignedUserRequired(a.RecommendationUtility.CONSOLIDATE_OPERATION,a.sourceKeys).done(z(a)).fail(ha.bind(null,a))}var B=c.curry(function(a,b){a.blockedFields=b,O(a)
}),C=c.curry(function a(b){return d.resolve(b.recommendationConfigurationService.getBlockedMergeFields(b.config.sourceModuleName)).catch(ha.bind(null,b))}),D=c.curry(function a(b,c){b.recommendations=c}),E=c.curry(function a(b){return d.resolve(b.entityService.getEntities(b.sourceKeys)).catch(ha.bind(null,b))}),F=c.curry(function a(b,c){b.recommendationFields=c.fields}),G=c.curry(function a(b){return d.resolve(b.recommendationService.getRecommendationFamilyByKey(b.config.recommendationFamilyKey)).catch(ha.bind(null,b,b.translator.translate("FAMILY_FIELDS_ERROR")))});function H(a){return c.composeP(B(a),c.partial(C,[a]),D(a),c.partial(E,[a]),F(a),c.partial(G,[a]))(a)}var I=c.curry(function a(b,d){return c.compose(c.prop("values"),c.head,c.filter(c.compose(c.equals(b),c.prop("id"))))(d.fields)}),J=c.curry(function a(b,d,e){var f=c.compose(c.prop("values"),c.head,c.filter(c.compose(c.equals(b),c.prop("id"))))(e.fields);return c.isArrayLike(f)&&c.isArrayLike(d)&&f[0]!==d[0]
}),K=c.curry(function a(b,d){var e=c.compose(I(d),c.head)(b.recommendations),f=c.remove(0,1,b.recommendations);return c.compose(c.any(c.equals(!0)),c.map(J(d,e)))(f)}),L=c.curry(function a(b,c){b.tempdata.push({entityId:b.headline,entityKey:b.key,entityFieldId:c.id,entityFieldValue:c.values[0],recLinkedStatus:"linkedGreyStatus"})}),M=c.curry(function a(b,d,e){var f=c.compose(c.compose(c.head,c.prop("values")),c.find(c.propEq("id","MI_REC_SHORT_DESCR_CHR")))(e.fields),g={key:e.key,headline:f,tempdata:b};c.compose(L(g),c.find(c.compose(c.equals(d.key.toString()),c.prop("key"))))(e.fields)}),N=c.curry(function a(b,d){var e=[],f=c.findIndex(c.equals(d.id))(b.blockedFields);if(K(b,d.id))f===-1&&(b.recFieldIdx=c.inc(b.recFieldIdx),c.map(M(e,d),b.recommendations),b.consolidationData.push({fieldName:d.caption,fieldId:d.id,order:b.recFieldIdx,recData:e}));else{var g=c.compose(c.head,c.filter(c.compose(c.equals(d.id),c.prop("id"))))(b.recommendations[0].fields);b.consolidatedFields.push({
fieldId:d.id,fieldValue:g.value,merged:!1})}});function O(a){c.map(N(a),a.recommendationFields),0===a.consolidationData().length&&a.disableMerge(!0),P(a),a.loadDataSheet()}function P(a){a.region.$element.find(".accordion-toggleTag, .accordion-circle-toggleTag").on("click",Q.bind(null,a))}function Q(a,b){var c=b.target.classList.contains("accordion-toggleTag")?a.region.$element.find(b.target):a.region.$element.find(b.target).closest(".accordion-circle-toggleTag"),d=c.attr("href"),e=c.parent().find(".icon-right-arrow"),f=c.parent().find(".icon-arrow");b.stopPropagation(),b.preventDefault(),e.hasClass("active")?(e.removeClass("active"),f.addClass("active")):f.hasClass("active")&&(f.removeClass("active"),e.addClass("active")),a.region.$element.find(d).collapse("toggle")}var R=c.curry(function a(b,c){c.getAttribute("href")==="#"+b&&c.parentElement.querySelector(".icon-tick").classList.add("active")});s.prototype.setAttribute=function(a,d){
var e=b(d.currentTarget).closest(".accordion-body").attr("id"),f=a.entityFieldId,g=a.entityFieldValue,h=a.entityKey,i,j;this.busyIndicator.show(),"mousedown"!==d.type&&"click"!==d.type||(d.currentTarget.checked=!0,this.selectedRecommendationKey=h,i=Array.prototype.slice.call(this.region.element.querySelector("#accordionPanel").querySelectorAll(".accordion-toggleTag")),c.map(R(e),i),j=c.findIndex(c.propEq("fieldId",f))(this.consolidatedFields),j!==-1?(this.consolidatedFields[j].fieldValue=g?g:"",this.consolidatedFields[j].merged=!0):this.consolidatedFields.push({fieldId:f,fieldValue:g,merged:!0}),this.loadDataSheet())};var S=c.curry(function a(b,c){return c.querySelector("input").checked}),T=c.curry(function a(b,d){var e,f=Array.prototype.slice.call(d.querySelectorAll(".recImageField"));e=c.filter(c.compose(c.equals(!0),S(b)))(f),0===e.length&&(d.querySelector(".key-"+b.selectedRecommendationKey).checked=!0)}),U=c.curry(function a(b,c){
c.entityKey.toString()===b.selectedRecommendationKey.toString()&&b.consolidatedFields.push({fieldId:c.entityFieldId,fieldValue:c.entityFieldValue,merged:!0})}),V=c.curry(function a(b,c,d){d.entityKey.toString()!==b.selectedRecommendationKey.toString()||c.merged||(c.fieldValue=d.entityFieldValue,c.merged=!0)}),W=c.curry(function a(b,d,e){c.map(V(b,e),d)}),X=c.curry(function a(b,d,e){var f=c.findIndex(c.propEq("fieldId",d.fieldId))(b.consolidatedFields);e.fieldId===d.fieldId&&W(b,d.recData,e),f<0&&!e.merged&&c.map(U(b),d.recData)}),Y=c.curry(function a(b,d){c.map(X(b,d),b.consolidatedFields)});s.prototype.mergeRemainingFields=function(){this.busyIndicator.show();var a=Array.prototype.slice.call(this.region.element.querySelectorAll(".accordion-inner"));c.map(T(this),a),this.region.$element.find(".icon-tick").addClass("active"),c.map(Y(this),this.consolidationData()),this.disableMerge(!0),this.loadDataSheet()},s.prototype.cancel=function(){
this.events.loadRecommendationListEvent.raise(this)},s.prototype.loadDataSheet=function(){var a={functionsAvailable:[],readOnly:!1,showDatasheetSelection:!0,canEdit:!0,showsiteselector:this.config.siteKey.showSiteSelector,disablesiteselector:this.config.siteKey.disableSiteSelector},c={containerEl:b(".consolidate-data-sheet"),entityObj:this.targetRecommendationEntity,familyKey:this.config.recommendationFamilyKey};fa(this),this.busyIndicator.hide(),this.dsheet=new k(c),this.dsheet.load(a).done($.bind(null,this))};var Z=c.curry(function a(b,c){void 0!==c.fieldValue&&(b.dsheet.entityFactory.updateField(b.dsheet.entity,c.fieldId,b.RecommendationUtility.DATASHEET_VALUE,c.fieldValue),b.dsheet.entityFactory.updateField(b.dsheet.entity,c.fieldId,b.RecommendationUtility.DATASHEET__DISPLAYVALUE,c.fieldValue))});function $(a){a.dsheet.setTitle(a.translator.translate("RECOMMENDATION_LABEL")),aa(a),void 0!==a.consolidatedFields&&c.map(Z(a),a.consolidatedFields)}var _=c.curry(function a(b,c){
"0"===c||null===c?ba(b,null):ba(b,c)});function aa(a){var b=a.config.assetKey&&Number(a.config.assetKey)>0?a.config.assetKey:a.config.parentKey,c=a.config.siteKey;c.override?ba(a,c.key):a.recommendationService.getSiteKey(b).done(_(a)).fail(ha.bind(null,a))}function ba(a,b){a.dsheet.datasheetManager.layout.siteKey(b)}var ca=c.curry(function a(b,c){c.value===b.fieldValue&&(c.isSelected=!0)}),da=c.curry(function a(b,d,e){void 0!==e.fieldValue&&d.id===e.fieldId&&(d.dbValue=e.fieldValue,d.value=e.fieldValue,d.originalValue=e.fieldValue,d.previousValue=e.fieldValue,d.previousValues=[e.fieldValue],d.values=[e.fieldValue],d.displayValue=e.fieldValue,d.hasOwnProperty("pickList")&&c.map(ca(e),d.pickList))}),ea=c.curry(function a(b,d){void 0!==b.consolidatedFields&&c.map(da(b,d),b.consolidatedFields)});function fa(a){c.map(ea(a),a.targetRecommendationEntity.fields)}s.prototype.performConsolidate=function(){var a=this.recommendations.length
;this.dsheet&&this.dsheet.entity&&(this.dsheet.entity.entityModified=null,this.dsheet.entity.entityDeleted=null,this.dsheet.entity.entitySaved=null,this.dsheet.entity.entityIdChanged=null,this.dsheet.entity.entityChangedEvent=null),this.busyIndicator.show(),this.recommendationService.PerformConsolidate(this.dsheet.entity,this.sourceKeys).done(ga.bind(null,this,a)).fail(ha.bind(null,this))};function ga(a,b){var c=b+" "+a.translator.translate("CONSOLIDATE_RECOMMENDATION_SUCCESS");a.events.consolidateActionEvent.raise(c)}function ha(a,b){a.busyIndicator.hide();var e;return e=c.is(Object,b)?b.responseJSON?b.responseJSON.message:b.responseText:b,l.showOk(e,a.translator.translate("ERROR"),a.RecommendationUtility.warningIcon),d.reject()}return s});
define('strategy/action-management/viewmodels/recommended-action/consolidate-dialog',['require','toastr','system/lang/private','strategy/recommendations/consolidate/recommendation-consolidate-view-model','system/globalization/has-translator','strategy/recommendations/recommendation-events','system/ui/dialog-box','strategy/recommendations/recommendation-utility','strategy/recommendations/services/recommendation-service'],function(require){"use strict";var a=require("toastr"),b=require("system/lang/private"),c=require("strategy/recommendations/consolidate/recommendation-consolidate-view-model"),d=require("system/globalization/has-translator"),e=require("strategy/recommendations/recommendation-events"),f=require("system/ui/dialog-box"),g=require("strategy/recommendations/recommendation-utility"),h=require("strategy/recommendations/services/recommendation-service");function i(a){b(this).events=Object.resolve(e),b(this).parentClass=a,b(this).recommendationService=Object.resolve(h),b(this).RecommendationUtility=Object.resolve(g),b(this).dialog=null,d.mixinProperties(this)}var j=i.prototype;d.mixinMethods(j),j.load=function(a,c,d){b(this).recommendationService.getFamilyKey(d).done(k.bind(null,this,a,c)).fail(b(this).parentClass.error.bind(null,b(this).parentClass))};function k(a,d,e,g){var h={width:"90%",height:"90%"},i,j=b(a).events;i=new c(d,{sourceModuleName:e,recommendationFamilyKey:g,siteKey:{
override:!0,key:null,showSiteSelector:!0,disableSiteSelector:!1}}),j.consolidateActionEvent.add(l.bind(null,a),a),j.loadRecommendationListEvent.add(m.bind(null,a),a),i.setIsRecManager(!0),b(a).dialog=new f(i,a.transl("CONSOLIDATE_RECOMMENDATIONS"),h),b(a).dialog.show()}function l(c,d){a.success(d),n(c),b(c).dialog.closeDialog(c),b(c).parentClass.reloadData?b(c).parentClass.reloadData(b(c).RecommendationUtility.CONSOLIDATE_OPERATION):b(c).parentClass.reload()}function m(a){n(a),b(a).dialog.closeDialog(a)}function n(a){b(a).events.consolidateActionEvent.remove(a),b(a).events.loadRecommendationListEvent.remove(a)}return i});
define('strategy/action-management/viewmodels/recommended-action/supersede-dialog',['require','system/lang/private','toastr','strategy/recommendations/supersede/recommendation-supersede-view-model','system/globalization/has-translator','strategy/recommendations/recommendation-events','system/ui/dialog-box','strategy/recommendations/recommendation-utility','strategy/recommendations/services/recommendation-service'],function(require){"use strict";var a=require("system/lang/private"),b=require("toastr"),c=require("strategy/recommendations/supersede/recommendation-supersede-view-model"),d=require("system/globalization/has-translator"),e=require("strategy/recommendations/recommendation-events"),f=require("system/ui/dialog-box"),g=require("strategy/recommendations/recommendation-utility"),h=require("strategy/recommendations/services/recommendation-service");function i(b){a(this).events=Object.resolve(e),a(this).parentClass=b,a(this).recommendationService=Object.resolve(h),a(this).RecommendationUtility=Object.resolve(g),a(this).dialog=null,d.mixinProperties(this)}var j=i.prototype;d.mixinMethods(j),j.load=function(b){var c=a(this).parentClass;a(this).recommendationService.getRecommendations(b).done(k.bind(null,this)).fail(c.error.bind(null,c,this.transl("LOAD_RECOM_MSG")))};function k(b,d){var e={width:"90%",height:"80%",buttons:[{name:b.transl("SUPERSEDE_TAB_LABEL"),value:"performSupersede",
cssClass:"btn btn-primary"},{name:b.transl("CANCEL"),cssClass:"btn btn-secondary"}]},g,h=a(b).events;g=new c(d),h.supersededActionDone.add(b.SupersededActionDone,b),h.closeSupersedeDialogBox.add(b.dialogBoxClose,b),h.supersededLoadingEvent.add(m.bind(null,b),b),h.supersededHideLoadingEvent.add(l.bind(null,b),b),a(b).dialog=new f(g,b.transl("Supersede_Recommendations"),e),a(b).dialog.show()}function l(b){a(b).parentClass.busyIndicator.hide()}function m(b){a(b).parentClass.busyIndicator.show()}j.SupersededActionDone=function(c,d){b.success(d),a(this).parentClass.reloadData?a(this).parentClass.reloadData(a(this).RecommendationUtility.SUPERSEDE_OPERATION):a(this).parentClass.reload(),a(this).parentClass.busyIndicator.hide(),n(this)},j.dialogBoxClose=function(b){a(this).dialog.closeDialog(b),a(this).parentClass.busyIndicator.hide(),n(this)};function n(b){a(b).events.supersededActionDone.remove(b),a(b).events.closeSupersedeDialogBox.remove(b),a(b).events.supersededLoadingEvent.remove(b),
a(b).events.supersededHideLoadingEvent.remove(b)}return i});
define('strategy/action-management/viewmodels/recommended-action/unlink-recommendations',['require','system/lang/private','system/globalization/has-translator','toastr','strategy/recommendations/services/recommendation-service'],function(require){"use strict";var a=require("system/lang/private"),b=require("system/globalization/has-translator"),c=require("toastr"),d=require("strategy/recommendations/services/recommendation-service");function e(c){a(this).parentClass=c,a(this).recommendationService=Object.resolve(d),b.mixinProperties(this)}var f=e.prototype;b.mixinMethods(f),f.unlink=function(b){0!==b.length&&(a(this).parentClass.busyIndicator.show(),a(this).recommendationService.UnlinkRecommendations(b).always(a(this).parentClass.busyIndicator.hide.bind(a(this).parentClass.busyIndicator)).done(g.bind(null,this,b.length)).fail(a(this).parentClass.error.bind(null,a(this).parentClass)))};function g(b,d,e){var f=d+" "+b.transl("GENERIC_ACTION_SUCCESS");c.success(f),a(b).parentClass.reloadData?a(b).parentClass.reloadData():a(b).parentClass.reload()}return e});
define('strategy/action-management/viewmodels/recommended-action/state-assignment',['require','ramda','system/lang/private','system/globalization/has-translator','toastr','strategy/recommendations/recommendation-utility','state-management/state-assignment-dialog','strategy/recommendations/services/recommendation-service'],function(require){"use strict";var a=require("ramda"),b=require("system/lang/private"),c=require("system/globalization/has-translator"),d=require("toastr"),e=require("strategy/recommendations/recommendation-utility"),f=require("state-management/state-assignment-dialog"),g=require("strategy/recommendations/services/recommendation-service");function h(){b(this).recommendationService=Object.resolve(g),b(this).RecommendationUtility=Object.resolve(e),b(this).stateAssignmentDialog=Object.resolve(f),b(this).selectedState=null,c.mixinProperties(this)}var i=h.prototype;c.mixinMethods(i),i.showStateAssignmentDialog=function(c,d){return b(this).selectedState=d,b(this).sourceKeys=c,b(this).stateAssignmentDialog.show(a.last(c),this.transl("STATE_ASSIGNMENT"))},i.stateAssignmentDialogDone=function(a){var c=j(this),d,e;for(e=0;e<a.length;e++)if(a[e].state.id===c&&null!==a[e].assignedUser){d=a[e].assignedUser.id;break}
return b(this).recommendationService.updateStateAssignments(d,c,b(this).sourceKeys)},i.bulkStateAssignmentDialogDone=function(a){var c,d=[];for(c=0;c<a.length;c++){var e={};null!==a[c].assignedUser&&(e.userId=a[c].assignedUser.id,e.state=a[c].state.id,d.push(e))}return b(this).recommendationService.bulkUpdateStateAssignments(d,b(this).sourceKeys)};function j(a){var c=b(a).selectedState;switch(b(a).selectedState){case b(a).RecommendationUtility.APPROVE_OPERATION:c=b(a).RecommendationUtility.APPROVED_STATE;break;case b(a).RecommendationUtility.REJECT_OPERATION:c=b(a).RecommendationUtility.REJECTED_STATE;break;case b(a).RecommendationUtility.PROMOTE_OPERATION:c=b(a).RecommendationUtility.ACCEPTED_STATE;break;case b(a).RecommendationUtility.IMPLEMENT_OPERATION:c=b(a).RecommendationUtility.IMPLEMENTED_STATE}return c}return h});
define('strategy/action-management/viewmodels/recommended-action/perform-state-operation',['require','ramda','bluebird','system/lang/private','system/globalization/has-translator','toastr','strategy/recommendations/recommendation-utility','./state-assignment','system/ui/message-box','strategy/recommendations/services/recommendation-service'],function(require){"use strict";var a=require("ramda"),b=require("bluebird"),c=require("system/lang/private"),d=require("system/globalization/has-translator"),e=require("toastr"),f=require("strategy/recommendations/recommendation-utility"),g=require("./state-assignment"),h=require("system/ui/message-box"),i=require("strategy/recommendations/services/recommendation-service");function j(a){c(this).parentClass=a,c(this).recommendationService=Object.resolve(i),c(this).RecommendationUtility=Object.resolve(f),c(this).stateAssignment=Object.resolve(g),c(this).selectedState=null,c(this).sourceKeys=null,d.mixinProperties(this)}var k=j.prototype;d.mixinMethods(k);var l=a.curry(function a(d,e){return r(d).show(),b.resolve(c(d).recommendationService.PerformOperation(c(d).selectedState,c(d).sourceKeys)).catch(q.bind(null,d))}),m=a.curry(function a(b,d){var f=r(b),g=c(b).sourceKeys.length+" "+b.transl("GENERIC_ACTION_SUCCESS");e.success(g),
c(b).parentClass&&c(b).parentClass.events&&c(b).parentClass.events.recStateChangedEvent&&c(b).parentClass.events.recStateChangedEvent.raise(b,g),c(b).parentClass.reloadData?c(b).parentClass.reloadData():c(b).parentClass.reload(),f.hide()}),n=a.curry(function a(d,e){return r(d).show(),b.resolve(c(d).stateAssignment.stateAssignmentDialogDone(e)).catch(q.bind(null,d))}),o=a.curry(function a(d,e){var f=r(d);return b.resolve(c(d).stateAssignment.showStateAssignmentDialog(c(d).sourceKeys,c(d).selectedState)).then(f.hide()).catch(q.bind(null,d))}),p=a.curry(function b(c,d){return a.cond([[a.identity,a.composeP(m(c),l(c),n(c),o(c))],[a.T,a.composeP(m(c),l(c))]])(d)});k.performOperation=function(a,b){c(this).selectedState=a,c(this).sourceKeys=b,c(this).recommendationService.AssignedUserRequired(a,b).done(p(this)).fail(c(this).parentClass.error.bind(null,this))};function q(d,e){var f;return r(d).hide(),f=a.is(Object,e)?e.responseJSON?e.responseJSON.message:e.responseText:e,
h.showOk(f,d.transl("ERROR"),c(d).RecommendationUtility.warningIcon),b.reject()}function r(a){return c(a).parentClass.busyIndicator}return j});
define('strategy/action-management/viewmodels/recommended-action/process-state',['require','lodash','jquery','ramda','bluebird','system/globalization/has-translator','toastr','system/lang/private','system/knockout/knockout-manager','system/ui/message-box','system/ui/busy-indicator','strategy/recommendations/recommendation-utility','strategy/recommendations/services/recommendation-service','./state-options','./consolidate-dialog','./supersede-dialog','./unlink-recommendations','./state-assignment','./perform-state-operation'],function(require){"use strict";var a=require("lodash"),b=require("jquery"),c=require("ramda"),d=require("bluebird"),e=require("system/globalization/has-translator"),f=require("toastr"),g=require("system/lang/private"),h=require("system/knockout/knockout-manager"),i=require("system/ui/message-box"),j=require("system/ui/busy-indicator"),k=require("strategy/recommendations/recommendation-utility"),l=require("strategy/recommendations/services/recommendation-service"),m=require("./state-options"),n=require("./consolidate-dialog"),o=require("./supersede-dialog"),p=require("./unlink-recommendations"),q=require("./state-assignment"),r=require("./perform-state-operation"),s=c.prop("FamilyID"),t=c.compose(s,c.head),u=c.map(s),v=c.invoker(0,"id"),w=c.prop("id"),x=c.map(v),y=c.map(w),z=c.prop("Type"),A=c.compose(z,c.head),B=c.prop("State"),C=c.compose(B,c.head),D=c.map(B);function E(a){g(this).parentClass=a,g(this).region=null,g(this).recAvailableOperations=Object.resolve(m),
g(this).recommendationService=Object.resolve(l),g(this).recommendationUtility=Object.resolve(k),g(this).supersedeDialog=Object.resolve(o,a),g(this).consolidateDialog=Object.resolve(n,a),g(this).unlinkRecs=Object.resolve(p,a),g(this).stateOperation=Object.resolve(r,a),g(this).stateAssignment=Object.resolve(q),g(this).kom=Object.resolve(h),g(this).stateManagmentBusyIndicator=Object.resolve(j,"loading-med"),g(this).stateControl=null,g(this).stateTransitionSubscription=null,g(this).availableOperations=[],g(this).selectedRecDTOs=[],this.observables={firstSelectedRecommendation:g(this).kom.observable(),disableStateTransition:g(this).kom.observable(!1),showStateManagement:g(this).kom.observable(!1),hiddenOps:g(this).kom.observableArray(["MI_PROMOTE"])},e.mixinProperties(this)}var F=E.prototype;e.mixinMethods(F),F.attach=function(a){g(this).region=a,g(this).stateControl=a.element.querySelector("mi-state-transition"),Element.upgrade(g(this).stateControl),
g(this).stateManagmentBusyIndicator.attachTo(a.element.querySelector(".state-management-control")),g(this).region.$element.on("shown.bs.popover",this,G),g(this).region.$element.on("hide.bs.popover",this,L)},F.detach=function(){g(this).region.$element.off("shown.bs.popover"),g(this).region.$element.off("hide.bs.popover"),g(this).stateTransitionSubscription&&(g(this).stateTransitionSubscription.dispose(),g(this).stateTransitionSubscription=null),g(this).stateControl=null,g(this).region=null,this.observables.showStateManagement(!1)},F.unload=function(){g(this).kom.dispose()},F.processStates=function(a){this.hideStateControl(),a.length>0?(g(this).stateManagmentBusyIndicator.show(),g(this).recommendationService.getRecommendations(a).done(M.bind(null,this,a)).fail(R.bind(null,this))):O(this)([])},F.hideStateControl=function(){this.observables.firstSelectedRecommendation(null),this.observables.showStateManagement(!1)},F.getSelectedRecDTOs=function(){return g(this).selectedRecDTOs}
;function G(a){var c=a.data;b(".state-assignment .assignment-dialog-link a").off("click"),b(".state-assignment .assignment-dialog-link a").on("click",K.bind(null,c))}var H=c.curry(function a(b,c){Q(b).hide()}),I=c.curry(function a(b,c){return Q(b).show(),d.resolve(g(b).stateAssignment.bulkStateAssignmentDialogDone(c)).catch(R.bind(null,b))}),J=c.curry(function a(b,c){return d.resolve(g(b).stateAssignment.showStateAssignmentDialog(c,"")).catch(R.bind(null,b))});function K(a,d){d.stopPropagation();var e=O(a)();b(".mi-state.popover").hide(),c.composeP(H(a),I(a),J(a))(e)}function L(){b(".state-assignment .assignment-dialog-link a").off("click")}function M(a,b,d){var e=c.head(b),f={userPermission:{canEditRecommendation:!0,canConsolidateRecommendation:!0,canSupersedeRecommendation:!0}},h=t(d),i=c.compose(c.all(c.equals(h)),u)(d),j=C(d),k=c.compose(c.all(c.equals(j)),D)(d);g(a).stateManagmentBusyIndicator.hide(),g(a).availableOperations=g(a).recAvailableOperations.enableMoreOptions(f,d),
g(a).selectedRecDTOs=d,O(a)(b),g(a).availableOperations.length>0&&i&&k?(a.observables.firstSelectedRecommendation(e),g(a).stateTransitionSubscription||(g(a).stateTransitionSubscription=P(a).transition.subscribe(N.bind(null,a)))):a.hideStateControl()}function N(b,d){if(a.has(d,"successors")){var e=x(d.successors()),f=y(g(b).availableOperations),h=c.difference(e,f);b.observables.hiddenOps(h),b.observables.showStateManagement(!0)}}F.onBeforeStateChanged=function(a,b){b.originalEvent.detail.cancel=!0;var c=b.originalEvent.detail.transitionData.operation.id,d=g(this),e=t(d.selectedRecDTOs),f=A(d.selectedRecDTOs),h=O(this)();switch(d.parentClass.resultGrid.resetGridSelections&&d.parentClass.resultGrid.resetGridSelections(),!f&&a.config&&a.config.analysisType&&(f=a.config.analysisType),c){case d.recommendationUtility.SUPERSEDE_OPERATION:d.supersedeDialog.load(h);break;case d.recommendationUtility.CONSOLIDATE_OPERATION:d.consolidateDialog.load(h,f,e);break
;case d.recommendationUtility.REVERT_CONSOLIDATE_OPERATION:case d.recommendationUtility.REVERT_SUPERSEDE_OPERATION:d.unlinkRecs.unlink(h);break;case void 0:break;default:d.stateOperation.performOperation(c,h)}};function O(a){return g(a).parentClass.observables.selectedRecommendations}function P(a){return g(a).stateControl.viewModel.popoverContentViewModel}function Q(a){return g(a).parentClass.busyIndicator}function R(a,b){var e;return Q(a).hide(),g(a).stateManagmentBusyIndicator.hide(),e=c.is(Object,b)?b.responseJSON?b.responseJSON.message:b.responseText:b,i.showOk(e,a.transl("ERROR"),g(a).recommendationUtility.warningIcon),d.reject()}return E});
define('strategy/recommendations/list/recommendations-list-cache',['require','lodash','strategy/recommendations/recommendation-events'],function(require){"use strict";var a=require("lodash"),b=require("strategy/recommendations/recommendation-events");function c(a,c){this.parentClass=a,this.events=Object.resolve(b),this.cachedValues=c||{filter:{state:null,perf:null},search:null,sort:{value:null,options:null},list:{uid:null,data:null,total:null}},this.cacheKey=null,this.cachedFilterObservable=null,this.cachedFilterObservableSubscription=null}c.prototype.detach=function(){this.cachedValues&&(this.parentClass.selectedSortValue&&(this.cachedValues.sort.value=this.parentClass.selectedSortValue),this.parentClass.observables.sortOptions()&&(this.cachedValues.sort.options=this.parentClass.observables.sortOptions()),this.parentClass.searchText&&(this.cachedValues.search=this.parentClass.searchText),this.parentClass.filterValues&&(this.cachedValues.filter.state=this.parentClass.filterValues),this.parentClass.config.perfFilterTypes&&(this.cachedValues.filter.perf=this.parentClass.config.perfFilterTypes),
this.cachedFilterObservable.valueHasMutated())},c.prototype.subscriptions=function(){this.cachedFilterObservableSubscription=this.cachedFilterObservable.subscribe(d.bind(null,this))};function d(a){a.events.cachedValuesEvent.raise(a.cachedValues)}c.prototype.setSortValue=function(a){this.cachedValues.sort.value=a,e(this)},c.prototype.setFilterState=function(a){this.cachedValues.filter.state=a,e(this)},c.prototype.setPerfFilter=function(a,b){this.cachedValues.filter.state=a,this.cachedValues.filter.perf=b,e(this)},c.prototype.setSearch=function(a){this.cachedValues.search=a,e(this)},c.prototype.loadCachedValues=function(){if(0!==Object.keys(this.cachedValues).length&&(this.cachedValues.search&&(this.parentClass.searchText=this.cachedValues.search),this.cachedValues.sort.value&&(this.parentClass.selectedSortValue=this.cachedValues.sort.value,this.parentClass.observables.sortValue(this.cachedValues.sort.value)),
this.cachedValues.sort.options&&this.parentClass.observables.sortOptions(this.cachedValues.sort.options),this.cachedValues.filter&&this.cachedValues.filter.state&&(this.parentClass.filterValues=this.cachedValues.filter.state),this.cachedValues.filter&&this.cachedValues.filter.perf&&(this.parentClass.config.perfFilterTypes=this.cachedValues.filter.perf),this.cacheKey&&this.cachedValues.list.uid===this.cacheKey)){if(this.parentClass.observables.recommendationCount(this.cachedValues.list.total),this.events.recCountUpdateEvent.raise(this.cachedValues.list.total),!this.parentClass.observables.isControlFullyExpanded())return this.cachedValues.list.data;if(this.cachedValues.list.total===this.cachedValues.list.data.length)return this.parentClass.recommendationGridData.data=this.cachedValues.list.data,this.parentClass.recommendationGridData}},c.prototype.resetCacheKey=function(){e(this),this.cacheKey=this.cachedValues.list.uid},c.prototype.resetCacheData=function(a,b,c){var d=a
;d.hasOwnProperty("Recommendations")&&(d=d.Recommendations),(c||0===c)&&(this.cachedValues.list.total=c),b&&b>1&&(d=this.cachedValues.list.data.concat(d)),this.cachedValues.list.data=d,f(this)},c.prototype.nullCacheUID=function(){this.cachedValues.list.uid=null,f(this)};function e(b){b.cachedValues.list.uid=a.uniqueId(),f(b)}function f(a){a.cachedFilterObservable&&a.cachedFilterObservable.valueHasMutated()}return c});

define('text!ui/elements/more-options/template.html',[],function () { return '<button class="mi-more-options-icon btn btn-primary btn-icon">\r\n    <i class="icon-options"></i>\r\n</button>';});


define('text!ui/elements/more-options/content-view.html',[],function () { return '<ul class="more-options-content" data-bind="visible: visible,foreach:options">\r\n    <!-- ko if: type == "select"-->\r\n    <li data-bind="click: $root.selectClicked.bind($parent)">\r\n        <span data-bind="attr: {class: icon}"></span>\r\n        <select data-bind="options: options,\r\n                           optionsText: \'displayName\',\r\n                           optionsValue: \'val\',\r\n                           value: value,\r\n                           "></select>\r\n    </li>\r\n    <!-- /ko -->\r\n    <!-- ko if: type != "select"-->\r\n    <li data-bind="click: $root.optionClicked.bind($parent),css: { \'disabled\': $data.disabled}">\r\n        <span data-bind="attr: {class: icon}"></span>\r\n        <span data-bind="text: text"></span>\r\n    </li>\r\n    <!-- /ko -->\r\n</ul>\r\n\r\n';});

define('ui/elements/more-options/view-model',['require','lodash','jquery','knockout','system/knockout/knockout-manager','text!./template.html','text!./content-view.html','spa/region'],function(require){"use strict";var a=require("lodash"),b=require("jquery"),c=require("knockout"),d=require("system/knockout/knockout-manager"),e=require("text!./template.html"),f=require("text!./content-view.html"),g=require("spa/region"),h={};h.prototype=Object.create(HTMLElement.prototype),h.prototype.createdCallback=function(){var f=this,h,l="",m=null,n=null;this.element=this,this.properties=[],this.kom=Object.resolve(d),this.innerHTML=e,this.bindArrayProperty("options"),this.bindAttribute("scrollingElement"),this.value=null,this.moreOptionsContent=new g(null,null),this.visible=c.observable(!1),this.resizeProxy=b.proxy(a.debounce(this.resize,100),this),this.scrollProxy=b.proxy(function(){this.visible(!1)},this),this.subscriptions=[],Object.defineProperty(f,"icon",{get:function(){return f.internalIcon}.bind(f),set:function(a){i.call(null,f,a)}.bind(f)}),Object.defineProperty(f,"disabled",{get:function(){return f._disabled}.bind(f),set:function(a){j.call(null,f,a)}.bind(f)}),
Object.defineProperty(f,"tooltip",{get:function(){}.bind(f),set:function(a){k.call(null,f,a)}.bind(f)})},h.prototype.bindArrayProperty=function(a){this[a]=this.kom.observableArray(),this.properties.push(a)},h.prototype.bindAttribute=function(a,c,d){this[a]=this.kom.observable(),this[a+"Changed"]=function(b,c){this[a](c)}.bind(this),this.kom.subscribe(this[a],function(c){b(this.element).trigger("attributes."+a+":changed",[c])},this),d&&this.kom.subscribe(this[a],d,this),this[a](Object.defaultValue(this.element.getAttribute(a),c))},h.prototype.attachedCallback=function(){var a=this;b(a.element).find(".mi-more-options-icon").on("click",o.bind(null,a)),b(document).on("click",l.bind(null,a))};function i(a,c){c?b(a).find("button i").removeAttr("class").addClass(c.trim()):b(a).find("button i").removeAttr("class").addClass("icon-options")}function j(a,c){a._disabled=c,c?b(a).find("button").addClass("disabled"):b(a).find("button").removeClass("disabled")}function k(a,c){
c&&b(a).find("button").attr("title",c)}function l(a){a.visible()&&(b(".more-options-outer-container").remove(),a.visible(!1))}h.prototype.detachedCallback=function(){var a=this;b(a.element).find(".mi-more-options-icon").off("click"),b(document).off("click",l.bind(null,a))},h.prototype.moreoptionsCB=function(a){this.callback=a},h.prototype.resize=function(a){n(this)},h.prototype.optionClicked=function(a,b){b.stopPropagation(),a.disabled!==!0&&(o(this),Object.tryMethod(this,"callback",a))},h.prototype.selectClicked=function(a,b){b.stopPropagation()};function m(b,c){var d;o(b),d=a.find(b.options,function(a){if(a.value)return a.value()===c}),Object.tryMethod(b,"callback",d)}function n(a){var c,d,e,f=50,g,h,i,j;c=b(a.contentContainer),d=b(a.element).find(".mi-more-options-icon").offset(),e=b(a.element).find(".mi-more-options-icon").width(),a.topOffset=d.top,a.leftOffset=d.left,b(c).css({position:"absolute"}),setTimeout(function(){g=b(a.contentContainer).width(),
h=b(a.contentContainer).height(),b(c).find(".more-options-content").removeClass("top-left top-right bottom-left bottom-right"),d.top+h>=b(window).height()?(i=d.top-h-10,d.left+e-g<80?(j=d.left,b(c).find(".more-options-content").addClass("top-left")):(j=d.left-Math.abs(e-g),b(c).find(".more-options-content").addClass("top-right")),b(c).find(".more-options-content").css({"box-shadow":"0px 0px 12px 6px rgba(0, 0, 0, 0.175)","-webkit-box-shadow":"0px 0px 12px 6px rgba(0, 0, 0, 0.175)"})):(i=a.topOffset+f-6,d.left+e-g<80?(j=d.left,b(c).find(".more-options-content").addClass("bottom-left")):(j=d.left-Math.abs(e-g),b(c).find(".more-options-content").addClass("bottom-right"))),b(c).css({left:j,top:i}),a.height&&b(c).find(".more-options-content").css({maxHeight:a.height})},1)}function o(a,c){c&&c.stopPropagation();var d=".content";a.scrollingElement()&&(d=a.scrollingElement()),a.visible()?(b(window).off("resize",a.resizeProxy),b("body").find(d).off("scroll",a.scrollProxy),q(a)):(p(a),
b(window).on("resize",a.resizeProxy),b("body").find(d).on("scroll",a.scrollProxy)),a.visible(!a.visible())}function p(a){var d="document",e,g,h;for(a.scrollingElement()&&(d=a.scrollingElement()),g=b("mi-more-options"),h=0;h<g.length;h++)g[h].visible()&&(g[h].visible(!1),b(g[h]).find(".more-options-outer-container").remove());for(e=document.createElement("div"),b(e).addClass("more-options-outer-container"),document.body.appendChild(e),a.contentContainer=b(e),a.moreOptionsContent.setElement(e),a.moreOptionsContent.attach(b(f)),c.applyBindings(a,a.moreOptionsContent.activeContainer),h=0;h<a.options.length;h++)"select"===a.options[h].type&&a.subscriptions.push(a.options[h].value.subscribe(m.bind(null,a)));n(a)}function q(a){var b;for(b=0;b<a.subscriptions.length;b++)a.subscriptions[b].dispose();c.cleanNode(a.moreOptionsContent.activeContainer),a.contentContainer.remove()}return document.registerElement("mi-more-options",{prototype:h.prototype}),h});
define('strategy/recommendations/list/recommendation-list-control',['require','ramda','knockout','jquery','system/globalization/translator','spa/ko/knockout-view-model','system/knockout/knockout-manager','text!./views/recommendation-list.html','strategy/recommendations/recommendation-events','strategy/recommendations/recommendation-utility','strategy/recommendations/services/recommendation-service','strategy/recommendations/supersede/recommendation-supersede-view-model','system/ui/dialog-box','system/ui/message-box','state-management/state-assignment-dialog','system/ui/busy-indicator','application/application-events','strategy/rcm/rcm-utility','system/lang/converter','spa/conductor','toastr','application/application-context','strategy/recommendations/list/recommendations-list-more-options','strategy/recommendations/list/recommendations-list-filters','strategy/action-management/viewmodels/recommended-action/process-state','strategy/recommendations/list/recommendations-list-cache','system/lang/object','ui/elements/select/view-model','ui/elements/list-group/view-model','ui/elements/more-options/view-model','ui/elements/checkbox/checkbox-view-model','ui/elements/tool-bar/view-model','ui/elements/searchbox/view-model','ui/elements/filter/filter-view-model','ui/elements/resultgrid/resultgrid-view-model','ui/elements/more-options/more-options'],function(require){"use strict"
;var a=require("ramda"),b=require("knockout"),c=require("jquery"),d=require("system/globalization/translator"),e=require("spa/ko/knockout-view-model"),f=require("system/knockout/knockout-manager"),g=require("text!./views/recommendation-list.html"),h=require("strategy/recommendations/recommendation-events"),i=require("strategy/recommendations/recommendation-utility"),j=require("strategy/recommendations/services/recommendation-service"),k=require("strategy/recommendations/supersede/recommendation-supersede-view-model"),l=require("system/ui/dialog-box"),m=require("system/ui/message-box"),n=require("state-management/state-assignment-dialog"),o=require("system/ui/busy-indicator"),p=require("application/application-events"),q=require("strategy/rcm/rcm-utility"),r=require("system/lang/converter"),s=require("spa/conductor"),t=require("toastr"),u=require("application/application-context"),v=require("strategy/recommendations/list/recommendations-list-more-options"),w=require("strategy/recommendations/list/recommendations-list-filters"),x=require("strategy/action-management/viewmodels/recommended-action/process-state"),y=require("strategy/recommendations/list/recommendations-list-cache")
;require("system/lang/object"),require("ui/elements/select/view-model"),require("ui/elements/list-group/view-model"),require("ui/elements/more-options/view-model"),require("ui/elements/checkbox/checkbox-view-model"),require("ui/elements/tool-bar/view-model"),require("ui/elements/searchbox/view-model"),require("ui/elements/filter/filter-view-model"),require("ui/elements/resultgrid/resultgrid-view-model"),require("ui/elements/more-options/more-options");function z(a,c,e,k,l){A.call(this,g),this.kom=Object.resolve(f),this.translator=Object.resolve(d),this.conductor=a||Object.resolve(s),this.recommendationService=Object.resolve(j),this.applicationEvent=Object.resolve(p),this.RecommendationUtility=Object.resolve(i),this.stateAssignmentDialog=Object.resolve(n),this.busyIndicator=Object.resolve(o),this.RCMUtility=Object.resolve(q),this.events=Object.resolve(h),this.recMoreOptions=Object.resolve(v),this.recFilters=Object.resolve(w),this.recListCache=Object.resolve(y,this,k),
this.processState=Object.resolve(x,this),this.region=null,this.config=c,this.filterlist=[],this.filterValues=null,this.selectedStateOperation="",this.recommendationGridData={columns:null,data:[]},this.selectedRecommendations=[],this.defaultRecFilterArr=[],this.resultGridSearch=null,this.selectedSortValue=null,this.consolidateSuccess=l,this.sortCaption=c.isStrategicRec?this.translator.translate("EQUIPMENT_ID"):this.translator.translate("SORT_BY"),this.recommendationSupersedeViewModel=null,this.resultGrid=null,this.currentListPage=null,this.cancelListSelection=!1,this.moreoptions=null,this.gridmoreoptions=null,this.expanded=e,this.recommendationListView=null,this.cachedDataSheetEntity=null,this.observables={recommendationCount:null,options:null,sortOptions:null,filterOptions:null,gridFilterValues:null,isAnalysisLevel:null,listSelector:null,recAdd:null,isControlFullyExpanded:null,disableOptions:null,sortValue:null,hasAddAccess:null,selectedRecommendations:this.kom.observableArray([])},
this.stateMsgText=this.translator.translate("STATE_SELECTION"),this.displayState=b.pureComputed(B.bind(null,this)),this.displayStateMsg=b.pureComputed(C.bind(null,this))}var A=Object.inherit(e,z);z.prototype.reload=function(a,b,c,d){this.config=a,this.expanded=b,this.recListCache.cachedValues=c?c:this.recListCache.cachedValues,this.consolidateSuccess=d,this.processState.hideStateControl()},z.prototype.attach=function(a){this.region=a,this.observables.recommendationCount=this.kom.observable(0),this.observables.options=this.kom.observableArray([]),this.observables.sortOptions=this.kom.observableArray([]),this.observables.filterOptions=b.observableArray([]),this.observables.gridFilterValues=this.kom.observable(),this.observables.isAnalysisLevel=this.kom.observable(this.config.isAnalysisLevel),this.observables.listSelector=this.kom.observable("none"),this.observables.recAdd=this.kom.observable(this.config.allowAdd),this.observables.isControlFullyExpanded=this.kom.observable(this.expanded),
this.observables.disableOptions=this.kom.observable(!0),this.observables.sortValue=this.kom.observable(),this.observables.hasAddAccess=this.kom.observable(!1),this.recListCache.cachedFilterObservable=b.observable(),A.prototype.attach.call(this,a),this.busyIndicator.attachTo(a.element),E(this),D(this),F(this),this.config.isStrategicRec?(Z(this),N(this)):_(this),G(this),this.consolidateSuccess&&this.consolidateActionDone(this.consolidateSuccess),M(this),H(this),this.processState.attach(a)};function B(a){return a.processState.observables.showStateManagement()?"block":"none"}function C(a){return a.processState.observables.showStateManagement()?"none":"block"}function D(a){a.config.userPermission.canCreateRecommendation||c(".as-add-recommendation").unbind("click"),a.config.isAnalysisLevel&&a.observables.listSelector("toggle"),a.config.defaultRecFilterSelectedValues&&(a.defaultRecFilterArr=a.config.defaultRecFilterSelectedValues.split(","),
a.filterValues=a.config.defaultRecFilterSelectedValues),a.observables.recAdd()&&a.config.userPermission.canCreateRecommendation&&(a.recommendationListView.setAttribute("allow-add","true"),a.observables.hasAddAccess(!0))}function E(a){a.recommendationListView=a.region.element.querySelector("mi-list-group"),Element.upgrade(a.recommendationListView),a.recommendationListView.searchCallback=a.searchedRecommendations.bind(a),a.resultGrid=a.region.element.querySelector("mi-resultgrid"),Element.upgrade(a.resultGrid),a.resultGridSearch=a.region.element.querySelector(".recResultGrid mi-toolbar mi-searchbox"),Element.upgrade(a.resultGridSearch),Element.upgrade(a.region.element.querySelector("mi-tool-bar")),Element.upgrade(Array.prototype.slice.call(a.region.element.querySelectorAll("mi-filter")))}function F(a){a.resultGridSearch.searchCallback=a.searchedRecommendations.bind(a),a.resultGridSearch.addEventListener("click",a),a.resultGrid.onRowMultiSelectCB=a.allRecsSelected.bind(a),
a.resultGrid.onCellHyperlinkClickCB=a.loadRecommendationDetails.bind(a)}function G(a){a.config.isStrategicRec?a.observables.gridFilterValues.subscribe(a.gridfilterRecommendations.bind(a)):a.observables.gridFilterValues.subscribe(a.gridPerfilterRecommendations.bind(a)),a.recListCache.subscriptions(),a.observables.sortValue.subscribe(I.bind(null,a))}function H(a,b){a.observables.isControlFullyExpanded()?(b&&(a.recommendationGridData.data=[]),a.resultGrid.loadJSONData=J.bind(null,a)):a.recommendationListView.loader=a.LoadRecommendationList.bind(a)}function I(a,b){var c=!0;a.selectedSortValue===b&&(c=!1),null!==b&&c&&(a.selectedSortValue=b,a.recListCache.setSortValue(a.selectedSortValue),a.cancelListSelection=!0,H(a,!0))}z.prototype.detach=function(){this.processState.detach(),this.recListCache.detach(),this.resultGridSearch.removeEventListener("click",this),this.resultGrid.loadJSONData=null,this.recommendationListView.loader=null,this.resultGridSearch.searchCallback=null,
this.resultGrid.onRowMultiSelectCB=null,this.resultGrid.onCellHyperlinkClickCB=null,this.events.supersededActionDone.remove(this),this.events.closeSupersedeDialogBox.remove(this),this.events.supersededLoadingEvent.remove(this),this.cancelListSelection=!1,this.dialog=null,this.recommendationSupersedeViewModel=null,this.recommendationListView=null,this.resultGrid=null,this.resultGridSearch=null,this.region=null,this.recommendationGridData.data=[],this.busyIndicator.detach(),this.kom.dispose(),A.prototype.detach.apply(this,arguments)},z.prototype.handleEvent=function(a){"click"===a.type&&this.recListCache.cachedValues.search&&this.region.$element.find(".mi-searchbox").find("input").val(this.recListCache.cachedValues.search)},z.prototype.loadMoreOptions=function(){var a=c.Deferred();return a.resolve(this.observables.options()),a.promise()},z.prototype.allRecsSelected=function(b){this.selectedRecommendations=b,this.processState.processStates(a.pluck("Key")(b)),this.enableMoreOptions()},
z.prototype.loadRecommendationDetails=function(a){var b=r.toString(a.key),c=r.toString(a.stratkey),d=r.toString(a.assetkey),e=!1,f=this.recommendationGridData.data;if("strategy"===a.id)return void this.loadLinkedStrategy(d,c);"target"===a.id&&(e=!0);for(var g=0;g<f.length;g++)if(f[g].Key===b){this.events.recommendationSummaryLoadEvent.raise(f[g],this.filterValues,e);break}},z.prototype.loadLinkedStrategy=function(a,b){var c;c=this.config.isTemplate?"strategy/asm/template/"+b:"strategy/asm/strategy/"+a,this.applicationEvent.navigate.raise(c,{tab:!0})};function J(a,b,d){var e=a.recListCache.loadCachedValues(),f=d||c.Deferred(),g=b||1;return P(a),e?(a.observables.recommendationCount(e.data.length),f.resolve(e)):(a.busyIndicator.show(),
a.recommendationService.getRecommendationList_abortPrevious(a.config.parentKey,a.config.recommendationFamilyID,a.config.isStrategicRec,a.config.assetKey,a.config.perfFilterTypes,a.filterValues,a.selectedSortValue,a.searchText,g,25).always(a.busyIndicator.hide.bind(a.busyIndicator)).done(K.bind(null,a,g,f)).fail(ca.bind(null,a)),f)}function K(a,b,c,d){var e;if(a.recommendationGridData.data.length!==d.Total){for(a.recommendationGridData.data.length>d.Total&&1===b?a.recommendationGridData.data=[]:a.recommendationGridData.data.length<d.Total&&1===b&&(a.recommendationGridData.data=[]),e=0;e<d.Recommendations.length;e++)a.recommendationGridData.data.push(d.Recommendations[e]);b++,d.Recommendations.length>0?J(a,b,c):L(a,d.Total,c)}else L(a,d.Total,c)}function L(a,b,c){a.recommendationGridData.data&&a.recommendationGridData.data.length>0?(a.observables.recommendationCount(a.recommendationGridData.data.length),
a.events.recCountUpdateEvent.raise(a.recommendationGridData.data.length)):(a.observables.recommendationCount(b),a.events.recCountUpdateEvent.raise(b)),a.recListCache.resetCacheKey(),a.recListCache.resetCacheData(a.recommendationGridData.data,1,b),c.resolve(a.recommendationGridData)}function M(a){a.config.isStrategicRec?"RBI"===a.config.sourceModuleName?a.recommendationGridData.columns=[{id:"IDUrl",alias:a.translator.translate("RECOMMENDATIONS_ID"),isActionColumn:"true"},{id:"Headline",alias:a.translator.translate("RECOMMENDATIONS_HeadLine")},{id:"AssetId",alias:a.translator.translate("EQUIPMENT_ID")},{id:"strategyIDUrl",alias:a.translator.translate("STRATEGY_ID"),isActionColumn:"true"},{id:"State",alias:a.translator.translate("IMPLEMENTATION_STATE")},{id:"Interval",alias:a.translator.translate("INTERVAL")},{id:"damageMechanism",alias:a.translator.translate("DAMAGE_MECH")},{id:"taskType",alias:a.translator.translate("TASK_TYPE")},{id:"nonRecurring",
alias:a.translator.translate("NON_RECURRING")},{id:"targetCompletionDate",alias:a.translator.translate("TARGET_COMPLETION_DT")}]:a.recommendationGridData.columns=[{id:"IDUrl",alias:a.translator.translate("RECOMMENDATIONS_ID"),isActionColumn:"true"},{id:"Headline",alias:a.translator.translate("RECOMMENDATIONS_HeadLine")},{id:"AssetId",alias:a.translator.translate("EQUIPMENT_ID")},{id:"strategyIDUrl",alias:a.translator.translate("STRATEGY_ID"),isActionColumn:"true"},{id:"State",alias:a.translator.translate("IMPLEMENTATION_STATE")},{id:"Interval",alias:a.translator.translate("INTERVAL")}]:a.recommendationGridData.columns=[{id:"IDUrl",alias:a.translator.translate("RECOMMENDATIONS_ID"),isActionColumn:"true"},{id:"PerformanceRecType",alias:a.translator.translate("RECOMMENDATIONS_TYPE")},{id:"Headline",alias:a.translator.translate("RECOMMENDATIONS_HeadLine")},{id:"State",alias:a.translator.translate("STATE")},{id:"LastUpdatedDate",alias:a.translator.translate("LAST_DATE")},{id:"AuthorName",
alias:a.translator.translate("CREATED-BY")},{id:"StateAssignedUser",alias:a.translator.translate("ASSIGNED_TO_")}]}function N(a){a.config.parentKey<=0||a.recommendationService.getAllEquipmentID(a.config.parentKey,a.config.recommendationFamilyID).done(a.observables.sortOptions.bind(a.observables.sortOptions)).fail(ca.bind(null,a))}z.prototype.LoadRecommendationList=function(a,b){var d=this.recListCache.loadCachedValues(),e=c.Deferred();return P(this),d&&this.currentListPage===a?(this.observables.recommendationCount(d.length),e.resolve(d)):(this.busyIndicator.show(),this.recommendationService.getRecommendationList_abortPrevious(this.config.parentKey,this.config.recommendationFamilyID,this.config.isStrategicRec,this.config.assetKey,this.config.perfFilterTypes,this.filterValues,this.selectedSortValue,this.searchText,a,b).always(this.busyIndicator.hide.bind(this.busyIndicator)).done(O.bind(null,this,e,a)).fail(ca.bind(null,this)),e)};function O(a,b,c,d){a.currentListPage=c,
a.recListCache.resetCacheKey(),a.recListCache.resetCacheData(d,c,d.Total),a.recListCache.cachedValues.list.data&&a.recListCache.cachedValues.list.data.length===d.Total&&(a.currentListPage="1"),a.recListCache.cachedValues.list.data&&a.recListCache.cachedValues.list.data.length>0?(a.observables.recommendationCount(a.recListCache.cachedValues.list.data.length),a.events.recCountUpdateEvent.raise(a.recListCache.cachedValues.list.data.length)):(a.observables.recommendationCount(d.Total),a.events.recCountUpdateEvent.raise(d.Total)),b.resolve(d.Recommendations)}function P(a){a.cachedDataSheetEntity&&!a.config.panelCollapsed&&(a.events.recommendationSummaryLoadEvent.raise({Key:a.cachedDataSheetEntity.key.toString()},a.filterValues,!1),a.cachedDataSheetEntity=null)}z.prototype.recSelectedEvent=function(b,c){var d=c.target.value,e=c.originalEvent;if(void 0!==e){if(b.selectedRecommendations=b.recommendationListView.selectedItems,b.enableMoreOptions(),
void 0!==e.selecting)return void b.processState.processStates(a.pluck("Key")(b.recommendationListView.selectedItems));this.recommendationListView.selectedItems=[]}void 0===d||null===d||b.cancelListSelection||b.events.recommendationSummaryLoadEvent.raise(d,b.filterValues,!1),b.cancelListSelection=!1},z.prototype.consolidateRecommendations=function(){var a=[],b=this.selectedRecommendations,c=0,d;for(d=0;d<b.length;d++)a.push(b[d].Key),b[d].consolidatedRecommendationsCount>0&&c++;c>1?m.showOk(this.translator.translate("CAN_NOT_CONSOLIDATE_RECOMMENDATIONS"),this.translator.translate("ERROR"),this.RecommendationUtility.warningIcon):this.events.recConsolidateEvent.raise(a)},z.prototype.consolidateActionDone=function(a){this.recListCache.nullCacheUID(),m.showOk(a,this.translator.translate("CONSOLIDATE_RECOMMENDATION_SUCCESS"))},z.prototype.unlinkRecommendations=function(){var b=a.pluck("Key",this.selectedRecommendations);0!==b.length&&(this.busyIndicator.show(),
this.recommendationService.UnlinkRecommendations(b).always(this.busyIndicator.hide.bind(this.busyIndicator)).done(U.bind(null,this,b.length)).fail(ba.bind(null,this)))},z.prototype.performStateOperation=function(a){var b=T(this);this.recommendationService.AssignedUserRequired(this.selectedStateOperation,b).done(Q.bind(null,this,b,a)).fail(ca.bind(null,this))};function Q(a,b,c,d){d?a.stateAssignmentDialog.show(b[0],a.translator.translate("STATE_ASSIGNMENT")).done(R.bind(null,a,c)).fail(ba.bind(null,a)):a.performGenericStateOperation(b)}function R(a,b,c){var d,e,f;e=T(a);for(var g=0;g<c.length;g++)if(c[g].state.id===b.successorStateId&&null!==c[g].assignedUser){d=c[g].assignedUser.id;break}if(d)a.recommendationService.updateStateAssignments(d,b.successorStateId,e).done(S.bind(null,a,e)).fail(ba.bind(null,a));else{var h="{0} {1}".format(b.successorStateCaption,a.translator.translate("STATE_ASSIGNMENT_FAILURE"));t.error(h)}}function S(a,b){a.performGenericStateOperation(b)}function T(b){
var c=b.observables.isControlFullyExpanded()?b.selectedRecommendations:b.recommendationListView.selectedItems;return a.pluck("Key",c)}z.prototype.performGenericStateOperation=function(a){var b=a.length;this.busyIndicator.show(),this.recommendationService.PerformOperation(this.selectedStateOperation,a).always(this.busyIndicator.hide.bind(this.busyIndicator)).done(U.bind(null,this,b)).fail(ba.bind(null,this))};function U(a,b,c){a.recListCache.nullCacheUID(),H(a,!0);var d=b+" "+a.translator.translate("GENERIC_ACTION_SUCCESS");a.events.recStateChangedEvent.raise(a,d),t.success(d)}z.prototype.openSupersedeDialog=function(){var a=T(this);this.recommendationService.getRecommendations(a).done(V.bind(null,this)).fail(ca.bind(null,this,this.translator.translate("LOAD_RECOM_MSG")))};function V(a,b){var c={width:"90%",buttons:[{name:a.translator.translate("SUPERSEDE_TAB_LABEL"),value:"performSupersede",cssClass:"btn btn-primary"},{name:a.translator.translate("CANCEL"),cssClass:"btn btn-secondary"
}]};a.recommendationSupersedeViewModel?a.recommendationSupersedeViewModel.reload(b):(a.recommendationSupersedeViewModel=new k(b),a.events.supersededActionDone.add(a.SupersededActionDone,a),a.events.closeSupersedeDialogBox.add(a.dialogBoxClose,a),a.events.supersededLoadingEvent.add(X.bind(null,a),a),a.events.supersededHideLoadingEvent.add(W.bind(null,a),a)),a.dialog=new l(a.recommendationSupersedeViewModel,a.translator.translate("Supersede_Recommendations"),c),a.dialog.show()}function W(a){a.busyIndicator.hide()}function X(a){a.busyIndicator.show()}z.prototype.SupersededActionDone=function(a,b){this.recListCache.nullCacheUID(),m.showOk(b,this.translator.translate("SUPERSEDE_ACTION_SUCCESS")),H(this,!0)},z.prototype.dialogBoxClose=function(a){this.dialog.closeDialog(a),this.busyIndicator.hide(),this.cancelListSelection=!1},z.prototype.loadRecommendationDatasheet=function(a){this.config.editMode&&this.events.recommendationDatasheetEvent.raise(a)},z.prototype.enableMoreOptions=function(){
this.recMoreOptions.enableMoreOptions(this.config,this.selectedRecommendations).then(Y.bind(null,this))};function Y(b,c){if(0===b.selectedRecommendations.length)return void b.observables.disableOptions(!0);var d=a.prop("State"),e=a.compose(d,a.head),f=a.map(d),g=e(b.selectedRecommendations),h=a.compose(a.all(a.equals(g)),f)(b.selectedRecommendations);c.length>0&&h?(b.observables.disableOptions(!1),b.observables.options(c)):b.observables.disableOptions(!0),b.loadMoreOptions()}z.prototype.gridfilterRecommendations=function(a){var b=!0;null===a&&(b=!1),b&&(this.observables.gridFilterValues(a),this.filterValues=a,this.recListCache.setFilterState(this.filterValues),this.cancelListSelection=!0,H(this,!0))},z.prototype.gridPerfilterRecommendations=function(a){var b="",c="",d=null,e=!0;if(this.filterValues!==a&&null!==a||(e=!1),a&&a.length>0){d=a.split(",");for(var f=0;f<d.length;f++)"state"===d[f].split("-")[0]?b+=d[f].split("-")[1]+",":c+=d[f].split("-")[1]+","}
""!==b&&(b=b.substring(0,b.length-1)),""!==c&&(c=c.substring(0,c.length-1)),this.config.perfFilterTypes=c,e&&(this.filterValues=b,this.recListCache.setPerfFilter(this.filterValues,this.config.perfFilterTypes),H(this,!0))},z.prototype.searchedRecommendations=function(a){var b=c.Deferred();return this.recListCache.setSearch(a),this.searchText=a,this.cancelListSelection=!0,H(this,!0),b.promise()};function Z(a){a.recommendationService.getFamilyStates(a.config.recommendationFamilyID).done($.bind(null,a)).fail(ca.bind(null,a))}function $(a,b){a.observables.filterOptions(a.recFilters.loadGridFilterValues(b,a.defaultRecFilterArr,a.recListCache.cachedValues))}function _(a){var b=a.config.assetKey?a.config.assetKey:a.config.parentKey;a.recommendationService.getMultipleFamilyStates(b).done(aa.bind(null,a)).fail(ca.bind(null,a))}function aa(a,b){a.filterlist=b,a.observables.filterOptions(a.recFilters.loadPerformanceGridFilters(a.filterlist,a.defaultRecFilterArr,a.recListCache.cachedValues))}
z.prototype.minimize=function(){this.events.recMinimizeEvent.raise()},z.prototype.addItem=function(){this.loadRecommendationDatasheet("0")},z.prototype.addItemfromGrid=function(){this.loadRecommendationDatasheet("0")},z.prototype.navigateToActionManagement=function(){this.applicationEvent.navigate.raise("action-management",{tab:!0})},z.prototype.reloadData=function(a){this.recListCache.nullCacheUID(),this.cancelListSelection=!0,H(this,!0),this.processState.hideStateControl()};function ba(a,b){var c,d=a.translator.translate("STATE_OPERATION_ERROR");a.busyIndicator.hide(),c=b.responseJSON?b.responseJSON.message:b.responseText?b.responseText:d,m.showOk(c,a.translator.translate("ERROR"),a.RecommendationUtility.warningIcon)}function ca(b,c){var d;b.busyIndicator.hide(),"abort"!==c.statusText&&(d=a.is(Object,c)?c.responseJSON?c.responseJSON.message:c.responseText:c,m.showOk(d,b.translator.translate("ERROR"),b.RecommendationUtility.warningIcon))}return z.prototype.error=function(a,b){ca(a,b)
},z});
define('strategy/recommendations/shell/recommendation-shell-view-model',['require','knockout','jquery','application/application-context','system/globalization/translator','spa/ko/knockout-view-model','system/knockout/knockout-manager','text!./views/recommendation-shell.html','strategy/recommendations/details/recommendation-details-control','strategy/recommendations/list/recommendation-list-control','strategy/recommendations/consolidate/recommendation-consolidate-view-model','strategy/recommendations/services/recommendation-service','spa/region','strategy/recommendations/recommendation-utility','system/ui/message-box','strategy/recommendations/recommendation-events','spa/conductor','system/lang/object'],function(require){"use strict";var a=require("knockout"),b=require("jquery"),c=require("application/application-context"),d=require("system/globalization/translator"),e=require("spa/ko/knockout-view-model"),f=require("system/knockout/knockout-manager"),g=require("text!./views/recommendation-shell.html"),h=require("strategy/recommendations/details/recommendation-details-control"),i=require("strategy/recommendations/list/recommendation-list-control"),j=require("strategy/recommendations/consolidate/recommendation-consolidate-view-model"),k=require("strategy/recommendations/services/recommendation-service"),l=require("spa/region"),m=require("strategy/recommendations/recommendation-utility"),n=require("system/ui/message-box"),o=require("strategy/recommendations/recommendation-events"),p=require("spa/conductor");require("system/lang/object");function q(a,b){r.call(this,g),this.kom=Object.resolve(f),this.translator=Object.resolve(d),this.conductor=Object.resolve(p),
this.events=Object.resolve(o),this.RecommendationUtility=Object.resolve(m),this.recommendationService=Object.resolve(k),this.minimized=this.kom.observable(!0),this.currentRecommendation=null,this.riskName=b,this.unmitigatedRiskAssessment=a,this.recommendationFamilyKey=0,this.recRegion=null,this.isControlFullyExpanded=!1,this.loadTargetRecommendation=!1,this.isListView=!0,this.recommendationDetailControl=null,this.recEntityloader=null,this.cachedValues=null,this.cachedDataSheetEntity=null,this.consolidateSuccessText=null,this.config=null,this.recommendationListControl=null,this.recommendationConsolidateViewModel=null}var r=Object.inherit(e,q);q.prototype.load=function(){this.allowCopy=!1},q.prototype.attach=function(a){r.prototype.attach.call(this,a),this.recRegion=new l;var b=a.element.querySelector(".strategy-recommendation-details");this.recRegion.setElement(b),this.events.reloadRiskAssessment.add(z.bind(null,this),this),this.loadUserPermissions(),this.loadRecommendationFamilyKey()},
q.prototype.detach=function(a){this.recommendationListControl=null,this.recommendationDetailControl=null,this.recommendationConsolidateViewModel=null,this.events.recommendationDatasheetEvent.remove(this),this.events.recommendationSummaryLoadEvent.remove(this),this.events.recMinimizeEvent.remove(this),this.events.recCountUpdateEvent.remove(this),this.events.recConsolidateEvent.remove(this),this.events.cachedValuesEvent.remove(this),this.events.consolidateActionEvent.remove(this),this.events.recDataSheetSavedEvent.remove(this),this.events.loadRecommendationListEvent.remove(this),this.events.detailsLoadRecommendationList.remove(this),this.events.reloadRiskAssessment.remove(this),this.events.cachedClearList.remove(this),r.prototype.detach.call(this,a)},q.prototype.unload=function(){this.kom.dispose()},q.prototype.loadUserPermissions=function(){this.recommendationService.GetSecurityConfiguration(this.config.recommendationFamilyID).done(s.bind(null,this)).fail(t.bind(null,this))}
;function s(a,b){a.config.userPermission.canCreateRecommendation=u(b.canCreateRecommendation,!0),a.config.userPermission.canEditRecommendation=u(b.canEditRecommendation,!0),a.config.userPermission.canDeleteRecommendation=u(b.canDeleteRecommendation,!0),a.config.userPermission.canConsolidateRecommendation=u(b.canConsolidateRecommendation,!0),a.config.userPermission.canSupersedeRecommendation=u(b.canSupersedeRecommendation,!0)}function t(a,b){n.showOk(b,a.translator.translate("ERROR"),a.RecommendationUtility.warningIcon)}function u(a,b){return"true"===a||"false"!==a&&(a!==!0&&a!==!1?b:a)}q.prototype.maximize=function(){this.minimized(!1),this.config.minimized=!1,this.minimizeChanged(!1),b(window).trigger("resize")},q.prototype.loadRecommendationFamilyKey=function(){
0===this.recommendationFamilyKey?this.recommendationService.getFamilyKey(this.config.recommendationFamilyID).done(v.bind(null,this)).fail(w.bind(null,this)):this.config.defaultRecDataSheetload?(this.createNewRecommendation("0"),this.events.defaultRecDatasheetEvent.raise()):this.loadRecommendationListControl()};function v(a,b){a.config.recommendationFamilyKey=b,a.config.defaultRecDataSheetload?(a.createNewRecommendation("0"),a.events.defaultRecDatasheetEvent.raise()):a.loadRecommendationListControl()}function w(a,b){n.showOk(a.translator.translate("KEY_FAILURE_MSG"),a.translator.translate("ERROR"),a.RecommendationUtility.warningIcon)}q.prototype.minimize=function(){this.minimized(!0),this.config.minimized=!0,this.minimizeChanged(!0),b(window).trigger("resize")},q.prototype.minimizeChanged=function(a){this.events.minChanged.raise(a)},q.prototype.canUnload=function(){return this.conductor.canUnloadScreen(this.recRegion.screen)},q.prototype.loadRecommendationListControl=function(){
this.isListView=!0,this.recommendationListControl?this.recommendationListControl.reload(this.config,this.isControlFullyExpanded,this.cachedValues,this.consolidateSuccessText):(this.recommendationListControl=new i(this.conductor,this.config,this.isControlFullyExpanded,this.cachedValues,this.consolidateSuccessText),this.events.recommendationSummaryLoadEvent.add(y,this),this.events.recommendationDatasheetEvent.add(this.createNewRecommendation,this),this.events.recMinimizeEvent.add(this.minimize,this),this.events.recConsolidateEvent.add(this.consolidateRecommendations,this),this.events.cachedValuesEvent.add(this.getCachedValuesEvent,this),this.events.cachedClearList.add(this.clearListCache,this),this.events.loadRecommendationListEvent.add(this.loadRecommendationList,this)),this.cachedDataSheetEntity&&(this.recommendationListControl.cachedDataSheetEntity=this.cachedDataSheetEntity),this.consolidateSuccessText=null,this.conductor.changeScreen(this.recommendationListControl,this.recRegion,{
positional:[this]},!1)},q.prototype.getCachedValuesEvent=function(a){0!==Object.keys(a).length&&(this.cachedValues=a)},q.prototype.clearListCache=function(){this.cachedValues&&this.cachedValues.hasOwnProperty("list")&&(this.cachedValues.list.uid=null)},q.prototype.consolidateRecommendations=function(a){this.isListView=!1,this.recommendationConsolidateViewModel?this.recommendationConsolidateViewModel=new j(a,this.config):(this.recommendationConsolidateViewModel=new j(a,this.config),this.events.consolidateActionEvent.add(this.consolidateActionDone,this)),this.conductor.changeScreen(this.recommendationConsolidateViewModel,this.recRegion,{positional:[this]},!1)},q.prototype.consolidateActionDone=function(a){this.consolidateSuccessText=a,this.loadRecommendationListControl()},q.prototype.createNewRecommendation=function(a){var b={Key:a};if(null!==this.recEntityloader&&void 0!==this.recEntityloader){this.recEntityloader(a).done(x.bind(null,this,b))}else this.currentRecommendation=b,
this.loadRecommendationDetailControl()};function x(a,b,c){b.Entity=c,a.currentRecommendation=b,a.loadRecommendationDetailControl()}function y(a,b,c){this.config.selectedFilters=b,this.currentRecommendation=a,this.loadTargetRecommendation=c,this.loadRecommendationDetailControl()}q.prototype.loadRecommendationDetailControl=function(){this.isListView=!1,this.events.setDatasheetViewEvent.raise(),this.recommendationDetailControl||(this.events.recDataSheetSavedEvent.add(this.recDatasheetSaved,this),this.events.detailsLoadRecommendationList.add(this.loadRecommendationList,this)),this.recommendationDetailControl=new h(this.currentRecommendation,this.unmitigatedRiskAssessment,this.unmititgatedRiskName(),this.config),this.cachedDataSheetEntity&&(this.recommendationDetailControl.cachedDataSheetEntity=this.cachedDataSheetEntity,this.cachedDataSheetEntity=null),this.conductor.changeScreen(this.recommendationDetailControl,this.recRegion,{positional:[this]},!1)};function z(a,b){
a.unmitigatedRiskAssessment=b}return q.prototype.recDatasheetSaved=function(a){this.config.defaultRecDataSheetload&&(this.config.defaultRecDataSheetload=!1)},q.prototype.loadRecommendationList=function(a){this.events.resetDatasheetEvent.raise(),this.config.newRecommendationID=a,this.loadRecommendationListControl()},q.prototype.removeBindings=function(b){b=b.replace("#",""),a.cleanNode(document.getElementById(b)),document.getElementById(b).innerHTML=""},q.prototype.unmititgatedRiskName=function(){var a;return this.config.sourceModuleName&&(""===this.riskName||"RCM"!==this.config.sourceModuleName&&"FMEA"!==this.config.sourceModuleName||""!==this.riskName&&(a=this.riskName)),a},q.prototype.switchDisplay=function(a){this.isControlFullyExpanded=a,this.isListView&&this.loadRecommendationListControl()},q.prototype.changeUnmitigatedRiskName=function(a){this.riskName=a,this.isListView||this.recommendationDetailControl&&this.recommendationDetailControl.changeUnmitigatedRiskName(a)},
q.prototype.changeUnmitigatedAssessment=function(a){this.unmitigatedRiskAssessment=a,this.isListView||this.recommendationDetailControl&&this.recommendationDetailControl.changeUnmitigatedAssessment(a)},q.prototype.setModuleHelpContext=function(){this.config.moduleHelpContext&&(c.help.helpContext=this.config.moduleHelpContext)},q});
define('strategy/recommendations/models/recommendations-config-dto',[],function(){"use strict";function a(a){a=a||{},this.autoExpand=a.autoExpand===!0,this.minimize=a.minimize,this.recommendationFamilyID=a.recommendationFamilyID,this.parentKey=a.parentKey||-1,this.parentRelationshipID=a.parentRelationshipID,this.parentID=a.parentID,this.analysisKey=a.analysisKey,this.analysisID=a.analysisID,this.analysisRelationshipID=a.analysisRelationshipID,this.analysisType=a.analysisType,this.assetKey=a.assetKey,this.assetID=a.assetID,this.assetRelationshipID=a.assetRelationshipID,this.riskAssessmentRelationshipID=a.riskAssessmentRelationshipID,this.editMode=a.editMode===!0,this.readOnly=void 0===a.readOnly||null===a.readOnly||a.readOnly===!0,this.autoCreateMitigatedRisk=a.autoCreateMitigatedRisk===!0,this.userPermission={canCreateRecommendation:a.userPermission.canCreateRecommendation===!0,canDeleteRecommendation:a.userPermission.canDeleteRecommendation===!0,canEditRecommendation:a.userPermission.canEditRecommendation===!0,
canSaveAsTemplate:a.userPermission.canSaveAsTemplate===!0,canCopyPaste:a.userPermission.canCopyPaste===!0},this.isAnalysisLevel=a.isAnalysisLevel===!0,this.archivedRecStates=a.archivedRecStates,this.newRecommendationID=a.newRecommendationID,this.allowAdd=a.allowAdd===!0,this.allowCopy=a.allowCopy===!0,this.allowDelete=void 0===a.allowDelete||a.allowDelete===!0,this.sourceModuleName=a.sourceModuleName,this.defaultRecDataSheetload=a.defaultRecDataSheetload===!0,this.defaultRecFilterSelectedValues=a.defaultRecFilterSelectedValues,this.recDataSheetDefaultValues=a.recDataSheetDefaultValues,this.moduleHelpContext=a.moduleHelpContext,this.perfFilterTypes=a.perfFilterTypes,this.unmitigatedriskassessment=a.unmitigatedriskassessment,this.unmititgatedriskname=a.unmititgatedriskname,this.isStrategicRec=void 0===a.isStrategicRec||null===a.isStrategicRec||a.isStrategicRec===!0,this.isTemplate=a.isTemplate===!0,this.recommendationFamilyKey=a.recommendationFamilyKey,
this.selectedFilters=a.selectedFilters,this.performanceFilterStates=a.performanceFilterStates,this.linkRec=a.linkRec===!0,this.setAssetFun=a.setAssetFun===!0,this.setLinkAnalysis=a.setLinkAnalysis===!0,this.setLinkMode=a.setLinkMode===!0,this.isTemplateRec=a.isTemplateRec===!0,this.panelCollapsed=a.panelCollapsed===!0,this.siteKey={override:!(!b(a)||a.siteKey.override!==!0)&&a.siteKey.override,key:b(a)?a.siteKey.key:null,showSiteSelector:!!b(a)&&a.siteKey.showSiteSelector,disableSiteSelector:!b(a)||a.siteKey.disableSiteSelector}}function b(a){return a.hasOwnProperty("siteKey")}return a});

define('text!ui/elements/slide-panel-right/right-sidePanel-control.html',[],function () { return '<div class="slide-tab" style="visibility: visible"><i class="icon-expand"></i></div>\r\n<div class="sliderPanel slide-content" style=""></div>';});

define('ui/elements/slide-panel-right/right-sidePanel-control',['require','jquery','text!./right-sidePanel-control.html','system/globalization/translator','system/lang/event'],function(require){"use strict";var a=require("jquery"),b=require("text!./right-sidePanel-control.html"),c=require("system/globalization/translator"),d=require("system/lang/event"),e=Object.create(HTMLElement.prototype);e.minimumWidth,e.maximumWidth,e.limitingElement,e.setNewWidth,e.minWidth=function(a){return a?(this.minimumWidth=a,!0):this.minimumWidth},e.maxWidth=function(a){return a?(this.maximumWidth=a,!0):this.maximumWidth},e.limitElement=function(a){return a?(this.limitingElement=a,this.limitingElement):this.limitingElement},e.createdCallback=function(){var b=this;this.state="closed",this.tonguePosition=0,this.backdrop=this.getAttribute("backdrop")?this.getAttribute("backdrop"):"true",this.icon=this.getAttribute("icon")?this.getAttribute("icon"):"icon-view-recommendation",this.iconExpand=this.getAttribute("icon-expand")?this.getAttribute("icon-expand"):"icon-expand",this.hideMaxButton=this.getAttribute("hidemaxbutton")?this.getAttribute("hidemaxbutton"):"false",
this.slideTabTitle=this.getAttribute("slide-tab-title")?this.getAttribute("slide-tab-title"):"",h(this),this.slideWidthChangedEvent=new d,this.slideWidthHalfEvent=new d,this.slideWidthZeroEvent=new d,this.translator=Object.resolve(c);var e='<div class="slide-tab" title="'+this.slideTabTitle+'" style="visibility: visible"><div class="notificationCount"></div><i class="'+this.icon+' collapsed"></i></div>';a(this).wrapInner('<div class="sliderPanel slide-content"></div>'),a(this).prepend(e),a(this).append('<button class="btn btn-icon expand-button"><i class="icon-move"></i></button>'),"false"!==this.backdrop.toLowerCase()&&a(this).append('<div class="slide-panel-opacity"></div>'),this.classList.add("slide-container"),this.handle=a(this).find("div.slide-tab"),this.slideContent=a(this).find("div.slide-content"),this.slidePanelOpacity=a(this).find("div.slide-panel-opacity"),this.maxButton=a(this).find("button.expand-button"),this._windowResize=this.windowResize.bind(this),
this._handleClick=this.handleClick.bind(this),this._maxButtonClick=this.maxButtonClick.bind(this),this._closePanel=this.closePanel.bind(this),a(this).attr("state",this.state)},e.attachedCallback=function(){f(this),this.positionSelf(),i(this)};function f(b){a(window).on("resize",b._windowResize),b.handle.on("click",b._handleClick),b.maxButton.on("click",b._maxButtonClick),b.slidePanelOpacity.on("click",b._closePanel)}e.detachedCallback=function(){g(this)};function g(b){a(window).off("resize",b._windowResize),b.handle.off("click",b._handleClick),b.maxButton.off("click",b._maxButtonClick),b.slidePanelOpacity.off("click",b._closePanel)}e.attributeChangedCallback=function(b,c,d){var e=window.innerWidth,f=.332*e,g=f+"px",j=a(this);"sliderenable"===b&&(this.sliderenable=d,"true"===this.sliderenable?(j.find("div.slide-tab").show(),j.find("div.sliderPanel").width(g),j.find("div.sliderPanel").css("float","right")):(j.find("div.slide-tab").hide(),j.find("div.sliderPanel").width("100%"),
j.find("div.sliderPanel").css("float","left"))),"notification-count"===b&&(d?(j.find("div.notificationCount").text(d),j.find("div.notificationCount")[0].style.display="inline"):(j.find("div.notificationCount").text(""),j.find("div.notificationCount")[0].style.display="none")),"backdrop"===b&&("false"===d.toLowerCase()?j.find("div.slide-panel-opacity").hide():j.find("div.slide-panel-opacity").show()),"hidemaxbutton"===b&&(this.hideMaxButton=d.toString(),"true"===this.hideMaxButton?j.maxButton.hide():j.maxButton.show()),"disabled"===b&&(h(this),i(this)),"slide-tab-title"===b&&j.find("div.slide-tab").prop("title",d)},e.windowResize=function(){"half-open"===this.state?this.openHalf():"full-open"===this.state&&this.maximize()},e.handleClick=function(){this.isPanelDisabled||("closed"===this.state?this.openHalf():"half-open"!==this.state&&"full-open"!==this.state||this.closePanel())},e.maxButtonClick=function(){"full-open"===this.state?this.openHalf():this.maximize()},
e.positionSelf=function(){var b=this.getPredecessorCount();a(this).find("div.slide-tab").css("top",60*b+10)},e.getPredecessorCount=function(){return a("mi-slidepanelright").index(this)},e.maximize=function(){a(this).find(".expand-button").attr("title",this.translator.translate("RECOMMENDATIONS_OPEN_HALF")),this.style.width=window.innerWidth-80+"px",this.slideWidthChangedEvent.raise(a(this).width()),this.state="full-open",a(this).attr("state",this.state)},e.openHalf=function(){a(this).find(".expand-button").attr("title",this.translator.translate("RECOMMENDATIONS_OPEN_FULL")),a("mi-slidepanelright").not(this).hide(),this.slidePanelOpacity.show(),"false"===this.hideMaxButton&&this.maxButton.show(),this.style.width=window.innerWidth/2+"px",this.style.height="calc(100% - 80px)","closed"===this.state&&(this.tonguePosition=this.handle.css("top"),this.handle.css("top","10px")),a(this).find(".icon-settings").removeClass(this.icon).addClass(this.iconExpand),
this.slideWidthHalfEvent.raise(a(this).width()),this.state="half-open",a(this).attr("state",this.state)},e.closePanel=function(){a("mi-slidepanelright").show(),this.slidePanelOpacity.hide(),this.maxButton.hide(),this.style.width="30px",this.style.height="0px",this.handle.css("top",this.tonguePosition),a(this).find(".icon-expand").removeClass(this.iconExpand).addClass(this.icon),this.slideWidthZeroEvent.raise(a(this).width()),this.state="closed",a(this).attr("state",this.state)};function h(a){a.isPanelDisabled=a.hasAttribute("disabled"),a.isPanelDisabled&&a.getAttribute("disabled")&&"false"===a.getAttribute("disabled").toLowerCase()&&(a.isPanelDisabled=!1)}function i(b){b.isPanelDisabled?a(b).addClass("slidepanel-disabled"):a(b).removeClass("slidepanel-disabled")}return document.registerElement("mi-slidepanelright",{prototype:e})});
define('strategy/recommendations/recommendation-control',['require','lodash','jquery','text!./views/recommendation-control.html','spa/region','strategy/recommendations/recommendation-events','strategy/recommendations/shell/recommendation-shell-view-model','mi-assert','system/ui/unsaved-changes-message-box','strategy/recommendations/models/recommendations-config-dto','spa/conductor','ui/elements/slide-panel-right/right-sidePanel-control'],function(require){"use strict";var a=require("lodash"),b=require("jquery"),c=require("text!./views/recommendation-control.html"),d=require("spa/region"),e=require("strategy/recommendations/recommendation-events"),f=require("strategy/recommendations/shell/recommendation-shell-view-model"),g=require("mi-assert"),h=require("system/ui/unsaved-changes-message-box"),i=require("strategy/recommendations/models/recommendations-config-dto"),j=require("spa/conductor");require("ui/elements/slide-panel-right/right-sidePanel-control");var k=Object.create(HTMLElement.prototype);k.createdCallback=function(){this.element=this,this.conductor=Object.resolve(j),this.events=Object.resolve(e),this.unmitigatedriskassessment=null,this.unmititgatedriskname=null,this.config=null,this.region=null,this.setReload=!1,this.rightPanelControl=null,this.rightPanelState=null,this.recommendationShellModel=null,this.isControlFullyExpanded=!1,this.recEntityloader=null,this.recDataSheetView=!1,this.cachedState=null,
this.cachedDataSheetEntity=null,this.listLoaded=!1,q(this)},k.attachedCallback=function(){this.element.innerHTML=c,this.rightPanelControl=this.element.querySelector("mi-slidepanelright"),Element.upgrade(this.rightPanelControl),this.rightPanelControl.slideWidthChangedEvent.add(this.onSlideWidthChanged,this),this.rightPanelControl.slideWidthZeroEvent.add(this.onSlideWidthZero,this),this.rightPanelControl.slideWidthHalfEvent.add(this.onSlideWidthHalf,this),this.region=new d;var a=this.element.querySelector(".recommendation-placeholder");this.region.setElement(a),this.events.panelFullWidth.add(l.bind(null,this),this),this.events.panelHalfWidth.add(m.bind(null,this),this),r(this)};function l(a){a.rightPanelControl.maximize()}function m(a){a.rightPanelControl.openHalf()}k.attributeChangedCallback=function(a,b,c){"disabled"===a&&(q(this),r(this))},k.detachedCallback=function(){this.rightPanelControl.slideWidthChangedEvent.remove(this),this.rightPanelControl.slideWidthZeroEvent.remove(this),
this.rightPanelControl.slideWidthHalfEvent.remove(this),this.events.defaultRecDatasheetEvent.remove(this),this.events.recSizeChangedEvent.remove(this),this.events.copiedSelectedRecEvent.remove(this),this.events.minChanged.remove(this),this.events.copyRecEvent.remove(this),this.events.resetDatasheetEvent.remove(this),this.events.setDatasheetViewEvent.remove(this),this.events.panelFullWidth.remove(this),this.events.panelHalfWidth.remove(this),this.recommendationShellModel&&this.recommendationShellModel.recommendationListControl&&(this.recommendationShellModel.recommendationListControl.recListCache.cachedFilterObservableSubscription.dispose(),this.recommendationShellModel.recommendationListControl.recListCache.cachedFilterObservable=null,this.recommendationShellModel.recommendationListControl.moreoptions=null,this.recommendationShellModel.recommendationListControl.gridmoreoptions=null),p(this),this.conductor.detachScreen(this.region),this.region=null,this.rightPanelControl=null},
k.onSlideWidthZero=function(){var a=!1;this.config&&(this.config.panelCollapsed=!0),this.recommendationShellModel&&this.recommendationShellModel.setModuleHelpContext(),this.isControlFullyExpanded&&(this.isControlFullyExpanded=!1,a=!0),a&&this.switchDisplay(),this.listLoaded=!1},k.onSlideWidthHalf=function(){this.isControlFullyExpanded=!1,this.config&&(this.config.panelCollapsed=!1),this.cachedState&&this.cachedState.cachedDataSheetEntity&&(this.recommendationShellModel.cachedDataSheetEntity=this.cachedState.cachedDataSheetEntity,this.cachedState=null),this.recDataSheetView?this.switchDisplay():this.listLoaded||(this.switchDisplay(),this.listLoaded=!0)},k.onSlideWidthChanged=function(a){var c=!1,d;d=a/b(window).width()*100,this.isControlFullyExpanded?d<50&&(this.isControlFullyExpanded=!1,c=!0):d>=50&&(this.isControlFullyExpanded=!0,this.listLoaded=!1,c=!0),c&&this.switchDisplay()},k.oRecDatasheetLoadedEvent=function a(){this.oSetDatasheetView(),this.rightPanelControl.openHalf(),
this.config.defaultRecDataSheetload&&(this.config.defaultRecDataSheetload=!1)},k.oSetDatasheetView=function a(){this.recDataSheetView=!0},k.oResetDataSheetView=function a(){this.recDataSheetView=!1};function n(a,b){b?a.rightPanelControl.setAttribute("sliderenable","false"):a.rightPanelControl.setAttribute("sliderenable","true"),a.events.recSizeChangedEvent.raise(b)}k.load=function(a){a&&(this.rightPanelState=this.rightPanelControl?this.rightPanelControl.state:"closed",this.config=new i(a),this.config.panelCollapsed="closed"!==this.rightPanelState,this.unmitigatedriskassessment=a.hasOwnProperty("unmitigatedriskassessment")&&a.unmitigatedriskassessment?a.unmitigatedriskassessment:{},this.unmititgatedriskname=a.hasOwnProperty("unmititgatedriskname")&&a.unmititgatedriskname?a.unmititgatedriskname:""),o(this)&&(this.recommendationShellModel?(this.recommendationShellModel.unmitigatedRiskAssessment=this.unmitigatedriskassessment,
this.recommendationShellModel.riskName=this.unmititgatedriskname,this.recommendationShellModel.recommendationFamilyKey=0):(this.recommendationShellModel=new f(this.unmitigatedriskassessment,this.unmititgatedriskname),this.events.minChanged.add(n,this),this.events.defaultRecDatasheetEvent.add(this.oRecDatasheetLoadedEvent,this),this.events.copyRecEvent.add(this.copiedSelectedRec,this),this.events.resetDatasheetEvent.add(this.oResetDataSheetView,this),this.events.setDatasheetViewEvent.add(this.oSetDatasheetView,this)),this.recEntityloader&&(this.recommendationShellModel.recEntityloader=this.recEntityloader),this.recommendationShellModel.config=this.config,this.conductor.changeScreen(this.recommendationShellModel,this.region,{positional:[this]},!1))},k.reload=function(b){this.recommendationShellModel&&(this.setReload=!0,this.config=a.extend({},this.config,b),this.load(this.config))},k.copiedSelectedRec=function a(b){this.events.copiedSelectedRecEvent.raise(b)};function o(a){
return a.setReload&&(a.config.panelCollapsed=!1,a.setReload=!1),null!==a.unmitigatedriskassessment&&null!==a.unmititgatedriskname&&null!==a.rightPanelControl&&""!==a.config&&null!==a.config.panelCollapsed&&void 0!==a.config.panelCollapsed&&a.config.panelCollapsed!==!0}k.switchDisplay=function(){this.recommendationShellModel?this.recommendationShellModel.switchDisplay(this.isControlFullyExpanded):this.load()},k.updateunMitigatedRiskName=function(a){this.unmititgatedriskname=a,this.recommendationShellModel&&this.recommendationShellModel.changeUnmitigatedRiskName(a)},k.updateunUnmitigatedAssessment=function(a){this.unmitigatedriskassessment=JSON.parse(a),this.recommendationShellModel&&this.recommendationShellModel.changeUnmitigatedAssessment(this.unmitigatedriskassessment)},k.loadState=function(a){a&&(this.cachedState=a,this.load(a.config))},k.getState=function(){return this.cachedState?this.cachedState:{config:this.config,cachedDataSheetEntity:this.cachedDataSheetEntity}},
k.canUnload=function(){p(this);var a=this.getState(),c=b.Deferred();return a.cachedDataSheetEntity?h.show():(c.resolve(!0),c)},k.isDirty=function(){return p(this),null!==this.getState().cachedDataSheetEntity};function p(a){a.recommendationShellModel&&a.recommendationShellModel.recommendationDetailControl&&(a.cachedDataSheetEntity=a.recommendationShellModel.recommendationDetailControl.getDataSheetState())}function q(a){a.isControlDisabled=a.hasAttribute("disabled"),a.isControlDisabled&&a.getAttribute("disabled")&&"false"===a.getAttribute("disabled").toLowerCase()&&(a.isControlDisabled=!1)}function r(a){a.isControlDisabled?a.rightPanelControl.setAttribute("disabled",""):a.rightPanelControl.removeAttribute("disabled")}return document.registerElement("mi-recommendation",{prototype:k}),k});
define('shell/application-menu-view-model',["require","exports","jquery","system/knockout/knockout-manager","spa/knockout/knockout-view-model","application/application-events","system/globalization/translator","spa/conductor","spa/region","application/application-context","./services/shell-service","system/lang/ioc","system/lang/object","help/view-models/help-opener","system/hardware/device","system/mobile/device-connectivity","text!./views/application-menu.html","search/search-screen","record-manager-v2/add-record-screen","shell/login-view-model","security/model/login-manager","strategy/recommendations/recommendation-control","logging/feedback-component/feedback-component"],function(require,exports,a,b,c,d,e,f,g,h,i,j,k,l,m,n){"use strict";var o=require("search/search-screen"),p=require("record-manager-v2/add-record-screen"),q=require("shell/login-view-model"),r=require("security/model/login-manager"),s=require("text!./views/application-menu.html"),t=require("logging/feedback-component/feedback-component"),u=window
;require("strategy/recommendations/recommendation-control");var v=function(b){__extends(c,b);function c(a,c,d){var f=b.call(this,s)||this;return f.kom=a,f.appEvents=c,f.translator=k.resolve(e),f.searchScreenModel=k.resolve(o),f.searchScreenRegion=null,f.conductor=d,f.isSearchVisible=a.observable(!1),f.hideSearch=!1,f.searchInput=null,f.addRecordScreenModel=k.resolve(p),f.addRecordScreenRegion=null,f.addRecordInput=null,f.isAddRecordVisible=a.observable(!1),f.hideAddRecord=!1,f.isLoginVisible=a.observable(!1),f.loginManager=k.resolve(r),f.loginDialog=null,f.isThemeSettingsVisible=a.observable(!1),f.hideThemeSettings=!1,f.shellService=k.resolve(i),f.IsCompactView=a.observable(!1),f.device=k.resolve(m),f.deviceConnectivity=k.resolve(n),f.IsDisableNetwork=f.deviceConnectivity.getManualOfflineStatus(),f.hasPredixSDKInstalled=h.hasPredixSDKInstalled(),f.IsDeviceMobile=f.device.isMobile(),f}return c.prototype.deactivate=function(){this.kom.dispose()},c.prototype.user=function(){return h.user
},c.prototype.attach=function(c){b.prototype.attach.call(this,c),this.appEvents.windowClicked.add(this.closeSearch,this),this.appEvents.windowClicked.add(this.closeAddRecord,this),this.appEvents.offlineSessionExpired.add(this.enableManualLogin,this),this.appEvents.windowClicked.add(this.closeThemeSettings,this),this.searchScreenRegion=new g(a("div.search-overlay")),this.conductor.changeScreen(this.searchScreenModel,this.searchScreenRegion),this.searchInput=a("nav.app div.search-overlay input"),this.addRecordScreenRegion=new g(a("div.add-record-overlay")),this.conductor.changeScreen(this.addRecordScreenModel,this.addRecordScreenRegion),this.addRecordInput=a("nav.app div.add-record-overlay input"),this.preventSearchClose(),this.preventAddRecordClose(),this.preventThemeSettingsClose(),this.getUserPref(),this.IsCompactViewChecked.bind(null,this),this.IsDisableNetworkChecked.bind(null,this)},c.prototype.toggleSearch=function(){this.isSearchVisible(!this.isSearchVisible()),
this.isSearchVisible()===!0&&this.searchInput&&(this.isAddRecordVisible(!1),this.isThemeSettingsVisible(!1),this.searchInput.focus())},c.prototype.toggleAddRecord=function(){this.isAddRecordVisible(!this.isAddRecordVisible()),this.isAddRecordVisible()===!0&&this.addRecordInput&&(this.isSearchVisible(!1),this.isThemeSettingsVisible(!1),this.addRecordInput.focus())},c.prototype.openLogin=function(){this.loginDialog=new q,this.loginDialog.show().done(this.login.bind(null,this))},c.prototype.toggleThemeSettings=function(){this.isThemeSettingsVisible(!this.isThemeSettingsVisible()),this.isThemeSettingsVisible()===!0&&(this.isAddRecordVisible(!1),this.isSearchVisible(!1))},c.prototype.closeSearch=function(){this.isSearchVisible()===!0&&this.hideSearch===!0&&this.toggleSearch()},c.prototype.closeAddRecord=function(){this.isAddRecordVisible()===!0&&this.hideAddRecord===!0&&this.toggleAddRecord()},c.prototype.closeThemeSettings=function(){
this.isThemeSettingsVisible()===!0&&this.hideThemeSettings===!0&&this.toggleThemeSettings()},c.prototype.preventSearchClose=function(){var b=a("nav.app div.search-overlay, nav.app a.search-icon"),c=a("nav.app div.search-overlay");b.on("touchstart",this,this.onSearchTouchStart),b.on("mouseover",this,this.onSearchMouseOver),b.on("mouseleave",this,this.onSearchMouseLeave),c.on("click",this,this.onSearchOverlayClick),c.on("mouseleave","mi-select",this,this.onSearchOverlaySelectMouseLeave)},c.prototype.preventThemeSettingsClose=function(){var b=a("nav.app div.themeSettings-overlay, nav.app a.search-icon"),c=a("nav.app div.themeSettings-overlay");b.on("touchstart",this,this.onThemeSettingsTouchStart),b.on("mouseover",this,this.onThemeSettingsMouseOver),b.on("mouseleave",this,this.onThemeSettingsMouseLeave),c.on("click",this,this.onThemeSettingsOverlayClick)},c.prototype.preventAddRecordClose=function(){
var b=a("nav.app div.add-record-overlay, nav.app a.add-record-icon"),c=a("nav.app div.add-record-overlay");b.on("touchstart",this,this.onAddRecordTouchStart),b.on("mouseover",this,this.onAddRecordMouseOver),b.on("mouseleave",this,this.onAddRecordMouseLeave),c.on("click",this,this.onAddRecordOverlayClick)},c.prototype.openHelp=function(){(new l).open(),this.isSearchVisible(!1),this.isAddRecordVisible(!1),this.isThemeSettingsVisible(!1)},c.prototype.enableManualLogin=function(){this.isLoginVisible(!0)},c.prototype.IsCompactViewChecked=function(){a(".themeSettings-overlay").find("mi-checkbox input:checkbox").is(":checked")?(a(".dx-datagrid, body").addClass("tight"),this.setUserPref("theme-tight"),this.handleLayoutChanged()):(a(".dx-datagrid, body").removeClass("tight"),this.setUserPref("theme-spacious"),this.handleLayoutChanged())},c.prototype.IsDisableNetworkChecked=function(){this.deviceConnectivity.setManualOfflineStatus(this.IsDisableNetwork=!this.IsDisableNetwork)},
c.prototype.handleLayoutChanged=function(){this.appEvents&&this.appEvents.layoutChanged&&this.appEvents.layoutChanged.raise(this)},c.prototype.setUserPref=function(a){var b={userKey:this.user().key,name:"user-theme",prefType:8,value:a};this.shellService.setPreference(b)},c.prototype.getUserPref=function(){var b=this;this.shellService.getPreference(this.user().key,"user-theme").done(function(c){c&&"theme-tight"===c.value?(a(".dx-datagrid, body").addClass("tight"),b.IsCompactView(!0)):(a(".dx-datagrid, body").removeClass("tight"),b.IsCompactView(!1))})},c.prototype.login=function(a){if(0===a){this.isLoginVisible(!1);var b=this.loginDialog.password();this.signin(b).then(this.initSession.bind(null,this)).then(this.loadUser.bind(null,this))}},c.prototype.signin=function(a){var b=h.session.datasourceId,c=h.session.userId;return this.loginManager.login(b,c,a)},c.prototype.initSession=function(a){var b=this.getApiServer();return a=this.loginManager.overrideApiServer(a,b),
this.loginManager.setContextSession(a),this.loginManager.saveSession(a),this.loginManager.registerAjaxClientWithSession(a),this.loginManager.setLocalStorageUserDataSourceApiServer(a,b),a},c.prototype.getApiServer=function(){return h.session.apiServer},c.prototype.loadUser=function(a){this.loginManager.saveUserCulture(a),this.loginManager.getUser().catch(this.loginManager.onFailedUserLoad).then(this.loginManager.checkIfPasswordHasToChange.bind(this.loginManager)).then(this.loginManager.setContextUser).then(this.loginManager.registerAjaxClientWithUser)},c.prototype.onSearchTouchStart=function(a){a.data.hideSearch=!1,a.data.hideAddRecord=!0,a.data.hideThemeSettings=!0},c.prototype.onSearchMouseOver=function(a){a.data.hideSearch=!1},c.prototype.onSearchMouseLeave=function(a){a.data.hideSearch=!0},c.prototype.onSearchOverlayClick=function(a){a.data.hideSearch=!1,"A"!==a.target.tagName&&"BUTTON"!==a.target.tagName||!a.target.hasAttribute("target")||(a.data.hideSearch=!0)},
c.prototype.onSearchOverlaySelectMouseLeave=function(a){a.stopPropagation(),a.data.hideSearch=!1},c.prototype.onAddRecordTouchStart=function(a){a.data.hideSearch=!0,a.data.hideAddRecord=!1},c.prototype.onThemeSettingsTouchStart=function(a){a.data.hideSearch=!0,a.data.hideAddRecord=!0,a.data.hideThemeSettings=!1},c.prototype.onAddRecordMouseOver=function(a){a.data.hideAddRecord=!1},c.prototype.onThemeSettingsMouseOver=function(a){a.data.hideThemeSettings=!1},c.prototype.onAddRecordMouseLeave=function(a){a.data.hideAddRecord=!0},c.prototype.onThemeSettingsMouseLeave=function(a){a.data.hideThemeSettings=!0},c.prototype.onAddRecordOverlayClick=function(a){"A"===a.target.tagName&&(a.data.hideAddRecord=!0)},c.prototype.onThemeSettingsOverlayClick=function(a){"A"===a.target.tagName&&(a.data.hideThemeSettings=!0)},c.prototype.clearOfflinePin=function(){
this.clearOfflineCredential().then(this.toastSuccessMessage.bind(this,this.translator.translate("OFFLINE_PIN_CLEAR_SUCCESS"))).catch(this.toastErrorMessage.bind(this,this.translator.translate("OFFLINE_PIN_CLEAR_ERROR")))},c.prototype.clearOfflineCredential=function(){return new Promise(this.clearOfflineCredential_Promise)},c.prototype.clearOfflineCredential_Promise=function(a,b){u.PredixSDK.user.clearOfflineCredential(a,b)},c.prototype.toastSuccessMessage=function(a,b){new t({closeButton:!0,timeOut:"2000",hideDuration:"1000"}).success(a,b)},c.prototype.toastErrorMessage=function(a,b,c){var d=new t({closeButton:!0,timeOut:"2000",hideDuration:"1000"}),e={message:a,code:0,detail:c};d.error(e,b)},c}(c);return v=__decorate([j.dependsOn(b,d,f)],v)});

define('text!shell/views/status-bar.html',[],function () { return '<footer>\r\n    <span class="left-footer" data-bind="visible: showOfflineStatus()">\r\n        <span class="offline-indicator"></span>\r\n        <span class="offline-caption" data-bind="text: offlineCaption"></span>\r\n    </span>\r\n    <span class="right-footer">\r\n        <span data-bind="visible: !isSupportedBrowser(), text: getPlatformUnsupportedCaption()"></span>\r\n        <span data-bind="text: version()"></span>\r\n        <span data-bind="text: host()"></span>\r\n        <span data-bind="text: session().datasourceId"></span>\r\n        <span data-bind="text: user().id"></span>\r\n    </span>\r\n</footer>';});

define('shell/status-bar-view-model',["require","exports","application/application-context","spa/knockout/knockout-view-model","system/globalization/translator","system/hardware/device","system/mobile/device-connectivity","knockout","application/application-events","../system/lang/ioc","text!./views/status-bar.html"],function(require,exports,a,b,c,d,e,f,g,h){"use strict";var i=require("text!./views/status-bar.html");return function(b){__extends(j,b);function j(){var a=b.call(this,i)||this;return a.applicationEvents=h.resolve(g),a.device=new d,a.translator=h.resolve(c),a.platformUnsupportedCaption=f.observable(""),a.showOfflineStatus=f.observable(!1),a.offlineCaption=f.observable(""),a}return j.prototype.open=function(){this.device.isMobileApp()&&(this.checkInitialConnectionStatus(),this.listenToConnectionStatus())},j.prototype.checkInitialConnectionStatus=function(){this.setOfflineIndicator(this,null,a.connectionStatus,!0)},j.prototype.listenToConnectionStatus=function(){
this.applicationEvents.connectionChanged.add(this.setOfflineIndicator.bind(null,this),this)},j.prototype.version=function(){return window.appInfo.version},j.prototype.host=function(){return this.session().apiServer},j.prototype.user=function(){return a.user},j.prototype.session=function(){return a.session},j.prototype.isSupportedBrowser=function(){return a.isSupportedBrowser},j.prototype.setOfflineIndicator=function(a,b,c,d){!c.connected||d?a.updateOfflineIndicator(a,c.connected):a.checkOnlineStatus().done(function(a,b){a.updateOfflineIndicator(a,b)}.bind(null,a))},j.prototype.updateOfflineIndicator=function(a,b){a.showOfflineStatus(!b),a.setOfflineCaption()},j.prototype.checkOnlineStatus=function(){var a=require("application/application-service"),b=new a,c=$.Deferred();return b.ping().done(c.resolve.bind(c,!0)).fail(c.resolve.bind(c,!1)),c.promise()},j.prototype.getOfflineCaption=function(){return this.setOfflineCaption(),this.offlineCaption()},
j.prototype.setOfflineCaption=function(){var a=h.resolve(e),b;b=this.device.isMobileApp()&&a.getManualOfflineStatus()?this.translator.translate("OFFLINE_BY_USER"):this.translator.translate("OFFLINE"),this.offlineCaption(b)},j.prototype.getPlatformUnsupportedCaption=function(){return this.setPlatformUnsupportedCaption(this),this.platformUnsupportedCaption()},j.prototype.setPlatformUnsupportedCaption=function(a){var b;b=a.device.isMobileApp()?a.translator.translate("OS_NOT_SUPPORTED"):a.translator.translate("BROWSER_NOT_SUPPORTED"),a.platformUnsupportedCaption(b)},j}(b)});

define('text!shell/views/shell.html',[],function () { return '<div class="dialog-shell"></div>\r\n<div id="shell-screen">\r\n    <div class="small-screen-app-title-bar">\r\n        <i class="icon-ge-logo"></i>\r\n        <span class="small-screen-title" data-bind="text: pageTitle"></span>\r\n    </div>\r\n    <nav class="top-nav block-group">\r\n        <nav class="tab block"></nav>\r\n        <nav class="app block"></nav>\r\n    </nav>\r\n    <nav class="leftnav" data-bind="css:{\'open\':leftnavViewModel.isHomeView}"></nav>\r\n    <section class="content-wrapper">\r\n        <section class="content">&nbsp;</section>\r\n    </section>\r\n    <nav class="status-bar"></nav>\r\n</div>\r\n<section id="iframe-stage" class="hidden"></section>';});

define('shell/shell-view-model',["require","exports","jquery","knockout","application/application-context","spa/knockout/knockout-view-model","./navigation-view-model","./application-menu-view-model","./leftnav-view-model","spa/region","ui/screen-size","spa/conductor","../system/lang/ioc","system/globalization/translator","./status-bar-view-model","text!./views/shell.html"],function(require,exports,a,b,c,d,e,f,g,h,i,j,k,l,m){"use strict";var n=require("text!./views/shell.html"),o=function(d){__extends(j,d);function j(a){var c=d.call(this,n)||this,j=k.resolve(l);return c.navigationViewModel=k.resolve(e),c.applicationMenuViewModel=k.resolve(f),c.statusBarViewModel=k.resolve(m),c.leftnavViewModel=k.resolve(g),c.screenSize=k.resolve(i),c.conductor=a,c.navigationRegion=new h(null),c.applicationMenuRegion=new h(null),c.statusBarRegion=new h(null),c.leftnavRegion=new h(null),c.pageTitle=b.observable(j.translate("ASSET_PERFORMANCE_MANAGEMENT")),c}return j.prototype.attach=function(b){d.prototype.attach.call(this,b)
;var c=screen;this.navigationRegion.setElement(a("nav.tab")),this.conductor.changeScreen(this.navigationViewModel,this.navigationRegion),this.applicationMenuRegion.setElement(a("nav.app")),this.conductor.changeScreen(this.applicationMenuViewModel,this.applicationMenuRegion),this.statusBarRegion.setElement(a("nav.status-bar")),this.conductor.changeScreen(this.statusBarViewModel,this.statusBarRegion),this.leftnavRegion.setElement(a("nav.leftnav")),this.conductor.changeScreen(this.leftnavViewModel,this.leftnavRegion),this.screenSize.isTooSmallForAllPages()&&c.lockOrientation&&c.lockOrientation("portrait")},j.prototype.reuse=function(){},j.prototype.deactivate=function(){this.shellEvents.newTab.remove(),this.shellEvents.logOff.remove()},j.prototype.user=function(){return c.user},j.prototype.session=function(){return c.session},j}(d);return o=__decorate([k.dependsOn(j)],o)});
