/* Copyright Â© 1993-2019 Meridium, Inc. All rights reserved.  */
define(function a(require){"use strict";var b=require("lodash"),c=require("jquery"),d=require("application/application-context"),e=require("system/http/ajax-request"),f=require("../adapters/dashboard-container-adapter"),g=require("mi-assert"),h="api/core/dashboards",i="api/core/userpref",j=2,k="20",l="api/core/localizer",m=l+"/translations?localizableType={0}&defaultValue={1}&objectContext={2}";function n(){}n.prototype.createDashboard=function a(b){g.isObject(b);var d=c.Deferred(),i=f.serialize(b);return e.post(h,i).send(d).done(d.resolve.bind(d)),d.promise()},n.prototype.getDashboardByKey=function a(b){g.isString(b);var d=c.Deferred();return e.get(h+"/"+b).send(d).done(r.bind(null,this,d)),d.promise()},n.prototype.getDashboardByPath=function a(b){g.isString(b);var d=c.Deferred();return e.get(h+"?path="+encodeURIComponent(b)).send(d).done(r.bind(null,this,d)),d.promise()},n.prototype.save=function a(b){g.isObject(b);var d=f.serialize(b),i=c.Deferred()
;return e.put(h+"/"+b.key,d).send(i).done(i.resolve.bind(i)),i.promise()},n.prototype.setHomePage=function a(b){g.isString(b,"path");var f=c.Deferred(),h=e.post(w(),u(b));return d.homeRoute="home",h.send(f).done(s.bind(null,this,f)),f.promise()},n.prototype.getHomePage=function a(){var b=c.Deferred();return e.get(h+"/home").send(b).done(t.bind(null,this,b)),b.promise()},n.prototype.getDefaultHomeDashboard=function(){var a=c.Deferred();return e.get(h+"/retrieveDefaultHomeDashboard").send(a).done(o.bind(null,this,a)),a.promise()};function o(a,b,c){g.instanceOf(a,n),g.isObject(b,"dfd"),b.resolve(c)}n.prototype.saveDefaultHomeDashboard=function(a){g.isString(a,"path");var b=c.Deferred();return e.post(h+"/saveDefaultHomeDashboard?path="+encodeURIComponent(a)).send(b).done(p.bind(null,this,b)),b.promise()};function p(a,b){g.instanceOf(a,n),g.isObject(b,"dfd"),b.resolve()}n.prototype.getTranslation=function(a,b,d){var f=c.Deferred(),g=x(b,d);return e.get(g).send(f).done(q.bind(null,f,a,b)),
f.promise()};function q(a,c,d,e){var f=b.find(e,{cultureId:c});f&&(d=f.value),a.resolve(d)}function r(a,b,c){g.instanceOf(a,n),g.isObject(b,"dfd"),g.isObject(c,"data");var d=f.deserialize(c);b.resolve(d)}function s(a,b){g.instanceOf(a,n),g.isObject(b,"dfd"),b.resolve()}function t(a,b,c){g.instanceOf(a,n),g.isObject(b,"dfd"),b.resolve(c)}function u(a){return g.isString(a,"path"),{userKey:v(),prefType:j,name:"home-dashboard",value:a}}function v(){return g.ok(d.user),d.user.key}function w(){return i+"/set"}function x(a,b){return m.replace("{0}",encodeURIComponent(k)).replace("{1}",encodeURIComponent(a)).replace("{2}",encodeURIComponent(b))}return n});