/* Copyright Â© 1993-2019 Meridium, Inc. All rights reserved.  */
define(function(require){"use strict";var a=require("lodash"),b=require("knockout"),c=require("system/lang/event"),d=require("./dashboard-user"),e=require("mi-assert");function f(a,f,h,k,l,m){e.isString(f,"type"),e.isString(h,"name"),e.isString(k,"uniqueID"),e.isObject(l,"properties"),this.user=new d,this.dashboard=b.observable(a),this.type=b.observable(f),this.name=b.observable(h),this.uniqueID=b.observable(k),this.properties=b.observable(l),this.caption=b.observable(m),this.propertiesAsArray=b.computed(g.bind(null,this)),this.translationContext=b.computed(i.bind(null,this)),this.name.subscribe(j.bind(null,this)),this.caption.subscribe(o.bind(null,this)),this.nameChanged=Object.resolve(c)}function g(b){return p(b),a.map(b.properties(),h)}function h(a,b){return e.isString(b),{key:b,value:a}}function i(a){return a.localizationContext(a.uniqueID())}f.prototype.localizationContext=function a(b){return this.dashboard().path()+"\\fields\\"+b};function j(a,b){p(a),e.isString(b,"value"),
a.user.usesDefaultLanguage()?a.caption(b):l(a,b)}function k(a,b){a.nameChanged.raise(a,b)}function l(a,b){require(["../services/dashboard-service"],m.bind(null,a,b))}function m(a,b,c){Object.resolve(c).getTranslation(a.user.language(),b,a.translationContext()).done(n.bind(null,a))}function n(a,b){a.caption(b)}function o(a,b){p(a),e.isString(b,"value"),k(a,b)}function p(a){e.instanceOf(a,f,"self")}return f});