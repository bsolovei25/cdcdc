/* Copyright Â© 1993-2019 Meridium, Inc. All rights reserved.  */
define(function(require,exports,module){"use strict";var a=require("system/http/ajax-client"),b=require("mi-assert"),c=require("./i-task"),d=require("system/diagnostics/log-manager"),e=d.getLogger(module.id),f=require("logging/error-notification-handler"),g=require("security/services/fmlypriv-dto"),h=require("application/application-context"),i=require("bluebird"),j="api/core/metadata/familyIds";function k(){b.implementsInterface(this,c,"this"),this.ajaxClient=Object.resolve(a),this.errorNotificationHandler=Object.resolve(f)}k.prototype.execute=function(){var a=h.user.privileges;return i.resolve(this.ajaxClient.post(j,a)).then(l).catch(m.bind(null,this))};function l(a){h.user.privileges=null,h.user.privileges=g.fromDataCollection(a)}function m(a){var b={name:"Error",message:"Unable to populate family ID",stack:"Unable to populate family ID - app/application/tasks/populate-family-id-task.js"};e.error(b.stack),a.errorNotificationHandler.addError({errorMessage:b.message,
errorDetail:b.stack})}return k});