/* Copyright Â© 1993-2019 Meridium, Inc. All rights reserved.  */
define(function(require){"use strict";var a=require("./widget-editor"),b=require("catalog/catalog-dialog"),c=require("../views/query-widget-editor-view");require("ui/elements/localize/localize-element");function d(a){e.call(this,a,c.html),this.editorView=Object.resolve(c),this.backup.path=this.kom.observable(),this.catalogDialog=Object.resolve(b)}var e=Object.inherit(a,d);d.prototype.afterLoad=function(){try{h(this)}catch(a){e.prototype.onError.call(this,a)}},d.prototype.afterSave=function(){try{i(this)}catch(a){e.prototype.onError.call(this,a)}},d.prototype.afterCancel=function(){try{j(this)}catch(a){e.prototype.onError.call(this,a)}},d.prototype.afterAttach=function(a){try{this.editorView.attach(a),e.prototype.handleRequiredFields.call(this,this.widgetVM.path),Element.upgrade(a.element.querySelectorAll("mi-localize"))}catch(a){e.prototype.onError.call(this,a)}},d.prototype.afterDetach=function(){try{this.editorView.detach()}catch(a){e.prototype.onError.call(this,a)}},
d.prototype.choosePathFromCatalog=function(){try{this.catalogDialog.show({path:this.widgetVM.path(),itemTypes:["Query"]}).done(f.bind(null,this)).fail(g.bind(null,this))}catch(a){e.prototype.onError.call(this,a)}};function f(a,b){var c=a.widgetVM.translator.translate("QUERY_WIDGET");a.widgetVM.path(b.path),a.widgetVM.widget.name(b.id)}function g(a,b){if("cancelled"!==b)throw new Error("Unable to retrieve catalog item because: "+b)}function h(a){a.backup.path(a.widgetVM.path())}function i(a){a.backup.path()}function j(a){a.widgetVM.path(a.backup.path())}return d});