/* Copyright Â© 1993-2019 Meridium, Inc. All rights reserved.  */
define(function(require){"use strict";var a=require("lodash"),b=require("system/http/es6-ajax-request"),c=require("bluebird"),d=require("system/globalization/culture"),e=require("mi-assert"),f="api/core/localizer",g=f+"/languages?transType={0}",h=f+"/translations/objectKey/{0}?localizableType={1}&defaultValue={2}",i=f+"/translations?localizableType={0}&defaultValue={1}&objectContext={2}";function j(){}j.prototype.getLanguages=function a(c){var e=arguments.length>0?c:1;return b.get(g.replace("{0}",e)).send().then(d.fromJsonArray)},j.prototype.getTranslationValues=function(a,c,d,e){var f=k(a,c,d,e);return b.get(f).send()};function k(a,b,c,d){return n(c,d),c?h.replace("{0}",encodeURIComponent(c)).replace("{1}",encodeURIComponent(a)).replace("{2}",encodeURIComponent(b)):i.replace("{0}",encodeURIComponent(a)).replace("{1}",encodeURIComponent(b)).replace("{2}",encodeURIComponent(d))}j.prototype.saveTranslationValues=function(d,e,f,g,h){var i,j=k(d,e,f,g);return h=l(h),
h.length?b.put(j,h).send():(i=c.resolve(),a.defer(i.resolve.bind(i)),i)};function l(b){return a(b).map(m).value()}function m(a){return{cultureId:a.culture().id,translation:a.phrase()}}function n(a,b){e.assert(a.length+b.length>0,"Either key or context must be populated: key = "+a+", context = "+b)}return j});